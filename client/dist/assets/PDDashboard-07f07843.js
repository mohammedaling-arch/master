import { r as o, d as k, j as e, A, m as y, a as b } from "./index-a367903a.js"; import { A as P } from "./ApplicantManager-e6297b3e.js"; import { P as w, a as z } from "./PublicAnalytics-f4f515fa.js"; import { a as I, P as C, b as S } from "./ProbateApplicationDetails-2d4ae9c5.js"; import { c as L, L as F, H as E, d as R, a as D, M as _ } from "./SupportTickets-1bec5e21.js"; import { S as O } from "./StaffProfile-a6896eb8.js"; import { A as T } from "./arrow-left-87f00f60.js"; import { F as M } from "./file-text-05ff1bfe.js"; import { H as B } from "./history-5f7ad8ed.js"; import { C as H } from "./credit-card-7df9ba98.js"; import { U as N } from "./dateUtils-0cf2816c.js"; import "./ImageCapture-db49fbfc.js"; import "./html2canvas.esm-7584f2e8.js"; import "./refresh-cw-24e393f6.js"; import "./user-plus-bcd5904a.js"; import "./trash-2-9ff1ad5f.js"; import "./image-fb628d93.js"; import "./download-8bb8051d.js"; import "./activity-566acbed.js"; import "./menu-52d4f898.js"; import "./briefcase-8ab53315.js"; import "./shield-1033dda0.js"; import "./mail-7147b856.js"; import "./lock-2d4848cc.js"; const W = ({ isMobile: r, activeTab: a, staff: d, onUpdate: p }) => { const [c, i] = o.useState("main"), [s, n] = o.useState(null), [u, x] = o.useState(null); k(), o.useEffect(() => { i("main"), n(null), x(null) }, [a]); const g = f => { n(f), i("file_probate") }, m = f => { x(f), i("details") }, h = () => { switch (a) { case "overview": return e.jsx(w, { isMobile: r, setView: () => { }, module: "probate" }); case "applicants": return e.jsx(P, { isMobile: r, onFileFor: g }); case "probates": return e.jsx(S, { isMobile: r, onSelect: m, staffMode: !0 }); case "letters": return e.jsx(S, { isMobile: r, onSelect: m, filterStatus: "under_processing,completed", title: "Letters of Administration Queue", staffMode: !0 }); case "payments": return e.jsx(z, { isMobile: r, staffMode: !0 }); case "support": return e.jsx(L, { user: d, isMobile: r, isStaff: !0 }); case "profile": return e.jsx(O, { staff: d, isMobile: r, onUpdate: p }); default: return e.jsx(w, { isMobile: r, setView: () => { }, module: "probate" }) } }; return e.jsx("div", { style: { minHeight: "100vh" }, children: e.jsxs(A, { mode: "wait", children: [c === "main" && e.jsx(y.div, { initial: { opacity: 0, y: 10 }, animate: { opacity: 1, y: 0 }, exit: { opacity: 0, y: -10 }, children: h() }, "main"), c === "file_probate" && s && e.jsxs(y.div, { initial: { opacity: 0, x: 20 }, animate: { opacity: 1, x: 0 }, exit: { opacity: 0, x: -20 }, children: [e.jsxs("div", { style: { marginBottom: "2rem", display: "flex", alignItems: "center", gap: "1rem" }, children: [e.jsxs("button", { onClick: () => i("main"), style: { background: "transparent", border: "none", color: "#778eaeff", cursor: "pointer", display: "flex", alignItems: "center", gap: "0.5rem", fontWeight: "bold" }, children: [e.jsx(T, { size: 18 }), " Back to Applicants"] }), e.jsxs("h2", { style: { margin: 0 }, children: ["File Probate for ", s.first_name, " ", s.surname] })] }), e.jsx(I, { user: { id: s.id, full_name: `${s.first_name} ${s.surname}`, email: s.email, phone: s.phone, is_applicant_manager_user: !0 }, isMobile: r, isStaffFiling: !0, onComplete: () => i("main") })] }, "file_probate"), c === "details" && u && e.jsx(y.div, { initial: { opacity: 0, scale: .98 }, animate: { opacity: 1, scale: 1 }, exit: { opacity: 0, scale: .98 }, children: e.jsx(C, { applicationId: u, onBack: () => i("main"), isMobile: r, user: d, staffMode: !0 }) }, "details")] }) }) }, fe = ({ staff: r }) => { var v; const [a, d] = o.useState(r), [p, c] = o.useState("overview"), [i, s] = o.useState(window.innerWidth > 1024), [n, u] = o.useState(window.innerWidth <= 1024), [x, g] = o.useState([]); o.useEffect(() => { const t = () => { const l = window.innerWidth <= 1024; u(l), s(!l) }; return window.addEventListener("resize", t), () => window.removeEventListener("resize", t) }, []), o.useEffect(() => { const t = async () => { try { const l = await b.get("/staff/profile"); d(l.data), localStorage.setItem("staff", JSON.stringify(l.data)) } catch (l) { console.error("Failed to refresh staff info:", l) } }; r != null && r.id && t() }, [r == null ? void 0 : r.id]); const m = async () => { try { const t = await b.get("/notifications/staff"); g(t.data) } catch (t) { console.error("Failed to fetch notifications:", t) } }, h = async t => { try { await b.put(`/notifications/staff/${t}/read`), m() } catch (l) { console.error("Error marking read:", l) } }; o.useEffect(() => { if (a != null && a.id) { m(); const t = setInterval(m, 3e4); return () => clearInterval(t) } }, [a == null ? void 0 : a.id]); const f = () => { localStorage.removeItem("staffToken"), localStorage.removeItem("staff"), window.location.href = "/staff/login" }, j = [{ icon: e.jsx(R, { size: 20 }), label: "Overview", id: "overview" }, { icon: e.jsx(D, { size: 20 }), label: "Manage Applicants", id: "applicants" }, { icon: e.jsx(M, { size: 20 }), label: "All Probate Filings", id: "probates" }, { icon: e.jsx(B, { size: 20 }), label: "Letter of Admin", id: "letters" }, { icon: e.jsx(H, { size: 20 }), label: "Payment Receipt", id: "payments" }, { icon: e.jsx(_, { size: 20 }), label: "Support", id: "support" }, { icon: e.jsx(N, { size: 20 }), label: "My Profile", id: "profile" }]; return a ? e.jsxs("div", { style: { display: "flex", height: "100vh", overflow: "hidden", background: "#f8fafc", color: "#3d2b1f", position: "relative" }, children: [n && i && e.jsx("div", { onClick: () => s(!1), style: { position: "fixed", inset: 0, background: "rgba(0,0,0,0.5)", zIndex: 40, backdropFilter: "blur(4px)" } }), e.jsxs("aside", { style: { width: i ? "260px" : n ? "0" : "80px", background: "#3d2b1f", padding: "0", display: "flex", flexDirection: "column", transition: "all 0.3s cubic-bezier(0.4, 0, 0.2, 1)", overflow: "hidden", position: n ? "fixed" : "relative", height: "100vh", zIndex: 50 }, children: [e.jsxs("div", { style: { padding: "2rem", marginBottom: "1rem", display: "flex", alignItems: "center", justifyContent: i ? "flex-start" : "center", gap: "1rem" }, children: [e.jsx("img", { src: "/assets/logo.png", alt: "Logo", style: { width: "40px", height: "40px", borderRadius: "50%", flexShrink: 0 } }), i && e.jsxs("div", { style: { whiteSpace: "nowrap" }, children: [e.jsx("h2", { style: { color: "white", fontSize: "1.2rem", margin: 0 }, children: "CRMS Probate" }), e.jsx("p", { style: { margin: 0, fontSize: "9px", color: "#8d6e63", fontWeight: "bold" }, children: "PROBATE DESK" })] })] }), e.jsx("nav", { style: { flex: 1, overflowY: "auto", padding: "0 1rem" }, children: j.map(t => e.jsxs("div", { onClick: () => { c(t.id), n && s(!1) }, title: i ? "" : t.label, style: { display: "flex", alignItems: "center", justifyContent: i ? "flex-start" : "center", gap: "1rem", padding: "1rem", cursor: "pointer", borderRadius: "12px", background: p === t.id ? "#5d4037" : "transparent", color: p === t.id ? "#2ecc71" : "#8d6e63", marginBottom: "0.5rem", transition: "all 0.2s", whiteSpace: "nowrap" }, children: [t.icon, i && e.jsx("span", { children: t.label })] }, t.id)) }), e.jsx("div", { style: { padding: "1rem" }, children: e.jsxs("button", { onClick: f, style: { width: "100%", display: "flex", alignItems: "center", justifyContent: i ? "flex-start" : "center", gap: "1rem", padding: "1rem", background: "transparent", border: "none", color: "#ef4444", cursor: "pointer", borderRadius: "12px", transition: "background 0.2s" }, onMouseOver: t => t.currentTarget.style.background = "rgba(239, 68, 68, 0.1)", onMouseOut: t => t.currentTarget.style.background = "transparent", children: [e.jsx(F, { size: 20 }), i && e.jsx("span", { children: "Logout" })] }) })] }), e.jsxs("main", { style: { flex: 1, display: "flex", flexDirection: "column", height: "100vh", overflowY: "auto", width: "100%" }, children: [e.jsx(E, { user: a, title: ((v = j.find(t => t.id === p)) == null ? void 0 : v.label) || "Probate Desk", onLogout: f, onSidebarToggle: () => s(!i), onProfileClick: () => c("profile"), onSettingsClick: () => c("profile"), sidebarOpen: i, notifications: x, onNotificationRead: h, isMobile: n }), e.jsx("div", { style: { padding: n ? "1rem" : "2.5rem", flex: 1 }, children: e.jsx(W, { activeTab: p, isMobile: n, staff: a, onUpdate: t => { d(t), localStorage.setItem("staff", JSON.stringify(t)) } }) })] })] }) : e.jsx("div", { style: { padding: "2rem", textAlign: "center" }, children: "Loading Probate Desk session..." }) }; export { fe as default };
