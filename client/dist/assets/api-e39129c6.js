import{c as createLucideIcon,l as commonjsGlobal}from"./index-a367903a.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$2=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],MicOff=createLucideIcon("mic-off",__iconNode$2);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$1=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],Mic=createLucideIcon("mic",__iconNode$1);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode=[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],VideoOff=createLucideIcon("video-off",__iconNode);var ZegoExpressWebRTC={exports:{}},umd={exports:{}},hasRequiredUmd;function requireUmd(){return hasRequiredUmd||(hasRequiredUmd=1,function(yn,Bt){var on=function(sn){Object.defineProperty(sn,"__esModule",{value:!0}),sn.default=void 0;/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var Dt=null;try{Dt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ct(b,y,M){this.low=b|0,this.high=y|0,this.unsigned=!!M}ct.prototype.__isLong__,Object.defineProperty(ct.prototype,"__isLong__",{value:!0});function bt(b){return(b&&b.__isLong__)===!0}function dt(b){var y=Math.clz32(b&-b);return b?31-y:y}ct.isLong=bt;var pt={},Ft={};function It(b,y){var M,Y,L;return y?(b>>>=0,(L=0<=b&&b<256)&&(Y=Ft[b],Y)?Y:(M=Te(b,0,!0),L&&(Ft[b]=M),M)):(b|=0,(L=-128<=b&&b<128)&&(Y=pt[b],Y)?Y:(M=Te(b,b<0?-1:0,!1),L&&(pt[b]=M),M))}ct.fromInt=It;function Ye(b,y){if(isNaN(b))return y?se:Q;if(y){if(b<0)return se;if(b>=nt)return N}else{if(b<=-Ne)return v;if(b+1>=Ne)return C}return b<0?Ye(-b,y).neg():Te(b%Me|0,b/Me|0,y)}ct.fromNumber=Ye;function Te(b,y,M){return new ct(b,y,M)}ct.fromBits=Te;var E=Math.pow;function w(b,y,M){if(b.length===0)throw Error("empty string");if(typeof y=="number"?(M=y,y=!1):y=!!y,b==="NaN"||b==="Infinity"||b==="+Infinity"||b==="-Infinity")return y?se:Q;if(M=M||10,M<2||36<M)throw RangeError("radix");var Y;if((Y=b.indexOf("-"))>0)throw Error("interior hyphen");if(Y===0)return w(b.substring(1),y,M).neg();for(var L=Ye(E(M,8)),A=Q,H=0;H<b.length;H+=8){var ge=Math.min(8,b.length-H),Ee=parseInt(b.substring(H,H+ge),M);if(ge<8){var Se=Ye(E(M,ge));A=A.mul(Se).add(Ye(Ee))}else A=A.mul(L),A=A.add(Ye(Ee))}return A.unsigned=y,A}ct.fromString=w;function Re(b,y){return typeof b=="number"?Ye(b,y):typeof b=="string"?w(b,y):Te(b.low,b.high,typeof y=="boolean"?y:b.unsigned)}ct.fromValue=Re;var we=65536,he=1<<24,Me=we*we,nt=Me*Me,Ne=nt/2,W=It(he),Q=It(0);ct.ZERO=Q;var se=It(0,!0);ct.UZERO=se;var J=It(1);ct.ONE=J;var G=It(1,!0);ct.UONE=G;var U=It(-1);ct.NEG_ONE=U;var C=Te(-1,2147483647,!1);ct.MAX_VALUE=C;var N=Te(-1,-1,!0);ct.MAX_UNSIGNED_VALUE=N;var v=Te(0,-2147483648,!1);ct.MIN_VALUE=v;var f=ct.prototype;f.toInt=function(){return this.unsigned?this.low>>>0:this.low},f.toNumber=function(){return this.unsigned?(this.high>>>0)*Me+(this.low>>>0):this.high*Me+(this.low>>>0)},f.toString=function(y){if(y=y||10,y<2||36<y)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(v)){var M=Ye(y),Y=this.div(M),L=Y.mul(M).sub(this);return Y.toString(y)+L.toInt().toString(y)}else return"-"+this.neg().toString(y);for(var A=Ye(E(y,6),this.unsigned),H=this,ge="";;){var Ee=H.div(A),Se=H.sub(Ee.mul(A)).toInt()>>>0,ue=Se.toString(y);if(H=Ee,H.isZero())return ue+ge;for(;ue.length<6;)ue="0"+ue;ge=""+ue+ge}},f.getHighBits=function(){return this.high},f.getHighBitsUnsigned=function(){return this.high>>>0},f.getLowBits=function(){return this.low},f.getLowBitsUnsigned=function(){return this.low>>>0},f.getNumBitsAbs=function(){if(this.isNegative())return this.eq(v)?64:this.neg().getNumBitsAbs();for(var y=this.high!=0?this.high:this.low,M=31;M>0&&!(y&1<<M);M--);return this.high!=0?M+33:M+1},f.isZero=function(){return this.high===0&&this.low===0},f.eqz=f.isZero,f.isNegative=function(){return!this.unsigned&&this.high<0},f.isPositive=function(){return this.unsigned||this.high>=0},f.isOdd=function(){return(this.low&1)===1},f.isEven=function(){return(this.low&1)===0},f.equals=function(y){return bt(y)||(y=Re(y)),this.unsigned!==y.unsigned&&this.high>>>31===1&&y.high>>>31===1?!1:this.high===y.high&&this.low===y.low},f.eq=f.equals,f.notEquals=function(y){return!this.eq(y)},f.neq=f.notEquals,f.ne=f.notEquals,f.lessThan=function(y){return this.comp(y)<0},f.lt=f.lessThan,f.lessThanOrEqual=function(y){return this.comp(y)<=0},f.lte=f.lessThanOrEqual,f.le=f.lessThanOrEqual,f.greaterThan=function(y){return this.comp(y)>0},f.gt=f.greaterThan,f.greaterThanOrEqual=function(y){return this.comp(y)>=0},f.gte=f.greaterThanOrEqual,f.ge=f.greaterThanOrEqual,f.compare=function(y){if(bt(y)||(y=Re(y)),this.eq(y))return 0;var M=this.isNegative(),Y=y.isNegative();return M&&!Y?-1:!M&&Y?1:this.unsigned?y.high>>>0>this.high>>>0||y.high===this.high&&y.low>>>0>this.low>>>0?-1:1:this.sub(y).isNegative()?-1:1},f.comp=f.compare,f.negate=function(){return!this.unsigned&&this.eq(v)?v:this.not().add(J)},f.neg=f.negate,f.add=function(y){bt(y)||(y=Re(y));var M=this.high>>>16,Y=this.high&65535,L=this.low>>>16,A=this.low&65535,H=y.high>>>16,ge=y.high&65535,Ee=y.low>>>16,Se=y.low&65535,ue=0,oe=0,be=0,Le=0;return Le+=A+Se,be+=Le>>>16,Le&=65535,be+=L+Ee,oe+=be>>>16,be&=65535,oe+=Y+ge,ue+=oe>>>16,oe&=65535,ue+=M+H,ue&=65535,Te(be<<16|Le,ue<<16|oe,this.unsigned)},f.subtract=function(y){return bt(y)||(y=Re(y)),this.add(y.neg())},f.sub=f.subtract,f.multiply=function(y){if(this.isZero())return this;if(bt(y)||(y=Re(y)),Dt){var M=Dt.mul(this.low,this.high,y.low,y.high);return Te(M,Dt.get_high(),this.unsigned)}if(y.isZero())return this.unsigned?se:Q;if(this.eq(v))return y.isOdd()?v:Q;if(y.eq(v))return this.isOdd()?v:Q;if(this.isNegative())return y.isNegative()?this.neg().mul(y.neg()):this.neg().mul(y).neg();if(y.isNegative())return this.mul(y.neg()).neg();if(this.lt(W)&&y.lt(W))return Ye(this.toNumber()*y.toNumber(),this.unsigned);var Y=this.high>>>16,L=this.high&65535,A=this.low>>>16,H=this.low&65535,ge=y.high>>>16,Ee=y.high&65535,Se=y.low>>>16,ue=y.low&65535,oe=0,be=0,Le=0,pe=0;return pe+=H*ue,Le+=pe>>>16,pe&=65535,Le+=A*ue,be+=Le>>>16,Le&=65535,Le+=H*Se,be+=Le>>>16,Le&=65535,be+=L*ue,oe+=be>>>16,be&=65535,be+=A*Se,oe+=be>>>16,be&=65535,be+=H*Ee,oe+=be>>>16,be&=65535,oe+=Y*ue+L*Se+A*Ee+H*ge,oe&=65535,Te(Le<<16|pe,oe<<16|be,this.unsigned)},f.mul=f.multiply,f.divide=function(y){if(bt(y)||(y=Re(y)),y.isZero())throw Error("division by zero");if(Dt){if(!this.unsigned&&this.high===-2147483648&&y.low===-1&&y.high===-1)return this;var M=(this.unsigned?Dt.div_u:Dt.div_s)(this.low,this.high,y.low,y.high);return Te(M,Dt.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?se:Q;var Y,L,A;if(this.unsigned){if(y.unsigned||(y=y.toUnsigned()),y.gt(this))return se;if(y.gt(this.shru(1)))return G;A=se}else{if(this.eq(v)){if(y.eq(J)||y.eq(U))return v;if(y.eq(v))return J;var H=this.shr(1);return Y=H.div(y).shl(1),Y.eq(Q)?y.isNegative()?J:U:(L=this.sub(y.mul(Y)),A=Y.add(L.div(y)),A)}else if(y.eq(v))return this.unsigned?se:Q;if(this.isNegative())return y.isNegative()?this.neg().div(y.neg()):this.neg().div(y).neg();if(y.isNegative())return this.div(y.neg()).neg();A=Q}for(L=this;L.gte(y);){Y=Math.max(1,Math.floor(L.toNumber()/y.toNumber()));for(var ge=Math.ceil(Math.log(Y)/Math.LN2),Ee=ge<=48?1:E(2,ge-48),Se=Ye(Y),ue=Se.mul(y);ue.isNegative()||ue.gt(L);)Y-=Ee,Se=Ye(Y,this.unsigned),ue=Se.mul(y);Se.isZero()&&(Se=J),A=A.add(Se),L=L.sub(ue)}return A},f.div=f.divide,f.modulo=function(y){if(bt(y)||(y=Re(y)),Dt){var M=(this.unsigned?Dt.rem_u:Dt.rem_s)(this.low,this.high,y.low,y.high);return Te(M,Dt.get_high(),this.unsigned)}return this.sub(this.div(y).mul(y))},f.mod=f.modulo,f.rem=f.modulo,f.not=function(){return Te(~this.low,~this.high,this.unsigned)},f.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},f.clz=f.countLeadingZeros,f.countTrailingZeros=function(){return this.low?dt(this.low):dt(this.high)+32},f.ctz=f.countTrailingZeros,f.and=function(y){return bt(y)||(y=Re(y)),Te(this.low&y.low,this.high&y.high,this.unsigned)},f.or=function(y){return bt(y)||(y=Re(y)),Te(this.low|y.low,this.high|y.high,this.unsigned)},f.xor=function(y){return bt(y)||(y=Re(y)),Te(this.low^y.low,this.high^y.high,this.unsigned)},f.shiftLeft=function(y){return bt(y)&&(y=y.toInt()),(y&=63)===0?this:y<32?Te(this.low<<y,this.high<<y|this.low>>>32-y,this.unsigned):Te(0,this.low<<y-32,this.unsigned)},f.shl=f.shiftLeft,f.shiftRight=function(y){return bt(y)&&(y=y.toInt()),(y&=63)===0?this:y<32?Te(this.low>>>y|this.high<<32-y,this.high>>y,this.unsigned):Te(this.high>>y-32,this.high>=0?0:-1,this.unsigned)},f.shr=f.shiftRight,f.shiftRightUnsigned=function(y){return bt(y)&&(y=y.toInt()),(y&=63)===0?this:y<32?Te(this.low>>>y|this.high<<32-y,this.high>>>y,this.unsigned):y===32?Te(this.high,0,this.unsigned):Te(this.high>>>y-32,0,this.unsigned)},f.shru=f.shiftRightUnsigned,f.shr_u=f.shiftRightUnsigned,f.rotateLeft=function(y){var M;return bt(y)&&(y=y.toInt()),(y&=63)===0?this:y===32?Te(this.high,this.low,this.unsigned):y<32?(M=32-y,Te(this.low<<y|this.high>>>M,this.high<<y|this.low>>>M,this.unsigned)):(y-=32,M=32-y,Te(this.high<<y|this.low>>>M,this.low<<y|this.high>>>M,this.unsigned))},f.rotl=f.rotateLeft,f.rotateRight=function(y){var M;return bt(y)&&(y=y.toInt()),(y&=63)===0?this:y===32?Te(this.high,this.low,this.unsigned):y<32?(M=32-y,Te(this.high<<M|this.low>>>y,this.low<<M|this.high>>>y,this.unsigned)):(y-=32,M=32-y,Te(this.low<<M|this.high>>>y,this.high<<M|this.low>>>y,this.unsigned))},f.rotr=f.rotateRight,f.toSigned=function(){return this.unsigned?Te(this.low,this.high,!1):this},f.toUnsigned=function(){return this.unsigned?this:Te(this.low,this.high,!0)},f.toBytes=function(y){return y?this.toBytesLE():this.toBytesBE()},f.toBytesLE=function(){var y=this.high,M=this.low;return[M&255,M>>>8&255,M>>>16&255,M>>>24,y&255,y>>>8&255,y>>>16&255,y>>>24]},f.toBytesBE=function(){var y=this.high,M=this.low;return[y>>>24,y>>>16&255,y>>>8&255,y&255,M>>>24,M>>>16&255,M>>>8&255,M&255]},ct.fromBytes=function(y,M,Y){return Y?ct.fromBytesLE(y,M):ct.fromBytesBE(y,M)},ct.fromBytesLE=function(y,M){return new ct(y[0]|y[1]<<8|y[2]<<16|y[3]<<24,y[4]|y[5]<<8|y[6]<<16|y[7]<<24,M)},ct.fromBytesBE=function(y,M){return new ct(y[4]<<24|y[5]<<16|y[6]<<8|y[7],y[0]<<24|y[1]<<16|y[2]<<8|y[3],M)};var _=ct;return sn.default=_,"default"in sn?sn.default:sn}({});yn.exports=on}(umd)),umd.exports}var indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=yn;function yn(Bt,on){for(var sn=new Array(arguments.length-1),Dt=0,ct=2,bt=!0;ct<arguments.length;)sn[Dt++]=arguments[ct++];return new Promise(function(pt,Ft){sn[Dt]=function(Ye){if(bt)if(bt=!1,Ye)Ft(Ye);else{for(var Te=new Array(arguments.length-1),E=0;E<Te.length;)Te[E++]=arguments[E];pt.apply(null,Te)}};try{Bt.apply(on||null,sn)}catch(It){bt&&(bt=!1,Ft(It))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(yn){var Bt=yn;Bt.length=function(dt){var pt=dt.length;if(!pt)return 0;for(var Ft=0;--pt%4>1&&dt.charAt(pt)==="=";)++Ft;return Math.ceil(dt.length*3)/4-Ft};for(var on=new Array(64),sn=new Array(123),Dt=0;Dt<64;)sn[on[Dt]=Dt<26?Dt+65:Dt<52?Dt+71:Dt<62?Dt-4:Dt-59|43]=Dt++;Bt.encode=function(dt,pt,Ft){for(var It=null,Ye=[],Te=0,E=0,w;pt<Ft;){var Re=dt[pt++];switch(E){case 0:Ye[Te++]=on[Re>>2],w=(Re&3)<<4,E=1;break;case 1:Ye[Te++]=on[w|Re>>4],w=(Re&15)<<2,E=2;break;case 2:Ye[Te++]=on[w|Re>>6],Ye[Te++]=on[Re&63],E=0;break}Te>8191&&((It||(It=[])).push(String.fromCharCode.apply(String,Ye)),Te=0)}return E&&(Ye[Te++]=on[w],Ye[Te++]=61,E===1&&(Ye[Te++]=61)),It?(Te&&It.push(String.fromCharCode.apply(String,Ye.slice(0,Te))),It.join("")):String.fromCharCode.apply(String,Ye.slice(0,Te))};var ct="invalid encoding";Bt.decode=function(dt,pt,Ft){for(var It=Ft,Ye=0,Te,E=0;E<dt.length;){var w=dt.charCodeAt(E++);if(w===61&&Ye>1)break;if((w=sn[w])===void 0)throw Error(ct);switch(Ye){case 0:Te=w,Ye=1;break;case 1:pt[Ft++]=Te<<2|(w&48)>>4,Te=w,Ye=2;break;case 2:pt[Ft++]=(Te&15)<<4|(w&60)>>2,Te=w,Ye=3;break;case 3:pt[Ft++]=(Te&3)<<6|w,Ye=0;break}}if(Ye===1)throw Error(ct);return Ft-It},Bt.test=function(dt){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(dt)}}(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=yn;function yn(){this._listeners={}}return yn.prototype.on=function(on,sn,Dt){return(this._listeners[on]||(this._listeners[on]=[])).push({fn:sn,ctx:Dt||this}),this},yn.prototype.off=function(on,sn){if(on===void 0)this._listeners={};else if(sn===void 0)this._listeners[on]=[];else for(var Dt=this._listeners[on],ct=0;ct<Dt.length;)Dt[ct].fn===sn?Dt.splice(ct,1):++ct;return this},yn.prototype.emit=function(on){var sn=this._listeners[on];if(sn){for(var Dt=[],ct=1;ct<arguments.length;)Dt.push(arguments[ct++]);for(ct=0;ct<sn.length;)sn[ct].fn.apply(sn[ct++].ctx,Dt)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=yn(yn);function yn(ct){return typeof Float32Array<"u"?function(){var bt=new Float32Array([-0]),dt=new Uint8Array(bt.buffer),pt=dt[3]===128;function Ft(E,w,Re){bt[0]=E,w[Re]=dt[0],w[Re+1]=dt[1],w[Re+2]=dt[2],w[Re+3]=dt[3]}function It(E,w,Re){bt[0]=E,w[Re]=dt[3],w[Re+1]=dt[2],w[Re+2]=dt[1],w[Re+3]=dt[0]}ct.writeFloatLE=pt?Ft:It,ct.writeFloatBE=pt?It:Ft;function Ye(E,w){return dt[0]=E[w],dt[1]=E[w+1],dt[2]=E[w+2],dt[3]=E[w+3],bt[0]}function Te(E,w){return dt[3]=E[w],dt[2]=E[w+1],dt[1]=E[w+2],dt[0]=E[w+3],bt[0]}ct.readFloatLE=pt?Ye:Te,ct.readFloatBE=pt?Te:Ye}():function(){function bt(pt,Ft,It,Ye){var Te=Ft<0?1:0;if(Te&&(Ft=-Ft),Ft===0)pt(1/Ft>0?0:2147483648,It,Ye);else if(isNaN(Ft))pt(2143289344,It,Ye);else if(Ft>34028234663852886e22)pt((Te<<31|2139095040)>>>0,It,Ye);else if(Ft<11754943508222875e-54)pt((Te<<31|Math.round(Ft/1401298464324817e-60))>>>0,It,Ye);else{var E=Math.floor(Math.log(Ft)/Math.LN2),w=Math.round(Ft*Math.pow(2,-E)*8388608)&8388607;pt((Te<<31|E+127<<23|w)>>>0,It,Ye)}}ct.writeFloatLE=bt.bind(null,Bt),ct.writeFloatBE=bt.bind(null,on);function dt(pt,Ft,It){var Ye=pt(Ft,It),Te=(Ye>>31)*2+1,E=Ye>>>23&255,w=Ye&8388607;return E===255?w?NaN:Te*(1/0):E===0?Te*1401298464324817e-60*w:Te*Math.pow(2,E-150)*(w+8388608)}ct.readFloatLE=dt.bind(null,sn),ct.readFloatBE=dt.bind(null,Dt)}(),typeof Float64Array<"u"?function(){var bt=new Float64Array([-0]),dt=new Uint8Array(bt.buffer),pt=dt[7]===128;function Ft(E,w,Re){bt[0]=E,w[Re]=dt[0],w[Re+1]=dt[1],w[Re+2]=dt[2],w[Re+3]=dt[3],w[Re+4]=dt[4],w[Re+5]=dt[5],w[Re+6]=dt[6],w[Re+7]=dt[7]}function It(E,w,Re){bt[0]=E,w[Re]=dt[7],w[Re+1]=dt[6],w[Re+2]=dt[5],w[Re+3]=dt[4],w[Re+4]=dt[3],w[Re+5]=dt[2],w[Re+6]=dt[1],w[Re+7]=dt[0]}ct.writeDoubleLE=pt?Ft:It,ct.writeDoubleBE=pt?It:Ft;function Ye(E,w){return dt[0]=E[w],dt[1]=E[w+1],dt[2]=E[w+2],dt[3]=E[w+3],dt[4]=E[w+4],dt[5]=E[w+5],dt[6]=E[w+6],dt[7]=E[w+7],bt[0]}function Te(E,w){return dt[7]=E[w],dt[6]=E[w+1],dt[5]=E[w+2],dt[4]=E[w+3],dt[3]=E[w+4],dt[2]=E[w+5],dt[1]=E[w+6],dt[0]=E[w+7],bt[0]}ct.readDoubleLE=pt?Ye:Te,ct.readDoubleBE=pt?Te:Ye}():function(){function bt(pt,Ft,It,Ye,Te,E){var w=Ye<0?1:0;if(w&&(Ye=-Ye),Ye===0)pt(0,Te,E+Ft),pt(1/Ye>0?0:2147483648,Te,E+It);else if(isNaN(Ye))pt(0,Te,E+Ft),pt(2146959360,Te,E+It);else if(Ye>17976931348623157e292)pt(0,Te,E+Ft),pt((w<<31|2146435072)>>>0,Te,E+It);else{var Re;if(Ye<22250738585072014e-324)Re=Ye/5e-324,pt(Re>>>0,Te,E+Ft),pt((w<<31|Re/4294967296)>>>0,Te,E+It);else{var we=Math.floor(Math.log(Ye)/Math.LN2);we===1024&&(we=1023),Re=Ye*Math.pow(2,-we),pt(Re*4503599627370496>>>0,Te,E+Ft),pt((w<<31|we+1023<<20|Re*1048576&1048575)>>>0,Te,E+It)}}}ct.writeDoubleLE=bt.bind(null,Bt,0,4),ct.writeDoubleBE=bt.bind(null,on,4,0);function dt(pt,Ft,It,Ye,Te){var E=pt(Ye,Te+Ft),w=pt(Ye,Te+It),Re=(w>>31)*2+1,we=w>>>20&2047,he=4294967296*(w&1048575)+E;return we===2047?he?NaN:Re*(1/0):we===0?Re*5e-324*he:Re*Math.pow(2,we-1075)*(he+4503599627370496)}ct.readDoubleLE=dt.bind(null,sn,0,4),ct.readDoubleBE=dt.bind(null,Dt,4,0)}(),ct}function Bt(ct,bt,dt){bt[dt]=ct&255,bt[dt+1]=ct>>>8&255,bt[dt+2]=ct>>>16&255,bt[dt+3]=ct>>>24}function on(ct,bt,dt){bt[dt]=ct>>>24,bt[dt+1]=ct>>>16&255,bt[dt+2]=ct>>>8&255,bt[dt+3]=ct&255}function sn(ct,bt){return(ct[bt]|ct[bt+1]<<8|ct[bt+2]<<16|ct[bt+3]<<24)>>>0}function Dt(ct,bt){return(ct[bt]<<24|ct[bt+1]<<16|ct[bt+2]<<8|ct[bt+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(yn){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(yn){var Bt=yn;Bt.length=function(sn){for(var Dt=0,ct=0,bt=0;bt<sn.length;++bt)ct=sn.charCodeAt(bt),ct<128?Dt+=1:ct<2048?Dt+=2:(ct&64512)===55296&&(sn.charCodeAt(bt+1)&64512)===56320?(++bt,Dt+=4):Dt+=3;return Dt},Bt.read=function(sn,Dt,ct){var bt=ct-Dt;if(bt<1)return"";for(var dt=null,pt=[],Ft=0,It;Dt<ct;)It=sn[Dt++],It<128?pt[Ft++]=It:It>191&&It<224?pt[Ft++]=(It&31)<<6|sn[Dt++]&63:It>239&&It<365?(It=((It&7)<<18|(sn[Dt++]&63)<<12|(sn[Dt++]&63)<<6|sn[Dt++]&63)-65536,pt[Ft++]=55296+(It>>10),pt[Ft++]=56320+(It&1023)):pt[Ft++]=(It&15)<<12|(sn[Dt++]&63)<<6|sn[Dt++]&63,Ft>8191&&((dt||(dt=[])).push(String.fromCharCode.apply(String,pt)),Ft=0);return dt?(Ft&&dt.push(String.fromCharCode.apply(String,pt.slice(0,Ft))),dt.join("")):String.fromCharCode.apply(String,pt.slice(0,Ft))},Bt.write=function(sn,Dt,ct){for(var bt=ct,dt,pt,Ft=0;Ft<sn.length;++Ft)dt=sn.charCodeAt(Ft),dt<128?Dt[ct++]=dt:dt<2048?(Dt[ct++]=dt>>6|192,Dt[ct++]=dt&63|128):(dt&64512)===55296&&((pt=sn.charCodeAt(Ft+1))&64512)===56320?(dt=65536+((dt&1023)<<10)+(pt&1023),++Ft,Dt[ct++]=dt>>18|240,Dt[ct++]=dt>>12&63|128,Dt[ct++]=dt>>6&63|128,Dt[ct++]=dt&63|128):(Dt[ct++]=dt>>12|224,Dt[ct++]=dt>>6&63|128,Dt[ct++]=dt&63|128);return ct-bt}}(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=yn;function yn(Bt,on,sn){var Dt=sn||8192,ct=Dt>>>1,bt=null,dt=Dt;return function(Ft){if(Ft<1||Ft>ct)return Bt(Ft);dt+Ft>Dt&&(bt=Bt(Dt),dt=0);var It=on.call(bt,dt,dt+=Ft);return dt&7&&(dt=(dt|7)+1),It}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=Bt;var yn=requireMinimal$1();function Bt(ct,bt){this.lo=ct>>>0,this.hi=bt>>>0}var on=Bt.zero=new Bt(0,0);on.toNumber=function(){return 0},on.zzEncode=on.zzDecode=function(){return this},on.length=function(){return 1};var sn=Bt.zeroHash="\0\0\0\0\0\0\0\0";Bt.fromNumber=function(bt){if(bt===0)return on;var dt=bt<0;dt&&(bt=-bt);var pt=bt>>>0,Ft=(bt-pt)/4294967296>>>0;return dt&&(Ft=~Ft>>>0,pt=~pt>>>0,++pt>4294967295&&(pt=0,++Ft>4294967295&&(Ft=0))),new Bt(pt,Ft)},Bt.from=function(bt){if(typeof bt=="number")return Bt.fromNumber(bt);if(yn.isString(bt))if(yn.Long)bt=yn.Long.fromString(bt);else return Bt.fromNumber(parseInt(bt,10));return bt.low||bt.high?new Bt(bt.low>>>0,bt.high>>>0):on},Bt.prototype.toNumber=function(bt){if(!bt&&this.hi>>>31){var dt=~this.lo+1>>>0,pt=~this.hi>>>0;return dt||(pt=pt+1>>>0),-(dt+pt*4294967296)}return this.lo+this.hi*4294967296},Bt.prototype.toLong=function(bt){return yn.Long?new yn.Long(this.lo|0,this.hi|0,!!bt):{low:this.lo|0,high:this.hi|0,unsigned:!!bt}};var Dt=String.prototype.charCodeAt;return Bt.fromHash=function(bt){return bt===sn?on:new Bt((Dt.call(bt,0)|Dt.call(bt,1)<<8|Dt.call(bt,2)<<16|Dt.call(bt,3)<<24)>>>0,(Dt.call(bt,4)|Dt.call(bt,5)<<8|Dt.call(bt,6)<<16|Dt.call(bt,7)<<24)>>>0)},Bt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},Bt.prototype.zzEncode=function(){var bt=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^bt)>>>0,this.lo=(this.lo<<1^bt)>>>0,this},Bt.prototype.zzDecode=function(){var bt=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^bt)>>>0,this.hi=(this.hi>>>1^bt)>>>0,this},Bt.prototype.length=function(){var bt=this.lo,dt=(this.lo>>>28|this.hi<<4)>>>0,pt=this.hi>>>24;return pt===0?dt===0?bt<16384?bt<128?1:2:bt<2097152?3:4:dt<16384?dt<128?5:6:dt<2097152?7:8:pt<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(yn){var Bt=yn;Bt.asPromise=requireAspromise(),Bt.base64=requireBase64(),Bt.EventEmitter=requireEventemitter(),Bt.float=requireFloat(),Bt.inquire=requireInquire(),Bt.utf8=requireUtf8(),Bt.pool=requirePool(),Bt.LongBits=requireLongbits(),Bt.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),Bt.global=Bt.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,Bt.emptyArray=Object.freeze?Object.freeze([]):[],Bt.emptyObject=Object.freeze?Object.freeze({}):{},Bt.isInteger=Number.isInteger||function(ct){return typeof ct=="number"&&isFinite(ct)&&Math.floor(ct)===ct},Bt.isString=function(ct){return typeof ct=="string"||ct instanceof String},Bt.isObject=function(ct){return ct&&typeof ct=="object"},Bt.isset=Bt.isSet=function(ct,bt){var dt=ct[bt];return dt!=null&&ct.hasOwnProperty(bt)?typeof dt!="object"||(Array.isArray(dt)?dt.length:Object.keys(dt).length)>0:!1},Bt.Buffer=function(){try{var Dt=Bt.inquire("buffer").Buffer;return Dt.prototype.utf8Write?Dt:null}catch{return null}}(),Bt._Buffer_from=null,Bt._Buffer_allocUnsafe=null,Bt.newBuffer=function(ct){return typeof ct=="number"?Bt.Buffer?Bt._Buffer_allocUnsafe(ct):new Bt.Array(ct):Bt.Buffer?Bt._Buffer_from(ct):typeof Uint8Array>"u"?ct:new Uint8Array(ct)},Bt.Array=typeof Uint8Array<"u"?Uint8Array:Array,Bt.Long=Bt.global.dcodeIO&&Bt.global.dcodeIO.Long||Bt.global.Long||Bt.inquire("long"),Bt.key2Re=/^true|false|0|1$/,Bt.key32Re=/^-?(?:0|[1-9][0-9]*)$/,Bt.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,Bt.longToHash=function(ct){return ct?Bt.LongBits.from(ct).toHash():Bt.LongBits.zeroHash},Bt.longFromHash=function(ct,bt){var dt=Bt.LongBits.fromHash(ct);return Bt.Long?Bt.Long.fromBits(dt.lo,dt.hi,bt):dt.toNumber(!!bt)};function on(Dt,ct,bt){for(var dt=Object.keys(ct),pt=0;pt<dt.length;++pt)(Dt[dt[pt]]===void 0||!bt)&&(Dt[dt[pt]]=ct[dt[pt]]);return Dt}Bt.merge=on,Bt.lcFirst=function(ct){return ct.charAt(0).toLowerCase()+ct.substring(1)};function sn(Dt){function ct(bt,dt){if(!(this instanceof ct))return new ct(bt,dt);Object.defineProperty(this,"message",{get:function(){return bt}}),Error.captureStackTrace?Error.captureStackTrace(this,ct):Object.defineProperty(this,"stack",{value:new Error().stack||""}),dt&&on(this,dt)}return ct.prototype=Object.create(Error.prototype,{constructor:{value:ct,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return Dt},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),ct}Bt.newError=sn,Bt.ProtocolError=sn("ProtocolError"),Bt.oneOfGetter=function(ct){for(var bt={},dt=0;dt<ct.length;++dt)bt[ct[dt]]=1;return function(){for(var pt=Object.keys(this),Ft=pt.length-1;Ft>-1;--Ft)if(bt[pt[Ft]]===1&&this[pt[Ft]]!==void 0&&this[pt[Ft]]!==null)return pt[Ft]}},Bt.oneOfSetter=function(ct){return function(bt){for(var dt=0;dt<ct.length;++dt)ct[dt]!==bt&&delete this[ct[dt]]}},Bt.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},Bt._configure=function(){var Dt=Bt.Buffer;if(!Dt){Bt._Buffer_from=Bt._Buffer_allocUnsafe=null;return}Bt._Buffer_from=Dt.from!==Uint8Array.from&&Dt.from||function(bt,dt){return new Dt(bt,dt)},Bt._Buffer_allocUnsafe=Dt.allocUnsafe||function(bt){return new Dt(bt)}}}(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=pt;var yn=requireMinimal$1(),Bt,on=yn.LongBits,sn=yn.base64,Dt=yn.utf8;function ct(we,he,Me){this.fn=we,this.len=he,this.next=void 0,this.val=Me}function bt(){}function dt(we){this.head=we.head,this.tail=we.tail,this.len=we.len,this.next=we.states}function pt(){this.len=0,this.head=new ct(bt,0,0),this.tail=this.head,this.states=null}var Ft=function(){return yn.Buffer?function(){return(pt.create=function(){return new Bt})()}:function(){return new pt}};pt.create=Ft(),pt.alloc=function(he){return new yn.Array(he)},yn.Array!==Array&&(pt.alloc=yn.pool(pt.alloc,yn.Array.prototype.subarray)),pt.prototype._push=function(he,Me,nt){return this.tail=this.tail.next=new ct(he,Me,nt),this.len+=Me,this};function It(we,he,Me){he[Me]=we&255}function Ye(we,he,Me){for(;we>127;)he[Me++]=we&127|128,we>>>=7;he[Me]=we}function Te(we,he){this.len=we,this.next=void 0,this.val=he}Te.prototype=Object.create(ct.prototype),Te.prototype.fn=Ye,pt.prototype.uint32=function(he){return this.len+=(this.tail=this.tail.next=new Te((he=he>>>0)<128?1:he<16384?2:he<2097152?3:he<268435456?4:5,he)).len,this},pt.prototype.int32=function(he){return he<0?this._push(E,10,on.fromNumber(he)):this.uint32(he)},pt.prototype.sint32=function(he){return this.uint32((he<<1^he>>31)>>>0)};function E(we,he,Me){for(;we.hi;)he[Me++]=we.lo&127|128,we.lo=(we.lo>>>7|we.hi<<25)>>>0,we.hi>>>=7;for(;we.lo>127;)he[Me++]=we.lo&127|128,we.lo=we.lo>>>7;he[Me++]=we.lo}pt.prototype.uint64=function(he){var Me=on.from(he);return this._push(E,Me.length(),Me)},pt.prototype.int64=pt.prototype.uint64,pt.prototype.sint64=function(he){var Me=on.from(he).zzEncode();return this._push(E,Me.length(),Me)},pt.prototype.bool=function(he){return this._push(It,1,he?1:0)};function w(we,he,Me){he[Me]=we&255,he[Me+1]=we>>>8&255,he[Me+2]=we>>>16&255,he[Me+3]=we>>>24}pt.prototype.fixed32=function(he){return this._push(w,4,he>>>0)},pt.prototype.sfixed32=pt.prototype.fixed32,pt.prototype.fixed64=function(he){var Me=on.from(he);return this._push(w,4,Me.lo)._push(w,4,Me.hi)},pt.prototype.sfixed64=pt.prototype.fixed64,pt.prototype.float=function(he){return this._push(yn.float.writeFloatLE,4,he)},pt.prototype.double=function(he){return this._push(yn.float.writeDoubleLE,8,he)};var Re=yn.Array.prototype.set?function(he,Me,nt){Me.set(he,nt)}:function(he,Me,nt){for(var Ne=0;Ne<he.length;++Ne)Me[nt+Ne]=he[Ne]};return pt.prototype.bytes=function(he){var Me=he.length>>>0;if(!Me)return this._push(It,1,0);if(yn.isString(he)){var nt=pt.alloc(Me=sn.length(he));sn.decode(he,nt,0),he=nt}return this.uint32(Me)._push(Re,Me,he)},pt.prototype.string=function(he){var Me=Dt.length(he);return Me?this.uint32(Me)._push(Dt.write,Me,he):this._push(It,1,0)},pt.prototype.fork=function(){return this.states=new dt(this),this.head=this.tail=new ct(bt,0,0),this.len=0,this},pt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ct(bt,0,0),this.len=0),this},pt.prototype.ldelim=function(){var he=this.head,Me=this.tail,nt=this.len;return this.reset().uint32(nt),nt&&(this.tail.next=he.next,this.tail=Me,this.len+=nt),this},pt.prototype.finish=function(){for(var he=this.head.next,Me=this.constructor.alloc(this.len),nt=0;he;)he.fn(he.val,Me,nt),nt+=he.len,he=he.next;return Me},pt._configure=function(we){Bt=we,pt.create=Ft(),Bt._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=on;var yn=requireWriter();(on.prototype=Object.create(yn.prototype)).constructor=on;var Bt=requireMinimal$1();function on(){yn.call(this)}on._configure=function(){on.alloc=Bt._Buffer_allocUnsafe,on.writeBytesBuffer=Bt.Buffer&&Bt.Buffer.prototype instanceof Uint8Array&&Bt.Buffer.prototype.set.name==="set"?function(ct,bt,dt){bt.set(ct,dt)}:function(ct,bt,dt){if(ct.copy)ct.copy(bt,dt,0,ct.length);else for(var pt=0;pt<ct.length;)bt[dt++]=ct[pt++]}},on.prototype.bytes=function(ct){Bt.isString(ct)&&(ct=Bt._Buffer_from(ct,"base64"));var bt=ct.length>>>0;return this.uint32(bt),bt&&this._push(on.writeBytesBuffer,bt,ct),this};function sn(Dt,ct,bt){Dt.length<40?Bt.utf8.write(Dt,ct,bt):ct.utf8Write?ct.utf8Write(Dt,bt):ct.write(Dt,bt)}return on.prototype.string=function(ct){var bt=Bt.Buffer.byteLength(ct);return this.uint32(bt),bt&&this._push(sn,bt,ct),this},on._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=ct;var yn=requireMinimal$1(),Bt,on=yn.LongBits,sn=yn.utf8;function Dt(Ye,Te){return RangeError("index out of range: "+Ye.pos+" + "+(Te||1)+" > "+Ye.len)}function ct(Ye){this.buf=Ye,this.pos=0,this.len=Ye.length}var bt=typeof Uint8Array<"u"?function(Te){if(Te instanceof Uint8Array||Array.isArray(Te))return new ct(Te);throw Error("illegal buffer")}:function(Te){if(Array.isArray(Te))return new ct(Te);throw Error("illegal buffer")},dt=function(){return yn.Buffer?function(E){return(ct.create=function(Re){return yn.Buffer.isBuffer(Re)?new Bt(Re):bt(Re)})(E)}:bt};ct.create=dt(),ct.prototype._slice=yn.Array.prototype.subarray||yn.Array.prototype.slice,ct.prototype.uint32=function(){var Te=4294967295;return function(){if(Te=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(Te=(Te|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(Te=(Te|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(Te=(Te|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(Te=(Te|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return Te;if((this.pos+=5)>this.len)throw this.pos=this.len,Dt(this,10);return Te}}(),ct.prototype.int32=function(){return this.uint32()|0},ct.prototype.sint32=function(){var Te=this.uint32();return Te>>>1^-(Te&1)|0};function pt(){var Ye=new on(0,0),Te=0;if(this.len-this.pos>4){for(;Te<4;++Te)if(Ye.lo=(Ye.lo|(this.buf[this.pos]&127)<<Te*7)>>>0,this.buf[this.pos++]<128)return Ye;if(Ye.lo=(Ye.lo|(this.buf[this.pos]&127)<<28)>>>0,Ye.hi=(Ye.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return Ye;Te=0}else{for(;Te<3;++Te){if(this.pos>=this.len)throw Dt(this);if(Ye.lo=(Ye.lo|(this.buf[this.pos]&127)<<Te*7)>>>0,this.buf[this.pos++]<128)return Ye}return Ye.lo=(Ye.lo|(this.buf[this.pos++]&127)<<Te*7)>>>0,Ye}if(this.len-this.pos>4){for(;Te<5;++Te)if(Ye.hi=(Ye.hi|(this.buf[this.pos]&127)<<Te*7+3)>>>0,this.buf[this.pos++]<128)return Ye}else for(;Te<5;++Te){if(this.pos>=this.len)throw Dt(this);if(Ye.hi=(Ye.hi|(this.buf[this.pos]&127)<<Te*7+3)>>>0,this.buf[this.pos++]<128)return Ye}throw Error("invalid varint encoding")}ct.prototype.bool=function(){return this.uint32()!==0};function Ft(Ye,Te){return(Ye[Te-4]|Ye[Te-3]<<8|Ye[Te-2]<<16|Ye[Te-1]<<24)>>>0}ct.prototype.fixed32=function(){if(this.pos+4>this.len)throw Dt(this,4);return Ft(this.buf,this.pos+=4)},ct.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Dt(this,4);return Ft(this.buf,this.pos+=4)|0};function It(){if(this.pos+8>this.len)throw Dt(this,8);return new on(Ft(this.buf,this.pos+=4),Ft(this.buf,this.pos+=4))}return ct.prototype.float=function(){if(this.pos+4>this.len)throw Dt(this,4);var Te=yn.float.readFloatLE(this.buf,this.pos);return this.pos+=4,Te},ct.prototype.double=function(){if(this.pos+8>this.len)throw Dt(this,4);var Te=yn.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,Te},ct.prototype.bytes=function(){var Te=this.uint32(),E=this.pos,w=this.pos+Te;if(w>this.len)throw Dt(this,Te);if(this.pos+=Te,Array.isArray(this.buf))return this.buf.slice(E,w);if(E===w){var Re=yn.Buffer;return Re?Re.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,E,w)},ct.prototype.string=function(){var Te=this.bytes();return sn.read(Te,0,Te.length)},ct.prototype.skip=function(Te){if(typeof Te=="number"){if(this.pos+Te>this.len)throw Dt(this,Te);this.pos+=Te}else do if(this.pos>=this.len)throw Dt(this);while(this.buf[this.pos++]&128);return this},ct.prototype.skipType=function(Ye){switch(Ye){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(Ye=this.uint32()&7)!==4;)this.skipType(Ye);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+Ye+" at offset "+this.pos)}return this},ct._configure=function(Ye){Bt=Ye,ct.create=dt(),Bt._configure();var Te=yn.Long?"toLong":"toNumber";yn.merge(ct.prototype,{int64:function(){return pt.call(this)[Te](!1)},uint64:function(){return pt.call(this)[Te](!0)},sint64:function(){return pt.call(this).zzDecode()[Te](!1)},fixed64:function(){return It.call(this)[Te](!0)},sfixed64:function(){return It.call(this)[Te](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=on;var yn=requireReader();(on.prototype=Object.create(yn.prototype)).constructor=on;var Bt=requireMinimal$1();function on(sn){yn.call(this,sn)}return on._configure=function(){Bt.Buffer&&(on.prototype._slice=Bt.Buffer.prototype.slice)},on.prototype.string=function(){var Dt=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+Dt,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+Dt,this.len))},on._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=Bt;var yn=requireMinimal$1();(Bt.prototype=Object.create(yn.EventEmitter.prototype)).constructor=Bt;function Bt(on,sn,Dt){if(typeof on!="function")throw TypeError("rpcImpl must be a function");yn.EventEmitter.call(this),this.rpcImpl=on,this.requestDelimited=!!sn,this.responseDelimited=!!Dt}return Bt.prototype.rpcCall=function on(sn,Dt,ct,bt,dt){if(!bt)throw TypeError("request must be specified");var pt=this;if(!dt)return yn.asPromise(on,pt,sn,Dt,ct,bt);if(!pt.rpcImpl){setTimeout(function(){dt(Error("already ended"))},0);return}try{return pt.rpcImpl(sn,Dt[pt.requestDelimited?"encodeDelimited":"encode"](bt).finish(),function(It,Ye){if(It)return pt.emit("error",It,sn),dt(It);if(Ye===null){pt.end(!0);return}if(!(Ye instanceof ct))try{Ye=ct[pt.responseDelimited?"decodeDelimited":"decode"](Ye)}catch(Te){return pt.emit("error",Te,sn),dt(Te)}return pt.emit("data",Ye,sn),dt(null,Ye)})}catch(Ft){pt.emit("error",Ft,sn),setTimeout(function(){dt(Ft)},0);return}},Bt.prototype.end=function(sn){return this.rpcImpl&&(sn||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(yn){var Bt=yn;Bt.Service=requireService()}(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(yn){var Bt=yn;Bt.build="minimal",Bt.Writer=requireWriter(),Bt.BufferWriter=requireWriter_buffer(),Bt.Reader=requireReader(),Bt.BufferReader=requireReader_buffer(),Bt.util=requireMinimal$1(),Bt.rpc=requireRpc(),Bt.roots=requireRoots(),Bt.configure=on;function on(){Bt.util._configure(),Bt.Writer._configure(Bt.BufferWriter),Bt.Reader._configure(Bt.BufferReader)}on()}(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var ZegoExpressLogger={exports:{}},hasRequiredZegoExpressLogger;function requireZegoExpressLogger(){return hasRequiredZegoExpressLogger||(hasRequiredZegoExpressLogger=1,function(yn,Bt){((on,sn)=>{yn.exports=sn(requireMinimal(),requireUmd())})(typeof self<"u"?self:commonjsGlobal,function(on,sn){return ct=[function(dt,pt){dt.exports=on},function(dt,pt){dt.exports=sn},function(dt,rr,wi){wi.r(rr),wi.d(rr,"ZegoLogger",function(){return bo}),wi.d(rr,"ZegoDataReport",function(){return W}),wi.d(rr,"createZegoWebSocket",function(){return nt}),wi.d(rr,"LoggerStateCenter",function(){return Te}),E.getInstance=function(){return E.instance||(E.instance=new E).u(),E.instance},E.prototype.u=function(){},Object.defineProperty(E.prototype,"testEnvironment",{get:function(){return this.h},set:function(d){this.h=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"ENV",{get:function(){return this.v},set:function(d){this.v=d},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"debug",{get:function(){return this._},set:function(d){this._=d},enumerable:!1,configurable:!0}),E.instance=new E;var It,Ye,Te=E;function E(){this.h=!1,this.v=0,this._=!1}(rr=jr=jr||{})[rr.IE=0]="IE",rr[rr.FIREFOX=1]="FIREFOX",rr[rr.CHROME=2]="CHROME",rr[rr.SAFARI=3]="SAFARI",rr[rr.OPERA=4]="OPERA",rr[rr.WEIXIN=5]="WEIXIN",rr[rr.WEIXINMINI=6]="WEIXINMINI",rr[rr.UNKOWN=7]="UNKOWN",(jr=It=It||{})[jr.BROWSER=0]="BROWSER",jr[jr.WEIXINMINI=1]="WEIXINMINI",(rr=Ye=Ye||{})[rr.DISABLE=0]="DISABLE",rr[rr.WEBSOCKET=1]="WEBSOCKET",rr[rr.HTTPS=2]="HTTPS";var w,Re,we={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},he=((jr=w=w||{})[jr.IPv4Only=0]="IPv4Only",jr[jr.IPv4Prefer=1]="IPv4Prefer",jr[jr.IPv6Prefer=2]="IPv6Prefer",(rr=Re=Re||{})[rr.offline=0]="offline",rr[rr.online=1]="online",Me.prototype.init=function(){var d=this;this.g&&(this.readyState=0,this.g.onOpen(function(g){d.readyState=d.g.readyState,typeof d.onopen=="function"&&(d.onopen(g),d.g.onClose(function(p){d.readyState=d.g.readyState,typeof d.onclose=="function"&&d.onclose(p)}),d.g.onMessage(function(p){typeof d.onmessage=="function"&&d.onmessage(p)}))}),this.g.onError(function(g){d.readyState=d.g.readyState,typeof d.onerror=="function"&&d.onerror(g)}))},Me.prototype.onopen=function(d){},Me.prototype.onerror=function(d){},Me.prototype.onclose=function(d){},Me.prototype.onmessage=function(d){},Me.prototype.send=function(d){this.g&&this.g.send({data:d})},Me.prototype.close=function(){this.g&&this.g.close()},Me);function Me(d,g){this.url=d,this.readyState=3,this.init()}function nt(d,g,p){return g%2===It.BROWSER?(g=d,(p=p)?p.createSocket(g,1):new WebSocket(g)):new he(d)}var Ne=function(){return(Ne=Object.assign||function(d){for(var g,p=1,O=arguments.length;p<O;p++)for(var I in g=arguments[p])Object.prototype.hasOwnProperty.call(g,I)&&(d[I]=g[I]);return d}).apply(this,arguments)},W=(Q.prototype.newReport=function(d,g){this.dataStatistics[d]={event_time:Date.now(),time_consumed:0,seq:d,error:0,message:"success",event:g,events:[]}},Q.prototype.addMsgExt=function(d,g){this.dataStatistics[d]?this.dataStatistics[d].msg_ext=g:console.warn("".concat(d," not exist"))},Q.prototype.addMsgInfo=function(d,g){this.dataStatistics[d]?Object.assign(this.dataStatistics[d],g):console.warn("".concat(d," not exist"))},Q.prototype.eventStart=function(d,g){this.dataStatistics[d]?this.dataStatistics[d].events==null?this.logger.warn("zd.es.0 no events"):this.dataStatistics[d].events.push({event:g,event_time:Date.now(),time_consumed:0}):this.logger.warn("zd.es.0 no seq match")},Q.prototype.eventEnd=function(d,g,p){if(this.dataStatistics[d]){var O=this.dataStatistics[d].events;if(O&&O.length!==0){for(var I=O.length-1;0<=I;I--)if(O[I].event==g&&O[I].time_consumed==0){O[I].time_consumed=Date.now()-O[I].event_time;break}}else this.logger.info("zd.ee.0 no events")}else this.logger.info("zd.ee.0 no seq match")},Q.prototype.eventEndWithMsg=function(d,g,p){if(this.dataStatistics[d]){var O=this.dataStatistics[d].events;if(O){for(var I=O.length-1;0<=I;I--)if(O[I].event==g&&O[I].time_consumed==0){O[I].time_consumed=Date.now()-O[I].event_time,O[I].msg_ext==null&&(O[I].msg_ext={}),O[I].msg_ext=Ne({},p);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},Q.prototype.eventEndWithMsgInfo=function(d,g,p){if(this.dataStatistics[d]){var O=this.dataStatistics[d].events;if(O){for(var I=O.length-1;0<=I;I--)if(O[I].event==g&&O[I].time_consumed==0){O[I].time_consumed=Date.now()-O[I].event_time,Object.assign(O[I],p);break}}else this.logger.warn("zd.ee.0 no events")}else this.logger.warn("zd.ee.0 no seq match")},Q.prototype.addEventInfo=function(d,g,p,O){if(this.dataStatistics[d]){var I=this.dataStatistics[d].events;if(I==null)this.logger.warn("zd.aei.0 no events");else for(var j=I.length-1;0<=j;j--)if(I[j].event==g&&I[j].time_consumed!=null){I[j].msg_ext==null?I[j].msg_ext={}:I[j].msg_ext&&(I[j].msg_ext[p]=O);break}}else this.logger.warn("zd.aei.0 no seq match")},Q.prototype.addEventMsg=function(d,g,p,O){if(this.dataStatistics[d]){var I=this.dataStatistics[d].events;if(I==null)this.logger.warn("zd.aem.0 no events");else for(var j=I.length-1;0<=j;j--)if(I[j].event==g){I[j][p]=O;break}}else this.logger.warn("zd.aem.0 no seq match")},Q.prototype.addEvent=function(d,g,p){this.dataStatistics[d]?this.dataStatistics[d].events&&(p?this.dataStatistics[d].events.push({event:g,event_time:Date.now(),msg_ext:p}):this.dataStatistics[d].events.push({event:g,event_time:Date.now()})):this.logger.warn("zd.ae.0 no seq match")},Q.prototype.uploadReport=function(d,g,p,O){var I=this.dataStatistics[d];I!=null&&(g&&(I.event=g),I.time_consumed=Date.now()-I.event_time,p&&this.addMsgInfo(d,{error:p.code,message:p.message||p.msg+" "+(O||"")}),this.logger.report(I),delete this.dataStatistics[d])},Q);function Q(d){this.dataStatistics={},this.logger=d}var se,J=["00","01","02","03","04","05","06","07","08","09"];function G(){var d=new Date;return[d.getFullYear()+"/",(J[d.getMonth()+1]||d.getMonth()+1)+"/",(J[d.getDate()]||d.getDate())+" ",(J[d.getHours()]||d.getHours())+":",(J[d.getMinutes()]||d.getMinutes())+":",J[d.getSeconds()]||d.getSeconds(),"."+(""+d.getTime()).slice(-3)].join("")}(jr=se=se||{}).WEBSOCKET_STATE_CHANGE="zl.net.wsc",jr.OPEN_WS="zl.net.opws";var U=wi(0),rr=wi(1);(U=U.default||U).util.Long=rr.default||rr,U.util.Long.fromBits=U.util.Long.fromBits||function(){return 0};for(var C=U.roots,N=U.types?U.types.basic:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0,string:2,bytes:2},v=U.types?U.types.packed:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0},f=Object.keys(N),_={$:function(d){return _[d]?_[d].call(this):C[d].decode?C[d].decode(this,this.uint32()):_.$.call(this,"int32")}},b={$:function(d,g,p){var O=N[d];return O===void 0?C[d].encode?(this.uint32((p<<3|2)>>0).fork(),C[d].encode(g,this).ldelim()):b.$.call(this,"int32",g,p):b[d].call(this.uint32(p<<3|O),g)}},y=0;y<f.length;y++)_[f[y]]=U.Reader.prototype[f[y]],b[f[y]]=U.Writer.prototype[f[y]];(function d(g,p,O,I){for(var j=0,je=Object.keys(g);j<je.length;j++){var Be=je[j];if(g[Be].$m&&Object.keys(g[Be].$m).every(function(rt){return Number(rt)})){if(O[Be])throw Error(`nested type ${O}.${Be} has already exist`);O[Be]=((rt,qe)=>{function re(Xt){for(var tn in rt)tn=rt[tn],tn[1].charAt(0)==="{"?this[tn[0]]={}:tn[1].charAt(0)!=="["&&tn[1].charAt(0)!=="<"||(this[tn[0]]=[]);if(Xt)for(var dn=Object.keys(Xt),gn=0;gn<dn.length;++gn)Xt[dn[gn]]!=null&&(this[dn[gn]]=Xt[dn[gn]])}var Rt,Ht={};for(Rt in rt){var xt=rt[Rt],En=xt[1];En.charAt(0)==="{"?(re.prototype[xt[0]]=U.util.emptyObject,Ht[En]={$m:En.substring(1).split(",").map(function(Xt,tn){return["$"+(tn+1),Xt,null]}).reduce(function(Xt,tn,dn){return Xt[dn+1]=tn,Xt},{})}):En.charAt(0)==="["||En.charAt(0)==="<"?re.prototype[xt[0]]=U.util.emptyArray:En==="bytes"?re.prototype[xt[0]]=U.util.newBuffer([]):xt[2]&&xt[2].hasOwnProperty("low")&&xt[2].hasOwnProperty("high")?re.prototype[xt[0]]=U.util.Long.fromBits(xt[2].low,xt[2].high,xt[2].unsigned):re.prototype[xt[0]]=xt[2]}return re.create=function(Xt){return new re(Xt)},re.decode=function(Xt,tn){Xt instanceof U.Reader||(Xt=U.Reader.create(Xt));for(var dn=tn===void 0?Xt.len:Xt.pos+tn,gn=new re;Xt.pos<dn;){var wn=Xt.uint32(),Gn=wn>>>3;if(0<Gn&&rt[Gn]){var Er=rt[Gn][0];if(($n=rt[Gn][1]).charAt(0)==="{")gn[Er]===U.util.emptyObject&&(gn[Er]={}),Gn=re.$namespace[$n].decode(Xt,Xt.uint32()),gn[Er][Gn.$1]=Gn.$2;else if($n.charAt(0)==="["||$n.charAt(0)==="<"){$n=$n.substring(1),gn[Er]&&gn[Er].length||(gn[Er]=[]);var $n,Gn=!_[$n]&&!C[$n].decode;if(v[$n=Gn?"int32":$n]!==void 0&&(7&wn)==2)for(var Un=Xt.uint32()+Xt.pos;Xt.pos<Un;)gn[Er].push(_.$.call(Xt,$n));else gn[Er].push(_.$.call(Xt,$n))}else gn[Er]=_.$.call(Xt,$n)}else Xt.skipType(7&wn)}return gn},re.encode=function(Xt,tn){for(var dn in tn=tn||U.Writer.create(),rt){var gn=rt[dn][0];if((Un=rt[dn][1]).charAt(0)==="{"){if(Xt[gn]!=null&&Xt.hasOwnProperty(gn))for(var wn=0,Gn=Object.keys(Xt[gn]);wn<Gn.length;++wn)tn.uint32((dn<<3|2)>>0).fork(),re.$namespace[Un].encode({$1:Gn[wn],$2:Xt[gn][Gn[wn]]},tn).ldelim()}else if(Un.charAt(0)==="["||Un.charAt(0)==="<"){var Er=Un.charAt(0)==="<",$n=(Un=Un.substring(1),Xt[gn]);if($n!=null&&$n.length){var Un=N[Un]===void 0&&!C[Un].encode?"int32":Un;if(Er&&v[Un]!==void 0){for(tn.uint32((dn<<3|2)>>0).fork(),wn=0;wn<$n.length;wn++)b[Un].call(tn,$n[wn]);tn.ldelim()}else for(wn=0;wn<$n.length;wn++)b.$.call(tn,Un,$n[wn],dn)}}else Xt[gn]!=null&&Xt.hasOwnProperty(gn)&&b.$.call(tn,Un,Xt[gn],dn)}return tn},Object.keys(Ht).length&&(re.$namespace=d(Ht,p+"."+qe,re.$namespace||{},!0)),re})(g[Be].$m,Be)}else g[Be].$s?O[Be]=((rt,qe)=>{function re(Rt,Ht,xt){U.rpc.Service.call(this,Rt,Ht,xt)}return((re.prototype=Object.create(U.rpc.Service.prototype)).constructor=re).create=function(Rt,Ht,xt){return new re(Rt,Ht,xt)},Object.keys(rt).forEach(function(Rt){var Ht=rt[Rt];function xt(En,Xt){return this.rpcCall(xt,C[Ht[0]],C[Ht[1]],En,Xt)}Object.defineProperty(xt,"name",{value:Rt}),Object.defineProperty(xt,"path",{value:p+"."+qe}),re.prototype[Rt]=xt}),re})(g[Be].$s,Be):g[Be].$e&&Object.values(g[Be].$e).every(function(rt){return Number(rt)===rt})&&(O[Be]=(rt=>{for(var qe=Object.keys(rt),re={},Rt=0;Rt<qe.length;Rt++)re[re[qe[Rt]]=rt[qe[Rt]]]=qe[Rt];return re})(g[Be].$e));O[Be]&&!I&&(C[p+"."+Be]=O[Be]),delete g[Be].$m,delete g[Be].$s,delete g[Be].$e,O[Be]=d(g[Be],p?p+"."+Be:Be,O[Be]||{})}return O})({report:{rtcreport:{DetailLogRequest:{$m:{1:["appid","uint32",0],2:["product","uint32",0],3:["id_name","string",""],4:["timestamp","uint64",{low:0,high:0,unsigned:!0}],5:["litesign","string",""],6:["detail_data","bytes",[]]}},DetailLogResponse:{$m:{1:["code","uint32",0]}}}}},"",C,!1);var M=C.report;let Y=0,L=1;function A(d){let g=d.length;for(;0<=--g;)d[g]=0}let H=29,ge=256,Ee=ge+1+H,Se=30,ue=19,oe=2*Ee+1,be=15,Le=16,pe=7,k=256,R=16,Fe=17,te=18,Ue=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),it=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ee=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),ae=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xe=new Array(2*(Ee+2)),Z=(A(xe),new Array(2*Se)),$=(A(Z),new Array(512)),K=(A($),new Array(256)),X=(A(K),new Array(H)),B=(A(X),new Array(Se));function fe(d,g,p,O,I){this.static_tree=d,this.extra_bits=g,this.extra_base=p,this.elems=O,this.max_length=I,this.has_stree=d&&d.length}A(B);let Ce,Ze,st;function Ie(d,g){this.dyn_tree=d,this.max_code=0,this.stat_desc=g}let D=d=>d<256?$[d]:$[256+(d>>>7)],me=(d,g)=>{d.pending_buf[d.pending++]=255&g,d.pending_buf[d.pending++]=g>>>8&255},ce=(d,g,p)=>{d.bi_valid>Le-p?(d.bi_buf|=g<<d.bi_valid&65535,me(d,d.bi_buf),d.bi_buf=g>>Le-d.bi_valid,d.bi_valid+=p-Le):(d.bi_buf|=g<<d.bi_valid&65535,d.bi_valid+=p)},le=(d,g,p)=>{ce(d,p[2*g],p[2*g+1])},et=(d,g)=>{let p=0;for(;p|=1&d,d>>>=1,p<<=1,0<--g;);return p>>>1},ze=(d,g)=>{var p,O=g.dyn_tree,I=g.max_code,j=g.stat_desc.static_tree,je=g.stat_desc.has_stree,Be=g.stat_desc.extra_bits,rt=g.stat_desc.extra_base,qe=g.stat_desc.max_length;let re,Rt,Ht,xt,En,Xt=0;for(xt=0;xt<=be;xt++)d.bl_count[xt]=0;for(O[2*d.heap[d.heap_max]+1]=0,re=d.heap_max+1;re<oe;re++)Rt=d.heap[re],(xt=O[2*O[2*Rt+1]+1]+1)>qe&&(xt=qe,Xt++),O[2*Rt+1]=xt,Rt>I||(d.bl_count[xt]++,En=0,Rt>=rt&&(En=Be[Rt-rt]),p=O[2*Rt],d.opt_len+=p*(xt+En),je&&(d.static_len+=p*(j[2*Rt+1]+En)));if(Xt!==0){do for(xt=qe-1;d.bl_count[xt]===0;)xt--;while(d.bl_count[xt]--,d.bl_count[xt+1]+=2,d.bl_count[qe]--,0<(Xt-=2));for(xt=qe;xt!==0;xt--)for(Rt=d.bl_count[xt];Rt!==0;)I<(Ht=d.heap[--re])||(O[2*Ht+1]!==xt&&(d.opt_len+=(xt-O[2*Ht+1])*O[2*Ht],O[2*Ht+1]=xt),Rt--)}},ft=(d,g,p)=>{var O=new Array(be+1);let I=0,j,je;for(j=1;j<=be;j++)I=I+p[j-1]<<1,O[j]=I;for(je=0;je<=g;je++){var Be=d[2*je+1];Be!==0&&(d[2*je]=et(O[Be]++,Be))}},_t=d=>{let g;for(g=0;g<Ee;g++)d.dyn_ltree[2*g]=0;for(g=0;g<Se;g++)d.dyn_dtree[2*g]=0;for(g=0;g<ue;g++)d.bl_tree[2*g]=0;d.dyn_ltree[2*k]=1,d.opt_len=d.static_len=0,d.sym_next=d.matches=0},mt=d=>{8<d.bi_valid?me(d,d.bi_buf):0<d.bi_valid&&(d.pending_buf[d.pending++]=d.bi_buf),d.bi_buf=0,d.bi_valid=0},Ve=(d,g,p,O)=>{var I=2*g,j=2*p;return d[I]<d[j]||d[I]===d[j]&&O[g]<=O[p]},Ot=(d,g,p)=>{var O=d.heap[p];let I=p<<1;for(;I<=d.heap_len&&(I<d.heap_len&&Ve(g,d.heap[I+1],d.heap[I],d.depth)&&I++,!Ve(g,O,d.heap[I],d.depth));)d.heap[p]=d.heap[I],p=I,I<<=1;d.heap[p]=O},rn=(d,g,p)=>{var O,I,j,je;let Be=0;if(d.sym_next!==0)for(;O=255&d.pending_buf[d.sym_buf+Be++],O+=(255&d.pending_buf[d.sym_buf+Be++])<<8,I=d.pending_buf[d.sym_buf+Be++],O==0?le(d,I,g):(j=K[I],le(d,j+ge+1,g),(je=Ue[j])!==0&&(I-=X[j],ce(d,I,je)),O--,j=D(O),le(d,j,p),(je=it[j])!==0&&(O-=B[j],ce(d,O,je))),Be<d.sym_next;);le(d,k,g)},an=(d,g)=>{var p=g.dyn_tree,O=g.stat_desc.static_tree,I=g.stat_desc.has_stree,j=g.stat_desc.elems;let je,Be,rt=-1,qe;for(d.heap_len=0,d.heap_max=oe,je=0;je<j;je++)p[2*je]!==0?(d.heap[++d.heap_len]=rt=je,d.depth[je]=0):p[2*je+1]=0;for(;d.heap_len<2;)p[2*(qe=d.heap[++d.heap_len]=rt<2?++rt:0)]=1,d.depth[qe]=0,d.opt_len--,I&&(d.static_len-=O[2*qe+1]);for(g.max_code=rt,je=d.heap_len>>1;1<=je;je--)Ot(d,p,je);for(qe=j;je=d.heap[1],d.heap[1]=d.heap[d.heap_len--],Ot(d,p,1),Be=d.heap[1],d.heap[--d.heap_max]=je,d.heap[--d.heap_max]=Be,p[2*qe]=p[2*je]+p[2*Be],d.depth[qe]=(d.depth[je]>=d.depth[Be]?d.depth[je]:d.depth[Be])+1,p[2*je+1]=p[2*Be+1]=qe,d.heap[1]=qe++,Ot(d,p,1),2<=d.heap_len;);d.heap[--d.heap_max]=d.heap[1],ze(d,g),ft(p,rt,d.bl_count)},In=(d,g,p)=>{let O,I=-1;var j;let je=g[1],Be=0,rt=7,qe=4;for(je===0&&(rt=138,qe=3),g[2*(p+1)+1]=65535,O=0;O<=p;O++)j=je,je=g[2*(O+1)+1],++Be<rt&&j===je||(Be<qe?d.bl_tree[2*j]+=Be:j!==0?(j!==I&&d.bl_tree[2*j]++,d.bl_tree[2*R]++):Be<=10?d.bl_tree[2*Fe]++:d.bl_tree[2*te]++,Be=0,I=j,qe=je===0?(rt=138,3):j===je?(rt=6,3):(rt=7,4))},Tn=(d,g,p)=>{let O,I=-1;var j;let je=g[1],Be=0,rt=7,qe=4;for(je===0&&(rt=138,qe=3),O=0;O<=p;O++)if(j=je,je=g[2*(O+1)+1],!(++Be<rt&&j===je)){if(Be<qe)for(;le(d,j,d.bl_tree),--Be!=0;);else j!==0?(j!==I&&(le(d,j,d.bl_tree),Be--),le(d,R,d.bl_tree),ce(d,Be-3,2)):Be<=10?(le(d,Fe,d.bl_tree),ce(d,Be-3,3)):(le(d,te,d.bl_tree),ce(d,Be-11,7));Be=0,I=j,qe=je===0?(rt=138,3):j===je?(rt=6,3):(rt=7,4)}},fn=!1,Rr=(d,g,p,O)=>{ce(d,0+(O?1:0),3),mt(d),me(d,p),me(d,~p),p&&d.pending_buf.set(d.window.subarray(g,g+p),d.pending),d.pending+=p};var jr={O:d=>{fn||((()=>{let g,p,O,I,j;var je=new Array(be+1);for(O=0,I=0;I<H-1;I++)for(X[I]=O,g=0;g<1<<Ue[I];g++)K[O++]=I;for(K[O-1]=I,j=0,I=0;I<16;I++)for(B[I]=j,g=0;g<1<<it[I];g++)$[j++]=I;for(j>>=7;I<Se;I++)for(B[I]=j<<7,g=0;g<1<<it[I]-7;g++)$[256+j++]=I;for(p=0;p<=be;p++)je[p]=0;for(g=0;g<=143;)xe[2*g+1]=8,g++,je[8]++;for(;g<=255;)xe[2*g+1]=9,g++,je[9]++;for(;g<=279;)xe[2*g+1]=7,g++,je[7]++;for(;g<=287;)xe[2*g+1]=8,g++,je[8]++;for(ft(xe,Ee+1,je),g=0;g<Se;g++)Z[2*g+1]=5,Z[2*g]=et(g,5);Ce=new fe(xe,Ue,ge+1,Ee,be),Ze=new fe(Z,it,0,Se,be),st=new fe(new Array(0),ee,0,ue,pe)})(),fn=!0),d.l_desc=new Ie(d.dyn_ltree,Ce),d.d_desc=new Ie(d.dyn_dtree,Ze),d.bl_desc=new Ie(d.bl_tree,st),d.bi_buf=0,d.bi_valid=0,_t(d)},S:Rr,k:(d,g,p,O)=>{let I,j,je=0;0<d.level?(d.strm.data_type===2&&(d.strm.data_type=(Be=>{let rt=4093624447,qe;for(qe=0;qe<=31;qe++,rt>>>=1)if(1&rt&&Be.dyn_ltree[2*qe]!==0)return Y;if(Be.dyn_ltree[18]!==0||Be.dyn_ltree[20]!==0||Be.dyn_ltree[26]!==0)return L;for(qe=32;qe<ge;qe++)if(Be.dyn_ltree[2*qe]!==0)return L;return Y})(d)),an(d,d.l_desc),an(d,d.d_desc),je=(Be=>{let rt;for(In(Be,Be.dyn_ltree,Be.l_desc.max_code),In(Be,Be.dyn_dtree,Be.d_desc.max_code),an(Be,Be.bl_desc),rt=ue-1;3<=rt&&Be.bl_tree[2*ae[rt]+1]===0;rt--);return Be.opt_len+=3*(rt+1)+5+5+4,rt})(d),I=d.opt_len+3+7>>>3,(j=d.static_len+3+7>>>3)<=I&&(I=j)):I=j=p+5,p+4<=I&&g!==-1?Rr(d,g,p,O):d.strategy===4||j===I?(ce(d,2+(O?1:0),3),rn(d,xe,Z)):(ce(d,4+(O?1:0),3),((Be,rt,qe,re)=>{let Rt;for(ce(Be,rt-257,5),ce(Be,qe-1,5),ce(Be,re-4,4),Rt=0;Rt<re;Rt++)ce(Be,Be.bl_tree[2*ae[Rt]+1],3);Tn(Be,Be.dyn_ltree,rt-1),Tn(Be,Be.dyn_dtree,qe-1)})(d,d.l_desc.max_code+1,d.d_desc.max_code+1,je+1),rn(d,d.dyn_ltree,d.dyn_dtree)),_t(d),O&&mt(d)},A:(d,g,p)=>(d.pending_buf[d.sym_buf+d.sym_next++]=g,d.pending_buf[d.sym_buf+d.sym_next++]=g>>8,d.pending_buf[d.sym_buf+d.sym_next++]=p,g===0?d.dyn_ltree[2*p]++:(d.matches++,g--,d.dyn_ltree[2*(K[p]+ge+1)]++,d.dyn_dtree[2*D(g)]++),d.sym_next===d.sym_end),j:d=>{ce(d,2,3),le(d,k,xe),(d=d).bi_valid===16?(me(d,d.bi_buf),d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}},ir=(d,g,p,O)=>{let I=65535&d|0,j=d>>>16&65535|0,je=0;for(;p!==0;){for(p-=je=2e3<p?2e3:p;I=I+g[O++]|0,j=j+I|0,--je;);I%=65521,j%=65521}return I|j<<16|0};let Ln=new Uint32Array((()=>{let d,g=[];for(var p=0;p<256;p++){d=p;for(var O=0;O<8;O++)d=1&d?3988292384^d>>>1:d>>>1;g[p]=d}return g})());var mn=(d,g,p,O)=>{var I=Ln,j=O+p;d^=-1;for(let je=O;je<j;je++)d=d>>>8^I[255&(d^g[je])];return-1^d},Qn={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},wi={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};let{O:Nn,S:or,k:pr,A:sr,j:Wr}=jr,{Z_NO_FLUSH:tr,Z_PARTIAL_FLUSH:zn,Z_FULL_FLUSH:bn,Z_FINISH:Jn,Z_BLOCK:zr,Z_OK:jn,Z_STREAM_END:Lr,Z_STREAM_ERROR:Vr,Z_DATA_ERROR:Ai,Z_BUF_ERROR:Yr,Z_DEFAULT_COMPRESSION:Qr,Z_FILTERED:Ci,Z_HUFFMAN_ONLY:Si,Z_RLE:ri,Z_FIXED:fr,Z_DEFAULT_STRATEGY:Yn,Z_UNKNOWN:yi,Z_DEFLATED:dr}=wi,ii=9,kn=286,nr=30,Fn=19,_r=2*kn+1,P=15,He=3,de=258,ne=de+He+1,De=42,ye=57,Qe=69,Ke=73,$e=91,at=103,ht=113,Ct=666,St=1,kt=2,Ut=3,Lt=4,cn=(d,g)=>(d.msg=Qn[g],g),_n=d=>2*d-(4<d?9:0),vn=d=>{let g=d.length;for(;0<=--g;)d[g]=0},xn=d=>{let g,p,O;var I=d.w_size;for(g=d.hash_size,O=g;p=d.head[--O],d.head[O]=p>=I?p-I:0,--g;);for(g=I,O=g;p=d.prev[--O],d.prev[O]=p>=I?p-I:0,--g;);},An=(d,g,p)=>(g<<d.hash_shift^p)&d.hash_mask,Zn=d=>{var g=d.state;let p=g.pending;(p=p>d.avail_out?d.avail_out:p)!==0&&(d.output.set(g.pending_buf.subarray(g.pending_out,g.pending_out+p),d.next_out),d.next_out+=p,g.pending_out+=p,d.total_out+=p,d.avail_out-=p,g.pending-=p,g.pending===0)&&(g.pending_out=0)},Kn=(d,g)=>{pr(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,g),d.block_start=d.strstart,Zn(d.strm)},Bn=(d,g)=>{d.pending_buf[d.pending++]=g},Jr=(d,g)=>{d.pending_buf[d.pending++]=g>>>8&255,d.pending_buf[d.pending++]=255&g},ui=(d,g,p,O)=>{let I=d.avail_in;return(I=I>O?O:I)===0?0:(d.avail_in-=I,g.set(d.input.subarray(d.next_in,d.next_in+I),p),d.state.wrap===1?d.adler=ir(d.adler,g,I,p):d.state.wrap===2&&(d.adler=mn(d.adler,g,I,p)),d.next_in+=I,d.total_in+=I,I)},Zr=(d,g)=>{let p=d.max_chain_length,O=d.strstart,I;var j;let je=d.prev_length,Be=d.nice_match;var rt=d.strstart>d.w_size-ne?d.strstart-(d.w_size-ne):0,qe=d.window,re=d.w_mask,Rt=d.prev,Ht=d.strstart+de;let xt=qe[O+je-1],En=qe[O+je];d.good_match<=d.prev_length&&(p>>=2),Be>d.lookahead&&(Be=d.lookahead);do if(qe[(I=g)+je]===En&&qe[I+je-1]===xt&&qe[I]===qe[O]&&qe[++I]===qe[O+1]){for(O+=2,I++;qe[++O]===qe[++I]&&qe[++O]===qe[++I]&&qe[++O]===qe[++I]&&qe[++O]===qe[++I]&&qe[++O]===qe[++I]&&qe[++O]===qe[++I]&&qe[++O]===qe[++I]&&qe[++O]===qe[++I]&&O<Ht;);if(j=de-(Ht-O),O=Ht-de,j>je){if(d.match_start=g,(je=j)>=Be)break;xt=qe[O+je-1],En=qe[O+je]}}while((g=Rt[g&re])>rt&&--p!=0);return je<=d.lookahead?je:d.lookahead},kr=d=>{var g=d.w_size;let p,O,I;do{if(O=d.window_size-d.lookahead-d.strstart,d.strstart>=g+(g-ne)&&(d.window.set(d.window.subarray(g,g+g-O),0),d.match_start-=g,d.strstart-=g,d.block_start-=g,d.strstart<d.insert&&(d.insert=d.strstart),xn(d),O+=g),d.strm.avail_in===0)break;if(p=ui(d.strm,d.window,d.strstart+d.lookahead,O),d.lookahead+=p,d.lookahead+d.insert>=He)for(I=d.strstart-d.insert,d.ins_h=d.window[I],d.ins_h=An(d,d.ins_h,d.window[I+1]);d.insert&&(d.ins_h=An(d,d.ins_h,d.window[I+He-1]),d.prev[I&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=I,I++,d.insert--,!(d.lookahead+d.insert<He)););}while(d.lookahead<ne&&d.strm.avail_in!==0)},Fr=(d,g)=>{let p=d.pending_buf_size-5>d.w_size?d.w_size:d.pending_buf_size-5,O,I,j,je=0;for(var Be=d.strm.avail_in;O=65535,j=d.bi_valid+42>>3,!(d.strm.avail_out<j||(j=d.strm.avail_out-j,I=d.strstart-d.block_start,(O=(O=O>I+d.strm.avail_in?I+d.strm.avail_in:O)>j?j:O)<p&&(O===0&&g!==Jn||g===tr||O!==I+d.strm.avail_in))||(je=g===Jn&&O===I+d.strm.avail_in?1:0,or(d,0,0,je),d.pending_buf[d.pending-4]=O,d.pending_buf[d.pending-3]=O>>8,d.pending_buf[d.pending-2]=~O,d.pending_buf[d.pending-1]=~O>>8,Zn(d.strm),I&&(I>O&&(I=O),d.strm.output.set(d.window.subarray(d.block_start,d.block_start+I),d.strm.next_out),d.strm.next_out+=I,d.strm.avail_out-=I,d.strm.total_out+=I,d.block_start+=I,O-=I),O&&(ui(d.strm,d.strm.output,d.strm.next_out,O),d.strm.next_out+=O,d.strm.avail_out-=O,d.strm.total_out+=O),je!==0)););return(Be-=d.strm.avail_in)&&(Be>=d.w_size?(d.matches=2,d.window.set(d.strm.input.subarray(d.strm.next_in-d.w_size,d.strm.next_in),0),d.strstart=d.w_size,d.insert=d.strstart):(d.window_size-d.strstart<=Be&&(d.strstart-=d.w_size,d.window.set(d.window.subarray(d.w_size,d.w_size+d.strstart),0),d.matches<2&&d.matches++,d.strstart<d.insert)&&(d.insert=d.strstart),d.window.set(d.strm.input.subarray(d.strm.next_in-Be,d.strm.next_in),d.strstart),d.strstart+=Be,d.insert+=d.w_size-d.insert<Be?d.w_size-d.insert:Be),d.block_start=d.strstart),d.high_water<d.strstart&&(d.high_water=d.strstart),je?Lt:g!==tr&&g!==Jn&&d.strm.avail_in===0&&d.strstart===d.block_start?kt:(j=d.window_size-d.strstart,d.strm.avail_in>j&&d.block_start>=d.w_size&&(d.block_start-=d.w_size,d.strstart-=d.w_size,d.window.set(d.window.subarray(d.w_size,d.w_size+d.strstart),0),d.matches<2&&d.matches++,j+=d.w_size,d.strstart<d.insert)&&(d.insert=d.strstart),(j=j>d.strm.avail_in?d.strm.avail_in:j)&&(ui(d.strm,d.window,d.strstart,j),d.strstart+=j,d.insert+=j>d.w_size-d.insert?d.w_size-d.insert:j),d.high_water<d.strstart&&(d.high_water=d.strstart),j=d.bi_valid+42>>3,j=65535<d.pending_buf_size-j?65535:d.pending_buf_size-j,p=j>d.w_size?d.w_size:j,((I=d.strstart-d.block_start)>=p||(I||g===Jn)&&g!==tr&&d.strm.avail_in===0&&I<=j)&&(O=I>j?j:I,je=g===Jn&&d.strm.avail_in===0&&O===I?1:0,or(d,d.block_start,O,je),d.block_start+=O,Zn(d.strm)),je?Ut:St)};rr=(d,g)=>{let p,O;for(;;){if(d.lookahead<ne){if(kr(d),d.lookahead<ne&&g===tr)return St;if(d.lookahead===0)break}if(p=0,d.lookahead>=He&&(d.ins_h=An(d,d.ins_h,d.window[d.strstart+He-1]),p=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),p!==0&&d.strstart-p<=d.w_size-ne&&(d.match_length=Zr(d,p)),d.match_length>=He)if(O=sr(d,d.strstart-d.match_start,d.match_length-He),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=He){for(d.match_length--;d.strstart++,d.ins_h=An(d,d.ins_h,d.window[d.strstart+He-1]),p=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart,--d.match_length!=0;);d.strstart++}else d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=An(d,d.ins_h,d.window[d.strstart+1]);else O=sr(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++;if(O&&(Kn(d,!1),d.strm.avail_out===0))return St}return d.insert=d.strstart<He-1?d.strstart:He-1,g===Jn?(Kn(d,!0),d.strm.avail_out===0?Ut:Lt):d.sym_next&&(Kn(d,!1),d.strm.avail_out===0)?St:kt},jr=(d,g)=>{let p,O;for(var I;;){if(d.lookahead<ne){if(kr(d),d.lookahead<ne&&g===tr)return St;if(d.lookahead===0)break}if(p=0,d.lookahead>=He&&(d.ins_h=An(d,d.ins_h,d.window[d.strstart+He-1]),p=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=He-1,p!==0&&d.prev_length<d.max_lazy_match&&d.strstart-p<=d.w_size-ne&&(d.match_length=Zr(d,p),d.match_length<=5)&&(d.strategy===Ci||d.match_length===He&&4096<d.strstart-d.match_start)&&(d.match_length=He-1),d.prev_length>=He&&d.match_length<=d.prev_length){for(I=d.strstart+d.lookahead-He,O=sr(d,d.strstart-1-d.prev_match,d.prev_length-He),d.lookahead-=d.prev_length-1,d.prev_length-=2;++d.strstart<=I&&(d.ins_h=An(d,d.ins_h,d.window[d.strstart+He-1]),p=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),--d.prev_length!=0;);if(d.match_available=0,d.match_length=He-1,d.strstart++,O&&(Kn(d,!1),d.strm.avail_out===0))return St}else if(d.match_available){if((O=sr(d,0,d.window[d.strstart-1]))&&Kn(d,!1),d.strstart++,d.lookahead--,d.strm.avail_out===0)return St}else d.match_available=1,d.strstart++,d.lookahead--}return d.match_available&&(O=sr(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<He-1?d.strstart:He-1,g===Jn?(Kn(d,!0),d.strm.avail_out===0?Ut:Lt):d.sym_next&&(Kn(d,!1),d.strm.avail_out===0)?St:kt};function qr(d,g,p,O,I){this.good_length=d,this.max_lazy=g,this.nice_length=p,this.max_chain=O,this.func=I}let Sr=[new qr(0,0,0,0,Fr),new qr(4,4,8,4,rr),new qr(4,5,16,8,rr),new qr(4,6,32,32,rr),new qr(4,4,16,16,jr),new qr(8,16,32,32,jr),new qr(8,16,128,128,jr),new qr(8,32,128,256,jr),new qr(32,128,258,1024,jr),new qr(32,258,258,4096,jr)],Dn=d=>{d.window_size=2*d.w_size,vn(d.head),d.max_lazy_match=Sr[d.level].max_lazy,d.good_match=Sr[d.level].good_length,d.nice_match=Sr[d.level].nice_length,d.max_chain_length=Sr[d.level].max_chain,d.strstart=0,d.block_start=0,d.lookahead=0,d.insert=0,d.match_length=d.prev_length=He-1,d.match_available=0,d.ins_h=0};function li(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=dr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*_r),this.dyn_dtree=new Uint16Array(2*(2*nr+1)),this.bl_tree=new Uint16Array(2*(2*Fn+1)),vn(this.dyn_ltree),vn(this.dyn_dtree),vn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(P+1),this.heap=new Uint16Array(2*kn+1),vn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*kn+1),vn(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}let Hr=d=>{var g;return!d||!(g=d.state)||g.strm!==d||g.status!==De&&g.status!==ye&&g.status!==Qe&&g.status!==Ke&&g.status!==$e&&g.status!==at&&g.status!==ht&&g.status!==Ct?1:0},Xr=d=>{if(Hr(d))return cn(d,Vr);d.total_in=d.total_out=0,d.data_type=yi;var g=d.state;return g.pending=0,g.pending_out=0,g.wrap<0&&(g.wrap=-g.wrap),g.status=g.wrap===2?ye:g.wrap?De:ht,d.adler=g.wrap===2?0:1,g.last_flush=-2,Nn(g),jn},z=d=>{var g=Xr(d);return g===jn&&Dn(d.state),g},T=(d,g,p,O,I,j)=>{if(!d)return Vr;let je=1;if(g===Qr&&(g=6),O<0?(je=0,O=-O):15<O&&(je=2,O-=16),I<1||I>ii||p!==dr||O<8||15<O||g<0||9<g||j<0||j>fr||O===8&&je!==1)return cn(d,Vr);O===8&&(O=9);var Be=new li;return(d.state=Be).strm=d,Be.status=De,Be.wrap=je,Be.gzhead=null,Be.w_bits=O,Be.w_size=1<<Be.w_bits,Be.w_mask=Be.w_size-1,Be.hash_bits=I+7,Be.hash_size=1<<Be.hash_bits,Be.hash_mask=Be.hash_size-1,Be.hash_shift=~~((Be.hash_bits+He-1)/He),Be.window=new Uint8Array(2*Be.w_size),Be.head=new Uint16Array(Be.hash_size),Be.prev=new Uint16Array(Be.w_size),Be.lit_bufsize=1<<I+6,Be.pending_buf_size=4*Be.lit_bufsize,Be.pending_buf=new Uint8Array(Be.pending_buf_size),Be.sym_buf=Be.lit_bufsize,Be.sym_end=3*(Be.lit_bufsize-1),Be.level=g,Be.strategy=j,Be.method=p,z(d)};var F={deflateInit:(d,g)=>T(d,g,dr,15,8,Yn),deflateInit2:T,deflateReset:z,deflateResetKeep:Xr,deflateSetHeader:(d,g)=>Hr(d)||d.state.wrap!==2?Vr:(d.state.gzhead=g,jn),deflate:(d,g)=>{if(Hr(d)||g>zr||g<0)return d?cn(d,Vr):Vr;var p=d.state;if(!d.output||d.avail_in!==0&&!d.input||p.status===Ct&&g!==Jn)return cn(d,d.avail_out===0?Yr:Vr);var O=p.last_flush;if(p.last_flush=g,p.pending!==0){if(Zn(d),d.avail_out===0)return p.last_flush=-1,jn}else if(d.avail_in===0&&_n(g)<=_n(O)&&g!==Jn)return cn(d,Yr);if(p.status===Ct&&d.avail_in!==0)return cn(d,Yr);if(p.status===De&&p.wrap===0&&(p.status=ht),p.status===De){let j=dr+(p.w_bits-8<<4)<<8,je=-1;if(je=p.strategy>=Si||p.level<2?0:p.level<6?1:p.level===6?2:3,j|=je<<6,p.strstart!==0&&(j|=32),j+=31-j%31,Jr(p,j),p.strstart!==0&&(Jr(p,d.adler>>>16),Jr(p,65535&d.adler)),d.adler=1,p.status=ht,Zn(d),p.pending!==0)return p.last_flush=-1,jn}if(p.status===ye){if(d.adler=0,Bn(p,31),Bn(p,139),Bn(p,8),p.gzhead)Bn(p,(p.gzhead.text?1:0)+(p.gzhead.hcrc?2:0)+(p.gzhead.extra?4:0)+(p.gzhead.name?8:0)+(p.gzhead.comment?16:0)),Bn(p,255&p.gzhead.time),Bn(p,p.gzhead.time>>8&255),Bn(p,p.gzhead.time>>16&255),Bn(p,p.gzhead.time>>24&255),Bn(p,p.level===9?2:p.strategy>=Si||p.level<2?4:0),Bn(p,255&p.gzhead.os),p.gzhead.extra&&p.gzhead.extra.length&&(Bn(p,255&p.gzhead.extra.length),Bn(p,p.gzhead.extra.length>>8&255)),p.gzhead.hcrc&&(d.adler=mn(d.adler,p.pending_buf,p.pending,0)),p.gzindex=0,p.status=Qe;else if(Bn(p,0),Bn(p,0),Bn(p,0),Bn(p,0),Bn(p,0),Bn(p,p.level===9?2:p.strategy>=Si||p.level<2?4:0),Bn(p,3),p.status=ht,Zn(d),p.pending!==0)return p.last_flush=-1,jn}if(p.status===Qe){if(p.gzhead.extra){let j=p.pending,je=(65535&p.gzhead.extra.length)-p.gzindex;for(;p.pending+je>p.pending_buf_size;){var I=p.pending_buf_size-p.pending;if(p.pending_buf.set(p.gzhead.extra.subarray(p.gzindex,p.gzindex+I),p.pending),p.pending=p.pending_buf_size,p.gzhead.hcrc&&p.pending>j&&(d.adler=mn(d.adler,p.pending_buf,p.pending-j,j)),p.gzindex+=I,Zn(d),p.pending!==0)return p.last_flush=-1,jn;j=0,je-=I}O=new Uint8Array(p.gzhead.extra),p.pending_buf.set(O.subarray(p.gzindex,p.gzindex+je),p.pending),p.pending+=je,p.gzhead.hcrc&&p.pending>j&&(d.adler=mn(d.adler,p.pending_buf,p.pending-j,j)),p.gzindex=0}p.status=Ke}if(p.status===Ke){if(p.gzhead.name){let j=p.pending,je;do if(p.pending===p.pending_buf_size){if(p.gzhead.hcrc&&p.pending>j&&(d.adler=mn(d.adler,p.pending_buf,p.pending-j,j)),Zn(d),p.pending!==0)return p.last_flush=-1,jn;j=0}while(je=p.gzindex<p.gzhead.name.length?255&p.gzhead.name.charCodeAt(p.gzindex++):0,Bn(p,je),je!==0);p.gzhead.hcrc&&p.pending>j&&(d.adler=mn(d.adler,p.pending_buf,p.pending-j,j)),p.gzindex=0}p.status=$e}if(p.status===$e){if(p.gzhead.comment){let j=p.pending,je;do if(p.pending===p.pending_buf_size){if(p.gzhead.hcrc&&p.pending>j&&(d.adler=mn(d.adler,p.pending_buf,p.pending-j,j)),Zn(d),p.pending!==0)return p.last_flush=-1,jn;j=0}while(je=p.gzindex<p.gzhead.comment.length?255&p.gzhead.comment.charCodeAt(p.gzindex++):0,Bn(p,je),je!==0);p.gzhead.hcrc&&p.pending>j&&(d.adler=mn(d.adler,p.pending_buf,p.pending-j,j))}p.status=at}if(p.status===at){if(p.gzhead.hcrc){if(p.pending+2>p.pending_buf_size&&(Zn(d),p.pending!==0))return p.last_flush=-1,jn;Bn(p,255&d.adler),Bn(p,d.adler>>8&255),d.adler=0}if(p.status=ht,Zn(d),p.pending!==0)return p.last_flush=-1,jn}if(d.avail_in!==0||p.lookahead!==0||g!==tr&&p.status!==Ct){if(O=p.level===0?Fr(p,g):p.strategy===Si?((j,je)=>{for(var Be;;){if(j.lookahead===0&&(kr(j),j.lookahead===0)){if(je===tr)return St;break}if(j.match_length=0,Be=sr(j,0,j.window[j.strstart]),j.lookahead--,j.strstart++,Be&&(Kn(j,!1),j.strm.avail_out===0))return St}return j.insert=0,je===Jn?(Kn(j,!0),j.strm.avail_out===0?Ut:Lt):j.sym_next&&(Kn(j,!1),j.strm.avail_out===0)?St:kt})(p,g):p.strategy===ri?((j,je)=>{let Be;var rt;let qe,re;for(var Rt=j.window;;){if(j.lookahead<=de){if(kr(j),j.lookahead<=de&&je===tr)return St;if(j.lookahead===0)break}if(j.match_length=0,j.lookahead>=He&&0<j.strstart&&(rt=Rt[qe=j.strstart-1])===Rt[++qe]&&rt===Rt[++qe]&&rt===Rt[++qe]){for(re=j.strstart+de;rt===Rt[++qe]&&rt===Rt[++qe]&&rt===Rt[++qe]&&rt===Rt[++qe]&&rt===Rt[++qe]&&rt===Rt[++qe]&&rt===Rt[++qe]&&rt===Rt[++qe]&&qe<re;);j.match_length=de-(re-qe),j.lookahead<j.match_length&&(j.match_length=j.lookahead)}if(j.match_length>=He?(Be=sr(j,1,j.match_length-He),j.lookahead-=j.match_length,j.strstart+=j.match_length,j.match_length=0):(Be=sr(j,0,j.window[j.strstart]),j.lookahead--,j.strstart++),Be&&(Kn(j,!1),j.strm.avail_out===0))return St}return j.insert=0,je===Jn?(Kn(j,!0),j.strm.avail_out===0?Ut:Lt):j.sym_next&&(Kn(j,!1),j.strm.avail_out===0)?St:kt})(p,g):Sr[p.level].func(p,g),O!==Ut&&O!==Lt||(p.status=Ct),O===St||O===Ut)return d.avail_out===0&&(p.last_flush=-1),jn;if(O===kt&&(g===zn?Wr(p):g!==zr&&(or(p,0,0,!1),g===bn)&&(vn(p.head),p.lookahead===0)&&(p.strstart=0,p.block_start=0,p.insert=0),Zn(d),d.avail_out===0))return p.last_flush=-1,jn}return g!==Jn||!(p.wrap<=0)&&(p.wrap===2?(Bn(p,255&d.adler),Bn(p,d.adler>>8&255),Bn(p,d.adler>>16&255),Bn(p,d.adler>>24&255),Bn(p,255&d.total_in),Bn(p,d.total_in>>8&255),Bn(p,d.total_in>>16&255),Bn(p,d.total_in>>24&255)):(Jr(p,d.adler>>>16),Jr(p,65535&d.adler)),Zn(d),0<p.wrap&&(p.wrap=-p.wrap),p.pending!==0)?jn:Lr},deflateEnd:d=>{var g;return Hr(d)?Vr:(g=d.state.status,d.state=null,g===ht?cn(d,Ai):jn)},deflateSetDictionary:(d,g)=>{let p=g.length;if(Hr(d))return Vr;var O=d.state,I=O.wrap;if(I===2||I===1&&O.status!==De||O.lookahead)return Vr;I===1&&(d.adler=ir(d.adler,g,p,0)),O.wrap=0,p>=O.w_size&&(I===0&&(vn(O.head),O.strstart=0,O.block_start=0,O.insert=0),(j=new Uint8Array(O.w_size)).set(g.subarray(p-O.w_size,p),0),g=j,p=O.w_size);var j=d.avail_in,je=d.next_in,Be=d.input;for(d.avail_in=p,d.next_in=0,d.input=g,kr(O);O.lookahead>=He;){let rt=O.strstart,qe=O.lookahead-(He-1);for(;O.ins_h=An(O,O.ins_h,O.window[rt+He-1]),O.prev[rt&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=rt,rt++,--qe;);O.strstart=rt,O.lookahead=He-1,kr(O)}return O.strstart+=O.lookahead,O.block_start=O.strstart,O.insert=O.lookahead,O.lookahead=0,O.match_length=O.prev_length=He-1,O.match_available=0,d.next_in=je,d.input=Be,d.avail_in=j,O.wrap=I,jn},deflateInfo:"pako deflate (from Nodeca project)"},ve=function(d){for(var g,p,O=Array.prototype.slice.call(arguments,1);O.length;){var I=O.shift();if(I){if(typeof I!="object")throw new TypeError(I+"must be non-object");for(var j in I)g=I,p=j,Object.prototype.hasOwnProperty.call(g,p)&&(d[j]=I[j])}}return d},Ae=d=>{let g=0;for(let I=0,j=d.length;I<j;I++)g+=d[I].length;var p=new Uint8Array(g);for(let I=0,j=0,je=d.length;I<je;I++){var O=d[I];p.set(O,j),j+=O.length}return p};let We=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{We=!1}let Xe=new Uint8Array(256);for(let d=0;d<256;d++)Xe[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;Xe[254]=Xe[254]=1;var ot=d=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(d);let g,p,O,I,j,je=d.length,Be=0;for(I=0;I<je;I++)(64512&(p=d.charCodeAt(I)))==55296&&I+1<je&&(64512&(O=d.charCodeAt(I+1)))==56320&&(p=65536+(p-55296<<10)+(O-56320),I++),Be+=p<128?1:p<2048?2:p<65536?3:4;for(g=new Uint8Array(Be),j=0,I=0;j<Be;I++)(64512&(p=d.charCodeAt(I)))==55296&&I+1<je&&(64512&(O=d.charCodeAt(I+1)))==56320&&(p=65536+(p-55296<<10)+(O-56320),I++),p<128?g[j++]=p:(p<2048?g[j++]=192|p>>>6:(p<65536?g[j++]=224|p>>>12:(g[j++]=240|p>>>18,g[j++]=128|p>>>12&63),g[j++]=128|p>>>6&63),g[j++]=128|63&p);return g},lt=(d,g)=>{var p=g||d.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(d.subarray(0,g));let O,I;var j=new Array(2*p);for(I=0,O=0;O<p;){let je=d[O++];if(je<128)j[I++]=je;else{let Be=Xe[je];if(4<Be)j[I++]=65533,O+=Be-1;else{for(je&=Be===2?31:Be===3?15:7;1<Be&&O<p;)je=je<<6|63&d[O++],Be--;1<Be?j[I++]=65533:je<65536?j[I++]=je:(je-=65536,j[I++]=55296|je>>10&1023,j[I++]=56320|1023&je)}}}return((je,Be)=>{if(Be<65534&&je.subarray&&We)return String.fromCharCode.apply(null,je.length===Be?je:je.subarray(0,Be));let rt="";for(let qe=0;qe<Be;qe++)rt+=String.fromCharCode(je[qe]);return rt})(j,I)},Tt=(d,g)=>{let p=(g=(g=g||d.length)>d.length?d.length:g)-1;for(;0<=p&&(192&d[p])==128;)p--;return!(p<0)&&p!==0&&p+Xe[d[p]]>g?p:g},Nt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};let Yt=Object.prototype.toString,{Z_NO_FLUSH:Rn,Z_SYNC_FLUSH:nn,Z_FULL_FLUSH:en,Z_FINISH:Zt,Z_OK:Cn,Z_STREAM_END:qn,Z_DEFAULT_COMPRESSION:hr,Z_DEFAULT_STRATEGY:vr,Z_DEFLATED:gr}=wi;function Wn(g){this.options=ve({level:hr,method:gr,chunkSize:16384,windowBits:15,memLevel:8,strategy:vr},g||{});var g=this.options,p=(g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Nt,this.strm.avail_out=0,F.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy));if(p!==Cn)throw new Error(Qn[p]);if(g.header&&F.deflateSetHeader(this.strm,g.header),g.dictionary){let O;if(O=typeof g.dictionary=="string"?ot(g.dictionary):Yt.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(p=F.deflateSetDictionary(this.strm,O))!==Cn)throw new Error(Qn[p]);this.T=!0}}function ur(d,g){if(g=new Wn(g),g.push(d,!0),g.err)throw g.msg||Qn[g.err];return g.result}Wn.prototype.push=function(d,g){var p=this.strm,O=this.options.chunkSize;let I,j;if(this.ended)return!1;for(j=g===~~g?g:g===!0?Zt:Rn,typeof d=="string"?p.input=ot(d):Yt.call(d)==="[object ArrayBuffer]"?p.input=new Uint8Array(d):p.input=d,p.next_in=0,p.avail_in=p.input.length;;)if(p.avail_out===0&&(p.output=new Uint8Array(O),p.next_out=0,p.avail_out=O),(j===nn||j===en)&&p.avail_out<=6)this.onData(p.output.subarray(0,p.next_out)),p.avail_out=0;else{if(F.deflate(p,j)===qn)return 0<p.next_out&&this.onData(p.output.subarray(0,p.next_out)),I=F.deflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===Cn;if(p.avail_out===0)this.onData(p.output);else if(0<j&&0<p.next_out)this.onData(p.output.subarray(0,p.next_out)),p.avail_out=0;else if(p.avail_in===0)break}return!0},Wn.prototype.onData=function(d){this.chunks.push(d)},Wn.prototype.onEnd=function(d){d===Cn&&(this.result=Ae(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};function Gi(d,g){return(g=g||{}).raw=!0,ur(d,g)}function uo(d,g){return(g=g||{}).gzip=!0,ur(d,g)}let nl=Wn,Ts=ur,rl=wi,ji={Deflate:nl,deflate:Ts,deflateRaw:Gi,gzip:uo,constants:rl},Ta=16209,il=16191,ol=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),sl=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),al=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Yc=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Es=(d,g,p,O,I,j,je,Be)=>{var rt,qe=Be.bits;let re=0,Rt=0,Ht=0,xt=0,En=0,Xt=0,tn=0,dn=0,gn=0,wn=0,Gn,Er,$n,Un,Br=null,Cr;var wr=new Uint16Array(16),ki=new Uint16Array(16);let $r=null,Yi,Ar,Fi;for(re=0;re<=15;re++)wr[re]=0;for(Rt=0;Rt<O;Rt++)wr[g[p+Rt]]++;for(En=qe,xt=15;1<=xt&&wr[xt]===0;xt--);if(En>xt&&(En=xt),xt===0)I[j++]=20971520,I[j++]=20971520,Be.bits=1;else{for(Ht=1;Ht<xt&&wr[Ht]===0;Ht++);for(En<Ht&&(En=Ht),dn=1,re=1;re<=15;re++)if((dn=(dn<<=1)-wr[re])<0)return-1;if(0<dn&&(d===0||xt!==1))return-1;for(ki[1]=0,re=1;re<15;re++)ki[re+1]=ki[re]+wr[re];for(Rt=0;Rt<O;Rt++)g[p+Rt]!==0&&(je[ki[g[p+Rt]]++]=Rt);if(Cr=d===0?(Br=$r=je,20):d===1?(Br=ol,$r=sl,257):(Br=al,$r=Yc,0),wn=0,Rt=0,re=Ht,Un=j,Xt=En,tn=0,$n=-1,rt=(gn=1<<En)-1,d===1&&852<gn||d===2&&592<gn)return 1;for(;;){for(Yi=re-tn,Fi=je[Rt]+1<Cr?(Ar=0,je[Rt]):je[Rt]>=Cr?(Ar=$r[je[Rt]-Cr],Br[je[Rt]-Cr]):(Ar=96,0),Gn=1<<re-tn,Er=1<<Xt,Ht=Er;Er-=Gn,I[Un+(wn>>tn)+Er]=Yi<<24|Ar<<16|Fi|0,Er!==0;);for(Gn=1<<re-1;wn&Gn;)Gn>>=1;if(wn=Gn!==0?(wn&=Gn-1)+Gn:0,Rt++,--wr[re]==0){if(re===xt)break;re=g[p+je[Rt]]}if(re>En&&(wn&rt)!==$n){for(tn===0&&(tn=En),Un+=Ht,Xt=re-tn,dn=1<<Xt;Xt+tn<xt&&!((dn-=wr[Xt+tn])<=0);)Xt++,dn<<=1;if(gn+=1<<Xt,d===1&&852<gn||d===2&&592<gn)return 1;I[$n=wn&rt]=En<<24|Xt<<16|Un-j|0}}wn!==0&&(I[Un+wn]=re-tn<<24|64<<16|0),Be.bits=En}return 0};let lc=1,dc=2,{Z_FINISH:Zc,Z_BLOCK:cl,Z_TREES:Ea,Z_OK:lo,Z_STREAM_END:ul,Z_NEED_DICT:ll,Z_STREAM_ERROR:ro,Z_DATA_ERROR:Xc,Z_MEM_ERROR:$c,Z_BUF_ERROR:dl,Z_DEFLATED:eu}=wi,Ca=16180,Cs=16190,Oo=16191,wa=16199,Qs=16200,Mr=16209,hl=16211,pl=852,tu=592,nu=d=>(d>>>24&255)+(d>>>8&65280)+((65280&d)<<8)+((255&d)<<24);function fl(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}let cs=d=>{var g;return!d||!(g=d.state)||g.strm!==d||g.mode<Ca||g.mode>hl?1:0},ru=d=>{var g;return cs(d)?ro:(g=d.state,d.total_in=d.total_out=g.total=0,d.msg="",g.wrap&&(d.adler=1&g.wrap),g.mode=Ca,g.last=0,g.havedict=0,g.flags=-1,g.dmax=32768,g.head=null,g.hold=0,g.bits=0,g.lencode=g.lendyn=new Int32Array(pl),g.distcode=g.distdyn=new Int32Array(tu),g.sane=1,g.back=-1,lo)},iu=d=>{var g;return cs(d)?ro:((g=d.state).wsize=0,g.whave=0,g.wnext=0,ru(d))},ou=(d,g)=>{let p;var O;return cs(d)||(O=d.state,g<0?(p=0,g=-g):(p=5+(g>>4),g<48&&(g&=15)),g&&(g<8||15<g))?ro:(O.window!==null&&O.wbits!==g&&(O.window=null),O.wrap=p,O.wbits=g,iu(d))},su=(d,g)=>{var p;return d?(p=new fl,(d.state=p).strm=d,p.window=null,p.mode=Ca,(p=ou(d,g))!==lo&&(d.state=null),p):ro},au=!0,hc,Ia,cu=(d,g,p,O)=>{let I;return d=d.state,d.window===null&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new Uint8Array(d.wsize)),d.wsize<=O?(d.window.set(g.subarray(p-d.wsize,p),0),d.wnext=0,d.whave=d.wsize):((I=d.wsize-d.wnext)>O&&(I=O),d.window.set(g.subarray(p-O,p-O+I),d.wnext),(O-=I)?(d.window.set(g.subarray(p-O,p),0),d.wnext=O,d.whave=d.wsize):(d.wnext+=I,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=I))),0};var No={inflateReset:iu,inflateReset2:ou,inflateResetKeep:ru,inflateInit:d=>su(d,15),inflateInit2:su,inflate:(d,g)=>{var p;let O,I,j,je,Be,rt,qe,re,Rt,Ht,xt,En,Xt,tn=0,dn,gn,wn,Gn,Er,$n,Un,Br;var Cr=new Uint8Array(4);let wr,ki;var $r,Yi,Ar,Fi,pi,Os,so,Mi,oa,sa,Pc,aa,mr,_o,Kr,Ns=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(cs(d)||!d.output||!d.input&&d.avail_in!==0)return ro;(p=d.state).mode===Oo&&(p.mode=16192),je=d.next_out,I=d.output,rt=d.avail_out,j=d.next_in,O=d.input,Be=d.avail_in,qe=p.hold,re=p.bits,Rt=Be,Ht=rt,Br=lo;e:for(;;)switch(p.mode){case Ca:if(p.wrap===0)p.mode=16192;else{for(;re<16;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}2&p.wrap&&qe===35615?(p.wbits===0&&(p.wbits=15),Cr[p.check=0]=255&qe,Cr[1]=qe>>>8&255,p.check=mn(p.check,Cr,2,0),qe=0,re=0,p.mode=16181):(p.head&&(p.head.done=!1),!(1&p.wrap)||(((255&qe)<<8)+(qe>>8))%31?(d.msg="incorrect header check",p.mode=Mr):(15&qe)!==eu?(d.msg="unknown compression method",p.mode=Mr):(qe>>>=4,re-=4,Un=8+(15&qe),p.wbits===0&&(p.wbits=Un),15<Un||Un>p.wbits?(d.msg="invalid window size",p.mode=Mr):(p.dmax=1<<p.wbits,p.flags=0,d.adler=p.check=1,p.mode=512&qe?16189:Oo,qe=0,re=0)))}break;case 16181:for(;re<16;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}if(p.flags=qe,(255&p.flags)!==eu){d.msg="unknown compression method",p.mode=Mr;break}if(57344&p.flags){d.msg="unknown header flags set",p.mode=Mr;break}p.head&&(p.head.text=qe>>8&1),512&p.flags&&4&p.wrap&&(Cr[0]=255&qe,Cr[1]=qe>>>8&255,p.check=mn(p.check,Cr,2,0)),qe=0,re=0,p.mode=16182;case 16182:for(;re<32;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}p.head&&(p.head.time=qe),512&p.flags&&4&p.wrap&&(Cr[0]=255&qe,Cr[1]=qe>>>8&255,Cr[2]=qe>>>16&255,Cr[3]=qe>>>24&255,p.check=mn(p.check,Cr,4,0)),qe=0,re=0,p.mode=16183;case 16183:for(;re<16;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}p.head&&(p.head.xflags=255&qe,p.head.os=qe>>8),512&p.flags&&4&p.wrap&&(Cr[0]=255&qe,Cr[1]=qe>>>8&255,p.check=mn(p.check,Cr,2,0)),qe=0,re=0,p.mode=16184;case 16184:if(1024&p.flags){for(;re<16;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}p.length=qe,p.head&&(p.head.extra_len=qe),512&p.flags&&4&p.wrap&&(Cr[0]=255&qe,Cr[1]=qe>>>8&255,p.check=mn(p.check,Cr,2,0)),qe=0,re=0}else p.head&&(p.head.extra=null);p.mode=16185;case 16185:if(1024&p.flags&&((xt=(xt=p.length)>Be?Be:xt)&&(p.head&&(Un=p.head.extra_len-p.length,p.head.extra||(p.head.extra=new Uint8Array(p.head.extra_len)),p.head.extra.set(O.subarray(j,j+xt),Un)),512&p.flags&&4&p.wrap&&(p.check=mn(p.check,O,xt,j)),Be-=xt,j+=xt,p.length-=xt),p.length))break e;p.length=0,p.mode=16186;case 16186:if(2048&p.flags){if(Be===0)break e;for(xt=0;Un=O[j+xt++],p.head&&Un&&p.length<65536&&(p.head.name+=String.fromCharCode(Un)),Un&&xt<Be;);if(512&p.flags&&4&p.wrap&&(p.check=mn(p.check,O,xt,j)),Be-=xt,j+=xt,Un)break e}else p.head&&(p.head.name=null);p.length=0,p.mode=16187;case 16187:if(4096&p.flags){if(Be===0)break e;for(xt=0;Un=O[j+xt++],p.head&&Un&&p.length<65536&&(p.head.comment+=String.fromCharCode(Un)),Un&&xt<Be;);if(512&p.flags&&4&p.wrap&&(p.check=mn(p.check,O,xt,j)),Be-=xt,j+=xt,Un)break e}else p.head&&(p.head.comment=null);p.mode=16188;case 16188:if(512&p.flags){for(;re<16;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}if(4&p.wrap&&qe!==(65535&p.check)){d.msg="header crc mismatch",p.mode=Mr;break}qe=0,re=0}p.head&&(p.head.hcrc=p.flags>>9&1,p.head.done=!0),d.adler=p.check=0,p.mode=Oo;break;case 16189:for(;re<32;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}d.adler=p.check=nu(qe),qe=0,re=0,p.mode=Cs;case Cs:if(p.havedict===0)return d.next_out=je,d.avail_out=rt,d.next_in=j,d.avail_in=Be,p.hold=qe,p.bits=re,ll;d.adler=p.check=1,p.mode=Oo;case Oo:if(g===cl||g===Ea)break e;case 16192:if(p.last)qe>>>=7&re,re-=7&re,p.mode=16206;else{for(;re<3;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}switch(p.last=1&qe,qe>>>=1,--re,3&qe){case 0:p.mode=16193;break;case 1:if((Dr=>{if(au){hc=new Int32Array(512),Ia=new Int32Array(32);let cr=0;for(;cr<144;)Dr.lens[cr++]=8;for(;cr<256;)Dr.lens[cr++]=9;for(;cr<280;)Dr.lens[cr++]=7;for(;cr<288;)Dr.lens[cr++]=8;for(Es(lc,Dr.lens,0,288,hc,0,Dr.work,{bits:9}),cr=0;cr<32;)Dr.lens[cr++]=5;Es(dc,Dr.lens,0,32,Ia,0,Dr.work,{bits:5}),au=!1}Dr.lencode=hc,Dr.lenbits=9,Dr.distcode=Ia,Dr.distbits=5})(p),p.mode=wa,g!==Ea)break;qe>>>=2,re-=2;break e;case 2:p.mode=16196;break;case 3:d.msg="invalid block type",p.mode=Mr}qe>>>=2,re-=2}break;case 16193:for(qe>>>=7&re,re-=7&re;re<32;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}if((65535&qe)!=(qe>>>16^65535)){d.msg="invalid stored block lengths",p.mode=Mr;break}if(p.length=65535&qe,qe=0,re=0,p.mode=16194,g===Ea)break e;case 16194:p.mode=16195;case 16195:if(xt=p.length){if((xt=(xt=xt>Be?Be:xt)>rt?rt:xt)===0)break e;I.set(O.subarray(j,j+xt),je),Be-=xt,j+=xt,rt-=xt,je+=xt,p.length-=xt}else p.mode=Oo;break;case 16196:for(;re<14;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}if(p.nlen=257+(31&qe),qe>>>=5,re-=5,p.ndist=1+(31&qe),qe>>>=5,re-=5,p.ncode=4+(15&qe),qe>>>=4,re-=4,286<p.nlen||30<p.ndist){d.msg="too many length or distance symbols",p.mode=Mr;break}p.have=0,p.mode=16197;case 16197:for(;p.have<p.ncode;){for(;re<3;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}p.lens[Ns[p.have++]]=7&qe,qe>>>=3,re-=3}for(;p.have<19;)p.lens[Ns[p.have++]]=0;if(p.lencode=p.lendyn,p.lenbits=7,wr={bits:p.lenbits},Br=Es(0,p.lens,0,19,p.lencode,0,p.work,wr),p.lenbits=wr.bits,Br){d.msg="invalid code lengths set",p.mode=Mr;break}p.have=0,p.mode=16198;case 16198:for(;p.have<p.nlen+p.ndist;){for(;tn=p.lencode[qe&(1<<p.lenbits)-1],dn=tn>>>24,gn=tn>>>16&255,wn=65535&tn,!(dn<=re);){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}if(wn<16)qe>>>=dn,re-=dn,p.lens[p.have++]=wn;else{if(wn===16){for(ki=dn+2;re<ki;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}if(qe>>>=dn,re-=dn,p.have===0){d.msg="invalid bit length repeat",p.mode=Mr;break}Un=p.lens[p.have-1],xt=3+(3&qe),qe>>>=2,re-=2}else if(wn===17){for(ki=dn+3;re<ki;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}qe>>>=dn,re-=dn,Un=0,xt=3+(7&qe),qe>>>=3,re-=3}else{for(ki=dn+7;re<ki;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}qe>>>=dn,re-=dn,Un=0,xt=11+(127&qe),qe>>>=7,re-=7}if(p.have+xt>p.nlen+p.ndist){d.msg="invalid bit length repeat",p.mode=Mr;break}for(;xt--;)p.lens[p.have++]=Un}}if(p.mode===Mr)break;if(p.lens[256]===0){d.msg="invalid code -- missing end-of-block",p.mode=Mr;break}if(p.lenbits=9,wr={bits:p.lenbits},Br=Es(lc,p.lens,0,p.nlen,p.lencode,0,p.work,wr),p.lenbits=wr.bits,Br){d.msg="invalid literal/lengths set",p.mode=Mr;break}if(p.distbits=6,p.distcode=p.distdyn,wr={bits:p.distbits},Br=Es(dc,p.lens,p.nlen,p.ndist,p.distcode,0,p.work,wr),p.distbits=wr.bits,Br){d.msg="invalid distances set",p.mode=Mr;break}if(p.mode=wa,g===Ea)break e;case wa:p.mode=Qs;case Qs:if(6<=Be&&258<=rt){d.next_out=je,d.avail_out=rt,d.next_in=j,d.avail_in=Be,p.hold=qe,p.bits=re;{Ti=void 0,Ac=void 0,$r=void 0,Yi=void 0,Ar=void 0,Fi=void 0,pi=void 0,Os=void 0,so=void 0,Mi=void 0,oa=void 0,sa=void 0,Pc=void 0,aa=void 0,mr=void 0,_o=void 0,Kr=void 0,bi=void 0;var Ti=d,Ac=Ht;let Dr,cr,_i,Ir,Wi,er,ai,Tr,Ui;var bi=Ti.state;Dr=Ti.next_in,_o=Ti.input,$r=Dr+(Ti.avail_in-5),cr=Ti.next_out,Kr=Ti.output,Yi=cr-(Ac-Ti.avail_out),Ar=cr+(Ti.avail_out-257),Fi=bi.dmax,pi=bi.wsize,Os=bi.whave,so=bi.wnext,Mi=bi.window,_i=bi.hold,Ir=bi.bits,oa=bi.lencode,sa=bi.distcode,Pc=(1<<bi.lenbits)-1,aa=(1<<bi.distbits)-1;t:do for(Ir<15&&(_i+=_o[Dr++]<<Ir,Ir+=8,_i+=_o[Dr++]<<Ir,Ir+=8),Wi=oa[_i&Pc];;){if(er=Wi>>>24,_i>>>=er,Ir-=er,(er=Wi>>>16&255)===0)Kr[cr++]=65535&Wi;else{if(!(16&er)){if(!(64&er)){Wi=oa[(65535&Wi)+(_i&(1<<er)-1)];continue}if(32&er){bi.mode=il;break t}Ti.msg="invalid literal/length code",bi.mode=Ta;break t}for(ai=65535&Wi,(er&=15)&&(Ir<er&&(_i+=_o[Dr++]<<Ir,Ir+=8),ai+=_i&(1<<er)-1,_i>>>=er,Ir-=er),Ir<15&&(_i+=_o[Dr++]<<Ir,Ir+=8,_i+=_o[Dr++]<<Ir,Ir+=8),Wi=sa[_i&aa];;){if(er=Wi>>>24,_i>>>=er,Ir-=er,!(16&(er=Wi>>>16&255))){if(!(64&er)){Wi=sa[(65535&Wi)+(_i&(1<<er)-1)];continue}Ti.msg="invalid distance code",bi.mode=Ta;break t}if(mr=65535&Wi,er&=15,Ir<er&&(_i+=_o[Dr++]<<Ir,(Ir+=8)<er)&&(_i+=_o[Dr++]<<Ir,Ir+=8),Fi<(mr+=_i&(1<<er)-1)){Ti.msg="invalid distance too far back",bi.mode=Ta;break t}if(_i>>>=er,Ir-=er,mr>(er=cr-Yi)){if((er=mr-er)>Os&&bi.sane){Ti.msg="invalid distance too far back",bi.mode=Ta;break t}if(Tr=0,Ui=Mi,so===0){if(Tr+=pi-er,er<ai){for(ai-=er;Kr[cr++]=Mi[Tr++],--er;);Tr=cr-mr,Ui=Kr}}else if(so<er){if(Tr+=pi+so-er,(er-=so)<ai){for(ai-=er;Kr[cr++]=Mi[Tr++],--er;);if(Tr=0,so<ai){for(er=so,ai-=er;Kr[cr++]=Mi[Tr++],--er;);Tr=cr-mr,Ui=Kr}}}else if(Tr+=so-er,er<ai){for(ai-=er;Kr[cr++]=Mi[Tr++],--er;);Tr=cr-mr,Ui=Kr}for(;2<ai;)Kr[cr++]=Ui[Tr++],Kr[cr++]=Ui[Tr++],Kr[cr++]=Ui[Tr++],ai-=3;ai&&(Kr[cr++]=Ui[Tr++],1<ai)&&(Kr[cr++]=Ui[Tr++])}else{for(Tr=cr-mr;Kr[cr++]=Kr[Tr++],Kr[cr++]=Kr[Tr++],Kr[cr++]=Kr[Tr++],2<(ai-=3););ai&&(Kr[cr++]=Kr[Tr++],1<ai)&&(Kr[cr++]=Kr[Tr++])}break}}break}while(Dr<$r&&cr<Ar);ai=Ir>>3,Dr-=ai,Ir-=ai<<3,_i&=(1<<Ir)-1,Ti.next_in=Dr,Ti.next_out=cr,Ti.avail_in=Dr<$r?$r-Dr+5:5-(Dr-$r),Ti.avail_out=cr<Ar?Ar-cr+257:257-(cr-Ar),bi.hold=_i,bi.bits=Ir}je=d.next_out,I=d.output,rt=d.avail_out,j=d.next_in,O=d.input,Be=d.avail_in,qe=p.hold,re=p.bits,p.mode===Oo&&(p.back=-1);break}for(p.back=0;tn=p.lencode[qe&(1<<p.lenbits)-1],dn=tn>>>24,gn=tn>>>16&255,wn=65535&tn,!(dn<=re);){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}if(gn&&!(240&gn)){for(Gn=dn,Er=gn,$n=wn;tn=p.lencode[$n+((qe&(1<<Gn+Er)-1)>>Gn)],dn=tn>>>24,gn=tn>>>16&255,wn=65535&tn,!(Gn+dn<=re);){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}qe>>>=Gn,re-=Gn,p.back+=Gn}if(qe>>>=dn,re-=dn,p.back+=dn,p.length=wn,gn===0){p.mode=16205;break}if(32&gn){p.back=-1,p.mode=Oo;break}if(64&gn){d.msg="invalid literal/length code",p.mode=Mr;break}p.extra=15&gn,p.mode=16201;case 16201:if(p.extra){for(ki=p.extra;re<ki;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}p.length+=qe&(1<<p.extra)-1,qe>>>=p.extra,re-=p.extra,p.back+=p.extra}p.was=p.length,p.mode=16202;case 16202:for(;tn=p.distcode[qe&(1<<p.distbits)-1],dn=tn>>>24,gn=tn>>>16&255,wn=65535&tn,!(dn<=re);){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}if(!(240&gn)){for(Gn=dn,Er=gn,$n=wn;tn=p.distcode[$n+((qe&(1<<Gn+Er)-1)>>Gn)],dn=tn>>>24,gn=tn>>>16&255,wn=65535&tn,!(Gn+dn<=re);){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}qe>>>=Gn,re-=Gn,p.back+=Gn}if(qe>>>=dn,re-=dn,p.back+=dn,64&gn){d.msg="invalid distance code",p.mode=Mr;break}p.offset=wn,p.extra=15&gn,p.mode=16203;case 16203:if(p.extra){for(ki=p.extra;re<ki;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}p.offset+=qe&(1<<p.extra)-1,qe>>>=p.extra,re-=p.extra,p.back+=p.extra}if(p.offset>p.dmax){d.msg="invalid distance too far back",p.mode=Mr;break}p.mode=16204;case 16204:if(rt===0)break e;if(xt=Ht-rt,p.offset>xt){if((xt=p.offset-xt)>p.whave&&p.sane){d.msg="invalid distance too far back",p.mode=Mr;break}En=xt>p.wnext?(xt-=p.wnext,p.wsize-xt):p.wnext-xt,xt>p.length&&(xt=p.length),Xt=p.window}else Xt=I,En=je-p.offset,xt=p.length;for(xt>rt&&(xt=rt),rt-=xt,p.length-=xt;I[je++]=Xt[En++],--xt;);p.length===0&&(p.mode=Qs);break;case 16205:if(rt===0)break e;I[je++]=p.length,rt--,p.mode=Qs;break;case 16206:if(p.wrap){for(;re<32;){if(Be===0)break e;Be--,qe|=O[j++]<<re,re+=8}if(Ht-=rt,d.total_out+=Ht,p.total+=Ht,4&p.wrap&&Ht&&(d.adler=p.check=(p.flags?mn:ir)(p.check,I,Ht,je-Ht)),Ht=rt,4&p.wrap&&(p.flags?qe:nu(qe))!==p.check){d.msg="incorrect data check",p.mode=Mr;break}qe=0,re=0}p.mode=16207;case 16207:if(p.wrap&&p.flags){for(;re<32;){if(Be===0)break e;Be--,qe+=O[j++]<<re,re+=8}if(4&p.wrap&&qe!==(4294967295&p.total)){d.msg="incorrect length check",p.mode=Mr;break}qe=0,re=0}p.mode=16208;case 16208:Br=ul;break e;case Mr:Br=Xc;break e;case 16210:return $c;default:return ro}return d.next_out=je,d.avail_out=rt,d.next_in=j,d.avail_in=Be,p.hold=qe,p.bits=re,(p.wsize||Ht!==d.avail_out&&p.mode<Mr&&(p.mode<16206||g!==Zc))&&cu(d,d.output,d.next_out,Ht-d.avail_out),Rt-=d.avail_in,Ht-=d.avail_out,d.total_in+=Rt,d.total_out+=Ht,p.total+=Ht,4&p.wrap&&Ht&&(d.adler=p.check=(p.flags?mn:ir)(p.check,I,Ht,d.next_out-Ht)),d.data_type=p.bits+(p.last?64:0)+(p.mode===Oo?128:0)+(p.mode===wa||p.mode===16194?256:0),Br=(Rt==0&&Ht===0||g===Zc)&&Br===lo?dl:Br},inflateEnd:d=>{var g;return cs(d)?ro:((g=d.state).window&&(g.window=null),d.state=null,lo)},inflateGetHeader:(d,g)=>cs(d)||!(2&(d=d.state).wrap)?ro:((d.head=g).done=!1,lo),inflateSetDictionary:(d,g)=>{var p,O=g.length;return cs(d)||(p=d.state).wrap!==0&&p.mode!==Cs?ro:p.mode===Cs&&ir(1,g,O,0)!==p.check?Xc:cu(d,g,O,O)?(p.mode=16210,$c):(p.havedict=1,lo)},inflateInfo:"pako inflate (from Nodeca project)"},ml=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};let uu=Object.prototype.toString,{Z_NO_FLUSH:vl,Z_FINISH:gl,Z_OK:Js,Z_STREAM_END:pc,Z_NEED_DICT:Ks,Z_STREAM_ERROR:Et,Z_DATA_ERROR:lu,Z_MEM_ERROR:du}=wi;function Ra(p){this.options=ve({chunkSize:65536,windowBits:15,to:""},p||{});var g=this.options,p=(g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0)&&(g.windowBits=-15),!(0<=g.windowBits&&g.windowBits<16)||p&&p.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&!(15&g.windowBits)&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Nt,this.strm.avail_out=0,No.inflateInit2(this.strm,g.windowBits));if(p!==Js)throw new Error(Qn[p]);if(this.header=new ml,No.inflateGetHeader(this.strm,this.header),g.dictionary&&(typeof g.dictionary=="string"?g.dictionary=ot(g.dictionary):uu.call(g.dictionary)==="[object ArrayBuffer]"&&(g.dictionary=new Uint8Array(g.dictionary)),g.raw)&&(p=No.inflateSetDictionary(this.strm,g.dictionary))!==Js)throw new Error(Qn[p])}function Vi(d,g){if(g=new Ra(g),g.push(d),g.err)throw g.msg||Qn[g.err];return g.result}Ra.prototype.push=function(d,g){var p,O,I,j=this.strm,je=this.options.chunkSize,Be=this.options.dictionary;let rt,qe,re;if(this.ended)return!1;for(qe=g===~~g?g:g===!0?gl:vl,uu.call(d)==="[object ArrayBuffer]"?j.input=new Uint8Array(d):j.input=d,j.next_in=0,j.avail_in=j.input.length;;){for(j.avail_out===0&&(j.output=new Uint8Array(je),j.next_out=0,j.avail_out=je),(rt=No.inflate(j,qe))===Ks&&Be&&((rt=No.inflateSetDictionary(j,Be))===Js?rt=No.inflate(j,qe):rt===lu&&(rt=Ks));0<j.avail_in&&rt===pc&&0<j.state.wrap&&d[j.next_in]!==0;)No.inflateReset(j),rt=No.inflate(j,qe);switch(rt){case Et:case lu:case Ks:case du:return this.onEnd(rt),!(this.ended=!0)}if(re=j.avail_out,!j.next_out||j.avail_out!==0&&rt!==pc||(this.options.to==="string"?(p=Tt(j.output,j.next_out),O=j.next_out-p,I=lt(j.output,p),j.next_out=O,j.avail_out=je-O,O&&j.output.set(j.output.subarray(p,p+O),0),this.onData(I)):this.onData(j.output.length===j.next_out?j.output:j.output.subarray(0,j.next_out))),rt!==Js||re!==0){if(rt===pc)return rt=No.inflateEnd(this.strm),this.onEnd(rt),this.ended=!0;if(j.avail_in===0)break}}return!0},Ra.prototype.onData=function(d){this.chunks.push(d)},Ra.prototype.onEnd=function(d){d===Js&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ae(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};var rr=ji.deflate,jr=Vi,ka=rr,us=jr,yl=(Ys.prototype.add=function(d){this.isStarting&&(this.count+=d)},Ys.prototype.stop=function(){return this.isStarting=!1,this.reset()},Ys.prototype.start=function(d){var g=this;d===void 0&&(d=0),this.isStarting=!0,this.count=0,clearInterval(this.timer),d&&(this.timer=window.setInterval(function(){var p=g.count;g.speed=p/d,g.count=0},d))},Ys.prototype.reset=function(){this.count=0,clearInterval(this.timer),this.timer=0,this.speed=0},Ys);function Ys(d){this.R=d=d===void 0?"":d,this.count=0,this.isStarting=!1,this.timer=0,this.lastLogTime=0,this.speed=0,this.lastTime=0}var fc=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},mc=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}};function bl(d,g,p){return fc(this,void 0,void 0,function(){var O,I,j;return mc(this,function(je){switch(je.label){case 0:return O="",I=(Be=>{Be=Be||32;for(var rt="abcdefhijkmnprstwxyz0123456789",qe=rt.length,re="",Rt=0;Rt<Be;Rt++)re+=rt.charAt(Math.floor(Math.random()*qe));return re})(16),[4,function(Be){var rt;return fc(this,void 0,void 0,function(){var qe,re;return mc(this,function(Rt){switch(Rt.label){case 0:return qe=new TextEncoder().encode(Be),[4,(rt=crypto.subtle)==null?void 0:rt.digest("SHA-256",qe)];case 1:return qe=Rt.sent(),re=Array.from(new Uint8Array(qe)),[2,re.map(function(Ht){return Ht.toString(16).padStart(2,"0")}).join("")]}})})}("".concat(d).concat("DPIV9g5X2zvTD4Zj").concat(I).concat(p))];case 1:return(j=(j=je.sent()).toLocaleLowerCase())&&(j={ver:g,hash:j,nonce:I,expire:p},j=JSON.stringify(j),O=btoa(j)),[2,O]}})})}function vc(d){return fc(this,void 0,void 0,function(){var g,p;return mc(this,function(O){switch(O.label){case 0:return g="",p=Math.floor((Date.now()+7776e6)/1e3),[4,bl(d,2,p)];case 1:return p=O.sent(),[2,g=0<p.length?p:g]}})})}var Zs=function(){return(Zs=Object.assign||function(d){for(var g,p=1,O=arguments.length;p<O;p++)for(var I in g=arguments[p])Object.prototype.hasOwnProperty.call(g,I)&&(d[I]=g[I]);return d}).apply(this,arguments)},ar=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},Lo=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}},Pa=function(d,g,p){if(p||arguments.length===2)for(var O,I=0,j=g.length;I<j;I++)!O&&I in g||((O=O||Array.prototype.slice.call(g,0,I))[I]=g[I]);return d.concat(O||Array.prototype.slice.call(g))},ws=(Object.defineProperty(Pr.prototype,"speed",{get:function(){return this.I.speed},enumerable:!1,configurable:!0}),Object.defineProperty(Pr.prototype,"url",{get:function(){return this.N.url},set:function(d){this.N.url=d},enumerable:!1,configurable:!0}),Object.defineProperty(Pr.prototype,"strategy",{get:function(){return this.D.strategy},enumerable:!1,configurable:!0}),Pr.prototype.setStrategy=function(d){var g;d===0?(this.D.setStrategy(d),(g=this.Z)!=null&&g.destroy(),this.Z=null):this.D.strategy!=d&&((g=this.Z)!=null&&g.destroy(),this.D.setStrategy(d),this.Z=this.D.build())},Pr.prototype.addRemoteWsLog=function(d){if(this.N.env!=It.BROWSER)throw new Error("cannot use net strategy on  mini program");for(this.U.push(d);this.U.size()>this.U.logCacheMax;)this.U.removeALog();this.connected()&&this.Z&&this.Z.active()},Pr.prototype.stopWebSocketServer=function(){this.clearHbTimer(),this.L=void 0,this.g&&(this.g.onclose=null,this.g.onerror=null,this.g.close(),this.g=null)},Pr.prototype.P=function(){this.g&&this.N.useStrategy&&(this.Z=this.D.build())},Pr.prototype.F=function(d){for(var g=[],p=1;p<arguments.length;p++)g[p-1]=arguments[p];var O=this.M=this.B,I="";switch(d){case"onconnecting":this.B==="never_opened"?this.B="first_connecting":this.B="reconnecting";break;case"onopen":this.B="connected",this.I.start(3e3),this.onSocketConnect();break;case"onclosed":this.B="closed";var j=g[0];j&&(I+=" close code=".concat(j.code)),this.I.stop(),this.onSocketClose();break;case"onerror":this.B="error",this.I.stop(),this.onSocketError()}d=se.WEBSOCKET_STATE_CHANGE+" log ws state change: ".concat(O," -> ").concat(this.B),I&&(d+=I),this.B==="error"?this.C.warn(d):this.C.info(d)},Pr.prototype.onSocketConnect=function(){},Pr.prototype.onSocketClose=function(){},Pr.prototype.onSocketError=function(){},Pr.prototype.onHeartBeatTimeout=function(){},Pr.prototype.openWebSocketLogServer=function(d,g,p,O){var I=this;g===void 0&&(g=!1),p===void 0&&(p=!1),d===""||!p&&this.url==d||((this.url&&this.url!==""||this.B==="never_opened")&&this.C.info(se.OPEN_WS+" log url change to: ".concat(d," , ").concat(this.enabled)),(this.url=d)&&this.enabled&&(p=function(){I.H&&(clearTimeout(I.H),I.H=null),I.stopWebSocketServer(),I.g=nt(d,I.N.env,I.q),I.g instanceof WebSocket&&(I.g.binaryType="arraybuffer"),I.P(),I.F("onconnecting"),I.g.onopen=function(){var j;I.J=!1,I.L=void 0,I.N.useStrategy&&(j=I.Z)!=null&&j.active(),I.F("onopen")},I.g.onclose=function(){for(var j=[],je=0;je<arguments.length;je++)j[je]=arguments[je];I.J=!1,I.F.apply(I,Pa(["onclosed"],j,!1))},I.g.onmessage=I.K.bind(I),I.g.onerror=function(){I.F("onerror")}},g?p():(g=this.B==="error"||this.M==="error",this.H||(this.H=setTimeout(p,O||(g?5e3:3e3))))))},Pr.prototype.resetSocketTimer=function(){this.H&&(clearTimeout(this.H),this.H=null)},Pr.prototype.closed=function(){return this.g==null||this.g.readyState==2||this.g.readyState==3},Pr.prototype.connected=function(){return this.g!==null&&this.g.readyState==1},Pr.prototype.connecting=function(){return this.g!==null&&this.g.readyState==0},Object.defineProperty(Pr.prototype,"canSendWs",{get:function(){var d=this.L,d=!d||performance.now()-d<5e3;return!(!this.g||this.g.readyState!==1)&&d},enumerable:!1,configurable:!0}),Pr.prototype.sendLogFrame=function(d){var g;return ar(this,void 0,void 0,function(){var p;return Lo(this,function(O){switch(O.label){case 0:return O.trys.push([0,2,,3]),[4,this.makeLogFrame(d)];case 1:return p=O.sent(),this.I.add(8*p.byteLength),this.connected()?((g=this.g)!=null&&g.send(p),[2,!0]):[2,!1];case 2:return O.sent(),[2,!0];case 3:return[2]}})})},Pr.prototype.makeLogFrame=function(d){return ar(this,void 0,void 0,function(){var g,p,O,I,j;return Lo(this,function(je){switch(je.label){case 0:return I=ka(d),p=this.N,g=p.appid,p=p.userid,O=this.seq++,I={detail_data:I},this.J?[3,2]:[4,vc(g)];case 1:if(!(j=je.sent()))throw new Error("litesign error");I=Zs(Zs({},I),{appid:g,product:2,id_name:p,timestamp:Math.floor(Date.now()/1e3),litesign:j}),je.label=2;case 2:return j=M.rtcreport.DetailLogRequest.encode(I).finish(),this.J=!0,[2,this.G(O,7,j)]}})})},Pr.prototype.G=function(d,g,p){var O=(p==null?void 0:p.length)||0,I=new Uint8Array(10+O);return I[0]=64,I[1]=g,I[2]=d>>24&255,I[3]=d>>16&255,I[4]=d>>8&255,I[5]=255&d,I[6]=O>>24&255,I[7]=O>>16&255,I[8]=O>>8&255,I[9]=255&O,p&&I.set(p,10),I},Pr.prototype.K=function(g){var g=new Uint8Array(g.data),p=g[0];this.L=performance.now(),this.startHbTimer(),p===64&&g[1]===8&&(g[2],g[3],g[4],g[5],p=g[6]<<24|g[7]<<16|g[8]<<8|g[9],g=new Uint8Array(g.slice(10,10+p)),M.rtcreport.DetailLogResponse.decode(g).code===101)&&(this.J=!1)},Pr.prototype.clearLogCacheAndUpload=function(){var d=this;this.connected()&&this.U.clear().forEach(function(g){d.sendLogFrame(g)})},Pr.prototype.clearHbTimer=function(){this.checkHbTimer&&(clearTimeout(this.checkHbTimer),this.checkHbTimer=void 0)},Pr.prototype.startHbTimer=function(){var d=this;this.clearHbTimer(),this.L!==void 0&&15e3<performance.now()-this.L?this.onHeartBeatTimeout():this.checkHbTimer=setTimeout(function(){var g;d.g&&(g=d.G(d.seq++,5),d.I.add(8*g.byteLength),d.g.send(g),d.startHbTimer())},5e3)},Pr.prototype.setUpBitrate=function(d){return d/=8,d=2e3<=d?5:200<=d?4:100<=d?3:10<=d?2:1<=d?1:0,this.setStrategy(d),d},Pr.prototype.destroy=function(){this.g=null,this.I.stop()},Pr);function Pr(d,g,p,O){this.U=d,this.N=g,this.C=p,this.q=O,this.g=null,this.B="never_opened",this.M="never_opened",this.D=new La(this),this.Z=null,this.J=!1,this.H=null,this.enabled=!0,this.seq=1,this.L=void 0,this.checkHbTimer=void 0,this.I=new yl("detail log"),this.D.setCache(this.U)}di.prototype.active=function(){var d=this;this.W.canSendWs&&this.U.size()!==0&&this.X.canSendLog()&&(this.X.getLog().forEach(function(g){d.W.sendLogFrame(g).then(function(p){!p&&d.W.enabled&&d.X.cacheLog(g)})}),this.X.onSendLog())},di.prototype.destroy=function(){this.X.onCanSendActive=void 0,this.X.destroy()};var Is=di;function di(d,g,p){this.W=d,this.U=g,this.X=p,this.X.onCanSendActive=this.active.bind(this)}function hu(d){this.cache=d}Aa=function(d,g){return(Aa=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(p,O){p.__proto__=O}:function(p,O){for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}))(d,g)};var Aa,pu;(function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function p(){this.constructor=d}Aa(d,g),d.prototype=g===null?Object.create(g):(p.prototype=g.prototype,new p)})(ls,pu=hu),ls.prototype.getLog=function(){return this.cache.clear()},ls.prototype.canSendLog=function(){return 0<this.cache.size()},ls.prototype.onSendLog=function(){},ls.prototype.cacheLog=function(d){this.cache.push(d)},ls.prototype.destroy=function(){};function ls(d){return pu.call(this,d)||this}gc=function(d,g){return(gc=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(p,O){p.__proto__=O}:function(p,O){for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}))(d,g)},function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function p(){this.constructor=d}gc(d,g),d.prototype=g===null?Object.create(g):(p.prototype=g.prototype,new p)}(jo,yc=hu),jo.prototype.canSendLog=function(){return!this.locked&&0<this.cache.size()},jo.prototype.getLog=function(){for(var d=[],g=0,p=!1;!p;){var O=this.cache.getOneLogPacket(this.maxPacketLen);if(!O||O.length<=0)break;var I=g+(O.length||0);I+this.cache.getOnePackMaxPacketLen(this.maxPacketLen)>this.maxPacketLen&&(p=!0),d.push(O),g=I}return this.lastTime=Date.now(),d},jo.prototype.onSendLog=function(){var d=this;this.locked=!0,this.timer=setTimeout(function(){d.locked=!1,d.onCanSendActive&&d.onCanSendActive()},this.maxDelay)},jo.prototype.cacheLog=function(d){this.cache.cacheLogPacket(d)},jo.prototype.destroy=function(){this.timer&&(clearTimeout(this.timer),this.timer=0)};var gc,yc,wi=jo;function jo(){var d=yc!==null&&yc.apply(this,arguments)||this;return d.name="NetworkFrequency",d.maxDelay=10,d.maxPacketLen=2e4,d.locked=!1,d.lastTime=0,d.timer=0,d}Vn=function(d,g){return(Vn=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(p,O){p.__proto__=O}:function(p,O){for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}))(d,g)},function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function p(){this.constructor=d}Vn(d,g),d.prototype=g===null?Object.create(g):(p.prototype=g.prototype,new p)}(fu,Xs=wi);var Vn,Xs,_l=fu;function fu(d){return d=Xs.call(this,d)||this,d.name="MaxBW",d.maxDelay=10,d.maxPacketLen=2e4,d}Da=function(d,g){return(Da=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(p,O){p.__proto__=O}:function(p,O){for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}))(d,g)},function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function p(){this.constructor=d}Da(d,g),d.prototype=g===null?Object.create(g):(p.prototype=g.prototype,new p)}(bc,Oa=wi);var Da,Oa,mu=bc;function bc(d){return d=Oa.call(this,d)||this,d.name="HighBig",d.maxDelay=100,d.maxPacketLen=2e4,d}Na=function(d,g){return(Na=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(p,O){p.__proto__=O}:function(p,O){for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}))(d,g)},function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function p(){this.constructor=d}Na(d,g),d.prototype=g===null?Object.create(g):(p.prototype=g.prototype,new p)}(io,oi=wi);var Na,oi,vu=io;function io(d){return d=oi.call(this,d)||this,d.name="HighSmall",d.maxDelay=100,d.maxPacketLen=1e4,d}$s=function(d,g){return($s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(p,O){p.__proto__=O}:function(p,O){for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}))(d,g)},function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function p(){this.constructor=d}$s(d,g),d.prototype=g===null?Object.create(g):(p.prototype=g.prototype,new p)}(Mo,_c=wi);var $s,_c,ea=Mo;function Mo(d){return d=_c.call(this,d)||this,d.name="LowBig",d.maxDelay=500,d.maxPacketLen=5e3,d}Wo=function(d,g){return(Wo=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(p,O){p.__proto__=O}:function(p,O){for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}))(d,g)},function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function p(){this.constructor=d}Wo(d,g),d.prototype=g===null?Object.create(g):(p.prototype=g.prototype,new p)}(oo,ds=wi);var Wo,ds,Rs=oo;function oo(d){return d=ds.call(this,d)||this,d.name="LowSmall",d.maxDelay=1e3,d.maxPacketLen=1e3,d}Object.defineProperty(ta.prototype,"strategy",{get:function(){return this.X},enumerable:!1,configurable:!0}),ta.prototype.setCache=function(d){this.U=d},ta.prototype.setStrategy=function(d){isNaN(d)||(this.X=d)},ta.prototype.build=function(){if(!this.U)throw new Error("cannot build log sender");switch(this.X){case 1:return new Is(this.W,this.U,new Rs(this.U));case 2:return new Is(this.W,this.U,new ea(this.U));case 3:return new Is(this.W,this.U,new vu(this.U));case 4:return new Is(this.W,this.U,new mu(this.U));default:return new Is(this.W,this.U,new _l(this.U))}};var La=ta;function ta(d){this.W=d,this.X=5}xo.Y=function(){return!(!window||!window.localStorage)},xo.bin2hex=function(d){for(var g,p="",O=0,I=(d+="").length;O<I;O++)p+=(g=d.charCodeAt(O).toString(16)).length<2?"0"+g:g;return p},xo.getCanvasFingerprint=function(O){var g=document.createElement("canvas"),p=g.getContext("2d"),p=(p.textBaseline="top",p.font="14px 'Arial'",p.fillStyle="#f60",p.fillRect(125,1,62,20),p.fillStyle="#069",p.fillText(O,2,15),p.fillStyle="rgba(102, 204, 0, 0.7)",p.fillText(O,4,17),g.toDataURL().replace("data:image/png;base64,","")),O=atob(p);return this.bin2hex(O.slice(-16,-12))},xo.generateUUID=function(){var d,g,p=localStorage.getItem(this.V);return p||(d=new Date().getTime(),p="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(O){var I=(d+16*Math.random())%16|0;return d=Math.floor(d/16),(O=="x"?I:3&I|8).toString(36)}),g=this.getCanvasFingerprint("hello, zego")+p.slice(8),localStorage.setItem(this.V,g),p)},xo.id=function(){var d;return xo.Y()?((d=localStorage.getItem(this.V))||(d=xo.generateUUID(),localStorage.setItem(this.V,d)),d):""},xo.V="z_deviceID";var gu=xo;function xo(){}var Sl=function(){this.url="",this.env=It.BROWSER,this.useStrategy=!0,this.token="",this.deviceid=gu.id(),this.ipStackMode=w.IPv4Prefer,this.networkState=Re.online};Object.defineProperty(Qo.prototype,"buffer",{get:function(){return this.queue},set:function(d){this.queue=d},enumerable:!1,configurable:!0}),Qo.prototype.push=function(d){if(!d)throw new Error("item null!");this.cacheByteLength+=d.length,d&&this.queue.push(d),this.cacheByteLength+=d.length},Qo.prototype.pop=function(){var d=this.queue[0]||"";return this.cacheByteLength-=d.length,this.queue.shift()},Qo.prototype.front=function(){return this.queue[0]},Qo.prototype.getFrontList=function(d){return this.queue.slice(0,d=d===void 0?1:d)},Qo.prototype.removeFrontList=function(d){var g=this.getFrontList(d=d===void 0?1:d).reduce(function(p,O){return p+=O.length},0);return this.cacheByteLength-=g,this.queue.splice(0,d)},Qo.prototype.clear=function(){this.timer&&(console.warn("clear cache"+this.name),clearInterval(this.timer)),this.queue=[]},rr=Qo;function Qo(d){this.name=d=d===void 0?"":d,this.queue=[],this.timer=0,this.cacheByteLength=0}Jo=function(d,g){return(Jo=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(p,O){p.__proto__=O}:function(p,O){for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}))(d,g)};var Jo,Ko,Ma=function(){return(Ma=Object.assign||function(d){for(var g,p=1,O=arguments.length;p<O;p++)for(var I in g=arguments[p])Object.prototype.hasOwnProperty.call(g,I)&&(d[I]=g[I]);return d}).apply(this,arguments)},Bo=function(d,g,p){if(p||arguments.length===2)for(var O,I=0,j=g.length;I<j;I++)!O&&I in g||((O=O||Array.prototype.slice.call(g,0,I))[I]=g[I]);return d.concat(O||Array.prototype.slice.call(g))},yu=(function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function p(){this.constructor=d}Jo(d,g),d.prototype=g===null?Object.create(g):(p.prototype=g.prototype,new p)}(Yo,Ko=rr),Yo.prototype.size=function(){return this.queue.length},Yo.prototype.getOnePackMaxPacketLen=function(d){return d&&d<this.tt?d:this.tt},Yo.prototype.getOneLogPacket=function(d){var g=[],p=0,O="";if(this.size()){var I=JSON.parse(this.queue[this.queue.length-1]).userid,j=this.N.userid||I;if(j){for(var je=this.getOnePackMaxPacketLen(d);0<this.queue.length&&(!d||p===0||p<d);){var Be=this.queue[0].length;if(p&&je<p+Be)return O=JSON.stringify(g);var rt=JSON.parse(this.queue[0]),rt=Ma(Ma({},rt),{userid:rt.userid||j,roomid:rt.roomid||this.N.roomid});p+=Be,g.push(rt),this.pop()}return(O=JSON.stringify(g))===""?void 0:O}}},Yo.prototype.cacheLogPacket=function(g){var g=JSON.parse(g);this.size()+g.length<this.logCacheMax&&(g=g.map(function(p){return JSON.stringify(p)}),this.queue=Bo(Bo([],g,!0),this.queue,!0))},Yo.prototype.clear=function(){for(var d=[];0<this.queue.length;){var g=this.getOneLogPacket();if(!g)break;d.push(g)}return d},Yo.prototype.removeALog=function(){for(var d=this.queue,g=0;g<d.length;g++){var p=void 0;try{p=JSON.parse(d[g])}catch{}if(!p||p.level<2)return void(this.queue=Bo(Bo([],d.slice(0,g),!0),d.slice(g+1),!0))}this.pop()},Yo);function Yo(d,g){g===void 0&&(g=1/0);var p=Ko.call(this,"ws cache")||this;return p.logCacheMax=g,p.tt=64e3,p.N=d,p}var Tl=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},bu=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}},_u=(Uo.fetchWhitelist=function(d,g){return Tl(this,void 0,void 0,function(){var p,O,I,j,je,Be,rt,qe,re,Rt;return bu(this,function(Ht){switch(Ht.label){case 0:return je=d.product,p=d.appID,Rt=d.userID,O=d.token,I=d.deviceID,rt=d.bizType,j=(j=this.domains[this.activeIndex])||"detaillog-global.zego.im",j="https://".concat(j,"/zglog/whitelist"),je={product:je,biz_type:""+rt,appid:""+p,uin:Rt,timestamp:""+Date.now(),deviceid:I},O?(je.token=O,[3,3]):[3,1];case 1:return Be=je,[4,vc(p)];case 2:Be.litesign=Ht.sent(),Ht.label=3;case 3:return rt=new URLSearchParams(je),qe="".concat(j,"?").concat(rt.toString()),g?[4,new Promise(function(xt,En){g.startHttpRequest({location:qe,method_no:1,serviceType:2},function(Xt){Xt.status_code===200?xt(Xt.body):En("request fail. status="+Xt.status_code)},function(Xt){En("request fail. result: "+JSON.stringify(Xt))})})]:[3,5];case 4:return[2,Ht.sent()];case 5:return Ht.trys.push([5,10,,14]),[4,fetch(qe,{method:"GET"})];case 6:return(re=Ht.sent()).ok?[4,re.json()]:[3,8];case 7:return[2,Ht.sent()];case 8:throw"get list fail. status="+re.status+"msg="+re.statusText;case 9:return[3,14];case 10:if(Rt=Ht.sent(),Uo.activeIndex!==Uo.domains.length-1)return[3,11];throw Uo.activeIndex=0,"get list fail. error ".concat(Rt," ").concat(JSON.stringify(Rt));case 11:return Uo.activeIndex++,[4,Uo.fetchWhitelist(d,g)];case 12:return[2,Ht.sent()];case 13:return[3,14];case 14:return[2]}})})},Uo.domains=[],Uo.activeIndex=0,Uo);function Uo(){}var El=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},Su=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}},br=(Di.prototype.nt=function(d){return"file_"+d},Di.prototype.saveLogs=function(d,g,p,O){return g=g.map(function(I){return{log:I,instanceId:p}}),this.it.addList(this.nt(d),g)},Di.prototype.queryList=function(d,g,p){return g=[{field:"instanceId",value:g}],this.it.queryByCursor(this.nt(d),{maxCount:p,conditions:g})},Di.prototype.storedBytesSize=function(d){var g=this;return new Promise(function(p,O){return El(g,void 0,void 0,function(){var I,j;return Su(this,function(je){return I=this.it.openCursor(this.nt(d)),j=0,I.onsuccess=function(qe){var rt,qe=(qe=qe.target)==null?void 0:qe.result;qe?(rt=qe.value,j+=rt.log.length,qe.continue()):p(j)},I.onerror=function(Be){O(Be)},[2]})})})},Di.prototype.lines=function(d,g){return this.it.lines(this.nt(d),isNaN(g)?void 0:[{field:"instanceId",value:g}])},Di.prototype.deleteAll=function(d,g){return this.it.deleteAll(this.nt(d),g)},Di);function Di(d){this.it=d}var Sc=function(){return(Sc=Object.assign||function(d){for(var g,p=1,O=arguments.length;p<O;p++)for(var I in g=arguments[p])Object.prototype.hasOwnProperty.call(g,I)&&(d[I]=g[I]);return d}).apply(this,arguments)},Oi=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},Cl=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}},zo=(ho.prototype.save=function(d,g){return this.it.save(this.et,d,g)},ho.prototype.queryList=function(d,g){return this.it.getAll(this.et,d,g)},ho.prototype.delete=function(d,g){return this.it.deleteItems(this.et,d,g)},ho.prototype.lines=function(){return this.it.lines(this.et)},ho.prototype.deleteByCount=function(d){return this.it.deleteByCount(this.et,d)},ho.prototype.deleteAll=function(){return this.it.deleteAll(this.et)},ho.prototype.getItem=function(d,g){return this.it.queryById(this.et,d,g)},ho.prototype.update=function(d,g){return Oi(this,void 0,void 0,function(){var p;return Cl(this,function(O){switch(O.label){case 0:return[4,this.getItem(d.id,g)];case 1:return(p=O.sent())?(p=Sc(Sc({},p),d),[2,this.it.update(this.et,p,g)]):[2]}})})},ho);function ho(d){this.it=d,this.et="log_instance"}po.prototype.save=function(d,g){return this.it.save(this.et,d,g)},po.prototype.update=function(d,g){return this.it.update(this.et,d,g)},po.prototype.delete=function(d,g){return this.it.deleteItems(this.et,[d],g)},po.prototype.queryList=function(d){return this.it.queryByCursor(this.et,{transaction:d})};var Tc=po;function po(d){this.it=d,this.et="file_usage"}var ks=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},Ps=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}},wl=(Ii.prototype.openDB=function(d,g){return ks(this,void 0,void 0,function(){var p,O=this;return Ps(this,function(I){switch(I.label){case 0:return p=window.indexedDB.open(g.database+"_"+d,g.version),[4,new Promise(function(j){p.onupgradeneeded=function(je){var Be=je.target.result;g.tableList.forEach(function(rt){var qe;Be.objectStoreNames.contains(rt.tableName)||(qe=Be.createObjectStore(rt.tableName,{keyPath:"id",autoIncrement:!0}),rt.tableItems.forEach(function(re){re.index&&qe.createIndex(re.itemName,re.itemName,{unique:re.unique})}))})},p.onsuccess=function(je){var Be=(je=je.target)==null?void 0:je.result;(O.rt=Be).onclose=function(){O.onDBClose&&O.onDBClose(),O.rt=void 0,p.onsuccess=null,p.onupgradeneeded=null,Be.onclose=null},j(p)}})];case 1:return I.sent(),[2]}})})},Ii.prototype.closeDB=function(){var d;return ks(this,void 0,void 0,function(){return Ps(this,function(g){return this.rt&&((d=this.rt)!=null&&d.close(),this.rt=void 0),[2]})})},Ii.prototype.st=function(){if(!this.rt)throw new Error("indexDB not open")},Ii.prototype.getTransaction=function(d,g){return g===void 0&&(g=!1),this.st(),this.rt.transaction(d,g?"readwrite":void 0)},Ii.prototype.save=function(d,g,p){var O=this;return new Promise(function(I){var j=(p=p||O.getTransaction([d],!0)).objectStore(d).add(g);j.onsuccess=function(){return I(j.result)}})},Ii.prototype.addList=function(d,g,p){return ks(this,void 0,void 0,function(){var O,I;return Ps(this,function(j){switch(j.label){case 0:return p=p||this.getTransaction([d],!0),O=p.objectStore(d),I=[],g.forEach(function(je){var Be=new Promise(function(rt,qe){var re=O.add(je);re.onsuccess=function(){return rt()},re.onerror=function(Rt){return qe(re.error)}});I.push(Be)}),[4,Promise.all(I)];case 1:return j.sent(),[2]}})})},Ii.prototype.update=function(d,g,p){var O=this;return new Promise(function(I){(p=p||O.getTransaction([d],!0)).objectStore(d).put(g).onsuccess=function(){return I()}})},Ii.prototype.queryById=function(d,g,p){var O=this;return new Promise(function(I){var j=(p=p||O.getTransaction([d])).objectStore(d).get(g);j.onsuccess=function(){return I(j.result||null)}})},Ii.prototype.queryByCursor=function(d,g){var p=this;return new Promise(function(O,I){var j=g.maxCount,je=g.conditions,Be=g.transaction,Be=(Be||p.getTransaction([d])).objectStore(d),rt=[],qe=null,re=(qe=je&&0<je.length&&(re=je[0],Be.indexNames.contains(re.field))?Be.index(re.field):qe)&&je!=null&&je.length?qe.openCursor(p.ot(je[0])):Be.openCursor();re.onsuccess=function(xt){var Ht,xt=xt.target.result;xt&&(!j||rt.length<j)?(Ht=xt.value,je!=null&&je.length&&!p.ut(Ht,je)||rt.push(Ht),xt.continue()):O(rt)},re.onerror=function(Rt){I(Rt.target.error)}})},Ii.prototype.getAll=function(d,g,p){var O=this;return new Promise(function(I,j){var je=(p=p||O.getTransaction([d])).objectStore(d).getAll(void 0,g);je.onsuccess=function(){return I(je.result)},je.onerror=function(Be){j(Be)}})},Ii.prototype.lines=function(d,g,p){var O=this;return new Promise(function(I,j){var je,Be=(p=p||O.getTransaction([d])).objectStore(d),rt=0,qe=!(g==null||!g.length),re=void 0,Rt=null;g&&0<g.length?(re=g[0],(Rt=(qe=Be.indexNames.contains(re.field)&&(Rt=Be.index(re.field))&&g.length===1?!1:qe)?Rt&&re?Rt.openCursor(O.ot(re)):Be.openCursor(void 0):Rt&&re?Rt.openKeyCursor(O.ot(re)):Be.openKeyCursor(void 0)).onsuccess=function(En){var xt,En=En.target.result;En?(qe&&(xt=En.value,g!=null)&&g.length&&!O.ut(xt,g)||rt++,En.continue()):I(rt)},Rt.onerror=function(Ht){j(Ht.target.error)}):((je=Be.count()).onsuccess=function(){return I(je.result)},je.onerror=function(){return j(je.error)})})},Ii.prototype.openCursor=function(d,g){return(g=g||this.getTransaction([d])).objectStore(d).openCursor()},Ii.prototype.deleteById=function(d,g,p){var O=this;return new Promise(function(I,j){var je=(p=p||O.getTransaction([d],!0)).objectStore(d).delete(g);je.onsuccess=function(){return I()},je.onerror=function(){j()}})},Ii.prototype.deleteByCount=function(d,g){var p=this;return new Promise(function(O,I){return ks(p,void 0,void 0,function(){var j,je;return Ps(this,function(Be){switch(Be.label){case 0:j=8192,Be.label=1;case 1:return 0<g?[4,this.queryByCursor(d,{maxCount:Math.min(g,j)})]:[3,4];case 2:return(je=Be.sent()).length===0?[3,4]:(g-=je.length,[4,this.deleteItems(d,je)]);case 3:return Be.sent(),[3,1];case 4:return O(),[2]}})})})},Ii.prototype.deleteAll=function(d,g){var p=this;return new Promise(function(O,I){return ks(p,void 0,void 0,function(){var j;return Ps(this,function(je){return g=g||this.getTransaction([d],!0),j=g.objectStore(d),(j=j.clear()).onsuccess=function(){return O()},j.onerror=function(Be){I()},[2]})})})},Ii.prototype.deleteItems=function(d,g,p){var O=this;return new Promise(function(I){return ks(O,void 0,void 0,function(){var j;return Ps(this,function(je){switch(je.label){case 0:return p=p||this.getTransaction([d],!0),j=p.objectStore(d),[4,Promise.all(g.map(function(Be){return new Promise(function(rt){j.delete(Be.id).onsuccess=function(){return rt()}})}))];case 1:return je.sent(),I(),[2]}})})})},Ii.prototype.ut=function(d,g){return g.every(function(j){var O=d[j.field],I=j.value,j=j.operator;switch(j===void 0?1:j){case 1:return O===I;case 2:return O!==I;case 3:return O<I;case 4:return I<O;case 5:return O<=I;case 6:return I<=O;default:return!1}})},Ii.prototype.ot=function(p){var g=p.value,p=p.operator;switch(p===void 0?1:p){case 1:return IDBKeyRange.only(g);case 3:return IDBKeyRange.upperBound(g,!0);case 5:return IDBKeyRange.upperBound(g);case 4:return IDBKeyRange.lowerBound(g,!0);case 6:return IDBKeyRange.lowerBound(g);default:return}},Ii);function Ii(){}var jr=function(d,g,p){if(p||arguments.length===2)for(var O,I=0,j=g.length;I<j;I++)!O&&I in g||((O=O||Array.prototype.slice.call(g,0,I))[I]=g[I]);return d.concat(O||Array.prototype.slice.call(g))},Tu={version:1,database:"zego_rtc_logger",tableList:jr(jr([{tableName:"log_instance",tableItems:[]}],new Array(20).fill(void 0).map(function(d,g){return{tableName:"file_"+(g+1),tableItems:[{itemName:"log",index:!1,unique:!1},{itemName:"instanceId",index:!0,unique:!1}]}}),!0),[{tableName:"file_usage",tableItems:[]}],!1)},xa=Tu.tableList.map(function(d){return d.tableName});Ec=function(d,g){return(Ec=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(p,O){p.__proto__=O}:function(p,O){for(var I in O)Object.prototype.hasOwnProperty.call(O,I)&&(p[I]=O[I])}))(d,g)},function(d,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");function p(){this.constructor=d}Ec(d,g),d.prototype=g===null?Object.create(g):(p.prototype=g.prototype,new p)}(Cc,Eu=rr),Cc.prototype.size=function(){return this.queue.length};var Ec,Eu,Il=Cc;function Cc(d){d===void 0&&(d=1/0);var g=Eu.call(this,"zzziplog storage_"+Date.now())||this;return g.logCacheMax=d,g}var Vo=function(){return(Vo=Object.assign||function(d){for(var g,p=1,O=arguments.length;p<O;p++)for(var I in g=arguments[p])Object.prototype.hasOwnProperty.call(g,I)&&(d[I]=g[I]);return d}).apply(this,arguments)},wc=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},Ic=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}},Rc=(As.prototype.pushTask=function(d,g,p,O,I){d={task:d},g&&(d=Vo(Vo({},d),{args:g})),p&&(d=Vo(Vo({},d),{successCallback:p})),O&&(d=Vo(Vo({},d),{errorCallback:O})),I&&(d=Vo(Vo({},d),{completeCallback:I})),this.ct.push(d)},As.prototype.ft=function(d,g){return wc(this,void 0,void 0,function(){var p,O;return Ic(this,function(I){switch(I.label){case 0:p=null,I.label=1;case 1:return I.trys.push([1,4,5,6]),d&&d.args?p=d.task.apply(d,d.args):d&&(p=d.task()),p instanceof Promise?[4,p]:[3,3];case 2:p=I.sent(),I.label=3;case 3:return d.successCallback&&d.successCallback(p),[3,6];case 4:if(O=I.sent(),d.errorCallback)return d.errorCallback(O),[3,6];throw O;case 5:return g(),d.completeCallback&&d.completeCallback(),[7];case 6:return[2]}})})},As.prototype.runATask=function(){return wc(this,void 0,void 0,function(){var d,g=this;return Ic(this,function(p){switch(p.label){case 0:return this.ct.length<=0?[2]:(d=this.ct[0],d?[4,this.ft(d,function(){g.ct.shift()})]:[3,2]);case 1:p.sent(),p.label=2;case 2:return[2]}})})},As.prototype.runAllTask=function(){return wc(this,void 0,void 0,function(){return Ic(this,function(d){switch(d.label){case 0:return 0<this.ct.length?[4,this.runATask()]:[3,2];case 1:return d.sent(),[3,0];case 2:return[2]}})})},As.prototype.size=function(){return this.ct.length},As);function As(){this.ct=[]}Ba.prototype.writeLine=function(d){d&&d!==""&&this.ht.push(d)},Ba.prototype.saveAs=function(d,g){var p=document.createElement("a");p.href=URL.createObjectURL(d),p.download=g,p.click()},Ba.prototype.createZip=function(){var d="";return 0<this.ht.length&&(d=this.ht.join(`
`),this.ht=[]),d=(g=>{for(var p,O=0,I=g.length,j="";O<I;)p=g.subarray(O,Math.min(O+32768,I)),j+=String.fromCharCode.apply(null,Array.from(p)),O+=32768;return btoa(j)})(ka(d)),new Blob([d],{type:"text/plain;charset=utf-8"})};var Cu=Ba;function Ba(){this.ht=[]}var na=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},Ds=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}},ra=(Xn.prototype.setUploadUrl=function(d){this.lt=d,this.vt=0,this.dt=this.lt[this.vt]},Xn.prototype.sendRequest=function(d,g){return g===void 0&&(g=!1),na(this,void 0,void 0,function(){var p,O;return Ds(this,function(I){switch(I.label){case 0:if(!this.dt)throw new Error("upload url is empty");I.label=1;case 1:return I.trys.push([1,3,,7]),[4,kl.post("https://".concat(this.dt,"/log/").concat(g?"userupload":"upload"),d,this.proxyCtrl)];case 2:if((p=I.sent()).code!==0)throw p;return this.C.info("zl.zlu.sr zip log ".concat(this.dt)),[3,7];case 3:if(((p=I.sent())==null?void 0:p.code)!==101&&this.lt.length&&this.vt!==this.lt.length-1)return[3,4];throw O=this.dt,this.vt=0,this.dt=this.lt[this.vt],new Error("upload logs ".concat(O," failed, error=").concat(JSON.stringify(p)));case 4:return this.vt<this.lt.length-1&&this.vt++,this.dt=this.lt[this.vt],[4,this.sendRequest(d,g)];case 5:I.sent(),I.label=6;case 6:return[3,7];case 7:return[2]}})})},Xn.prototype.upload=function(d,g,p){return na(this,void 0,void 0,function(){var O,I,j,je,Be,rt=this;return Ds(this,function(qe){switch(qe.label){case 0:return O=d.appId,I=d.userId,j=d.deviceId,je=d.token,[4,vc(O)];case 1:if(Be=qe.sent(),!(!O||!I&&!j||!Be&&!je))return[2,new Promise(function(re,Rt){return na(rt,void 0,void 0,function(){var Ht,xt=this;return Ds(this,function(En){switch(En.label){case 0:return Ht=function(){return na(xt,void 0,void 0,function(){var Xt,tn,dn=this;return Ds(this,function(gn){switch(gn.label){case 0:this.wt=!0,(Xt=new FormData).append("logs",g),Xt.append("appid",O.toString()),I&&Xt.append("uin",I==null?void 0:I.toString()),Xt.append("timestamp",new Date().getTime().toString()),j&&Xt.append("deviceid",j),Be?Xt.append("litesign",Be):je&&Xt.append("token",je),gn.label=1;case 1:return gn.trys.push([1,3,4,5]),[4,this.sendRequest(Xt,p)];case 2:return gn.sent(),[3,5];case 3:return tn=gn.sent(),Rt(tn),[3,5];case 4:return setTimeout(function(){return na(dn,void 0,void 0,function(){return Ds(this,function(wn){switch(wn.label){case 0:return this.wt=!1,[4,this.bt.runATask()];case 1:return wn.sent(),[2]}})})},100),[7];case 5:return[2]}})})},this.wt?(this.bt.pushTask(Ht,[],function(){re()},function(Xt){Rt(Xt)}),[3,3]):[3,1];case 1:return[4,Ht()];case 2:En.sent(),re(),En.label=3;case 3:return[2]}})})})];throw new Error("cannot upload logs, please login room before you upload logs.")}})})},Xn);function Xn(d,g){this.C=d,this.proxyCtrl=g,this.yt="detaillog-global.zego.im",this.dt=this.yt,this.lt=[],this.vt=0,this.bt=new Rc,this.wt=!1}var wu=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},Rl=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}},kl=(Iu.post=function(d,g,p){var O=this;return new Promise(function(I,j){return wu(O,void 0,void 0,function(){var je;return Rl(this,function(Be){try{p?p.startHttpRequest({location:d,body:g,method_no:2,headers:[{name:"Content-Type",val:"multipart/form-data"}],serviceType:2},function(rt){rt.status_code===200?I(rt.body):j("request fail. status="+rt.status_code)},function(rt){j("request fail. result: "+JSON.stringify(rt))}):((je=new XMLHttpRequest).open("POST",d,!0),je.responseType="json",je.send(g),je.onreadystatechange=function(){je.readyState===XMLHttpRequest.DONE&&(je.status===200?I(je.response):j("request fail. status="+je.status))})}catch(rt){j(rt)}return[2]})})})},Iu);function Iu(){}var Ua=function(){return(Ua=Object.assign||function(d){for(var g,p=1,O=arguments.length;p<O;p++)for(var I in g=arguments[p])Object.prototype.hasOwnProperty.call(g,I)&&(d[I]=g[I]);return d}).apply(this,arguments)},Pl=(Ri.prototype.build=function(d){for(var g=Ua({},d),p=[],O=0,I=this._t;O<I.length;O++){var j=I[O];p.push(g[j])}for(var je=0,Be=this.gt;je<Be.length;je++){var rt=g[j=Be[je]];rt!==this.Ot[j]&&(this.Ot[j]=rt,p.push("".concat(j,": ").concat(rt)))}return p.join(" @ ")},Ri.prototype.buildFullMessageLog=function(d){return d=JSON.parse(d),d=Ua(Ua({},this.Ot),d),JSON.stringify(d)},Ri);function Ri(d){this.N=d,this.Ot={},this._t=["level","time","action","content","streamid"],this.gt=["appid","userid","roomid","sessionid"],this.St=0}var kc=function(){return(kc=Object.assign||function(d){for(var g,p=1,O=arguments.length;p<O;p++)for(var I in g=arguments[p])Object.prototype.hasOwnProperty.call(g,I)&&(d[I]=g[I]);return d}).apply(this,arguments)},xr=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},hi=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}},Al=new TextEncoder;function Ru(d){return Al.encode(d).length}function za(je){var je=new Date(je),g=je.getFullYear(),p=String(je.getMonth()+1).padStart(2,"0"),O=String(je.getDate()).padStart(2,"0"),I=String(je.getHours()).padStart(2,"0"),j=String(je.getMinutes()).padStart(2,"0"),je=String(je.getSeconds()).padStart(2,"0");return"".concat(g).concat(p).concat(O).concat(I).concat(j).concat(je)}si.prototype.setFileConfig=function(d,g){typeof d=="number"&&(d=d<3?3:20<d?20:Math.round(d),this.fileConfig.count=d),typeof g=="number"&&0<=g&&(this.fileConfig.size=g)},Object.defineProperty(si.prototype,"dbOpened",{get:function(){return this.kt},enumerable:!1,configurable:!0}),Object.defineProperty(si.prototype,"Et",{get:function(){return this.N.appid},enumerable:!1,configurable:!0}),si.prototype.At=function(d){return xr(this,void 0,void 0,function(){var g,p,O=this;return hi(this,function(I){switch(I.label){case 0:return g=[],[4,new Promise(function(j,je){return xr(O,void 0,void 0,function(){var Be,rt,qe;return hi(this,function(re){switch(re.label){case 0:return(Be=this.it.getTransaction(xa,!0)).oncomplete=function(){j()},Be.onerror=function(Rt){je(Be.error)},Be.onabort=function(Rt){je(Be.error)},[4,this.jt.queryList(Be)];case 1:return rt=re.sent(),[4,this.Tt.queryList(void 0,Be)];case 2:return qe=re.sent(),(p=rt[0])&&(qe.forEach(function(Rt){Rt.lastLogTime<p.lastTime&&g.push(Rt)}),this.xt.deleteAll(p.fileId,Be),this.Tt.delete(g,Be)),[2]}})})})];case 1:return I.sent(),[2]}})})},si.prototype.checkUsingFile=function(){return xr(this,void 0,void 0,function(){var d,g,p,O,I=this;return hi(this,function(j){switch(j.label){case 0:return d=[],p=!(g=[]),[4,new Promise(function(je,Be){return xr(I,void 0,void 0,function(){var rt,qe,re,Rt,Ht,xt,En=this;return hi(this,function(Xt){switch(Xt.label){case 0:return(rt=this.it.getTransaction(xa,!0)).oncomplete=function(){je()},rt.onerror=function(tn){Be(rt.error)},rt.onabort=function(tn){Be(rt.error)},[4,this.jt.queryList(rt)];case 1:return qe=Xt.sent(),[4,this.Tt.queryList(void 0,rt)];case 2:if(re=Xt.sent(),xt=qe[qe.length-1],0<(Ht=qe.length-this.fileConfig.count)&&(g=qe.splice(0,Ht)),xt&&xt.byteLength>=this.fileConfig.size?(p=!0,qe.length===this.fileConfig.count&&(Ht=qe.shift())&&g.push(Ht)):xt||(p=!0),g.length&&((Rt=g[g.length-1])&&re.forEach(function(tn){(!tn.active||3e5<Date.now()-tn.lastLogTime)&&tn.lastLogTime<Rt.lastTime&&d.push(tn)}),g.forEach(function(tn){En.xt.deleteAll(tn.fileId,rt),En.jt.delete(tn,rt)}),this.Tt.delete(d,rt)),p){if(Ht=Date.now(),!(xt=new Array(20).fill(1).map(function(tn,dn){return dn+1}).find(function(tn){return!qe.find(function(dn){return dn.fileId===tn})})))throw"not found can use file";this.jt.save({fileId:xt,byteLength:0,startTime:Ht,lastTime:Ht},rt)}return[2]}})})})];case 1:return j.sent(),[4,this.jt.queryList()];case 2:return O=j.sent(),[2,O[O.length-1]]}})})},si.prototype.uploadLegacyLog=function(d,g,p){return g===void 0&&(g=!0),p===void 0&&(p=5),xr(this,void 0,void 0,function(){var O,I,j=this;return hi(this,function(je){switch(je.label){case 0:return this.Rt?[4,this.Tt.queryList()]:[2];case 1:return I=(I=je.sent()).filter(function(Be){return!(Be.id===j.It||!Be.userIds.length||Be.active&&!(3e5<Date.now()-Be.lastLogTime)||g&&Be.userIds.includes(j.N.userid))}),O=I.reduce(function(Be,rt){var qe=rt.userIds[rt.userIds.length-1];return qe&&(Be[qe]=Be[qe]||[],Be[qe].push(rt)),Be},{}),I=Object.keys(O),I=I.map(function(Be){return xr(j,void 0,void 0,function(){var rt,qe,re=this;return hi(this,function(Rt){return rt=O[Be],qe=function(){return xr(re,void 0,void 0,function(){return hi(this,function(Ht){switch(Ht.label){case 0:return[4,this.Nt(Be,d,rt)];case 1:return Ht.sent(),[2]}})})},[2,new Promise(function(Ht,xt){return xr(re,void 0,void 0,function(){var En;return hi(this,function(Xt){switch(Xt.label){case 0:return this.dbOpened?[3,1]:(this.Dt.pushTask(qe,[],function(){Ht()},function(tn){xt(tn)}),[3,5]);case 1:return Xt.trys.push([1,3,,4]),[4,qe()];case 2:return Xt.sent(),[3,4];case 3:return En=Xt.sent(),xt(En),[2];case 4:Ht(),Xt.label=5;case 5:return[2]}})})}).catch(function(Ht){return{error:Ht,index:0}})]})})}),p--,[4,Promise.all(I)];case 2:return I=je.sent(),I.find(function(Be){return Be==null?void 0:Be.error})&&p?[4,this.uploadLegacyLog(d,g,p)]:[3,4];case 3:je.sent(),je.label=4;case 4:return[2]}})})},si.prototype.openDB=function(){return xr(this,void 0,void 0,function(){var d;return hi(this,function(g){switch(g.label){case 0:return d=!1,this.Zt||(this.Zt=this.it.openDB(this.Et,Tu),d=!0),[4,this.Zt];case 1:return g.sent(),[4,this.Ut()];case 2:return g.sent(),this.Zt=void 0,this.kt=!0,d?[4,this.Dt.runAllTask()]:[3,5];case 3:return g.sent(),[4,this.Lt.runATask()];case 4:g.sent(),this.Pt(),g.label=5;case 5:return[2]}})})},si.prototype.Ut=function(d){return xr(this,void 0,void 0,function(){var g,p,O,I;return hi(this,function(j){switch(j.label){case 0:return g=this.It,p=!1,g!==void 0?[3,1]:(p=!0,[3,3]);case 1:return[4,this.Tt.getItem(g,d)];case 2:(O=j.sent())?O.active||this.Tt.update({id:O.id,active:1},d):p=!0,j.label=3;case 3:return p?(O=Date.now(),I={appId:this.Et,userIds:this.Ft,active:1,lastLogTime:O,createdAt:O,logQuantity:0,byteLength:0},this.N.userid&&!this.Ft.includes(this.N.userid)&&this.Ft.push(this.N.userid),[4,this.Tt.save(I,d)]):[3,5];case 4:I=j.sent(),this.It=I,j.label=5;case 5:return[2]}})})},si.prototype.zt=function(){return this.Rt&&si.isEnvSupport()&&!this.kt&&!this.Zt},si.prototype.enable=function(){this.Rt||(this.Rt=!0,this.zt()&&this.openDB())},si.prototype.saveLog=function(d){for(this.zt()&&this.openDB(),d=JSON.parse(d),this.Ft&&d.userid&&!this.Ft.includes(d.userid)&&(this.Ft.push(d.userid),this.dbOpened)&&this.Tt.update({id:this.It,userIds:this.Ft}),this.U.push(this.Mt.build(d));this.U.size()>this.U.logCacheMax;)this.U.pop();this.Bt||this.Pt()},si.prototype.Pt=function(d){return d===void 0&&(d=!1),xr(this,void 0,void 0,function(){var g,p=this;return hi(this,function(O){switch(O.label){case 0:return this.Rt?this.dbOpened?(g=!1,this.Bt||(g=!0,this.Bt=new Promise(function(I,j){function je(){xr(p,void 0,void 0,function(){var Be,rt,qe,re,Rt,Ht,xt,En,Xt,tn,dn=this;return hi(this,function(gn){switch(gn.label){case 0:if(!(Be=this.It))return I(),[2];if(!this.dbOpened||!this.fileConfig.size)return I(),[2];if((rt=this.U.getFrontList(100)).length<100&&(Rt=Date.now(),Rt=this.Ct&&1e4<=Rt-this.Ct,tn=rt.length!==0,!tn||!d&&!Rt))return tn?this.Ht||(this.Ht=window.setTimeout(function(){dn.Pt()},1e4)):(this.Ht&&window.clearTimeout(this.Ht),this.Ht=void 0),I(),[2];qe=function(wn){var Gn="QuotaExceededError";(wn==null?void 0:wn.name)===Gn||wn+""==Gn?dn.At().finally(function(){setTimeout(function(){je()},5e3)}):j(wn)},gn.label=1;case 1:return gn.trys.push([1,3,,4]),[4,this.checkUsingFile()];case 2:return re=gn.sent(),[3,4];case 3:return Rt=gn.sent(),qe(Rt),[2];case 4:return Ht=re.fileId,xt=rt.reduce(function(wn,Gn){return wn+=Ru(Gn)},0),(En=this.it.getTransaction(xa,!0)).oncomplete=function(){dn.U.removeFrontList(rt.length),je()},En.onerror=function(wn){qe(En.error)},En.onabort=function(wn){qe(En.error)},Xt=Date.now(),this.It?[4,this.Tt.getItem(this.It,En)]:[3,6];case 5:(tn=gn.sent())?(this.Ct=Xt,rt.length,this.Tt.update({id:this.It,byteLength:tn.byteLength+xt,logQuantity:tn.logQuantity+rt.length,lastLogTime:Xt},En)):this.Ut(En),gn.label=6;case 6:return this.xt.saveLogs(Ht,rt,Be,En),re.byteLength+=xt,re.lastTime=Xt,this.jt.update(re,En),[2]}})})}je()}),this.Bt.finally(function(){p.Bt=void 0})),[4,this.Bt]):[2]:[2];case 1:return O.sent(),!d||g?[3,3]:[4,this.Pt(d)];case 2:O.sent(),O.label=3;case 3:return[2]}})})},si.isEnvSupport=function(){return!!(window&&"indexedDB"in window)},si.prototype.qt=function(d,g,p){return xr(this,void 0,void 0,function(){var O,I,j,je,Be,rt,qe,re,Rt,Ht,xt=this;return hi(this,function(En){switch(En.label){case 0:return p?[3,2]:[4,this.Tt.queryList()];case 1:O=En.sent(),p=O.filter(function(Xt){return Xt.userIds.includes(d)}),En.label=2;case 2:I=new Cu,j=0,je=[],Be=this.fileConfig.size,rt=function(){return xr(xt,void 0,void 0,function(){var Xt,tn,dn,gn,wn,Gn,Er,$n,Un;return hi(this,function(Br){switch(Br.label){case 0:Xt=I.createZip(),tn={appId:this.Et,deviceId:this.N.deviceid},d===this.N.userid&&(tn.token=this.N.token),tn.userId=d,wn=je.reduce(function(Cr,wr){return wr.startTime<dn&&(Cr.startTime=wr.startTime),gn<wr.endTime&&(Cr.endTime=wr.endTime),Cr},{startTime:0,endTime:0}),dn=wn.startTime,gn=wn.endTime,Br.label=1;case 1:return Br.trys.push([1,3,,4]),[4,this.Jt.upload(tn,Xt,g)];case 2:return Br.sent(),[3,4];case 3:throw wn=Br.sent(),this.onUploadLog(Xt.size,"".concat(d,"_").concat(za(dn),"_").concat(za(gn)),{code:-1,message:""+wn+JSON.stringify(wn)}),wn;case 4:I=new Cu,j=0,Gn=this.it.getTransaction(xa,!0),Er=0,Br.label=5;case 5:return Er<je.length?($n=je[Er],[4,this.Tt.getItem($n.id,Gn)]):[3,8];case 6:(Un=Br.sent())&&((Un=Un.byteLength-$n.uploadByteLength)<0&&(Un=0),this.Tt.update({id:$n.id,lastUploadInfo:{logId:$n.logId,usageId:$n.usageId},byteLength:Un},Gn)),Br.label=7;case 7:return Er++,[3,5];case 8:return this.onUploadLog(Xt.size,"".concat(d,"_").concat(za(dn),"_").concat(za(gn))),je=[],[2]}})})},qe=function(Xt){return I.writeLine(Xt),Xt=Ru(Xt),Be<(j+=Xt)?{byteLength:Xt,hasLeft:!1}:{byteLength:Xt,hasLeft:!0}},re=function(Xt){var tn,dn,gn,wn,Gn,Er,$n,Un,Br,Cr,wr,ki;return hi(this,function($r){switch($r.label){case 0:return tn=p[Xt],[4,Rt.Tt.getItem(tn.id)];case 1:return dn=$r.sent(),dn=(dn||tn).lastUploadInfo,gn=kc(kc({id:tn.id,logId:0,usageId:0},dn||{}),{uploadByteLength:0,startTime:tn.createdAt,endTime:tn.lastLogTime}),je.push(gn),wn=0,qe("#start# "+tn.id),qe(JSON.stringify(tn)),[4,Rt.jt.queryList()];case 2:Gn=$r.sent(),Er=0,$r.label=3;case 3:return Er<Gn.length?($n=Gn[Er],$n=$n.fileId,!dn||$n>=dn.usageId?(gn.usageId=$n,[4,Rt.xt.queryList($n,tn.id)]):[3,11]):[3,12];case 4:Un=$r.sent(),Br=function(Yi){return xr(xt,void 0,void 0,function(){var Ar,Fi;return hi(this,function(pi){switch(pi.label){case 0:return Fi=qe(Yi.log),Ar=Fi.hasLeft,Fi=Fi.byteLength,wn++,gn.logId=Yi.id,gn.uploadByteLength+=Fi,Ar?[3,2]:(qe("#end# "+tn.id+" "+wn),wn=0,[4,rt()]);case 1:pi.sent(),qe("#start# "+tn.id),pi.label=2;case 2:return[2]}})})},Cr=0,$r.label=5;case 5:return Cr<Un.length?(wr=Un[Cr],$n!==(dn==null?void 0:dn.usageId)?[3,8]:wr.id>dn.logId?[4,Br(wr)]:[3,7]):[3,11];case 6:$r.sent(),$r.label=7;case 7:return[3,10];case 8:return wr.log,[4,Br(wr)];case 9:$r.sent(),$r.label=10;case 10:return Cr++,[3,5];case 11:return Er++,[3,3];case 12:return qe("#end# "+tn.id+" "+wn),wn=0,!(ki=p[Xt+1])||0<j&&j+ki.byteLength>Be?[4,rt()]:[3,14];case 13:$r.sent(),$r.label=14;case 14:return[2]}})},Rt=this,Ht=0,En.label=3;case 3:return Ht<p.length?[5,re(Ht)]:[3,6];case 4:En.sent(),En.label=5;case 5:return Ht++,[3,3];case 6:return[2]}})})},si.prototype.Nt=function(d,g,p){return xr(this,void 0,void 0,function(){var O=this;return hi(this,function(I){return[2,new Promise(function(j,je){return xr(O,void 0,void 0,function(){var Be,rt=this;return hi(this,function(qe){return Be=function(){return xr(rt,void 0,void 0,function(){return hi(this,function(re){switch(re.label){case 0:return[4,this.qt(d,g,p)];case 1:return re.sent(),[2]}})})},this.Lt.pushTask(Be,[],function(){j()},function(re){je(re)},function(){0<rt.Lt.size()&&rt.Lt.runATask()}),this.dbOpened&&this.Lt.size()===1&&this.Lt.runATask(),[2]})})})]})})},si.prototype.Kt=function(d){return xr(this,void 0,void 0,function(){var g;return hi(this,function(p){switch(p.label){case 0:return this.It?[4,this.Pt(!0)]:[2];case 1:p.sent(),this.Gt=!1,p.label=2;case 2:return p.trys.push([2,4,,5]),[4,this.Nt(this.N.userid,d)];case 3:return p.sent(),this.Gt=!0,[3,5];case 4:throw g=p.sent(),this.Gt=!1,g;case 5:return[2]}})})},si.prototype.setUploadUrl=function(d){this.Jt.setUploadUrl(d)},si.prototype.startUpload=function(d,g){return g===void 0&&(g=!1),xr(this,void 0,void 0,function(){var p;return hi(this,function(O){switch(O.label){case 0:if(!this.Rt)throw new Error("zip logs upload is not enabled.");if(!g&&this.Wt!==0&&performance.now()-this.Wt<6e4&&this.Gt||this.Xt)throw new Error("Do not uplaod frequently.");O.label=1;case 1:return O.trys.push([1,6,,7]),this.Wt=performance.now(),this.Xt=!0,this.dbOpened?[3,3]:[4,this.openDB()];case 2:O.sent(),O.label=3;case 3:return[4,this.Kt(d)];case 4:return O.sent(),[4,this.uploadLegacyLog(d)];case 5:return O.sent(),this.Xt=!1,[3,7];case 6:throw p=O.sent(),this.Xt=!1,p;case 7:return[2]}})})},si.prototype.disable=function(){return xr(this,void 0,void 0,function(){var d;return hi(this,function(g){switch(g.label){case 0:if(d=this.It,!this.Rt||isNaN(d)||!this.kt)return[3,6];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,this.Tt.update({active:0,id:d})];case 2:return g.sent(),[3,4];case 3:return g.sent(),[3,4];case 4:return[4,this.Pt(!0)];case 5:return g.sent(),this.it.closeDB(),this.kt=!1,this.U.clear(),[2,!(this.Rt=!1)];case 6:return this.U.clear(),[2,this.Rt=!1]}})})},si.prototype.onUploadLog=function(d,g,p){},si.prototype.destroy=function(){this.It?this.disable():(this.Ht&&(window.clearTimeout(this.Ht),this.Ht=void 0),this.U.clear())};var ia=si;function si(d,g,p){var O=this;this.N=d,this.C=g,this.proxyCtrl=p,this.fileConfig={count:3,size:5242880},this.it=new wl,this.xt=new br(this.it),this.Tt=new zo(this.it),this.jt=new Tc(this.it),this.kt=!1,this.U=new Il(8e3),this.Dt=new Rc,this.Lt=new Rc,this.Rt=!1,this.Wt=0,this.Gt=!1,this.Xt=!1,this.Ft=[],this.Zt=void 0,this.Jt=new ra(g,p),this.Mt=new Pl(this.N),this.it.onDBClose=function(){O.kt=!1}}var Fo=function(){return(Fo=Object.assign||function(d){for(var g,p=1,O=arguments.length;p<O;p++)for(var I in g=arguments[p])Object.prototype.hasOwnProperty.call(g,I)&&(d[I]=g[I]);return d}).apply(this,arguments)},hs=function(d,g,p,O){return new(p=p||Promise)(function(I,j){function je(qe){try{rt(O.next(qe))}catch(re){j(re)}}function Be(qe){try{rt(O.throw(qe))}catch(re){j(re)}}function rt(qe){var re;qe.done?I(qe.value):((re=qe.value)instanceof p?re:new p(function(Rt){Rt(re)})).then(je,Be)}rt((O=O.apply(d,g||[])).next())})},Zo=function(d,g){var p,O,I,j={label:0,sent:function(){if(1&I[0])throw I[1];return I[1]},trys:[],ops:[]},je={next:Be(0),throw:Be(1),return:Be(2)};return typeof Symbol=="function"&&(je[Symbol.iterator]=function(){return this}),je;function Be(rt){return function(qe){var re=[rt,qe];if(p)throw new TypeError("Generator is already executing.");for(;j=je&&re[je=0]?0:j;)try{if(p=1,O&&(I=2&re[0]?O.return:re[0]?O.throw||((I=O.return)&&I.call(O),0):O.next)&&!(I=I.call(O,re[1])).done)return I;switch(O=0,(re=I?[2&re[0],I.value]:re)[0]){case 0:case 1:I=re;break;case 4:return j.label++,{value:re[1],done:!1};case 5:j.label++,O=re[1],re=[0];continue;case 7:re=j.ops.pop(),j.trys.pop();continue;default:if(!(I=0<(I=j.trys).length&&I[I.length-1])&&(re[0]===6||re[0]===2)){j=0;continue}if(re[0]===3&&(!I||re[1]>I[0]&&re[1]<I[3]))j.label=re[1];else if(re[0]===6&&j.label<I[1])j.label=I[1],I=re;else{if(!(I&&j.label<I[2])){I[2]&&j.ops.pop(),j.trys.pop();continue}j.label=I[2],j.ops.push(re)}}re=g.call(d,j)}catch(Rt){re=[6,Rt],O=0}finally{p=I=0}if(5&re[0])throw re[1];return{value:re[0]?re[1]:void 0,done:!0}}}};Object.defineProperty(On.prototype,"url",{get:function(){return this.N.url||""},set:function(d){this.N.url=d},enumerable:!1,configurable:!0}),Object.defineProperty(On.prototype,"logType",{get:function(){return this.N.logType||Ye.DISABLE},set:function(d){this.N.logType=d},enumerable:!1,configurable:!0}),Object.defineProperty(On.prototype,"env",{get:function(){return this.N.env},set:function(d){this.N.env=d},enumerable:!1,configurable:!0}),Object.defineProperty(On.prototype,"appid",{get:function(){return this.N.appid},set:function(d){this.N.appid=d},enumerable:!1,configurable:!0}),Object.defineProperty(On.prototype,"roomid",{get:function(){return this.N.roomid},set:function(d){this.N.roomid=d},enumerable:!1,configurable:!0}),Object.defineProperty(On.prototype,"sessionid",{get:function(){return this.N.sessionid},set:function(d){this.N.sessionid=d},enumerable:!1,configurable:!0}),Object.defineProperty(On.prototype,"userid",{get:function(){return this.N.userid},set:function(d){this.N.userid=d},enumerable:!1,configurable:!0}),Object.defineProperty(On.prototype,"version",{get:function(){return this.N.version},set:function(d){this.N.version=d},enumerable:!1,configurable:!0}),Object.defineProperty(On.prototype,"wsSpeed",{get:function(){var d;return(d=(d=this.$t)==null?void 0:d.speed)!=null?d:0},enumerable:!1,configurable:!0}),On.prototype.setLogLevel=function(d){return d=we[d],d!==void 0&&(this.logLevel=d,!0)},On.prototype.setRemoteLogLevel=function(d){return d=we[d],d!==void 0&&(this.logRemoteLevel=d,!0)},On.prototype.setSessionInfo=function(d,g,p,O,I,j){this.appid=d,this.roomid=g,this.sessionid=p,this.userid=O,this.version=j},On.prototype.setTokenInfo=function(d,g){this.N.token=d||"",g&&(this.N.userid=g)},On.prototype.setZipLogConfig=function(d,g){var p;g===void 0&&(g=!1),d===1?(!this.Yt&&this.env==It.BROWSER&&ia.isEnvSupport()&&(this.Yt=new ia(this.N,this.C,this.proxyCtrl)),(p=this.Yt)!=null&&p.enable()):d==0&&g&&this.Yt&&(this.Yt.destroy(),this.Yt=null)},On.prototype.setStorageConfig=function(d){this.Yt&&this.Yt.setFileConfig(d.count,d.size)},On.prototype.setZipLogDomains=function(d,g){d=this.getLogUrlsByIPStackMode(d,g),this.Yt&&this.Yt.setUploadUrl(d),_u.domains=d},On.prototype.makeZipLogSpaceUpload=function(){return hs(this,void 0,void 0,function(){return Zo(this,function(d){switch(d.label){case 0:return this.Yt?[4,this.Yt.uploadLegacyLog(!1,!1)]:[3,2];case 1:d.sent(),d.label=2;case 2:return[2]}})})},On.prototype.uploadStorageLog=function(d){return d===void 0&&(d=!1),hs(this,void 0,void 0,function(){return Zo(this,function(g){switch(g.label){case 0:return this.Yt?[4,this.Yt.startUpload(d)]:[3,2];case 1:return g.sent(),[3,3];case 2:throw new Error("cannot use zip log module");case 3:return[2]}})})},On.prototype.report=function(d){d=this.Qt(we.REPORT,d),this.logLevel!==we.DISABLE&&this.logLevel<=we.REPORT&&!this.isDestroy&&console.debug(d),this.Vt(we.REPORT,d,!0)},On.prototype.debug=function(d,O){var p={},O=(typeof(O=O===void 0?{}:O)=="string"?d=Array.from(arguments).join(""):p=O,this.tn(we.DEBUG,d,p));this.logLevel!==we.DISABLE&&this.logLevel<=we.DEBUG&&!this.isDestroy&&console.debug(O),this.nn(we.DEBUG,O)},On.prototype.info=function(d,O){var p={},O=(typeof(O=O===void 0?{}:O)=="string"?d=Array.from(arguments).join(""):p=O,this.tn(we.INFO,d,p));this.logLevel!==we.DISABLE&&this.logLevel<=we.INFO&&!this.isDestroy&&console.info(O),this.nn(we.INFO,O)},On.prototype.warn=function(d,O){var p={},O=(typeof(O=O===void 0?{}:O)=="string"?d=Array.from(arguments).join(""):p=O,this.tn(we.WARN,d,p));this.logLevel!==we.DISABLE&&this.logLevel<=we.WARN&&!this.isDestroy&&console.warn(O),this.nn(we.WARN,O)},On.prototype.remoteReport=function(){for(var d=[],g=0;g<arguments.length;g++)d[g]=arguments[g];var p=this.tn(we.INFO,d.join(""));this.nn(we.INFO,p)},On.prototype.error=function(d,O){var p={},O=(typeof(O=O===void 0?{}:O)=="string"?d=Array.from(arguments).join(""):p=O,this.tn(we.ERROR,d,p));this.logLevel!==we.DISABLE&&this.logLevel<=we.ERROR&&!this.isDestroy&&(console.error(O),this.env%2===It.BROWSER&&window?this.stateCenter.debug&&window.alert(d.substr(d.indexOf(" ")+1,4500)):(this.env,It.WEIXINMINI)),this.nn(we.ERROR,O)},On.prototype.nn=function(d,g){this.logRemoteLevel!==we.DISABLE&&this.logRemoteLevel<=d&&(this.Vt(d,g),this.Yt)&&this.Yt.saveLog(g)},On.prototype.setSettingConfig=function(d){this.N.ipStackMode=d.ipStackMode},On.prototype.getLogUrlsByIPStackMode=function(d,g){var p=[];switch(this.N.ipStackMode){case w.IPv4Only:p.push.apply(p,d);break;case w.IPv4Prefer:p.push.apply(p,d),p.push.apply(p,g);break;case w.IPv6Prefer:p.push.apply(p,g),p.push.apply(p,d);break;default:p.push.apply(p,d)}return p},On.prototype.onConnected=function(d){},On.prototype.onUploadLog=function(d,g,p){},On.prototype.setLogServer=function(d,g){var p;if(this.isDestroy||this.logConnected)return!1;g=this.N.env===0?(this.N.connectURLs=this.getLogUrlsByIPStackMode(d,g),this.N.connectURLs[this.urlIndex]):(this.N.connectURLs=d,this.url!==this.N.connectURLs[0]&&(this.logConnected=!1),this.N.connectURLs[0]);try{return g.startsWith("wss:")?(this.logType=Ye.WEBSOCKET,(p=this.$t)!=null&&p.openWebSocketLogServer(g,!0)):g.startsWith("https:")?(this.logType=Ye.HTTPS,this.en(g)):this.logType=Ye.DISABLE,!0}catch(O){return this.error(JSON.stringify(O)),!1}},On.prototype.rn=function(){this.logType==Ye.WEBSOCKET?this.sn():this.logType==Ye.HTTPS&&(this.on(),this.un()),this.logType=Ye.DISABLE},On.prototype.sn=function(){var d;(d=this.$t)!=null&&d.stopWebSocketServer()},On.prototype.en=function(d){var g=this;(this.url=d)&&(this.un(),this.logUploadTimer||(this.logUploadTimer=setInterval(function(){g.on()},this.logUploadInterval)))},On.prototype.un=function(){this.logUploadTimer&&(clearInterval(this.logUploadTimer),this.logUploadTimer=null)},On.prototype.Vt=function(d,g,p){return p===void 0&&(p=!1),hs(this,void 0,void 0,function(){return Zo(this,function(O){if(!this.isDestroy){if(this.logType==Ye.WEBSOCKET)this.cn&&this.fn(d,g);else if(this.logType==Ye.HTTPS)this.hn(d,g,p);else if(this.logLevel!==we.DISABLE&&this.logLevel<=d){if(4e3<g.length)return[2];for(this.an.push(g);this.an.size()>this.ln;)this.an.removeALog()}}return[2]})})},On.prototype.clearCache=function(){var d;this.an.size()!==0&&(d=this.$t)!=null&&d.clearLogCacheAndUpload()},On.prototype.fn=function(d,g){var p;return hs(this,void 0,void 0,function(){var O,I=this;return Zo(this,function(j){return typeof g=="string"&&4e3<g.length?((je,Be)=>{Be===void 0&&(Be=2e3);for(var rt=[],qe=0;qe<je.length;)rt.push(je.substring(qe,qe+Be)),qe+=Be;return rt})((O=JSON.parse(g)).content,3e3).forEach(function(je,Be){3<Be||(O.content="s".concat(Be+1,": ").concat(je),I.fn(d,JSON.stringify(O)))}):this.N.useStrategy&&this.env==It.BROWSER&&(p=this.$t)!=null&&p.addRemoteWsLog(g),[2]})})},On.prototype.hn=function(d,g,p){this.an.push(g),(this.an.size()>=this.ln||p===!0)&&this.on()},On.prototype.tn=function(d,j,je){je===void 0&&(je={});var O=G(),j=[j.substr(0,j.indexOf(" "))||j,j.substr(j.indexOf(" ")+1,8e3)||j],I=j[0],j=j[1],je=Fo(Fo({},je),{time:O,level:d,action:I,content:j,appid:this.appid,roomid:this.roomid||void 0,userid:this.userid,sessionid:this.sessionid||void 0});return JSON.stringify(je)},On.prototype.Qt=function(d,g){var p=G(),O="",O=this.env%2===It.BROWSER?"rtc":"ali";return g=Fo(Fo({},g),{time:p,level:d,console:O,appid:this.appid,room_id:this.roomid,roomid:this.roomid,userid:this.userid,id_name:this.userid,sessionid:this.sessionid,sdk_version:this.version,test_environment:this.stateCenter.testEnvironment,version:this.version,event_id:this.appid+"_"+this.userid+"_"+g.event_time+"_"+g.seq}),JSON.stringify(g)},On.prototype.on=function(){this.an.size()!=0&&(this.env%2===It.BROWSER?this.vn():this.SendHttpsLogWeChatMini())},On.prototype.vn=function(){var d=this,g=this.an.buffer.join(`
`),p=this.an.buffer,O=new XMLHttpRequest;O.onreadystatechange=function(){if(O.readyState==4){if(O.status==200){if(d.logConnected=!0,O.responseText.length==0)return;try{var I=JSON.parse(O.responseText).interval;typeof I=="number"&&d.logUploadInterval!==I&&(d.timeInterval=I,d.en(d.url))}catch(j){d.an.buffer=p.concat(d.an.buffer),console.log("send result failed "+j)}}else d.an.buffer=p.concat(d.an.buffer);p=null}},O.open("POST",this.url,!0),this.env==0?O.send(g):this.env==1&&(O.setRequestHeader("content-type","application/json"),O.send(JSON.stringify({user_id:this.userid,log:g}))),this.an.buffer=[]},On.prototype.SendHttpsLogWeChatMini=function(){},On.prototype.retryConnectSocket=function(){var d,g;100<performance.now()-this.wsConnectFailTime&&(this.tryIndex++,d=this.N.networkState===Re.offline,g=void this.C.info("zl.rcs.0 ".concat(JSON.stringify(this.N.connectURLs)," ").concat(this.tryIndex," ").concat(this.urlIndex)),g=this.tryIndex<this.urlTryMaxCount?this.url:(this.tryIndex=0,this.urlIndex++,this.N.connectURLs[this.urlIndex%this.N.connectURLs.length]),d?(d=this.$t)!=null&&d.openWebSocketLogServer(g,!1,!0,this.dn):(d=this.$t)!=null&&d.openWebSocketLogServer(g,!1,!0,this.wn)),this.wsConnectFailTime=performance.now()},On.prototype.listener=function(){var d=this;this.env==It.BROWSER&&(window.addEventListener("online",function(){d.N.networkState=Re.online,d.reconnectLogServer()}),window.addEventListener("offline",function(){d.N.networkState=Re.offline})),this.$t&&(this.$t.onSocketConnect=function(){d.logConnected=!0,d.N.networkState=Re.online,d.onConnected({url:d.url})},this.$t.onSocketClose=function(){d.retryConnectSocket()},this.$t.onSocketError=function(){d.retryConnectSocket()},this.$t.onHeartBeatTimeout=function(){d.reconnectLogServer()})},On.prototype.reconnectLogServer=function(){var d,g;this.logType===Ye.WEBSOCKET&&(this.C.info("zl.rcs.1 call"),this.tryIndex=0,this.urlIndex=0,g=this.N.connectURLs[this.urlIndex],this.url="",(d=this.$t)!=null&&d.resetSocketTimer(),(d=this.$t)!=null)&&d.openWebSocketLogServer(g,!1,!0,this.wn)},On.prototype.enableWebSocketLog=function(d){this.$t&&d!==this.$t.enabled&&(d?(this.$t.enabled=!0,this.$t.openWebSocketLogServer(this.url,!0,!0)):(this.$t.enabled=!1,this.sn(),this.an.clear()))},On.prototype.stopStorageLog=function(){return hs(this,void 0,void 0,function(){return Zo(this,function(d){return this.Yt?[2,this.Yt.disable()]:[2,!1]})})},On.prototype.setUpBitrate=function(d){var g;return(g=this.$t)==null||!g.enabled||(g=this.$t)==null?void 0:g.setUpBitrate(d)},On.prototype.setUploadStrategy=function(d){var g;(g=this.$t)!=null&&g.enabled&&this.$t.setStrategy(d)},On.prototype.getWhiteList=function(d,g){return _u.fetchWhitelist({appID:this.appid,product:d=d===void 0?"rtc":d,userID:this.N.userid,token:this.N.token,deviceID:this.N.deviceid,bizType:g=g===void 0?0:g},this.proxyCtrl)},Object.defineProperty(On.prototype,"cn",{get:function(){var d;return!((d=this.$t)==null||!d.enabled)},enumerable:!1,configurable:!0}),On.prototype.destroy=function(){var d;this.rn(),this.logUploadTimer&&clearTimeout(this.logUploadTimer),Te.instance=void 0,(d=this.$t)!=null&&d.destroy(),this.Yt&&this.Yt.destroy(),this.url="",this.isDestroy=!0,this.tryIndex=0,this.urlIndex=0},On.logVersion="1.4.15";var bo=On;function On(d,g){var p=this;this.proxyCtrl=g,this.logLevel=we.INFO,this.logRemoteLevel=0,this.logUploadTimer=null,this.logUploadInterval=1e4,this.existUserID=!1,this.isDestroy=!1,this.ln=8192,this.wn=2e3,this.dn=5e3,this.C={debug:this.debug.bind(this),info:this.info.bind(this),warn:this.warn.bind(this),error:this.error.bind(this)},this.logConnected=!1,this.tryIndex=0,this.urlIndex=0,this.urlTryMaxCount=3,this.wsConnectFailTime=0,this.urlGroups={v4:[],v6:[]},this.inflate=us,this.deflate=ka,this.stateCenter=Te.getInstance(),this.N=new Sl,this.N.env=d,this.an=new yu(this.N,this.ln),this.$t=new ws(this.an,this.N,this.C,this.proxyCtrl),this.listener(),this.env==It.BROWSER&&ia.isEnvSupport()&&(this.Yt=new ia(this.N,this.C,this.proxyCtrl),this.Yt.onUploadLog=function(O,I,j){p.onUploadLog(O,I,j)})}}],bt={},Dt.m=ct,Dt.c=bt,Dt.d=function(dt,pt,Ft){Dt.o(dt,pt)||Object.defineProperty(dt,pt,{enumerable:!0,get:Ft})},Dt.r=function(dt){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(dt,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(dt,"bn",{value:!0})},Dt.t=function(dt,pt){if(1&pt&&(dt=Dt(dt)),8&pt||4&pt&&typeof dt=="object"&&dt&&dt.bn)return dt;var Ft=Object.create(null);if(Dt.r(Ft),Object.defineProperty(Ft,"default",{enumerable:!0,value:dt}),2&pt&&typeof dt!="string")for(var It in dt)Dt.d(Ft,It,(function(Ye){return dt[Ye]}).bind(null,It));return Ft},Dt.n=function(dt){var pt=dt&&dt.bn?function(){return dt.default}:function(){return dt};return Dt.d(pt,"a",pt),pt},Dt.o=function(dt,pt){return Object.prototype.hasOwnProperty.call(dt,pt)},Dt.p="",Dt(Dt.s=2);function Dt(dt){var pt;return(bt[dt]||(pt=bt[dt]={i:dt,l:!1,exports:{}},ct[dt].call(pt.exports,pt,pt.exports,Dt),pt.l=!0,pt)).exports}var ct,bt})}(ZegoExpressLogger)),ZegoExpressLogger.exports}function commonjsRequire(yn){throw new Error('Could not dynamically require "'+yn+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var localforage={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var hasRequiredLocalforage;function requireLocalforage(){return hasRequiredLocalforage||(hasRequiredLocalforage=1,function(yn,Bt){(function(on){yn.exports=on()})(function(){return function on(sn,Dt,ct){function bt(Ft,It){if(!Dt[Ft]){if(!sn[Ft]){var Ye=typeof commonjsRequire=="function"&&commonjsRequire;if(!It&&Ye)return Ye(Ft,!0);if(dt)return dt(Ft,!0);var Te=new Error("Cannot find module '"+Ft+"'");throw Te.code="MODULE_NOT_FOUND",Te}var E=Dt[Ft]={exports:{}};sn[Ft][0].call(E.exports,function(w){var Re=sn[Ft][1][w];return bt(Re||w)},E,E.exports,on,sn,Dt,ct)}return Dt[Ft].exports}for(var dt=typeof commonjsRequire=="function"&&commonjsRequire,pt=0;pt<ct.length;pt++)bt(ct[pt]);return bt}({1:[function(on,sn,Dt){(function(ct){var bt=ct.MutationObserver||ct.WebKitMutationObserver,dt;if(bt){var pt=0,Ft=new bt(w),It=ct.document.createTextNode("");Ft.observe(It,{characterData:!0}),dt=function(){It.data=pt=++pt%2}}else if(!ct.setImmediate&&typeof ct.MessageChannel<"u"){var Ye=new ct.MessageChannel;Ye.port1.onmessage=w,dt=function(){Ye.port2.postMessage(0)}}else"document"in ct&&"onreadystatechange"in ct.document.createElement("script")?dt=function(){var we=ct.document.createElement("script");we.onreadystatechange=function(){w(),we.onreadystatechange=null,we.parentNode.removeChild(we),we=null},ct.document.documentElement.appendChild(we)}:dt=function(){setTimeout(w,0)};var Te,E=[];function w(){Te=!0;for(var we,he,Me=E.length;Me;){for(he=E,E=[],we=-1;++we<Me;)he[we]();Me=E.length}Te=!1}sn.exports=Re;function Re(we){E.push(we)===1&&!Te&&dt()}}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(on,sn,Dt){var ct=on(1);function bt(){}var dt={},pt=["REJECTED"],Ft=["FULFILLED"],It=["PENDING"];sn.exports=Ye;function Ye(W){if(typeof W!="function")throw new TypeError("resolver must be a function");this.state=It,this.queue=[],this.outcome=void 0,W!==bt&&Re(this,W)}Ye.prototype.catch=function(W){return this.then(null,W)},Ye.prototype.then=function(W,Q){if(typeof W!="function"&&this.state===Ft||typeof Q!="function"&&this.state===pt)return this;var se=new this.constructor(bt);if(this.state!==It){var J=this.state===Ft?W:Q;E(se,J,this.outcome)}else this.queue.push(new Te(se,W,Q));return se};function Te(W,Q,se){this.promise=W,typeof Q=="function"&&(this.onFulfilled=Q,this.callFulfilled=this.otherCallFulfilled),typeof se=="function"&&(this.onRejected=se,this.callRejected=this.otherCallRejected)}Te.prototype.callFulfilled=function(W){dt.resolve(this.promise,W)},Te.prototype.otherCallFulfilled=function(W){E(this.promise,this.onFulfilled,W)},Te.prototype.callRejected=function(W){dt.reject(this.promise,W)},Te.prototype.otherCallRejected=function(W){E(this.promise,this.onRejected,W)};function E(W,Q,se){ct(function(){var J;try{J=Q(se)}catch(G){return dt.reject(W,G)}J===W?dt.reject(W,new TypeError("Cannot resolve promise with itself")):dt.resolve(W,J)})}dt.resolve=function(W,Q){var se=we(w,Q);if(se.status==="error")return dt.reject(W,se.value);var J=se.value;if(J)Re(W,J);else{W.state=Ft,W.outcome=Q;for(var G=-1,U=W.queue.length;++G<U;)W.queue[G].callFulfilled(Q)}return W},dt.reject=function(W,Q){W.state=pt,W.outcome=Q;for(var se=-1,J=W.queue.length;++se<J;)W.queue[se].callRejected(Q);return W};function w(W){var Q=W&&W.then;if(W&&(typeof W=="object"||typeof W=="function")&&typeof Q=="function")return function(){Q.apply(W,arguments)}}function Re(W,Q){var se=!1;function J(N){se||(se=!0,dt.reject(W,N))}function G(N){se||(se=!0,dt.resolve(W,N))}function U(){Q(G,J)}var C=we(U);C.status==="error"&&J(C.value)}function we(W,Q){var se={};try{se.value=W(Q),se.status="success"}catch(J){se.status="error",se.value=J}return se}Ye.resolve=he;function he(W){return W instanceof this?W:dt.resolve(new this(bt),W)}Ye.reject=Me;function Me(W){var Q=new this(bt);return dt.reject(Q,W)}Ye.all=nt;function nt(W){var Q=this;if(Object.prototype.toString.call(W)!=="[object Array]")return this.reject(new TypeError("must be an array"));var se=W.length,J=!1;if(!se)return this.resolve([]);for(var G=new Array(se),U=0,C=-1,N=new this(bt);++C<se;)v(W[C],C);return N;function v(f,_){Q.resolve(f).then(b,function(y){J||(J=!0,dt.reject(N,y))});function b(y){G[_]=y,++U===se&&!J&&(J=!0,dt.resolve(N,G))}}}Ye.race=Ne;function Ne(W){var Q=this;if(Object.prototype.toString.call(W)!=="[object Array]")return this.reject(new TypeError("must be an array"));var se=W.length,J=!1;if(!se)return this.resolve([]);for(var G=-1,U=new this(bt);++G<se;)C(W[G]);return U;function C(N){Q.resolve(N).then(function(v){J||(J=!0,dt.resolve(U,v))},function(v){J||(J=!0,dt.reject(U,v))})}}},{1:1}],3:[function(on,sn,Dt){(function(ct){typeof ct.Promise!="function"&&(ct.Promise=on(2))}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(on,sn,Dt){var ct=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne};function bt(ne,De){if(!(ne instanceof De))throw new TypeError("Cannot call a class as a function")}function dt(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var pt=dt();function Ft(){try{if(!pt||!pt.open)return!1;var ne=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),De=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!ne||De)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function It(ne,De){ne=ne||[],De=De||{};try{return new Blob(ne,De)}catch($e){if($e.name!=="TypeError")throw $e;for(var ye=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,Qe=new ye,Ke=0;Ke<ne.length;Ke+=1)Qe.append(ne[Ke]);return Qe.getBlob(De.type)}}typeof Promise>"u"&&on(3);var Ye=Promise;function Te(ne,De){De&&ne.then(function(ye){De(null,ye)},function(ye){De(ye)})}function E(ne,De,ye){typeof De=="function"&&ne.then(De),typeof ye=="function"&&ne.catch(ye)}function w(ne){return typeof ne!="string"&&(console.warn(ne+" used as a key, but it is not a string."),ne=String(ne)),ne}function Re(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var we="local-forage-detect-blob-support",he=void 0,Me={},nt=Object.prototype.toString,Ne="readonly",W="readwrite";function Q(ne){for(var De=ne.length,ye=new ArrayBuffer(De),Qe=new Uint8Array(ye),Ke=0;Ke<De;Ke++)Qe[Ke]=ne.charCodeAt(Ke);return ye}function se(ne){return new Ye(function(De){var ye=ne.transaction(we,W),Qe=It([""]);ye.objectStore(we).put(Qe,"key"),ye.onabort=function(Ke){Ke.preventDefault(),Ke.stopPropagation(),De(!1)},ye.oncomplete=function(){var Ke=navigator.userAgent.match(/Chrome\/(\d+)/),$e=navigator.userAgent.match(/Edge\//);De($e||!Ke||parseInt(Ke[1],10)>=43)}}).catch(function(){return!1})}function J(ne){return typeof he=="boolean"?Ye.resolve(he):se(ne).then(function(De){return he=De,he})}function G(ne){var De=Me[ne.name],ye={};ye.promise=new Ye(function(Qe,Ke){ye.resolve=Qe,ye.reject=Ke}),De.deferredOperations.push(ye),De.dbReady?De.dbReady=De.dbReady.then(function(){return ye.promise}):De.dbReady=ye.promise}function U(ne){var De=Me[ne.name],ye=De.deferredOperations.pop();if(ye)return ye.resolve(),ye.promise}function C(ne,De){var ye=Me[ne.name],Qe=ye.deferredOperations.pop();if(Qe)return Qe.reject(De),Qe.promise}function N(ne,De){return new Ye(function(ye,Qe){if(Me[ne.name]=Me[ne.name]||H(),ne.db)if(De)G(ne),ne.db.close();else return ye(ne.db);var Ke=[ne.name];De&&Ke.push(ne.version);var $e=pt.open.apply(pt,Ke);De&&($e.onupgradeneeded=function(at){var ht=$e.result;try{ht.createObjectStore(ne.storeName),at.oldVersion<=1&&ht.createObjectStore(we)}catch(Ct){if(Ct.name==="ConstraintError")console.warn('The database "'+ne.name+'" has been upgraded from version '+at.oldVersion+" to version "+at.newVersion+', but the storage "'+ne.storeName+'" already exists.');else throw Ct}}),$e.onerror=function(at){at.preventDefault(),Qe($e.error)},$e.onsuccess=function(){var at=$e.result;at.onversionchange=function(ht){ht.target.close()},ye(at),U(ne)}})}function v(ne){return N(ne,!1)}function f(ne){return N(ne,!0)}function _(ne,De){if(!ne.db)return!0;var ye=!ne.db.objectStoreNames.contains(ne.storeName),Qe=ne.version<ne.db.version,Ke=ne.version>ne.db.version;if(Qe&&(ne.version!==De&&console.warn('The database "'+ne.name+`" can't be downgraded from version `+ne.db.version+" to version "+ne.version+"."),ne.version=ne.db.version),Ke||ye){if(ye){var $e=ne.db.version+1;$e>ne.version&&(ne.version=$e)}return!0}return!1}function b(ne){return new Ye(function(De,ye){var Qe=new FileReader;Qe.onerror=ye,Qe.onloadend=function(Ke){var $e=btoa(Ke.target.result||"");De({__local_forage_encoded_blob:!0,data:$e,type:ne.type})},Qe.readAsBinaryString(ne)})}function y(ne){var De=Q(atob(ne.data));return It([De],{type:ne.type})}function M(ne){return ne&&ne.__local_forage_encoded_blob}function Y(ne){var De=this,ye=De._initReady().then(function(){var Qe=Me[De._dbInfo.name];if(Qe&&Qe.dbReady)return Qe.dbReady});return E(ye,ne,ne),ye}function L(ne){G(ne);for(var De=Me[ne.name],ye=De.forages,Qe=0;Qe<ye.length;Qe++){var Ke=ye[Qe];Ke._dbInfo.db&&(Ke._dbInfo.db.close(),Ke._dbInfo.db=null)}return ne.db=null,v(ne).then(function($e){return ne.db=$e,_(ne)?f(ne):$e}).then(function($e){ne.db=De.db=$e;for(var at=0;at<ye.length;at++)ye[at]._dbInfo.db=$e}).catch(function($e){throw C(ne,$e),$e})}function A(ne,De,ye,Qe){Qe===void 0&&(Qe=1);try{var Ke=ne.db.transaction(ne.storeName,De);ye(null,Ke)}catch($e){if(Qe>0&&(!ne.db||$e.name==="InvalidStateError"||$e.name==="NotFoundError"))return Ye.resolve().then(function(){if(!ne.db||$e.name==="NotFoundError"&&!ne.db.objectStoreNames.contains(ne.storeName)&&ne.version<=ne.db.version)return ne.db&&(ne.version=ne.db.version+1),f(ne)}).then(function(){return L(ne).then(function(){A(ne,De,ye,Qe-1)})}).catch(ye);ye($e)}}function H(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function ge(ne){var De=this,ye={db:null};if(ne)for(var Qe in ne)ye[Qe]=ne[Qe];var Ke=Me[ye.name];Ke||(Ke=H(),Me[ye.name]=Ke),Ke.forages.push(De),De._initReady||(De._initReady=De.ready,De.ready=Y);var $e=[];function at(){return Ye.resolve()}for(var ht=0;ht<Ke.forages.length;ht++){var Ct=Ke.forages[ht];Ct!==De&&$e.push(Ct._initReady().catch(at))}var St=Ke.forages.slice(0);return Ye.all($e).then(function(){return ye.db=Ke.db,v(ye)}).then(function(kt){return ye.db=kt,_(ye,De._defaultConfig.version)?f(ye):kt}).then(function(kt){ye.db=Ke.db=kt,De._dbInfo=ye;for(var Ut=0;Ut<St.length;Ut++){var Lt=St[Ut];Lt!==De&&(Lt._dbInfo.db=ye.db,Lt._dbInfo.version=ye.version)}})}function Ee(ne,De){var ye=this;ne=w(ne);var Qe=new Ye(function(Ke,$e){ye.ready().then(function(){A(ye._dbInfo,Ne,function(at,ht){if(at)return $e(at);try{var Ct=ht.objectStore(ye._dbInfo.storeName),St=Ct.get(ne);St.onsuccess=function(){var kt=St.result;kt===void 0&&(kt=null),M(kt)&&(kt=y(kt)),Ke(kt)},St.onerror=function(){$e(St.error)}}catch(kt){$e(kt)}})}).catch($e)});return Te(Qe,De),Qe}function Se(ne,De){var ye=this,Qe=new Ye(function(Ke,$e){ye.ready().then(function(){A(ye._dbInfo,Ne,function(at,ht){if(at)return $e(at);try{var Ct=ht.objectStore(ye._dbInfo.storeName),St=Ct.openCursor(),kt=1;St.onsuccess=function(){var Ut=St.result;if(Ut){var Lt=Ut.value;M(Lt)&&(Lt=y(Lt));var cn=ne(Lt,Ut.key,kt++);cn!==void 0?Ke(cn):Ut.continue()}else Ke()},St.onerror=function(){$e(St.error)}}catch(Ut){$e(Ut)}})}).catch($e)});return Te(Qe,De),Qe}function ue(ne,De,ye){var Qe=this;ne=w(ne);var Ke=new Ye(function($e,at){var ht;Qe.ready().then(function(){return ht=Qe._dbInfo,nt.call(De)==="[object Blob]"?J(ht.db).then(function(Ct){return Ct?De:b(De)}):De}).then(function(Ct){A(Qe._dbInfo,W,function(St,kt){if(St)return at(St);try{var Ut=kt.objectStore(Qe._dbInfo.storeName);Ct===null&&(Ct=void 0);var Lt=Ut.put(Ct,ne);kt.oncomplete=function(){Ct===void 0&&(Ct=null),$e(Ct)},kt.onabort=kt.onerror=function(){var cn=Lt.error?Lt.error:Lt.transaction.error;at(cn)}}catch(cn){at(cn)}})}).catch(at)});return Te(Ke,ye),Ke}function oe(ne,De){var ye=this;ne=w(ne);var Qe=new Ye(function(Ke,$e){ye.ready().then(function(){A(ye._dbInfo,W,function(at,ht){if(at)return $e(at);try{var Ct=ht.objectStore(ye._dbInfo.storeName),St=Ct.delete(ne);ht.oncomplete=function(){Ke()},ht.onerror=function(){$e(St.error)},ht.onabort=function(){var kt=St.error?St.error:St.transaction.error;$e(kt)}}catch(kt){$e(kt)}})}).catch($e)});return Te(Qe,De),Qe}function be(ne){var De=this,ye=new Ye(function(Qe,Ke){De.ready().then(function(){A(De._dbInfo,W,function($e,at){if($e)return Ke($e);try{var ht=at.objectStore(De._dbInfo.storeName),Ct=ht.clear();at.oncomplete=function(){Qe()},at.onabort=at.onerror=function(){var St=Ct.error?Ct.error:Ct.transaction.error;Ke(St)}}catch(St){Ke(St)}})}).catch(Ke)});return Te(ye,ne),ye}function Le(ne){var De=this,ye=new Ye(function(Qe,Ke){De.ready().then(function(){A(De._dbInfo,Ne,function($e,at){if($e)return Ke($e);try{var ht=at.objectStore(De._dbInfo.storeName),Ct=ht.count();Ct.onsuccess=function(){Qe(Ct.result)},Ct.onerror=function(){Ke(Ct.error)}}catch(St){Ke(St)}})}).catch(Ke)});return Te(ye,ne),ye}function pe(ne,De){var ye=this,Qe=new Ye(function(Ke,$e){if(ne<0){Ke(null);return}ye.ready().then(function(){A(ye._dbInfo,Ne,function(at,ht){if(at)return $e(at);try{var Ct=ht.objectStore(ye._dbInfo.storeName),St=!1,kt=Ct.openKeyCursor();kt.onsuccess=function(){var Ut=kt.result;if(!Ut){Ke(null);return}ne===0||St?Ke(Ut.key):(St=!0,Ut.advance(ne))},kt.onerror=function(){$e(kt.error)}}catch(Ut){$e(Ut)}})}).catch($e)});return Te(Qe,De),Qe}function k(ne){var De=this,ye=new Ye(function(Qe,Ke){De.ready().then(function(){A(De._dbInfo,Ne,function($e,at){if($e)return Ke($e);try{var ht=at.objectStore(De._dbInfo.storeName),Ct=ht.openKeyCursor(),St=[];Ct.onsuccess=function(){var kt=Ct.result;if(!kt){Qe(St);return}St.push(kt.key),kt.continue()},Ct.onerror=function(){Ke(Ct.error)}}catch(kt){Ke(kt)}})}).catch(Ke)});return Te(ye,ne),ye}function R(ne,De){De=Re.apply(this,arguments);var ye=this.config();ne=typeof ne!="function"&&ne||{},ne.name||(ne.name=ne.name||ye.name,ne.storeName=ne.storeName||ye.storeName);var Qe=this,Ke;if(!ne.name)Ke=Ye.reject("Invalid arguments");else{var $e=ne.name===ye.name&&Qe._dbInfo.db,at=$e?Ye.resolve(Qe._dbInfo.db):v(ne).then(function(ht){var Ct=Me[ne.name],St=Ct.forages;Ct.db=ht;for(var kt=0;kt<St.length;kt++)St[kt]._dbInfo.db=ht;return ht});ne.storeName?Ke=at.then(function(ht){if(ht.objectStoreNames.contains(ne.storeName)){var Ct=ht.version+1;G(ne);var St=Me[ne.name],kt=St.forages;ht.close();for(var Ut=0;Ut<kt.length;Ut++){var Lt=kt[Ut];Lt._dbInfo.db=null,Lt._dbInfo.version=Ct}var cn=new Ye(function(_n,vn){var xn=pt.open(ne.name,Ct);xn.onerror=function(An){var Zn=xn.result;Zn.close(),vn(An)},xn.onupgradeneeded=function(){var An=xn.result;An.deleteObjectStore(ne.storeName)},xn.onsuccess=function(){var An=xn.result;An.close(),_n(An)}});return cn.then(function(_n){St.db=_n;for(var vn=0;vn<kt.length;vn++){var xn=kt[vn];xn._dbInfo.db=_n,U(xn._dbInfo)}}).catch(function(_n){throw(C(ne,_n)||Ye.resolve()).catch(function(){}),_n})}}):Ke=at.then(function(ht){G(ne);var Ct=Me[ne.name],St=Ct.forages;ht.close();for(var kt=0;kt<St.length;kt++){var Ut=St[kt];Ut._dbInfo.db=null}var Lt=new Ye(function(cn,_n){var vn=pt.deleteDatabase(ne.name);vn.onerror=function(){var xn=vn.result;xn&&xn.close(),_n(vn.error)},vn.onblocked=function(){console.warn('dropInstance blocked for database "'+ne.name+'" until all open connections are closed')},vn.onsuccess=function(){var xn=vn.result;xn&&xn.close(),cn(xn)}});return Lt.then(function(cn){Ct.db=cn;for(var _n=0;_n<St.length;_n++){var vn=St[_n];U(vn._dbInfo)}}).catch(function(cn){throw(C(ne,cn)||Ye.resolve()).catch(function(){}),cn})})}return Te(Ke,De),Ke}var Fe={_driver:"asyncStorage",_initStorage:ge,_support:Ft(),iterate:Se,getItem:Ee,setItem:ue,removeItem:oe,clear:be,length:Le,key:pe,keys:k,dropInstance:R};function te(){return typeof openDatabase=="function"}var Ue="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",it="~~local_forage_type~",ee=/^~~local_forage_type~([^~]+)~/,ae="__lfsc__:",xe=ae.length,Z="arbf",$="blob",K="si08",X="ui08",B="uic8",fe="si16",Ce="si32",Ze="ur16",st="ui32",Ie="fl32",D="fl64",me=xe+Z.length,ce=Object.prototype.toString;function le(ne){var De=ne.length*.75,ye=ne.length,Qe,Ke=0,$e,at,ht,Ct;ne[ne.length-1]==="="&&(De--,ne[ne.length-2]==="="&&De--);var St=new ArrayBuffer(De),kt=new Uint8Array(St);for(Qe=0;Qe<ye;Qe+=4)$e=Ue.indexOf(ne[Qe]),at=Ue.indexOf(ne[Qe+1]),ht=Ue.indexOf(ne[Qe+2]),Ct=Ue.indexOf(ne[Qe+3]),kt[Ke++]=$e<<2|at>>4,kt[Ke++]=(at&15)<<4|ht>>2,kt[Ke++]=(ht&3)<<6|Ct&63;return St}function et(ne){var De=new Uint8Array(ne),ye="",Qe;for(Qe=0;Qe<De.length;Qe+=3)ye+=Ue[De[Qe]>>2],ye+=Ue[(De[Qe]&3)<<4|De[Qe+1]>>4],ye+=Ue[(De[Qe+1]&15)<<2|De[Qe+2]>>6],ye+=Ue[De[Qe+2]&63];return De.length%3===2?ye=ye.substring(0,ye.length-1)+"=":De.length%3===1&&(ye=ye.substring(0,ye.length-2)+"=="),ye}function ze(ne,De){var ye="";if(ne&&(ye=ce.call(ne)),ne&&(ye==="[object ArrayBuffer]"||ne.buffer&&ce.call(ne.buffer)==="[object ArrayBuffer]")){var Qe,Ke=ae;ne instanceof ArrayBuffer?(Qe=ne,Ke+=Z):(Qe=ne.buffer,ye==="[object Int8Array]"?Ke+=K:ye==="[object Uint8Array]"?Ke+=X:ye==="[object Uint8ClampedArray]"?Ke+=B:ye==="[object Int16Array]"?Ke+=fe:ye==="[object Uint16Array]"?Ke+=Ze:ye==="[object Int32Array]"?Ke+=Ce:ye==="[object Uint32Array]"?Ke+=st:ye==="[object Float32Array]"?Ke+=Ie:ye==="[object Float64Array]"?Ke+=D:De(new Error("Failed to get type for BinaryArray"))),De(Ke+et(Qe))}else if(ye==="[object Blob]"){var $e=new FileReader;$e.onload=function(){var at=it+ne.type+"~"+et(this.result);De(ae+$+at)},$e.readAsArrayBuffer(ne)}else try{De(JSON.stringify(ne))}catch(at){console.error("Couldn't convert value into a JSON string: ",ne),De(null,at)}}function ft(ne){if(ne.substring(0,xe)!==ae)return JSON.parse(ne);var De=ne.substring(me),ye=ne.substring(xe,me),Qe;if(ye===$&&ee.test(De)){var Ke=De.match(ee);Qe=Ke[1],De=De.substring(Ke[0].length)}var $e=le(De);switch(ye){case Z:return $e;case $:return It([$e],{type:Qe});case K:return new Int8Array($e);case X:return new Uint8Array($e);case B:return new Uint8ClampedArray($e);case fe:return new Int16Array($e);case Ze:return new Uint16Array($e);case Ce:return new Int32Array($e);case st:return new Uint32Array($e);case Ie:return new Float32Array($e);case D:return new Float64Array($e);default:throw new Error("Unkown type: "+ye)}}var _t={serialize:ze,deserialize:ft,stringToBuffer:le,bufferToString:et};function mt(ne,De,ye,Qe){ne.executeSql("CREATE TABLE IF NOT EXISTS "+De.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],ye,Qe)}function Ve(ne){var De=this,ye={db:null};if(ne)for(var Qe in ne)ye[Qe]=typeof ne[Qe]!="string"?ne[Qe].toString():ne[Qe];var Ke=new Ye(function($e,at){try{ye.db=openDatabase(ye.name,String(ye.version),ye.description,ye.size)}catch(ht){return at(ht)}ye.db.transaction(function(ht){mt(ht,ye,function(){De._dbInfo=ye,$e()},function(Ct,St){at(St)})},at)});return ye.serializer=_t,Ke}function Ot(ne,De,ye,Qe,Ke,$e){ne.executeSql(ye,Qe,Ke,function(at,ht){ht.code===ht.SYNTAX_ERR?at.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[De.storeName],function(Ct,St){St.rows.length?$e(Ct,ht):mt(Ct,De,function(){Ct.executeSql(ye,Qe,Ke,$e)},$e)},$e):$e(at,ht)},$e)}function rn(ne,De){var ye=this;ne=w(ne);var Qe=new Ye(function(Ke,$e){ye.ready().then(function(){var at=ye._dbInfo;at.db.transaction(function(ht){Ot(ht,at,"SELECT * FROM "+at.storeName+" WHERE key = ? LIMIT 1",[ne],function(Ct,St){var kt=St.rows.length?St.rows.item(0).value:null;kt&&(kt=at.serializer.deserialize(kt)),Ke(kt)},function(Ct,St){$e(St)})})}).catch($e)});return Te(Qe,De),Qe}function an(ne,De){var ye=this,Qe=new Ye(function(Ke,$e){ye.ready().then(function(){var at=ye._dbInfo;at.db.transaction(function(ht){Ot(ht,at,"SELECT * FROM "+at.storeName,[],function(Ct,St){for(var kt=St.rows,Ut=kt.length,Lt=0;Lt<Ut;Lt++){var cn=kt.item(Lt),_n=cn.value;if(_n&&(_n=at.serializer.deserialize(_n)),_n=ne(_n,cn.key,Lt+1),_n!==void 0){Ke(_n);return}}Ke()},function(Ct,St){$e(St)})})}).catch($e)});return Te(Qe,De),Qe}function In(ne,De,ye,Qe){var Ke=this;ne=w(ne);var $e=new Ye(function(at,ht){Ke.ready().then(function(){De===void 0&&(De=null);var Ct=De,St=Ke._dbInfo;St.serializer.serialize(De,function(kt,Ut){Ut?ht(Ut):St.db.transaction(function(Lt){Ot(Lt,St,"INSERT OR REPLACE INTO "+St.storeName+" (key, value) VALUES (?, ?)",[ne,kt],function(){at(Ct)},function(cn,_n){ht(_n)})},function(Lt){if(Lt.code===Lt.QUOTA_ERR){if(Qe>0){at(In.apply(Ke,[ne,Ct,ye,Qe-1]));return}ht(Lt)}})})}).catch(ht)});return Te($e,ye),$e}function Tn(ne,De,ye){return In.apply(this,[ne,De,ye,1])}function fn(ne,De){var ye=this;ne=w(ne);var Qe=new Ye(function(Ke,$e){ye.ready().then(function(){var at=ye._dbInfo;at.db.transaction(function(ht){Ot(ht,at,"DELETE FROM "+at.storeName+" WHERE key = ?",[ne],function(){Ke()},function(Ct,St){$e(St)})})}).catch($e)});return Te(Qe,De),Qe}function Rr(ne){var De=this,ye=new Ye(function(Qe,Ke){De.ready().then(function(){var $e=De._dbInfo;$e.db.transaction(function(at){Ot(at,$e,"DELETE FROM "+$e.storeName,[],function(){Qe()},function(ht,Ct){Ke(Ct)})})}).catch(Ke)});return Te(ye,ne),ye}function ir(ne){var De=this,ye=new Ye(function(Qe,Ke){De.ready().then(function(){var $e=De._dbInfo;$e.db.transaction(function(at){Ot(at,$e,"SELECT COUNT(key) as c FROM "+$e.storeName,[],function(ht,Ct){var St=Ct.rows.item(0).c;Qe(St)},function(ht,Ct){Ke(Ct)})})}).catch(Ke)});return Te(ye,ne),ye}function Ln(ne,De){var ye=this,Qe=new Ye(function(Ke,$e){ye.ready().then(function(){var at=ye._dbInfo;at.db.transaction(function(ht){Ot(ht,at,"SELECT key FROM "+at.storeName+" WHERE id = ? LIMIT 1",[ne+1],function(Ct,St){var kt=St.rows.length?St.rows.item(0).key:null;Ke(kt)},function(Ct,St){$e(St)})})}).catch($e)});return Te(Qe,De),Qe}function mn(ne){var De=this,ye=new Ye(function(Qe,Ke){De.ready().then(function(){var $e=De._dbInfo;$e.db.transaction(function(at){Ot(at,$e,"SELECT key FROM "+$e.storeName,[],function(ht,Ct){for(var St=[],kt=0;kt<Ct.rows.length;kt++)St.push(Ct.rows.item(kt).key);Qe(St)},function(ht,Ct){Ke(Ct)})})}).catch(Ke)});return Te(ye,ne),ye}function Qn(ne){return new Ye(function(De,ye){ne.transaction(function(Qe){Qe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Ke,$e){for(var at=[],ht=0;ht<$e.rows.length;ht++)at.push($e.rows.item(ht).name);De({db:ne,storeNames:at})},function(Ke,$e){ye($e)})},function(Qe){ye(Qe)})})}function Nn(ne,De){De=Re.apply(this,arguments);var ye=this.config();ne=typeof ne!="function"&&ne||{},ne.name||(ne.name=ne.name||ye.name,ne.storeName=ne.storeName||ye.storeName);var Qe=this,Ke;return ne.name?Ke=new Ye(function($e){var at;ne.name===ye.name?at=Qe._dbInfo.db:at=openDatabase(ne.name,"","",0),ne.storeName?$e({db:at,storeNames:[ne.storeName]}):$e(Qn(at))}).then(function($e){return new Ye(function(at,ht){$e.db.transaction(function(Ct){function St(cn){return new Ye(function(_n,vn){Ct.executeSql("DROP TABLE IF EXISTS "+cn,[],function(){_n()},function(xn,An){vn(An)})})}for(var kt=[],Ut=0,Lt=$e.storeNames.length;Ut<Lt;Ut++)kt.push(St($e.storeNames[Ut]));Ye.all(kt).then(function(){at()}).catch(function(cn){ht(cn)})},function(Ct){ht(Ct)})})}):Ke=Ye.reject("Invalid arguments"),Te(Ke,De),Ke}var or={_driver:"webSQLStorage",_initStorage:Ve,_support:te(),iterate:an,getItem:rn,setItem:Tn,removeItem:fn,clear:Rr,length:ir,key:Ln,keys:mn,dropInstance:Nn};function pr(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function sr(ne,De){var ye=ne.name+"/";return ne.storeName!==De.storeName&&(ye+=ne.storeName+"/"),ye}function Wr(){var ne="_localforage_support_test";try{return localStorage.setItem(ne,!0),localStorage.removeItem(ne),!1}catch{return!0}}function tr(){return!Wr()||localStorage.length>0}function zn(ne){var De=this,ye={};if(ne)for(var Qe in ne)ye[Qe]=ne[Qe];return ye.keyPrefix=sr(ne,De._defaultConfig),tr()?(De._dbInfo=ye,ye.serializer=_t,Ye.resolve()):Ye.reject()}function bn(ne){var De=this,ye=De.ready().then(function(){for(var Qe=De._dbInfo.keyPrefix,Ke=localStorage.length-1;Ke>=0;Ke--){var $e=localStorage.key(Ke);$e.indexOf(Qe)===0&&localStorage.removeItem($e)}});return Te(ye,ne),ye}function Jn(ne,De){var ye=this;ne=w(ne);var Qe=ye.ready().then(function(){var Ke=ye._dbInfo,$e=localStorage.getItem(Ke.keyPrefix+ne);return $e&&($e=Ke.serializer.deserialize($e)),$e});return Te(Qe,De),Qe}function zr(ne,De){var ye=this,Qe=ye.ready().then(function(){for(var Ke=ye._dbInfo,$e=Ke.keyPrefix,at=$e.length,ht=localStorage.length,Ct=1,St=0;St<ht;St++){var kt=localStorage.key(St);if(kt.indexOf($e)===0){var Ut=localStorage.getItem(kt);if(Ut&&(Ut=Ke.serializer.deserialize(Ut)),Ut=ne(Ut,kt.substring(at),Ct++),Ut!==void 0)return Ut}}});return Te(Qe,De),Qe}function jn(ne,De){var ye=this,Qe=ye.ready().then(function(){var Ke=ye._dbInfo,$e;try{$e=localStorage.key(ne)}catch{$e=null}return $e&&($e=$e.substring(Ke.keyPrefix.length)),$e});return Te(Qe,De),Qe}function Lr(ne){var De=this,ye=De.ready().then(function(){for(var Qe=De._dbInfo,Ke=localStorage.length,$e=[],at=0;at<Ke;at++){var ht=localStorage.key(at);ht.indexOf(Qe.keyPrefix)===0&&$e.push(ht.substring(Qe.keyPrefix.length))}return $e});return Te(ye,ne),ye}function Vr(ne){var De=this,ye=De.keys().then(function(Qe){return Qe.length});return Te(ye,ne),ye}function Ai(ne,De){var ye=this;ne=w(ne);var Qe=ye.ready().then(function(){var Ke=ye._dbInfo;localStorage.removeItem(Ke.keyPrefix+ne)});return Te(Qe,De),Qe}function Yr(ne,De,ye){var Qe=this;ne=w(ne);var Ke=Qe.ready().then(function(){De===void 0&&(De=null);var $e=De;return new Ye(function(at,ht){var Ct=Qe._dbInfo;Ct.serializer.serialize(De,function(St,kt){if(kt)ht(kt);else try{localStorage.setItem(Ct.keyPrefix+ne,St),at($e)}catch(Ut){(Ut.name==="QuotaExceededError"||Ut.name==="NS_ERROR_DOM_QUOTA_REACHED")&&ht(Ut),ht(Ut)}})})});return Te(Ke,ye),Ke}function Qr(ne,De){if(De=Re.apply(this,arguments),ne=typeof ne!="function"&&ne||{},!ne.name){var ye=this.config();ne.name=ne.name||ye.name,ne.storeName=ne.storeName||ye.storeName}var Qe=this,Ke;return ne.name?Ke=new Ye(function($e){ne.storeName?$e(sr(ne,Qe._defaultConfig)):$e(ne.name+"/")}).then(function($e){for(var at=localStorage.length-1;at>=0;at--){var ht=localStorage.key(at);ht.indexOf($e)===0&&localStorage.removeItem(ht)}}):Ke=Ye.reject("Invalid arguments"),Te(Ke,De),Ke}var Ci={_driver:"localStorageWrapper",_initStorage:zn,_support:pr(),iterate:zr,getItem:Jn,setItem:Yr,removeItem:Ai,clear:bn,length:Vr,key:jn,keys:Lr,dropInstance:Qr},Si=function(De,ye){return De===ye||typeof De=="number"&&typeof ye=="number"&&isNaN(De)&&isNaN(ye)},ri=function(De,ye){for(var Qe=De.length,Ke=0;Ke<Qe;){if(Si(De[Ke],ye))return!0;Ke++}return!1},fr=Array.isArray||function(ne){return Object.prototype.toString.call(ne)==="[object Array]"},Yn={},yi={},dr={INDEXEDDB:Fe,WEBSQL:or,LOCALSTORAGE:Ci},ii=[dr.INDEXEDDB._driver,dr.WEBSQL._driver,dr.LOCALSTORAGE._driver],kn=["dropInstance"],nr=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(kn),Fn={description:"",driver:ii.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function _r(ne,De){ne[De]=function(){var ye=arguments;return ne.ready().then(function(){return ne[De].apply(ne,ye)})}}function P(){for(var ne=1;ne<arguments.length;ne++){var De=arguments[ne];if(De)for(var ye in De)De.hasOwnProperty(ye)&&(fr(De[ye])?arguments[0][ye]=De[ye].slice():arguments[0][ye]=De[ye])}return arguments[0]}var He=function(){function ne(De){bt(this,ne);for(var ye in dr)if(dr.hasOwnProperty(ye)){var Qe=dr[ye],Ke=Qe._driver;this[ye]=Ke,Yn[Ke]||this.defineDriver(Qe)}this._defaultConfig=P({},Fn),this._config=P({},this._defaultConfig,De),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return ne.prototype.config=function(ye){if((typeof ye>"u"?"undefined":ct(ye))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var Qe in ye){if(Qe==="storeName"&&(ye[Qe]=ye[Qe].replace(/\W/g,"_")),Qe==="version"&&typeof ye[Qe]!="number")return new Error("Database version must be a number.");this._config[Qe]=ye[Qe]}return"driver"in ye&&ye.driver?this.setDriver(this._config.driver):!0}else return typeof ye=="string"?this._config[ye]:this._config},ne.prototype.defineDriver=function(ye,Qe,Ke){var $e=new Ye(function(at,ht){try{var Ct=ye._driver,St=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!ye._driver){ht(St);return}for(var kt=nr.concat("_initStorage"),Ut=0,Lt=kt.length;Ut<Lt;Ut++){var cn=kt[Ut],_n=!ri(kn,cn);if((_n||ye[cn])&&typeof ye[cn]!="function"){ht(St);return}}var vn=function(){for(var Zn=function(Zr){return function(){var kr=new Error("Method "+Zr+" is not implemented by the current driver"),Fr=Ye.reject(kr);return Te(Fr,arguments[arguments.length-1]),Fr}},Kn=0,Bn=kn.length;Kn<Bn;Kn++){var Jr=kn[Kn];ye[Jr]||(ye[Jr]=Zn(Jr))}};vn();var xn=function(Zn){Yn[Ct]&&console.info("Redefining LocalForage driver: "+Ct),Yn[Ct]=ye,yi[Ct]=Zn,at()};"_support"in ye?ye._support&&typeof ye._support=="function"?ye._support().then(xn,ht):xn(!!ye._support):xn(!0)}catch(An){ht(An)}});return E($e,Qe,Ke),$e},ne.prototype.driver=function(){return this._driver||null},ne.prototype.getDriver=function(ye,Qe,Ke){var $e=Yn[ye]?Ye.resolve(Yn[ye]):Ye.reject(new Error("Driver not found."));return E($e,Qe,Ke),$e},ne.prototype.getSerializer=function(ye){var Qe=Ye.resolve(_t);return E(Qe,ye),Qe},ne.prototype.ready=function(ye){var Qe=this,Ke=Qe._driverSet.then(function(){return Qe._ready===null&&(Qe._ready=Qe._initDriver()),Qe._ready});return E(Ke,ye,ye),Ke},ne.prototype.setDriver=function(ye,Qe,Ke){var $e=this;fr(ye)||(ye=[ye]);var at=this._getSupportedDrivers(ye);function ht(){$e._config.driver=$e.driver()}function Ct(Ut){return $e._extend(Ut),ht(),$e._ready=$e._initStorage($e._config),$e._ready}function St(Ut){return function(){var Lt=0;function cn(){for(;Lt<Ut.length;){var _n=Ut[Lt];return Lt++,$e._dbInfo=null,$e._ready=null,$e.getDriver(_n).then(Ct).catch(cn)}ht();var vn=new Error("No available storage method found.");return $e._driverSet=Ye.reject(vn),$e._driverSet}return cn()}}var kt=this._driverSet!==null?this._driverSet.catch(function(){return Ye.resolve()}):Ye.resolve();return this._driverSet=kt.then(function(){var Ut=at[0];return $e._dbInfo=null,$e._ready=null,$e.getDriver(Ut).then(function(Lt){$e._driver=Lt._driver,ht(),$e._wrapLibraryMethodsWithReady(),$e._initDriver=St(at)})}).catch(function(){ht();var Ut=new Error("No available storage method found.");return $e._driverSet=Ye.reject(Ut),$e._driverSet}),E(this._driverSet,Qe,Ke),this._driverSet},ne.prototype.supports=function(ye){return!!yi[ye]},ne.prototype._extend=function(ye){P(this,ye)},ne.prototype._getSupportedDrivers=function(ye){for(var Qe=[],Ke=0,$e=ye.length;Ke<$e;Ke++){var at=ye[Ke];this.supports(at)&&Qe.push(at)}return Qe},ne.prototype._wrapLibraryMethodsWithReady=function(){for(var ye=0,Qe=nr.length;ye<Qe;ye++)_r(this,nr[ye])},ne.prototype.createInstance=function(ye){return new ne(ye)},ne}(),de=new He;sn.exports=de},{3:3}]},{},[4])(4)})}(localforage)),localforage.exports}(function(yn,Bt){(function(on,sn){yn.exports=sn(requireUmd(),requireMinimal(),requireZegoExpressLogger(),requireLocalforage())})(typeof self<"u"?self:commonjsGlobal,function(on,sn,Dt,ct){return function(){var bt={166:function(It,Ye,Te){var E,w,Re,we;Te.d(Ye,{PP:function(){return we},SC:function(){return Re}}),function(he){he[he.NONE=0]="NONE",he[he.MEN_TO_CHILD=1]="MEN_TO_CHILD",he[he.MEN_TO_WOMEN=2]="MEN_TO_WOMEN",he[he.WOMEN_TO_CHILD=3]="WOMEN_TO_CHILD",he[he.WOMEN_TO_MEN=4]="WOMEN_TO_MEN",he[he.FOREIGNER=5]="FOREIGNER",he[he.OPTIMUS_PRIME=6]="OPTIMUS_PRIME",he[he.ANDROID=7]="ANDROID",he[he.ETHEREAL=8]="ETHEREAL",he[he.MALE_MAGNETIC=9]="MALE_MAGNETIC",he[he.FEMALE_FRESH=10]="FEMALE_FRESH",he[he.MAJOR_C=11]="MAJOR_C",he[he.MINOR_A=12]="MINOR_A",he[he.HARMONIC_MINOR=13]="HARMONIC_MINOR",he[he.FEMALE_ENERGETIC=14]="FEMALE_ENERGETIC",he[he.RICHNESS=15]="RICHNESS",he[he.MUFFLED=16]="MUFFLED",he[he.ROUNDNESS=17]="ROUNDNESS",he[he.FALSETTO=18]="FALSETTO",he[he.FULLNESS=19]="FULLNESS",he[he.CLEAR=20]="CLEAR",he[he.HIGHLY_RESONANT=21]="HIGHLY_RESONANT",he[he.LOUD_CLEAR=22]="LOUD_CLEAR"}(E||(E={})),function(he){he[he.None=0]="None",he[he.SoftRoom=1]="SoftRoom",he[he.LargeRoom=2]="LargeRoom",he[he.ConcertHall=3]="ConcertHall",he[he.Valley=4]="Valley",he[he.RecordingStudio=5]="RecordingStudio",he[he.Basement=6]="Basement",he[he.KTV=7]="KTV",he[he.Popular=8]="Popular",he[he.Rock=9]="Rock",he[he.VocalConcert=10]="VocalConcert",he[he.GramoPhone=11]="GramoPhone",he[he.EnhancedKTV=12]="EnhancedKTV"}(w||(w={})),function(he){he[he.None=0]="None",he[he.Local=1]="Local",he[he.Publish=2]="Publish",he[he.All=3]="All"}(Re||(Re={})),function(he){he[he.AI=0]="AI",he[he.AIBalanced=1]="AIBalanced",he[he.AIAggressive=2]="AIAggressive"}(we||(we={}))},327:function(It,Ye,Te){Te.d(Ye,{L:function(){return w}});var E=Te(4872);function w(Re,we){if(Re&&!(0,E.dr)(Re)&&Re.zegoStream){if(we.info("cu.gs type:zego"),(0,E.dr)(Re.stream))return Re.stream;throw new Error("The ZegoLocalStream type requires first calling the capture api to capture the stream")}return Re}},477:function(){},743:function(It,Ye,Te){Te.d(Ye,{RangeAudio:function(){return st}});var E=Te(8899),w=Te(8866),Re=function(){function Ie(){}return Ie.generateEls=function(D){if(D===void 0&&(D=30),this.elements.length>=D)this.elements.forEach(function(ce){ce.dom.play().catch(function(le){})});else{var me=Array(D-this.elements.length).fill(0).map(function(ce,le){var et=w.VJ.createElement("audio");return et.muted=!0,et.setAttribute("autoplay","autoplay"),et.setAttribute("playsInline","playsInline"),et.id="audio"+le,{dom:et,id:le,used:!1}});this.elements=this.elements.concat(me)}},Ie.useAudioEl=function(){this.elements.length===0&&this.generateEls();var D=this.elements.find(function(me){return!me.used});return D&&(D.used=!0),D},Ie.stopUsingAudioEl=function(D){var me=this.elements[D];me&&(me.dom.onpause=null,me.dom.onerror=null,me.dom.muted=!0,me.used=!1)},Ie.elements=[],Ie}(),we=function(Ie,D,me,ce){return new(me||(me=Promise))(function(le,et){function ze(mt){try{_t(ce.next(mt))}catch(Ve){et(Ve)}}function ft(mt){try{_t(ce.throw(mt))}catch(Ve){et(Ve)}}function _t(mt){var Ve;mt.done?le(mt.value):(Ve=mt.value,Ve instanceof me?Ve:new me(function(Ot){Ot(Ve)})).then(ze,ft)}_t((ce=ce.apply(Ie,D||[])).next())})},he=function(Ie,D){var me,ce,le,et,ze={label:0,sent:function(){if(1&le[0])throw le[1];return le[1]},trys:[],ops:[]};return et={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(et[Symbol.iterator]=function(){return this}),et;function ft(_t){return function(mt){return function(Ve){if(me)throw new TypeError("Generator is already executing.");for(;et&&(et=0,Ve[0]&&(ze=0)),ze;)try{if(me=1,ce&&(le=2&Ve[0]?ce.return:Ve[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,Ve[1])).done)return le;switch(ce=0,le&&(Ve=[2&Ve[0],le.value]),Ve[0]){case 0:case 1:le=Ve;break;case 4:return ze.label++,{value:Ve[1],done:!1};case 5:ze.label++,ce=Ve[1],Ve=[0];continue;case 7:Ve=ze.ops.pop(),ze.trys.pop();continue;default:if(le=ze.trys,!((le=le.length>0&&le[le.length-1])||Ve[0]!==6&&Ve[0]!==2)){ze=0;continue}if(Ve[0]===3&&(!le||Ve[1]>le[0]&&Ve[1]<le[3])){ze.label=Ve[1];break}if(Ve[0]===6&&ze.label<le[1]){ze.label=le[1],le=Ve;break}if(le&&ze.label<le[2]){ze.label=le[2],ze.ops.push(Ve);break}le[2]&&ze.ops.pop(),ze.trys.pop();continue}Ve=D.call(Ie,ze)}catch(Ot){Ve=[6,Ot],ce=0}finally{me=le=0}if(5&Ve[0])throw Ve[1];return{value:Ve[0]?Ve[1]:void 0,done:!0}}([_t,mt])}}},Me="zc.ra.3",nt=function(){function Ie(D,me){this.un=D,this.an=me,this.rtcConn=null,this.loopbackConn=null,this.destStream=new MediaStream,this.onError=null}return Ie.prototype.bindStream=function(D,me){var ce,le;return we(this,void 0,void 0,function(){var et,ze,ft,_t,mt,Ve,Ot=this;return he(this,function(rn){switch(rn.label){case 0:return me&&(this.un=me),et=["completed","connected"],this.rtcConn&&this.loopbackConn&&et.includes(this.rtcConn.connectionState)?(ze=(ce=this.rtcConn)===null||ce===void 0?void 0:ce.getSenders().find(function(an){var In;return((In=an.track)===null||In===void 0?void 0:In.kind)==="audio"}),D.getTracks().forEach(function(an){an.kind==="audio"&&(ze==null||ze.replaceTrack(an))}),[3,10]):[3,1];case 1:this.rtcConn=new RTCPeerConnection,this.loopbackConn=new RTCPeerConnection,ft={offerVideo:!0,offerAudio:!0,offerToReceiveAudio:!1,offerToReceiveVideo:!1},this.rtcConn.onicecandidateerror=function(an){Ot.an.warn(Me+" ".concat(Ot.un," loopback in ice error: ").concat(JSON.stringify(an)))},this.loopbackConn.onicecandidateerror=function(an){Ot.an.warn(Me+" ".concat(Ot.un," loopback out ice error: ").concat(JSON.stringify(an)))},this.rtcConn.onicecandidate=function(an){var In,Tn=an.candidate;Tn&&(Ot.an.info(Me+" ".concat(Ot.un," loopback add out candidate: ").concat(Tn)),(In=Ot.loopbackConn)===null||In===void 0||In.addIceCandidate(new RTCIceCandidate(Tn)))},this.loopbackConn.onicecandidate=function(an){var In,Tn=an.candidate;Tn&&(Ot.an.info(Me+" ".concat(Ot.un," loopback add in candidate: ").concat(Tn)),(In=Ot.rtcConn)===null||In===void 0||In.addIceCandidate(new RTCIceCandidate(Tn)))},window.setTimeout(function(){Ot.rtcConn&&Ot.loopbackConn&&(et.includes(Ot.rtcConn.iceConnectionState)&&et.includes(Ot.loopbackConn.iceConnectionState)?Ot.an.info(Me+" ".concat(Ot.un," loopback connect ok.")):(Ot.an.warn(Me+" ".concat(Ot.un," loopback connect failed. in state: ").concat(Ot.rtcConn.iceConnectionState,", out state: ").concat(Ot.loopbackConn.iceConnectionState)),Ot.close(),Ot.onError&&Ot.onError("time out")))},2e3),this.loopbackConn.ontrack=function(an){var In=an.track;Ot.an.info(Me+" ".concat(Ot.un," loopback receive track")),Ot.replaceTrack(In)},D.getTracks().find(function(an){var In;if(an.kind==="audio")return(In=Ot.rtcConn)===null||In===void 0||In.addTrack(an,D),!0}),rn.label=2;case 2:return rn.trys.push([2,9,,10]),[4,this.rtcConn.createOffer(ft)];case 3:return _t=rn.sent(),[4,this.rtcConn.setLocalDescription(_t)];case 4:return rn.sent(),[4,this.loopbackConn.setRemoteDescription(_t)];case 5:return rn.sent(),[4,this.loopbackConn.createAnswer()];case 6:return(mt=rn.sent()).sdp=(le=mt.sdp)===null||le===void 0?void 0:le.replace(/useinbandfec=/,"stereo=1;useinbandfec="),[4,this.loopbackConn.setLocalDescription(mt)];case 7:return rn.sent(),[4,this.rtcConn.setRemoteDescription(mt)];case 8:return rn.sent(),this.an.info(Me+" ".concat(this.un," loopback set sdp completed.")),[3,10];case 9:return Ve=rn.sent(),this.an.error(Me+" ".concat(this.un," loopback connect failed.").concat(Ve)),this.close(),this.onError&&this.onError("connect failed"),this.onError=null,[3,10];case 10:return[2,this.destStream]}})})},Ie.prototype.replaceTrack=function(D){var me=this;D.kind==="audio"&&(this.destStream.getTracks().forEach(function(ce){me.destStream.removeTrack(ce)}),this.destStream.addTrack(D))},Ie.prototype.close=function(){var D=this,me=this.rtcConn,ce=this.loopbackConn;this.destStream.getTracks().forEach(function(le){D.destStream.removeTrack(le)}),me==null||me.close(),ce==null||ce.close(),this.rtcConn=null,this.loopbackConn=null},Ie}(),Ne=Te(4872),W=Te(6493),Q=function(Ie,D,me,ce){return new(me||(me=Promise))(function(le,et){function ze(mt){try{_t(ce.next(mt))}catch(Ve){et(Ve)}}function ft(mt){try{_t(ce.throw(mt))}catch(Ve){et(Ve)}}function _t(mt){var Ve;mt.done?le(mt.value):(Ve=mt.value,Ve instanceof me?Ve:new me(function(Ot){Ot(Ve)})).then(ze,ft)}_t((ce=ce.apply(Ie,D||[])).next())})},se=function(Ie,D){var me,ce,le,et,ze={label:0,sent:function(){if(1&le[0])throw le[1];return le[1]},trys:[],ops:[]};return et={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(et[Symbol.iterator]=function(){return this}),et;function ft(_t){return function(mt){return function(Ve){if(me)throw new TypeError("Generator is already executing.");for(;et&&(et=0,Ve[0]&&(ze=0)),ze;)try{if(me=1,ce&&(le=2&Ve[0]?ce.return:Ve[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,Ve[1])).done)return le;switch(ce=0,le&&(Ve=[2&Ve[0],le.value]),Ve[0]){case 0:case 1:le=Ve;break;case 4:return ze.label++,{value:Ve[1],done:!1};case 5:ze.label++,ce=Ve[1],Ve=[0];continue;case 7:Ve=ze.ops.pop(),ze.trys.pop();continue;default:if(le=ze.trys,!((le=le.length>0&&le[le.length-1])||Ve[0]!==6&&Ve[0]!==2)){ze=0;continue}if(Ve[0]===3&&(!le||Ve[1]>le[0]&&Ve[1]<le[3])){ze.label=Ve[1];break}if(Ve[0]===6&&ze.label<le[1]){ze.label=le[1],le=Ve;break}if(le&&ze.label<le[2]){ze.label=le[2],ze.ops.push(Ve);break}le[2]&&ze.ops.pop(),ze.trys.pop();continue}Ve=D.call(Ie,ze)}catch(Ot){Ve=[6,Ot],ce=0}finally{me=le=0}if(5&Ve[0])throw Ve[1];return{value:Ve[0]?Ve[1]:void 0,done:!0}}([_t,mt])}}},J="zc.ra.5",G,U=function(){function Ie(D,me){this.an=D,this.userID="base"+new Date().getTime(),this.isHide=!1,this.distance=null,this.maxDistance=1e3,this.position=null,this.speaker="",this.audioEl=null,this.sourceNode=null,this.isPlaying=!1,this.config={needLoopback:!0,useGain:!0,playOnAudioContext:!1,useWebAudio:!0},this.volume=1,this.gainNode=null,this.isSpatial=!1,this.panner=null,this.audioCtx=me.audioCtx,this.isSpatial=me.isSpatial,this.setMaxDistance((0,Ne.Cs)(me.maxDistance)?me.maxDistance:1e5),this.destNode=this.audioCtx.createMediaStreamDestination(),this.setVolume(me.volume),this.setSpeaker(me.speaker).catch(function(ce){}),this.inBackground(me.isHide)}return Ie.prototype.setPosition=function(D){this.an.info(J+" ".concat(this.userID," set position: ")+D),this.position=D,this.panner&&(this.panner.positionX!==void 0?(this.panner.positionX.value=D[1],this.panner.positionY.value=D[2],this.panner.positionZ.value=-D[0]):this.panner.setPosition(D[1],D[2],-D[0]))},Ie.prototype.getDistanceFromListener=function(D){return this.distance=function(me,ce){if(!ce||!me)return null;var le=[me[0]-ce[0],me[1]-ce[1],me[2]-ce[2]];return Math.sqrt(Math.pow(le[0],2)+Math.pow(le[1],2)+Math.pow(le[2],2))}(this.position,D.position),this.distance},Ie.prototype.setMaxDistance=function(D){this.maxDistance=D,this.panner&&(D<10&&(D=10),this.panner.maxDistance=2.6*D)},Ie.prototype.setVolume=function(D){isNaN(D)||(this.volume=D,this.gainNode&&(this.gainNode.gain.value=this.volume))},Ie.prototype.setSpeaker=function(D){var me;return Q(this,void 0,void 0,function(){var ce,le,et;return se(this,function(ze){switch(ze.label){case 0:if(!(0,Ne.QP)(D))return[2];if(this.speaker=D,!(ce=(me=this.audioEl)===null||me===void 0?void 0:me.dom))return[3,10];if(!(le=ce.setSinkId))return[3,8];ze.label=1;case 1:return ze.trys.push([1,6,,7]),this.config.playOnAudioContext?[3,3]:[4,le.call(ce,D||"")];case 2:return ze.sent(),[3,5];case 3:return[4,le.call(ce,"")];case 4:ze.sent(),ze.label=5;case 5:return this.an.info(J+" ".concat(this.userID," set speaker success. id: ").concat(D,".")),[3,7];case 6:throw et=ze.sent(),this.an.error(J+" ".concat(this.userID," set speaker failed. id: ").concat(D,"  error: ").concat(et,".")),et;case 7:return[3,9];case 8:throw"setting speaker not support.";case 9:return[3,11];case 10:this.an.info(J+" ".concat(this.userID," no element for set speaker.")),ze.label=11;case 11:return[2]}})})},Ie.prototype.initPanner=function(){if(!this.panner){var D=function(ce,le,et){var ze=et||[0,0,0],ft=ce.createPanner(),_t=ce.createGain();return ft.panningModel="HRTF",ft.distanceModel="linear",ft.refDistance=1,ft.maxDistance=2.6*le||1,ft.rolloffFactor=1,ft.coneOuterGain=.4,ft.positionX!==void 0?(ft.positionX.value=ze[1],ft.positionY.value=ze[2],ft.positionZ.value=-ze[0]):ft.setPosition(ze[1],ze[2],-ze[0]),{panner:ft,gainNode:_t}}(this.audioCtx,this.maxDistance,this.position),me=D.gainNode;this.panner=D.panner,this.gainNode=me,me.gain.value=this.volume}},Ie.prototype.changeRenderConfig=function(D,me,ce,le){var et,ze,ft,_t,mt;return me===void 0&&(me=!1),ce===void 0&&(ce=!1),le===void 0&&(le=!0),Q(this,void 0,void 0,function(){var Ve,Ot,rn,an,In,Tn,fn,Rr,ir,Ln,mn,Qn,Nn=this;return se(this,function(or){switch(or.label){case 0:return me||this.isSpatial!==D?(this.isSpatial=D,Ve=(0,W.H8)()&&(0,W.Fr)(),[4,K()]):[2];case 1:return Ot=or.sent(),rn=Ot.platform==="Windows"&&Ot.majorPlatformVersion>=13,an=this.isHide&&(rn||Ve),In=this.audioCtx.state!=="running",le&&(an||In)&&(this.an.warn("".concat(J," ").concat(this.userID," stop web audio. system: ").concat(Ot.platform," ").concat(Ot.majorPlatformVersion)),le=!1),this.config.useWebAudio=le,Tn=(0,W.$t)(),fn=Tn.includes("safari")&&!Tn.includes("chrome"),Rr=Tn.includes("micromessenger")&&new RegExp(/(iphone|ipad|ipod|ios)/i).test(Tn),le||this.stream||(ce=!0),this.config.playOnAudioContext=ce,this.initPanner(),this.isPlaying&&this.sourceNode?(this.lastNode&&this.lastNode.disconnect(),ir=this.sourceNode,this.sourceNode.disconnect(),(et=this.panner)===null||et===void 0||et.disconnect(),(ze=this.gainNode)===null||ze===void 0||ze.disconnect(),this.gainNode?(le&&(this.config.useGain&&(ir=this.sourceNode.connect(this.gainNode)),this.panner&&D&&(ir=ir.connect(this.panner))),ir.connect(ce?this.audioCtx.destination:this.destNode),this.lastNode=ir,this.position&&this.setPosition(this.position),this.an.info(J+" '".concat(this.userID,"' play ").concat(D?"3d":"normal"," stream on ").concat(ce?"audio ctx":"element")),(Ln=(ft=this.audioEl)===null||ft===void 0?void 0:ft.dom)?(Ln.onpause=function(){Nn.an.warn(J+" ".concat(Nn.streamID," audio paused"))},Ln.onerror=function(pr){Nn.an.warn(J+" ".concat(Nn.streamID," audio error, ").concat(pr))},ce?(this.stream&&Ln.srcObject!==this.stream&&(Ln.srcObject=this.stream,Ln.muted=!0,Ln.oncanplay=function(){Ln.play().then(function(){Nn.an.info(J+" ".concat(Nn.userID," ctx autoplay success.")),Nn.checkPlayStatus()}).catch(function(pr){Nn.an.warn(J+" ".concat(Nn.userID," ctx autoplay failed."))})}),[3,6]):[3,2]):[3,6]):[3,6]):[3,6];case 2:return mn=this.destNode.stream,(Qn=this.config.needLoopback&&!Rr&&!fn)&&this.loopbackConn&&(this.loopbackConn.close(),this.loopbackConn.onError=null),le||!this.stream?[3,3]:(this.an.info("".concat(J," ").concat(this.userID," stop audio api")),this.sourceNode.disconnect(),(_t=this.panner)===null||_t===void 0||_t.disconnect(),(mt=this.gainNode)===null||mt===void 0||mt.disconnect(),mn=this.stream,[3,5]);case 3:return Qn&&mn?(this.loopbackConn=this.loopbackConn||new nt(this.streamID||"",this.an),this.loopbackConn.onError=function(pr){Nn.an.warn(J+" ".concat(Nn.userID," loopback failed! ").concat(pr)),Nn.changeRenderConfig(Nn.isSpatial,!0,!0)},[4,this.loopbackConn.bindStream(mn,this.streamID||void 0)]):[3,5];case 4:return mn=or.sent(),[3,5];case 5:Ln.muted=!0,Ln.srcObject=mn,this.setSpeaker(this.speaker).catch(function(pr){}),Ln.oncanplay=function(){if(Ln){Ln.muted=!1;var pr=function(sr){Nn.an.error(J+" ".concat(Nn.userID," autoplay failed. error: ").concat(sr)),Nn.changeRenderConfig(Nn.isSpatial,!0,!0)};Ln.play().then(function(){Ln!=null&&Ln.paused?pr("audio paused"):(Nn.an.info(J+" ".concat(Nn.userID," element autoplay success.")),Nn.checkPlayStatus())}).catch(function(sr){pr(sr)})}},or.label=6;case 6:return[2]}})})},Ie.prototype.checkPlayStatus=function(){var D=this;setTimeout(function(){var me;if(D.isPlaying){var ce=(me=D.audioEl)===null||me===void 0?void 0:me.dom,le=D.audioCtx.state;!ce||ce.paused||ce.muted&&!D.config.playOnAudioContext||le!=="running"?(D.an.warn("".concat(J," ").concat(D.userID," play detection is abnormal. audio ctx:").concat(le,", paused:").concat(ce==null?void 0:ce.paused,", muted:").concat(ce==null?void 0:ce.muted)),le!=="running"&&(D.audioCtx.resume(),setTimeout(function(){D.an.warn("".concat(J," ").concat(D.userID," play resume. audio ctx:").concat(le,", paused:").concat(ce==null?void 0:ce.paused,", muted:").concat(ce==null?void 0:ce.muted))},1e3))):D.an.info("".concat(J," ").concat(D.userID," play detection is fine"))}},2e3)},Ie.prototype.inBackground=function(D,me){D===void 0&&(D=!1),this.isHide!==D&&(this.isHide=D,D||this.config.useWebAudio||this.changeRenderConfig(this.isSpatial,!0))},Ie}(),C=(G=function(Ie,D){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(me,ce){me.__proto__=ce}||function(me,ce){for(var le in ce)Object.prototype.hasOwnProperty.call(ce,le)&&(me[le]=ce[le])},G(Ie,D)},function(Ie,D){if(typeof D!="function"&&D!==null)throw new TypeError("Class extends value "+String(D)+" is not a constructor or null");function me(){this.constructor=Ie}G(Ie,D),Ie.prototype=D===null?Object.create(D):(me.prototype=D.prototype,new me)}),N=function(Ie,D,me,ce){return new(me||(me=Promise))(function(le,et){function ze(mt){try{_t(ce.next(mt))}catch(Ve){et(Ve)}}function ft(mt){try{_t(ce.throw(mt))}catch(Ve){et(Ve)}}function _t(mt){var Ve;mt.done?le(mt.value):(Ve=mt.value,Ve instanceof me?Ve:new me(function(Ot){Ot(Ve)})).then(ze,ft)}_t((ce=ce.apply(Ie,D||[])).next())})},v=function(Ie,D){var me,ce,le,et,ze={label:0,sent:function(){if(1&le[0])throw le[1];return le[1]},trys:[],ops:[]};return et={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(et[Symbol.iterator]=function(){return this}),et;function ft(_t){return function(mt){return function(Ve){if(me)throw new TypeError("Generator is already executing.");for(;et&&(et=0,Ve[0]&&(ze=0)),ze;)try{if(me=1,ce&&(le=2&Ve[0]?ce.return:Ve[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,Ve[1])).done)return le;switch(ce=0,le&&(Ve=[2&Ve[0],le.value]),Ve[0]){case 0:case 1:le=Ve;break;case 4:return ze.label++,{value:Ve[1],done:!1};case 5:ze.label++,ce=Ve[1],Ve=[0];continue;case 7:Ve=ze.ops.pop(),ze.trys.pop();continue;default:if(le=ze.trys,!((le=le.length>0&&le[le.length-1])||Ve[0]!==6&&Ve[0]!==2)){ze=0;continue}if(Ve[0]===3&&(!le||Ve[1]>le[0]&&Ve[1]<le[3])){ze.label=Ve[1];break}if(Ve[0]===6&&ze.label<le[1]){ze.label=le[1],le=Ve;break}if(le&&ze.label<le[2]){ze.label=le[2],ze.ops.push(Ve);break}le[2]&&ze.ops.pop(),ze.trys.pop();continue}Ve=D.call(Ie,ze)}catch(Ot){Ve=[6,Ot],ce=0}finally{me=le=0}if(5&Ve[0])throw Ve[1];return{value:Ve[0]?Ve[1]:void 0,done:!0}}([_t,mt])}}},f="zc.ra.1",_=function(Ie){function D(me,ce,le){var et=Ie.call(this,me,le)||this;return et.an=me,et.audioTrack=null,et.zegoRTC=le.zegoRTC,et.userID=ce.userID,et.teamID=ce.teamID,et.raMode=ce.raMode!==void 0?ce.raMode:E.kf.World,ce.position&&(et.position=ce.position),et}return C(D,Ie),Object.defineProperty(D.prototype,"sendMode",{get:function(){return this._sendMode!==void 0?this._sendMode:this.raMode===E.kf.World?E.UF.All:E.UF.Team},set:function(me){this._sendMode=me},enumerable:!1,configurable:!0}),D.prototype.checkTrackChanged=function(){var me;if(this.stream){var ce=this.stream.getAudioTracks()[0];ce&&ce!==this.audioTrack&&(this.an.info(f+" retry play success, render stream."),(me=this.sourceNode)===null||me===void 0||me.disconnect(),this.sourceNode=this.audioCtx.createMediaStreamSource(this.stream),this.changeRenderConfig(this.isSpatial,!0),this.audioTrack=ce)}},D.prototype.startPlayingAudio=function(me){var ce,le;return N(this,void 0,void 0,function(){var et,ze,ft;return v(this,function(_t){switch(_t.label){case 0:if(!this.streamID)return[2];_t.label=1;case 1:return _t.trys.push([1,3,,4]),me&&this.an.info(f+" ".concat(this.streamID," ")+me),this.isPlaying=!0,et=this,[4,this.zegoRTC.startPlayingStream(this.streamID)];case 2:return et.stream=_t.sent(),this.audioTrack=this.stream.getAudioTracks()[0],[3,4];case 3:if(ze=_t.sent(),this.isPlaying=!1,ze.code===1103049)return[2];throw ze;case 4:return this.audioEl=this.audioEl||Re.useAudioEl()||null,this.an.info(f+" ".concat(this.streamID," start using audio el ").concat((ce=this.audioEl)===null||ce===void 0?void 0:ce.id)),(ft=(le=this.audioEl)===null||le===void 0?void 0:le.dom)||(this.an.error(f+" not enough audio elements"),ft=w.VJ.createElement("audio"),this.audioEl={id:-1,dom:ft,used:!0},ft.setAttribute("autoplay","autoplay")),ft.muted=!0,this.stream&&(this.sourceNode=this.audioCtx.createMediaStreamSource(this.stream)),this.sourceNode?[4,this.changeRenderConfig(this.isSpatial,!0)]:[3,6];case 5:_t.sent(),_t.label=6;case 6:return this.audioCtx.state==="suspended"&&this.audioCtx.resume(),[2]}})})},D.prototype.stopPlayingAudio=function(me){this.isPlaying&&this.streamID?(this.an.info(f+" ".concat(this.streamID," ")+me),this.zegoRTC.stopPlayingStream(this.streamID),this.isPlaying=!1):this.streamID&&this.an.info(f+" ".concat(this.streamID," not playing, ")+me),this.stream=void 0,this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=null);var ce=this.audioEl,le=ce==null?void 0:ce.dom;le&&(le.srcObject=null,le.parentNode&&le.parentNode.removeChild(le));var et=(ce==null?void 0:ce.id)||-1;ce&&et>=0&&(Re.stopUsingAudioEl(et),this.an.info(f+" ".concat(this.streamID," stop using audio el ").concat(et))),this.audioEl=null,this.loopbackConn&&(this.loopbackConn.close(),this.loopbackConn.onError=null)},D.prototype.isSpeakInTeam=function(me){var ce=![this.teamID,me].includes(void 0)&&this.teamID!==""&&this.teamID===me,le=[E.UF.Team,E.UF.All].includes(this.sendMode);return ce&&le},D}(U),b=function(){var Ie=function(D,me){return Ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ce,le){ce.__proto__=le}||function(ce,le){for(var et in le)Object.prototype.hasOwnProperty.call(le,et)&&(ce[et]=le[et])},Ie(D,me)};return function(D,me){if(typeof me!="function"&&me!==null)throw new TypeError("Class extends value "+String(me)+" is not a constructor or null");function ce(){this.constructor=D}Ie(D,me),D.prototype=me===null?Object.create(me):(ce.prototype=me.prototype,new ce)}}(),y=function(Ie,D,me,ce){return new(me||(me=Promise))(function(le,et){function ze(mt){try{_t(ce.next(mt))}catch(Ve){et(Ve)}}function ft(mt){try{_t(ce.throw(mt))}catch(Ve){et(Ve)}}function _t(mt){var Ve;mt.done?le(mt.value):(Ve=mt.value,Ve instanceof me?Ve:new me(function(Ot){Ot(Ve)})).then(ze,ft)}_t((ce=ce.apply(Ie,D||[])).next())})},M=function(Ie,D){var me,ce,le,et,ze={label:0,sent:function(){if(1&le[0])throw le[1];return le[1]},trys:[],ops:[]};return et={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(et[Symbol.iterator]=function(){return this}),et;function ft(_t){return function(mt){return function(Ve){if(me)throw new TypeError("Generator is already executing.");for(;et&&(et=0,Ve[0]&&(ze=0)),ze;)try{if(me=1,ce&&(le=2&Ve[0]?ce.return:Ve[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,Ve[1])).done)return le;switch(ce=0,le&&(Ve=[2&Ve[0],le.value]),Ve[0]){case 0:case 1:le=Ve;break;case 4:return ze.label++,{value:Ve[1],done:!1};case 5:ze.label++,ce=Ve[1],Ve=[0];continue;case 7:Ve=ze.ops.pop(),ze.trys.pop();continue;default:if(le=ze.trys,!((le=le.length>0&&le[le.length-1])||Ve[0]!==6&&Ve[0]!==2)){ze=0;continue}if(Ve[0]===3&&(!le||Ve[1]>le[0]&&Ve[1]<le[3])){ze.label=Ve[1];break}if(Ve[0]===6&&ze.label<le[1]){ze.label=le[1],le=Ve;break}if(le&&ze.label<le[2]){ze.label=le[2],ze.ops.push(Ve);break}le[2]&&ze.ops.pop(),ze.trys.pop();continue}Ve=D.call(Ie,ze)}catch(Ot){Ve=[6,Ot],ce=0}finally{me=le=0}if(5&Ve[0])throw Ve[1];return{value:Ve[0]?Ve[1]:void 0,done:!0}}([_t,mt])}}},Y="zc.ra.4",L=function(Ie){function D(me,ce,le){var et=Ie.call(this,me,le)||this;return et.an=me,et.media=ce.media,et.position=ce.position||null,et.createSource(),et.userID="custom"+new Date().getTime(),et.config={needLoopback:!1,useGain:!1,playOnAudioContext:!1,useWebAudio:!0},et}return b(D,Ie),D.prototype.createSource=function(){var me=this;if((0,W.Fr)())return this.an.info("".concat((0,W.Fr)()," ").concat(this.userID," not create src.")),void(this.changeRenderConfig=function(){return y(me,void 0,void 0,function(){return M(this,function(ce){return[2]})})});this.media&&(this.an.info(Y+" create el source."),this.sourceNode||(this.sourceNode=this.audioCtx.createMediaElementSource(this.media)),this.distance!==null&&this.distance<this.maxDistance&&this.startPlayingAudio("in range"))},D.prototype.startPlayingAudio=function(me){var ce,le;return y(this,void 0,void 0,function(){var et;return M(this,function(ze){switch(ze.label){case 0:return this.isPlaying?(this.an.info(Y+" ".concat(this.userID," is already playing")),[2]):(me&&this.an.info(Y+" vocal ".concat(this.userID," play for ").concat(me)),this.isPlaying=!0,(0,W.Fr)()?(this.media.muted=!1,[2]):(this.audioEl=this.audioEl||Re.useAudioEl()||null,this.an.info(Y+" ".concat(this.userID," start using audio el ").concat((ce=this.audioEl)===null||ce===void 0?void 0:ce.id)),(et=(le=this.audioEl)===null||le===void 0?void 0:le.dom)||(this.an.error(Y+" ".concat(this.userID," not enough audio elements")),et=w.VJ.createElement("audio"),this.audioEl={id:-1,dom:et,used:!0},et.setAttribute("autoplay","autoplay")),et.muted=!0,et.setAttribute("autoplay","autoplay"),et.setAttribute("id","zg-audio-source-"+this.userID),this.sourceNode?[4,this.changeRenderConfig(this.isSpatial,!0)]:[3,2]));case 1:ze.sent(),ze.label=2;case 2:return this.audioCtx.state==="suspended"&&this.audioCtx.resume(),[2]}})})},D.prototype.stopPlayingAudio=function(me){if(me===void 0&&(me=""),this.isPlaying&&(this.an.info(Y+" vocal ".concat(this.userID," stop for ")+me),this.isPlaying=!1),(0,W.Fr)())this.media.muted=!0;else{this.sourceNode&&this.sourceNode.disconnect();var ce=this.audioEl,le=ce==null?void 0:ce.dom;le&&(le.srcObject=null,le.parentNode&&le.parentNode.removeChild(le));var et=(ce==null?void 0:ce.id)||-1;ce&&et>=0&&(Re.stopUsingAudioEl(et),this.an.info(Y+" ".concat(this.userID," stop using audio el ").concat(et))),this.audioEl=null}},D.prototype.checkIfCanPlay=function(me){var ce=this.distance=this.getDistanceFromListener(me);ce===null||ce>this.maxDistance||this.maxDistance===0?this.stopPlayingAudio("out of range. ".concat(ce," > ").concat(this.maxDistance)):this.startPlayingAudio("in range")},D}(U),A=function(){var Ie=function(D,me){return Ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ce,le){ce.__proto__=le}||function(ce,le){for(var et in le)Object.prototype.hasOwnProperty.call(le,et)&&(ce[et]=le[et])},Ie(D,me)};return function(D,me){if(typeof me!="function"&&me!==null)throw new TypeError("Class extends value "+String(me)+" is not a constructor or null");function ce(){this.constructor=D}Ie(D,me),D.prototype=me===null?Object.create(me):(ce.prototype=me.prototype,new ce)}}(),H=function(Ie,D,me,ce){return new(me||(me=Promise))(function(le,et){function ze(mt){try{_t(ce.next(mt))}catch(Ve){et(Ve)}}function ft(mt){try{_t(ce.throw(mt))}catch(Ve){et(Ve)}}function _t(mt){var Ve;mt.done?le(mt.value):(Ve=mt.value,Ve instanceof me?Ve:new me(function(Ot){Ot(Ve)})).then(ze,ft)}_t((ce=ce.apply(Ie,D||[])).next())})},ge=function(Ie,D){var me,ce,le,et,ze={label:0,sent:function(){if(1&le[0])throw le[1];return le[1]},trys:[],ops:[]};return et={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(et[Symbol.iterator]=function(){return this}),et;function ft(_t){return function(mt){return function(Ve){if(me)throw new TypeError("Generator is already executing.");for(;et&&(et=0,Ve[0]&&(ze=0)),ze;)try{if(me=1,ce&&(le=2&Ve[0]?ce.return:Ve[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,Ve[1])).done)return le;switch(ce=0,le&&(Ve=[2&Ve[0],le.value]),Ve[0]){case 0:case 1:le=Ve;break;case 4:return ze.label++,{value:Ve[1],done:!1};case 5:ze.label++,ce=Ve[1],Ve=[0];continue;case 7:Ve=ze.ops.pop(),ze.trys.pop();continue;default:if(le=ze.trys,!((le=le.length>0&&le[le.length-1])||Ve[0]!==6&&Ve[0]!==2)){ze=0;continue}if(Ve[0]===3&&(!le||Ve[1]>le[0]&&Ve[1]<le[3])){ze.label=Ve[1];break}if(Ve[0]===6&&ze.label<le[1]){ze.label=le[1],le=Ve;break}if(le&&ze.label<le[2]){ze.label=le[2],ze.ops.push(Ve);break}le[2]&&ze.ops.pop(),ze.trys.pop();continue}Ve=D.call(Ie,ze)}catch(Ot){Ve=[6,Ot],ce=0}finally{me=le=0}if(5&Ve[0])throw Ve[1];return{value:Ve[0]?Ve[1]:void 0,done:!0}}([_t,mt])}}},Ee="zc.ra.4",Se=function(Ie){function D(me,ce,le){var et=Ie.call(this,me,le)||this;return et.an=me,et.streamView=ce.streamView,et.position=ce.position||null,et.createSource(),et.userID="stream"+new Date().getTime(),et.config={needLoopback:!1,useGain:!1,playOnAudioContext:!1,useWebAudio:!0},et.streamView.on("_trackChange",function(ze,ft){ze==="audio"&&(ft?et.createSource(!0):et.an.error("".concat(Ee," ").concat(et.userID," audio track lost")))}),et}return A(D,Ie),D.prototype.createSource=function(me){var ce=this;if(me===void 0&&(me=!1),(0,W.Fr)())return this.an.info("".concat(Ee," ").concat(this.userID," not create src.")),this.changeRenderConfig=function(){return H(ce,void 0,void 0,function(){return ge(this,function(et){return[2]})})},!1;if(!this.streamView)return!1;if(this.an.info(Ee+" create view source. trackChanged: "+me),!this.sourceNode||me){var le=this.streamView.v.getAudioNodeAndStopRender();if(!le)return this.an.error(Ee+" create view source failed."),!1;this.sourceNode&&this.sourceNode.disconnect(),this.sourceNode=le,this.changeRenderConfig(this.isSpatial,!0)}return this.distance!==null&&this.distance<this.maxDistance&&this.startPlayingAudio("in range"),!0},D.prototype.startPlayingAudio=function(me){var ce,le;return H(this,void 0,void 0,function(){var et;return ge(this,function(ze){switch(ze.label){case 0:return this.isPlaying?(this.an.info(Ee+" ".concat(this.userID," is already playing")),[2]):(me&&this.an.info(Ee+" vocal ".concat(this.userID," play for ").concat(me)),this.isPlaying=!0,(0,W.Fr)()?(this.streamView.setAudioMuted(!1),[2]):(this.audioEl=this.audioEl||Re.useAudioEl()||null,this.an.info(Ee+" ".concat(this.userID," start using audio el ").concat((ce=this.audioEl)===null||ce===void 0?void 0:ce.id)),(et=(le=this.audioEl)===null||le===void 0?void 0:le.dom)||(this.an.error(Ee+" ".concat(this.userID," not enough audio elements")),et=w.VJ.createElement("audio"),this.audioEl={id:-1,dom:et,used:!0},et.setAttribute("autoplay","autoplay")),et.muted=!0,et.setAttribute("autoplay","autoplay"),et.setAttribute("id","zg-audio-source-"+this.userID),this.sourceNode?[4,this.changeRenderConfig(this.isSpatial,!0)]:[3,2]));case 1:ze.sent(),ze.label=2;case 2:return this.audioCtx.state==="suspended"&&this.audioCtx.resume(),[2]}})})},D.prototype.stopPlayingAudio=function(me){if(me===void 0&&(me=""),this.isPlaying&&(this.an.info(Ee+" vocal ".concat(this.userID," stop for ")+me),this.isPlaying=!1),(0,W.Fr)())this.streamView.setAudioMuted(!0);else{this.sourceNode&&this.sourceNode.disconnect();var ce=this.audioEl,le=ce==null?void 0:ce.dom;le&&(le.srcObject=null,le.parentNode&&le.parentNode.removeChild(le));var et=(ce==null?void 0:ce.id)||-1;ce&&et>=0&&(Re.stopUsingAudioEl(et),this.an.info(Ee+" ".concat(this.userID," stop using audio el ").concat(et))),this.audioEl=null}},D.prototype.checkIfCanPlay=function(me){var ce=this.distance=this.getDistanceFromListener(me);ce===null||ce>this.maxDistance||this.maxDistance===0?this.stopPlayingAudio("out of range. ".concat(ce," > ").concat(this.maxDistance)):this.startPlayingAudio("in range")},D}(U),ue=Te(166),oe=function(){function Ie(){this.cn={}}return Ie.getInstance=function(){return Ie.instance||(Ie.instance=new Ie),Ie.instance},Ie.prototype.addEventHandler=function(D,me){if(this.cn[D]||(this.cn[D]=[]),!(0,Ne.JO)(me))throw new Error("Params callBack is not a Function");return this.cn[D].indexOf(me)==-1&&this.cn[D].push(me),!0},Ie.prototype.removeEventHandler=function(D,me){return!!this.cn[D]&&(this.cn[D]=me?this.cn[D].filter(function(ce){return ce!==me}):[],!0)},Ie.prototype.emit=function(D){for(var me=[],ce=1;ce<arguments.length;ce++)me[ce-1]=arguments[ce];this.cn[D]&&this.cn[D].forEach(function(le){try{setTimeout(function(){le.apply(void 0,me)},0)}catch(et){console.error('Fail to execute callback of event "'.concat(D,'" : ').concat(et))}})},Ie.prototype.reset=function(){this.cn={}},Ie}(),be=oe,Le=function(Ie,D,me,ce){return new(me||(me=Promise))(function(le,et){function ze(mt){try{_t(ce.next(mt))}catch(Ve){et(Ve)}}function ft(mt){try{_t(ce.throw(mt))}catch(Ve){et(Ve)}}function _t(mt){var Ve;mt.done?le(mt.value):(Ve=mt.value,Ve instanceof me?Ve:new me(function(Ot){Ot(Ve)})).then(ze,ft)}_t((ce=ce.apply(Ie,D||[])).next())})},pe=function(Ie,D){var me,ce,le,et,ze={label:0,sent:function(){if(1&le[0])throw le[1];return le[1]},trys:[],ops:[]};return et={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(et[Symbol.iterator]=function(){return this}),et;function ft(_t){return function(mt){return function(Ve){if(me)throw new TypeError("Generator is already executing.");for(;et&&(et=0,Ve[0]&&(ze=0)),ze;)try{if(me=1,ce&&(le=2&Ve[0]?ce.return:Ve[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,Ve[1])).done)return le;switch(ce=0,le&&(Ve=[2&Ve[0],le.value]),Ve[0]){case 0:case 1:le=Ve;break;case 4:return ze.label++,{value:Ve[1],done:!1};case 5:ze.label++,ce=Ve[1],Ve=[0];continue;case 7:Ve=ze.ops.pop(),ze.trys.pop();continue;default:if(le=ze.trys,!((le=le.length>0&&le[le.length-1])||Ve[0]!==6&&Ve[0]!==2)){ze=0;continue}if(Ve[0]===3&&(!le||Ve[1]>le[0]&&Ve[1]<le[3])){ze.label=Ve[1];break}if(Ve[0]===6&&ze.label<le[1]){ze.label=le[1],le=Ve;break}if(le&&ze.label<le[2]){ze.label=le[2],ze.ops.push(Ve);break}le[2]&&ze.ops.pop(),ze.trys.pop();continue}Ve=D.call(Ie,ze)}catch(Ot){Ve=[6,Ot],ce=0}finally{me=le=0}if(5&Ve[0])throw Ve[1];return{value:Ve[0]?Ve[1]:void 0,done:!0}}([_t,mt])}}},k,R=function(){function Ie(D,me){var ce=this;this.raMode=E.kf.World,this.recvRange=null,this.position=null,this.forwardAxis=[1,0,0],this.upAxis=[0,0,1],this.audioStream=null,this.enableMic=!1,this.isPublishing=!1,this.streamID=null,this.isDenoise=!1,this.denoiseMode=ue.PP.AI,this.voiceChanger=null,this.voiceParam=null,this.isUpdated=!0,this.zegoRTC=me,this.audioCtx=D,this.audioListener=this.audioCtx.listener,this.eventHandler=be.getInstance(),this.zegoRTC.on("publisherStateUpdate",function(le){var et=le.state,ze=le.errorCode,ft=le.extendedData,_t=le.streamID.match(/(.*)_(.*)/);if((_t==null?void 0:_t.length)===3){if(ce.userID!==_t[1])return;et==="NO_PUBLISH"?(ce.isPublishing=!1,ce.stopPublishingStream()):(ce.isPublishing=!0,ce.isUpdated||(ce.an.info(f+" resend stream info"),ce.updateSteamExtraInfo())),ce.eventHandler.emit("microphoneStateUpdate",{NO_PUBLISH:E.eI.Off,PUBLISH_REQUESTING:E.eI.TurningOn,PUBLISHING:E.eI.On}[et],ze,ft)}}),this.zegoRTC.on("deviceError",function(le,et){return Le(ce,void 0,void 0,function(){var ze,ft;return pe(this,function(_t){switch(_t.label){case 0:return this.an.info(f+" device fail ".concat(le," ").concat(et," ").concat(!!this.audioStream," ").concat(this.micID)),this.audioStream?[4,this.zegoRTC.enumDevices()]:[2];case 1:return ze=_t.sent(),ft=ze.microphones,this.micID||ft.length!==0?le!==1106009?[3,3]:[4,this.zegoRTC.useAudioDevice(this.audioStream,this.micID||ft[0].deviceID)]:[2];case 2:_t.sent(),_t.label=3;case 3:return[2]}})})})}return Object.defineProperty(Ie.prototype,"recvMode",{get:function(){return this._recvMode!==void 0?this._recvMode:[E.kf.World,E.kf.SecretTeam].includes(this.raMode)?E.ju.All:E.ju.Team},set:function(D){this._recvMode=D},enumerable:!1,configurable:!0}),Object.defineProperty(Ie.prototype,"sendMode",{get:function(){return this._sendMode!==void 0?this._sendMode:this.raMode===E.kf.World?E.UF.All:E.UF.Team},set:function(D){this._sendMode=D},enumerable:!1,configurable:!0}),Object.defineProperty(Ie.prototype,"an",{get:function(){return this.zegoRTC.logger},enumerable:!1,configurable:!0}),Ie.getInstance=function(D,me){return Ie.instance||(Ie.instance=new Ie(D,me)),Ie.instance},Ie.prototype.updateSelfPosition=function(D,me,ce){this.position=D,this.forwardAxis=me,Array.isArray(ce)&&(this.upAxis=ce),this.updateListenerEffect()},Ie.prototype.updateListenerEffect=function(){this.position&&(this.audioListener.positionX?(this.audioListener.positionX.value=this.position[1],this.audioListener.positionY.value=this.position[2],this.audioListener.positionZ.value=-this.position[0]):this.audioListener.setPosition(this.position[1],this.position[2],-this.position[0]),this.audioListener.forwardX?(this.audioListener.forwardX.value=this.forwardAxis[1],this.audioListener.forwardY.value=this.forwardAxis[2],this.audioListener.forwardZ.value=-this.forwardAxis[0],this.audioListener.upX.value=this.upAxis[1],this.audioListener.upY.value=this.upAxis[2],this.audioListener.upZ.value=-this.upAxis[0]):this.audioListener.setOrientation(this.forwardAxis[1],this.forwardAxis[2],-this.forwardAxis[0],this.upAxis[1],this.upAxis[2],-this.upAxis[0]))},Ie.prototype.startPublishingStream=function(){var D=this;this.enableMic?this.an.warn(f+" mic is already enabled"):(this.enableMic=!0,this.zegoRTC.createStream({camera:{video:!1,audio:!0,audioInput:this.micID||void 0,audioBitrate:30}}).then(function(me){return Le(D,void 0,void 0,function(){return pe(this,function(ce){if(!this.userID)throw this.zegoRTC.destroyStream(me),this.enableMic=!1,Error("Enable mic failed. Please log in room first.");return this.audioStream&&this.audioStream!==me&&this.zegoRTC.destroyStream(this.audioStream),this.audioStream=me,this.isDenoise&&(this.enableDenoise(this.isDenoise),this.denoiseMode!==ue.PP.AIBalanced&&this.denoiseMode!=ue.PP.AIAggressive||this.setAiDenoiseMode(this.denoiseMode)),this.voiceChanger!==null&&this.setVoiceChangerPreset({voiceChanger:this.voiceChanger}),this.voiceParam!==null&&this.setVoiceChangerPreset({voiceParam:this.voiceParam}),this.streamID=this.userID+"_"+Date.now(),this.zegoRTC.startPublishingStream(this.streamID,me,{extraInfo:JSON.stringify(this.getExtraInfo())}),[2]})})}).catch(function(me){throw D.audioStream=null,D.enableMic=!1,me}))},Ie.prototype.stopPublishingStream=function(){this.isPublishing&&this.streamID&&this.zegoRTC.stopPublishingStream(this.streamID),this.isPublishing=!1,this.audioStream&&(this.zegoRTC.destroyStream(this.audioStream),this.audioStream=null),this.enableMic=!1},Ie.prototype.setCustomMode=function(D,me){var ce=!1,le=!1,et=!1;return me!==this.recvMode&&(this.recvMode=me,et=!0),D!==this.sendMode&&(this.sendMode=D,ce=!0,le=!0),ce&&this.updateSteamExtraInfo(),{sendChange:le,recvChange:et}},Ie.prototype.setNormalMode=function(D){this.raMode=D,this.updateSteamExtraInfo()},Ie.prototype.setTeamID=function(D){this.teamID=D,this.updateSteamExtraInfo()},Ie.prototype.updateSteamExtraInfo=function(){var D=this;this.streamID&&this.isPublishing&&(this.isUpdated=!1,this.an.info(f+" update stream info"),this.zegoRTC.setStreamExtraInfo(this.streamID,JSON.stringify(this.getExtraInfo())).then(function(me){me.errorCode===0&&(D.an.info(f+" update stream info success"),D.isUpdated=!0)}))},Ie.prototype.getExtraInfo=function(){var D,me={range_audio_team_id:this.teamID||"",range_audio_mode:(D=this.raMode,{0:1,1:2,2:3}[D]),r_a_s_flag:1};return this._sendMode===void 0&&this.raMode!==E.kf.World||(me.r_a_speak=this.sendMode),me},Ie.prototype.reset=function(){this.audioStream&&this.stopPublishingStream(),this.userID=void 0,this.streamID=null},Ie.prototype.enableDenoise=function(D){var me=this;return this.audioStream&&this.zegoRTC._enableAiDenoise(this.audioStream,D).catch(function(ce){me.isDenoise=!1;var le=ce||{};me.eventHandler.emit("aiDenoiseError",le.errorCode,le.extendedData)}),this.isDenoise=D,!0},Ie.prototype.setAiDenoiseMode=function(D){var me=this;return this.audioStream&&this.zegoRTC.setAiDenoiseMode(this.audioStream,D).catch(function(ce){me.denoiseMode=ue.PP.AI;var le=ce||{};me.eventHandler.emit("aiDenoiseError",le.errorCode,le.extendedData)}),this.denoiseMode=D,!0},Ie.prototype.setVoiceChangerPreset=function(D){var me=this;return this.audioStream&&this.zegoRTC.setVoiceChangerPreset(this.audioStream,D).catch(function(ce){me.voiceChanger=null;var le=ce||{};me.eventHandler.emit("voiceChangerError",le.errorCode,le.extendedData)}),"voiceChanger"in D&&D.voiceChanger!==void 0?(this.voiceChanger=D.voiceChanger,this.voiceParam=null):"voiceParam"in D&&D.voiceParam!==void 0&&(this.voiceParam=D.voiceParam,this.voiceChanger=null),!0},Ie}(),Fe=function(Ie,D,me){if(me||arguments.length===2)for(var ce,le=0,et=D.length;le<et;le++)!ce&&le in D||(ce||(ce=Array.prototype.slice.call(D,0,le)),ce[le]=D[le]);return Ie.concat(ce||Array.prototype.slice.call(D))},te="zc.ra.2",Ue=function(){function Ie(D,me){this.an=D,this.isEnable=!1,this.interval=100,this.timer=null,this.audioSourceList=[],this.hasChanged=!1,this.userChanged=!1,this.updateUserInterval=1e3,this.updateUserTimer=null,this.audioSourceUpdate=!1,this._maxPlayingQuantity=20,this.allAudioSourceList=[],this.audioSourceWithinRangeList=[],this.localUserList=[],this.hn=me}return Ie.getInstance=function(D,me){return Ie.instance||(Ie.instance=new Ie(D,me)),Ie.instance},Ie.prototype.setAudioSourceUpdate=function(D){this.audioSourceUpdate=D},Ie.prototype.setListener=function(D){this.hn=D,this.hasChanged=!0,this.userChanged=!0},Ie.prototype.setAudioSourceList=function(D){this.audioSourceList=D,this.an.info("".concat(te," set src list: [").concat(D.map(function(me){return me.userID}).join(","),"]")),this.hasChanged=!0},Ie.prototype.setAllAudioSourceList=function(D){D&&(this.allAudioSourceList=D),this.userChanged=!0},Ie.prototype.startPlayingAudioStream=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.hasChanged=!0,this.playAudioTask()},Ie.prototype.playAudioTask=function(){var D=this;this.hasChanged&&(this.hasChanged=!1,this.handlePlayAudioTask()),this.timer=window.setTimeout(function(){D.playAudioTask()},this.interval)},Ie.prototype.handlePlayAudioTask=function(){var D=this;if(this.isEnable){this.an.info("".concat(te," handler task start"));var me=Fe([],this.audioSourceList,!0),ce=0,le=this.hn.recvMode;if([E.ju.Team,E.ju.All].includes(le)){var et=this.getTeamAudioSourceGroup();me=et.otherList,et.teamList.forEach(function(ft){ce<D._maxPlayingQuantity&&(ft.isPlaying||ft.startPlayingAudio("play for team"),ce++)})}var ze=[E.ju.World,E.ju.All].includes(le);ze&&(me.forEach(function(ft){ft.distance=ft.getDistanceFromListener(D.hn)}),me.sort(function(ft,_t){return ft.distance===null?1:_t.distance===null||ft.distance<_t.distance?-1:ft.distance>_t.distance?1:0})),me.forEach(function(ft){var _t=[E.UF.All,E.UF.World].includes(ft.sendMode)&&ft.distance!==null&&(D.hn.recvRange===null||ft.distance<=D.hn.recvRange);if(ze&&ce<D._maxPlayingQuantity&&_t)ft.isPlaying||ft.startPlayingAudio("play for range"),ce++;else{var mt="stop for mode or range. mode: ".concat(ft.sendMode,", range: ").concat(ft.distance," > ").concat(D.hn.recvRange);ft.stopPlayingAudio(mt)}}),this.an.info(te+" playing quantity: ".concat(ce,"."))}else this.stopPlayingAudioStream()},Ie.prototype.startCheckUserInRange=function(){this.an.info(te+" start user check"),this.updateUserTimer&&(clearTimeout(this.updateUserTimer),this.updateUserTimer=null),this.userChanged=!0,this.userCheckTask()},Ie.prototype.stopCheckUserInRange=function(){this.an.info(te+" stop user check"),this.updateUserTimer&&(clearTimeout(this.updateUserTimer),this.updateUserTimer=null)},Ie.prototype.userCheckTask=function(){var D=this;this.userChanged&&(this.userChanged=!1,this.handleUserCheckTask()),this.updateUserTimer=window.setTimeout(function(){D.userCheckTask()},this.updateUserInterval)},Ie.prototype.handleUserCheckTask=function(){var D=this;if(this.audioSourceUpdate){var me=[];this.allAudioSourceList.forEach(function(ce){ce.distance=ce.getDistanceFromListener(D.hn);var le=ce.distance!==null&&(D.hn.recvRange===null||ce.distance<=D.hn.recvRange),et=!!D.localUserList.find(function(ze){return ze.userID===ce.userID});le&&et&&me.push({userID:ce.userID,position:ce.position})}),this.checkAudioSourceListDiff(me,this.audioSourceWithinRangeList)&&this.hn.eventHandler.emit("audioSourceWithinRangeUpdate",me),this.audioSourceWithinRangeList=me}},Ie.prototype.getTeamAudioSourceGroup=function(){var D=this,me=[],ce=[];return this.audioSourceList.forEach(function(le){le.isSpeakInTeam(D.hn.teamID)?me.push(le):ce.push(le)}),{teamList:me,otherList:ce}},Ie.prototype.stopPlayingAudioStream=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.audioSourceList.forEach(function(D){D.stopPlayingAudio("stop for all stream")})},Ie.prototype.setLocalUserList=function(D){this.localUserList=D,this.userChanged=!0},Ie.prototype.checkAudioSourceListDiff=function(D,me){for(var ce,le=0;le<D.length;le++){ce=!1;for(var et=0;et<me.length;et++)if(D[le].userID===me[et].userID){ce=!0;break}if(!ce)return!0}for(var ze=0;ze<me.length;ze++){ce=!1;for(var ft=0;ft<D.length;ft++)if(me[ze].userID===D[ft].userID){ce=!0;break}if(!ce)return!0}return!1},Ie}();function it(Ie){return!isNaN(Number(Ie))&&Ie!==""&&Number.MAX_SAFE_INTEGER>=Number(Ie)&&Number(Ie)>=-Number.MAX_SAFE_INTEGER}function ee(Ie){if(Array.isArray(Ie)){for(var D=0;D<3;D++)if(!it(Ie[D]))return!1;return!0}return!1}(function(Ie){Ie[Ie.Normal=0]="Normal",Ie[Ie.Custom=1]="Custom"})(k||(k={}));var ae=function(){return ae=Object.assign||function(Ie){for(var D,me=1,ce=arguments.length;me<ce;me++)for(var le in D=arguments[me])Object.prototype.hasOwnProperty.call(D,le)&&(Ie[le]=D[le]);return Ie},ae.apply(this,arguments)},xe=function(Ie,D,me,ce){return new(me||(me=Promise))(function(le,et){function ze(mt){try{_t(ce.next(mt))}catch(Ve){et(Ve)}}function ft(mt){try{_t(ce.throw(mt))}catch(Ve){et(Ve)}}function _t(mt){var Ve;mt.done?le(mt.value):(Ve=mt.value,Ve instanceof me?Ve:new me(function(Ot){Ot(Ve)})).then(ze,ft)}_t((ce=ce.apply(Ie,D||[])).next())})},Z=function(Ie,D){var me,ce,le,et,ze={label:0,sent:function(){if(1&le[0])throw le[1];return le[1]},trys:[],ops:[]};return et={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(et[Symbol.iterator]=function(){return this}),et;function ft(_t){return function(mt){return function(Ve){if(me)throw new TypeError("Generator is already executing.");for(;et&&(et=0,Ve[0]&&(ze=0)),ze;)try{if(me=1,ce&&(le=2&Ve[0]?ce.return:Ve[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,Ve[1])).done)return le;switch(ce=0,le&&(Ve=[2&Ve[0],le.value]),Ve[0]){case 0:case 1:le=Ve;break;case 4:return ze.label++,{value:Ve[1],done:!1};case 5:ze.label++,ce=Ve[1],Ve=[0];continue;case 7:Ve=ze.ops.pop(),ze.trys.pop();continue;default:if(le=ze.trys,!((le=le.length>0&&le[le.length-1])||Ve[0]!==6&&Ve[0]!==2)){ze=0;continue}if(Ve[0]===3&&(!le||Ve[1]>le[0]&&Ve[1]<le[3])){ze.label=Ve[1];break}if(Ve[0]===6&&ze.label<le[1]){ze.label=le[1],le=Ve;break}if(le&&ze.label<le[2]){ze.label=le[2],ze.ops.push(Ve);break}le[2]&&ze.ops.pop(),ze.trys.pop();continue}Ve=D.call(Ie,ze)}catch(Ot){Ve=[6,Ot],ce=0}finally{me=le=0}if(5&Ve[0])throw Ve[1];return{value:Ve[0]?Ve[1]:void 0,done:!0}}([_t,mt])}}},$=function(Ie,D,me){if(me||arguments.length===2)for(var ce,le=0,et=D.length;le<et;le++)!ce&&le in D||(ce||(ce=Array.prototype.slice.call(D,0,le)),ce[le]=D[le]);return Ie.concat(ce||Array.prototype.slice.call(D))};function K(){var Ie;return xe(this,void 0,void 0,function(){var D,me,ce;return Z(this,function(le){switch(le.label){case 0:return(D=navigator==null?void 0:navigator.userAgentData)?[4,D.getHighEntropyValues(["platformVersion"]).catch(function(){})]:[2,{platform:"",majorPlatformVersion:0}];case 1:return me=le.sent()||{},ce=parseInt((Ie=me.platformVersion)===null||Ie===void 0?void 0:Ie.split(".")[0]),[2,{platform:me.platform,majorPlatformVersion:ce}]}})})}var X="zc.ra.0",B=function(){function Ie(D,me){var ce=this;this.an=me,this.isSpatial=!1,this.audioSourceList=[],this.audioSourceUpdate=!1,this.localUserList=[],this.speakingUserIdList=[],this.vocalSourceMap=new Map,this.volume=1,this.speaker="",this.ln=null,this.supportSpeakerSet=!1,this.isHide=!1,this.eventHandler={visibilitychange:function(){return xe(ce,void 0,void 0,function(){var le,et,ze,ft,_t,mt=this;return Z(this,function(Ve){switch(Ve.label){case 0:return $($([],this.vocalSourceList,!0),this.audioSourceList,!0).forEach(function(Ot){Ot.inBackground(w.VJ.hidden),mt.isHide=w.VJ.hidden}),le=function(){$($([],mt.vocalSourceList,!0),mt.audioSourceList,!0).forEach(function(Ot){Ot.changeRenderConfig(mt.isOpen3D(Ot),!0,!1,!1)})},w.VJ.hidden?(et=(0,W.H8)()&&(0,W.Fr)(),[4,K()]):[3,2];case 1:return ze=Ve.sent(),ft=ze.platform==="Windows"&&ze.majorPlatformVersion>=13,et||ft?(this.an.warn("".concat(X," mobile chrome hide page and stop web audio.")),le(),[2]):((_t=this.audioCtx.state)!=="running"?(this.an.info("".concat(X," hidden ctx: ").concat(_t,", resume ctx")),this.audioCtx.resume(),setTimeout(function(){var Ot=mt.audioCtx.state;mt.isHide&&(Ot==="running"?mt.an.info("".concat(X," hidden ctx: ").concat(Ot,".")):(mt.an.warn("".concat(X," hidden ctx: ").concat(Ot,", ctx resume failed. stop web audio.")),le()))},2e3)):this.an.info("".concat(X," hidden ctx: ").concat(_t,".")),[3,3]);case 2:this.audioCtx.resume(),this.audioSourceList.forEach(function(Ot){var rn,an;Ot.isPlaying&&((rn=Ot.audioEl)===null||rn===void 0||rn.dom.pause(),(an=Ot.audioEl)===null||an===void 0||an.dom.play().catch(function(){mt.an.warn("".concat(X," show page and  ").concat(Ot.userID," replay failed."))}))}),Ve.label=3;case 3:return[2]}})})}},this.zegoRTC=D,w.VJ.addEventListener("visibilitychange",this.eventHandler.visibilitychange,!1),this.zegoRTC.on("roomStreamUpdate",function(le,et,ze){var ft=ze.map(function(mt){var Ve=ce.getStreamInfo(mt.extraInfo,mt.streamID),Ot=Ve.isRangeAudioStream,rn=Ve.teamID,an=Ve.raMode,In=Ve.sendMode;return ae(ae({},mt),{isRangeAudioStream:Ot,teamID:rn,raMode:an,sendMode:In})}).filter(function(mt){return mt.isRangeAudioStream}),_t=ft.map(function(mt){return mt.user.userID});et==="DELETE"?ce.speakingUserIdList=ce.speakingUserIdList.filter(function(mt){var Ve=!_t.includes(mt);if(!Ve){var Ot=ce.audioSourceMap[mt];Ot&&Ot.stopPlayingAudio("stop for stream delete")}return Ve}):et==="ADD"&&(ce.speakingUserIdList=ce.speakingUserIdList.concat(_t),ft.forEach(function(mt){var Ve=mt.user.userID,Ot=ce.audioSourceMap[Ve],rn=mt.teamID,an=mt.raMode,In=mt.sendMode;if(Ot)Ot.streamID!==mt.streamID&&(Ot.stopPlayingAudio("stop for old stream"),Ot.streamID=mt.streamID),an!==void 0&&(Ot.raMode=an),rn!==Ot.teamID&&(Ot.teamID=rn),Ot.changeRenderConfig(ce.isOpen3D(Ot));else{var Tn=new _(ce.an,{userID:Ve,teamID:rn,raMode:an,sendMode:In},{audioCtx:ce.audioCtx,zegoRTC:ce.zegoRTC,isSpatial:ce.isSpatial,maxDistance:ce.hn.recvRange,volume:ce.volume,speaker:ce.speaker,isHide:ce.isHide});Tn.streamID=mt.streamID,ce.audioSourceList.push(Tn),ce.playStreamHandler.hasChanged=!0}})),ce.playStreamHandler.setAudioSourceList(ce.speakingAudioSourceList)}),this.zegoRTC.on("playerStateUpdate",function(le){var et=ce.audioSourceList.find(function(ze){return ze.streamID===le.streamID});et&&(le.state==="NO_PLAY"?et.isPlaying=!1:(le.state==="PLAYING"&&et.checkTrackChanged(),et.isPlaying=!0))}),this.zegoRTC.on("streamExtraInfoUpdate",function(le,et){ce.an.info(X+" recv extra info: "+JSON.stringify(et));var ze=!1;et.forEach(function(ft){var _t=ce.audioSourceMap[ft.user.userID];if(_t&&_t.streamID){var mt=ce.getStreamInfo(ft.extraInfo,ft.streamID),Ve=mt.teamID,Ot=mt.raMode,rn=mt.sendMode;Ve!==_t.teamID&&(_t.teamID=Ve,ze=!0),Ot!==void 0&&(_t.raMode=Ot,ze=!0),_t.sendMode!==rn&&(_t.sendMode=rn,ze=!0),ce.playStreamHandler.hasChanged=!0}}),ze&&ce.enableSpatializer(ce.isSpatial)}),this.zegoRTC.RTM._on("_roomStateUpdate",function(le,et){et==="CONNECTED"?(ce.roomID=le,ce.hn.userID=ce.zegoRTC.RTM.getUserID(),ce.playStreamHandler.hasChanged=!0,ce.playStreamHandler.userChanged=!0):et==="DISCONNECTED"&&(ce.roomID=void 0,ce.hn.reset(),ce.enableSpeaker(!1),ce.audioSourceList=[],ce.playStreamHandler.setAudioSourceList([]),ce.localUserList=[],ce.playStreamHandler.setLocalUserList([]))}),this.zegoRTC.RTM.on("roomUserUpdate",function(le,et,ze){var ft;ce.an.info(X+" roomUserUpdate: "+le+et+JSON.stringify(ze)),et==="ADD"?(ft=ce.localUserList).push.apply(ft,ze):et==="DELETE"&&ze.forEach(function(_t){ce.localUserList=ce.localUserList.filter(function(mt){return mt.userID!==_t.userID})}),ce.playStreamHandler.setLocalUserList(ce.localUserList)}),this.zegoRTC.on("publishQualityUpdate",function(le,et){var ze=le.match(/(.*)_(.*)/);if((ze==null?void 0:ze.length)===3){var ft=ze[1];if(ce.hn.userID!==ft)return;var _t=ae({},et.audio);ce.eventManager.emit("publishQualityUpdate",ft,_t)}}),this.zegoRTC.on("playQualityUpdate",function(le,et){var ze,ft=le.match(/(.*)_(.*)/);if((ft==null?void 0:ft.length)===3){var _t=ft[1],mt=et.audio,Ve=et.peerToPeerDelay,Ot=et.peerToPeerPacketLostRate;if(!(!((ze=ce.audioSourceList)===null||ze===void 0)&&ze.some(function(an){return an.userID===_t})))return;var rn=ae(ae({},mt),{peerToPeerDelay:Ve,peerToPeerPacketLostRate:Ot});ce.eventManager.emit("playQualityUpdate",_t,rn)}}),this.ln=this.dn(),this.hn=R.getInstance(this.audioCtx,this.zegoRTC),this.playStreamHandler=Ue.getInstance(this.an,this.hn),this.eventManager=be.getInstance()}return Object.defineProperty(Ie.prototype,"audioSourceMap",{get:function(){return this.audioSourceList.reduce(function(D,me){return me.userID&&(D[me.userID]=me),D},{})},enumerable:!1,configurable:!0}),Object.defineProperty(Ie.prototype,"speakingAudioSourceList",{get:function(){var D=this;return this.audioSourceList.filter(function(me){return D.speakingUserIdList.includes(me.userID)})},enumerable:!1,configurable:!0}),Object.defineProperty(Ie.prototype,"vocalSourceList",{get:function(){for(var D=[],me=this.vocalSourceMap.values(),ce=0;ce<this.vocalSourceMap.size;ce++)D.push(me.next().value);return D},enumerable:!1,configurable:!0}),Object.defineProperty(Ie.prototype,"playingAudioSourceList",{get:function(){return this.audioSourceList.filter(function(D){return D.isPlaying})},enumerable:!1,configurable:!0}),Ie.prototype.dn=function(){var D=this,me=new(window.AudioContext||window.webkitAudioContext);return me.addEventListener("statechange",function(){me.state==="suspended"&&(D.an.info(X+" audio context suspended"),me.resume())}),me},Object.defineProperty(Ie.prototype,"audioCtx",{get:function(){return this.ln||(this.ln=this.dn()),this.ln},enumerable:!1,configurable:!0}),Ie.getInstance=function(D,me){return Ie.instance||(Ie.instance=new Ie(D,me)),Ie.instance},Ie.prototype.resumeAudioContext=function(){return xe(this,void 0,void 0,function(){var D=this;return Z(this,function(me){return[2,new w.l3(function(ce){Re.generateEls(),D.audioCtx.state==="running"&&ce(!0),D.audioCtx.onstatechange=function(){D.audioCtx.state==="running"&&ce(!0)},D.audioCtx.resume(),D.an.info(X+" resume audio ctx"),setTimeout(function(){ce(!1)},3e3)})]})})},Ie.prototype.getAudioContextState=function(){return this.audioCtx.state},Ie.prototype.getStreamInfo=function(D,me){var ce=void 0,le=null;try{le=JSON.parse(D)}catch{return this.an.warn(X+" parse room extra info failed. ".concat(me," is not ra stream.")),{isRangeAudioStream:!1}}if(!le.hasOwnProperty("range_audio_team_id")||!le.hasOwnProperty("range_audio_mode"))return this.an.warn(X+" extra info has no mode. ".concat(me," is not ra stream.")),{isRangeAudioStream:!1};ce={1:0,2:1,3:2}[le.range_audio_mode];var et=le.r_a_s_flag,ze={teamID:le.range_audio_team_id||void 0,raMode:ce,isRangeAudioStream:et===void 0||et===1};return le.hasOwnProperty("r_a_speak")&&(ze.sendMode=le.r_a_speak),this.an.info("".concat(X," ").concat(me," parse extra info: ").concat(JSON.stringify(ze),".")),ze},Ie.prototype.setAudioReceiveRange=function(D){if(!it(D))throw Error("Failed to execute 'setAudioReceiveRange': Argument 'range' requires to be type number.");if(D=Number(D),(D=Number(D))<0)throw Error("Failed to execute 'setAudioReceiveRange': Argument 'range' can not be less than 0.");this.an.info(X+" set receive range: "+D),this.hn.recvRange=D,this.audioSourceList.forEach(function(me){me.setMaxDistance(D)}),this.playStreamHandler.hasChanged=!0,this.playStreamHandler.userChanged=!0},Ie.prototype.updateSelfPosition=function(D,me,ce,le){var et=this,ze=function(ft){return"Failed to execute 'updateSelfPosition': Argument '".concat(ft,`' requires an array of type number."`)};if(!ee(D))throw new Error(ze("position"));if(!ee(me))throw new Error(ze("axisForward"));if(!ee(ce))throw new Error(ze("axisRight"));if(!ee(le))throw new Error(ze("axisUp"));this.an.info(X+" set self position [".concat(D,"]")),this.hn&&(this.hn.updateSelfPosition(D,me,le),this.vocalSourceMap.forEach(function(ft){ft.checkIfCanPlay(et.hn)})),this.playStreamHandler.setListener(this.hn)},Ie.prototype.updateAudioSource=function(D,me){if(D=String(D),!ee(me))throw new Error("Failed to execute 'updateAudioSource': parameter 'position' must be an array of type number.");var ce=this.audioSourceMap[D];ce?ce.setPosition(me):(ce=new _(this.an,{userID:D,position:me},{audioCtx:this.audioCtx,zegoRTC:this.zegoRTC,isSpatial:this.isSpatial,maxDistance:this.hn.recvRange,volume:this.volume,speaker:this.speaker,isHide:this.isHide}),this.enableSpatializer(this.isSpatial),this.audioSourceList.push(ce)),this.playStreamHandler.setAudioSourceList(this.speakingAudioSourceList),this.playStreamHandler.setAllAudioSourceList(this.audioSourceList)},Ie.prototype.enableMicrophone=function(D){if(D===void 0&&(D=!0),!this.hn.userID)throw new Error("Enable mic failed. Please log in room first.");return D?this.hn.startPublishingStream():this.hn.stopPublishingStream()},Ie.prototype.selectMic=function(D){return xe(this,void 0,void 0,function(){var me,ce,le,et;return Z(this,function(ze){switch(ze.label){case 0:if(!(0,Ne.QP)(D)&&!(0,Ne.TE)(D))throw new Error("Select mic failed. DeviceID error.");if(ce=(me=this.hn).audioStream,le=me.isPublishing,this.an.info(X+" select mic: "+D),!ce||!le)return[3,5];et={errorCode:0},ze.label=1;case 1:return ze.trys.push([1,3,,4]),[4,this.zegoRTC.useAudioDevice(ce,D||"")];case 2:return et=ze.sent(),[3,4];case 3:return ze.sent(),[2,!1];case 4:return et.errorCode===0?(this.hn.micID=D,[2,!0]):[2,!1];case 5:return this.hn.micID=D,[2,!0];case 6:return[2]}})})},Ie.prototype.enableSpeaker=function(D){if(D===void 0&&(D=!0),D&&!this.roomID)throw new Error("Enable speaker failed. Please log in room first.");this.playStreamHandler.isEnable=D,this.an.info(X+" enable speaker: "+D),D?(Re.generateEls(),this.playStreamHandler.startPlayingAudioStream()):this.playStreamHandler.stopPlayingAudioStream()},Ie.prototype.enableSpatializer=function(D){var me=this;D===void 0&&(D=!0),this.an.info(X+" set spatializer: "+D),this.isSpatial=!!D,this.audioSourceList.forEach(function(ce){ce.changeRenderConfig(me.isOpen3D(ce))}),this.vocalSourceList.forEach(function(ce){ce.changeRenderConfig(D)}),D&&this.hn.updateListenerEffect()},Ie.prototype.enableAiDenoise=function(D){if(this.an.info(X+" set ai denoise: "+D),!(0,Ne.dd)(D))return!1;var me=(0,W.Fr)();return(me||window.AudioWorklet)&&window.WebAssembly&&(window.AudioContext||(window==null?void 0:window.webkitAudioContext)).prototype.createScriptProcessor?this.hn.enableDenoise(!!D):(this.an.error(X+"".concat(me&&" mobile"," browser dose not support ai denoise.")),!1)},Ie.prototype.setAiDenoiseMode=function(D){return D===void 0&&(D=ue.PP.AI),this.hn.setAiDenoiseMode(D)},Ie.prototype.setVoiceChangerPreset=function(D){this.an.info(X+" set voice changer preset: "+JSON.stringify(D));var me=(0,W.Fr)();return(me||window.AudioWorklet)&&window.WebAssembly&&(window.AudioContext||(window==null?void 0:window.webkitAudioContext)).prototype.createScriptProcessor?this.hn.setVoiceChangerPreset(D):(this.an.error(X+"".concat(me&&" mobile"," browser dose not support voice changer.")),!1)},Ie.prototype.setRangeAudioTeamID=function(D){this.an.info(X+" set team id: "+D),this.hn.setTeamID(D),this.enableSpatializer(this.isSpatial),this.playStreamHandler.hasChanged=!0},Ie.prototype.setRangeAudioMode=function(D){if(this.modeType===k.Custom)throw new Error("Failed to execute 'setRangeAudioMode': already use 'setRangeAudioCustomMode'.");this.modeType=k.Normal,this.an.info(X+" set mode "+D),this.hn.setNormalMode(D),this.playStreamHandler.hasChanged=!0},Ie.prototype.setCustomMode=function(D,me){if(this.modeType===k.Normal)throw new Error("Failed to execute 'setRangeAudioCustomMode': already use 'setRangeAudioMode'.");this.modeType=k.Custom,this.an.info(X+" set custom mode: ".concat(D,", ").concat(me));var ce=this.hn.setCustomMode(D,me).recvChange;this.playStreamHandler.hasChanged=!0,ce&&this.enableSpatializer(this.isSpatial)},Ie.prototype.setAudioVolume=function(D){var me=this;if(this.an.info(X+" set volume ".concat(D)),D<0)throw new Error("Failed to execute 'setVolume': The volume provided is outside the range [0, 200].");this.volume=D/100,this.audioSourceList.forEach(function(ce){ce.setVolume(me.volume)})},Ie.prototype.selectSpeaker=function(D){var me=this;if(D===void 0&&(D=""),!(0,Ne.QP)(D))throw new Error("Select speaker failed. Device ID error.");if(!this.supportSpeakerSet){if(!w.VJ.createElement("audio").setSinkId)throw new Error("Failed to execute 'selectSpeaker': browser not support.");this.supportSpeakerSet=!0}this.speaker=D,this.an.info(X+" set speaker: "+D),D===""&&this.an.warn(X+" set speaker to be default. "),this.audioSourceList.find(function(ce){return xe(me,void 0,void 0,function(){var le;return Z(this,function(et){switch(et.label){case 0:return et.trys.push([0,2,,3]),[4,ce.setSpeaker(D)];case 1:return et.sent(),[3,3];case 2:return le=et.sent(),this.an.warn(X+" set speaker failed. id: ".concat(D,", error: ").concat(le)),[2,!0];case 3:return[2,!1]}})})})},Ie.prototype.setPositionUpdateFrequency=function(D){if(!(D>=15))throw new Error("Failed to execute 'setPositionUpdateFrequency': The frequency provided is outside the range [15, +].");this.playStreamHandler.interval=Number(D)||100,this.an.info(X+" set interval: "+D)},Ie.prototype.on=function(D,me){return this.eventManager.addEventHandler(D,me)},Ie.prototype.off=function(D,me){return this.eventManager.removeEventHandler(D,me)},Ie.prototype.enableAudioSourceUpdateChecker=function(D,me){if(this.an.info(X+" set source update: "+D),this.audioSourceUpdate=D,this.playStreamHandler.setAudioSourceUpdate(D),me&&(0,Ne.Cs)(me.frequency)){if(me.frequency<50)throw new Error("Failed to execute 'enableAudioSourceUpdateChecker': The frequency provided is outside the range [50, +].");this.playStreamHandler.updateUserInterval=Number(me.frequency)||1e3,this.an.info(X+" set interval: "+me.frequency)}D?this.playStreamHandler.startCheckUserInRange():this.playStreamHandler.stopCheckUserInRange()},Ie.prototype.getVocalSource=function(D,me){var ce=this.vocalSourceMap.get(D);if(!ce){var le={audioCtx:this.audioCtx,isSpatial:this.isSpatial,maxDistance:me||0,volume:this.volume,speaker:this.speaker,isHide:this.isHide};ce=(0,Ne.Si)(D)?new L(this.an,{media:D},le):new Se(this.an,{streamView:D},le)}return this.vocalSourceMap.set(D,ce),ce},Ie.prototype.setStreamVocalRange=function(D,me){var ce=(0,Ne.Si)(D);if(!ce&&!(D!=null&&D.v))throw new Error("Failed to execute 'setVocalRange': type of parameter 1 error.");if(!it(me))throw Error("Failed to execute 'setVocalRange': parameter 2 requires to be type number.");me=Number(me),this.an.info(X+" ".concat(ce?"custom":"stream"," set range: ")+me);var le=this.getVocalSource(D,me);le.setMaxDistance(me),le.checkIfCanPlay(this.hn)},Ie.prototype.updateStreamPosition=function(D,me){if(!(0,Ne.Si)(D)&&!(D!=null&&D.v))throw new Error("Failed to execute 'updatePosition': type of parameter 1 error.");if(!ee(me))throw new Error("Failed to execute 'updatePosition': parameter 'position' must be an array of type number.");var ce=this.getVocalSource(D);ce.setPosition(me),ce.checkIfCanPlay(this.hn)},Ie.prototype.isOpen3D=function(D){return D instanceof _?(this.hn.recvMode===E.ju.World||!D.isSpeakInTeam(this.hn.teamID))&&this.isSpatial:this.isSpatial},Ie}(),fe=function(Ie,D,me,ce){return new(me||(me=Promise))(function(le,et){function ze(mt){try{_t(ce.next(mt))}catch(Ve){et(Ve)}}function ft(mt){try{_t(ce.throw(mt))}catch(Ve){et(Ve)}}function _t(mt){var Ve;mt.done?le(mt.value):(Ve=mt.value,Ve instanceof me?Ve:new me(function(Ot){Ot(Ve)})).then(ze,ft)}_t((ce=ce.apply(Ie,D||[])).next())})},Ce=function(Ie,D){var me,ce,le,et,ze={label:0,sent:function(){if(1&le[0])throw le[1];return le[1]},trys:[],ops:[]};return et={next:ft(0),throw:ft(1),return:ft(2)},typeof Symbol=="function"&&(et[Symbol.iterator]=function(){return this}),et;function ft(_t){return function(mt){return function(Ve){if(me)throw new TypeError("Generator is already executing.");for(;et&&(et=0,Ve[0]&&(ze=0)),ze;)try{if(me=1,ce&&(le=2&Ve[0]?ce.return:Ve[0]?ce.throw||((le=ce.return)&&le.call(ce),0):ce.next)&&!(le=le.call(ce,Ve[1])).done)return le;switch(ce=0,le&&(Ve=[2&Ve[0],le.value]),Ve[0]){case 0:case 1:le=Ve;break;case 4:return ze.label++,{value:Ve[1],done:!1};case 5:ze.label++,ce=Ve[1],Ve=[0];continue;case 7:Ve=ze.ops.pop(),ze.trys.pop();continue;default:if(le=ze.trys,!((le=le.length>0&&le[le.length-1])||Ve[0]!==6&&Ve[0]!==2)){ze=0;continue}if(Ve[0]===3&&(!le||Ve[1]>le[0]&&Ve[1]<le[3])){ze.label=Ve[1];break}if(Ve[0]===6&&ze.label<le[1]){ze.label=le[1],le=Ve;break}if(le&&ze.label<le[2]){ze.label=le[2],ze.ops.push(Ve);break}le[2]&&ze.ops.pop(),ze.trys.pop();continue}Ve=D.call(Ie,ze)}catch(Ot){Ve=[6,Ot],ce=0}finally{me=le=0}if(5&Ve[0])throw Ve[1];return{value:Ve[0]?Ve[1]:void 0,done:!0}}([_t,mt])}}},Ze=function(){function Ie(D,me){this.vn=B.getInstance(D,me)}return Ie.getInstance=function(D,me){if(!Ie.instance){if(!D)throw Error("create instance failed.");Ie.instance=new Ie(D,me)}return Ie.instance},Ie.prototype.enableAiDenoise=function(D){return this.vn.enableAiDenoise(D)},Ie.prototype.setAiDenoiseMode=function(D){return this.vn.setAiDenoiseMode(D)},Ie.prototype.enableAudioSourceUpdateChecker=function(D,me){this.vn.enableAudioSourceUpdateChecker(D,me)},Ie.prototype.on=function(D,me){return this.vn.on(D,me)},Ie.prototype.off=function(D,me){return this.vn.off(D,me)},Ie.prototype.setAudioReceiveRange=function(D){this.vn.setAudioReceiveRange(D)},Ie.prototype.updateSelfPosition=function(D,me,ce,le){this.vn.updateSelfPosition(D,me,ce,le)},Ie.prototype.updateAudioSource=function(D,me){this.vn.updateAudioSource(D,me)},Ie.prototype.enableSpatializer=function(D){return this.vn.enableSpatializer(D)},Ie.prototype.enableMicrophone=function(D){return this.vn.enableMicrophone(D)},Ie.prototype.selectMicrophone=function(D){return fe(this,void 0,void 0,function(){return Ce(this,function(me){switch(me.label){case 0:return[4,this.vn.selectMic(D)];case 1:return[2,me.sent()]}})})},Ie.prototype.selectSpeaker=function(D){return this.vn.selectSpeaker(D)},Ie.prototype.enableSpeaker=function(D){return this.vn.enableSpeaker(D)},Ie.prototype.setRangeAudioCustomMode=function(D,me){this.vn.setCustomMode(D,me)},Ie.prototype.setRangeAudioMode=function(D){this.vn.setRangeAudioMode(D)},Ie.prototype.setTeamID=function(D){this.vn.setRangeAudioTeamID(D)},Ie.prototype.setPositionUpdateFrequency=function(D){return this.vn.setPositionUpdateFrequency(D)},Ie.prototype.setRangeAudioVolume=function(D){return this.vn.setAudioVolume(D)},Ie.prototype.setVoiceChangerPreset=function(D){return this.vn.setVoiceChangerPreset({voiceChanger:D})},Ie.prototype.setVoiceChangerParam=function(D){return this.vn.setVoiceChangerPreset({voiceParam:D})},Ie.prototype.isAudioContextRunning=function(){return this.vn.getAudioContextState()==="running"},Ie.prototype.resumeAudioContext=function(){return this.vn.resumeAudioContext()},Ie.prototype.setStreamVocalRange=function(D,me){this.vn.setStreamVocalRange(D,me)},Ie.prototype.updateStreamPosition=function(D,me){this.vn.updateStreamPosition(D,me)},Ie.prototype.setCustomSourceVocalRange=function(D,me){this.vn.setStreamVocalRange(D,me)},Ie.prototype.updateCustomSourcePosition=function(D,me){this.vn.updateStreamPosition(D,me)},Ie}(),st={type:"RangeAudio",install:function(Ie){Object.defineProperty(Ie.prototype,"createRangeAudioInstance",{value:function(){return this.rangeAudio||(this.rangeAudio=Ze.getInstance(this,this.logger)),this.rangeAudio},writable:!1})}}},754:function(It,Ye,Te){var E;It.exports=(E=Te(9021),function(){var w=E.lib.WordArray;function Re(we,he,Me){for(var nt=[],Ne=0,W=0;W<he;W++)if(W%4){var Q=Me[we.charCodeAt(W-1)]<<W%4*2,se=Me[we.charCodeAt(W)]>>>6-W%4*2;nt[Ne>>>2]|=(Q|se)<<24-Ne%4*8,Ne++}return w.create(nt,Ne)}E.enc.Base64={stringify:function(we){var he=we.words,Me=we.sigBytes,nt=this._map;we.clamp();for(var Ne=[],W=0;W<Me;W+=3)for(var Q=(he[W>>>2]>>>24-W%4*8&255)<<16|(he[W+1>>>2]>>>24-(W+1)%4*8&255)<<8|he[W+2>>>2]>>>24-(W+2)%4*8&255,se=0;se<4&&W+.75*se<Me;se++)Ne.push(nt.charAt(Q>>>6*(3-se)&63));var J=nt.charAt(64);if(J)for(;Ne.length%4;)Ne.push(J);return Ne.join("")},parse:function(we){var he=we.length,Me=this._map,nt=this._reverseMap;if(!nt){nt=this._reverseMap=[];for(var Ne=0;Ne<Me.length;Ne++)nt[Me.charCodeAt(Ne)]=Ne}var W=Me.charAt(64);if(W){var Q=we.indexOf(W);Q!==-1&&(he=Q)}return Re(we,he,nt)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),E.enc.Base64)},757:function(It,Ye,Te){It.exports=function(E,w,Re,we){return Me=[function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.LinkedList=W.ListNode=W.ENUM_NETWORK_STATE=W.SOCKET_DISCONNECT=W.errorList=W.Queue=W.getSeq=W.E_CLIENT_TYPE=W.ENUM_LOG_LEVEL=W.ZEGO_BROWSER_TYPE=W.ZEGO_ENV=W.PROTO_VERSION=void 0,W.PROTO_VERSION="1.0.8",(J=W.ZEGO_ENV||(W.ZEGO_ENV={}))[J.BROWSER=0]="BROWSER",J[J.WEIXINMINI=1]="WEIXINMINI",(J=W.ZEGO_BROWSER_TYPE||(W.ZEGO_BROWSER_TYPE={}))[J.IE=0]="IE",J[J.FIREFOX=1]="FIREFOX",J[J.CHROME=2]="CHROME",J[J.SAFARI=3]="SAFARI",J[J.OPERA=4]="OPERA",J[J.WEIXIN=5]="WEIXIN",J[J.WEIXINMINI=6]="WEIXINMINI",J[J.UNKOWN=7]="UNKOWN",W.ENUM_LOG_LEVEL={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},(J=W.E_CLIENT_TYPE||(W.E_CLIENT_TYPE={}))[J.ClientType_None=0]="ClientType_None",J[J.ClientType_H5=1]="ClientType_H5",J[J.ClientType_SmallPragram=2]="ClientType_SmallPragram",J[J.ClientType_Webrtc=3]="ClientType_Webrtc",W.getSeq=(se=1,function(){return se++}),G.prototype.isEmpty=function(){return this.items.length==0},G.prototype.enqueue=function(v){this.items.push(v)},G.prototype.dequeue=function(){return this.isEmpty()?"Underflow":this.items.shift()},G.prototype.front=function(){return this.isEmpty()?"No elements in Queue":this.items[0]},G.prototype.size=function(){return this.items.length},G.prototype.clear=function(){this.items=[]},G.prototype.all=function(){return this.items};var se,J=G;function G(){this.items=[],this.items=[]}W.Queue=J,W.errorList={TIMEOUT:{code:100001,msg:"network timeout"},DATAEXIST:{code:100002,msg:"data exist"},BROKEN:{code:100003,msg:"network broken"}},W.SOCKET_DISCONNECT=-1,(J=W.ENUM_NETWORK_STATE||(W.ENUM_NETWORK_STATE={}))[J.offline=0]="offline",J[J.online=1]="online",Object.defineProperty(C.prototype,"id",{get:function(){return this.h||null},set:function(v){this.h=v},enumerable:!1,configurable:!0}),Object.defineProperty(C.prototype,"data",{get:function(){return this.v},set:function(v){this.v=v},enumerable:!1,configurable:!0}),C.prototype.hasNext=function(){return this.next&&this.next.id},C.prototype.hasPrev=function(){return this.prev&&this.prev.id};var U=C;function C(v,f){v===void 0&&(v=null),f===void 0&&(f=null),this.next=null,this.prev=null,this.h=v,this.v=f}function N(){this.start=new U,this.end=new U,this.g=0,this.O=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}W.ListNode=U,N.prototype.insertBefore=function(v,f){return(f=new U(this.g,f)).next=v,f.prev=v.prev,v.prev&&(v.prev.next=f),v.prev=f,++this.g,++this.O,f},N.prototype.addLast=function(v){return this.insertBefore(this.end,v)},N.prototype.add=function(v){return this.addLast(v)},N.prototype.getFirst=function(){return this.O===0?null:this.start.next},N.prototype.getLast=function(){return this.O===0?null:this.end.prev},N.prototype.size=function(){return this.O},N.prototype.getFromFirst=function(v){var f=0,_=this.start.next;if(0<=v)for(;f<v&&_!==null;)_=_.next,++f;else _=null;if(_===null)throw"Index out of bounds.";return _},N.prototype.get=function(v){return v===0?this.getFirst():v===this.O-1?this.getLast():this.getFromFirst(v)},N.prototype.remove=function(v){return v.prev&&(v.prev.next=v.next),v.next&&(v.next.prev=v.prev),--this.O,v},N.prototype.removeFirst=function(){return 0<this.O&&this.start.next?this.remove(this.start.next):null},N.prototype.removeLast=function(){return 0<this.O&&this.end.prev?this.remove(this.end.prev):null},N.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this.O=0,this.g=0},N.prototype.each=function(v){for(var f=this.start;f.hasNext();)v(f=f.next)},N.prototype.find=function(v){for(var f=this.start,_=!1,b=null;f.hasNext()&&!_;)v(f=f.next)&&(b=f,_=!0);return b},N.prototype.map=function(v){for(var f=this.start,_=[];f.hasNext();)v(f=f.next)&&_.push(f);return _},N.prototype.push=function(v){return this.addLast(v)},N.prototype.unshift=function(v){this.insertBefore(0<this.O?this.start.next:this.end,v)},N.prototype.pop=function(){return this.removeLast()},N.prototype.shift=function(){return this.removeFirst()},W.LinkedList=N},function(Ne,W,Q){var se=this&&this.__read||function(_,b){var y=typeof Symbol=="function"&&_[Symbol.iterator];if(!y)return _;var M,Y,L=y.call(_),A=[];try{for(;(b===void 0||0<b--)&&!(M=L.next()).done;)A.push(M.value)}catch(H){Y={error:H}}finally{try{M&&!M.done&&(y=L.return)&&y.call(L)}finally{if(Y)throw Y.error}}return A},J=this&&this.__spread||function(){for(var _=[],b=0;b<arguments.length;b++)_=_.concat(se(arguments[b]));return _},G=(Object.defineProperty(W,"u",{value:!0}),W.ContextAPI=W.suppressInstrumentation=W.ROOT_CONTEXT=W.BaseContext=W.setSpan=W.getSpanContext=W.getSpan=W.createContextKey=void 0,Q(17));function U(_){return Symbol.for(_)}var C=(W.createContextKey=U)("OpenTelemetry Context Key SUPPRESS_INSTRUMENTATION"),N=U("OpenTelemetry Context Key SPAN");function v(_){return _.getValue(N)||void 0}function f(_){this._=_,this.S=new G.StackContextManager}W.getSpan=v,W.getSpanContext=function(_){return(_=v(_))==null?void 0:_.context()},W.setSpan=function(_,b){return _.setValue(N,b)},W.BaseContext=Q=function _(b){var y=this;y.M=b?new Map(b):new Map,y.getValue=function(M){return y.M.get(M)},y.setValue=function(M,Y){var L=new _(y.M);return L.M.set(M,Y),L},y.deleteValue=function(M){var Y=new _(y.M);return Y.M.delete(M),Y}},W.ROOT_CONTEXT=new Q,W.suppressInstrumentation=function(_){return _.setValue(C,!0)},f.getInstance=function(_){return _===void 0&&(_="context"),this.j||(this.j=new f(_)),this.j},f.prototype.active=function(){return this.S.active()},f.prototype.with=function(_,b,y){for(var M,Y=[],L=3;L<arguments.length;L++)Y[L-3]=arguments[L];return(M=this.T()).with.apply(M,J([_,b,y],Y))},f.prototype.T=function(){return this.S},W.ContextAPI=f},function(Ne,W,Q){var se,J;Object.defineProperty(W,"u",{value:!0}),W.INVALID_SPAN_CONTEXT=W.INVALID_TRACEID=W.INVALID_SPANID=W.TraceFlags=W.SpanKind=W.SpanStatusCode=void 0,(se=W.SpanStatusCode||(W.SpanStatusCode={}))[se.UNSET=0]="UNSET",se[se.OK=1]="OK",se[se.ERROR=2]="ERROR",(se=W.SpanKind||(W.SpanKind={}))[se.INTERNAL=0]="INTERNAL",se[se.SERVER=1]="SERVER",se[se.CLIENT=2]="CLIENT",se[se.PRODUCER=3]="PRODUCER",se[se.CONSUMER=4]="CONSUMER",(J=se=W.TraceFlags||(W.TraceFlags={}))[J.NONE=0]="NONE",J[J.SAMPLED=1]="SAMPLED",W.INVALID_SPANID="0000000000000000",W.INVALID_TRACEID="00000000000000000000000000000000",W.INVALID_SPAN_CONTEXT={traceId:W.INVALID_TRACEID,spanId:W.INVALID_SPANID,traceFlags:se.NONE}},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.log=W.ZegoLog=void 0,J.prototype.log=function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];var C=G.join("");console.log(C)},J.prototype.debug=function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];var C=G.join("");console.debug(C)},J.prototype.info=function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];var C=G.join("");console.info(C)},J.prototype.warn=function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];var C=G.join("");console.warn(C)},J.prototype.error=function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];var C=G.join("");console.error(C)};var se=J;function J(){}se=new(W.ZegoLog=se),W.log=se},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.FAIL_TIME=W.FAIL_MAX_COUNT=W.FAIL_COUNT=W.STORE_SIZE=W.CACHE_SIZE=W.BUCKET_CONFIG=W.DEFAULT_CONFIG=void 0,W.DEFAULT_CONFIG={importantLevel:0,reportSize:3e3,reportNum:10,bps:16e3,netTimeout:10},W.BUCKET_CONFIG={bucketSize:1e4,tokensPerInterval:1600},W.CACHE_SIZE={totalAvailCache:102400,cacheMaxSize:2e4,cacheDelPer:.2},W.STORE_SIZE={totalDBSize:2048e3,storeDelPer:.2},W.FAIL_COUNT=5,W.FAIL_MAX_COUNT=10,W.FAIL_TIME=30},function(Ne,W,Q){var se=this&&this.__importDefault||function(C){return C&&C.u?C:{default:C}},J=(Object.defineProperty(W,"u",{value:!0}),W.uuid=W.calculateMemSize=W.analyzeKey=W.getCurrentTime=W.getCurrentEnv=W.getBrowser=void 0,Q(0)),G=se(Q(31)),U=(W.getBrowser=function(){var C=window.navigator.userAgent,N=window.ActiveXObject!=null&&C.indexOf("MSIE")!=-1,v=C.indexOf("Firefox")!=-1,f=window.opr!=null,_=C.indexOf("Chrome")&&window.chrome,b=C.indexOf("Safari")!=-1&&C.indexOf("Version")!=-1;return C=C.toLowerCase().match(/MicroMessenger/i)&&C.toLowerCase().match(/MicroMessenger/i)[0]==="micromessenger",N?J.ZEGO_BROWSER_TYPE.IE:v?J.ZEGO_BROWSER_TYPE.FIREFOX:f?J.ZEGO_BROWSER_TYPE.OPERA:_?J.ZEGO_BROWSER_TYPE.CHROME:b?J.ZEGO_BROWSER_TYPE.SAFARI:C?J.ZEGO_BROWSER_TYPE.WEIXIN:J.ZEGO_BROWSER_TYPE.UNKOWN},W.getCurrentEnv=function(){var C=window.navigator.userAgent;return new Promise(function(N){C.indexOf("MicroMessage")==-1?N(J.ZEGO_ENV.BROWSER):wx.miniProgram.getEnv(function(v){})})},["00","01","02","03","04","05","06","07","08","09"]);W.getCurrentTime=function(){var C=new Date;return[C.getFullYear()+"/",(U[C.getMonth()+1]||C.getMonth()+1)+"/",(U[C.getDate()]||C.getDate())+" ",(U[C.getHours()]||C.getHours())+":",(U[C.getMinutes()]||C.getMinutes())+":",U[C.getSeconds()]||C.getSeconds(),"."+C.getTime()%1e3].join("")},W.analyzeKey=function(C){return C=C.split("_"),{level:Number(C[0]),timestamp:C[1],seq:C[2]}},W.calculateMemSize=function(C){return G.default(C)},W.uuid=function(C,N){var v,f,_="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=[];if(N=N||_.length,C)for(v=0;v<C;v++)b[v]=_[0|Math.random()*N];else for(b[8]=b[13]=b[18]=b[23]="-",b[14]="4",v=0;v<36;v++)b[v]||(f=0|16*Math.random(),b[v]=_[v==19?3&f|8:f]);return b.join("")}},function(Ne,W,Q){var se=this&&this.__values||function(U){var C=typeof Symbol=="function"&&Symbol.iterator,N=C&&U[C],v=0;if(N)return N.call(U);if(U&&typeof U.length=="number")return{next:function(){return{value:(U=U&&v>=U.length?void 0:U)&&U[v++],done:!U}}};throw new TypeError(C?"Object is not iterable.":"Symbol.iterator is not defined.")},J=this&&this.__read||function(U,C){var N=typeof Symbol=="function"&&U[Symbol.iterator];if(!N)return U;var v,f,_=N.call(U),b=[];try{for(;(C===void 0||0<C--)&&!(v=_.next()).done;)b.push(v.value)}catch(y){f={error:y}}finally{try{v&&!v.done&&(N=_.return)&&N.call(_)}finally{if(f)throw f.error}}return b};function G(U){var C,N,v;if(U!=null&&Array.isArray(U))try{for(var f=se(U),_=f.next();!_.done;_=f.next()){var b=_.value;if(b!=null)if(v){if(typeof b!==v)return!1}else v=typeof b}}catch(y){C={error:y}}finally{try{_&&!_.done&&(N=f.return)&&N.call(f)}finally{if(C)throw C.error}}return!0}Object.defineProperty(W,"u",{value:!0}),W.sanitizeAttributes=W.isAttributeValue=void 0,W.isAttributeValue=G,W.sanitizeAttributes=function(U){var C,N,v={};if(U!=null&&typeof U=="object")try{for(var f=se(Object.entries(U)),_=f.next();!_.done;_=f.next()){var b=J(_.value,2),y=b[0],M=b[1];G(M)&&(v[y]=Array.isArray(M)?M.slice():M)}}catch(Y){C={error:Y}}finally{try{_&&!_.done&&(N=f.return)&&N.call(f)}finally{if(C)throw C.error}}return v}},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.IdGenerator=void 0;var se=Array(32);function J(G){return function(){for(var U=0;U<2*G;U++)se[U]=Math.floor(16*Math.random())+48,58<=se[U]&&(se[U]+=39);return String.fromCharCode.apply(null,se.slice(0,2*G))}}W.IdGenerator=function(){this.generateTraceId=J(16),this.generateSpanId=J(8),this.generateEventId=J(4)}},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.Resource=W.SDK_INFO=W.SemanticResourceAttributes=void 0,W.SemanticResourceAttributes={PROCESS_RUNTIME_NAME:"process.runtime.name",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version"},W.SDK_INFO=((se={})[W.SemanticResourceAttributes.TELEMETRY_SDK_NAME]="opentelemetry",se[W.SemanticResourceAttributes.PROCESS_RUNTIME_NAME]="browser",se[W.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE]="webjs",se[W.SemanticResourceAttributes.TELEMETRY_SDK_VERSION]=W.VERSION,se),J.empty=function(){return J.EMPTY},J.createTelemetrySDKResource=function(){var G;return new J(((G={})[W.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE]=W.SDK_INFO[W.SemanticResourceAttributes.TELEMETRY_SDK_LANGUAGE],G[W.SemanticResourceAttributes.TELEMETRY_SDK_NAME]=W.SDK_INFO[W.SemanticResourceAttributes.TELEMETRY_SDK_NAME],G[W.SemanticResourceAttributes.TELEMETRY_SDK_VERSION]=W.SDK_INFO[W.SemanticResourceAttributes.TELEMETRY_SDK_VERSION],G))},J.prototype.merge=function(G){return G&&Object.keys(G.attributes).length?new J(Object.assign({},this.attributes,G.attributes)):this},J.EMPTY=new J({});var se=J;function J(G){this.attributes=G}W.Resource=se},function(Ne,W,Q){var se=this&&this.__values||function(_){var b=typeof Symbol=="function"&&Symbol.iterator,y=b&&_[b],M=0;if(y)return y.call(_);if(_&&typeof _.length=="number")return{next:function(){return{value:(_=_&&M>=_.length?void 0:_)&&_[M++],done:!_}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")},J=this&&this.__read||function(_,b){var y=typeof Symbol=="function"&&_[Symbol.iterator];if(!y)return _;var M,Y,L=y.call(_),A=[];try{for(;(b===void 0||0<b--)&&!(M=L.next()).done;)A.push(M.value)}catch(H){Y={error:H}}finally{try{M&&!M.done&&(y=L.return)&&y.call(L)}finally{if(Y)throw Y.error}}return A},G=(Object.defineProperty(W,"u",{value:!0}),W.Span=void 0,Q(6)),U=Q(1),C=Q(2),N=Q(7),v=Q(18);function f(_,b,y,M,Y,L,A,H){H===void 0&&(H=[]),this.attributes={},this.links=[],this.events=[],this.status={code:C.SpanStatusCode.UNSET},this.endTime=0,this.N=!1,this.A=0,this.exported=!0,this.R=_.context,this.reporter=_.reporter,this.spanProcessor=_.spanProcessor,this.parentTracer=_,this.name=y,this.level=M,this.spanContext=Y,this.parentSpanId=A,this.kind=L,this.links=H,this.startTime=Date.now(),this.resource=_.resource,this.instrumentationLibrary=_.instrumentationLibrary,this.I=_.getActiveTraceParams(),this.k=new N.IdGenerator}f.prototype.context=function(){return this.spanContext},f.prototype.setAttribute=function(_,b){return b==null||_.length===0||!G.isAttributeValue(b)||Object.keys(this.attributes).length>=this.I.numberOfAttributesPerSpan&&!Object.prototype.hasOwnProperty.call(this.attributes,_)||(this.attributes[_]=b),this},f.prototype.appendAttribute=function(_,b){return b==null||_.length===0||!G.isAttributeValue(b)||Object.keys(this.attributes).length>=this.I.numberOfAttributesPerSpan&&!Object.prototype.hasOwnProperty.call(this.attributes,_)||(this.attributes[_]&&Array.isArray(this.attributes[_])?this.attributes[_].push(b):this.attributes[_]=[b]),this},f.prototype.setAttributes=function(_){var b,y;try{for(var M=se(Object.entries(_)),Y=M.next();!Y.done;Y=M.next()){var L=J(Y.value,2);this.setAttribute(L[0],L[1])}}catch(A){b={error:A}}finally{try{Y&&!Y.done&&(y=M.return)&&y.call(M)}finally{if(b)throw b.error}}return this},f.prototype.addEvent=function(_,b,y){this.events.length>=this.I.numberOfEventsPerSpan&&this.events.shift();var M=this.k.generateEventId();return v.isTimeInput(b)&&(y===void 0&&(y=b),b=void 0),y===void 0&&(y=v.hrTime()),this.events.push({name:_,attributes:b,time:v.timeInputToHrTime(y),event_id:M}),this},f.prototype.setStatus=function(_){return this.status=_,this},f.prototype.updateName=function(_){return this.name=_,this},f.prototype.end=function(_){var b,y=this;this.D()||(this.N=!0,this.resource=this.parentTracer.resource,this.spanProcessor.spanBeforeEnd&&this.spanProcessor.spanBeforeEnd(this),b=v.getCurrentTime(),this.setAttribute("e_time_s",b),this.endTime=Date.now(),this.A=this.endTime-this.startTime,this.R.with(U.suppressInstrumentation(this.R.active()),function(){var M=y.P(y);y.spanProcessor.spanEnd&&y.spanProcessor.spanEnd(M,y.level),M.droped||_===!1||(delete M.droped,y.reporter.report(JSON.stringify(M),y.level))}))},f.prototype.spanReport=function(){var _=this.P(this);this.reporter.report(JSON.stringify(_),this.level)},f.prototype.isRecording=function(){return this.N===!1},Object.defineProperty(f.prototype,"duration",{get:function(){return this.A},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"ended",{get:function(){return this.N},enumerable:!1,configurable:!0}),f.prototype.D=function(){return this.N},f.prototype.P=function(_){var b=[],y=(_.events.forEach(function(M){var Y={};Object.keys(M).forEach(function(L){L==="name"&&(Y[L]=M[L]),L==="time"&&(Y.timestamp=v.hrTimeToMilliseconds(M[L])),L==="attributes"&&(Y.tags=M[L])}),b.push(Y)}),[]);return _.links.forEach(function(M){y.push({span_id:M.context.spanId,trace_id:M.context.traceId})}),{trace_id:_.spanContext.traceId,parent_span_id:_.parentSpanId,name:_.name,span_id:_.spanContext.spanId,kind:_.kind,start_time:_.startTime,end_time:_.endTime,duration:_.duration,logs:b,tags:_.attributes,links:y}},W.Span=f},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.ZegoSpan=void 0;var se=Q(3),J=Q(9);function G(U,C){this.spanId=U,this.span=C}G.prototype.setAttribute=function(U,C){var N=this;return this.span?this.span.setAttribute(U,C):this.B().then(function(){N.span&&N.span.setAttribute(U,C)}),this},G.prototype.setAttributes=function(U){var C=this;return this.span?this.span.setAttributes(U):this.B().then(function(){C.span&&C.span.setAttributes(U)}),this},G.prototype.appendAttribute=function(U,C){var N=this;return this.span?this.span.appendAttribute(U,C):this.B().then(function(){N.span&&N.span.appendAttribute(U,C)}),this},G.prototype.addEvent=function(U,C,N){var v=this;return this.span?this.span.addEvent(U,C,N):this.B().then(function(){v.span&&v.span.addEvent(U,C,N)}),this},G.prototype.setStatus=function(U){var C=this;return this.span?this.span.setStatus(U):this.B().then(function(){C.span&&C.span.setStatus(U)}),this},G.prototype.updateName=function(U){var C=this;return this.span?this.span.updateName(U):this.B().then(function(){C.span&&C.span.updateName(U)}),this},G.prototype.end=function(U){var C=this;U===void 0&&(U=!0),this.span?this.span.end(U):this.B(!0).then(function(){C.span&&C.span.end(U),C.U()})},G.prototype.setSpanActive=function(U){this.activeCallback=U},G.prototype.setSpanEnd=function(U){this.endCallback=U},G.prototype.spanReport=function(){var U;(U=this.span)!=null&&U.spanReport()},G.prototype.U=function(){this.L()||(this.J(this.spanId),this.endCallback&&this.endCallback(this.spanInfo))},G.prototype.L=function(){return this.spanId==="noop"},G.prototype.B=function(U){var C=this;return U===void 0&&(U=!1),new Promise(function(N,v){C.store.getItem(C.spanId).then(function(f){var _=new J.Span(G.tracer,G.tracer.context.active(),f.name,f.level,f.spanContext,f.kind,f.parentSpanId,f.links);_.setStatus(f.status),_.setAttributes(f.attributes),C.span=_,C.activeCallback&&C.activeCallback(C.spanId,U),N()}).catch(function(f){v(f)})})},G.prototype.J=function(U){var C=this;this.store.getItem(U).then(function(N){N&&C.store.removeItem(U).then(function(){se.log.log("remove suc")}).catch(function(v){se.log.warn("remove fail")})})},W.ZegoSpan=G},function(Ne,W,Q){function se(J){this.q=J=J===void 0?"":J,this.count=0,this.isStarting=!1,this.timer=0,this.lastLogTime=0,this.speed=0,this.lastTime=0}Object.defineProperty(W,"u",{value:!0}),W.SpeedUtil=void 0,se.prototype.add=function(J){this.isStarting&&(this.count+=J)},se.prototype.stop=function(){return this.isStarting=!1,this.reset()},se.prototype.start=function(J){var G=this;J===void 0&&(J=0),this.isStarting=!0,this.count=0,clearInterval(this.timer),J&&(this.timer=window.setInterval(function(){G.speed=G.count/J,G.count=0},J))},se.prototype.reset=function(){this.count=0,clearInterval(this.timer),this.timer=0,this.speed=0},W.SpeedUtil=se},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.createZegoStore=W.ZegoWechatMiniStore=W.ZEGO_ENV=void 0;var se,J,G=Q(13),U=((J=se=W.ZEGO_ENV||(W.ZEGO_ENV={}))[J.BROWSER=0]="BROWSER",J[J.WEIXINMINI=1]="WEIXINMINI",Q(3)),C=(N.prototype.getItem=function(v){var f=this;return new Promise(function(_,b){try{_(wx.getStorageSync(f.keyPrefix+v))}catch(y){b(y)}})},N.prototype.setItem=function(v,f){var _=this;return new Promise(function(b,y){try{wx.setStorageSync(_.keyPrefix+v,f),b()}catch(M){y(M)}})},N.prototype.removeItem=function(v){var f=this;return new Promise(function(_,b){try{_(wx.removeStorageSync(f.keyPrefix+v))}catch(y){b(y)}})},N.prototype.clear=function(){return new Promise(function(v,f){try{wx.clearStorageSync(),v()}catch(_){f(_)}})},N.prototype.keys=function(){var v=this;return new Promise(function(f,_){try{var b=wx.getStorageInfoSync().keys,y=(U.log.warn("keys",b),[]);b.forEach(function(M){M.indexOf(v.keyPrefix)==0&&y.push(M.replace(v.keyPrefix,""))}),U.log.warn("keyArr",JSON.stringify(y)),y.sort(),f(y)}catch(M){_(M)}})},N);function N(v){this.storeName=v,this.keyPrefix=v+"/"}W.ZegoWechatMiniStore=C,W.createZegoStore=function(v,f,_){return f===se.BROWSER?G.createInstance({name:v+":"+(_||"store")}):new C(v)}},function(Ne,W){Ne.exports=E},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.DynamicCode=W.ZegoTracer=W.ZegoSpan=void 0;var se=Q(15),J=(Object.defineProperty(W,"ZegoTracer",{enumerable:!0,get:function(){return se.ZegoTracer}}),Q(46)),G=(Object.defineProperty(W,"DynamicCode",{enumerable:!0,get:function(){return J.DynamicCode}}),Q(10));Object.defineProperty(W,"ZegoSpan",{enumerable:!0,get:function(){return G.ZegoSpan}})},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.ZegoTracer=void 0;var se=Q(16),J=Q(22),G=Q(10),U=Q(23),C=Q(3),N=Q(1),v=Q(8),f=Q(24),_=Q(39),b=Q(12),y=Q(44),M=Q(45);function Y(L){this.C=U.DEFAULT_MAX_SPAN_SIZE,this.level=0,this.log=new y.ZegoLog,this.stateCenter=new M.StateCenter(this.log),this.stateCenter.proxyCtrl=L}Y.prototype.init=function(L){L.deflate?(this.stateCenter.deflate=L.deflate,typeof L.keepLive=="boolean"&&(this.stateCenter.keepLive=L.keepLive),this.options=L,this.name=L.product,this.reporter=new f.ZegoDataReport(this.name,this.stateCenter),this.reporter.init({appID:L.appID,env:L.env||0,importantLevel:L.importantLevel,levels:L.levels,deviceID:L.deviceID,bps:L.bps,serverUrl:L.serverUrl}),this.tracer=new se.Tracer({name:this.name,version:L.version},{resource:new v.Resource(L.resources)},this.reporter,{spanStart:L.spanStart,spanBeforeEnd:L.spanBeforeEnd,spanEnd:L.spanEnd}),this.reporter.setProcessData(this.tracer.resource.attributes),this.F(this.options),this.dyStore=b.createZegoStore(L.product+"_"+L.appID+"_dy",L.env||0)):console.error("init tracer failed. need input pako inflate function")},Y.prototype.F=function(L){this.rootSpan=this.tracer.startSpan("root",0);var A=N.setSpan(this.tracer.context.active(),this.rootSpan);this.tracer.context.T().M=A,this.rootSpan.end()},Y.prototype.createSpan=function(L,A,H){var ge,Ee;return L<=this.level?(ge=N.setSpan(this.tracer.context.active(),H&&H.parent?H.parent.span:this.rootSpan),Ee=[],H&&H.linkSpans&&(H.linkSpans.forEach(function(Se){Ee.push({context:Se.span.context()})}),delete H.linkSpans),A=this.tracer.startSpan(A,L,Object.assign({},H,{links:Ee}),ge),L=new G.ZegoSpan(A.spanContext.spanId,A),G.ZegoSpan.tracer=this.tracer,L):(C.log.warn("createSpan level not fix"),new G.ZegoSpan(U.NOOP_SPAN_ID,new J.NoopSpan))},Y.prototype.setLogger=function(L){this.stateCenter.logger=L},Y.prototype.setTimeOffset=function(L){this.reporter.setTimeOffset(L)},Y.prototype.setWaitNtpTimeout=function(L){this.reporter.setWaitNtpTimeout(L)},Y.prototype.setLogLevel=function(L){return this.stateCenter.W.setLogLevel(L)},Y.prototype.startReport=function(L){return this.reporter.startReport(L)},Y.prototype.setConfig=function(L){this.reporter.setConfig(L)},Y.prototype.loadJs=function(L,A,H,ge,Ee,Se){return _.loadJS(L,this.dyStore,A,H,ge,Ee,Se)},Y.prototype.flush=function(L){this.reporter.flush(L)},Y.prototype.setUnloadState=function(L){this.reporter.setUnloadState(L)},Y.prototype.shutdown=function(){this.reporter.saveDataBeforeUnload()},Y.prototype.destroy=function(){this.reporter.uninit()},Y.prototype.setSampleConfig=function(L){this.level=L.level||this.level},Y.prototype.setResource=function(L){this.tracer.setResource(L),this.reporter.setProcessData(this.tracer.resource.attributes)},Y.prototype.setNetStateCheck=function(){this.reporter.setNetStateCheck()},Y.prototype.getUnloadStatus=function(){return{uploadSpeed:this.reporter.uploadSpeed,increaseSpeed:this.reporter.speed,unreportLength:this.reporter.unreportDataByteLen}},Y.prototype.reportSize=function(){return this.reporter.traceType.MEM_I_API},W.ZegoTracer=Y},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.Tracer=void 0;var se=Q(6),J=Q(1),G=Q(2),U=Q(7),C=Q(8),N=Q(9),v=Q(19),f=Q(20);function _(b,y,M,Y){var L=f.mergeConfig(y);this.I=L.traceParams,this.k=new U.IdGenerator,this.resource=(L=y.resource)!=null?L:C.Resource.createTelemetrySDKResource(),this.instrumentationLibrary=b,y=Math.random().toString(36).slice(-6),this.context=new J.ContextAPI(y),this.reporter=M,this.spanProcessor=Y||{}}_.prototype.startSpan=function(b,y,M,Y){var L,A,H,ge=((ue,oe)=>{if(!ue.root)return J.getSpanContext(oe)})(M=M===void 0?{}:M,Y=Y===void 0?this.context.active():Y),Ee=this.k.generateSpanId(),Se=(ge&&v.isSpanContextValid(ge)?(L=ge.traceId,A=ge.traceState,H=ge.spanId):L=this.k.generateTraceId(),ge=(ge=M.kind)!=null?ge:G.SpanKind.INTERNAL,(Se=M.links)!=null?Se:[]);return M=se.sanitizeAttributes(M.attributes),(Y=new N.Span(this,Y,b,y,{traceId:L,spanId:Ee,traceFlags:G.TraceFlags.NONE,traceState:A},ge,H,Se)).setAttributes(M),this.spanProcessor.spanStart&&this.spanProcessor.spanStart(Y),Y},_.prototype.setResource=function(b){this.resource=this.resource.merge(new C.Resource(b))},_.prototype.getActiveTraceParams=function(){return this.I},W.Tracer=_},function(Ne,W,Q){var se=this&&this.__read||function(C,N){var v=typeof Symbol=="function"&&C[Symbol.iterator];if(!v)return C;var f,_,b=v.call(C),y=[];try{for(;(N===void 0||0<N--)&&!(f=b.next()).done;)y.push(f.value)}catch(M){_={error:M}}finally{try{f&&!f.done&&(v=b.return)&&v.call(b)}finally{if(_)throw _.error}}return y},J=this&&this.__spread||function(){for(var C=[],N=0;N<arguments.length;N++)C=C.concat(se(arguments[N]));return C},G=(Object.defineProperty(W,"u",{value:!0}),W.StackContextManager=void 0,Q(1));function U(){this.X=!1,this.M=G.ROOT_CONTEXT}U.prototype.K=function(C,N){function v(){for(var _=this,b=[],y=0;y<arguments.length;y++)b[y]=arguments[y];return f.with(N,function(){return C.apply(_,b)})}N===void 0&&(N=G.ROOT_CONTEXT);var f=this;return Object.defineProperty(v,"length",{enumerable:!1,configurable:!0,writable:!1,value:C.length}),v},U.prototype.active=function(){return this.M},U.prototype.bind=function(C,N){return(N=N===void 0?G.ROOT_CONTEXT:N)===void 0&&(N=this.active()),typeof C=="function"?this.K(C,N):C},U.prototype.disable=function(){return this.M=G.ROOT_CONTEXT,this.X=!1,this},U.prototype.enable=function(){return this.X||(this.X=!0,this.M=G.ROOT_CONTEXT),this},U.prototype.with=function(C,N,v){for(var f=[],_=3;_<arguments.length;_++)f[_-3]=arguments[_];var b=this.M;this.M=C||G.ROOT_CONTEXT;try{return N.call.apply(N,J([v],f))}finally{this.M=b}},W.StackContextManager=U},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.getCurrentTime=W.isTimeInput=W.hrTimeToMilliseconds=W.hrTimeDuration=W.timeInputToHrTime=W.isTimeInputHrTime=W.hrTime=void 0;var se=9,J=Math.pow(10,se),G=["00","01","02","03","04","05","06","07","08","09"];function U(f){f/=1e3;var _=Math.trunc(f);return[_,Number((f-_).toFixed(se))*J]}function C(){var f,_=performance.timeOrigin;return typeof _!="number"?(f=performance).timing&&f.timing.fetchStart:_}function N(f){var _=U(C()),b=(f=U(typeof f=="number"?f:performance.now()),_[0]+f[0]);return J<(_=_[1]+f[1])&&(_-=J,b+=1),[b,_]}function v(f){return Array.isArray(f)&&f.length===2&&typeof f[0]=="number"&&typeof f[1]=="number"}W.hrTime=N,W.isTimeInputHrTime=v,W.timeInputToHrTime=function(f){if(v(f))return f;if(typeof f=="number")return(f<C()?N:U)(f);if(f instanceof Date)return U(f.getTime());throw TypeError("Invalid input type")},W.hrTimeDuration=function(f,_){var b=_[0]-f[0];return(_=_[1]-f[1])<0&&(--b,_+=J),[b,_]},W.hrTimeToMilliseconds=function(f){return Math.round(1e3*f[0]+f[1]/1e6)},W.isTimeInput=function(f){return v(f)||typeof f=="number"||f instanceof Date},W.getCurrentTime=function(){var f=new Date;return[f.getFullYear()+"/",(G[f.getMonth()+1]||f.getMonth()+1)+"/",(G[f.getDate()]||f.getDate())+" ",(G[f.getHours()]||f.getHours())+":",(G[f.getMinutes()]||f.getMinutes())+":",G[f.getSeconds()]||f.getSeconds(),"."+(""+f.getTime()).slice(-3)].join("")}},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.isSpanContextValid=W.isValidSpanId=W.isValidTraceId=W.INVALID_SPAN_CONTEXT=W.INVALID_TRACEID=W.INVALID_SPANID=void 0,Q=Q(2);var se=/^([0-9a-f]{32})$/i,J=/^[0-9a-f]{16}$/i;function G(C){return se.test(C)&&C!==W.INVALID_TRACEID}function U(C){return J.test(C)&&C!==W.INVALID_SPANID}W.INVALID_SPANID="0000000000000000",W.INVALID_TRACEID="00000000000000000000000000000000",W.INVALID_SPAN_CONTEXT={traceId:W.INVALID_TRACEID,spanId:W.INVALID_SPANID,traceFlags:Q.TraceFlags.NONE},W.isValidTraceId=G,W.isValidSpanId=U,W.isSpanContextValid=function(C){return G(C.traceId)&&U(C.spanId)}},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.mergeConfig=void 0;var se=Q(21);W.mergeConfig=function(J){var G=Object.assign({},se.DEFAULT_CONFIG,J);return G.traceParams=Object.assign({},se.DEFAULT_CONFIG.traceParams,J.traceParams||{}),G}},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.DEFAULT_CONFIG=void 0,W.DEFAULT_CONFIG={traceParams:{numberOfAttributesPerSpan:128,numberOfLinksPerSpan:128,numberOfEventsPerSpan:128}}},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.NoopSpan=void 0;var se=Q(2);function J(G){G===void 0&&(G=se.INVALID_SPAN_CONTEXT),this.G=G}J.prototype.context=function(){return this.G},J.prototype.setAttribute=function(G,U){return this},J.prototype.appendAttribute=function(G,U){return this},J.prototype.setAttributes=function(G){return this},J.prototype.addEvent=function(G,U,C){return this},J.prototype.setStatus=function(G){return this},J.prototype.updateName=function(G){return this},J.prototype.end=function(G){},J.prototype.isRecording=function(){return!1},J.prototype.spanReport=function(){},J.prototype.recordException=function(G,U){},W.NoopSpan=J},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.NOOP_SPAN_ID=W.SCHEDULED_DELAY_MILLIS=W.DEFAULT_MAX_SPAN_SIZE=W.readSpanKeys=void 0,W.readSpanKeys=["name","level","kind","spanContext","parentSpanId","startTime","endTime","status","attributes","links","events","duration","ended","resource","instrumentationLibrary"],W.DEFAULT_MAX_SPAN_SIZE=1e3,W.SCHEDULED_DELAY_MILLIS=3e3,W.NOOP_SPAN_ID="noop"},function(Ne,W,Q){var se=this&&this.__assign||function(){return(se=Object.assign||function(A){for(var H,ge=1,Ee=arguments.length;ge<Ee;ge++)for(var Se in H=arguments[ge])Object.prototype.hasOwnProperty.call(H,Se)&&(A[Se]=H[Se]);return A}).apply(this,arguments)},J=this&&this.__awaiter||function(A,H,ge,Ee){return new(ge=ge||Promise)(function(Se,ue){function oe(pe){try{Le(Ee.next(pe))}catch(k){ue(k)}}function be(pe){try{Le(Ee.throw(pe))}catch(k){ue(k)}}function Le(pe){var k;pe.done?Se(pe.value):((k=pe.value)instanceof ge?k:new ge(function(R){R(k)})).then(oe,be)}Le((Ee=Ee.apply(A,H||[])).next())})},G=this&&this.__generator||function(A,H){var ge,Ee,Se,ue={label:0,sent:function(){if(1&Se[0])throw Se[1];return Se[1]},trys:[],ops:[]},oe={next:be(0),throw:be(1),return:be(2)};return typeof Symbol=="function"&&(oe[Symbol.iterator]=function(){return this}),oe;function be(Le){return function(pe){var k=[Le,pe];if(ge)throw new TypeError("Generator is already executing.");for(;ue;)try{if(ge=1,Ee&&(Se=2&k[0]?Ee.return:k[0]?Ee.throw||((Se=Ee.return)&&Se.call(Ee),0):Ee.next)&&!(Se=Se.call(Ee,k[1])).done)return Se;switch(Ee=0,(k=Se?[2&k[0],Se.value]:k)[0]){case 0:case 1:Se=k;break;case 4:return ue.label++,{value:k[1],done:!1};case 5:ue.label++,Ee=k[1],k=[0];continue;case 7:k=ue.ops.pop(),ue.trys.pop();continue;default:if(!(Se=0<(Se=ue.trys).length&&Se[Se.length-1])&&(k[0]===6||k[0]===2)){ue=0;continue}if(k[0]===3&&(!Se||k[1]>Se[0]&&k[1]<Se[3]))ue.label=k[1];else if(k[0]===6&&ue.label<Se[1])ue.label=Se[1],Se=k;else{if(!(Se&&ue.label<Se[2])){Se[2]&&ue.ops.pop(),ue.trys.pop();continue}ue.label=Se[2],ue.ops.push(k)}}k=H.call(A,ue)}catch(R){k=[6,R],Ee=0}finally{ge=Se=0}if(5&k[0])throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}}},U=this&&this.__read||function(A,H){var ge=typeof Symbol=="function"&&A[Symbol.iterator];if(!ge)return A;var Ee,Se,ue=ge.call(A),oe=[];try{for(;(H===void 0||0<H--)&&!(Ee=ue.next()).done;)oe.push(Ee.value)}catch(be){Se={error:be}}finally{try{Ee&&!Ee.done&&(ge=ue.return)&&ge.call(ue)}finally{if(Se)throw Se.error}}return oe},C=this&&this.__spread||function(){for(var A=[],H=0;H<arguments.length;H++)A=A.concat(U(arguments[H]));return A},N=this&&this.__values||function(A){var H=typeof Symbol=="function"&&Symbol.iterator,ge=H&&A[H],Ee=0;if(ge)return ge.call(A);if(A&&typeof A.length=="number")return{next:function(){return{value:(A=A&&Ee>=A.length?void 0:A)&&A[Ee++],done:!A}}};throw new TypeError(H?"Object is not iterable.":"Symbol.iterator is not defined.")},v=(Object.defineProperty(W,"u",{value:!0}),W.ZegoDataReport=void 0,Q(0)),f=Q(25),_=Q(30),b=Q(38),y=Q(5),M=Q(4),Y=Q(11);function L(A,H){this.H=H,this.QUEUE_MAX=100,this.cacheMaxSize=M.CACHE_SIZE.cacheMaxSize,this.cacheDelPer=M.CACHE_SIZE.cacheDelPer,this.state="normal",this.forceDataTotalLen=0,this.reportPackagesSize=0,this.staticConfig={totalAvailCache:M.CACHE_SIZE.totalAvailCache,totalDBSize:M.STORE_SIZE.totalDBSize,bps:1600},this.dataInDb=[],this.listenerList={progressUpdate:[],forceResult:[],postFail:[],dataDroped:[]},this.tempBuffer=[],this.traceType={MEM_I_API:0,MEM_O_DONE:0,MEM_O_DUMP:0,MEM_I_LOAD:0,DB_O_DROP:0,DB_O_DONE:0,DB_I_BACKUP:0},this.isPaused=!1,this.pro="json",this.isLoadReportData=!1,this.dropCount=0,this.timeInterval=!1,this.isWaitNtpTimeout=!1,this.waitNtpTimeout=2e3,this.postDataState="",this.product=A,this.reportMap=new Map,this.Y=new Y.SpeedUtil("tracer increase"),(H=this.Y)!=null&&H.start(3e3)}Object.defineProperty(L.prototype,"speed",{get:function(){return this.Y.speed},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"uploadSpeed",{get:function(){return this.zegoService.speed},enumerable:!1,configurable:!0}),Object.defineProperty(L.prototype,"unreportDataByteLen",{get:function(){return this.traceType.MEM_I_API+this.traceType.MEM_I_LOAD-this.traceType.MEM_O_DONE-this.traceType.MEM_O_DUMP},enumerable:!1,configurable:!0}),L.prototype.init=function(A){return J(this,void 0,void 0,function(){var H=this;return G(this,function(ge){switch(ge.label){case 0:return this.config=se(se({},M.DEFAULT_CONFIG),A),this.config.env%2!=1&&this.V(),this.zegoService=new f.ZegoService(this.config.env||v.ZEGO_ENV.BROWSER,this.config.bps||M.DEFAULT_CONFIG.bps,this.product,this.pro,this.H),this.zegoService.setLogUrlParams({product:this.product,signature:this.config.token||"",appid:this.config.appID,id_name:this.config.userID||"",deviceid:this.config.deviceID||""}),this.config.serverUrl&&this.zegoService.setLogServer(this.config.serverUrl),this.zegoService.setPostSucCallback(this.product,this.Z.bind(this)),this.zegoService.setPostFailCallback(this.product,function(Ee){return J(H,void 0,void 0,function(){return G(this,function(Se){switch(Se.label){case 0:return this.H.logger.warn("zt.zd.i fail"),this.postDataState="fail",this.dropCount++,this.$(Ee),[4,this.tt(1)];case 1:return Se.sent(),this.it("postFail"),[2]}})})}),this.nt(),this.storeHandler=new _.ZegoStoreHandler(this.product+"_"+this.config.appID+"_datareporter",y.uuid(6),this.config,this.traceType,this.staticConfig,this.H,this.product),this.storeHandler.setDropCallBack(function(Ee){H.traceType.DB_O_DROP+=y.calculateMemSize(Ee),H.it("dataDroped",Ee)}),[4,this.storeHandler.loadPendingData()];case 1:return ge.sent(),this.storeHandler.init().then(function(){H.rt()}).catch(function(Ee){console.warn(Ee)}),this.et(),this.st(),this.ut(),[2]}})})},L.prototype.uninit=function(){this.isWaitNtpTimeout=!1,this.ntpTimer&&(clearTimeout(this.ntpTimer),this.ntpTimer=null),this.Y.stop(),this.zegoService.destroy()},L.prototype.setConfig=function(A){typeof A=="object"&&typeof A.bps=="number"&&(this.config.bps=A.bps,this.zegoService.setBps(this.config.bps)),typeof A=="object"&&typeof A.totalDBSize=="number"&&(this.staticConfig.totalDBSize=A.totalDBSize),typeof A=="object"&&typeof A.serverUrl=="string"&&A.serverUrl!==""&&(this.config.serverUrl=A.serverUrl,this.zegoService.setLogServer(this.config.serverUrl))},L.prototype.pause=function(){this.isPaused=!0},L.prototype.resume=function(){this.isPaused=!1;var A=this.pendingQueue.getPendingDataInfo();this.ot(A.pendingDataSize,A.size)},L.prototype.startReport=function(A){var H=A.get("userID"),ge=A.get("token");return!(!H||typeof H!="string"||!ge||typeof ge!="string"||(this.startCommonField=A,this.config.userID=H,this.config.token=ge,this.zegoService.setLogUrlParams({product:this.product,signature:this.config.token,appid:this.config.appID,id_name:this.config.userID||"",deviceid:this.config.deviceID||""}),this.ht()&&this.ct(),(H=A.get("serverUrl"))&&(this.config.serverUrl=H,this.zegoService.setLogServer(this.config.serverUrl)),this.isConfigOK(this.config)&&(A=(ge=this.pendingQueue.getPendingDataInfo()).pendingDataSize,this.ot(A,ge.size)),0))},L.prototype.setTimeOffset=function(A){var H=this;this.clientTimeOffset=A,this.tempBuffer.forEach(function(ge){(ge=ge.data).tags.time_offset||(ge.tags.time_offset=H.clientTimeOffset)}),this.config.userID&&this.ct()},L.prototype.setProcessData=function(A){this.H.processData=A},L.prototype.on=function(A,H){return this.ft(A,H)},L.prototype.off=function(A,H){return this.lt(A,H)},L.prototype.report=function(A,H){var ge;if(15e3<A.length)return!1;try{ge=JSON.parse(A)}catch{return!1}return this.H.W.debug(A+" "+H),(ge!=null&&ge.id_name||(A=ge==null?void 0:ge.tags)!=null&&A.id_name||this.config.userID)&&this.ht()?(ge!=null&&ge.id_name||(A=ge==null?void 0:ge.tags)!=null&&A.id_name?this.clientTimeOffset&&(ge.tags.time_offset=this.clientTimeOffset):(this.clientTimeOffset&&(ge.tags.time_offset=this.clientTimeOffset),ge.tags.id_name=this.config.userID),this.vt(JSON.stringify(ge),H)):this.tempBuffer.push({data:ge,level:H}),!0},L.prototype.setUnloadState=function(A){this.unloadLevel=A,this.state="unload"},L.prototype.vt=function(A,H){var ge=this,Ee=y.calculateMemSize(A),Se=(this.traceType.MEM_I_API+=Ee,this.Y.add(8*Ee),v.getSeq()),ue=new Date().getTime(),oe={seq:Se,content:A,level:H,timestamp:ue};this.state==="unload"?this.unloadLevel!==void 0&&H<=this.unloadLevel?(this.storeHandler.saveDataToStorage(oe),this.pendingQueue.enqueue(oe,H)):this.H.W.debug("level is low"):H<=this.config.importantLevel?(oe.key=H+"_"+ue+"_"+Se,this.dataInDb.push(oe.key),this.storeHandler.storeData(oe).then(function(be){ge.pendingQueue.enqueue(oe,H),ge.traceType.DB_I_BACKUP+=Ee}).catch(function(be){var Le=ge.dataInDb.findIndex(function(pe){return pe===oe.key});-1<Le&&ge.dataInDb.splice(Le,1),ge.pendingQueue.enqueue(oe,H)})):this.pendingQueue.enqueue(oe,H),this.state==="force"&&(ue=y.calculateMemSize(A),this.forceDataTotalLen+=ue)},L.prototype.ht=function(){return this.isWaitNtpTimeout||this.clientTimeOffset!==void 0},L.prototype.ct=function(){var A,H=this.tempBuffer.shift();H&&(A=H.data,H=H.level,A.tags.id_name=this.config.userID,this.vt(JSON.stringify(A),H),this.ct())},L.prototype.isConfigOK=function(A){return A.userID!==""&&A.token!==""&&A.server!==""},L.prototype.testSize=function(A){},L.prototype.flush=function(A){var H;this.state!=="force"&&(this.state="force",H=16e6,typeof A=="object"&&typeof A.bps=="number"&&(H=A.bps),this.zegoService.setBps(H),this.forceDataTotalLen=this.storeHandler.storeSize+this.pendingQueue.pendingDataSize+this.reportPackagesSize,0<(H=(A=this.pendingQueue.getPendingDataInfo()).pendingDataSize)?this.ot(H,A.size):this.rt())},L.prototype.setWaitNtpTimeout=function(A){this.waitNtpTimeout=A},L.prototype.st=function(){var A=this;this.ntpTimer=setTimeout(function(){A.isWaitNtpTimeout=!0,A.config.userID&&A.ct()},this.waitNtpTimeout)},L.prototype.et=function(){var A=this,H=(this.H.W.debug("startReportTimer "+new Date),this.timeInterval=!0,this.pendingQueue.getPendingDataInfo());this.ot(H.pendingDataSize,H.size),this.reportTimer=window.setTimeout(function(){A.et()},3e4)},L.prototype.ut=function(){return J(this,void 0,void 0,function(){var A,H,ge=this;return G(this,function(Ee){switch(Ee.label){case 0:return H=this.pendingQueue.getPendingDataInfo(),A=H.pendingDataSize,H=H.size,A>this.config.reportSize||H>this.config.reportNum?[4,this.ot(A,H)]:[3,2];case 1:return Ee.sent(),[3,3];case 2:this.rt(),Ee.label=3;case 3:return this.checkDataTimer=window.setTimeout(function(){ge.ut()},15e3),[2]}})})},L.prototype.V=function(){var A=this,H=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i);navigator.userAgent.indexOf("Firefox"),window.addEventListener(H?"pagehide":"beforeunload",function(){window.event&&(window.event.cancelBubble=!0),A.saveDataBeforeUnload()})},L.prototype.saveDataBeforeUnload=function(){var A=(A=this.pendingQueue.readStoreData(1)).storeArr,H=(this.storeHandler.resetCommonStore(),[]);H.push.apply(H,C(A)),A=this.zegoService.readReportQueueData(),H.push.apply(H,C(A)),0<H.length&&this.storeHandler.storePendingData(H)},L.prototype.setNetStateCheck=function(){this.postDataState==="fail"&&this.zegoService.handleNetConnect()},L.prototype.Z=function(A,H,ge){return J(this,void 0,void 0,function(){var Ee,Se,ue,oe,be,Le=this;return G(this,function(pe){switch(pe.label){case 0:for(this.H.W.debug("post suc"),this.postDataState="suc",A.forEach(function(k){Le.traceType.MEM_O_DONE+=y.calculateMemSize(k.content)}),Ee=function(k){var R=A[k];Se.storeHandler.removeDataItem(R).then(function(Fe){R.key&&Le.reportMap.delete(R.key)}).catch(function(Fe){})},Se=this,ue=0;ue<A.length;ue++)Ee(ue);return this.reportPackagesSize-=H,be=this.pendingQueue.getPendingDataInfo(),oe=be.pendingDataSize,be=be.size,oe>this.config.reportSize||be>this.config.reportNum?[4,this.ot(oe,be)]:[3,2];case 1:return pe.sent(),[3,3];case 2:this.rt(),pe.label=3;case 3:return this.state==="force"&&this.reportPackagesSize==0&&(oe=this.reportPackagesSize+this.pendingQueue.pendingDataSize+this.storeHandler.storeSize,be=1-Number((oe/this.forceDataTotalLen).toFixed(2)),this.listenerList.progressUpdate&&this.it("progressUpdate",be),0<this.storeHandler.storeSize)&&this.rt(function(k){k===0&&(Le.state="normal",Le.zegoService.setBps(Le.config.bps||M.DEFAULT_CONFIG.bps),Le.listenerList.forceSuccessCallback)&&Le.it("forceResult","SUCCESS")}),[2]}})})},L.prototype.ot=function(A,H){return J(this,void 0,void 0,function(){var ge,Ee,Se,ue,oe;return G(this,function(be){switch(be.label){case 0:return A>this.config.reportSize||H>this.config.reportNum||["force","unload"].includes(this.state)||this.timeInterval?(this.timeInterval=!1,!this.isPaused&&this.config.userID&&this.config.token&&this.config.serverUrl?[3,3]:(this.H.W.debug("isPaused "+this.isPaused+" "+this.userID+" "+this.config.token+" "+this.config.serverUrl),A>=this.cacheMaxSize||this.staticConfig.totalAvailCache<=0?[4,this.tt(this.cacheDelPer)]:[3,2])):[3,7];case 1:be.sent(),be.label=2;case 2:return[2];case 3:return this.zegoService.reportAllowed()?[3,6]:(this.zegoService.resumeReport(),A>=this.cacheMaxSize||this.staticConfig.totalAvailCache<=0?[4,this.tt(this.cacheDelPer)]:[3,5]);case 4:be.sent(),be.label=5;case 5:return[2];case 6:if(Se=this.pendingQueue.readReportData(this.config.reportSize),ge=Se.totalLen,Se=Se.reportDataArr,ge<=0)return[2];for(Se=this.dt(Se),this.zegoService.report(Ee=Se.packageArr,Se=Se.packageLen,this.product,this.state==="unload"),ue=0;ue<Ee.length;ue++)this.reportMap.set((oe=Ee[ue]).key,oe);this.reportPackagesSize+=Se,this.pendingQueue.refresh(ge),be.label=7;case 7:return[2]}})})},L.prototype.nt=function(){var A=this;this.pendingQueue=new b.PendingQueue(this.config.levels,this.product,this.staticConfig,this.H),this.pendingQueue.setListener({enCallback:function(H,ge,Ee){return J(A,void 0,void 0,function(){return G(this,function(Se){switch(Se.label){case 0:return[4,this.ot(Ee,ge)];case 1:return Se.sent(),[2]}})})}})},L.prototype.yt=function(){var A=this;this.storeHandler.readStoreDataItem().then(function(H){var ge=y.calculateMemSize(H.content);A.traceType.MEM_I_LOAD+=ge,A.pendingQueue.enqueue(H,H.level)}).catch(function(H){})},L.prototype.tt=function(A){return J(this,void 0,void 0,function(){var H,ge,Ee,Se,ue,oe,be,Le,pe;return G(this,function(k){switch(k.label){case 0:ge=this.pendingQueue.readStoreData(A),H=ge.totalLen,ge=ge.storeArr,Ee=function(R){var Fe,te;return G(this,function(Ue){switch(Ue.label){case 0:return Ue.trys.push([0,2,,3]),[4,Se.wt(R,H)];case 1:return Ue.sent(),Fe=R.level+"_"+R.timestamp+"_"+R.seq,-1<(te=Se.dataInDb.findIndex(function(it){return it===Fe}))&&Se.dataInDb.splice(te,1),[3,3];case 2:return Ue.sent(),[3,3];case 3:return[2]}})},Se=this,k.label=1;case 1:k.trys.push([1,6,7,8]),ue=N(ge),oe=ue.next(),k.label=2;case 2:return oe.done?[3,5]:[5,Ee(be=oe.value)];case 3:k.sent(),k.label=4;case 4:return oe=ue.next(),[3,2];case 5:return[3,8];case 6:return be=k.sent(),Le={error:be},[3,8];case 7:try{oe&&!oe.done&&(pe=ue.return)&&pe.call(ue)}finally{if(Le)throw Le.error}return[7];case 8:return[2]}})})},L.prototype.$=function(A){var H=this;A.length&&A.forEach(function(ge){H.storeHandler.storeData(ge).then(function(Ee){var Se=y.calculateMemSize(ge.content);H.traceType.MEM_O_DUMP+=Se}).catch(function(Ee){})})},L.prototype.wt=function(A,H){var ge=this;return new Promise(function(Ee,Se){return J(ge,void 0,void 0,function(){var ue;return G(this,function(oe){switch(oe.label){case 0:return oe.trys.push([0,2,,3]),[4,this.storeHandler.storeData(A)];case 1:return oe.sent(),ue=y.calculateMemSize(A.content),this.traceType.MEM_O_DUMP+=ue,Ee(),[3,3];case 2:return ue=oe.sent(),Se(ue),[3,3];case 3:return[2]}})})})},L.prototype.rt=function(A){var H=this;this.storeHandler.storeSize<=0||this.isLoadReportData||(this.isLoadReportData=!0,this.storeHandler.loadDBData(this.config.reportSize,5,Math.floor(this.cacheMaxSize/3),function(ge){return-1<H.dataInDb.indexOf(ge)}).then(function(ge){H.isLoadReportData=!1,ge.datas.forEach(function(Ee){var Se;H.reportMap.has(Ee.key)||H.pendingQueue.findInQueue(Ee)||(Se=y.calculateMemSize(Ee.content),H.traceType.MEM_I_LOAD+=Se,H.pendingQueue.enqueue(Ee,Ee.level),H.dataInDb.push(Ee.key))}),A&&A(ge.len)}).catch(function(ge){H.isLoadReportData=!1}))},L.prototype.dt=function(A){var H=this,ge=0;return A.forEach(function(Ee){var Se,ue,oe=JSON.parse(Ee.content);if(H.startCommonField)try{for(var be=N(H.startCommonField),Le=be.next();!Le.done;Le=be.next()){var pe=U(Le.value,2),k=pe[0];k!=="userID"&&k!=="token"&&k!=="serverUrl"&&(oe[k]=pe[1])}}catch(R){Se={error:R}}finally{try{Le&&!Le.done&&(ue=be.return)&&ue.call(be)}finally{if(Se)throw Se.error}}ge+=y.calculateMemSize(oe),Ee.content=JSON.stringify(oe)}),{packageArr:A,packageLen:ge}},L.prototype.ft=function(A,H){return!!this.listenerList[A]&&typeof H=="function"&&(this.listenerList[A].indexOf(H)==-1&&this.listenerList[A].push(H),!0)},L.prototype.lt=function(A,H){var ge;return!!this.listenerList[A]&&(ge=this.listenerList[A],H?ge.splice(ge.indexOf(H),1):this.listenerList[A]=[],!0)},L.prototype.it=function(A){for(var H=[],ge=1;ge<arguments.length;ge++)H[ge-1]=arguments[ge];this.listenerList[A]&&this.listenerList[A].forEach(function(Ee){try{Ee.apply(void 0,C(H))}catch{}})},W.ZegoDataReport=L},function(Ne,W,Q){var se=this&&this.__read||function(f,_){var b=typeof Symbol=="function"&&f[Symbol.iterator];if(!b)return f;var y,M,Y=b.call(f),L=[];try{for(;(_===void 0||0<_--)&&!(y=Y.next()).done;)L.push(y.value)}catch(A){M={error:A}}finally{try{y&&!y.done&&(b=Y.return)&&b.call(Y)}finally{if(M)throw M.error}}return L},J=this&&this.__spread||function(){for(var f=[],_=0;_<arguments.length;_++)f=f.concat(se(arguments[_]));return f},G=(Object.defineProperty(W,"u",{value:!0}),W.ZegoService=void 0,Q(0)),U=Q(26),C=Q(29),N=Q(4);function v(f,_,b,y,M){var Y,L,A,H=this;this.bt=f,this.gt=b,this.Ot=y,this.H=M,this.isDestroy=!1,this.packageLen=0,this.packagesDataSize=0,this.PACKAGE_MAX_LEN=5,this.msgID=0,this.logUploadTimer=null,this.logUploadInterval=1e4,this.logCacheSend=[],this.logCacheMax=100,this._t=1e3,this.postSucCallbackList={},this.postFailCallbackList={},this.failCount=0,this.failStartTime=0,this.netWorkFail=!1,this.networkState=G.ENUM_NETWORK_STATE.online,this.state=0,this.St=(L=Y=0,A=function(){L=Y=0},{onOpen:function(){Y=performance.now()},onClose:function(){0<Y&&(performance.now()-Y<100?(L++,H.H.logger.info("zt.rzs.wfsc frequently shutdown.")):A())},isOutOfMaxTimes:function(){return 10<=L}}),this.Mt={offline:function(){H.networkState=G.ENUM_NETWORK_STATE.offline},online:function(ge){H.handleNetConnect()}},this.bindWindowListener(),this.networkState=G.ENUM_NETWORK_STATE.online,this.service=new U.LogService(f,b,y,M),this.service.onHbTimeout=function(){H.H.logger.warn("zt.rzs.ohbto hb timeout."),H.socketReconnect(!0,!0)},this.setBps(_),this.reportQueue=new G.Queue}Object.defineProperty(v.prototype,"speed",{get:function(){return this.service.speed},enumerable:!1,configurable:!0}),v.prototype.destroy=function(){this.Et(),this.logUploadTimer&&clearTimeout(this.logUploadTimer),this.reportQueue.clear(),window.removeEventListener("offline",this.Mt.offline),window.removeEventListener("online",this.Mt.online),this.isDestroy=!0},v.prototype.bindWindowListener=function(){window.addEventListener("offline",this.Mt.offline),window.addEventListener("online",this.Mt.online)},v.prototype.handleNetConnect=function(){var f;this.networkState=G.ENUM_NETWORK_STATE.online,this.logType===1?this.socketReconnect():(f=this.url,this.url="",this.setLogServer(f)),this.netWorkFail=!1},v.prototype.setLogServer=function(f){try{return f.startsWith("wss:")||f.startsWith("ws:")?(this.logType=1,this.jt(f)):f.startsWith("https:")||f.startsWith("http:")?(this.logType=2,this.Tt(f)):this.logType=0,!0}catch{return!1}},v.prototype.setLogUrlParams=function(f){this.logParams=f},v.prototype.jt=function(f){var _,b=this;this.url!=f&&(this.url=f)&&(this.Et(),this.logParams.id_name)&&(this.St.isOutOfMaxTimes()?(this.H.logger.warn("zt.rzs.owsls frequently shutdown too many times. cannot create socket anymore."),this.state=0):(this.state=1,_=f+"?product="+this.logParams.product+"&appid="+this.logParams.appid+"&token="+encodeURIComponent(this.logParams.signature)+"&deviceid="+this.logParams.deviceid+"&id_name="+this.logParams.id_name,this.service.createSocket(_),this.H.logger.info("zt.rzs.owsls socket start "+f),this.service.openHandler(function(){b.service.onPush(),b.service.startCheck(),b.H.logger.info("zt.rzs.owsls socket open"),b.openHandler(),b.St.onOpen()}),this.service.closeHandler(function(y){b.H.logger.warn("zt.rzs.owsls socket close "+JSON.stringify(y.code||y)),b.state=0,b.service.closeSocket(),b.St.onClose(),b.service.url&&b.H.keepLive&&b.socketReconnect(!1)}),this.service.errorHandler(function(y){b.H.logger.warn("zt.rzs.owsls socket error "+JSON.stringify(y.code||y)),b.state=0,b.service.closeSocket(),b.service.url&&b.H.keepLive&&b.socketReconnect(!1)})))},v.prototype.Et=function(){this.service.closeSocket(!0),this.Nt&&(clearTimeout(this.Nt),this.Nt=void 0)},v.prototype.Tt=function(f){(this.url=f)&&this.At()},v.prototype.At=function(){this.logUploadTimer&&(clearInterval(this.logUploadTimer),this.logUploadTimer=null)},v.prototype.Rt=function(f,_,b,y){this.bt===G.ZEGO_ENV.BROWSER?this.It(f,_,b,y):this.SendHttpsLogWeChatMini(f,_,b,y)},v.prototype.It=function(f,_,b,y){var M=this,Y=(f=JSON.stringify({body:{data:f}}),new XMLHttpRequest);Y.onreadystatechange=function(){if(Y.readyState==4)if(Y.status==200){if(Y.responseText.length!=0)try{var L=JSON.parse(Y.responseText).interval;typeof L=="number"&&M.logUploadInterval!==L&&M.Tt(M.url),b&&b()}catch{y&&y()}}else y&&y()},Y.open("POST",this.url,!0),Y.send(f)},v.prototype.SendHttpsLogWeChatMini=function(f,_,b,y){var M=this;f={appid:this.logParams.appid+"",timestamp:new Date().getTime()+"",token:this.logParams.signature,id_name:this.logParams.id_name,product:this.logParams.product,message_id:++this.msgID,req_sdk:1,s:JSON.stringify({speed_detail:f})},wx.request({url:this.url,data:JSON.stringify(f),method:"POST",success:function(Y){Y.data.length!=0&&(typeof(Y=Y&&Y.data&&Y.data.interval)=="number"&&M.logUploadInterval!==Y&&M.Tt(M.url),b)&&b()},fail:function(Y){y&&y()}})},v.prototype.openHandler=function(){this.state=2,this.startReport()},v.prototype.setPostSucCallback=function(f,_){this.postSucCallbackList[f]=_},v.prototype.setPostFailCallback=function(f,_){this.postFailCallbackList[f]=_},v.prototype.reportAllowed=function(){return this.packageLen<this.PACKAGE_MAX_LEN},v.prototype.report=function(f,_,b,y){this.packageLen++,this.packagesDataSize+=_,this.reportQueue.enqueue({reportDatas:f,dataLen:_,product:b}),this.netWorkFail=!1,this.failCount=0,this.failStartTime=0,this.startReport(y)},v.prototype.setBps=function(f){this.tokenBucket=new C.TokenBucket(N.BUCKET_CONFIG.bucketSize,f/8,"sec")},v.prototype.startReport=function(f){var _,b,y,M,Y=this;this.isDestroy||this.logType===1&&this.socketReconnect()||0<this.reportQueue.size()&&(_=this.reportQueue.dequeue(),b=_.reportDatas,y=_.dataLen,M=_.product,f?this.sendReport(b,y,M):this.tokenBucket.removeTokens(y,function(){Y.sendReport(b,y,M)}))},v.prototype.kt=function(){if(this.failCount<=0)return!1;this.failCount==1&&(this.failStartTime=Date.now());var f=(Date.now()-this.failStartTime)/1e3;return this.failCount>=N.FAIL_COUNT&&f>N.FAIL_TIME||this.failCount>=N.FAIL_MAX_COUNT},v.prototype.sendReport=function(f,_,b){var y=this;this.reportData(f,_,b,function(){y.failCount=0,y.failStartTime=0,y.packageLen--,y.packagesDataSize-=_,y.postSucCallbackList[b]&&y.postSucCallbackList[b](f,_,b)},function(M){var Y;y.reportQueue.enqueue({reportDatas:f,dataLen:_,product:b}),y.failCount++,y.kt()?(y.netWorkFail=!0,Y=y.decodeReportQueue(),Object.keys(y.postFailCallbackList).forEach(function(L){y.postFailCallbackList[b](Y[L])})):y.startReport()})},v.prototype.resumeReport=function(){this.netWorkFail===!0&&this.networkState===G.ENUM_NETWORK_STATE.online&&(this.netWorkFail=!1,this.startReport())},v.prototype.reportData=function(f,_,b,y,M){var Y=this,L=[];f.forEach(function(A){L.push(JSON.parse(A.content))}),this.logType==1?this.networkState===G.ENUM_NETWORK_STATE.offline?M&&M(G.errorList.BROKEN):this.service.sendMessage("report",L,y,function(A){var H;Y.state===0&&A===G.SOCKET_DISCONNECT&&(H=Y.url,Y.url="",Y.setLogServer(H)),M&&M(A)}):this.logType==2&&this.Rt(L,_,y,function(){M&&M()})},v.prototype.unsigned2signed=function(f){var _=parseInt(f,10);if(256<_)return _%256;for(var b=[];0<_;)b.push(_%2!=0?1:0),_=Number(_/2);for(b.reverse();b.length<8;)b.unshift(0);var y="";if((b=b.join("")).substr(0,1)==1){for(var M=1;M<b.length;M++)b.substr(M,1)==1?y+=0:y+=1;return"-"+(parseInt(y,2)+1)}for(M=0;M<b.length;M++)y+=b.substr(M,1);return parseInt(y,2)},v.prototype.decodeReportQueue=function(){for(var f={},_=this.reportQueue.size(),b=0;b<_;b++){var y=this.reportQueue.dequeue(),M=y.reportDatas,Y=y.dataLen;f[y=y.product]||(f[y]=[]),f[y]=J(f[y],M),this.reportQueue.enqueue({reportDatas:M,dataLen:Y,product:y})}return f},v.prototype.readReportQueueData=function(){for(var f=[],_=this.reportQueue.size(),b=0;b<_;b++){var y=this.reportQueue.dequeue().reportDatas;f.push.apply(f,J(y))}return f},v.prototype.socketReconnect=function(f,_){var b=this,y=(f===void 0&&(f=!0),(_=_!==void 0&&_)||this.state===0);return this.Nt&&!f||y&&(f&&this.Nt&&(clearTimeout(this.Nt),this.Nt=void 0),this.Nt||(this.Nt=setTimeout(function(){var M;!b.isDestroy&&(b.Nt&&(clearTimeout(b.Nt),b.Nt=void 0),_||b.state===0)&&(M=b.url,b.url="",b.setLogServer(M))},f?0:5e3))),y},W.ZegoService=v},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.LogService=void 0;var se=Q(27),J=Q(4),G=Q(0);function U(C,N,v,f){this.bt=C,this.gt=N,this.Ot=v,this.H=f,this.Dt=new se.ZegoSocketService(this.bt,this.gt,this.Ot,this.H),this.xt=0,this.Pt={},this.Bt=void 0,this.checkHbTimer=void 0}Object.defineProperty(U.prototype,"url",{get:function(){return this.Ut},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"speed",{get:function(){return this.Dt.speed},enumerable:!1,configurable:!0}),U.prototype.zt=function(C){var N,v,f=this,_=this.Dt.sendCommandMap[C.messageId||((_=C==null?void 0:C.data)==null?void 0:_.message_id)];_!=null&&(v=_.v,delete this.Dt.sendCommandMap[C.messageId||((N=C==null?void 0:C.data)==null?void 0:N.message_id)],this.Dt.sendCommandList.remove(_),C.code===0?setTimeout(function(){v&&v.success!=null&&v.success(C,f.xt)},0):setTimeout(function(){v&&v.error!=null&&v.error(C,f.xt)},0))},U.prototype.onPush=function(){var C=this;this.Dt.onMessage=function(N){C.H.keepLive&&(C.Bt=performance.now(),C.startHbTimer()),C.zt(N)}},U.prototype.closeHandler=function(C){this.Dt.closeHandler(function(N){C(N)})},U.prototype.openHandler=function(C){var N=this;this.Dt.openHandler(function(){N.H.keepLive&&(N.Bt=performance.now(),N.startHbTimer()),C&&C()})},U.prototype.errorHandler=function(C){this.Dt.errorHandler(function(N){C(N)})},U.prototype.Lt=function(C){return{Protocol:"req",cmd:C,appid:123,seq:++this.xt,session_id:""}},U.prototype.startCheck=function(){this.Dt.startCheck()},U.prototype.stopCheck=function(){this.Dt.stopCheck()},U.prototype.isDisConnect=function(){return!this.Dt||this.Dt.isDisConnect()},U.prototype.createSocket=function(C){this.Dt.createSocket(C),this.Pt={},this.Ut=C},U.prototype.closeSocket=function(C){C===void 0&&(C=!1),this.Bt=void 0,this.clearHbTimer(),this.Dt.closeSocket(),C&&(this.Ut=void 0)},U.prototype.sendMessage=function(C,N,v,f,_){return this.Dt.isDisConnect()?(f&&f(G.SOCKET_DISCONNECT),0):(_=_||this.Lt(C),this.Dt.sendMessage(_,N,v,f,{timeOut:1e3*J.DEFAULT_CONFIG.netTimeout}))},U.prototype.on=function(C,N){this.Pt[C]=N},U.prototype.clearHbTimer=function(){this.checkHbTimer&&(clearTimeout(this.checkHbTimer),this.checkHbTimer=void 0)},U.prototype.startHbTimer=function(){var C=this;this.clearHbTimer(),this.Dt.isDisConnect()||(this.Bt!==void 0&&15e3<performance.now()-this.Bt?this.Ut&&this.onHbTimeout():this.checkHbTimer=setTimeout(function(){C.Dt.isDisConnect()||(C.sendMessage("report",[]),C.startHbTimer())},5e3))},U.prototype.onHbTimeout=function(){},W.LogService=U},function(Ne,W,Q){var se=this&&this.__assign||function(){return(se=Object.assign||function(N){for(var v,f=1,_=arguments.length;f<_;f++)for(var b in v=arguments[f])Object.prototype.hasOwnProperty.call(v,b)&&(N[b]=v[b]);return N}).apply(this,arguments)},J=(Object.defineProperty(W,"u",{value:!0}),W.ZegoSocketService=void 0,Q(28)),G=Q(0),U=Q(11);function C(N,v,f,_){this.gt=v,this.Ot=f,this.H=_,this.Jt=null,this.sendCommandList=new G.LinkedList,this.sendCommandMap={},this.qt=100,this.Ct=3e4,this.Ft=2e3,this.Mt={},this.ENV=N,this.Y=new U.SpeedUtil("tracer upload")}Object.defineProperty(C.prototype,"speed",{get:function(){return this.Y.speed},enumerable:!1,configurable:!0}),C.prototype.createSocket=function(N){var v=this;this.Jt=J.createZegoWebSocket(N,this.ENV,this.H.proxyCtrl),this.Jt.onclose=function(f){v.Mt.close&&v.Mt.close(f)},this.Jt.onerror=function(f){v.Mt.error&&v.Mt.error(f)},this.Jt.binaryType="arraybuffer",this.Y.start(3e3)},C.prototype.closeSocket=function(){this.Jt&&(this.Jt.onclose=null,this.Jt.onerror=null,this.Jt.close(),this.Jt=null,this.Y.stop())},C.prototype.isDisConnect=function(){return!this.Jt||this.Jt.readyState!==1},C.prototype.sendMessage=function(N,v,f,_,b){b===void 0&&(b={timeOut:6e3});var y=se(se({},this.H.processData),{time_upload:Date.now()});return y={data:v={message_id:N.seq,product:this.gt,s:JSON.stringify({speed_detail:v,process:y})},seq:N.seq,deleted:!1,sendTime:Date.parse(new Date+""),timeOut:b.timeOut,success:f,error:_},b=this.sendCommandList.push(y),this.sendCommandMap[y.seq]=b,this.Jt&&this.Ot!=="pb"&&(f=JSON.stringify(v),this.H.W.debug("zt.zss.sm upload data: "+f),_=this.H.deflate(f),this.Y.add(8*f.length),this.Jt.send(_)),N.seq},C.prototype.Wt=function(N){for(var v=N.getFirst();v!=null;)N.remove(v),v.v&&v.v.error&&setTimeout(function(){v&&v.v&&v.v.error&&v.v.error(G.errorList.TIMEOUT,v.v.data.message_id,v.v.data.s)},0),v=N.getFirst()},C.prototype.Xt=function(N,v){for(var f=N.getFirst(),_=Date.parse(new Date+""),b=0;!(f==null||f.v&&f.v.sendTime+f.v.timeOut>_||(f.v&&delete v[f.v.data.message_id],N.remove(f),!(f.v&&f.v.error==null||f.v&&f.v.sendTime+this.Ct<_)&&f&&f.v&&f.v.error&&f.v.error(G.errorList.TIMEOUT,f.v.data.message_id,f.v.data.s),++b>=this.qt));)f=N.getFirst()},C.prototype.startCheck=function(){var N=this;this.Xt(this.sendCommandList,this.sendCommandMap),this.Kt=setTimeout(function(){N.startCheck()},this.Ft)},C.prototype.stopCheck=function(){this.Wt(this.sendCommandList),clearTimeout(this.Kt)},C.prototype.openHandler=function(N){var v=this;this.Jt&&(this.Jt.onopen=function(f){v.responseHandler(),N(f)})},C.prototype.responseHandler=function(){var N=this;this.Jt&&(this.Jt.onmessage=function(v){v=typeof v.data=="string"?JSON.parse(v.data):JSON.parse(String.fromCharCode.apply(null,new Uint8Array(v.data))),N.onMessage(v)})},C.prototype.closeHandler=function(N){this.Mt.close=N},C.prototype.errorHandler=function(N){this.Mt.error=N},C.prototype.onMessage=function(N){},W.ZegoSocketService=C},function(Ne,W,Q){Object.defineProperty(W,"u",{value:!0}),W.createZegoWebSocket=W.ZegoWeiXinMiniWebSocket=void 0;var se=Q(0),J=(G.prototype.init=function(){var U=this;this.Gt&&(this.readyState=0,this.Gt.onOpen(function(C){U.readyState=U.Gt.readyState,typeof U.onopen=="function"&&(U.onopen(C),U.Gt.onClose(function(N){U.readyState=U.Gt.readyState,typeof U.onclose=="function"&&U.onclose(N)}),U.Gt.onMessage(function(N){typeof U.onmessage=="function"&&U.onmessage(N)}))}),this.Gt.onError(function(C){U.readyState=U.Gt.readyState,typeof U.onerror=="function"&&U.onerror(C)}))},G.prototype.onopen=function(U){},G.prototype.onerror=function(U){},G.prototype.onclose=function(U){},G.prototype.onmessage=function(U){},G.prototype.send=function(U){this.Gt&&this.Gt.send({data:U})},G.prototype.close=function(){this.Gt&&this.Gt.close()},G);function G(U,C){this.url=U,this.readyState=3,this.Gt=wx.connectSocket({url:U}),this.init()}W.ZegoWeiXinMiniWebSocket=J,W.createZegoWebSocket=function(U,C,N){return C%2===se.ZEGO_ENV.BROWSER?(C=U,N?N.createSocket(C,1):new WebSocket(C)):new J(U)}},function(Ne,W,Q){function se(J,G,U,C){if(this.bucketSize=1,this.tokensPerInterval=1,this.interval=1e3,this.parentBucket=null,this.content=0,this.lastDrip=0,this.bucketSize=J,this.tokensPerInterval=G,typeof U=="string")switch(U){case"sec":case"second":this.interval=1e3;break;case"min":case"minute":this.interval=6e4;break;case"hr":case"hour":this.interval=36e5;break;case"day":this.interval=864e5;break;default:throw new Error("Invaid interval "+U)}else this.interval=U;this.parentBucket=C,this.content=0,this.lastDrip=+new Date}Object.defineProperty(W,"u",{value:!0}),W.TokenBucket=void 0,se.prototype.removeTokens=function(J,G){var U=this;return this.bucketSize?J>this.bucketSize?(setTimeout(G.bind(null,"Requested tokens "+J+" exceeds bucket size "+this.bucketSize,null),0),!1):(this.drip(),J>this.content?C():this.parentBucket?this.parentBucket.removeTokens(J,function(N,v){return N?G(N,null):J>U.content?C():(U.content-=J,void G(null,Math.min(v,U.content)))}):(this.content-=J,setTimeout(G.bind(null,null,this.content),0),!0)):(setTimeout(G.bind(null,null,J,Number.POSITIVE_INFINITY),0),!0);function C(){var N=Math.ceil(U.interval/U.tokensPerInterval*(J-U.content));return setTimeout(function(){U.removeTokens(J,G)},N),!1}},se.prototype.tryRemoveTokens=function(J){if(this.bucketSize){if(J>this.bucketSize||(this.drip(),J>this.content)||this.parentBucket&&!this.parentBucket.tryRemoveTokens(J))return!1;this.content-=J}return!0},se.prototype.drip=function(){var J,G;this.tokensPerInterval?(G=+new Date,J=Math.max(G-this.lastDrip,0),this.lastDrip=G,G=J*(this.tokensPerInterval/this.interval),this.content=Math.min(this.content+G,this.bucketSize)):this.content=this.bucketSize},W.TokenBucket=se},function(Ne,W,Q){var se=this&&this.__awaiter||function(_,b,y,M){return new(y=y||Promise)(function(Y,L){function A(Ee){try{ge(M.next(Ee))}catch(Se){L(Se)}}function H(Ee){try{ge(M.throw(Ee))}catch(Se){L(Se)}}function ge(Ee){var Se;Ee.done?Y(Ee.value):((Se=Ee.value)instanceof y?Se:new y(function(ue){ue(Se)})).then(A,H)}ge((M=M.apply(_,b||[])).next())})},J=this&&this.__generator||function(_,b){var y,M,Y,L={label:0,sent:function(){if(1&Y[0])throw Y[1];return Y[1]},trys:[],ops:[]},A={next:H(0),throw:H(1),return:H(2)};return typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function H(ge){return function(Ee){var Se=[ge,Ee];if(y)throw new TypeError("Generator is already executing.");for(;L;)try{if(y=1,M&&(Y=2&Se[0]?M.return:Se[0]?M.throw||((Y=M.return)&&Y.call(M),0):M.next)&&!(Y=Y.call(M,Se[1])).done)return Y;switch(M=0,(Se=Y?[2&Se[0],Y.value]:Se)[0]){case 0:case 1:Y=Se;break;case 4:return L.label++,{value:Se[1],done:!1};case 5:L.label++,M=Se[1],Se=[0];continue;case 7:Se=L.ops.pop(),L.trys.pop();continue;default:if(!(Y=0<(Y=L.trys).length&&Y[Y.length-1])&&(Se[0]===6||Se[0]===2)){L=0;continue}if(Se[0]===3&&(!Y||Se[1]>Y[0]&&Se[1]<Y[3]))L.label=Se[1];else if(Se[0]===6&&L.label<Y[1])L.label=Y[1],Y=Se;else{if(!(Y&&L.label<Y[2])){Y[2]&&L.ops.pop(),L.trys.pop();continue}L.label=Y[2],L.ops.push(Se)}}Se=b.call(_,L)}catch(ue){Se=[6,ue],M=0}finally{y=Y=0}if(5&Se[0])throw Se[1];return{value:Se[0]?Se[1]:void 0,done:!0}}}},G=this&&this.__importDefault||function(_){return _&&_.u?_:{default:_}},U=(Object.defineProperty(W,"u",{value:!0}),W.ZegoStoreHandler=void 0,Q(12)),C=Q(5),N=Q(4),v=G(Q(13));function f(_,b,y,M,Y,L,A){this._=_,this.Ht=b,this.Yt=y,this.Vt=M,this.Zt=Y,this.H=L,this.gt=A,this.storeSize=0,this.storeTime=0,this.storeDelPer=N.STORE_SIZE.storeDelPer,this.updateTimeFreq=6e4,this.storeSleepInterval=6e5,this.droping=!1,this.bufferData=[],this.updateTimer=null,this.interSymbol="#",this.drops=[],this.storesKeys="",this.transStores=[],this.store=U.createZegoStore(_,y.env,b),this.commonStore=U.createZegoStore("data_common",y.env,"reporter")}Object.defineProperty(f.prototype,"Qt",{get:function(){return"z_t_"+this.gt+"_"+this.Yt.appID},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"$t",{get:function(){return"z_store_keys"},enumerable:!1,configurable:!0}),f.prototype.init=function(){return se(this,void 0,void 0,function(){var _,b;return J(this,function(y){switch(y.label){case 0:return y.trys.push([0,6,,7]),this.setCommonStoreState(),[4,this.transferStoreData()];case 1:return y.sent(),[4,this.commonStore.getItem(this._+this.interSymbol+this.Ht)];case 2:return(_=y.sent())?[3,4]:[4,this.commonStore.setItem(this._+this.interSymbol+this.Ht,b={storeSize:this.storeSize,lock:0,pros:1})];case 3:return y.sent(),[3,5];case 4:b=typeof _=="string"?JSON.parse(_):_,this.storeSize=b.storeSize,y.label=5;case 5:return[3,7];case 6:return y.sent(),[3,7];case 7:return[2]}})})},f.prototype.uninit=function(){this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)},f.prototype.setCommonStoreState=function(){var _=this,b=(this.getStorage(this.$t)||"").split(";");this.transStores=b.filter(function(y){return y.includes(_.Yt.appID+"")&&y.includes(_.gt)}),b=b.filter(function(y){return!y.includes(_.Yt.appID+"")||!y.includes(_.gt)}),this.storesKeys=b.join(";")},f.prototype.resetCommonStore=function(){return se(this,void 0,void 0,function(){return J(this,function(_){switch(_.label){case 0:return this.saveStorage(this.$t,this.storesKeys+(0<this.storesKeys.length?";":"")+this._+this.interSymbol+this.Ht),[4,this.commonStore.setItem(this._+this.interSymbol+this.Ht,{storeSize:this.storeSize,lock:0,pros:0})];case 1:return _.sent(),[2]}})})},f.prototype.transferStoreData=function(){return se(this,void 0,void 0,function(){var _,b,y,M,Y=this;return J(this,function(L){switch(L.label){case 0:return[4,this.commonStore.keys()];case 1:_=L.sent(),b=function(A){var H,ge,Ee,Se,ue,oe,be,Le;return J(this,function(pe){switch(pe.label){case 0:return(H=_[A])===y._+y.interSymbol+y.Ht?[3,9]:[4,y.commonStore.getItem(H)];case 1:return(ge=typeof(ge=pe.sent())=="string"?JSON.parse(ge):ge).lock||ge.pros&&!y.transStores.includes(H)?[3,9]:(Se=H.split(y.interSymbol),[4,(ue=U.createZegoStore(Ee=Se[0],y.Yt.env,Se=Se[1])).keys()]);case 2:return(oe=pe.sent()).length!=0?[3,3]:[3,8];case 3:return ge.lock=1,[4,y.commonStore.setItem(H,ge)];case 4:pe.sent(),be=function(k){var R,Fe,te;return J(this,function(Ue){switch(Ue.label){case 0:return[4,ue.getItem(R=oe[k])];case 1:return Fe=Ue.sent(),R.indexOf("pending")!==-1?Fe&&JSON.parse(Fe).forEach(function(it){return se(Y,void 0,void 0,function(){return J(this,function(ee){switch(ee.label){case 0:return[4,this.storeData(it)];case 1:return ee.sent(),[2]}})})}):(te=C.analyzeKey(R),y.storeData({level:te.level,timestamp:te.timestamp,seq:te=te.seq,content:Fe})),setTimeout(function(){return se(Y,void 0,void 0,function(){return J(this,function(it){switch(it.label){case 0:return[4,ue.removeItem(R)];case 1:return it.sent(),[2]}})})},300),[2]}})},Le=0,pe.label=5;case 5:return Le<oe.length?[5,be(Le)]:[3,8];case 6:pe.sent(),pe.label=7;case 7:return Le++,[3,5];case 8:y.drops.push({name:Ee,storeName:Se}),pe.label=9;case 9:return[2]}})},y=this,M=0,L.label=2;case 2:return M<_.length?[5,b(M)]:[3,5];case 3:L.sent(),L.label=4;case 4:return M++,[3,2];case 5:return this.transportStorageData(),setTimeout(function(){return se(Y,void 0,void 0,function(){var A,H,ge;return J(this,function(Ee){switch(Ee.label){case 0:A=0,Ee.label=1;case 1:if(!(A<this.drops.length))return[3,7];H=(ge=this.drops[A]).name,ge=ge.storeName,Ee.label=2;case 2:return Ee.trys.push([2,5,,6]),[4,this.dropInstance(H,ge)];case 3:return Ee.sent(),[4,this.commonStore.removeItem(H+this.interSymbol+ge)];case 4:case 5:return Ee.sent(),[3,6];case 6:return A++,[3,1];case 7:return[2]}})})},1e3),[2]}})})},f.prototype.dropInstance=function(_,b){return new Promise(function(y,M){v.default.dropInstance({name:_+":"+b}).then(function(){y()}).catch(function(Y){M(Y)})})},f.prototype.setDropCallBack=function(_){this.dropCallBack=_},f.prototype.storeData=function(_){var b=this;return new Promise(function(y,M){return se(b,void 0,void 0,function(){var Y,L,A,H,ge=this;return J(this,function(Ee){switch(Ee.label){case 0:L=_.content,A=(Y=_.level)+"_"+_.timestamp+"_"+_.seq,Ee.label=1;case 1:return Ee.trys.push([1,3,,4]),[4,this.store.getItem(A)];case 2:return Ee.sent()?(y(),[2]):[3,4];case 3:return Ee.sent(),[3,4];case 4:if(this.droping)return this.bufferData.push(_),[2];if(H=C.calculateMemSize(A)+C.calculateMemSize(L),this.Zt.totalDBSize-H<=0)return this.dropDBData(Y,A,L).then(function(){ge.droping=!1,ge.bufferDump()}).catch(function(Se){}),y(),[2];Ee.label=5;case 5:return Ee.trys.push([5,8,,9]),[4,this.store.setItem(A,L)];case 6:return Ee.sent(),this.storeSize+=H,this.Zt.totalDBSize-=H,[4,this.ti()];case 7:return Ee.sent(),y(),[3,9];case 8:return Ee.sent().name==="QuotaExceededError"&&this.dropDBData(Y,A,L).then(function(){ge.droping=!1,ge.bufferDump()}).catch(function(Se){}),[3,9];case 9:return[2]}})})})},f.prototype.loadPendingData=function(){return se(this,void 0,void 0,function(){var _=this;return J(this,function(b){switch(b.label){case 0:return[4,this.store.keys()];case 1:return b.sent().forEach(function(y){return se(_,void 0,void 0,function(){var M,Y=this;return J(this,function(L){switch(L.label){case 0:return y.indexOf("pending")===-1?[3,3]:[4,this.store.getItem(y)];case 1:return(M=L.sent())?(JSON.parse(M).forEach(function(A){return se(Y,void 0,void 0,function(){return J(this,function(H){switch(H.label){case 0:return[4,this.storeData(A)];case 1:return H.sent(),[2]}})})}),[4,this.store.removeItem(y)]):[3,3];case 2:L.sent(),L.label=3;case 3:return[2]}})})}),[2]}})})},f.prototype.storePendingData=function(_){return se(this,void 0,void 0,function(){return J(this,function(b){switch(b.label){case 0:return[4,this.store.setItem("pending"+new Date().getTime(),JSON.stringify(_))];case 1:return b.sent(),[2]}})})},f.prototype.bufferDump=function(){return se(this,void 0,void 0,function(){var _;return J(this,function(b){switch(b.label){case 0:return(_=this.bufferData.pop())?[4,this.storeData(_)]:[3,2];case 1:b.sent(),this.bufferDump(),b.label=2;case 2:return[2]}})})},f.prototype.dropDBData=function(_,b,y){return se(this,void 0,void 0,function(){var M=this;return J(this,function(Y){return this.droping=!0,[2,new Promise(function(L,A){return se(M,void 0,void 0,function(){var H,ge,Ee,Se,ue;return J(this,function(oe){switch(oe.label){case 0:return oe.trys.push([0,10,,11]),[4,this.store.keys()];case 1:(H=oe.sent()).reverse(),ge=Math.ceil(H.length*this.storeDelPer),Ee=0,oe.label=2;case 2:return Ee<ge?[4,this.store.getItem(H[Ee])]:[3,7];case 3:return(Se=oe.sent())==null?[3,6]:[4,this.store.removeItem(H[Ee])];case 4:return oe.sent(),ue=C.calculateMemSize(H[Ee])+C.calculateMemSize(Se),this.Zt.totalDBSize+=ue,this.storeSize-=ue,[4,this.ti()];case 5:oe.sent(),this.dropCallBack(Se),oe.label=6;case 6:return Ee++,[3,2];case 7:return[4,this.store.setItem(b,y)];case 8:return oe.sent(),this.storeSize+=C.calculateMemSize(b)+C.calculateMemSize(y),[4,this.ti()];case 9:return oe.sent(),L(),[3,11];case 10:return ue=oe.sent(),A(ue),[3,11];case 11:return[2]}})})})]})})},f.prototype.removeDataItem=function(_){var b=this;return new Promise(function(y,M){return se(b,void 0,void 0,function(){var Y,L,A;return J(this,function(H){switch(H.label){case 0:Y=(Y=_.level)+"_"+_.timestamp+"_"+_.seq,H.label=1;case 1:return H.trys.push([1,6,,7]),[4,this.store.getItem(Y)];case 2:return(L=H.sent())?[4,this.store.removeItem(Y)]:[3,5];case 3:return H.sent(),A=C.calculateMemSize(this.Yt.env==1?JSON.parse(L):L),A=C.calculateMemSize(Y)+A,this.storeSize-=A,this.Zt.totalDBSize+=A,this.Vt.DB_O_DONE+=A,[4,this.ti()];case 4:H.sent(),y(),H.label=5;case 5:return[3,7];case 6:return A=H.sent(),M(A),[3,7];case 7:return[2]}})})})},f.prototype.ti=function(){return se(this,void 0,void 0,function(){return J(this,function(_){switch(_.label){case 0:return _.trys.push([0,4,,5]),[4,this.commonStore.getItem(this._+this.interSymbol+this.Ht)];case 1:return _.sent()?[4,this.commonStore.setItem(this._+this.interSymbol+this.Ht,{storeSize:this.storeSize,lock:0,pros:1})]:[3,3];case 2:_.sent(),_.label=3;case 3:return[3,5];case 4:return _.sent(),[3,5];case 5:return[2]}})})},f.prototype.readStoreDataItem=function(){var _=this;return new Promise(function(b,y){return se(_,void 0,void 0,function(){var M,Y,L,A;return J(this,function(H){switch(H.label){case 0:return H.trys.push([0,3,,4]),[4,this.store.keys()];case 1:return M=H.sent(),[4,this.store.getItem(M[0])];case 2:return Y=H.sent(),L=C.analyzeKey(M[0]),b({level:A=L.level,timestamp:L.timestamp,seq:L.seq,content:Y}),[3,4];case 3:return A=H.sent(),y(A),[3,4];case 4:return[2]}})})})},f.prototype.loadDBData=function(_,b,y,M){var Y=this;return new Promise(function(L,A){return se(Y,void 0,void 0,function(){var H,ge,Ee,Se,ue,oe,be,Le,pe,k;return J(this,function(R){switch(R.label){case 0:return R.trys.push([0,6,,7]),[4,this.store.keys()];case 1:H=R.sent(),ge=[],oe=ue=Se=Ee=0,R.label=2;case 2:return oe<H.length?M(H[oe])?[3,4]:[4,this.store.getItem(H[oe])]:[3,5];case 3:if((be=R.sent())==null)return[3,4];if(Le=C.analyzeKey(H[oe]),ge.push({level:pe=Le.level,timestamp:k=Le.timestamp,seq:Le=Le.seq,content:be,key:H[oe]}),pe=C.calculateMemSize(be),Se+=pe,_<=(Ee+=pe)&&(Ee=0,ue++),b<=ue&&y<=Se)return[3,5];R.label=4;case 4:return oe++,[3,2];case 5:return L({datas:ge,len:Se}),[3,7];case 6:return k=R.sent(),A(k),[3,7];case 7:return[2]}})})})},f.prototype.sortKeys=function(_,b){b===void 0&&(b=!1),_.sort(function(y,M){return y=y.split("_"),+(M=M.split("_"))[0]-+y[0]||+M[1]-+y[1]||+M[2]-+y[2]}),b&&_.reverse()},f.prototype.saveStorage=function(_,b){try{localStorage.setItem(_,b)}catch{this.H.W.debug("storage set err")}},f.prototype.getStorage=function(_){try{return localStorage.getItem(_)}catch{this.H.W.debug("storage get err")}},f.prototype.saveDataToStorage=function(_){try{this.saveStorage(this.Qt+"_"+_.level+"_"+_.timestamp+"_"+_.seq,_.content)}catch(b){this.H.W.debug("saveDataToStorage "+JSON.stringify(b))}},f.prototype.transportStorageData=function(){for(var _=[],b=0;b<localStorage.length;b++){var y,M,Y,L,A=localStorage.key(b);this.H.W.debug("transportStorageData "+A),A!=null&&A.startsWith(this.Qt)&&(Y=A.replace(this.Qt+"_",""),y=(Y=C.analyzeKey(Y)).level,M=Y.timestamp,Y=Y.seq,typeof(L=this.getStorage(A))=="string"&&this.storeData({level:y,timestamp:M,seq:Y,content:L}),_.push(A))}setTimeout(function(){for(var H=0;H<_.length;H++)localStorage.removeItem(_[H])},100)},W.ZegoStoreHandler=f},function(Ne,W,Q){var se=Q(32),J=Q(33).Buffer;function G(U){return function(C){if(J.isBuffer(C))return C.length;switch(typeof C){case"string":return C.length*se.STRING;case"boolean":return se.BOOLEAN;case"number":return se.NUMBER;case"symbol":return Symbol.keyFor&&Symbol.keyFor(C)?Symbol.keyFor(C).length*se.STRING:(C.toString().length-8)*se.STRING;case"object":if(Array.isArray(C))return C.map(G(U)).reduce(function(M,Y){return M+Y},0);var N=U,v=C;if(v==null)return 0;for(var f=0,_=(M=>{var Y,L=[];for(Y in M)L.push(Y);return Object.getOwnPropertySymbols&&(M=Object.getOwnPropertySymbols(M),Array.prototype.push.apply(L,M)),L})(v),b=0;b<_.length;b++){var y=_[b];if(typeof v[y]=="object"&&v[y]!==null){if(N.has(v[y]))continue;N.add(v[y])}f+=G(N)(y);try{f+=G(N)(v[y])}catch(M){M instanceof RangeError&&(f=0)}}return f;default:return 0}}}Ne.exports=function(U){return G(new WeakSet)(U)}},function(Ne,W){Ne.exports={STRING:2,BOOLEAN:4,NUMBER:8}},function(Ne,W,Q){(function(se){var J=Q(35),G=Q(36),U=Q(37);function C(){return v.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function N(ee,ae){if(C()<ae)throw new RangeError("Invalid typed array length");return v.TYPED_ARRAY_SUPPORT?(ee=new Uint8Array(ae)).__proto__=v.prototype:(ee=ee===null?new v(ae):ee).length=ae,ee}function v(ee,ae,xe){if(!(v.TYPED_ARRAY_SUPPORT||this instanceof v))return new v(ee,ae,xe);if(typeof ee!="number")return f(this,ee,ae,xe);if(typeof ae=="string")throw new Error("If encoding is specified then the first argument must be a string");return b(this,ee)}function f(ee,ae,xe,Z){if(typeof ae=="number")throw new TypeError('"value" argument must not be a number');if(typeof ArrayBuffer<"u"&&ae instanceof ArrayBuffer){var $=ee,K=ae,X=xe;if(X<0||K.byteLength<X)throw new RangeError("'offset' is out of bounds");if(K.byteLength<X+(Z||0))throw new RangeError("'length' is out of bounds");return K=X===void 0&&Z===void 0?new Uint8Array(K):Z===void 0?new Uint8Array(K,X):new Uint8Array(K,X,Z),v.TYPED_ARRAY_SUPPORT?($=K).__proto__=v.prototype:$=y($,K),$}if(typeof ae!="string"){if(X=ee,v.isBuffer(Z=ae))return(X=N(X,K=0|M(Z.length))).length!==0&&Z.copy(X,0,0,K),X;if(Z){if(typeof ArrayBuffer<"u"&&Z.buffer instanceof ArrayBuffer||"length"in Z)return typeof Z.length!="number"||(K=Z.length)!=K?N(X,0):y(X,Z);if(Z.type==="Buffer"&&U(Z.data))return y(X,Z.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}if($=ee,Z=ae,v.isEncoding(ee=typeof(ee=xe)=="string"&&ee!==""?ee:"utf8"))return(Z=($=N($,ae=0|Y(Z,ee))).write(Z,ee))!==ae?$.slice(0,Z):$;throw new TypeError('"encoding" must be a valid string encoding')}function _(ee){if(typeof ee!="number")throw new TypeError('"size" argument must be a number');if(ee<0)throw new RangeError('"size" argument must not be negative')}function b(ee,ae){if(_(ae),ee=N(ee,ae<0?0:0|M(ae)),!v.TYPED_ARRAY_SUPPORT)for(var xe=0;xe<ae;++xe)ee[xe]=0;return ee}function y(ee,ae){var xe=ae.length<0?0:0|M(ae.length);ee=N(ee,xe);for(var Z=0;Z<xe;Z+=1)ee[Z]=255&ae[Z];return ee}function M(ee){if(C()<=ee)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+C().toString(16)+" bytes");return 0|ee}function Y(ee,ae){if(v.isBuffer(ee))return ee.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(ee)||ee instanceof ArrayBuffer))return ee.byteLength;var xe=(ee=typeof ee!="string"?""+ee:ee).length;if(xe===0)return 0;for(var Z=!1;;)switch(ae){case"ascii":case"latin1":case"binary":return xe;case"utf8":case"utf-8":case void 0:return te(ee).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*xe;case"hex":return xe>>>1;case"base64":return Ue(ee).length;default:if(Z)return te(ee).length;ae=(""+ae).toLowerCase(),Z=!0}}function L(ee,ae,xe){var Z=ee[ae];ee[ae]=ee[xe],ee[xe]=Z}function A(ee,ae,xe,Z,$){if(ee.length===0)return-1;if(typeof xe=="string"?(Z=xe,xe=0):2147483647<xe?xe=2147483647:xe<-2147483648&&(xe=-2147483648),xe=+xe,(xe=(xe=isNaN(xe)?$?0:ee.length-1:xe)<0?ee.length+xe:xe)>=ee.length){if($)return-1;xe=ee.length-1}else if(xe<0){if(!$)return-1;xe=0}if(typeof ae=="string"&&(ae=v.from(ae,Z)),v.isBuffer(ae))return ae.length===0?-1:H(ee,ae,xe,Z,$);if(typeof ae=="number")return ae&=255,v.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?($?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(ee,ae,xe):H(ee,[ae],xe,Z,$);throw new TypeError("val must be string, number or Buffer")}function H(ee,ae,xe,Z,$){var K=1,X=ee.length,B=ae.length;if(Z!==void 0&&((Z=String(Z).toLowerCase())==="ucs2"||Z==="ucs-2"||Z==="utf16le"||Z==="utf-16le")){if(ee.length<2||ae.length<2)return-1;X/=K=2,B/=2,xe/=2}function fe(D,me){return K===1?D[me]:D.readUInt16BE(me*K)}if($)for(var Ce=-1,Ze=xe;Ze<X;Ze++)if(fe(ee,Ze)===fe(ae,Ce===-1?0:Ze-Ce)){if(Ze-(Ce=Ce===-1?Ze:Ce)+1===B)return Ce*K}else Ce!==-1&&(Ze-=Ze-Ce),Ce=-1;else for(Ze=xe=X<xe+B?X-B:xe;0<=Ze;Ze--){for(var st=!0,Ie=0;Ie<B;Ie++)if(fe(ee,Ze+Ie)!==fe(ae,Ie)){st=!1;break}if(st)return Ze}return-1}function ge(ee,ae,xe,Z){return it(($=>{for(var K=[],X=0;X<$.length;++X)K.push(255&$.charCodeAt(X));return K})(ae),ee,xe,Z)}function Ee(ee,ae,xe){xe=Math.min(ee.length,xe);for(var Z=[],$=ae;$<xe;){var K,X,B,fe,Ce=ee[$],Ze=null,st=239<Ce?4:223<Ce?3:191<Ce?2:1;if($+st<=xe)switch(st){case 1:Ce<128&&(Ze=Ce);break;case 2:(192&(K=ee[$+1]))==128&&127<(fe=(31&Ce)<<6|63&K)&&(Ze=fe);break;case 3:X=ee[$+2],(192&(K=ee[$+1]))==128&&(192&X)==128&&2047<(fe=(15&Ce)<<12|(63&K)<<6|63&X)&&(fe<55296||57343<fe)&&(Ze=fe);break;case 4:X=ee[$+2],B=ee[$+3],(192&(K=ee[$+1]))==128&&(192&X)==128&&(192&B)==128&&65535<(fe=(15&Ce)<<18|(63&K)<<12|(63&X)<<6|63&B)&&fe<1114112&&(Ze=fe)}Ze===null?(Ze=65533,st=1):65535<Ze&&(Z.push((Ze-=65536)>>>10&1023|55296),Ze=56320|1023&Ze),Z.push(Ze),$+=st}var Ie=Z,D=Ie.length;if(D<=Se)return String.fromCharCode.apply(String,Ie);for(var me="",ce=0;ce<D;)me+=String.fromCharCode.apply(String,Ie.slice(ce,ce+=Se));return me}W.Buffer=v,W.SlowBuffer=function(ee){return v.alloc(+(ee=+ee!=ee?0:ee))},W.INSPECT_MAX_BYTES=50,v.TYPED_ARRAY_SUPPORT=se.TYPED_ARRAY_SUPPORT!==void 0?se.TYPED_ARRAY_SUPPORT:(()=>{try{var ee=new Uint8Array(1);return ee.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ee.foo()===42&&typeof ee.subarray=="function"&&ee.subarray(1,1).byteLength===0}catch{return!1}})(),W.kMaxLength=C(),v.poolSize=8192,v.ii=function(ee){return ee.__proto__=v.prototype,ee},v.from=function(ee,ae,xe){return f(null,ee,ae,xe)},v.TYPED_ARRAY_SUPPORT&&(v.prototype.__proto__=Uint8Array.prototype,v.__proto__=Uint8Array,typeof Symbol<"u")&&Symbol.species&&v[Symbol.species]===v&&Object.defineProperty(v,Symbol.species,{value:null,configurable:!0}),v.alloc=function(ee,ae,xe){return _(ee),ee<=0||ae===void 0?N(null,ee):typeof xe=="string"?N(null,ee).fill(ae,xe):N(null,ee).fill(ae)},v.allocUnsafe=function(ee){return b(null,ee)},v.allocUnsafeSlow=function(ee){return b(null,ee)},v.isBuffer=function(ee){return!(ee==null||!ee.ni)},v.compare=function(ee,ae){if(!v.isBuffer(ee)||!v.isBuffer(ae))throw new TypeError("Arguments must be Buffers");if(ee===ae)return 0;for(var xe=ee.length,Z=ae.length,$=0,K=Math.min(xe,Z);$<K;++$)if(ee[$]!==ae[$]){xe=ee[$],Z=ae[$];break}return xe<Z?-1:Z<xe?1:0},v.isEncoding=function(ee){switch(String(ee).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},v.concat=function(ee,ae){if(!U(ee))throw new TypeError('"list" argument must be an Array of Buffers');if(ee.length===0)return v.alloc(0);if(ae===void 0)for($=ae=0;$<ee.length;++$)ae+=ee[$].length;for(var xe=v.allocUnsafe(ae),Z=0,$=0;$<ee.length;++$){var K=ee[$];if(!v.isBuffer(K))throw new TypeError('"list" argument must be an Array of Buffers');K.copy(xe,Z),Z+=K.length}return xe},v.byteLength=Y,v.prototype.ni=!0,v.prototype.swap16=function(){var ee=this.length;if(ee%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var ae=0;ae<ee;ae+=2)L(this,ae,ae+1);return this},v.prototype.swap32=function(){var ee=this.length;if(ee%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var ae=0;ae<ee;ae+=4)L(this,ae,ae+3),L(this,ae+1,ae+2);return this},v.prototype.swap64=function(){var ee=this.length;if(ee%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var ae=0;ae<ee;ae+=8)L(this,ae,ae+7),L(this,ae+1,ae+6),L(this,ae+2,ae+5),L(this,ae+3,ae+4);return this},v.prototype.toString=function(){var ee=0|this.length;return ee==0?"":arguments.length===0?Ee(this,0,ee):(function(ae,xe,Z){var $,K,X=!1;if((xe=xe===void 0||xe<0?0:xe)>this.length||(Z=Z===void 0||Z>this.length?this.length:Z)<=0||(Z>>>=0)<=(xe>>>=0))return"";for(ae=ae||"utf8";;)switch(ae){case"hex":var B=Z,fe=this.length;(!B||B<0||fe<B)&&(B=fe);for(var Ce="",Ze=me=!(me=xe)||me<0?0:me;Ze<B;++Ze)Ce+=(K=this[Ze])<16?"0"+K.toString(16):K.toString(16);return Ce;case"utf8":case"utf-8":return Ee(this,xe,Z);case"ascii":fe=xe;for(var st=Z,Ie="",D=(st=Math.min(this.length,st),fe);D<st;++D)Ie+=String.fromCharCode(127&this[D]);return Ie;case"latin1":case"binary":for(var me=xe,ce=Z,le="",et=(ce=Math.min(this.length,ce),me);et<ce;++et)le+=String.fromCharCode(this[et]);return le;case"base64":return ze=this,$=Z,(ft=xe)===0&&$===ze.length?J.fromByteArray(ze):J.fromByteArray(ze.slice(ft,$));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var ze=xe,ft=Z,_t=this.slice(ze,ft),mt="",Ve=0;Ve<_t.length;Ve+=2)mt+=String.fromCharCode(_t[Ve]+256*_t[Ve+1]);return mt;default:if(X)throw new TypeError("Unknown encoding: "+ae);ae=(ae+"").toLowerCase(),X=!0}}).apply(this,arguments)},v.prototype.equals=function(ee){if(v.isBuffer(ee))return this===ee||v.compare(this,ee)===0;throw new TypeError("Argument must be a Buffer")},v.prototype.inspect=function(){var ee="",ae=W.INSPECT_MAX_BYTES;return 0<this.length&&(ee=this.toString("hex",0,ae).match(/.{2}/g).join(" "),this.length>ae)&&(ee+=" ... "),"<Buffer "+ee+">"},v.prototype.compare=function(ee,ae,xe,Z,$){if(!v.isBuffer(ee))throw new TypeError("Argument must be a Buffer");if(xe===void 0&&(xe=ee?ee.length:0),Z===void 0&&(Z=0),$===void 0&&($=this.length),(ae=ae===void 0?0:ae)<0||xe>ee.length||Z<0||$>this.length)throw new RangeError("out of range index");if($<=Z&&xe<=ae)return 0;if($<=Z)return-1;if(xe<=ae)return 1;if(this===ee)return 0;for(var K=($>>>=0)-(Z>>>=0),X=(xe>>>=0)-(ae>>>=0),B=Math.min(K,X),fe=this.slice(Z,$),Ce=ee.slice(ae,xe),Ze=0;Ze<B;++Ze)if(fe[Ze]!==Ce[Ze]){K=fe[Ze],X=Ce[Ze];break}return K<X?-1:X<K?1:0},v.prototype.includes=function(ee,ae,xe){return this.indexOf(ee,ae,xe)!==-1},v.prototype.indexOf=function(ee,ae,xe){return A(this,ee,ae,xe,!0)},v.prototype.lastIndexOf=function(ee,ae,xe){return A(this,ee,ae,xe,!1)},v.prototype.write=function(ee,ae,xe,Z){if(ae===void 0)Z="utf8",xe=this.length,ae=0;else if(xe===void 0&&typeof ae=="string")Z=ae,xe=this.length,ae=0;else{if(!isFinite(ae))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");ae|=0,isFinite(xe)?(xe|=0,Z===void 0&&(Z="utf8")):(Z=xe,xe=void 0)}var $=this.length-ae;if((xe===void 0||$<xe)&&(xe=$),0<ee.length&&(xe<0||ae<0)||ae>this.length)throw new RangeError("Attempt to write outside buffer bounds");Z=Z||"utf8";for(var K,X,B,fe,Ce,Ze=!1;;)switch(Z){case"hex":var st,Ie=ee,D=xe,me=(st=Number(ae)||0,this.length-st);if((!D||me<(D=Number(D)))&&(D=me),(me=Ie.length)%2!=0)throw new TypeError("Invalid hex string");me/2<D&&(D=me/2);for(var ce=0;ce<D;++ce){var le=parseInt(Ie.substr(2*ce,2),16);if(isNaN(le))return ce;this[st+ce]=le}return ce;case"utf8":case"utf-8":return X=xe,it(te(ee,(K=this).length-(me=ae)),K,me,X);case"ascii":case"latin1":case"binary":return ge(this,ee,ae,xe);case"base64":return K=this,X=ae,fe=xe,it(Ue(ee),K,X,fe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ce=xe,it(((et,ze)=>{for(var ft,_t,mt=[],Ve=0;Ve<et.length&&!((ze-=2)<0);++Ve)_t=(ft=et.charCodeAt(Ve))>>8,mt.push(ft%256),mt.push(_t);return mt})(ee,(B=this).length-(fe=ae)),B,fe,Ce);default:if(Ze)throw new TypeError("Unknown encoding: "+Z);Z=(""+Z).toLowerCase(),Ze=!0}},v.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Se=4096;function ue(ee,ae,xe){if(ee%1!=0||ee<0)throw new RangeError("offset is not uint");if(xe<ee+ae)throw new RangeError("Trying to access beyond buffer length")}function oe(ee,ae,xe,Z,$,K){if(!v.isBuffer(ee))throw new TypeError('"buffer" argument must be a Buffer instance');if($<ae||ae<K)throw new RangeError('"value" argument is out of bounds');if(xe+Z>ee.length)throw new RangeError("Index out of range")}function be(ee,ae,xe,Z){ae<0&&(ae=65535+ae+1);for(var $=0,K=Math.min(ee.length-xe,2);$<K;++$)ee[xe+$]=(ae&255<<8*(Z?$:1-$))>>>8*(Z?$:1-$)}function Le(ee,ae,xe,Z){ae<0&&(ae=4294967295+ae+1);for(var $=0,K=Math.min(ee.length-xe,4);$<K;++$)ee[xe+$]=ae>>>8*(Z?$:3-$)&255}function pe(ee,ae,xe,Z){if(xe+Z>ee.length)throw new RangeError("Index out of range");if(xe<0)throw new RangeError("Index out of range")}function k(ee,ae,xe,Z,$){return $||pe(ee,0,xe,4),G.write(ee,ae,xe,Z,23,4),xe+4}function R(ee,ae,xe,Z,$){return $||pe(ee,0,xe,8),G.write(ee,ae,xe,Z,52,8),xe+8}v.prototype.slice=function(ee,ae){var xe=this.length;if((ee=~~ee)<0?(ee+=xe)<0&&(ee=0):xe<ee&&(ee=xe),(ae=ae===void 0?xe:~~ae)<0?(ae+=xe)<0&&(ae=0):xe<ae&&(ae=xe),ae<ee&&(ae=ee),v.TYPED_ARRAY_SUPPORT)($=this.subarray(ee,ae)).__proto__=v.prototype;else for(var Z=ae-ee,$=new v(Z,void 0),K=0;K<Z;++K)$[K]=this[K+ee];return $},v.prototype.readUIntLE=function(ee,ae,xe){ee|=0,ae|=0,xe||ue(ee,ae,this.length);for(var Z=this[ee],$=1,K=0;++K<ae&&($*=256);)Z+=this[ee+K]*$;return Z},v.prototype.readUIntBE=function(ee,ae,xe){ee|=0,ae|=0,xe||ue(ee,ae,this.length);for(var Z=this[ee+--ae],$=1;0<ae&&($*=256);)Z+=this[ee+--ae]*$;return Z},v.prototype.readUInt8=function(ee,ae){return ae||ue(ee,1,this.length),this[ee]},v.prototype.readUInt16LE=function(ee,ae){return ae||ue(ee,2,this.length),this[ee]|this[ee+1]<<8},v.prototype.readUInt16BE=function(ee,ae){return ae||ue(ee,2,this.length),this[ee]<<8|this[ee+1]},v.prototype.readUInt32LE=function(ee,ae){return ae||ue(ee,4,this.length),(this[ee]|this[ee+1]<<8|this[ee+2]<<16)+16777216*this[ee+3]},v.prototype.readUInt32BE=function(ee,ae){return ae||ue(ee,4,this.length),16777216*this[ee]+(this[ee+1]<<16|this[ee+2]<<8|this[ee+3])},v.prototype.readIntLE=function(ee,ae,xe){ee|=0,ae|=0,xe||ue(ee,ae,this.length);for(var Z=this[ee],$=1,K=0;++K<ae&&($*=256);)Z+=this[ee+K]*$;return($*=128)<=Z&&(Z-=Math.pow(2,8*ae)),Z},v.prototype.readIntBE=function(ee,ae,xe){ee|=0,ae|=0,xe||ue(ee,ae,this.length);for(var Z=ae,$=1,K=this[ee+--Z];0<Z&&($*=256);)K+=this[ee+--Z]*$;return($*=128)<=K&&(K-=Math.pow(2,8*ae)),K},v.prototype.readInt8=function(ee,ae){return ae||ue(ee,1,this.length),128&this[ee]?-1*(255-this[ee]+1):this[ee]},v.prototype.readInt16LE=function(ee,ae){return ae||ue(ee,2,this.length),32768&(ae=this[ee]|this[ee+1]<<8)?4294901760|ae:ae},v.prototype.readInt16BE=function(ee,ae){return ae||ue(ee,2,this.length),32768&(ae=this[ee+1]|this[ee]<<8)?4294901760|ae:ae},v.prototype.readInt32LE=function(ee,ae){return ae||ue(ee,4,this.length),this[ee]|this[ee+1]<<8|this[ee+2]<<16|this[ee+3]<<24},v.prototype.readInt32BE=function(ee,ae){return ae||ue(ee,4,this.length),this[ee]<<24|this[ee+1]<<16|this[ee+2]<<8|this[ee+3]},v.prototype.readFloatLE=function(ee,ae){return ae||ue(ee,4,this.length),G.read(this,ee,!0,23,4)},v.prototype.readFloatBE=function(ee,ae){return ae||ue(ee,4,this.length),G.read(this,ee,!1,23,4)},v.prototype.readDoubleLE=function(ee,ae){return ae||ue(ee,8,this.length),G.read(this,ee,!0,52,8)},v.prototype.readDoubleBE=function(ee,ae){return ae||ue(ee,8,this.length),G.read(this,ee,!1,52,8)},v.prototype.writeUIntLE=function(ee,ae,xe,Z){ee=+ee,ae|=0,xe|=0,Z||oe(this,ee,ae,xe,Math.pow(2,8*xe)-1,0);var $=1,K=0;for(this[ae]=255&ee;++K<xe&&($*=256);)this[ae+K]=ee/$&255;return ae+xe},v.prototype.writeUIntBE=function(ee,ae,xe,Z){ee=+ee,ae|=0,xe|=0,Z||oe(this,ee,ae,xe,Math.pow(2,8*xe)-1,0);var $=xe-1,K=1;for(this[ae+$]=255&ee;0<=--$&&(K*=256);)this[ae+$]=ee/K&255;return ae+xe},v.prototype.writeUInt8=function(ee,ae,xe){return ee=+ee,ae|=0,xe||oe(this,ee,ae,1,255,0),v.TYPED_ARRAY_SUPPORT||(ee=Math.floor(ee)),this[ae]=255&ee,ae+1},v.prototype.writeUInt16LE=function(ee,ae,xe){return ee=+ee,ae|=0,xe||oe(this,ee,ae,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[ae]=255&ee,this[ae+1]=ee>>>8):be(this,ee,ae,!0),ae+2},v.prototype.writeUInt16BE=function(ee,ae,xe){return ee=+ee,ae|=0,xe||oe(this,ee,ae,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[ae]=ee>>>8,this[ae+1]=255&ee):be(this,ee,ae,!1),ae+2},v.prototype.writeUInt32LE=function(ee,ae,xe){return ee=+ee,ae|=0,xe||oe(this,ee,ae,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[ae+3]=ee>>>24,this[ae+2]=ee>>>16,this[ae+1]=ee>>>8,this[ae]=255&ee):Le(this,ee,ae,!0),ae+4},v.prototype.writeUInt32BE=function(ee,ae,xe){return ee=+ee,ae|=0,xe||oe(this,ee,ae,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[ae]=ee>>>24,this[ae+1]=ee>>>16,this[ae+2]=ee>>>8,this[ae+3]=255&ee):Le(this,ee,ae,!1),ae+4},v.prototype.writeIntLE=function(ee,ae,xe,Z){ee=+ee,ae|=0,Z||oe(this,ee,ae,xe,(Z=Math.pow(2,8*xe-1))-1,-Z);var $=0,K=1,X=0;for(this[ae]=255&ee;++$<xe&&(K*=256);)ee<0&&X===0&&this[ae+$-1]!==0&&(X=1),this[ae+$]=(ee/K|0)-X&255;return ae+xe},v.prototype.writeIntBE=function(ee,ae,xe,Z){ee=+ee,ae|=0,Z||oe(this,ee,ae,xe,(Z=Math.pow(2,8*xe-1))-1,-Z);var $=xe-1,K=1,X=0;for(this[ae+$]=255&ee;0<=--$&&(K*=256);)ee<0&&X===0&&this[ae+$+1]!==0&&(X=1),this[ae+$]=(ee/K|0)-X&255;return ae+xe},v.prototype.writeInt8=function(ee,ae,xe){return ee=+ee,ae|=0,xe||oe(this,ee,ae,1,127,-128),v.TYPED_ARRAY_SUPPORT||(ee=Math.floor(ee)),this[ae]=255&(ee=ee<0?255+ee+1:ee),ae+1},v.prototype.writeInt16LE=function(ee,ae,xe){return ee=+ee,ae|=0,xe||oe(this,ee,ae,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[ae]=255&ee,this[ae+1]=ee>>>8):be(this,ee,ae,!0),ae+2},v.prototype.writeInt16BE=function(ee,ae,xe){return ee=+ee,ae|=0,xe||oe(this,ee,ae,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[ae]=ee>>>8,this[ae+1]=255&ee):be(this,ee,ae,!1),ae+2},v.prototype.writeInt32LE=function(ee,ae,xe){return ee=+ee,ae|=0,xe||oe(this,ee,ae,4,2147483647,-2147483648),v.TYPED_ARRAY_SUPPORT?(this[ae]=255&ee,this[ae+1]=ee>>>8,this[ae+2]=ee>>>16,this[ae+3]=ee>>>24):Le(this,ee,ae,!0),ae+4},v.prototype.writeInt32BE=function(ee,ae,xe){return ee=+ee,ae|=0,xe||oe(this,ee,ae,4,2147483647,-2147483648),ee<0&&(ee=4294967295+ee+1),v.TYPED_ARRAY_SUPPORT?(this[ae]=ee>>>24,this[ae+1]=ee>>>16,this[ae+2]=ee>>>8,this[ae+3]=255&ee):Le(this,ee,ae,!1),ae+4},v.prototype.writeFloatLE=function(ee,ae,xe){return k(this,ee,ae,!0,xe)},v.prototype.writeFloatBE=function(ee,ae,xe){return k(this,ee,ae,!1,xe)},v.prototype.writeDoubleLE=function(ee,ae,xe){return R(this,ee,ae,!0,xe)},v.prototype.writeDoubleBE=function(ee,ae,xe){return R(this,ee,ae,!1,xe)},v.prototype.copy=function(ee,ae,xe,Z){if(xe=xe||0,Z||Z===0||(Z=this.length),ae>=ee.length&&(ae=ee.length),(Z=0<Z&&Z<xe?xe:Z)===xe||ee.length===0||this.length===0)return 0;if((ae=ae||0)<0)throw new RangeError("targetStart out of bounds");if(xe<0||xe>=this.length)throw new RangeError("sourceStart out of bounds");if(Z<0)throw new RangeError("sourceEnd out of bounds");Z>this.length&&(Z=this.length);var $,K=(Z=ee.length-ae<Z-xe?ee.length-ae+xe:Z)-xe;if(this===ee&&xe<ae&&ae<Z)for($=K-1;0<=$;--$)ee[$+ae]=this[$+xe];else if(K<1e3||!v.TYPED_ARRAY_SUPPORT)for($=0;$<K;++$)ee[$+ae]=this[$+xe];else Uint8Array.prototype.set.call(ee,this.subarray(xe,xe+K),ae);return K},v.prototype.fill=function(ee,ae,xe,Z){if(typeof ee=="string"){var $;if(typeof ae=="string"?(Z=ae,ae=0,xe=this.length):typeof xe=="string"&&(Z=xe,xe=this.length),ee.length===1&&($=ee.charCodeAt(0))<256&&(ee=$),Z!==void 0&&typeof Z!="string")throw new TypeError("encoding must be a string");if(typeof Z=="string"&&!v.isEncoding(Z))throw new TypeError("Unknown encoding: "+Z)}else typeof ee=="number"&&(ee&=255);if(ae<0||this.length<ae||this.length<xe)throw new RangeError("Out of range index");if(!(xe<=ae))if(ae>>>=0,xe=xe===void 0?this.length:xe>>>0,typeof(ee=ee||0)=="number")for(B=ae;B<xe;++B)this[B]=ee;else for(var K=v.isBuffer(ee)?ee:te(new v(ee,Z).toString()),X=K.length,B=0;B<xe-ae;++B)this[B+ae]=K[B%X];return this};var Fe=/[^+\/0-9A-Za-z-_]/g;function te(ee,ae){ae=ae||1/0;for(var xe,Z=ee.length,$=null,K=[],X=0;X<Z;++X){if(55295<(xe=ee.charCodeAt(X))&&xe<57344){if(!$){if(56319<xe){-1<(ae-=3)&&K.push(239,191,189);continue}if(X+1===Z){-1<(ae-=3)&&K.push(239,191,189);continue}$=xe;continue}if(xe<56320){-1<(ae-=3)&&K.push(239,191,189),$=xe;continue}xe=65536+($-55296<<10|xe-56320)}else $&&-1<(ae-=3)&&K.push(239,191,189);if($=null,xe<128){if(--ae<0)break;K.push(xe)}else if(xe<2048){if((ae-=2)<0)break;K.push(xe>>6|192,63&xe|128)}else if(xe<65536){if((ae-=3)<0)break;K.push(xe>>12|224,xe>>6&63|128,63&xe|128)}else{if(!(xe<1114112))throw new Error("Invalid code point");if((ae-=4)<0)break;K.push(xe>>18|240,xe>>12&63|128,xe>>6&63|128,63&xe|128)}}return K}function Ue(ee){return J.toByteArray((ae=>{var xe;if((ae=((xe=ae).trim?xe.trim():xe.replace(/^\s+|\s+$/g,"")).replace(Fe,"")).length<2)return"";for(;ae.length%4!=0;)ae+="=";return ae})(ee))}function it(ee,ae,xe,Z){for(var $=0;$<Z&&!($+xe>=ae.length||$>=ee.length);++$)ae[$+xe]=ee[$];return $}}).call(this,Q(34))},function(Ne,W){var Q=function(){return this}();try{Q=Q||new Function("return this")()}catch{typeof window=="object"&&(Q=window)}Ne.exports=Q},function(Ne,W,Q){W.byteLength=function(f){return 3*((f=v(f))[0]+(f=f[1]))/4-f},W.toByteArray=function(f){for(var _,b=v(f),y=b[0],M=new G(3*(y+(b=b[1]))/4-b),Y=0,L=0<b?y-4:y,A=0;A<L;A+=4)_=J[f.charCodeAt(A)]<<18|J[f.charCodeAt(A+1)]<<12|J[f.charCodeAt(A+2)]<<6|J[f.charCodeAt(A+3)],M[Y++]=_>>16&255,M[Y++]=_>>8&255,M[Y++]=255&_;return b===2&&(_=J[f.charCodeAt(A)]<<2|J[f.charCodeAt(A+1)]>>4,M[Y++]=255&_),b===1&&(_=J[f.charCodeAt(A)]<<10|J[f.charCodeAt(A+1)]<<4|J[f.charCodeAt(A+2)]>>2,M[Y++]=_>>8&255,M[Y++]=255&_),M},W.fromByteArray=function(f){for(var _,b=f.length,y=b%3,M=[],Y=0,L=b-y;Y<L;Y+=16383)M.push(((A,H)=>{for(var ge,Ee=[],Se=Y;Se<H;Se+=3)Ee.push(se[(ge=(A[Se]<<16&16711680)+(A[Se+1]<<8&65280)+(255&A[Se+2]))>>18&63]+se[ge>>12&63]+se[ge>>6&63]+se[63&ge]);return Ee.join("")})(f,L<Y+16383?L:Y+16383));return y==1?M.push(se[(_=f[b-1])>>2]+se[_<<4&63]+"=="):y==2&&M.push(se[(_=(f[b-2]<<8)+f[b-1])>>10]+se[_>>4&63]+se[_<<2&63]+"="),M.join("")};for(var se=[],J=[],G=typeof Uint8Array<"u"?Uint8Array:Array,U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",C=0,N=U.length;C<N;++C)se[C]=U[C],J[U.charCodeAt(C)]=C;function v(f){var _=f.length;if(0<_%4)throw new Error("Invalid string. Length must be a multiple of 4");return _=(f=(f=f.indexOf("="))===-1?_:f)===_?0:4-f%4,[f,_]}J["-".charCodeAt(0)]=62,J["_".charCodeAt(0)]=63},function(Ne,W){W.read=function(Q,se,J,G,U){var C,N,v=8*U-G-1,f=(1<<v)-1,_=f>>1,b=-7,y=J?U-1:0,M=J?-1:1;for(U=Q[se+y],y+=M,C=U&(1<<-b)-1,U>>=-b,b+=v;0<b;C=256*C+Q[se+y],y+=M,b-=8);for(N=C&(1<<-b)-1,C>>=-b,b+=G;0<b;N=256*N+Q[se+y],y+=M,b-=8);if(C===0)C=1-_;else{if(C===f)return N?NaN:1/0*(U?-1:1);N+=Math.pow(2,G),C-=_}return(U?-1:1)*N*Math.pow(2,C-G)},W.write=function(Q,se,J,G,U,C){var N,v,f=8*C-U-1,_=(1<<f)-1,b=_>>1,y=U===23?Math.pow(2,-24)-Math.pow(2,-77):0,M=G?0:C-1,Y=G?1:-1;for(C=se<0||se===0&&1/se<0?1:0,se=Math.abs(se),isNaN(se)||se===1/0?(v=isNaN(se)?1:0,N=_):(N=Math.floor(Math.log(se)/Math.LN2),se*(G=Math.pow(2,-N))<1&&(N--,G*=2),2<=(se+=1<=N+b?y/G:y*Math.pow(2,1-b))*G&&(N++,G/=2),_<=N+b?(v=0,N=_):1<=N+b?(v=(se*G-1)*Math.pow(2,U),N+=b):(v=se*Math.pow(2,b-1)*Math.pow(2,U),N=0));8<=U;Q[J+M]=255&v,M+=Y,v/=256,U-=8);for(N=N<<U|v,f+=U;0<f;Q[J+M]=255&N,M+=Y,N/=256,f-=8);Q[J+M-Y]|=128*C}},function(Ne,W){var Q={}.toString;Ne.exports=Array.isArray||function(se){return Q.call(se)=="[object Array]"}},function(Ne,W,Q){var se=this&&this.__read||function(N,v){var f=typeof Symbol=="function"&&N[Symbol.iterator];if(!f)return N;var _,b,y=f.call(N),M=[];try{for(;(v===void 0||0<v--)&&!(_=y.next()).done;)M.push(_.value)}catch(Y){b={error:Y}}finally{try{_&&!_.done&&(f=y.return)&&f.call(y)}finally{if(b)throw b.error}}return M},J=this&&this.__spread||function(){for(var N=[],v=0;v<arguments.length;v++)N=N.concat(se(arguments[v]));return N},G=(Object.defineProperty(W,"u",{value:!0}),W.PendingQueue=void 0,Q(0)),U=Q(5);function C(N,v,f,_){var b=this;this.ri=N,this.gt=v,this.Zt=f,this.H=_,this.byteLength=0,this.size=0,this.pendingDataSize=0,this.cacheMap=new Map,N.forEach(function(y){b.cacheMap.set(y,new G.Queue)})}C.prototype.enqueue=function(N,v){(v=this.cacheMap.get(v))&&!v.all().find(function(f){return f.content==N.content})&&(v.enqueue(N),v=U.calculateMemSize(N.content),this.pendingDataSize+=v,this.size++,this.Zt.totalAvailCache-=v,this.enCallback)&&this.enCallback(this.byteLength,this.size,this.pendingDataSize)},C.prototype.dequeue=function(N){return N=(N=this.cacheMap.get(N))==null?void 0:N.dequeue(),this.size--,this.deCallback&&this.deCallback(),N},C.prototype.findInQueue=function(N){var v=(v=this.cacheMap.get(N.level))==null?void 0:v.all();return v==null?void 0:v.find(function(f){return f.key===N.key})},C.prototype.readReportData=function(N){var v=J(this.cacheMap.entries());return v=this.readData(v,N,!0),this.reset(),{totalLen:v.totalLen,reportDataArr:v.resArr}},C.prototype.readStoreData=function(N){N=Math.ceil(this.pendingDataSize*N);var v=J(this.cacheMap.entries()).reverse();return v=this.readData(v,N,!1),this.refresh(v.totalLen),{totalLen:v.totalLen,storeArr:v.resArr}},C.prototype.readData=function(N,v,f){var _=[],b=0;e:for(var y=0;y<N.length;y++)for(var M=se(N[y],2),Y=M[0],L=M[1];L.size();){var A=this.dequeue(Y);if(_.push(A),v<(b+=U.calculateMemSize(A.content)))break e}return{totalLen:b,resArr:_}},C.prototype.decodeReportData=function(N){var v=this;N.forEach(function(f){v.enqueue(f,f.level)})},C.prototype.setListener=function(N){this.enCallback=N.enCallback,this.deCallback=N.deCallback},C.prototype.getPendingDataInfo=function(){return{pendingDataSize:this.pendingDataSize,size:this.size}},C.prototype.refresh=function(N){this.pendingDataSize-=N,this.Zt.totalAvailCache+=N},C.prototype.reset=function(){this.byteLength=0},W.PendingQueue=C},function(Ne,W,Q){var se=this&&this.__awaiter||function(C,N,v,f){return new(v=v||Promise)(function(_,b){function y(L){try{Y(f.next(L))}catch(A){b(A)}}function M(L){try{Y(f.throw(L))}catch(A){b(A)}}function Y(L){var A;L.done?_(L.value):((A=L.value)instanceof v?A:new v(function(H){H(A)})).then(y,M)}Y((f=f.apply(C,N||[])).next())})},J=this&&this.__generator||function(C,N){var v,f,_,b={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]},y={next:M(0),throw:M(1),return:M(2)};return typeof Symbol=="function"&&(y[Symbol.iterator]=function(){return this}),y;function M(Y){return function(L){var A=[Y,L];if(v)throw new TypeError("Generator is already executing.");for(;b;)try{if(v=1,f&&(_=2&A[0]?f.return:A[0]?f.throw||((_=f.return)&&_.call(f),0):f.next)&&!(_=_.call(f,A[1])).done)return _;switch(f=0,(A=_?[2&A[0],_.value]:A)[0]){case 0:case 1:_=A;break;case 4:return b.label++,{value:A[1],done:!1};case 5:b.label++,f=A[1],A=[0];continue;case 7:A=b.ops.pop(),b.trys.pop();continue;default:if(!(_=0<(_=b.trys).length&&_[_.length-1])&&(A[0]===6||A[0]===2)){b=0;continue}if(A[0]===3&&(!_||A[1]>_[0]&&A[1]<_[3]))b.label=A[1];else if(A[0]===6&&b.label<_[1])b.label=_[1],_=A;else{if(!(_&&b.label<_[2])){_[2]&&b.ops.pop(),b.trys.pop();continue}b.label=_[2],b.ops.push(A)}}A=N.call(C,b)}catch(H){A=[6,H],f=0}finally{v=_=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}},G=(Object.defineProperty(W,"u",{value:!0}),W.loadJS=void 0,Q(40));function U(C,N,v){return(C=G.decrypt(C,N))&&G.hashMd5(C)===v?C:""}W.loadJS=function(C,N,v,f,_,b,y){var M=this;return new Promise(function(Y,L){return se(M,void 0,void 0,function(){var A,H,ge,Ee,Se;return J(this,function(ue){switch(ue.label){case 0:if(A="dy",C)return[3,7];ue.label=1;case 1:return ue.trys.push([1,5,,6]),[4,N.getItem("code")];case 2:return H=ue.sent(),[4,N.getItem("key")];case 3:return ge=ue.sent(),[4,N.getItem("hash")];case 4:Ee=ue.sent();var oe=U(H,ge,Ee)||b,be=A,Le=y,pe=document.getElementsByTagName("HEAD").item(0),k=document.createElement("script");k.language="javascript",k.type="text/javascript",k.id=be,k.param=Le;try{k.appendChild(document.createTextNode(oe))}catch{k.text=oe}return pe.appendChild(k),Y(),[3,6];case 5:return ue.sent(),L(),[3,6];case 6:return[2];case 7:if(window.ActiveXObject)try{Se=new ActiveXObject("Msxml2.XMLHTTP")}catch{Se=new ActiveXObject("Microsoft.XMLHTTP")}else window.XMLHttpRequest&&(Se=new XMLHttpRequest);return Se.open("GET",v,!0),Se.send(null),Se.onreadystatechange=function(){return se(this,void 0,void 0,function(){return J(this,function(R){switch(R.label){case 0:if(Se.readyState!=4)return[3,10];if(!(200<=Se.status&&Se.status<300||Se.status==0||Se.status==304))return[3,8];R.label=1;case 1:return R.trys.push([1,6,,7]),U(Se.responseText,f,_)?[4,N.setItem("code",Se.responseText)]:[3,5];case 2:return R.sent(),[4,N.setItem("key",f)];case 3:return R.sent(),[4,N.setItem("hash",_)];case 4:R.sent(),R.label=5;case 5:return Y(),[3,7];case 6:return R.sent(),L(),[3,7];case 7:return[2];case 8:return L(),[2];case 9:return[3,11];case 10:case 11:return[2]}})})},[2]}})})})}},function(Ne,W,Q){var se=this&&this.__importDefault||function(C){return C&&C.u?C:{default:C}},J=(Object.defineProperty(W,"u",{value:!0}),W.hashMd5=W.decrypt=void 0,se(Q(41))),G=se(Q(42)),U=se(Q(43));W.decrypt=function(C,N){var v="";try{v=G.default.decrypt(C,N).toString(U.default)}catch{}return v},W.hashMd5=function(C){return J.default(C).toString()}},function(Ne,W){Ne.exports=w},function(Ne,W){Ne.exports=Re},function(Ne,W){Ne.exports=we},function(Ne,W,Q){function se(){this.logLevel=W.ENUM_LOG_LEVEL.DISABLE}Object.defineProperty(W,"u",{value:!0}),W.ZegoLog=W.ENUM_LOG_LEVEL=void 0,W.ENUM_LOG_LEVEL={DEBUG:0,INFO:1,WARN:2,ERROR:3,REPORT:99,DISABLE:100,debug:0,info:1,warn:2,error:3,report:99,disable:100},se.prototype.setLogLevel=function(J){return(J=W.ENUM_LOG_LEVEL[J])!==void 0&&(this.logLevel=J,!0)},se.prototype.debug=function(){for(var J=[],G=0;G<arguments.length;G++)J[G]=arguments[G];var U=J.join(" ");this.logLevel!==W.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=W.ENUM_LOG_LEVEL.DEBUG&&console.debug(U)},se.prototype.log=function(){for(var J=[],G=0;G<arguments.length;G++)J[G]=arguments[G];var U=J.join(" ");this.logLevel!==W.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=W.ENUM_LOG_LEVEL.INFO&&console.log(U)},se.prototype.info=function(){for(var J=[],G=0;G<arguments.length;G++)J[G]=arguments[G];var U=J.join(" ");this.logLevel!==W.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=W.ENUM_LOG_LEVEL.INFO&&console.info(U)},se.prototype.warn=function(){for(var J=[],G=0;G<arguments.length;G++)J[G]=arguments[G];var U=J.join(" ");this.logLevel!==W.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=W.ENUM_LOG_LEVEL.WARN&&console.warn(U)},se.prototype.error=function(){for(var J=[],G=0;G<arguments.length;G++)J[G]=arguments[G];var U=J.join(" ");this.logLevel!==W.ENUM_LOG_LEVEL.DISABLE&&this.logLevel<=W.ENUM_LOG_LEVEL.ERROR&&console.error(U)},W.ZegoLog=se},function(Ne,W,Q){function se(J){this.keepLive=!0,this.logger=J,this.W=J}Object.defineProperty(W,"u",{value:!0}),W.StateCenter=void 0,se.prototype.isLogin=function(){return!0},W.StateCenter=se},function(Ne,W,Q){var se=this&&this.__read||function(C,N){var v=typeof Symbol=="function"&&C[Symbol.iterator];if(!v)return C;var f,_,b=v.call(C),y=[];try{for(;(N===void 0||0<N--)&&!(f=b.next()).done;)y.push(f.value)}catch(M){_={error:M}}finally{try{f&&!f.done&&(v=b.return)&&v.call(b)}finally{if(_)throw _.error}}return y},J=this&&this.__spread||function(){for(var C=[],N=0;N<arguments.length;N++)C=C.concat(se(arguments[N]));return C},G=(Object.defineProperty(W,"u",{value:!0}),W.DynamicCode=void 0,Q(3));function U(){this.init()}U.prototype.init=function(){window.dyObj={}},U.prototype.runExecution=function(C,N,v){C=new(Function.bind.apply(Function,J([void 0],C,[v])));try{C.apply(void 0,J(N))}catch(f){G.log.error(f)}},W.DynamicCode=U}],nt={},he.m=Me,he.c=nt,he.d=function(Ne,W,Q){he.o(Ne,W)||Object.defineProperty(Ne,W,{enumerable:!0,get:Q})},he.r=function(Ne){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Ne,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Ne,"u",{value:!0})},he.t=function(Ne,W){if(1&W&&(Ne=he(Ne)),8&W||4&W&&typeof Ne=="object"&&Ne&&Ne.u)return Ne;var Q=Object.create(null);if(he.r(Q),Object.defineProperty(Q,"default",{enumerable:!0,value:Ne}),2&W&&typeof Ne!="string")for(var se in Ne)he.d(Q,se,(function(J){return Ne[J]}).bind(null,se));return Q},he.n=function(Ne){var W=Ne&&Ne.u?function(){return Ne.default}:function(){return Ne};return he.d(W,"a",W),W},he.o=function(Ne,W){return Object.prototype.hasOwnProperty.call(Ne,W)},he.p="",he(he.s=14);function he(Ne){var W;return(nt[Ne]||(W=nt[Ne]={i:Ne,l:!1,exports:{}},Me[Ne].call(W.exports,W,W.exports,he),W.l=!0,W)).exports}var Me,nt}(Te(6361),Te(4636),Te(955),Te(5178))},955:function(It,Ye,Te){var E;It.exports=(E=Te(9021),Te(754),Te(4636),Te(9506),Te(7165),function(){var w=E,Re=w.lib.BlockCipher,we=w.algo,he=[],Me=[],nt=[],Ne=[],W=[],Q=[],se=[],J=[],G=[],U=[];(function(){for(var v=[],f=0;f<256;f++)v[f]=f<128?f<<1:f<<1^283;var _=0,b=0;for(f=0;f<256;f++){var y=b^b<<1^b<<2^b<<3^b<<4;he[_]=y=y>>>8^255&y^99,Me[y]=_;var M,Y=v[_],L=v[Y],A=v[L];nt[_]=(M=257*v[y]^16843008*y)<<24|M>>>8,Ne[_]=M<<16|M>>>16,W[_]=M<<8|M>>>24,Q[_]=M,se[y]=(M=16843009*A^65537*L^257*Y^16843008*_)<<24|M>>>8,J[y]=M<<16|M>>>16,G[y]=M<<8|M>>>24,U[y]=M,_?(_=Y^v[v[v[A^Y]]],b^=v[v[b]]):_=b=1}})();var C=[0,1,2,4,8,16,32,64,128,27,54],N=we.AES=Re.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var v=this._keyPriorReset=this._key,f=v.words,_=v.sigBytes/4,b=4*((this._nRounds=_+6)+1),y=this._keySchedule=[],M=0;M<b;M++)M<_?y[M]=f[M]:(A=y[M-1],M%_?_>6&&M%_==4&&(A=he[A>>>24]<<24|he[A>>>16&255]<<16|he[A>>>8&255]<<8|he[255&A]):(A=he[(A=A<<8|A>>>24)>>>24]<<24|he[A>>>16&255]<<16|he[A>>>8&255]<<8|he[255&A],A^=C[M/_|0]<<24),y[M]=y[M-_]^A);for(var Y=this._invKeySchedule=[],L=0;L<b;L++){if(M=b-L,L%4)var A=y[M];else A=y[M-4];Y[L]=L<4||M<=4?A:se[he[A>>>24]]^J[he[A>>>16&255]]^G[he[A>>>8&255]]^U[he[255&A]]}}},encryptBlock:function(v,f){this._doCryptBlock(v,f,this._keySchedule,nt,Ne,W,Q,he)},decryptBlock:function(v,f){var _=v[f+1];v[f+1]=v[f+3],v[f+3]=_,this._doCryptBlock(v,f,this._invKeySchedule,se,J,G,U,Me),_=v[f+1],v[f+1]=v[f+3],v[f+3]=_},_doCryptBlock:function(v,f,_,b,y,M,Y,L){for(var A=this._nRounds,H=v[f]^_[0],ge=v[f+1]^_[1],Ee=v[f+2]^_[2],Se=v[f+3]^_[3],ue=4,oe=1;oe<A;oe++){var be=b[H>>>24]^y[ge>>>16&255]^M[Ee>>>8&255]^Y[255&Se]^_[ue++],Le=b[ge>>>24]^y[Ee>>>16&255]^M[Se>>>8&255]^Y[255&H]^_[ue++],pe=b[Ee>>>24]^y[Se>>>16&255]^M[H>>>8&255]^Y[255&ge]^_[ue++],k=b[Se>>>24]^y[H>>>16&255]^M[ge>>>8&255]^Y[255&Ee]^_[ue++];H=be,ge=Le,Ee=pe,Se=k}be=(L[H>>>24]<<24|L[ge>>>16&255]<<16|L[Ee>>>8&255]<<8|L[255&Se])^_[ue++],Le=(L[ge>>>24]<<24|L[Ee>>>16&255]<<16|L[Se>>>8&255]<<8|L[255&H])^_[ue++],pe=(L[Ee>>>24]<<24|L[Se>>>16&255]<<16|L[H>>>8&255]<<8|L[255&ge])^_[ue++],k=(L[Se>>>24]<<24|L[H>>>16&255]<<16|L[ge>>>8&255]<<8|L[255&Ee])^_[ue++],v[f]=be,v[f+1]=Le,v[f+2]=pe,v[f+3]=k},keySize:8});w.AES=Re._createHelper(N)}(),E.AES)},1025:function(It,Ye,Te){var E,w;It.exports=(E=Te(9021),w=E.enc.Utf8,void(E.algo.HMAC=E.lib.Base.extend({init:function(Re,we){Re=this._hasher=new Re.init,typeof we=="string"&&(we=w.parse(we));var he=Re.blockSize,Me=4*he;we.sigBytes>Me&&(we=Re.finalize(we)),we.clamp();for(var nt=this._oKey=we.clone(),Ne=this._iKey=we.clone(),W=nt.words,Q=Ne.words,se=0;se<he;se++)W[se]^=1549556828,Q[se]^=909522486;nt.sigBytes=Ne.sigBytes=Me,this.reset()},reset:function(){var Re=this._hasher;Re.reset(),Re.update(this._iKey)},update:function(Re){return this._hasher.update(Re),this},finalize:function(Re){var we=this._hasher,he=we.finalize(Re);return we.reset(),we.finalize(this._oKey.clone().concat(he))}})))},1290:function(It,Ye,Te){Te.d(Ye,{BBG:function(){return E},Bnp:function(){return Ue},BsE:function(){return Ve},CLV:function(){return an},CcO:function(){return B},E8q:function(){return ge},EPo:function(){return Jr},E_I:function(){return zn},Eb9:function(){return fr},Ehk:function(){return me},FGD:function(){return Zt},FSV:function(){return f},GV2:function(){return In},HGP:function(){return rn},HHW:function(){return Me},I2V:function(){return D},I8R:function(){return F},IGr:function(){return cn},IRO:function(){return P},ISq:function(){return nr},Ifp:function(){return xe},JFd:function(){return ui},JGn:function(){return ce},JX$:function(){return Lt},Jli:function(){return Z},K15:function(){return mt},K4A:function(){return W},K74:function(){return at},KBL:function(){return ye},KWc:function(){return Ee},KY4:function(){return C},Kw2:function(){return ii},LBe:function(){return We},La0:function(){return oe},Lji:function(){return ri},Loj:function(){return _t},M9m:function(){return _},MDS:function(){return jn},MSI:function(){return Ke},N$A:function(){return Cn},NYT:function(){return ot},Nw2:function(){return zr},O2K:function(){return R},OKY:function(){return H},OYv:function(){return Nt},Ox5:function(){return _r},Q4K:function(){return K},Q4y:function(){return Ln},Q9_:function(){return _n},QRg:function(){return ue},QU$:function(){return Ot},Qld:function(){return Ce},QpU:function(){return Tt},Qu8:function(){return L},R46:function(){return sr},RM$:function(){return De},Rbr:function(){return Vr},Rfl:function(){return Ie},RnN:function(){return Hr},SK:function(){return Ut},SKc:function(){return Ci},SPm:function(){return y},Szn:function(){return we},Tk2:function(){return de},TlX:function(){return An},Toj:function(){return Yr},UY3:function(){return Lr},V9q:function(){return J},VMq:function(){return te},VdQ:function(){return St},W0Q:function(){return Nn},W8t:function(){return Ai},WaK:function(){return Se},Wgj:function(){return w},WuQ:function(){return en},XLj:function(){return be},XO3:function(){return b},XQ0:function(){return Re},XR3:function(){return ft},Y9k:function(){return nn},YNv:function(){return T},YOg:function(){return dr},Ywv:function(){return kr},ZIe:function(){return v},Ze2:function(){return kn},_2$:function(){return Yn},_ny:function(){return Qe},aSL:function(){return fe},amU:function(){return Tn},aww:function(){return Si},b9b:function(){return Ze},bp1:function(){return Fr},bzn:function(){return tr},c2i:function(){return fn},cDv:function(){return Qn},cIs:function(){return Fn},cuT:function(){return Qr},d0o:function(){return le},d8C:function(){return st},d9R:function(){return Ae},de8:function(){return $},dk2:function(){return se},dnG:function(){return G},dw7:function(){return Jn},fcT:function(){return Rn},fgh:function(){return pe},fjj:function(){return or},fkL:function(){return Y},gPJ:function(){return Xe},gkP:function(){return nt},hkn:function(){return bn},iMZ:function(){return lt},ibZ:function(){return Kn},ifL:function(){return kt},it$:function(){return N},ivM:function(){return Ct},kEb:function(){return $e},kEs:function(){return Wr},kNG:function(){return z},kVV:function(){return Xr},kc8:function(){return U},kkS:function(){return ne},lWs:function(){return ee},mLk:function(){return he},mMR:function(){return Zn},msE:function(){return A},n9B:function(){return it},n9u:function(){return X},nkr:function(){return Sr},ny0:function(){return et},oLS:function(){return M},p1K:function(){return He},qPT:function(){return ze},rGc:function(){return Ne},rS5:function(){return k},rp8:function(){return yi},ruA:function(){return pr},s1U:function(){return Q},sk8:function(){return Bn},t6w:function(){return vn},u7D:function(){return mn},v$W:function(){return qr},vBC:function(){return Fe},wQ8:function(){return Rr},wT7:function(){return xn},x_Q:function(){return Yt},xcT:function(){return ve},xcY:function(){return Zr},y4U:function(){return ht},z3d:function(){return Le},zC0:function(){return ae},zUi:function(){return Dn},z_2:function(){return ir},zub:function(){return li}});var E="zc.0",w="zc.1",Re="zc.csr",we="zc.cs",he="zc.ds",Me="zc.hvc.0",nt="zc.sps.0",Ne="zc.sps.1",W="zc.sps.0.0",Q="zc.spsr.0.0",se="zc.sps.1.0",J="zc.spsr.1.0",G="zc.smsi.0",U="zc.opsu",C="zc.opur",N="zc.sao",v="zc.stoto",f="zc.psh.0",_="zc.psh.1",b="zc.tsh.rngn.0",y="zc.tsh.rngn.1",M="zc.tsh.dgnb",Y="zc.sc.al",L="zc.s.cmt",A="zc.s.sss",H="zsc.ssgn",ge="zsc.ccgl",Ee="zsc.ccns",Se="zsc.ucgl",ue="zc.p.0.sp.0",oe="zc.p.ps",be="zc.p.0.ocpss",Le="zc.p.cps.0",pe="zc.p.0.ocos",k="zc.p.0.oslds",R="zc.p.0.ogrd",Fe="zc.p.0.orpe",te="zc.p.0.orci.1",Ue="zc.p.0.oic",it="zc.p.0.ocsc",ee="zc.p.0.oicsc",ae="zc.p.0.rp",xe="zc.p.0.spqt",Z="zc.p.0.upq",$="zc.p.0.orrs",K="zc.p.0.orcs",X="zc.p.0.sci",B="zc.p.0.psr",fe="zc.p.0.sp.1",Ce="zc.p.0.od",Ze="zc.p.0.ssl.0",st="zc.p.0.ssl.1",Ie="zc.p.0.heb",D="zc.p.0.ss",me="zc.p.0.rgn",ce="zc.p.0.sgn",le="zc.p.0.hdgn",et="zc.p.0.sb.0",ze="zc.p.0.scd",ft="zc.p.0.scg",_t="zc.p.0.rsi",mt="zc.p.0.croic",Ve="zc.p.0.tc",Ot="zc.p.1.sp.0",rn="zc.p.ocpss.1",an="zc.p.cps.1",In="zc.p.hcsws.1",Tn="zc.p.ocos.1",fn="zc.p.oslds.1",Rr="zc.p.ormd.1",ir="zc.p.orpe.1",Ln="zc.p.orci.1.1",mn="zc.p.oic.1",Qn="zc.p.ocsc.1",Nn="zc.p.oicsc.1",or="zc.p.opcsc.1",pr="zc.p.rp.1",sr="zc.p.spqt.1",Wr="zc.p.upq.1",tr="zc.p.gs.1",zn="zc.p.orrs.1",bn="zc.p.orcs.1",Jn="zc.p.orss.1",zr="zc.p.ogrs.1",jn="zc.p.gvc",Lr="zc.p.sci.1",Vr="zc.p.psr.1",Ai="zc.p.1.sp.1",Yr="zc.p.od.1",Qr="zc.p.ssl.1",Ci="zc.p.ssl.1.1",Si="zc.p.1.nqi",ri="zc.p.1.rgn",fr="zc.p.1.sgn",Yn="zc.p.1.hdgn",yi="zc.p.1.scd",dr="zc.p.1.scg",ii="zc.p.1.oce",kn="zc.p.1.smsbpm",nr="zc.p.1.sms",Fn="zc.p.1.mst",_r="zc.p.1.spsf",P="zc.p.1.rsi",He="zc.p.1.croic",de="zc.uslq",ne="zc.sr.uud",De="zc.hpqd.pl",ye="zc.hpqd.pu",Qe="zc.hcid.pu",Ke="zc.sr.sd",$e="zc.sr.cisn",at="zc.sr.chdtr",ht="zc.sr.sprd",Ct="zc.sr.rrp.0",St="zc.sr.ccptr",kt="zc.sr.srptc.0",Ut="zc.sr.sct.0",Lt="zc.sr.csi.0",cn="zc.sr.cic.0",_n="zc.sr.cnia.0",vn="zc.p.scv",xn="zc.sh.msbss",An="zc.sh.ms",Zn="zc.sh.psl",Kn="zc.srs",Bn="zc.irs",Jr="zc.ssh",ui="zc.s.nqga",Zr="zc.ups.0",kr="zc.p.0.gqs",Fr="zc.p.1.gqs",qr="zc.crh.a.0",Sr="zc.ctcc.a.0",Dn="zc.hrh.smt.0",li="zc.hrh.smt.1",Hr="zc.hrh.grdbc",Xr="zc.vam.rv",z="zc.vam.iwg",T="zc.vam.vam",F="zc.svc",ve="zc.sac",Ae="zc.rp",We="zc.emo",Xe="zc.asi",ot="zc.mpsv.0",lt="zc.mpsa.0",Tt="zc.mm",Nt="zc.mpsv.1",Yt="zc.mpsa.1",Rn="zc.mapa.1",nn="zc.mapv.1",en="zc.at",Zt="zc.rt",Cn="zc.ht"},1350:function(It,Ye,Te){Te.d(Ye,{E:function(){return Re}});var E=function(we,he,Me,nt){return new(Me||(Me=Promise))(function(Ne,W){function Q(G){try{J(nt.next(G))}catch(U){W(U)}}function se(G){try{J(nt.throw(G))}catch(U){W(U)}}function J(G){var U;G.done?Ne(G.value):(U=G.value,U instanceof Me?U:new Me(function(C){C(U)})).then(Q,se)}J((nt=nt.apply(we,he||[])).next())})},w=function(we,he){var Me,nt,Ne,W,Q={label:0,sent:function(){if(1&Ne[0])throw Ne[1];return Ne[1]},trys:[],ops:[]};return W={next:se(0),throw:se(1),return:se(2)},typeof Symbol=="function"&&(W[Symbol.iterator]=function(){return this}),W;function se(J){return function(G){return function(U){if(Me)throw new TypeError("Generator is already executing.");for(;W&&(W=0,U[0]&&(Q=0)),Q;)try{if(Me=1,nt&&(Ne=2&U[0]?nt.return:U[0]?nt.throw||((Ne=nt.return)&&Ne.call(nt),0):nt.next)&&!(Ne=Ne.call(nt,U[1])).done)return Ne;switch(nt=0,Ne&&(U=[2&U[0],Ne.value]),U[0]){case 0:case 1:Ne=U;break;case 4:return Q.label++,{value:U[1],done:!1};case 5:Q.label++,nt=U[1],U=[0];continue;case 7:U=Q.ops.pop(),Q.trys.pop();continue;default:if(Ne=Q.trys,!((Ne=Ne.length>0&&Ne[Ne.length-1])||U[0]!==6&&U[0]!==2)){Q=0;continue}if(U[0]===3&&(!Ne||U[1]>Ne[0]&&U[1]<Ne[3])){Q.label=U[1];break}if(U[0]===6&&Q.label<Ne[1]){Q.label=Ne[1],Ne=U;break}if(Ne&&Q.label<Ne[2]){Q.label=Ne[2],Q.ops.push(U);break}Ne[2]&&Q.ops.pop(),Q.trys.pop();continue}U=he.call(we,Q)}catch(C){U=[6,C],nt=0}finally{Me=Ne=0}if(5&U[0])throw U[1];return{value:U[0]?U[1]:void 0,done:!0}}([J,G])}}},Re=function(){function we(){this.isFirstNode=!0,this.isLastNode=!0,this.hasAnother=!1}return we.prototype.connect=function(he){return E(this,void 0,void 0,function(){return w(this,function(Me){switch(Me.label){case 0:return this.next=he,this.output?[4,he.setInput(this.output)]:[3,2];case 1:Me.sent(),Me.label=2;case 2:return[2,he]}})})},we.prototype.disconnect=function(he){return E(this,void 0,void 0,function(){return w(this,function(Me){switch(Me.label){case 0:return this.next?[4,this.next.setInput(null,he)]:[3,2];case 1:Me.sent(),this.next=void 0,Me.label=2;case 2:return[2]}})})},we.prototype.setNodePos=function(he,Me,nt){he!==void 0&&(this.isFirstNode=he),Me!==void 0&&(this.isLastNode=Me),typeof nt=="boolean"&&(this.hasAnother=!nt)},we}()},2638:function(It,Ye,Te){Te.d(Ye,{Am:function(){return Ee},B7:function(){return k},B8:function(){return Z},Bl:function(){return Ue},D2:function(){return te},Dg:function(){return U},EA:function(){return Le},EN:function(){return ee},Es:function(){return ue},F1:function(){return he},FV:function(){return f},Hb:function(){return Ne},Kk:function(){return M},Ks:function(){return nt},LO:function(){return C},Lx:function(){return b},Mo:function(){return H},NI:function(){return be},NP:function(){return L},T_:function(){return Y},UP:function(){return pe},UV:function(){return Se},X5:function(){return G},Xb:function(){return J},ZV:function(){return y},b3:function(){return it},bD:function(){return we},d7:function(){return v},di:function(){return _},eZ:function(){return ae},ey:function(){return R},h7:function(){return xe},jZ:function(){return A},ku:function(){return oe},qP:function(){return Fe},qt:function(){return Re},t0:function(){return w.t0},uv:function(){return N},wN:function(){return ge},wl:function(){return X},xb:function(){return se}});var E,w=Te(3052),Re="3.11.0",we="2025-10-24 20:49:13",he=void 0;(function(B){B[B.debug=0]="debug",B[B.info=1]="info",B[B.warn=2]="warn",B[B.error=3]="error",B[B.report=99]="report",B[B.disable=100]="disable"})(E||(E={}));var Me,nt,Ne;(function(B){B[B.disable=0]="disable",B[B.websocket=1]="websocket",B[B.https=2]="https"})(Me||(Me={})),function(B){B[B.SDKProject_ZegoWebRTC=6]="SDKProject_ZegoWebRTC",B[B.SDKProject_ZegoMiniProgram=7]="SDKProject_ZegoMiniProgram"}(nt||(nt={})),function(B){B[B.UDP=0]="UDP",B[B.RTMP=1]="RTMP",B[B.FLV=2]="FLV",B[B.HLS=3]="HLS",B[B.WEBRTC=4]="WEBRTC"}(Ne||(Ne={}));var W,Q,se={disconnected:0,connecting:1,connected:2},J=1,G=2,U=3,C=256,N=1024,v=1e3,f=1,_=50,b=1,y=3600,M=52e6,Y={waiting_url:1,tryPublish:2,update_info:3,publishing:4,stop:5,retryPublish:6},L={liveNone:0,liveBegin:2001,liveEnd:2002,liveUpdate:2003},A=101,H=(W=1,function(){return W++}),ge=function(){var B=1;return function(){return B++}}();(function(B){B[B.ClientType_None=0]="ClientType_None",B[B.ClientType_H5=1]="ClientType_H5",B[B.ClientType_SmallPragram=2]="ClientType_SmallPragram",B[B.ClientType_Webrtc=3]="ClientType_Webrtc"})(Q||(Q={}));var Ee,Se,ue,oe,be,Le,pe,k,R,Fe,te,Ue,it,ee={added:12001,deleted:12002,updated:12003},ae={start:0,error:1,retry:2},xe={start:0,error:1,retry:2,stop:3};(function(B){B[B.Default=0]="Default",B[B.Extranet=1]="Extranet",B[B.Intranet=2]="Intranet"})(Ee||(Ee={})),function(B){B[B.logout=0]="logout",B[B.trylogin=1]="trylogin",B[B.login=2]="login"}(Se||(Se={})),function(B){B[B.logout=0]="logout",B[B.trylogin=1]="trylogin",B[B.login=2]="login",B[B.reconnect=3]="reconnect"}(ue||(ue={})),function(B){B[B.stop=0]="stop",B[B.start=1]="start"}(oe||(oe={})),function(B){B[B.CDN=0]="CDN",B[B.RTC=1]="RTC",B[B.L3=2]="L3",B[B.DG=3]="DG"}(be||(be={})),function(B){B[B.useAnalyzer=0]="useAnalyzer",B[B.useWorklet=1]="useWorklet"}(Le||(Le={})),function(B){B[B.Default=3]="Default",B[B.StandardVideoCall=4]="StandardVideoCall",B[B.HighVideoCall=5]="HighVideoCall",B[B.StandardChatroom=6]="StandardChatroom",B[B.HighQualityChatroom=7]="HighQualityChatroom",B[B.Broadcast=8]="Broadcast",B[B.Karaoke=9]="Karaoke",B[B.UNKNOWN=100]="UNKNOWN"}(pe||(pe={})),function(B){B.WIN32="WIN32",B.MAC="Mac",B.ANDROID="Android",B.LINUX="Linux",B.IOS="iOS",B.Harmony="Harmony",B.UNKNOWN="WTF"}(k||(k={})),function(B){B.CDN="cdn",B.L3="l3",B.RTC="rtc"}(R||(R={})),function(B){B[B.RTC=0]="RTC",B[B.CDN=1]="CDN",B[B.L3=2]="L3",B[B.DG=3]="DG",B[B.CUSTOM=5]="CUSTOM"}(Fe||(Fe={})),function(B){B[B.offline=0]="offline",B[B.online=1]="online"}(te||(te={})),function(B){B[B.MinQuality=0]="MinQuality",B[B.DieQuality=0]="DieQuality",B[B.PoorMinQuality=1]="PoorMinQuality",B[B.MiddleMinQuality=30]="MiddleMinQuality",B[B.GoodMinQuality=60]="GoodMinQuality",B[B.ExcellentMinQuality=85]="ExcellentMinQuality",B[B.MaxQuality=100]="MaxQuality"}(Ue||(Ue={})),function(B){B[B.Unknown=-1]="Unknown",B[B.Excellent=0]="Excellent",B[B.Good=1]="Good",B[B.Middle=2]="Middle",B[B.Poor=3]="Poor",B[B.Die=4]="Die"}(it||(it={}));var Z,$,K=function(){function B(fe,Ce){fe===void 0&&(fe=null),Ce===void 0&&(Ce=null),this.next=null,this.prev=null,this._id=fe,this._data=Ce}return Object.defineProperty(B.prototype,"id",{get:function(){return this._id?this._id:null},set:function(fe){this._id=fe},enumerable:!1,configurable:!0}),Object.defineProperty(B.prototype,"data",{get:function(){return this._data},set:function(fe){this._data=fe},enumerable:!1,configurable:!0}),B.prototype.hasNext=function(){return this.next&&this.next.id},B.prototype.hasPrev=function(){return this.prev&&this.prev.id},B}(),X=function(){function B(){this.start=new K,this.end=new K,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}return B.prototype.insertBefore=function(fe,Ce){var Ze=new K(this._idCounter,Ce);return Ze.next=fe,Ze.prev=fe.prev,fe.prev&&(fe.prev.next=Ze),fe.prev=Ze,++this._idCounter,++this._numNodes,Ze},B.prototype.addLast=function(fe){return this.insertBefore(this.end,fe)},B.prototype.add=function(fe){return this.addLast(fe)},B.prototype.getFirst=function(){return this._numNodes===0?null:this.start.next},B.prototype.getLast=function(){return this._numNodes===0?null:this.end.prev},B.prototype.size=function(){return this._numNodes},B.prototype.getFromFirst=function(fe){var Ce=0,Ze=this.start.next;if(fe>=0)for(;Ce<fe&&Ze!==null;)Ze=Ze.next,++Ce;else Ze=null;if(Ze===null)throw"Index out of bounds.";return Ze},B.prototype.get=function(fe){return fe===0?this.getFirst():fe===this._numNodes-1?this.getLast():this.getFromFirst(fe)},B.prototype.remove=function(fe){return fe.prev&&(fe.prev.next=fe.next),fe.next&&(fe.next.prev=fe.prev),--this._numNodes,fe},B.prototype.removeFirst=function(){var fe=null;return this._numNodes>0&&this.start.next&&(fe=this.remove(this.start.next)),fe},B.prototype.removeLast=function(){var fe=null;return this._numNodes>0&&this.end.prev&&(fe=this.remove(this.end.prev)),fe},B.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},B.prototype.each=function(fe){for(var Ce=this.start;Ce.hasNext();)fe(Ce=Ce.next)},B.prototype.find=function(fe){for(var Ce=this.start,Ze=!1,st=null;Ce.hasNext()&&!Ze;)fe(Ce=Ce.next)&&(st=Ce,Ze=!0);return st},B.prototype.map=function(fe){for(var Ce=this.start,Ze=[];Ce.hasNext();)fe(Ce=Ce.next)&&Ze.push(Ce);return Ze},B.prototype.push=function(fe){return this.addLast(fe)},B.prototype.unshift=function(fe){this.insertBefore(this._numNodes>0?this.start.next:this.end,fe)},B.prototype.pop=function(){return this.removeLast()},B.prototype.shift=function(){return this.removeFirst()},B}();(function(B){B.ONLY_BASELINE="only_baseline",B.HARD_SOFT_ENCODEC_FIRST="hard_or_soft_encodec_first",B.HIGH_PROFILE_FIRST="high_profile_first"})(Z||(Z={})),function(B){B[B.None=0]="None",B[B.Vocalist=1]="Vocalist",B[B.BackingSinging=2]="BackingSinging"}($||($={}))},2799:function(It,Ye,Te){var E;E=(w,Re)=>(()=>{var we={955:function(Ne,W,Q){var se;Ne.exports=(se=Q(21),Q(754),Q(636),Q(506),Q(165),function(){var J=se,G=J.lib.BlockCipher,U=J.algo,C=[],N=[],v=[],f=[],_=[],b=[],y=[],M=[],Y=[],L=[];(function(){for(var ge=[],Ee=0;Ee<256;Ee++)ge[Ee]=Ee<128?Ee<<1:Ee<<1^283;var Se=0,ue=0;for(Ee=0;Ee<256;Ee++){var oe=ue^ue<<1^ue<<2^ue<<3^ue<<4;C[Se]=oe=oe>>>8^255&oe^99,N[oe]=Se;var be=ge[Se],Le=ge[be],pe=ge[Le],k=257*ge[oe]^16843008*oe;v[Se]=k<<24|k>>>8,f[Se]=k<<16|k>>>16,_[Se]=k<<8|k>>>24,b[Se]=k,y[oe]=(k=16843009*pe^65537*Le^257*be^16843008*Se)<<24|k>>>8,M[oe]=k<<16|k>>>16,Y[oe]=k<<8|k>>>24,L[oe]=k,Se?(Se=be^ge[ge[ge[pe^be]]],ue^=ge[ge[ue]]):Se=ue=1}})();var A=[0,1,2,4,8,16,32,64,128,27,54],H=U.AES=G.extend({t:function(){if(!this.i||this.u!==this.h){for(var ge=this.u=this.h,Ee=ge.words,Se=ge.sigBytes/4,ue=4*((this.i=Se+6)+1),oe=this._=[],be=0;be<ue;be++)be<Se?oe[be]=Ee[be]:(k=oe[be-1],be%Se?Se>6&&be%Se==4&&(k=C[k>>>24]<<24|C[k>>>16&255]<<16|C[k>>>8&255]<<8|C[255&k]):(k=C[(k=k<<8|k>>>24)>>>24]<<24|C[k>>>16&255]<<16|C[k>>>8&255]<<8|C[255&k],k^=A[be/Se|0]<<24),oe[be]=oe[be-Se]^k);for(var Le=this.l=[],pe=0;pe<ue;pe++){if(be=ue-pe,pe%4)var k=oe[be];else k=oe[be-4];Le[pe]=pe<4||be<=4?k:y[C[k>>>24]]^M[C[k>>>16&255]]^Y[C[k>>>8&255]]^L[C[255&k]]}}},encryptBlock:function(ge,Ee){this.v(ge,Ee,this._,v,f,_,b,C)},decryptBlock:function(ge,Ee){var Se=ge[Ee+1];ge[Ee+1]=ge[Ee+3],ge[Ee+3]=Se,this.v(ge,Ee,this.l,y,M,Y,L,N),Se=ge[Ee+1],ge[Ee+1]=ge[Ee+3],ge[Ee+3]=Se},v:function(ge,Ee,Se,ue,oe,be,Le,pe){for(var k=this.i,R=ge[Ee]^Se[0],Fe=ge[Ee+1]^Se[1],te=ge[Ee+2]^Se[2],Ue=ge[Ee+3]^Se[3],it=4,ee=1;ee<k;ee++){var ae=ue[R>>>24]^oe[Fe>>>16&255]^be[te>>>8&255]^Le[255&Ue]^Se[it++],xe=ue[Fe>>>24]^oe[te>>>16&255]^be[Ue>>>8&255]^Le[255&R]^Se[it++],Z=ue[te>>>24]^oe[Ue>>>16&255]^be[R>>>8&255]^Le[255&Fe]^Se[it++],$=ue[Ue>>>24]^oe[R>>>16&255]^be[Fe>>>8&255]^Le[255&te]^Se[it++];R=ae,Fe=xe,te=Z,Ue=$}ae=(pe[R>>>24]<<24|pe[Fe>>>16&255]<<16|pe[te>>>8&255]<<8|pe[255&Ue])^Se[it++],xe=(pe[Fe>>>24]<<24|pe[te>>>16&255]<<16|pe[Ue>>>8&255]<<8|pe[255&R])^Se[it++],Z=(pe[te>>>24]<<24|pe[Ue>>>16&255]<<16|pe[R>>>8&255]<<8|pe[255&Fe])^Se[it++],$=(pe[Ue>>>24]<<24|pe[R>>>16&255]<<16|pe[Fe>>>8&255]<<8|pe[255&te])^Se[it++],ge[Ee]=ae,ge[Ee+1]=xe,ge[Ee+2]=Z,ge[Ee+3]=$},keySize:8});J.AES=G.p(H)}(),se.AES)},165:function(Ne,W,Q){var se;Ne.exports=(se=Q(21),Q(506),void(se.lib.Cipher||function(){var J=se,G=J.lib,U=G.Base,C=G.WordArray,N=G.BufferedBlockAlgorithm,v=J.enc,f=v.Base64,_=J.algo.EvpKDF,b=G.Cipher=N.extend({cfg:U.extend(),createEncryptor:function(ue,oe){return this.create(this.S,ue,oe)},createDecryptor:function(ue,oe){return this.create(this.T,ue,oe)},init:function(ue,oe,be){this.cfg=this.cfg.extend(be),this.C=ue,this.h=oe,this.reset()},reset:function(){N.reset.call(this),this.t()},process:function(ue){return this.m(ue),this.O()},finalize:function(ue){return ue&&this.m(ue),this.R()},keySize:4,ivSize:4,S:1,T:2,p:function(){function ue(oe){return typeof oe=="string"?Se:ge}return function(oe){return{encrypt:function(be,Le,pe){return ue(Le).encrypt(oe,be,Le,pe)},decrypt:function(be,Le,pe){return ue(Le).decrypt(oe,be,Le,pe)}}}}()}),y=(G.StreamCipher=b.extend({R:function(){return this.O(!0)},blockSize:1}),J.mode={}),M=G.BlockCipherMode=U.extend({createEncryptor:function(ue,oe){return this.Encryptor.create(ue,oe)},createDecryptor:function(ue,oe){return this.Decryptor.create(ue,oe)},init:function(ue,oe){this.A=ue,this.P=oe}}),Y=y.CBC=function(){var ue=M.extend();function oe(be,Le,pe){var k,R=this.P;R?(k=R,this.P=void 0):k=this.I;for(var Fe=0;Fe<pe;Fe++)be[Le+Fe]^=k[Fe]}return ue.Encryptor=ue.extend({processBlock:function(be,Le){var pe=this.A,k=pe.blockSize;oe.call(this,be,Le,k),pe.encryptBlock(be,Le),this.I=be.slice(Le,Le+k)}}),ue.Decryptor=ue.extend({processBlock:function(be,Le){var pe=this.A,k=pe.blockSize,R=be.slice(Le,Le+k);pe.decryptBlock(be,Le),oe.call(this,be,Le,k),this.I=R}}),ue}(),L=(J.pad={}).Pkcs7={pad:function(ue,oe){for(var be=4*oe,Le=be-ue.sigBytes%be,pe=Le<<24|Le<<16|Le<<8|Le,k=[],R=0;R<Le;R+=4)k.push(pe);var Fe=C.create(k,Le);ue.concat(Fe)},unpad:function(ue){ue.sigBytes-=255&ue.words[ue.sigBytes-1>>>2]}},A=(G.BlockCipher=b.extend({cfg:b.cfg.extend({mode:Y,padding:L}),reset:function(){var ue;b.reset.call(this);var oe=this.cfg,be=oe.iv,Le=oe.mode;this.C==this.S?ue=Le.createEncryptor:(ue=Le.createDecryptor,this.N=1),this.D&&this.D.M==ue?this.D.init(this,be&&be.words):(this.D=ue.call(Le,this,be&&be.words),this.D.M=ue)},H:function(ue,oe){this.D.processBlock(ue,oe)},R:function(){var ue,oe=this.cfg.padding;return this.C==this.S?(oe.pad(this.U,this.blockSize),ue=this.O(!0)):(ue=this.O(!0),oe.unpad(ue)),ue},blockSize:4}),G.CipherParams=U.extend({init:function(ue){this.mixIn(ue)},toString:function(ue){return(ue||this.formatter).stringify(this)}})),H=(J.format={}).OpenSSL={stringify:function(ue){var oe=ue.ciphertext,be=ue.salt;return(be?C.create([1398893684,1701076831]).concat(be).concat(oe):oe).toString(f)},parse:function(ue){var oe,be=f.parse(ue),Le=be.words;return Le[0]==1398893684&&Le[1]==1701076831&&(oe=C.create(Le.slice(2,4)),Le.splice(0,4),be.sigBytes-=16),A.create({ciphertext:be,salt:oe})}},ge=G.SerializableCipher=U.extend({cfg:U.extend({format:H}),encrypt:function(ue,oe,be,Le){Le=this.cfg.extend(Le);var pe=ue.createEncryptor(be,Le),k=pe.finalize(oe),R=pe.cfg;return A.create({ciphertext:k,key:be,iv:R.iv,algorithm:ue,mode:R.mode,padding:R.padding,blockSize:ue.blockSize,formatter:Le.format})},decrypt:function(ue,oe,be,Le){return Le=this.cfg.extend(Le),oe=this.G(oe,Le.format),ue.createDecryptor(be,Le).finalize(oe.ciphertext)},G:function(ue,oe){return typeof ue=="string"?oe.parse(ue,this):ue}}),Ee=(J.kdf={}).OpenSSL={execute:function(ue,oe,be,Le){Le||(Le=C.random(8));var pe=_.create({keySize:oe+be}).compute(ue,Le),k=C.create(pe.words.slice(oe),4*be);return pe.sigBytes=4*oe,A.create({key:pe,iv:k,salt:Le})}},Se=G.PasswordBasedCipher=ge.extend({cfg:ge.cfg.extend({kdf:Ee}),encrypt:function(ue,oe,be,Le){var pe=(Le=this.cfg.extend(Le)).kdf.execute(be,ue.keySize,ue.ivSize);Le.iv=pe.iv;var k=ge.encrypt.call(this,ue,oe,pe.key,Le);return k.mixIn(pe),k},decrypt:function(ue,oe,be,Le){Le=this.cfg.extend(Le),oe=this.G(oe,Le.format);var pe=Le.kdf.execute(be,ue.keySize,ue.ivSize,oe.salt);return Le.iv=pe.iv,ge.decrypt.call(this,ue,oe,pe.key,Le)}})}()))},21:function(Ne,W,Q){var se;Ne.exports=(se=se||function(J){var G;if(typeof window<"u"&&window.crypto&&(G=window.crypto),typeof self<"u"&&self.crypto&&(G=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(G=globalThis.crypto),!G&&typeof window<"u"&&window.msCrypto&&(G=window.msCrypto),!G&&Q.g!==void 0&&Q.g.crypto&&(G=Q.g.crypto),!G)try{G=Q(477)}catch{}var U=function(){if(G){if(typeof G.getRandomValues=="function")try{return G.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof G.randomBytes=="function")try{return G.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||function(){function H(){}return function(ge){var Ee;return H.prototype=ge,Ee=new H,H.prototype=null,Ee}}(),N={},v=N.lib={},f=v.Base={extend:function(H){var ge=C(this);return H&&ge.mixIn(H),ge.hasOwnProperty("init")&&this.init!==ge.init||(ge.init=function(){ge.$super.init.apply(this,arguments)}),ge.init.prototype=ge,ge.$super=this,ge},create:function(){var H=this.extend();return H.init.apply(H,arguments),H},init:function(){},mixIn:function(H){for(var ge in H)H.hasOwnProperty(ge)&&(this[ge]=H[ge]);H.hasOwnProperty("toString")&&(this.toString=H.toString)},clone:function(){return this.init.prototype.extend(this)}},_=v.WordArray=f.extend({init:function(H,ge){H=this.words=H||[],this.sigBytes=ge??4*H.length},toString:function(H){return(H||y).stringify(this)},concat:function(H){var ge=this.words,Ee=H.words,Se=this.sigBytes,ue=H.sigBytes;if(this.clamp(),Se%4)for(var oe=0;oe<ue;oe++)ge[Se+oe>>>2]|=(Ee[oe>>>2]>>>24-oe%4*8&255)<<24-(Se+oe)%4*8;else for(var be=0;be<ue;be+=4)ge[Se+be>>>2]=Ee[be>>>2];return this.sigBytes+=ue,this},clamp:function(){var H=this.words,ge=this.sigBytes;H[ge>>>2]&=4294967295<<32-ge%4*8,H.length=J.ceil(ge/4)},clone:function(){var H=f.clone.call(this);return H.words=this.words.slice(0),H},random:function(H){for(var ge=[],Ee=0;Ee<H;Ee+=4)ge.push(U());return new _.init(ge,H)}}),b=N.enc={},y=b.Hex={stringify:function(H){for(var ge=H.words,Ee=H.sigBytes,Se=[],ue=0;ue<Ee;ue++){var oe=ge[ue>>>2]>>>24-ue%4*8&255;Se.push((oe>>>4).toString(16)),Se.push((15&oe).toString(16))}return Se.join("")},parse:function(H){for(var ge=H.length,Ee=[],Se=0;Se<ge;Se+=2)Ee[Se>>>3]|=parseInt(H.substr(Se,2),16)<<24-Se%8*4;return new _.init(Ee,ge/2)}},M=b.Latin1={stringify:function(H){for(var ge=H.words,Ee=H.sigBytes,Se=[],ue=0;ue<Ee;ue++)Se.push(String.fromCharCode(ge[ue>>>2]>>>24-ue%4*8&255));return Se.join("")},parse:function(H){for(var ge=H.length,Ee=[],Se=0;Se<ge;Se++)Ee[Se>>>2]|=(255&H.charCodeAt(Se))<<24-Se%4*8;return new _.init(Ee,ge)}},Y=b.Utf8={stringify:function(H){try{return decodeURIComponent(escape(M.stringify(H)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(H){return M.parse(unescape(encodeURIComponent(H)))}},L=v.BufferedBlockAlgorithm=f.extend({reset:function(){this.U=new _.init,this.k=0},m:function(H){typeof H=="string"&&(H=Y.parse(H)),this.U.concat(H),this.k+=H.sigBytes},O:function(H){var ge,Ee=this.U,Se=Ee.words,ue=Ee.sigBytes,oe=this.blockSize,be=ue/(4*oe),Le=(be=H?J.ceil(be):J.max((0|be)-this.N,0))*oe,pe=J.min(4*Le,ue);if(Le){for(var k=0;k<Le;k+=oe)this.H(Se,k);ge=Se.splice(0,Le),Ee.sigBytes-=pe}return new _.init(ge,pe)},clone:function(){var H=f.clone.call(this);return H.U=this.U.clone(),H},N:0}),A=(v.Hasher=L.extend({cfg:f.extend(),init:function(H){this.cfg=this.cfg.extend(H),this.reset()},reset:function(){L.reset.call(this),this.t()},update:function(H){return this.m(H),this.O(),this},finalize:function(H){return H&&this.m(H),this.R()},blockSize:16,p:function(H){return function(ge,Ee){return new H.init(Ee).finalize(ge)}},V:function(H){return function(ge,Ee){return new A.HMAC.init(H,Ee).finalize(ge)}}}),N.algo={});return N}(Math),se)},754:function(Ne,W,Q){var se;Ne.exports=(se=Q(21),function(){var J=se.lib.WordArray;function G(U,C,N){for(var v=[],f=0,_=0;_<C;_++)if(_%4){var b=N[U.charCodeAt(_-1)]<<_%4*2|N[U.charCodeAt(_)]>>>6-_%4*2;v[f>>>2]|=b<<24-f%4*8,f++}return J.create(v,f)}se.enc.Base64={stringify:function(U){var C=U.words,N=U.sigBytes,v=this.B;U.clamp();for(var f=[],_=0;_<N;_+=3)for(var b=(C[_>>>2]>>>24-_%4*8&255)<<16|(C[_+1>>>2]>>>24-(_+1)%4*8&255)<<8|C[_+2>>>2]>>>24-(_+2)%4*8&255,y=0;y<4&&_+.75*y<N;y++)f.push(v.charAt(b>>>6*(3-y)&63));var M=v.charAt(64);if(M)for(;f.length%4;)f.push(M);return f.join("")},parse:function(U){var C=U.length,N=this.B,v=this.Y;if(!v){v=this.Y=[];for(var f=0;f<N.length;f++)v[N.charCodeAt(f)]=f}var _=N.charAt(64);if(_){var b=U.indexOf(_);b!==-1&&(C=b)}return G(U,C,v)},B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),se.enc.Base64)},178:function(Ne,W,Q){Ne.exports=Q(21).enc.Utf8},506:function(Ne,W,Q){var se,J,G,U,C,N,v;Ne.exports=(v=Q(21),Q(471),Q(25),J=(se=v).lib,U=J.WordArray,N=(C=se.algo).EvpKDF=(G=J.Base).extend({cfg:G.extend({keySize:4,hasher:C.MD5,iterations:1}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,_){for(var b,y=this.cfg,M=y.hasher.create(),Y=U.create(),L=Y.words,A=y.keySize,H=y.iterations;L.length<A;){b&&M.update(b),b=M.update(f).finalize(_),M.reset();for(var ge=1;ge<H;ge++)b=M.finalize(b),M.reset();Y.concat(b)}return Y.sigBytes=4*A,Y}}),se.EvpKDF=function(f,_,b){return N.create(b).compute(f,_)},v.EvpKDF)},25:function(Ne,W,Q){var se,J,G;Ne.exports=(J=(se=Q(21)).lib.Base,G=se.enc.Utf8,void(se.algo.HMAC=J.extend({init:function(U,C){U=this.L=new U.init,typeof C=="string"&&(C=G.parse(C));var N=U.blockSize,v=4*N;C.sigBytes>v&&(C=U.finalize(C)),C.clamp();for(var f=this.j=C.clone(),_=this.q=C.clone(),b=f.words,y=_.words,M=0;M<N;M++)b[M]^=1549556828,y[M]^=909522486;f.sigBytes=_.sigBytes=v,this.reset()},reset:function(){var U=this.L;U.reset(),U.update(this.q)},update:function(U){return this.L.update(U),this},finalize:function(U){var C=this.L,N=C.finalize(U);return C.reset(),C.finalize(this.j.clone().concat(N))}})))},636:function(Ne,W,Q){var se;Ne.exports=(se=Q(21),function(J){var G=se,U=G.lib,C=U.WordArray,N=U.Hasher,v=G.algo,f=[];(function(){for(var L=0;L<64;L++)f[L]=4294967296*J.abs(J.sin(L+1))|0})();var _=v.MD5=N.extend({t:function(){this.F=new C.init([1732584193,4023233417,2562383102,271733878])},H:function(L,A){for(var H=0;H<16;H++){var ge=A+H,Ee=L[ge];L[ge]=16711935&(Ee<<8|Ee>>>24)|4278255360&(Ee<<24|Ee>>>8)}var Se=this.F.words,ue=L[A+0],oe=L[A+1],be=L[A+2],Le=L[A+3],pe=L[A+4],k=L[A+5],R=L[A+6],Fe=L[A+7],te=L[A+8],Ue=L[A+9],it=L[A+10],ee=L[A+11],ae=L[A+12],xe=L[A+13],Z=L[A+14],$=L[A+15],K=Se[0],X=Se[1],B=Se[2],fe=Se[3];K=b(K,X,B,fe,ue,7,f[0]),fe=b(fe,K,X,B,oe,12,f[1]),B=b(B,fe,K,X,be,17,f[2]),X=b(X,B,fe,K,Le,22,f[3]),K=b(K,X,B,fe,pe,7,f[4]),fe=b(fe,K,X,B,k,12,f[5]),B=b(B,fe,K,X,R,17,f[6]),X=b(X,B,fe,K,Fe,22,f[7]),K=b(K,X,B,fe,te,7,f[8]),fe=b(fe,K,X,B,Ue,12,f[9]),B=b(B,fe,K,X,it,17,f[10]),X=b(X,B,fe,K,ee,22,f[11]),K=b(K,X,B,fe,ae,7,f[12]),fe=b(fe,K,X,B,xe,12,f[13]),B=b(B,fe,K,X,Z,17,f[14]),K=y(K,X=b(X,B,fe,K,$,22,f[15]),B,fe,oe,5,f[16]),fe=y(fe,K,X,B,R,9,f[17]),B=y(B,fe,K,X,ee,14,f[18]),X=y(X,B,fe,K,ue,20,f[19]),K=y(K,X,B,fe,k,5,f[20]),fe=y(fe,K,X,B,it,9,f[21]),B=y(B,fe,K,X,$,14,f[22]),X=y(X,B,fe,K,pe,20,f[23]),K=y(K,X,B,fe,Ue,5,f[24]),fe=y(fe,K,X,B,Z,9,f[25]),B=y(B,fe,K,X,Le,14,f[26]),X=y(X,B,fe,K,te,20,f[27]),K=y(K,X,B,fe,xe,5,f[28]),fe=y(fe,K,X,B,be,9,f[29]),B=y(B,fe,K,X,Fe,14,f[30]),K=M(K,X=y(X,B,fe,K,ae,20,f[31]),B,fe,k,4,f[32]),fe=M(fe,K,X,B,te,11,f[33]),B=M(B,fe,K,X,ee,16,f[34]),X=M(X,B,fe,K,Z,23,f[35]),K=M(K,X,B,fe,oe,4,f[36]),fe=M(fe,K,X,B,pe,11,f[37]),B=M(B,fe,K,X,Fe,16,f[38]),X=M(X,B,fe,K,it,23,f[39]),K=M(K,X,B,fe,xe,4,f[40]),fe=M(fe,K,X,B,ue,11,f[41]),B=M(B,fe,K,X,Le,16,f[42]),X=M(X,B,fe,K,R,23,f[43]),K=M(K,X,B,fe,Ue,4,f[44]),fe=M(fe,K,X,B,ae,11,f[45]),B=M(B,fe,K,X,$,16,f[46]),K=Y(K,X=M(X,B,fe,K,be,23,f[47]),B,fe,ue,6,f[48]),fe=Y(fe,K,X,B,Fe,10,f[49]),B=Y(B,fe,K,X,Z,15,f[50]),X=Y(X,B,fe,K,k,21,f[51]),K=Y(K,X,B,fe,ae,6,f[52]),fe=Y(fe,K,X,B,Le,10,f[53]),B=Y(B,fe,K,X,it,15,f[54]),X=Y(X,B,fe,K,oe,21,f[55]),K=Y(K,X,B,fe,te,6,f[56]),fe=Y(fe,K,X,B,$,10,f[57]),B=Y(B,fe,K,X,R,15,f[58]),X=Y(X,B,fe,K,xe,21,f[59]),K=Y(K,X,B,fe,pe,6,f[60]),fe=Y(fe,K,X,B,ee,10,f[61]),B=Y(B,fe,K,X,be,15,f[62]),X=Y(X,B,fe,K,Ue,21,f[63]),Se[0]=Se[0]+K|0,Se[1]=Se[1]+X|0,Se[2]=Se[2]+B|0,Se[3]=Se[3]+fe|0},R:function(){var L=this.U,A=L.words,H=8*this.k,ge=8*L.sigBytes;A[ge>>>5]|=128<<24-ge%32;var Ee=J.floor(H/4294967296),Se=H;A[15+(ge+64>>>9<<4)]=16711935&(Ee<<8|Ee>>>24)|4278255360&(Ee<<24|Ee>>>8),A[14+(ge+64>>>9<<4)]=16711935&(Se<<8|Se>>>24)|4278255360&(Se<<24|Se>>>8),L.sigBytes=4*(A.length+1),this.O();for(var ue=this.F,oe=ue.words,be=0;be<4;be++){var Le=oe[be];oe[be]=16711935&(Le<<8|Le>>>24)|4278255360&(Le<<24|Le>>>8)}return ue},clone:function(){var L=N.clone.call(this);return L.F=this.F.clone(),L}});function b(L,A,H,ge,Ee,Se,ue){var oe=L+(A&H|~A&ge)+Ee+ue;return(oe<<Se|oe>>>32-Se)+A}function y(L,A,H,ge,Ee,Se,ue){var oe=L+(A&ge|H&~ge)+Ee+ue;return(oe<<Se|oe>>>32-Se)+A}function M(L,A,H,ge,Ee,Se,ue){var oe=L+(A^H^ge)+Ee+ue;return(oe<<Se|oe>>>32-Se)+A}function Y(L,A,H,ge,Ee,Se,ue){var oe=L+(H^(A|~ge))+Ee+ue;return(oe<<Se|oe>>>32-Se)+A}G.MD5=N.p(_),G.HmacMD5=N.V(_)}(Math),se.MD5)},471:function(Ne,W,Q){var se,J,G,U,C,N,v;Ne.exports=(J=(se=v=Q(21)).lib,G=J.WordArray,C=[],N=se.algo.SHA1=(U=J.Hasher).extend({t:function(){this.F=new G.init([1732584193,4023233417,2562383102,271733878,3285377520])},H:function(f,_){for(var b=this.F.words,y=b[0],M=b[1],Y=b[2],L=b[3],A=b[4],H=0;H<80;H++){if(H<16)C[H]=0|f[_+H];else{var ge=C[H-3]^C[H-8]^C[H-14]^C[H-16];C[H]=ge<<1|ge>>>31}var Ee=(y<<5|y>>>27)+A+C[H];Ee+=H<20?1518500249+(M&Y|~M&L):H<40?1859775393+(M^Y^L):H<60?(M&Y|M&L|Y&L)-1894007588:(M^Y^L)-899497514,A=L,L=Y,Y=M<<30|M>>>2,M=y,y=Ee}b[0]=b[0]+y|0,b[1]=b[1]+M|0,b[2]=b[2]+Y|0,b[3]=b[3]+L|0,b[4]=b[4]+A|0},R:function(){var f=this.U,_=f.words,b=8*this.k,y=8*f.sigBytes;return _[y>>>5]|=128<<24-y%32,_[14+(y+64>>>9<<4)]=Math.floor(b/4294967296),_[15+(y+64>>>9<<4)]=b,f.sigBytes=4*_.length,this.O(),this.F},clone:function(){var f=U.clone.call(this);return f.F=this.F.clone(),f}}),se.SHA1=U.p(N),se.HmacSHA1=U.V(N),v.SHA1)},994:Ne=>{Ne.exports=w},788:Ne=>{Ne.exports=Re},477:()=>{}},he={};function Me(Ne){var W=he[Ne];if(W!==void 0)return W.exports;var Q=he[Ne]={exports:{}};return we[Ne].call(Q.exports,Q,Q.exports,Me),Q.exports}Me.n=Ne=>{var W=Ne&&Ne.J?()=>Ne.default:()=>Ne;return Me.d(W,{a:W}),W},Me.d=(Ne,W)=>{for(var Q in W)Me.o(W,Q)&&!Me.o(Ne,Q)&&Object.defineProperty(Ne,Q,{enumerable:!0,get:W[Q]})},Me.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),Me.o=(Ne,W)=>Object.prototype.hasOwnProperty.call(Ne,W),Me.r=Ne=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Ne,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Ne,"J",{value:!0})};var nt={};return(()=>{var Ne,W,Q,se,J,G,U,C,N,v,f,_,b,y,M,Y,L,A,H;Me.r(nt),Me.d(nt,{BrokenType:()=>be,BusinessService:()=>y,ConnectedType:()=>oe,DisconnectedType:()=>ue,Method:()=>Se,Mode:()=>Y,NET_ACCESS_CONFIG:()=>jn,NetAgentHttpRequest:()=>kr,NetAgentPCRequest:()=>An,ZegoConnectionAgent:()=>Xr}),function(z){z[z.Normal=0]="Normal",z[z.Private=1]="Private"}(Ne||(Ne={})),function(z){z[z.IPv4Only=0]="IPv4Only",z[z.IPv4Prefer=1]="IPv4Prefer",z[z.IPv6Prefer=2]="IPv6Prefer"}(W||(W={})),function(z){z[z.Default=0]="Default",z[z.Detail=1]="Detail"}(Q||(Q={})),function(z){z[z.IPv4=0]="IPv4",z[z.IPv6=1]="IPv6"}(se||(se={})),function(z){z[z.unreachable=0]="unreachable",z[z.unknown=1]="unknown",z[z.reachable=2]="reachable"}(J||(J={})),function(z){z[z.probed=0]="probed",z[z.noProbe=1]="noProbe",z[z.probing=2]="probing"}(G||(G={})),function(z){z[z.fail=0]="fail",z[z.connecting=1]="connecting",z[z.success=2]="success",z[z.timeout=3]="timeout"}(U||(U={})),function(z){z[z.WebSocket=0]="WebSocket",z[z.WebTransport=1]="WebTransport"}(C||(C={})),function(z){z[z.CONNECTING=0]="CONNECTING",z[z.OPEN=1]="OPEN",z[z.CLOSING=2]="CLOSING",z[z.CLOSED=3]="CLOSED"}(N||(N={})),function(z){z[z.offline=0]="offline",z[z.online=1]="online"}(v||(v={})),function(z){z[z.PB=0]="PB",z[z.JSON=1]="JSON"}(f||(f={})),function(z){z[z.MSG_TYPE_STREAM_CLOSED=2]="MSG_TYPE_STREAM_CLOSED",z[z.MSG_TYPE_CLOSE_CONNECTION=3]="MSG_TYPE_CLOSE_CONNECTION",z[z.MSG_TYPE_HTTP_REQUEST=4]="MSG_TYPE_HTTP_REQUEST",z[z.MSG_TYPE_HTTP_RESPONSE=5]="MSG_TYPE_HTTP_RESPONSE",z[z.MSG_TYPE_HB_REQUEST=12]="MSG_TYPE_HB_REQUEST",z[z.MSG_TYPE_HB_RESPONSE=13]="MSG_TYPE_HB_RESPONSE",z[z.MSG_TYPE_GET_CONFIG_REQUEST=14]="MSG_TYPE_GET_CONFIG_REQUEST",z[z.MSG_TYPE_GET_CONFIG_RESPONSE=15]="MSG_TYPE_GET_CONFIG_RESPONSE",z[z.MSG_TYPE_HTTP_REQUEST_ACK=16]="MSG_TYPE_HTTP_REQUEST_ACK",z[z.MSG_TYPE_PC_UPWARD_MESSAGE=17]="MSG_TYPE_PC_UPWARD_MESSAGE",z[z.MSG_TYPE_PC_UPWARD_MESSAGE_ACK=18]="MSG_TYPE_PC_UPWARD_MESSAGE_ACK",z[z.MSG_TYPE_PC_ESTABLISHED=19]="MSG_TYPE_PC_ESTABLISHED",z[z.MSG_TYPE_PC_BROKEN=20]="MSG_TYPE_PC_BROKEN",z[z.MSG_TYPE_PC_DOWNWARD_MESSAGE=21]="MSG_TYPE_PC_DOWNWARD_MESSAGE",z[z.MSG_TYPE_REDIRECT=22]="MSG_TYPE_REDIRECT",z[z.MSG_TYPE_GET_APPCONFIG_REQUEST=23]="MSG_TYPE_GET_APPCONFIG_REQUEST",z[z.MSG_TYPE_GET_APPCONFIG_RESPONSE=24]="MSG_TYPE_GET_APPCONFIG_RESPONSE",z[z.MSG_TYPE_PUSH_APPCONFIG=25]="MSG_TYPE_PUSH_APPCONFIG",z[z.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST=26]="MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST",z[z.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE=27]="MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE",z[z.MSG_TYPE_PUSH_EXCEPTION=30]="MSG_TYPE_PUSH_EXCEPTION",z[z.MSG_TYPE_HTTP_REQUEST2=33]="MSG_TYPE_HTTP_REQUEST2",z[z.MSG_TYPE_REDIRECT2=34]="MSG_TYPE_REDIRECT2",z[z.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2=35]="MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2",z[z.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE2=36]="MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE2",z[z.MSG_TYPE_GET_SVRADDR_REQUEST=39]="MSG_TYPE_GET_SVRADDR_REQUEST",z[z.MSG_TYPE_GET_SVRADDR_RESPONSE=40]="MSG_TYPE_GET_SVRADDR_RESPONSE"}(_||(_={})),function(z){z[z.ACCESSHUB_INVALID_FRAME=2e4]="ACCESSHUB_INVALID_FRAME",z[z.ACCESSHUB_NEED_ENCRYPT=20001]="ACCESSHUB_NEED_ENCRYPT",z[z.ACCESSHUB_DECRYPT=20002]="ACCESSHUB_DECRYPT",z[z.ACCESSHUB_MSGTYPE=20003]="ACCESSHUB_MSGTYPE",z[z.ACCESSHUB_UNMARSHAL=20004]="ACCESSHUB_UNMARSHAL",z[z.ACCESSHUB_TIMEOUT=20005]="ACCESSHUB_TIMEOUT",z[z.ACCESSHUB_CONNECT=20006]="ACCESSHUB_CONNECT",z[z.ACCESSHUB_BROKEN=20007]="ACCESSHUB_BROKEN",z[z.ACCESSHUB_INTERNAL_ERROR=20008]="ACCESSHUB_INTERNAL_ERROR",z[z.ACCESSHUB_MARSHAL=20009]="ACCESSHUB_MARSHAL",z[z.ACCESSHUB_UNSUPPORTED_SERVICE=20010]="ACCESSHUB_UNSUPPORTED_SERVICE",z[z.ACCESSHUB_TOO_FREQUENTLY=20011]="ACCESSHUB_TOO_FREQUENTLY",z[z.ACCESSHUB_INVALID_APPID=20012]="ACCESSHUB_INVALID_APPID",z[z.ACCESSHUB_HB_TIMEOUT=20013]="ACCESSHUB_HB_TIMEOUT",z[z.ACCESSHUB_INVALID_SIGNATURE=20014]="ACCESSHUB_INVALID_SIGNATURE"}(b||(b={})),function(z){z[z.SERVICE_UNSET=0]="SERVICE_UNSET",z[z.SERVICE_MEDIAGW=1]="SERVICE_MEDIAGW",z[z.SERVICE_LIVEROOM=2]="SERVICE_LIVEROOM",z[z.SERVICE_MIX=3]="SERVICE_MIX",z[z.SERVICE_ZEUS=4]="SERVICE_ZEUS",z[z.SERVICE_ZPUSH=5]="SERVICE_ZPUSH",z[z.SERVICE_L3=6]="SERVICE_L3",z[z.SERVICE_TALKLINE=7]="SERVICE_TALKLINE",z[z.SERVICE_EDUSUITE=8]="SERVICE_EDUSUITE",z[z.SERVICE_ZIM=9]="SERVICE_ZIM",z[z.SERVICE_ClOUD_SETTING=10]="SERVICE_ClOUD_SETTING",z[z.SERVICE_ZEUSHB=11]="SERVICE_ZEUSHB",z[z.SERVICE_USER_LOGIC=12]="SERVICE_USER_LOGIC",z[z.SERVICE_UNIFYDISPATCH=13]="SERVICE_UNIFYDISPATCH",z[z.SERVICE_QUALITY=14]="SERVICE_QUALITY",z[z.SERVICE_SECURITY=15]="SERVICE_SECURITY",z[z.SERVICE_KTVCPR=16]="SERVICE_KTVCPR",z[z.SERVICE_SWITCH4LIVEROOM=17]="SERVICE_SWITCH4LIVEROOM",z[z.SERVICE_WEBRTC_SIGNAL=18]="SERVICE_WEBRTC_SIGNAL",z[z.SERVICE_L3_WEBRTC_SIGNAL=19]="SERVICE_L3_WEBRTC_SIGNAL",z[z.SERVICE_VIDEOCPR=20]="SERVICE_VIDEOCPR",z[z.SERVICE_CDN=21]="SERVICE_CDN",z[z.SERVICE_CLOUDRECORD=22]="SERVICE_CLOUDRECORD",z[z.SERVICE_INNER_ECHO=23]="SERVICE_INNER_ECHO",z[z.SERVICE_OUTER_ECHO=24]="SERVICE_OUTER_ECHO",z[z.SERVICE_LOCALHOST_ECHO=25]="SERVICE_LOCALHOST_ECHO",z[z.SERVICE_ECHO=26]="SERVICE_ECHO",z[z.SERVICE_DOCSERVICE=27]="SERVICE_DOCSERVICE",z[z.SERVICE_AUTHSVR=28]="SERVICE_AUTHSVR"}(y||(y={})),function(z){z[z.ZEGOCONN_RUN_ENV_UNSET=0]="ZEGOCONN_RUN_ENV_UNSET",z[z.ZEGOCONN_RUN_ENV_BROWSER=1]="ZEGOCONN_RUN_ENV_BROWSER",z[z.ZEGOCONN_RUN_ENV_APPLET=2]="ZEGOCONN_RUN_ENV_APPLET"}(M||(M={})),function(z){z[z.Mode_UNSET=0]="Mode_UNSET",z[z.MODE_ONLINE=1]="MODE_ONLINE",z[z.MODE_TEST=2]="MODE_TEST",z[z.MODE_ALPHA=3]="MODE_ALPHA"}(Y||(Y={})),function(z){z[z.HTTP=0]="HTTP",z[z.PC=1]="PC",z[z.OTHER=2]="OTHER"}(L||(L={})),function(z){z[z.NONE=0]="NONE",z[z.BROKEN=1]="BROKEN",z[z.DISCONNECT=2]="DISCONNECT"}(A||(A={})),function(z){z[z.CONNECTED=0]="CONNECTED",z[z.DISCONNECT=1]="DISCONNECT",z[z.BROKEN=2]="BROKEN"}(H||(H={}));var ge,Ee,Se,ue,oe,be,Le,pe=[b.ACCESSHUB_INVALID_APPID,b.ACCESSHUB_INVALID_SIGNATURE];(function(z){z[z.offline=0]="offline",z[z.online=1]="online"})(ge||(ge={})),function(z){z[z.ACTION_RESERVED=0]="ACTION_RESERVED",z[z.ACTION_DISPATCH=1]="ACTION_DISPATCH",z[z.ACTION_RETRY=2]="ACTION_RETRY",z[z.ACTION_NEXT_NODE=3]="ACTION_NEXT_NODE",z[z.ACTION_ABORT=4]="ACTION_ABORT",z[z.ACTION_NEXT_GROUP=5]="ACTION_NEXT_GROUP",z[z.ACTION_IDLE=6]="ACTION_IDLE"}(Ee||(Ee={})),function(z){z[z.METHOD_UNSET=0]="METHOD_UNSET",z[z.METHOD_GET=1]="METHOD_GET",z[z.METHOD_POST=2]="METHOD_POST",z[z.METHOD_PUT=3]="METHOD_PUT",z[z.METHOD_PATCH=4]="METHOD_PATCH",z[z.METHOD_DELETE=5]="METHOD_DELETE",z[z.METHOD_HEAD=6]="METHOD_HEAD",z[z.METHOD_OPTIONS=7]="METHOD_OPTIONS"}(Se||(Se={})),function(z){z[z.CLOSE=0]="CLOSE",z[z.TEMP=1]="TEMP",z[z.TIMEOUT=2]="TIMEOUT"}(ue||(ue={})),function(z){z[z.AUTO=0]="AUTO",z[z.MANUAL=1]="MANUAL"}(oe||(oe={})),function(z){z[z.EMPTY=0]="EMPTY",z[z.CLOSE=1]="CLOSE"}(be||(be={})),function(z){z[z.single=0]="single",z[z.detail=1]="detail"}(Le||(Le={}));var k={2:"stream_closed",3:"close_connection",4:"http_request",5:"http_response",12:"hb_request",13:"hb_response",14:"get_config_request",15:"get_config_response",16:"http_request_ack",17:"pc_upward_message",18:"pc_upward_message_ack",19:"pc_established",20:"pc_broken",21:"pc_downward_message",22:"redirect",23:"get_appconfig_request",24:"get_appconfig_response",25:"push_appconfig",26:"accesshub_dispatch_request",27:"accesshub_dispatch_response",30:"push_exception",33:"http_request2",34:"redirect2",35:"accesshub_dispatch_request2",36:"accesshub_dispatch_response2",39:"get_svraddr_request",40:"get_svraddr_response"},R=Me(994);const Fe=R.default||R;var te=Me(788),Ue=Me(788);const it=Me(994);(Ue=Ue.default||Ue).util.Long=it.default||it,Ue.util.Long.fromBits=Ue.util.Long.fromBits||function(){return 0};for(var ee=Ue.roots,ae=Ue.types?Ue.types.basic:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0,string:2,bytes:2},xe=Ue.types?Ue.types.packed:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0},Z=Object.keys(ae),$={$:function(z){return $[z]?$[z].call(this):ee[z].decode?ee[z].decode(this,this.uint32()):$.$.call(this,"int32")}},K={$:function(z,T,F){var ve=ae[z];return ve===void 0?ee[z].encode?(this.uint32(F<<3|2).fork(),ee[z].encode(T,this).ldelim()):K.$.call(this,"int32",T,F):K[z].call(this.uint32(F<<3|ve),T)}},X=0;X<Z.length;X++)$[Z[X]]=Ue.Reader.prototype[Z[X]],K[Z[X]]=Ue.Writer.prototype[Z[X]];(function z(T,F,ve,Ae){for(var We=0,Xe=Object.keys(T);We<Xe.length;We++){var ot=Xe[We];T[ot].$m&&Object.keys(T[ot].$m).every(function(lt){return Number(lt)})?ve[ot]=function(lt,Tt){function Nt(Zt){for(var Cn in lt){var qn=lt[Cn];qn[1].charAt(0)==="{"?this[qn[0]]={}:qn[1].charAt(0)!=="["&&qn[1].charAt(0)!=="<"||(this[qn[0]]=[])}if(Zt)for(var hr=Object.keys(Zt),vr=0;vr<hr.length;++vr)Zt[hr[vr]]!=null&&(this[hr[vr]]=Zt[hr[vr]])}var Yt={};for(var Rn in lt){var nn=lt[Rn],en=nn[1];en.charAt(0)==="{"?(Nt.prototype[nn[0]]=Ue.util.emptyObject,Yt[en]={$m:en.substring(1).split(",").map(function(Zt,Cn){return[`$${Cn+1}`,Zt,null]}).reduce(function(Zt,Cn,qn){return Zt[qn+1]=Cn,Zt},{})}):Nt.prototype[nn[0]]=en.charAt(0)==="["||en.charAt(0)==="<"?Ue.util.emptyArray:en==="bytes"?Ue.util.newBuffer([]):nn[2]&&nn[2].hasOwnProperty("low")&&nn[2].hasOwnProperty("high")?Ue.util.Long.fromBits(nn[2].low,nn[2].high,nn[2].unsigned):nn[2]}return Nt.create=function(Zt){return new Nt(Zt)},Nt.decode=function(Zt,Cn){Zt instanceof Ue.Reader||(Zt=Ue.Reader.create(Zt));for(var qn=Cn===void 0?Zt.len:Zt.pos+Cn,hr=new Nt;Zt.pos<qn;){var vr=Zt.uint32(),gr=vr>>>3;if(gr>0&&lt[gr]){var Wn=lt[gr][0],ur=lt[gr][1];if(ur.charAt(0)==="{"){hr[Wn]===Ue.util.emptyObject&&(hr[Wn]={});var Gi=Nt.$namespace[ur].decode(Zt,Zt.uint32());hr[Wn][Gi.$1]=Gi.$2}else if(ur.charAt(0)==="["||ur.charAt(0)==="<")if(ur=ur.substring(1),hr[Wn]&&hr[Wn].length||(hr[Wn]=[]),xe[ur=$[ur]||ee[ur].decode?ur:"int32"]!==void 0&&(7&vr)==2)for(var uo=Zt.uint32()+Zt.pos;Zt.pos<uo;)hr[Wn].push($.$.call(Zt,ur));else hr[Wn].push($.$.call(Zt,ur));else hr[Wn]=$.$.call(Zt,ur)}else Zt.skipType(7&vr)}return hr},Nt.encode=function(Zt,Cn){for(var qn in Cn||(Cn=Ue.Writer.create()),lt){var hr=lt[qn][0],vr=lt[qn][1];if(vr.charAt(0)==="{"){if(Zt[hr]!=null&&Zt.hasOwnProperty(hr))for(var gr=0,Wn=Object.keys(Zt[hr]);gr<Wn.length;++gr)Cn.uint32(qn<<3|2).fork(),Nt.$namespace[vr].encode({$1:Wn[gr],$2:Zt[hr][Wn[gr]]},Cn).ldelim()}else if(vr.charAt(0)==="["||vr.charAt(0)==="<"){var ur=vr.charAt(0)==="<";vr=vr.substring(1);var Gi=Zt[hr];if(Gi!=null&&Gi.length)if(vr=ae[vr]!==void 0||ee[vr].encode?vr:"int32",ur&&xe[vr]!==void 0){for(Cn.uint32(qn<<3|2).fork(),gr=0;gr<Gi.length;gr++)K[vr].call(Cn,Gi[gr]);Cn.ldelim()}else for(gr=0;gr<Gi.length;gr++)K.$.call(Cn,vr,Gi[gr],qn)}else Zt[hr]!=null&&Zt.hasOwnProperty(hr)&&K.$.call(Cn,vr,Zt[hr],qn)}return Cn},Object.keys(Yt).length&&(Nt.$namespace=z(Yt,F+"."+Tt,Nt.$namespace||{},!0)),Nt}(T[ot].$m,ot):T[ot].$s?ve[ot]=function(lt,Tt){function Nt(Yt,Rn,nn){Ue.rpc.Service.call(this,Yt,Rn,nn)}return(Nt.prototype=Object.create(Ue.rpc.Service.prototype)).constructor=Nt,Nt.create=function(Yt,Rn,nn){return new Nt(Yt,Rn,nn)},Object.keys(lt).forEach(function(Yt){var Rn=lt[Yt];function nn(en,Zt){return this.rpcCall(nn,ee[Rn[0]],ee[Rn[1]],en,Zt)}Object.defineProperty(nn,"name",{value:Yt}),Object.defineProperty(nn,"path",{value:`${F}.${Tt}`}),Nt.prototype[Yt]=nn}),Nt}(T[ot].$s,ot):T[ot].$e&&Object.values(T[ot].$e).every(function(lt){return Number(lt)===lt})&&(ve[ot]=function(lt){for(var Tt=Object.keys(lt),Nt={},Yt=0;Yt<Tt.length;Yt++)Nt[Nt[Tt[Yt]]=lt[Tt[Yt]]]=Tt[Yt];return Nt}(T[ot].$e)),ve[ot]&&!Ae&&(ee[`${F}.${ot}`]=ve[ot]),delete T[ot].$m,delete T[ot].$s,delete T[ot].$e,ve[ot]=z(T[ot],F?`${F}.${ot}`:ot,ve[ot]||{})}return ve})({zego_connection:{proto_accesshub:{AccesshubAddr:{$m:{1:["ipv4","fixed32",0],2:["ipv6","zego_connection.proto_accesshub.IPV6Addr",null],3:["quic_port","uint32",0],4:["wss_port","uint32",0]}},AccesshubDispatchGroup:{$m:{1:["group","string",""],2:["quic_nodes","<string",null],3:["mtcp_nodes","<string",null],4:["wss_nodes","<string",null]}},AccesshubDispatchGroup2:{$m:{1:["group","string",""],2:["nodes","<zego_connection.proto_accesshub.AccesshubAddr",null],3:["nodes_dual","<zego_connection.proto_accesshub.AccesshubAddr",null],4:["weight","uint32",0],5:["gid","uint32",0]}},AccesshubDispatchRequest2:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode_no","zego_connection.proto_accesshub.Mode",0],5:["id_name","string",""],6:["sdk_type","zego_connection.proto_accesshub.SdkType",0],7:["zegoconn_version","uint32",0],8:["zegoconn_run_env","zego_connection.proto_accesshub.ZegoconnRunEnv",0],9:["device_id","string",""],10:["client_ip","string",""],11:["geofencing_type","uint32",0],12:["geofencings","[uint32",null],13:["addr_type","uint32",0],14:["net_mode","uint32",0],15:["dispatch_tag","uint32",0]}},AccesshubDispatchResponse2:{$m:{1:["code","int32",0],2:["message","string",""],3:["data","zego_connection.proto_accesshub.AccesshubDispatchResponseData2",null]}},AccesshubDispatchResponseData2:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["rand","string",""],3:["secret","string",""],4:["groups","<zego_connection.proto_accesshub.AccesshubDispatchGroup2",null],5:["wss_groups","<zego_connection.proto_accesshub.WssAccesshubDispatchGroup",null],6:["ttl","uint32",0],7:["http3_groups","<zego_connection.proto_accesshub.Http3AccesshubDispatchGroup",null],8:["wss_v6_groups","<zego_connection.proto_accesshub.WssAccesshubDispatchGroup",null],9:["http3_v6_groups","<zego_connection.proto_accesshub.Http3AccesshubDispatchGroup",null]}},BackendConnType:{$e:{BACKEND_CONN_TYPE_UNSET:0,BACKEND_CONN_TYPE_TCP:1,BACKEND_CONN_TYPE_WSS:2}},CheckServiceAreaRequest:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode","zego_connection.proto_accesshub.Mode",0],5:["id_name","string",""],6:["sdk_type","zego_connection.proto_accesshub.SdkType",0],7:["zegoconn_run_env","zego_connection.proto_accesshub.ZegoconnRunEnv",0],8:["zegoconn_version","uint32",0],9:["device_id","string",""],10:["user_agent","string",""],11:["language","string",""],12:["timezone","string",""],13:["carrier","string",""],14:["dns_result","zego_connection.proto_accesshub.IPAddr",null]}},CheckServiceAreaResponse:{$m:{1:["code","int32",0],2:["message","string",""],3:["data","zego_connection.proto_accesshub.CheckServiceAreaResponseData",null]}},CheckServiceAreaResponseData:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}]}},CloseConnection:{$m:{1:["reason","int32",0],2:["msg","string",""],3:["action","int32",0]},Action:{$e:{ACTION_RESERVED:0,ACTION_DISPATCH:1,ACTION_RETRY:2,ACTION_NEXT_NODE:3,ACTION_ABORT:4,ACTION_NEXT_GROUP:5,ACTION_IDLE:6}}},ConnectionClosed:{$m:{1:["code","int32",0],2:["msg","string",""]}},ErrorCode:{$e:{OK:0,DISPATCH_NO_AVAILABLE_NODE:1e4,DISPATCH_INTERNAL_ERROR:10001,DISPATCH_INVALID_FRAME:10002,DISPATCH_UNMARSHAL:10003,DISPATCH_MSGTYPE:10004,DISPATCH_MARSHAL:10005,DISPATCH_TOO_FREQUENTLY:10006,DISPATCH_EMPTY_GEOFENCING:10007,ACCESSHUB_INVALID_FRAME:2e4,ACCESSHUB_NEED_ENCRYPT:20001,ACCESSHUB_DECRYPT:20002,ACCESSHUB_MSGTYPE:20003,ACCESSHUB_UNMARSHAL:20004,ACCESSHUB_TIMEOUT:20005,ACCESSHUB_CONNECT:20006,ACCESSHUB_BROKEN:20007,ACCESSHUB_INTERNAL_ERROR:20008,ACCESSHUB_MARSHAL:20009,ACCESSHUB_UNSUPPORTED_SERVICE:20010,ACCESSHUB_TOO_FREQUENTLY:20011,ACCESSHUB_INVALID_APPID:20012,ACCESSHUB_HB_TIMEOUT:20013,ACCESSHUB_INVALID_SIGNATURE:20014,ACCESSHUB_AUTH_FAILED:20015,ACCESSHUB_UNSUPPORTED_INTERFACE:20016,ACCESSHUB_EMPTY_GEOFENCING:20017,ACCESSHUB_ACCESS_DENIED:20018,ACCESSHUB_SPECIAL_CUSTOMER:20019,ACCESSHUB_IDLE_CONNECTION:20020,ACCESSHUB_APPID_OFFLINE:20021,ACCESSHUB_GET_STREAM_FAILED:3e4,ACCESSHUB_GET_CONN_FAILED:30001,ACCESSHUB_DO_HTTP_REQUEST_FAILED:30002,ACCESSHUB_UNMARSHAL_HB_FAILED:30003,ACCESSHUB_DO_BACKEND_DISPATCH_FAILED:30004}},GeoFencing:{$e:{CN:2,NA:3,EU:4,AS:5,IN:6,NCN:7}},GeoFencingType:{$e:{NONE:0,UNION:1,EXCLUDE:2}},GetAppConfigRequest:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode_no","zego_connection.proto_accesshub.Mode",0],5:["id_name","string",""],6:["config_key","string",""],7:["ts","uint64",{low:0,high:0,unsigned:!0}],8:["signature","bytes",[]],9:["lite_sign","string",""],10:["token","string",""],11:["sdk_type","zego_connection.proto_accesshub.SdkType",0],12:["zegoconn_version","uint32",0],13:["zegoconn_run_env","zego_connection.proto_accesshub.ZegoconnRunEnv",0],14:["device_id","string",""],15:["etag","uint32",0],16:["is_special_customer","uint32",0]}},GetAppConfigResponse:{$m:{1:["code","int32",0],2:["message","string",""],3:["data","zego_connection.proto_accesshub.GetAppConfigResponseData",null]}},GetAppConfigResponseData:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["data","bytes",[]],3:["ts","uint64",{low:0,high:0,unsigned:!0}],4:["etag","uint32",0]}},GetConfigRequest:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode","string",""],5:["id_name","string",""],6:["reqid","string",""],7:["zegoconn_version","uint32",0],8:["sdk_type","zego_connection.proto_accesshub.SdkType",0],9:["zegoconn_run_env","zego_connection.proto_accesshub.ZegoconnRunEnv",0],10:["device_id","string",""],11:["mode_no","zego_connection.proto_accesshub.Mode",0],12:["geofencing_type","uint32",0],13:["geofencings","[uint32",null],14:["dispatch_tag","uint32",0]}},GetConfigResponse:{$m:{1:["code","int32",0],2:["message","string",""],3:["data","zego_connection.proto_accesshub.GetConfigResponseData",null]}},GetConfigResponseData:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["quic_hb_interval","uint32",0],3:["quic_hb_timeout","uint32",0],4:["logic_hb_interval","uint32",0],5:["logic_hb_timeout","uint32",0],6:["pc_establish_timeout","uint32",0],7:["sdk_link_detect_interval","uint32",0],8:["sdk_link_detect_duration","uint32",0],9:["client_outer_ip","string",""],10:["ntp_time","uint64",{low:0,high:0,unsigned:!0}],11:["root_rsa_certs_ver","uint32",0],12:["geofencing_id","uint32",0],13:["svraddr_ver","uint32",0],14:["root_ecc_certs_ver","uint32",0]}},GetSvraddrRequest:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode","zego_connection.proto_accesshub.Mode",0],5:["id_name","string",""],6:["sdk_type","zego_connection.proto_accesshub.SdkType",0],7:["zegoconn_run_env","zego_connection.proto_accesshub.ZegoconnRunEnv",0],8:["zegoconn_version","uint32",0],9:["device_id","string",""],10:["geofencing_type","uint32",0],11:["geofencings","[uint32",null],12:["addr_type","uint32",0],13:["dispatch_tag","uint32",0]}},GetSvraddrResponse:{$m:{1:["code","int32",0],2:["msg","string",""],3:["data","zego_connection.proto_accesshub.GetSvraddrResponseData",null]}},GetSvraddrResponseData:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["geofencing_id","uint32",0],3:["svraddr_ver","uint32",0],4:["anycast_ips","<zego_connection.proto_accesshub.IPAddr",null],5:["zegons_domain","string",""],6:["zegons_ips","<zego_connection.proto_accesshub.IPAddr",null],7:["accesshub_domain","string",""],8:["accesshub_ips","<zego_connection.proto_accesshub.IPAddr",null],9:["logreport_domain","string",""],10:["logreport_ips","<zego_connection.proto_accesshub.IPAddr",null],11:["detaillog_domain","string",""],12:["detaillog_ips","<zego_connection.proto_accesshub.IPAddr",null],13:["stunsvr_domain","string",""],14:["stunsvr_ips","<zego_connection.proto_accesshub.IPAddr",null],15:["zimfile_domain","string",""],16:["zimfile_ips","<zego_connection.proto_accesshub.IPAddr",null],17:["accesshub_sni","string",""],18:["detectsvr_domain","string",""],19:["accesscube_domain","string",""],20:["wslog_domain","string",""],21:["wslog_ips","<zego_connection.proto_accesshub.IPAddr",null],22:["http3_domain","string",""],23:["accesshub_v6_domain","string",""],24:["http3_v6_domain","string",""],25:["logreport_v6_domain","string",""],26:["detaillog_v6_domain","string",""]}},HBRequest:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["ts","int64",{low:0,high:0,unsigned:!1}]}},HBResponse:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["ts","int64",{low:0,high:0,unsigned:!1}],3:["ntp_time","uint64",{low:0,high:0,unsigned:!0}]}},Http3AccesshubDispatchGroup:{$m:{1:["group","string",""],2:["host","string",""]}},HTTPRequest:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode","string",""],5:["id_name","string",""],6:["reqid","string",""],7:["stick","string",""],8:["service","string",""],9:["location","string",""],10:["method","string",""],11:["headers","<zego_connection.proto_accesshub.HTTPRequest.HTTPHeader",null],12:["body","bytes",[]],13:["ack","bool",!1],14:["mode_no","zego_connection.proto_accesshub.Mode",0],15:["service_no","zego_connection.proto_accesshub.Service",0],16:["method_no","zego_connection.proto_accesshub.Method",0],17:["sdk_type","zego_connection.proto_accesshub.SdkType",0],18:["zegoconn_run_env","zego_connection.proto_accesshub.ZegoconnRunEnv",0],19:["zegoconn_version","uint32",0],20:["device_id","string",""],21:["reduce_resp_header","uint32",0]},HTTPHeader:{$m:{1:["name","string",""],2:["val","string",""]}}},HTTPRequest2:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode","zego_connection.proto_accesshub.Mode",0],5:["id_name","string",""],6:["sdk_type","zego_connection.proto_accesshub.SdkType",0],7:["zegoconn_run_env","zego_connection.proto_accesshub.ZegoconnRunEnv",0],8:["zegoconn_version","uint32",0],9:["headers","<zego_connection.proto_accesshub.HTTPRequest.HTTPHeader",null],10:["method","zego_connection.proto_accesshub.Method",0],11:["interface_id","uint32",0],12:["res_id","string",""],13:["params","string",""],14:["body","bytes",[]],15:["ack","bool",!1],16:["device_id","string",""],17:["ts","uint64",{low:0,high:0,unsigned:!0}],18:["signature","bytes",[]],19:["token","string",""],20:["lite_sign","string",""],21:["reduce_resp_header","uint32",0]}},HTTPRequestAck:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}]}},HTTPRequestDroped:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["reason","int32",0],3:["msg","string",""]}},HTTPResponse:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["headers","<zego_connection.proto_accesshub.HTTPRequest.HTTPHeader",null],3:["status_code","int32",0],4:["body","bytes",[]]}},IPAddr:{$m:{1:["ipv4","fixed32",0],2:["ipv6","zego_connection.proto_accesshub.IPV6Addr",null]}},IPV6Addr:{$m:{1:["high","fixed64",{low:0,high:0,unsigned:!1}],2:["low","fixed64",{low:0,high:0,unsigned:!1}]}},MessageType:{$e:{MSG_TYPE_EMPTY:0,MSG_TYPE_CONNECTION_CLOSED:1,MSG_TYPE_STREAM_CLOSED:2,MSG_TYPE_CLOSE_CONNECTION:3,MSG_TYPE_HTTP_REQUEST:4,MSG_TYPE_HTTP_RESPONSE:5,MSG_TYPE_HTTP_REQUEST_DROPED:6,MSG_TYPE_PROXY_CONNECT:7,MSG_TYPE_PROXY_CONNECTED:8,MSG_TYPE_PROXY_CONNECTION_CLOSED:9,MSG_TYPE_PROXY_SEND_DATA:10,MSG_TYPE_PROXY_RECV_DATA:11,MSG_TYPE_HB_REQUEST:12,MSG_TYPE_HB_RESPONSE:13,MSG_TYPE_GET_CONFIG_REQUEST:14,MSG_TYPE_GET_CONFIG_RESPONSE:15,MSG_TYPE_HTTP_REQUEST_ACK:16,MSG_TYPE_PC_UPWARD_MESSAGE:17,MSG_TYPE_PC_UPWARD_MESSAGE_ACK:18,MSG_TYPE_PC_ESTABLISHED:19,MSG_TYPE_PC_BROKEN:20,MSG_TYPE_PC_DOWNWARD_MESSAGE:21,MSG_TYPE_REDIRECT:22,MSG_TYPE_GET_APPCONFIG_REQUEST:23,MSG_TYPE_GET_APPCONFIG_RESPONSE:24,MSG_TYPE_PUSH_APPCONFIG:25,MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST:26,MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE:27,MSG_TYPE_GET_IM_CONFIG_REQUEST:28,MSG_TYPE_GET_IM_CONFIG_RESPONSE:29,MSG_TYPE_PUSH_EXCEPTION:30,MSG_TYPE_RESOLVE_DOMAIN_REQUEST:31,MSG_TYPE_RESOLVE_DOMAIN_RESPONSE:32,MSG_TYPE_HTTP_REQUEST2:33,MSG_TYPE_REDIRECT2:34,MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2:35,MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE2:36,MSG_TYPE_GET_ROOTCERTS_REQUEST:37,MSG_TYPE_GET_ROOTCERTS_RESPONSE:38,MSG_TYPE_GET_SVRADDR_REQUEST:39,MSG_TYPE_GET_SVRADDR_RESPONSE:40,MSG_TYPE_CHECK_SERVICEAREA_REQUEST:41,MSG_TYPE_CHECK_SERVICEAREA_RESPONSE:42,MSG_TYPE_UA_DISPATCH_REQUEST:50,MSG_TYPE_UA_DISPATCH_RESPONSE:51,MSG_TYPE_UA_ECHO_REQUEST:52,MSG_TYPE_UA_ECHO_RESPONSE:53,MSG_TYPE_NODE_REGISTER_REQUEST:100,MSG_TYPE_NODE_REGISTER_RESPONSE:101,MSG_TYPE_NODE_HB_REQUEST:102,MSG_TYPE_NODE_HB_RESPONSE:103}},Method:{$e:{METHOD_UNSET:0,METHOD_GET:1,METHOD_POST:2,METHOD_PUT:3,METHOD_PATCH:4,METHOD_DELETE:5,METHOD_HEAD:6,METHOD_OPTIONS:7}},Mode:{$e:{Mode_UNSET:0,MODE_ONLINE:1,MODE_TEST:2,MODE_ALPHA:3}},PCBroken:{$m:{}},PCDownwardMessage:{$m:{1:["payload","bytes",[]],2:["wss_message_type","uint32",0],3:["ts","uint64",{low:0,high:0,unsigned:!0}]}},PCEstablished:{$m:{1:["elapse","uint32",0],2:["from","uint32",0]}},PCUpwardMessage:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}],2:["appid","uint32",0],3:["biz_type","uint32",0],4:["mode_no","zego_connection.proto_accesshub.Mode",0],5:["id_name","string",""],6:["service_no","zego_connection.proto_accesshub.Service",0],7:["ack","bool",!1],8:["payload","bytes",[]],9:["sdk_type","zego_connection.proto_accesshub.SdkType",0],10:["wss_message_type","uint32",0],11:["wss_path","string",""],12:["wss_raw_query","string",""],13:["zegoconn_version","uint32",0],14:["zegoconn_run_env","zego_connection.proto_accesshub.ZegoconnRunEnv",0],15:["backend_conn_type","zego_connection.proto_accesshub.BackendConnType",0],16:["device_id","string",""],17:["geofencing_type","uint32",0],18:["geofencings","[uint32",null],19:["addr_type","uint32",0],20:["net_mode","uint32",0]}},PCUpwardMessageAck:{$m:{1:["txid","uint64",{low:0,high:0,unsigned:!0}]}},ProxyConnectionClosed:{$m:{1:["code","int32",0],2:["msg","string",""],3:["connected","int32",0]}},PushAppConfig:{$m:{1:["config_key","string",""],2:["data","bytes",[]]}},PushException:{$m:{1:["reason","int32",0],2:["msg","string",""],3:["txid","uint64",{low:0,high:0,unsigned:!0}]}},Redirect2:{$m:{1:["rand","string",""],2:["secret","string",""],3:["groups","<zego_connection.proto_accesshub.AccesshubDispatchGroup2",null],4:["wss_groups","<zego_connection.proto_accesshub.WssAccesshubDispatchGroup",null],5:["ttl","uint32",0],6:["http3_groups","<zego_connection.proto_accesshub.Http3AccesshubDispatchGroup",null],7:["wss_v6_groups","<zego_connection.proto_accesshub.WssAccesshubDispatchGroup",null],8:["http3_v6_groups","<zego_connection.proto_accesshub.Http3AccesshubDispatchGroup",null]}},SdkType:{$e:{SDK_TYPE_UNSET:0,SDK_TYPE_NATIVE:1,SDK_TYPE_WSS_WEB:3,SDK_TYPE_ZIM_WEB:4}},Service:{$e:{SERVICE_UNSET:0,SERVICE_MEDIAGW:1,SERVICE_LIVEROOM:2,SERVICE_MIX:3,SERVICE_ZEUS:4,SERVICE_ZPUSH:5,SERVICE_L3:6,SERVICE_TALKLINE:7,SERVICE_EDUSUITE:8,SERVICE_ZIM:9,SERVICE_ClOUD_SETTING:10,SERVICE_ZEUSHB:11,SERVICE_USER_LOGIC:12,SERVICE_UNIFYDISPATCH:13,SERVICE_QUALITY:14,SERVICE_SECURITY:15,SERVICE_KTVCPR:16,SERVICE_SWITCH4LIVEROOM:17,SERVICE_WEBRTC_SIGNAL:18,SERVICE_L3_WEBRTC_SIGNAL:19,SERVICE_VIDEOCPR:20,SERVICE_CDN:21,SERVICE_CLOUDRECORD:22,SERVICE_INNER_ECHO:23,SERVICE_OUTER_ECHO:24,SERVICE_LOCALHOST_ECHO:25,SERVICE_ECHO:26,SERVICE_DOCSERVICE:27,SERVICE_AUTHSVR:28,SERVICE_WEBLIVEROOM:29,SERVICE_WHITEBOARD:30,SERVICE_METAWORLD:31,SERVICE_ZEGOLAND:32}},StreamClosed:{$m:{1:["code","int32",0],2:["msg","string",""]}},WssAccesshubDispatchGroup:{$m:{1:["group","string",""],2:["host","string",""],3:["main_domain","string",""]}},ZegoconnRunEnv:{$e:{ZEGOCONN_RUN_ENV_UNSET:0,ZEGOCONN_RUN_ENV_BROWSER:1,ZEGOCONN_RUN_ENV_APPLET:2}}},proto_initconfig:{AppConfig:{$m:{1:["test_id","int32",0],2:["domain","string",""],3:["flexible_domain","string",""],4:["replace_flexible_domain","string",""]}},InitConfig:{$m:{1:["app_config","zego_connection.proto_initconfig.AppConfig",null],4:["speedlog_config","zego_connection.proto_initconfig.SpeedlogConfig",null],5:["media_config","zego_connection.proto_initconfig.MediaConfig",null],9:["log_config","zego_connection.proto_initconfig.LogConfig",null]}},LogConfig:{$m:{1:["ws_log","int32",0]}},MediaConfig:{$m:{1:["play_config","zego_connection.proto_initconfig.MediaPlayConfig",null],2:["publish_config","zego_connection.proto_initconfig.MediaPublishConfig",null]}},MediaPlayConfig:{$m:{5:["resource_info","<zego_connection.proto_initconfig.MediaResourceInfo",null],16:["transcoding","zego_connection.proto_initconfig.TranscodingConfig",null],19:["enable_codec_template","int32",0],20:["codec_template_postfix_pattern","string",""]}},MediaPublishConfig:{$m:{2:["resource_info","<zego_connection.proto_initconfig.MediaResourceInfo",null],5:["enable_subject_segmentation","int32",0],6:["object_segmentation_platform","int32",0]}},MediaResourceInfo:{$m:{1:["resource_type","zego_connection.proto_initconfig.ResourceType",0],2:["service_info","<zego_connection.proto_initconfig.MediaServiceProtocolInfo",null]}},MediaServiceProtocolInfo:{$m:{1:["config_id","string",""],2:["protocol","zego_connection.proto_initconfig.ProtocolType",0],3:["url_template","string",""],4:["resolve_type","zego_connection.proto_initconfig.ResolveType",0],5:["push_cdn_authentication","int32",0],6:["cdn_quic_version","<int32",null]}},ProtocolType:{$e:{UDP:0,RTMP:1,FLV:2,HLS:3,WEBRTC:4}},ResolveType:{$e:{LOCAL_DNS:0,DISPATCH:1}},ResourceType:{$e:{CDN:0,RTC:1,L3:2,CDN_PLUS:3,CDN_PLUS_BACKUP:4}},SpeedlogConfig:{$m:{1:["report_count","int32",0],2:["report_retry_interval","int32",0],3:["push_quality_sample_count","int32",0],4:["pull_quality_sample_count","int32",0],5:["hardware_report_cycle","int32",0],6:["room_user_max_count","int32",0],7:["room_stream_max_count","int32",0],8:["charge_info_report_cycle","int32",0],9:["charge_info_report_mode","int32",0],10:["disable_report_pull","<zego_connection.proto_initconfig.ResourceType",null],11:["report_max_bytes","int32",0],12:["push_quality_report_freq","int32",0],13:["pull_quality_report_freq","int32",0],14:["charge_info_report_no_playing","int32",0]}},TranscodingConfig:{$m:{1:["video_codec_h264","string",""]}}}}},"",ee,!1);const B=ee.zego_connection;var fe=function(){return fe=Object.assign||function(z){for(var T,F=1,ve=arguments.length;F<ve;F++)for(var Ae in T=arguments[F])Object.prototype.hasOwnProperty.call(T,Ae)&&(z[Ae]=T[Ae]);return z},fe.apply(this,arguments)};te.util.Long=Fe,te.configure();var Ce,Ze=function(){function z(T){var F;this.stateCenter=T,this.W=B,this.K=((F={})[_.MSG_TYPE_STREAM_CLOSED]=["proto_accesshub","ConnectionClosed"],F[_.MSG_TYPE_CLOSE_CONNECTION]=["proto_accesshub","CloseConnection"],F[_.MSG_TYPE_HTTP_REQUEST]=["proto_accesshub","HTTPRequest"],F[_.MSG_TYPE_HTTP_RESPONSE]=["proto_accesshub","HTTPResponse"],F[_.MSG_TYPE_HTTP_REQUEST2]=["proto_accesshub","HTTPRequest2"],F[_.MSG_TYPE_HB_REQUEST]=["proto_accesshub","HBRequest"],F[_.MSG_TYPE_HB_RESPONSE]=["proto_accesshub","HBResponse"],F[_.MSG_TYPE_GET_CONFIG_REQUEST]=["proto_accesshub","GetConfigRequest"],F[_.MSG_TYPE_GET_CONFIG_RESPONSE]=["proto_accesshub","GetConfigResponse"],F[_.MSG_TYPE_GET_SVRADDR_REQUEST]=["proto_accesshub","GetSvraddrRequest"],F[_.MSG_TYPE_GET_SVRADDR_RESPONSE]=["proto_accesshub","GetSvraddrResponse"],F[_.MSG_TYPE_HTTP_REQUEST_ACK]=["proto_accesshub","HTTPRequestAck"],F[_.MSG_TYPE_PC_UPWARD_MESSAGE]=["proto_accesshub","PCUpwardMessage"],F[_.MSG_TYPE_PC_UPWARD_MESSAGE_ACK]=["proto_accesshub","PCUpwardMessageAck"],F[_.MSG_TYPE_PC_ESTABLISHED]=["proto_accesshub","PCEstablished"],F[_.MSG_TYPE_PC_BROKEN]=["proto_accesshub","PCBroken"],F[_.MSG_TYPE_PC_DOWNWARD_MESSAGE]=["proto_accesshub","PCDownwardMessage"],F[_.MSG_TYPE_REDIRECT]=["proto_accesshub","Redirect"],F[_.MSG_TYPE_REDIRECT2]=["proto_accesshub","Redirect2"],F[_.MSG_TYPE_GET_APPCONFIG_REQUEST]=["proto_accesshub","GetAppConfigRequest"],F[_.MSG_TYPE_GET_APPCONFIG_RESPONSE]=["proto_accesshub","GetAppConfigResponse"],F[_.MSG_TYPE_PUSH_APPCONFIG]=["proto_accesshub","PushAppConfig"],F[_.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST]=["proto_accesshub","AccesshubDispatchRequest"],F[_.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE]=["proto_accesshub","AccesshubDispatchResponse"],F[_.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2]=["proto_accesshub","AccesshubDispatchRequest2"],F[_.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE2]=["proto_accesshub","AccesshubDispatchResponse2"],F[_.MSG_TYPE_PUSH_EXCEPTION]=["proto_accesshub","PushException"],F)}return z.prototype.encodeRequest=function(T,F,ve,Ae){var We,Xe=this.K[T],ot=this.Z(this.W[Xe[0]][Xe[1]],F),lt=ot.length,Tt=13;return this.stateCenter.appInfo.model===Ne.Private?((We=new Uint8Array(13+lt))[0]=172,We[1]=0,We[2]=0,We.set(new Uint8Array(Int32Array.from([ve]).buffer).reverse(),3),We[7]=T>>8,We[8]=T-(We[2]<<8),We.set(new Uint8Array(Int32Array.from([lt]).buffer).reverse(),9)):Ae===C.WebTransport?((We=new Uint8Array(9+lt))[0]=175,We[1]=0,We[2]=T>>8,We[3]=T-(We[2]<<8),We.set(new Uint8Array(Int32Array.from([lt]).buffer).reverse(),4),We[8]=0,Tt=9):((We=new Uint8Array(13+lt))[0]=175,We[1]=0,We[2]=T>>8,We[3]=T-(We[2]<<8),We.set(new Uint8Array(Int32Array.from([lt]).buffer).reverse(),4),We.set(new Uint8Array(Int32Array.from([ve]).buffer).reverse(),8),We[12]=0),We.set(ot,Tt),We},z.prototype.decodeResponse=function(T,F){var ve,Ae,We,Xe=13,ot=0;if(this.stateCenter.appInfo.model===Ne.Private)ve=(T[7]<<8)+T[8],We=(Ae=new DataView(T.buffer)).getUint32(3),ot=Ae.getUint32(9);else if(F===C.WebTransport){if(T.length<9)return[0,0,null,0];if(ve=(T[2]<<8)+T[3],We=0,Xe=9,ot=T[4]*Math.pow(256,3)+T[5]*Math.pow(256,2)+256*T[6]+T[7],T.length-Xe<ot)return[0,0,null,0]}else ve=(T[2]<<8)+T[3],ot=(Ae=new DataView(T.buffer)).getUint32(4),We=Ae.getUint32(8);var lt=Xe+ot,Tt=T.slice(Xe,lt);return[We,ve,this.decodeBody(Tt,ve),lt]},z.prototype.decodeBody=function(T,F){try{var ve=this.K[F];return this.X(this.W[ve[0]][ve[1]],T)}catch{return{code:1}}},z.prototype.decodeConfigMessage=function(T){return this.X(this.W.proto_initconfig.InitConfig,T)},z.prototype.Z=function(T,F){return T.encode(new T(F)).finish()},z.prototype.X=function(T,F){return fe({},T.decode(F))},z}(),st=function(){function z(T,F){T===void 0&&(T=null),F===void 0&&(F=null),this.next=null,this.prev=null,this.tt=T,this.U=F}return Object.defineProperty(z.prototype,"id",{get:function(){return this.tt?this.tt:null},set:function(T){this.tt=T},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"data",{get:function(){return this.U},set:function(T){this.U=T},enumerable:!1,configurable:!0}),z.prototype.hasNext=function(){return this.next&&this.next.id},z.prototype.hasPrev=function(){return this.prev&&this.prev.id},z}(),Ie=function(){function z(){this.start=new st,this.end=new st,this.it=1,this.nt=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}return z.prototype.insertBefore=function(T,F){var ve=new st(this.it,F);return ve.next=T,ve.prev=T.prev,T.prev&&(T.prev.next=ve),T.prev=ve,++this.it,++this.nt,ve},z.prototype.addLast=function(T){return this.insertBefore(this.end,T)},z.prototype.add=function(T){return this.addLast(T)},z.prototype.getFirst=function(){return this.nt===0?null:this.start.next},z.prototype.getLast=function(){return this.nt===0?null:this.end.prev},z.prototype.size=function(){return this.nt},z.prototype.getFromFirst=function(T){var F=0,ve=this.start.next;if(T>=0)for(;F<T&&ve!==null;)ve=ve.next,++F;else ve=null;if(ve===null)throw"Index out of bounds.";return ve},z.prototype.get=function(T){return T===0?this.getFirst():T===this.nt-1?this.getLast():this.getFromFirst(T)},z.prototype.remove=function(T){return T.prev&&(T.prev.next=T.next),T.next&&(T.next.prev=T.prev),--this.nt,T},z.prototype.removeFirst=function(){var T=null;return this.nt>0&&this.start.next&&(T=this.remove(this.start.next)),T},z.prototype.removeLast=function(){var T=null;return this.nt>0&&this.end.prev&&(T=this.remove(this.end.prev)),T},z.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this.nt=0,this.it=1},z.prototype.each=function(T){for(var F=this.start;F.hasNext();)T(F=F.next)},z.prototype.forEach=function(T){for(var F=this.start;F.hasNext()&&!T(F=F.next););},z.prototype.find=function(T){for(var F=this.start,ve=!1,Ae=null;F.hasNext()&&!ve;)T(F=F.next)&&(Ae=F,ve=!0);return Ae},z.prototype.map=function(T){for(var F=this.start,ve=[];F.hasNext();)T(F=F.next)&&ve.push(F);return ve},z.prototype.push=function(T){return this.addLast(T)},z.prototype.unshift=function(T){this.insertBefore(this.nt>0?this.start.next:this.end,T)},z.prototype.pop=function(){return this.removeLast()},z.prototype.shift=function(){return this.removeFirst()},z}(),D="zn.zca.gc",me="zn.zca.oce",ce="zn.zca.gac",le="zn.zca.rd",et="zn.zca.cc",ze="zn.zca.ir.0",ft="zn.sai.0",_t="zn.shq.0",mt="zn.nab.gsa",Ve="zn.nab.du",Ot="zn.nab.gac",rn="zn.nhb.s",an="zn.rlh.at",In="zn.rlh.sm",Tn="zn.wl.cs.0",fn="zn.wl.om",Rr="zn.wl.h3.g",ir="zn.wl.h3.t.2",Ln="zn.wl.h3.s",mn="zn.wl.h3.s.0",Qn="zn.wl.sls",Nn="zn.wl.sidr",or="zn.wl.c.0",pr="zn.wl.gbi.0",sr="zn.sm.cs.0",Wr="zn.sm.bsh",tr="zn.sm.cps",zn="zn.napr.sr",bn="zn.napr.ope",Jn="zn.nahr.sr",zr="zn.nahr.sr2",jn={domains:["accesshub-wss.zego.im"],mode:"online",modeNo:Y.MODE_ONLINE,sdkType:3,connectVer:33,pcEstablishTimeout:15,scheme:"wss",location:"accesshub",wssMessageType:1,model:Ne.Normal},Lr="0c9e6e0f8c0a8f4e",Vr=2e4,Ai=Me(955),Yr=Me.n(Ai),Qr=Me(178),Ci=Me.n(Qr),Si=new TextDecoder("utf-8"),ri=new TextEncoder,fr=function(z){return ri.encode(z)},Yn=function(z){return Si.decode(z)},yi=function(){return new Promise(function(z,T){z(Math.random())})};function dr(z,T,F){var ve=function(We,Xe){try{return localStorage.getItem(Xe)}catch{}}(0,"".concat(z,"_").concat(F,"_").concat(T));if(!ve)return null;var Ae=function(We,Xe){try{return Yr().decrypt(We,Xe).toString(Ci())}catch{return""}}(ve,Lr);return Ae&&JSON.parse(Ae)||null}function ii(z,T,F,ve,Ae){var We=ve;if(Ae){var Xe=dr(z,T,F);Xe&&(We=Object.assign(Xe,ve))}var ot,lt,Tt=JSON.stringify(We);T===0&&(ot=JSON.stringify(We),lt=Lr,Tt=Yr().encrypt(ot,lt).toString()),function(Nt,Yt,Rn){try{localStorage.setItem(Yt,Rn)}catch{}}(0,"".concat(z,"_").concat(F,"_").concat(T),Tt)}function kn(z){return z!=null&&z.includes("https")?1:3}(function(z){z[z.NotSupport=0]="NotSupport",z[z.LinkFailed=1]="LinkFailed",z[z.CreateStreamFailed=2]="CreateStreamFailed",z[z.WriteDataFailed=3]="WriteDataFailed",z[z.ReadDataFailed=4]="ReadDataFailed",z[z.GetConfigFailed=5]="GetConfigFailed",z[z.NoUseableHttp3Server=6]="NoUseableHttp3Server",z[z.ClosedTooOften=7]="ClosedTooOften",z[z.LinkTimeout=8]="LinkTimeout",z[z.Unknown=100]="Unknown"})(Ce||(Ce={}));var nr,Fn={code:1100002,msg:"network timeout."},_r={code:1100004,msg:"net agent timeout"},P={code:1100006,msg:"net connect timeout"},He={code:1100007,msg:"the user breaks the network connection"},de=1100009,ne=1100011,De={code:1100012,msg:"the socket is idle"};(function(z){z[z.BROWSER=0]="BROWSER",z[z.WEIXINMINI=1]="WEIXINMINI"})(nr||(nr={}));var ye=function(){function z(T,F){this.url=T,this.readyState=N.CLOSED,this.et=wx.connectSocket({url:T}),this.init()}return z.prototype.init=function(){var T=this;this.et&&(this.readyState=N.CONNECTING,this.et.onOpen(function(F){T.readyState=T.et.readyState,typeof T.onopen=="function"&&(T.onopen(F),T.et.onClose(function(ve){T.readyState=T.et.readyState,typeof T.onclose=="function"&&T.onclose(ve)}),T.et.onMessage(function(ve){typeof T.onmessage=="function"&&T.onmessage(ve)}))}),this.et.onError(function(F){T.readyState=T.et.readyState,typeof T.onerror=="function"&&T.onerror(F)}))},z.prototype.onopen=function(T){},z.prototype.onerror=function(T){},z.prototype.onclose=function(T){},z.prototype.onmessage=function(T){},z.prototype.send=function(T,F,ve,Ae){T instanceof Uint8Array&&(T=new Uint8Array(T).buffer),this.et&&this.et.send({data:T})},z.prototype.close=function(){this.et&&this.et.close()},z}(),Qe=function(){function z(T){T===void 0&&(T=""),this.st=T,this.count=0,this.isStarting=!1,this.timer=0,this.lastLogTime=0,this.speed=0,this.lastTime=0}return z.prototype.add=function(T){this.isStarting&&(this.count+=T)},z.prototype.stop=function(){return this.isStarting=!1,this.reset()},z.prototype.start=function(T){var F=this;T===void 0&&(T=0),this.isStarting=!0,this.count=0,clearInterval(this.timer),T&&(this.timer=window.setInterval(function(){F.speed=F.count/T,F.count=0},T))},z.prototype.reset=function(){this.count=0,clearInterval(this.timer),this.timer=0,this.speed=0},z}(),Ke=function(){function z(){this.ot={}}return z.prototype.addEventHandler=function(T,F){if(this.ot[T]||(this.ot[T]=[]),typeof F!="function")throw new Error("Params callBack is not a Function");return this.ot[T]&&this.ot[T].indexOf(F)==-1&&this.ot[T].push(F),!0},z.prototype.removeEventHandler=function(T,F){return!!this.ot[T]&&(this.ot[T]=F?this.ot[T].filter(function(ve){return ve!==F}):[],!0)},z.prototype.emit=function(T){for(var F=[],ve=1;ve<arguments.length;ve++)F[ve-1]=arguments[ve];this.ot[T]&&this.ot[T].forEach(function(Ae){try{Ae.apply(void 0,F)}catch(We){console.error('Fail to execute callback of event "'.concat(T,'" : ').concat(We))}})},z}(),$e=function(z,T,F,ve){return new(F||(F=Promise))(function(Ae,We){function Xe(Tt){try{lt(ve.next(Tt))}catch(Nt){We(Nt)}}function ot(Tt){try{lt(ve.throw(Tt))}catch(Nt){We(Nt)}}function lt(Tt){var Nt;Tt.done?Ae(Tt.value):(Nt=Tt.value,Nt instanceof F?Nt:new F(function(Yt){Yt(Nt)})).then(Xe,ot)}lt((ve=ve.apply(z,T||[])).next())})},at=function(z,T){var F,ve,Ae,We,Xe={label:0,sent:function(){if(1&Ae[0])throw Ae[1];return Ae[1]},trys:[],ops:[]};return We={next:ot(0),throw:ot(1),return:ot(2)},typeof Symbol=="function"&&(We[Symbol.iterator]=function(){return this}),We;function ot(lt){return function(Tt){return function(Nt){if(F)throw new TypeError("Generator is already executing.");for(;We&&(We=0,Nt[0]&&(Xe=0)),Xe;)try{if(F=1,ve&&(Ae=2&Nt[0]?ve.return:Nt[0]?ve.throw||((Ae=ve.return)&&Ae.call(ve),0):ve.next)&&!(Ae=Ae.call(ve,Nt[1])).done)return Ae;switch(ve=0,Ae&&(Nt=[2&Nt[0],Ae.value]),Nt[0]){case 0:case 1:Ae=Nt;break;case 4:return Xe.label++,{value:Nt[1],done:!1};case 5:Xe.label++,ve=Nt[1],Nt=[0];continue;case 7:Nt=Xe.ops.pop(),Xe.trys.pop();continue;default:if(!((Ae=(Ae=Xe.trys).length>0&&Ae[Ae.length-1])||Nt[0]!==6&&Nt[0]!==2)){Xe=0;continue}if(Nt[0]===3&&(!Ae||Nt[1]>Ae[0]&&Nt[1]<Ae[3])){Xe.label=Nt[1];break}if(Nt[0]===6&&Xe.label<Ae[1]){Xe.label=Ae[1],Ae=Nt;break}if(Ae&&Xe.label<Ae[2]){Xe.label=Ae[2],Xe.ops.push(Nt);break}Ae[2]&&Xe.ops.pop(),Xe.trys.pop();continue}Nt=T.call(z,Xe)}catch(Yt){Nt=[6,Yt],ve=0}finally{F=Ae=0}if(5&Nt[0])throw Nt[1];return{value:Nt[0]?Nt[1]:void 0,done:!0}}([lt,Tt])}}};const ht=function(){function z(T){this.rt=T,this.readyState=N.CLOSED,this.ct=null,this.ut=[],this.ht=[],this.ft={}}return z.isSupport=function(){var T,F;return window&&!!window.WebTransport&&!!(!((F=(T=window.WebTransport)===null||T===void 0?void 0:T.prototype)===null||F===void 0)&&F.createBidirectionalStream)},z.prototype.getStreamByID=function(T){return this.ut.find(function(F){return F.streamID===T})||null},z.prototype.startConnect=function(T){var F=this;try{this.ct=new WebTransport(T),this.readyState=N.CONNECTING,this.ct.ready.then(function(ve){F.readyState=N.OPEN,F.onopen(ve),F.onTransportClosed()}).catch(function(ve){F.readyState=N.CLOSED,F._t(Ce.LinkFailed,ve),F.close()})}catch(ve){this.readyState=N.CLOSED,this._t(Ce.NotSupport,ve)}},z.prototype.onTransportClosed=function(){return $e(this,void 0,void 0,function(){var T;return at(this,function(F){switch(F.label){case 0:return F.trys.push([0,2,,3]),[4,this.ct.closed];case 1:return F.sent(),this.readyState!==N.CLOSED&&this.onclose&&this.onclose({code:0,message:"server-side h3 closed"}),[3,3];case 2:return T=F.sent(),this.readyState!==N.CLOSED&&this.onclose&&this.onclose(T),[3,3];case 3:return this.readyState=N.CLOSED,this.ct=null,this.ut=[],this.ht=[],this.ft={},[2]}})})},z.prototype.onopen=function(T){},z.prototype.onerror=function(T){},z.prototype.onclose=function(T){},z.prototype.onmessage=function(T,F){},z.prototype.onBackToWebSocket=function(T,F){},z.prototype._t=function(T,F){this.ct&&this.onBackToWebSocket(T,F)},z.prototype.send=function(T,F,ve,Ae){var We;return $e(this,void 0,void 0,function(){var Xe,ot=this;return at(this,function(lt){switch(lt.label){case 0:return this.ct&&F?(Xe=this.getStreamByID(F))!=null&&Xe.stream?[3,2]:Xe!=null&&Xe.isCreating?(this.ht.push({msg:T,streamID:F,type:ve,streamType:Ae}),[2]):[4,this.createStream(Ae,F)]:[2];case 1:Xe=lt.sent(),lt.label=2;case 2:if(Xe&&(Xe!=null&&Xe.stream))try{(We=Xe==null?void 0:Xe.writer)===null||We===void 0||We.write(T).then(function(){ve===_.MSG_TYPE_STREAM_CLOSED&&ot.closeStream(Xe.streamID),ot.ht=ot.ht.filter(function(Tt){var Nt;return Tt.streamID!==F||((Nt=Xe==null?void 0:Xe.writer)===null||Nt===void 0||Nt.write(Tt.msg).then(function(){}).catch(function(Yt){ot.rt.info("zn.zwt.s.0 unsend write fail ".concat(Yt==null?void 0:Yt.message))}),ve===_.MSG_TYPE_STREAM_CLOSED&&ot.closeStream(Tt.streamID),!1)})}).catch(function(Tt){var Nt;ot.rt.info("zn.zwt.s.0 write fail ".concat(Tt==null?void 0:Tt.message)),((Nt=Tt==null?void 0:Tt.message)===null||Nt===void 0?void 0:Nt.indexOf("Connection lost"))===-1&&(ot._t(Ce.WriteDataFailed,Tt),ot.close())})}catch(Tt){this._t(Ce.WriteDataFailed,Tt),this.close()}return[2]}})})},z.prototype.close=function(){return $e(this,void 0,void 0,function(){var T,F,ve=this;return at(this,function(Ae){return this.readyState=N.CLOSED,this.ct&&(T=Object.values(this.ft),F=function(){var We;(We=ve.ct)===null||We===void 0||We.close(),ve.ct=null,ve.ft={}},T.length>0?Promise.all(T).then(function(){F()}).catch(function(We){F()}):F()),this.ut=[],this.ht=[],[2]})})},z.prototype.createStream=function(T,F){return $e(this,void 0,void 0,function(){var ve,Ae,We;return at(this,function(Xe){switch(Xe.label){case 0:if(!this.ct)return[2,null];(ve=this.getStreamByID(F))||this.ut.push(ve={streamID:F,streamType:T,stream:null,writer:null,reader:null,isCreating:!0}),Xe.label=1;case 1:return Xe.trys.push([1,3,,4]),[4,this.ct.createBidirectionalStream()];case 2:return Ae=Xe.sent(),ve.stream=Ae,ve.writer=Ae.writable.getWriter(),ve.reader=Ae.readable.getReader(),ve.isCreating=!1,this.initReader(ve.reader,ve.streamID),[2,ve];case 3:return We=Xe.sent(),this._t(Ce.CreateStreamFailed,We),this.close(),[3,4];case 4:return[2,null]}})})},z.prototype.closeStream=function(T){var F;return $e(this,void 0,void 0,function(){var ve,Ae;return at(this,function(We){switch(We.label){case 0:if(ve=this.getStreamByID(T),this.ut=this.ut.filter(function(Xe){return Xe.streamID!==T}),!(ve!=null&&ve.stream))return[3,4];We.label=1;case 1:return We.trys.push([1,3,,4]),ve.stream.writable.locked&&((F=ve.writer)===null||F===void 0||F.releaseLock()),Ae=ve.stream.writable.close(),this.ft[T]=Ae,[4,Ae];case 2:return We.sent(),delete this.ft[T],[3,4];case 3:return We.sent(),[3,4];case 4:return[2]}})})},z.prototype.initReader=function(T,F){var ve,Ae;return $e(this,void 0,void 0,function(){var We,Xe,ot,lt,Tt;return at(this,function(Nt){switch(Nt.label){case 0:Nt.label=1;case 1:return Nt.trys.push([1,3,,4]),[4,T.read()];case 2:return We=Nt.sent(),Xe=We.value,ot=We.done,lt=this.getStreamByID(F),ot||!lt?(this.rt.info("zn.zwt.rd h3 stream not found ".concat(F," ").concat(!!ot," ").concat(!lt)),this.closeStream(F),T.releaseLock(),[2]):(this.onmessage&&this.onmessage(Xe,lt.streamID),[3,4]);case 3:return Tt=Nt.sent(),((ve=Tt==null?void 0:Tt.message)===null||ve===void 0?void 0:ve.indexOf("RESET_STREAM"))!==-1?(this.ut=this.ut.filter(function(Yt){return Yt.streamID!==F}),[2]):(((Ae=Tt==null?void 0:Tt.message)===null||Ae===void 0?void 0:Ae.indexOf("closed"))===-1&&(this.rt.warn("zn.zwt.rd error ".concat(Tt==null?void 0:Tt.message)),this._t(Ce.ReadDataFailed,Tt),this.close()),[2]);case 4:return[3,0];case 5:return[2]}})})},z}();var Ct,St=function(){function z(T,F,ve){this.lt=T,this.rt=F,this.proxyCtrl=ve,this.dt=null,this.server="",this.type=C.WebSocket,this.vt=null,this.retryTimer=null,this.ENV=T.env,this.eventManager=new Ke,this.Et=new Qe("connection send")}return Object.defineProperty(z.prototype,"speed",{get:function(){return this.Et.speed},enumerable:!1,configurable:!0}),z.prototype.createSocket=function(T,F,ve){var Ae=this;this.rt.info("zn.nss.0 ".concat(T," ").concat(ve)),this.server=T,this.type=F,this.type===C.WebTransport?(this.dt=new ht(this.rt),this.dt.onBackToWebSocket=function(We,Xe){Ae.type===C.WebTransport&&(Ae.resetConnectTimer(),Ae.onBackToWebSocket&&Ae.onBackToWebSocket(We,Xe))},this.dt.startConnect(T)):(this.type=C.WebSocket,this.dt=function(We,Xe,ot){return Xe%2===nr.BROWSER?function(lt,Tt){return Tt?Tt.createSocket(lt,0):new WebSocket(lt)}(We,ot):new ye(We)}(T,this.ENV%2,this.proxyCtrl)),this.bindSocketHandler(),this.startConnectCheck(ve)},z.prototype.bindSocketHandler=function(){var T=this;this.dt&&(this.dt.onopen=function(F){var ve;T.type===C.WebSocket&&(T.dt.binaryType="arraybuffer"),T.responseHandler(),T.resetConnectTimer(),(ve=T.Et)===null||ve===void 0||ve.start(3e3),T.eventManager.emit("open",F)},this.dt.onclose=function(F){var ve;T.resetConnectTimer(),(ve=T.Et)===null||ve===void 0||ve.stop(),T.eventManager.emit("close",F)},this.dt.onerror=function(F){T.resetConnectTimer(),T.eventManager.emit("error",F)})},z.prototype.startConnectCheck=function(T){var F=this;this.resetConnectTimer(),this.vt=setTimeout(function(){F.type===C.WebTransport&&F.lt.networkState===v.online?(F.resetConnectTimer(),F.onBackToWebSocket&&F.onBackToWebSocket(Ce.LinkTimeout,{message:"connect timeout"})):F.eventManager.emit("timeout")},T)},z.prototype.resetConnectTimer=function(){this.vt&&(clearTimeout(this.vt),this.vt=null)},z.prototype.responseHandler=function(){var T=this;this.dt&&(this.dt.onmessage=function(F,ve,Ae){var We=F;T.type===C.WebSocket&&(We=typeof F.data=="string"?JSON.parse(F.data):F.data),T.eventManager.emit("message",We,ve,Ae)})},z.prototype.closeSocket=function(){var T;this.dt&&(this.dt.onclose=null,this.dt.onerror=null,this.dt.close(),this.dt=null,(T=this.Et)===null||T===void 0||T.stop()),this.resetConnectTimer()},z.prototype.isNotConnected=function(){return!this.dt||this.dt.readyState!==N.OPEN},z.prototype.sendMessage=function(T,F,ve,Ae){this.isNotConnected()||this.dt&&(this.Et.add(8*T.byteLength),this.dt.send(T,F,ve,Ae))},z.prototype.onBackToWebSocket=function(T,F){},z.prototype.closeStream=function(T){var F;this.type===C.WebTransport&&((F=this.dt)===null||F===void 0||F.closeStream(T))},z.prototype.hasStream=function(T){var F,ve;return this.type===C.WebTransport&&!!(!((ve=(F=this.dt)===null||F===void 0?void 0:F.getStreamByID(T))===null||ve===void 0)&&ve.stream)},z.prototype.on=function(T,F){return this.eventManager.addEventHandler(T,F)},z.prototype.off=function(T,F){this.eventManager.removeEventHandler(T,F)},z}(),kt=function(){function z(T,F,ve){this.lt=T,this.gt=F,this.proxyCtrl=ve,this.ipStackRules=[],this.St=null,this.Tt=G.noProbe,this.Ct=2}return Object.defineProperty(z.prototype,"bt",{get:function(){var T=this.lt.customConfig,F=T.accesshubBypassConnectTime;return typeof F=="number"&&F!==0?F:T.probeByPassStrategy===Q.Default||T.ipStackMode===W.IPv4Prefer?3e3:500},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"isIpv4Prefer",{get:function(){return this.lt.customConfig.ipStackMode===W.IPv4Prefer},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"Ot",{get:function(){return this.lt.logger},enumerable:!1,configurable:!0}),z.prototype.createSockets=function(T,F){var ve=this;this.Ot.info("".concat(sr," call ").concat(JSON.stringify(T)," ").concat(JSON.stringify(F))),this.Tt=G.noProbe;var Ae=this.lt.isIpStackDetected?1e4:Vr;this.Ot.info("".concat(sr," interval ").concat(Ae)),T!=null&&T.server&&(this.Rt=T,this.At||(this.At=new St(this.lt,this.Ot,this.proxyCtrl)),this.bindServiceHandler(this.At,this.Rt),this.At.createSocket(T.server,T.linkType,Ae)),F!=null&&F.server?(this.Pt=F,this.It||(this.It=new St(this.lt,this.Ot,this.proxyCtrl)),this.Ot.info("".concat(tr," bypass time ").concat(this.bt)),this.St=setTimeout(function(){ve.bindServiceHandler(ve.It,ve.Pt),ve.It.createSocket(F.server,F.linkType,Vr)},this.bt)):this.onIPStackDetection({ipStackType:this.Rt.ipStackType===se.IPv4?se.IPv6:se.IPv4,detection:J.unreachable}),this.Tt=G.probing},z.prototype.bindServiceHandler=function(T,F){var ve=this;this.Ot.info("".concat(Wr," call ").concat(F.server));var Ae=function(Xe){ve.onIPStackDetection({ipStackType:F.ipStackType,detection:Xe})},We=function(Xe,ot){var lt=performance.now();if(ve.Ot.info("".concat(Wr," fail ").concat(F.server," ").concat(Xe," ").concat(ot.massage?JSON.stringify(ot.massage):JSON.stringify(ot.code))),!(lt-F.failTime<100)){var Tt;if(F.failTime=lt,F.tryCount++,ve.isIpv4Prefer&&F.ipStackType===se.IPv6&&ve.lt.retryLevel===Le.single&&ve.Rt.svrConnectState===U.success)ve.Ot.info("".concat(Wr," only retry once"));else if(ve.gt.Nt==G.probing&&F.tryCount<ve.Ct)return ve.Ot.info("".concat(Wr," server ").concat(F.server," retry ").concat(F.tryCount)),T.retryTimer&&(clearTimeout(T.retryTimer),T.retryTimer=null),void(T.retryTimer=setTimeout(function(){T.createSocket(F.server,F.linkType,Vr)},3e3));(ot==null?void 0:ot.code)===P.code?(Tt=J.unknown,F.svrConnectState=U.timeout):(Tt=J.unreachable,F.svrConnectState=U.fail),Ae(Tt),ve.removeServiceListener(T),T.closeSocket(),ve.checkProbeState()}};T.off("open"),T.on("open",function(){ve.Ot.info("".concat(Wr," ").concat(F.server," open ").concat(G[ve.Tt])),F.svrConnectState=U.success,Ae(J.reachable),ve.Tt===G.probing?(ve.Tt=G.probed,ve.removeServiceListener(T),ve.onSocketOpen&&ve.onSocketOpen(T,F)):ve.onNextSocketOpen&&ve.onNextSocketOpen(T,F),ve.lt.customConfig.probeByPassStrategy===Q.Default&&ve.isIpv4Prefer&&F.ipStackType===se.IPv4&&ve.St&&ve.clearByPassProbe()}),T.off("close"),T.on("close",function(Xe){We("close",Xe)}),T.off("error"),T.on("error",function(Xe){We("error",Xe)}),T.off("timeout"),T.on("timeout",function(){We("timeout",P)}),T.onBackToWebSocket=function(Xe,ot){if(ve.lt.networkState===v.online){var lt={message:ot.message||""};ve.Ot.info("".concat(Wr," back to wss reason: ").concat(Xe," ").concat(lt.message)),lt.message.includes("Connection lost")?We("error",lt):(T.closeSocket(),F.backToWss=!0,F.backToWssInfo={reason:Xe,error:lt},ve.checkIfBackToWss())}else We("error",ot)}},z.prototype.checkProbeState=function(){var T,F;((T=this.Rt)===null||T===void 0?void 0:T.svrConnectState)!==void 0&&[U.fail,U.timeout].includes(this.Rt.svrConnectState)&&(!this.Pt||((F=this.Pt)===null||F===void 0?void 0:F.svrConnectState)!==void 0&&[U.fail,U.timeout].includes(this.Pt.svrConnectState))&&(this.Ot.info("".concat(tr," sockets fail")),this.onSocketsFail&&this.onSocketsFail())},z.prototype.checkIfBackToWss=function(){var T,F,ve,Ae,We,Xe,ot,lt;this.Rt&&this.Rt.backToWss&&(this.onSocketBackToWebSocket&&this.onSocketBackToWebSocket(this.Rt,((F=(T=this.Rt)===null||T===void 0?void 0:T.backToWssInfo)===null||F===void 0?void 0:F.reason)||Ce.Unknown,((Ae=(ve=this.Rt)===null||ve===void 0?void 0:ve.backToWssInfo)===null||Ae===void 0?void 0:Ae.error)||{}),this.Pt&&this.Pt.backToWss&&this.onSocketBackToWebSocket&&this.onSocketBackToWebSocket(this.Pt,((Xe=(We=this.Pt)===null||We===void 0?void 0:We.backToWssInfo)===null||Xe===void 0?void 0:Xe.reason)||Ce.Unknown,((lt=(ot=this.Pt)===null||ot===void 0?void 0:ot.backToWssInfo)===null||lt===void 0?void 0:lt.error)||{}))},z.prototype.removeServiceListener=function(T){T.off("open"),T.off("close"),T.off("error"),T.off("timeout"),T.onBackToWebSocket=function(){},T.retryTimer&&(clearTimeout(T.retryTimer),T.retryTimer=null)},z.prototype.stopTask=function(){this.Tt==G.probing&&this.destroySockets()},z.prototype.destroySockets=function(){var T;this.Ot.info("".concat("zn.sm.ds.0"," call")),this.At&&(this.removeServiceListener(this.At),this.At.closeSocket()),this.It&&(this.removeServiceListener(this.It),(T=this.It)===null||T===void 0||T.closeSocket()),this.clearByPassProbe()},z.prototype.clearByPassProbe=function(){this.St&&(clearTimeout(this.St),this.St=null)},z.prototype.onSocketOpen=function(T,F){},z.prototype.onNextSocketOpen=function(T,F){},z.prototype.onSocketBackToWebSocket=function(T,F,ve){},z.prototype.onSocketsFail=function(){},z.prototype.onIPStackDetection=function(T){},z}(),Ut=function(){return Ut=Object.assign||function(z){for(var T,F=1,ve=arguments.length;F<ve;F++)for(var Ae in T=arguments[F])Object.prototype.hasOwnProperty.call(T,Ae)&&(z[Ae]=T[Ae]);return z},Ut.apply(this,arguments)},Lt=function(z,T,F){if(F||arguments.length===2)for(var ve,Ae=0,We=T.length;Ae<We;Ae++)!ve&&Ae in T||(ve||(ve=Array.prototype.slice.call(T,0,Ae)),ve[Ae]=T[Ae]);return z.concat(ve||Array.prototype.slice.call(T))},cn=function(){function z(T,F,ve){var Ae,We=this;this.Dt=T,this.lt=F,this.proxyCtrl=ve,this.txid=0,this.linkRetryTime=60,this.updatedMsgTime=0,this.connectServer="",this.ipStackRules=[],this.urlIndex=0,this.http3Servers=[],this.byPassUrlIndex=0,this.Nt=G.noProbe,this.serversGroup={wss:[],http3:[],wssV6:[],http3V6:[]},this.unUpdateMsgTimeTypes=[_.MSG_TYPE_HB_REQUEST,_.MSG_TYPE_HB_RESPONSE,_.MSG_TYPE_GET_CONFIG_REQUEST,_.MSG_TYPE_GET_CONFIG_RESPONSE,_.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2,_.MSG_TYPE_ACCESSHUB_DISPATCH_RESPONSE2,_.MSG_TYPE_GET_SVRADDR_REQUEST,_.MSG_TYPE_GET_SVRADDR_RESPONSE,_.MSG_TYPE_GET_APPCONFIG_REQUEST,_.MSG_TYPE_GET_APPCONFIG_RESPONSE,_.MSG_TYPE_CLOSE_CONNECTION],this.netLinkState=0,this.sendCommandList=new Ie,this.unSendCommandList=new Ie,this.sendCommandMap={},this.unSendCommandMap={},this.yt=100,this.wt=15e3,this.zt=1e3,this.Mt=5e3,this.connectInterval=1e4,this.connectRsp={},this.unlogTypes=[12,13],this.tryServers=[],this.connectStartTime=0,this.isTestedWebTransport=((Ae={})[se.IPv4]=!1,Ae[se.IPv6]=!1,Ae),this.msgCache={},this.Ht=0,this.bt=500,this.Ut="",this.Gt=function(){var Xe,ot;We.Ot.info("zn.wl.ssoh.0 server connected: ".concat((Xe=We.socketService)===null||Xe===void 0?void 0:Xe.server," open time: ").concat(Date.now()-We.Ht)),We.socketService&&We.connectServer!==((ot=We.socketService)===null||ot===void 0?void 0:ot.server)&&(We.connectServer=We.socketService.server,We.tryServers.pop(),We.tryServers.push(We.connectServer)),We.netLinkState!==2&&We.kt()},this.Vt=function(Xe){We.closeCallback("close",Xe)},this.Bt=function(Xe){We.closeCallback("error",Xe)},this.Yt=function(){var Xe;We.Ot.info(Tn+" timeout"),We.Lt(1,We.connectServer,P.code),(Xe=We.$t)===null||Xe===void 0||Xe.call(We,!0,{code:P.code,msg:""}),We.netLinkState=0,We.connectRsp.fail&&We.connectRsp.fail()},this.onUpdateMsgTimeChanged=void 0,this.updatedMsgTime=Date.now(),this.socketDetectManager=new kt(this.lt,this,this.proxyCtrl),this.socketDetectManager.onSocketOpen=function(Xe,ot){We.Ot.info("".concat(or," main server ").concat(ot.server," open socket")),We.socketService=Xe,We.setIPStackDetectedInfo(ot),We.bindSocketServiceEvent(),We.Gt()},this.socketDetectManager.onIPStackDetection=function(Xe){We.Ot.info("".concat(or," ip stack detection ").concat(JSON.stringify(Xe))),We.xt(Xe)},this.socketDetectManager.onNextSocketOpen=function(Xe,ot){We.Ot.info("".concat(or," next server ").concat(ot.server," open socket")),We.getByPassIp(Xe,ot)},this.socketDetectManager.onSocketBackToWebSocket=function(Xe,ot,lt){var Tt,Nt={message:lt.message||""};if(We.Ot.info("".concat(or," backToWss reason: ").concat(ot,", error: ").concat(Nt.message)),We.lt.enableHttp3){var Yt=Xe.server,Rn=Xe.ipStackType,nn=We.jt(Rn),en=dr(nn,We.lt.env,We.lt.appID);if(We.Ot.info("".concat(or," backToWss server: ").concat(Yt," stack: ").concat(Rn)),We.lt.enableHttp3=!1,en){var Zt=!1;if(Object.keys(en).find(function(qn){return qn===Yt})){var Cn=en[Yt].time;Date.now()-Cn>864e5&&(Zt=!0)}else Zt=!0;Zt&&(We.Ot.info("".concat(or," backToWss http3 fail")),ii(nn,We.lt.env,We.lt.appID,((Tt={})[Yt]={status:!1,time:ot===Ce.LinkTimeout?0:Date.now()},Tt),!0))}We.closeSocket(),We.netLinkState=0,We.clearMessageList(We.sendCommandList,We.sendCommandMap),We.clearMessageList(We.unSendCommandList,We.unSendCommandMap),We.Lt(1,We.connectServer,ne,ot,Nt),We._t&&We._t(ot,Nt)}},this.socketDetectManager.onSocketsFail=function(){We.Ot.info("".concat(or," socket fail")),We.Nt=G.noProbe,We.netLinkState=0,We.connectRsp.fail&&We.connectRsp.fail()}}return Object.defineProperty(z.prototype,"linkServerStorageKey",{get:function(){return this.jt(this.lt.currentIpStackType)},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"byPassStackType",{get:function(){return this.lt.currentIpStackType===se.IPv4?se.IPv6:se.IPv4},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"Ot",{get:function(){return this.lt.logger},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"speed",{get:function(){var T,F;return(F=(T=this.socketService)===null||T===void 0?void 0:T.speed)!==null&&F!==void 0?F:0},enumerable:!1,configurable:!0}),z.prototype.setIPStackDetectedInfo=function(T){this.lt.isIpStackDetected=!0;var F=T.ipStackType;this.lt.currentIpStackType=F,F===se.IPv4?(this.servers=this.serversGroup.wss,this.http3Servers=this.serversGroup.http3):(this.servers=this.serversGroup.wssV6,this.http3Servers=this.serversGroup.http3V6)},Object.defineProperty(z.prototype,"HBHandler",{set:function(T){this.qt=T},enumerable:!1,configurable:!0}),z.prototype.initEvent=function(T,F,ve,Ae,We,Xe){this.Ft=T,this.$t=F,this.Jt=ve,this.Wt=Ae,this._t=We,this.Qt=Xe},z.prototype.onSocketClose=function(){},z.prototype.setServers=function(T,F,ve,Ae){T===void 0&&(T=[]),F===void 0&&(F=[]),ve===void 0&&(ve=[]),Ae===void 0&&(Ae=[]),this.Ot.info("".concat("zn.wl.ss"," ").concat(JSON.stringify(T)," ").concat(JSON.stringify(F)," ").concat(JSON.stringify(ve)," ").concat(JSON.stringify(Ae))),this.serversGroup.wss=T,this.serversGroup.http3=F,this.serversGroup.wssV6=ve,this.serversGroup.http3V6=Ae,this.urlIndex=0,this.ipStackRules.length>0&&this.setLinkServers()},z.prototype.setHttp3Servers=function(T,F){this.Ot.info("".concat("zn.wl.shs"," ").concat(JSON.stringify(T)," ").concat(JSON.stringify(F))),(T==null?void 0:T.length)>0&&(this.serversGroup.http3=T),(F==null?void 0:F.length)>0&&(this.serversGroup.http3V6=F),this.ipStackRules.length>0&&this.setLinkServers()},z.prototype.setIpStrategy=function(T){T.length>0&&(this.Ot.info("".concat("zn.wl.sis"," rules: ").concat(JSON.stringify(T))),this.ipStackRules=T,this.setLinkServers())},z.prototype.setLinkServers=function(){this.ipStackRules.length>0&&this.ipStackRules[0]===se.IPv6?(this.Ot.info("".concat(Qn," set ipv6")),this.servers=this.serversGroup.wssV6,this.http3Servers=this.serversGroup.http3V6,this.lt.currentIpStackType=se.IPv6):(this.Ot.info("".concat(Qn," set ipv4")),this.servers=this.serversGroup.wss,this.http3Servers=this.serversGroup.http3,this.lt.currentIpStackType=se.IPv4)},z.prototype.isNeedTestWebTransport=function(T,F){return!!this.isEnableHttp3()&&(T==null?void 0:T.length)!==0&&!this.isTestedWebTransport[F]},z.prototype.destroySocket=function(T,F){this.Ot.info("zn.wl.ds.0 call "+T),this.closeSocket(),T!==A.NONE&&(F&&this.Lt(1,this.connectServer,F==null?void 0:F.code),this.$t&&this.$t(T===A.BROKEN,F,this.tryServers))},z.prototype.refreshServers=function(T){this.servers=Lt(Lt([],T,!0),this.servers,!0)},z.prototype.isEnableHttp3=function(){return!!this.lt.enableHttp3&&!!this.lt.customConfig.enableHttp3&&this.lt.appInfo.model!==Ne.Private&&!this.proxyCtrl},z.prototype.connectSocket=function(T,F,ve){var Ae,We,Xe=this;if(T===void 0&&(T=!0),this.Ot.info(Tn+" call"),!this.servers||!(!((Ae=this.servers)===null||Ae===void 0)&&Ae.length))return this.Ot.warn(Tn+" no servers"),!1;this.connectRsp.suc=F;var ot=!1;this.connectRsp.fail=function(){ve&&(ot?Xe.Ot.info(Tn+" fail cb has exec"):(ve(),ot=!0))},T&&(this.urlIndex=(this.urlIndex+1)%this.servers.length),this.closeSocket(),this.connectStartTime=Date.now(),this.Lt(0),this.netLinkState=1,this.Ht=Date.now();var lt=this.getConnectServers(),Tt=lt.mainSvrInfo,Nt=lt.byPassSvrInfo;return this.Nt===G.noProbe?(this.Ot.info("".concat(Tn," probe")),this.socketDetectManager.createSockets(Tt,Nt),this.Nt=G.probing):(this.Ot.info("".concat(Tn," createSocket")),(We=this.socketService)===null||We===void 0||We.createSocket(Tt.server,Tt.linkType,1e4)),this.connectServer=Tt.server,this.tryServers.push(this.connectServer),this.Jt&&this.Jt(!0),!0},z.prototype.Lt=function(T,F,ve,Ae,We){},z.prototype.getServersByStackType=function(T){var F,ve;return T===se.IPv4?(F=this.serversGroup.wss,ve=this.serversGroup.http3):(F=this.serversGroup.wssV6,ve=this.serversGroup.http3V6),[F,ve]},z.prototype.getConnectServers=function(){var T,F=this.Kt(this.servers,this.http3Servers,this.lt.currentIpStackType,this.urlIndex,"main");if(this.ipStackRules.length>1){var ve=this.getServersByStackType(this.byPassStackType),Ae=ve[0];(Ae==null?void 0:Ae.length)>0&&(T=this.Kt(Ae,ve[1],this.byPassStackType,this.byPassUrlIndex,"bypass"))}return{mainSvrInfo:F,byPassSvrInfo:T}},z.prototype.Kt=function(T,F,ve,Ae,We){var Xe,ot="",lt=C.WebSocket;return this.Ot.info(Tn+" "+We+" enableHttp3:"+this.isEnableHttp3()),(Xe=this.isEnableHttp3()?this.getUseableHttp3Server(F,ve):"").length>0&&(lt=C.WebTransport,ot=Xe,this.Ot.info("".concat(Tn," h3 connect ").concat(We," server ").concat(ot))),Xe||(lt=C.WebSocket,ot=T[Ae],this.Ot.info("".concat(Tn," wss connect ").concat(We," server ").concat(ot))),{server:ot,linkType:lt,ipStackType:ve,tryCount:0,failTime:0}},z.prototype.xt=function(T){this.Ot.info("".concat(Nn," ").concat(JSON.stringify(T)));var F=T.ipStackType,ve=T.detection,Ae=!1;F===se.IPv4?(this.lt.linkIpStackDetection.IPv4!==ve&&(Ae=!0),this.lt.linkIpStackDetection.IPv4=ve):F===se.IPv6&&(this.lt.linkIpStackDetection.IPv6!==ve&&(Ae=!0),this.lt.linkIpStackDetection.IPv6=ve),Ae&&(this.Ot.info("".concat(Nn," res ").concat(JSON.stringify(this.lt.linkIpStackDetection))),this.Qt(Ut({},this.lt.linkIpStackDetection)));var We=this.lt.linkIpStackDetection;this.Nt===G.probing&&We.IPv4!==J.unknown&&We.IPv6!==J.unknown&&(this.Nt=G.probed)},z.prototype.getByPassIp=function(T,F){var ve=this,Ae=Date.now(),We=F.server,Xe=F.linkType,ot=F.ipStackType;T==null||T.on("message",function(Tt){var Nt,Yt;try{if(Date.now()-Ae>ve.connectInterval)ve.Ot.info("".concat(pr," failed:").concat(We," reason:").concat(Ce.LinkTimeout," time:").concat(Date.now()-Ae,"ms"));else{var Rn=new Uint8Array(Tt),nn=ve.Dt.decodeResponse(Rn,Xe),en=nn[2];if(nn[1]===_.MSG_TYPE_GET_CONFIG_RESPONSE&&en.code===0){ve.Ot.info("".concat(pr," success:").concat(We," time: ").concat(Date.now()-Ae,"ms")),!((Nt=en.data)===null||Nt===void 0)&&Nt.client_outer_ip&&(ve.lt.byPassClientIP=(Yt=en.data)===null||Yt===void 0?void 0:Yt.client_outer_ip);var Zt=ve.getServersByStackType(ot),Cn=Zt[1];Xe===C.WebSocket&&ve.isNeedTestWebTransport(Cn,ot)&&ve.testWebTransport(Cn,ot)}ve.Qt(Ut({},ve.lt.linkIpStackDetection)),ve.socketDetectManager.removeServiceListener(T),T.off("message"),T.closeSocket()}}catch(qn){ve.Ot.info("".concat(pr," failed:").concat(We," reason:").concat(Ce.GetConfigFailed," error:").concat(JSON.stringify(qn),"  time:").concat(Date.now()-Ae,"ms"))}});var lt=this.Zt(Xe);T==null||T.sendMessage(lt.buf,lt.streamID,lt.type,L.OTHER)},z.prototype.closeCallback=function(T,F){var ve;this.Ot.info("".concat("zn.wl.cc.0"," ").concat(T," ").concat(JSON.stringify(F)));var Ae=((ve=this.socketService)===null||ve===void 0?void 0:ve.type)===C.WebTransport?"zn.wl.bse.h3":"zn.wl.bse.wss";this.Ot.warn("".concat(Ae," ").concat(T," ").concat(JSON.stringify(F.code?F.code:F))),this.Xt(F)},z.prototype.Xt=function(T){var F=(T==null?void 0:T.code)||P.code;this.Lt(1,this.connectServer,F),this.$t&&this.$t(!0,{code:F,msg:""}),this.netLinkState=0,this.connectRsp.fail&&this.connectRsp.fail()},z.prototype.bindSocketServiceEvent=function(){var T=this;this.socketService?(this.socketService.on("open",this.Gt.bind(this)),this.socketService.on("close",this.Vt.bind(this)),this.socketService.on("error",this.Bt.bind(this)),this.socketService.on("timeout",this.Yt.bind(this)),this.socketService.onBackToWebSocket=function(F,ve){var Ae,We={message:ve.message||""};if(T.Ot.info(mn+" call reason:"+F+" error:"+We.message+" h3 "+T.lt.enableHttp3+" service: "+!!T.socketService),T.lt.networkState===v.online)if(We.message.includes("Connection lost"))T.closeCallback("error",We);else{if(!T.lt.enableHttp3||!T.socketService)return;T.Ot.info(Ln+" server ".concat(T.socketService.server," fail")),T.lt.enableHttp3=!1;var Xe=dr(T.linkServerStorageKey,T.lt.env,T.lt.appID);if(Xe){var ot=!1;if(Object.keys(Xe).find(function(Tt){return Tt===T.socketService.server})){var lt=Xe[T.socketService.server].time;Date.now()-lt>864e5&&(ot=!0)}else ot=!0;ot&&(T.Ot.info(Ln+" http3 fail"),ii(T.linkServerStorageKey,T.lt.env,T.lt.appID,((Ae={})[T.socketService.server]={status:!1,time:F===Ce.LinkTimeout?0:Date.now()},Ae),!0))}T.closeSocket(),T.netLinkState=0,T.clearMessageList(T.sendCommandList,T.sendCommandMap),T.clearMessageList(T.unSendCommandList,T.unSendCommandMap),T.Lt(1,T.connectServer,ne,F,We),T._t&&T._t(F,We)}else T.closeCallback("error",We)}):this.Ot.warn(mn+" no service")},z.prototype.removeSocketServiceEvent=function(){this.Ot.info("zn.wl.rsse.0 call ".concat(!!this.socketService)),this.socketService&&(this.socketService.off("open"),this.socketService.off("close"),this.socketService.off("error"),this.socketService.off("timeout"),this.socketService.off("message"),this.socketService=null)},z.prototype.releaseSocketDetectTask=function(){this.Ot.info("zn.wl.rsdt.0 call"),this.socketDetectManager&&this.socketDetectManager.stopTask(),this.closeSocket(),this.netLinkState=0},z.prototype.kt=function(){this.Ot.info("zn.wl.osso.0 call"),this.connectRsp.suc&&this.connectRsp.suc(),this.netLinkState=2,this.Lt(1,this.connectServer,0),this.Ft&&this.Ft(this.tryServers,0),this.tryServers=[],this.checkUnSendMsgs(this.unSendCommandList,this.unSendCommandMap),this.onMessage()},z.prototype.closeSocket=function(){var T,F,ve=(T=this.socketService)===null||T===void 0?void 0:T.isNotConnected();return this.Ot.info("zn.wl.cs.1"+" call ".concat(ve," ").concat(this.netLinkState)),!(ve&&this.netLinkState===0||((F=this.socketService)===null||F===void 0||F.closeSocket(),this.netLinkState=0,this.onSocketClose&&this.onSocketClose(),0))},z.prototype.release=function(){this.socketDetectManager.destroySockets(),this.stopCheck(),this.sendCommandList=new Ie,this.unSendCommandList=new Ie,this.sendCommandMap={},this.unSendCommandMap={},this.msgCache={}},z.prototype.isConnect=function(){return this.netLinkState===2},z.prototype.isDisConnect=function(){return!this.socketService||this.socketService.isNotConnected()},z.prototype.isConnecting=function(){return this.netLinkState===1},z.prototype.setState=function(T){this.netLinkState=T},z.prototype.sendMessage=function(T,F,ve,Ae,We,Xe,ot,lt,Tt){var Nt,Yt,Rn;Ae===void 0&&(Ae=!0),We===void 0&&(We=null),Xe===void 0&&(Xe=null),ot===void 0&&(ot=null),lt===void 0&&(lt={}),(lt.timeout===void 0||lt.timeout<=0)&&(lt.timeout=this.Mt),lt.isInSendMap===void 0&&(lt.isInSendMap=!0),lt.isMsgCache===void 0&&(lt.isMsgCache=!0),this.txid++;var nn={appid:this.lt.appID,biz_type:0,mode_no:this.lt.appInfo.mode,sdk_type:jn.sdkType,zegoconn_run_env:this.lt.env===0?M.ZEGOCONN_RUN_ENV_BROWSER:M.ZEGOCONN_RUN_ENV_APPLET,zegoconn_version:this.lt.appInfo.connVer};!((Nt=this.lt.appInfo)===null||Nt===void 0)&&Nt.deviceID&&(nn.device_id=this.lt.appInfo.deviceID),((Yt=this.socketService)===null||Yt===void 0?void 0:Yt.type)===C.WebTransport&&(!((Rn=this.socketService)===null||Rn===void 0)&&Rn.hasStream(F)||(Ae=!0));var en=Ut({id_name:this.lt.userId},Ae?nn:{}),Zt=Ut(Ut({txid:this.txid},en),ve),Cn=Date.now(),qn={data:Zt,txid:this.txid,sendTime:Cn,streamID:F,type:T,timeOut:Cn+lt.timeout,ack:ve.ack,success:We,error:Xe,ackFunc:ot,isSend:!0,isCheck:T!==_.MSG_TYPE_PC_UPWARD_MESSAGE,extras:lt.extras,streamType:Tt};if(lt.isInSendMap){var hr=this.sendCommandList.push(qn);this.sendCommandMap[this.txid]=hr,!this.ti&&this.startCheck()}if(!(Zt.service===10||Zt.interface_id===14)&&this.unUpdateMsgTimeTypes.includes(T)||(this.updatedMsgTime=Date.now(),this.onUpdateMsgTimeChanged&&this.onUpdateMsgTimeChanged(this.updatedMsgTime)),this.unlogTypes.indexOf(T)===-1&&this.Ot.info("zn.wl.sm type: "+T+"-"+k[T]+" streamID: "+F+" txid: "+this.txid+" no1: ".concat(Ae)),this.isConnect())this.sendUint8Data(T,Zt,F,Tt);else if(lt.isMsgCache){qn.isSend=!1;var vr=this.unSendCommandList.push(qn);this.unSendCommandMap[this.txid]=vr}},z.prototype.checkUnSendMsgs=function(T,F){var ve=this;T.forEach(function(Ae){return!Ae||(T.remove(Ae),!!Ae.U&&(delete F[Ae.U.txid],Ae.U.isSend===!1&&Ae.U.type&&Ae.U.streamID&&Ae.U.data&&(ve.sendUint8Data(Ae.U.type,Ae.U.data,Ae.U.streamID,Ae.U.streamType),Ae.U.isSend=!0),!1))})},z.prototype.clearUnsentMsgs=function(T){var F=this;this.unSendCommandList.forEach(function(ve){var Ae;((Ae=ve==null?void 0:ve.U)===null||Ae===void 0?void 0:Ae.streamID)===T&&(F.unSendCommandList.remove(ve),delete F.unSendCommandMap[ve.U.txid])})},z.prototype.ii=function(T){return T.buffer.slice(T.byteOffset,T.byteLength+T.byteOffset)},z.prototype.sendUint8Data=function(T,F,ve,Ae){var We,Xe,ot=this.Dt.encodeRequest(T,F,ve,this.socketService.type);(We=this.socketService)===null||We===void 0||We.sendMessage(this.ii(ot),ve,T,Ae),(Xe=this.qt)===null||Xe===void 0||Xe.startHB()},z.prototype.notifyMessage=function(T,F,ve,Ae){var We;T!=null&&T.txid&&Fe.isLong(T.txid)&&T.txid.toNumber&&(T.txid=T.txid.toNumber()),this.unUpdateMsgTimeTypes.includes(F)||(this.updatedMsgTime=Date.now(),this.onUpdateMsgTimeChanged&&this.onUpdateMsgTimeChanged(this.updatedMsgTime));var Xe=(T==null?void 0:T.txid)||((We=T==null?void 0:T.data)===null||We===void 0?void 0:We.txid);if(this.unlogTypes.indexOf(F)===-1){var ot=Xe?", txid: ".concat(Xe):"";this.Ot.info(fn+" streamID: ".concat(Ae,", msgType: ").concat(F,"-").concat(k[F])+ot)}Xe&&this.isRspMsg(Xe)?this.handleSendCommandMsgRsp(F,Xe,T,{size:ve}):this.Wt(Ae,F,T,{size:ve})},z.prototype.onMessage=function(){var T=this;this.msgCache={},this.socketService&&(this.socketService.off("message"),this.socketService.on("message",function(F,ve){var Ae;T.lt.lastRecvMsgTime=Date.now();var We,Xe=new Uint8Array(F),ot=T.msgCache[ve];if(ot){var lt=new Uint8Array(ot.data.byteLength+Xe.byteLength);lt.set(ot.data,0),lt.set(Xe,ot.data.byteLength),Xe=lt,We=ot.streamID,delete T.msgCache[ve]}for(;Xe.byteLength;){var Tt=T.Dt.decodeResponse(Xe,T.socketService.type),Nt=Tt[0],Yt=Tt[1],Rn=Tt[2],nn=Tt[3];if(We=Nt===0?ve:Nt,!(nn>0)){T.msgCache[ve]={streamID:ve,data:Xe};break}nn>Xe.byteLength&&T.Ot.warn(fn+" streamID: ".concat(We,", msg decode error, ").concat(Xe.byteLength," ").concat(nn)),Xe=Xe.slice(nn,Xe.byteLength),((Ae=T.socketService)===null||Ae===void 0?void 0:Ae.type)===C.WebSocket&&Yt===_.MSG_TYPE_GET_CONFIG_RESPONSE&&T.isNeedTestWebTransport(T.http3Servers,T.lt.currentIpStackType)&&T.testWebTransport(T.http3Servers,T.lt.currentIpStackType),T.notifyMessage(Rn,Yt,nn,We)}}))},z.prototype.isRspMsg=function(T){return this.sendCommandMap[T]!==void 0},z.prototype.startCheck=function(){var T=this;this.ni(this.sendCommandList,this.sendCommandMap,this.unSendCommandList,this.unSendCommandMap),this.ti=setTimeout(function(){T.startCheck()},this.zt)},z.prototype.stopCheck=function(){this.ei(this.sendCommandList),this.ti&&(clearTimeout(this.ti),this.ti=null)},z.prototype.ni=function(T,F,ve,Ae){var We=this,Xe=Date.now(),ot=0;T.forEach(function(lt){if(!lt)return!0;if(!lt.U)return!1;if(lt.U.timeOut<=Xe){T.remove(lt),delete F[lt.U.txid];var Tt=Ae[lt.U.txid];if(Tt&&(ve.remove(Tt),delete Ae[lt.U.txid]),!(lt.U.error==null||lt.U.sendTime+We.wt<Xe)){var Nt=lt.U.error;lt.U.isCheck&&Nt&&Nt({},lt.U.txid,Fn)}if(++ot>=We.yt)return!0}return!1})},z.prototype.ei=function(T){T.forEach(function(F){if(!F)return!0;if(T.remove(F),!F.U)return!1;if(F.U.isSend&&F.U.error){var ve=F.U.error,Ae=F.U.txid;F.U.isCheck&&setTimeout(function(){ve({},Ae,Fn)},0)}return!1})},z.prototype.clearMessageList=function(T,F){T.forEach(function(ve){if(!ve)return!0;if(T.remove(ve),!ve.U)return!1;if(ve.U.error){var Ae=ve.U.error,We=ve.U.txid;ve.U.isCheck&&setTimeout(function(){F[ve.U.txid]&&delete F[ve.U.txid],Ae({},We,Fn)},0)}return!1})},z.prototype.handleSendCommandMsgRsp=function(T,F,ve,Ae){var We=this.sendCommandMap[F];if(We!=null){var Xe=We.U;Xe!=null&&Xe.ack||(delete this.sendCommandMap[F],this.sendCommandList.remove(We)),ve.code&&ve.code!==0?Xe&&Xe.error!=null&&(Xe.error(ve,F),Xe.success=null,Xe.error=null):T===_.MSG_TYPE_PUSH_EXCEPTION?(ve.code=ve.reason,ve.message=ve.msg,delete ve.reason,delete ve.msg,Xe&&Xe.error!=null&&(Xe.error(ve,F),Xe.success=null,Xe.error=null)):T===_.MSG_TYPE_HTTP_REQUEST_ACK?Xe&&Xe.ackFunc!=null&&Xe.ackFunc(ve,F):Xe&&Xe.success!=null&&(Xe.success(ve,F,Ae),Xe.success=null,Xe.error=null)}},z.prototype._t=function(T,F){},z.prototype.Qt=function(T){},z.prototype.jt=function(T){return T===se.IPv4?"z_net_http3_servers_status":"z_net_http3_v6_servers_status"},z.prototype.Zt=function(T){var F,ve;this.txid++;var Ae={appid:this.lt.appID,biz_type:0,mode_no:this.lt.appInfo.mode,sdk_type:jn.sdkType,zegoconn_run_env:this.lt.env===0?M.ZEGOCONN_RUN_ENV_BROWSER:M.ZEGOCONN_RUN_ENV_APPLET,zegoconn_version:this.lt.appInfo.connVer};!((F=this.lt.appInfo)===null||F===void 0)&&F.deviceID&&(Ae.device_id=(ve=this.lt.appInfo)===null||ve===void 0?void 0:ve.deviceID);var We=Ut({id_name:this.lt.userId},Ae),Xe=this.lt.appInfo.geoFencing,ot=Ut(Ut({txid:this.txid},We),{geofencing_type:Xe==null?void 0:Xe.type,geofencings:Xe==null?void 0:Xe.list}),lt=_.MSG_TYPE_GET_CONFIG_REQUEST,Tt=Date.now(),Nt=this.Dt.encodeRequest(lt,ot,Tt,T);return{buf:this.ii(Nt),streamID:Tt,type:lt}},z.prototype.getUseableHttp3Server=function(T,F){var ve="",Ae=dr(this.jt(F),this.lt.env,this.lt.appID);if(this.Ot.info(Rr+" cache:"+JSON.stringify(Ae)),Ae)for(var We=0,Xe=Object.keys(Ae);We<Xe.length;We++){var ot=Xe[We];if(Ae[ot].status&&T.includes(ot)){ve=ot;break}}return this.Ot.info(Rr+" "+ve),ve},z.prototype.si=function(T,F){if(!T.length)return[];var ve=T,Ae=dr(F,this.lt.env,this.lt.appID);if(Ae){for(var We=0,Xe=Object.keys(Ae);We<Xe.length;We++){var ot=Xe[We];if(T.includes(ot)){var lt=Ae[ot].time;Date.now()-lt>864e5&&delete Ae[ot]}else delete Ae[ot]}ii(F,this.lt.env,this.lt.appID,Ae),ve=T.filter(function(Tt){return!Ae[Tt]})}return Array.from(new Set(ve))},z.prototype.testWebTransport=function(T,F){this.isTestedWebTransport[F]=!0;var ve=this.jt(F),Ae=this.si(T,ve);this.Ot.info("zn.wl.h3.t servers:"+JSON.stringify(Ae)+" ip "+F),this.startTestHttp3Server(Ae,ve)},z.prototype.startTestHttp3Server=function(T,F){var ve=this;if(T.length){var Ae=T.shift();this.Ot.info("zn.wl.h3.t.0 start:"+Ae);var We=new ht(this.Ot),Xe=Date.now();We.onBackToWebSocket=function(ot){var lt;ve.Ot.info("".concat(ir," failed:").concat(Ae," reason:").concat(ot," time:").concat(Date.now()-Xe,"ms")),ii(F,ve.lt.env,ve.lt.appID,((lt={})[Ae]={status:!1,time:Date.now()},lt),!0),ve.startTestHttp3Server(T,F)},We.onopen=function(ot){var lt=ve.Zt(C.WebTransport);We.send(lt.buf,lt.streamID,lt.type,L.OTHER)},We.onmessage=function(ot){var lt,Tt;try{if(Date.now()-Xe>ve.connectInterval)ve.Ot.info("".concat(ir," failed:").concat(Ae," reason:").concat(Ce.LinkTimeout," time:").concat(Date.now()-Xe,"ms"));else{var Nt=new Uint8Array(ot),Yt=ve.Dt.decodeResponse(Nt,C.WebTransport);if(Yt[1]===_.MSG_TYPE_GET_CONFIG_RESPONSE&&Yt[2].code===0)return ve.Ot.info("".concat("zn.wl.h3.t.1"," success:").concat(Ae," time: ").concat(Date.now()-Xe,"ms storageKey: ").concat(F)),ii(F,ve.lt.env,ve.lt.appID,((lt={})[Ae]={status:!0,time:Date.now()},lt),!0),void We.close()}}catch(Rn){ve.Ot.info("".concat(ir," failed:").concat(Ae," reason:").concat(Ce.GetConfigFailed," error:").concat(JSON.stringify(Rn),"  time:").concat(Date.now()-Xe,"ms"))}We.close(),We=null,ii(F,ve.lt.env,ve.lt.appID,((Tt={})[Ae]={status:!1,time:Date.now()},Tt),!0),ve.startTestHttp3Server(T,F)},We.startConnect(Ae)}},z}(),_n=function(){function z(T,F,ve){this.oi=T,this.Dt=F,this.stateCenter=ve}return Object.defineProperty(z.prototype,"appInfo",{get:function(){return this.stateCenter.appInfo},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"Ot",{get:function(){return this.stateCenter.logger},enumerable:!1,configurable:!0}),z.prototype.getConfig=function(T,F){this.Ot.info("zn.nab.gc call");var ve=this.oi.getFreeStream(L.OTHER),Ae=this.appInfo.geoFencing;ve.sendMessage(_.MSG_TYPE_GET_CONFIG_REQUEST,{geofencing_type:Ae==null?void 0:Ae.type,geofencings:Ae==null?void 0:Ae.list,dispatch_tag:this.stateCenter.customConfig.dispatchTag},T,F)},z.prototype.dispatchURL=function(T,F){var ve=this;this.Ot.info(Ve+" call");var Ae=this.oi.getFreeStream(L.OTHER),We=this.appInfo.geoFencing;Ae.sendMessage(_.MSG_TYPE_ACCESSHUB_DISPATCH_REQUEST2,{geofencing_type:We==null?void 0:We.type,geofencings:We==null?void 0:We.list,dispatch_tag:this.stateCenter.customConfig.dispatchTag,addr_type:this.stateCenter.customConfig.ipStackMode===0?0:1},function(Xe){ve.Ot.info(Ve+" suc "),T&&T(Xe)},function(Xe,ot,lt){ve.Ot.info(Ve+" fail"),F&&F(lt||Xe)})},z.prototype.getAppConfig=function(T,F,ve,Ae,We,Xe){var ot=this;return new Promise(function(lt,Tt){ot.Ot.info(Ot+" call");var Nt={id_name:F,config_key:T,token:ve,mode_no:ot.appInfo.mode,etag:We,is_special_customer:Xe!=null&&Xe.isSpecial?1:0},Yt=function(Rn,nn,en){if(en)return ot.Ot.error(Ot+" fail "+JSON.stringify(en)),void Tt(en);if(Rn.code===0){ot.Ot.info(Ot+" suc");var Zt=ot.decodeConfigMessage(Rn.data.data);lt({code:0,data:Zt,etag:Rn.data.etag})}else ot.Ot.error(Ot+" fail "+Rn.code),Tt({code:Rn.code})};ot.oi.getFreeStream(L.OTHER).sendMessage(_.MSG_TYPE_GET_APPCONFIG_REQUEST,Nt,Yt,Yt,null,{timeout:Ae})})},z.prototype.decodeConfigMessage=function(T){return this.Dt.decodeConfigMessage(T)},z.prototype.getSvrAddr=function(){var T=this;return new Promise(function(F,ve){T.Ot.info("".concat(mt," call"));var Ae=T.oi.getFreeStream(L.OTHER),We=T.appInfo.geoFencing;Ae.sendMessage(_.MSG_TYPE_GET_SVRADDR_REQUEST,{geofencing_type:We==null?void 0:We.type,geofencings:We==null?void 0:We.list,dispatch_tag:T.stateCenter.customConfig.dispatchTag,addr_type:T.stateCenter.customConfig.ipStackMode===0?0:2},function(Xe){T.Ot.info("".concat(mt," suc")),F(Xe)},function(Xe,ot,lt){T.Ot.info("".concat(mt," fail")),ve(lt||Xe)})})},z}();(function(z){z.Lazy="lazy",z.Periodic="periodic"})(Ct||(Ct={}));var vn=function(){function z(T,F){this.oi=T,this.lt=F,this.ri=null,this.ci=5,this.ui=10,this.hi=0,this.ai=0,this.fi=0,this.mode=Ct.Lazy}return Object.defineProperty(z.prototype,"_i",{get:function(){return this.oi.getHbStream()},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"Ot",{get:function(){return this.lt.logger},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"li",{get:function(){var T=this.lt.lastRecvMsgTime;return!!T&&Date.now()-T>1e3*this.ci},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"di",{get:function(){var T=this.fi;return!!T&&Date.now()-T>1e3*this.ui},enumerable:!1,configurable:!0}),z.prototype.init=function(T){this.Ot.info("zn.nhb.ii call. "),T.data.logic_hb_interval>=1&&T.data.logic_hb_interval<=10&&(this.ci=T.data.logic_hb_interval),T.data.logic_hb_timeout>=3&&T.data.logic_hb_timeout<=30&&(this.ui=T.data.logic_hb_timeout),this.ai=0,this.hi=this.ui/this.ci,this.startHB()},z.prototype.startHB=function(){var T=this;if(this._i){var F=this.li;if(this.Ot.debug("zn.nhb.rs call "+F),!F&&this.fi&&(this.Ot.info(rn+" stop check."),this.fi=0),this.ri!==null){if(F||this.mode===Ct.Periodic)return;clearTimeout(this.ri)}var ve=this.ri=setTimeout(function(){T.ri===ve&&(T.ri=null),T.li&&!T.fi&&(T.Ot.info(rn+" start check."),T.fi=Date.now()),T.di&&(T.Ot.warn(rn+" over max hb timeout. "),T.onHBTimeout&&T.onHBTimeout()),T.Ei()},1e3*this.ci)}},z.prototype.Ei=function(){var T=this;if(this._i){this.Ot.debug(rn+" call "+this.ai++);var F=new Date().getTime(),ve=function(We,Xe,ot){var lt=new Date().getTime()-F;if(T.Ot.debug(rn+" hb callback "+lt),ot&&(ot==null?void 0:ot.code)!==0)T.Ot.warn(rn+" fail "+JSON.stringify(ot));else{if(T.fi&&(T.Ot.info(rn+" hb rsp to stop check."),T.fi=0),We==null?void 0:We.ntp_time){var Tt=We.ntp_time,Nt=typeof Tt=="number"?Tt:Tt.toNumber(),Yt=new Date().getTime();T.lt.appInfo.env===0&&T.lt.updateNTP(F,Nt,Yt)}T.ai=0}},Ae={ts:Date.now()};this._i.sendMessage(_.MSG_TYPE_HB_REQUEST,Ae,ve,ve,null)}},z.prototype.onHBTimeout=function(){},z.prototype.stop=function(){this.ri&&(clearTimeout(this.ri),this.ri=null),this.ai=0},z}(),xn=function(){return xn=Object.assign||function(z){for(var T,F=1,ve=arguments.length;F<ve;F++)for(var Ae in T=arguments[F])Object.prototype.hasOwnProperty.call(T,Ae)&&(z[Ae]=T[Ae]);return z},xn.apply(this,arguments)},An=function(){function z(T,F,ve,Ae,We,Xe){this.Ot=T,this.pi=F,this.oi=ve,this.gi=Ae,this.lt=We,this.Si=Xe,this.connectState=H.DISCONNECT,this.lastConnectState=H.DISCONNECT,this.brokenTimer=null,this.listenerList={connected:[],broken:[]},this.pcEmitState=-1,this.Ti=null,this.eventManager=new Ke,this.Si&&(this.Si.isMsgCache=!1)}return Object.defineProperty(z.prototype,"service",{get:function(){return this.pi},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"netPcStream",{get:function(){return this.Ti||this.createPcStream()},enumerable:!1,configurable:!0}),z.prototype.createPcStream=function(){var T=this.oi.createStream(L.PC);return this.Ti=T,T.onPushEvent=this.onPushEvent.bind(this),T},z.prototype.sendRequest=function(T,F,ve,Ae){var We,Xe,ot,lt,Tt,Nt,Yt=this;this.Ti||this.Ot.info(zn+" create pc ".concat(this.pi," ").concat(this.netPcStream.StreamID));var Rn=T.payload;!((We=this.Si)===null||We===void 0)&&We.encode&&(Rn=fr(T.payload));var nn={service_no:this.pi,ack:T.ack,payload:Rn,wss_message_type:(ot=(Xe=this.Si)===null||Xe===void 0?void 0:Xe.messageType)!==null&&ot!==void 0?ot:jn.wssMessageType,wss_path:(lt=this.Si)===null||lt===void 0?void 0:lt.path,wss_raw_query:(Tt=this.Si)===null||Tt===void 0?void 0:Tt.query,zegoconn_version:jn.connectVer,addr_type:this.lt.customConfig.ipStackMode===0?0:1};this.netPcStream.isConnect()||(this.Ot.info(zn+" pc is not connect"),this.eventManager.emit("connectStart")),this.netPcStream.sendMessage(_.MSG_TYPE_PC_UPWARD_MESSAGE,nn,function(){Yt.Ot.info(zn+" suc"),ve&&ve()},function(en){Yt.Ot.error(zn+" fail"),F&&F(en)},null,{isInSendMap:typeof T.isInSendMap=="boolean"&&T.isInSendMap,extras:Ae,isMsgCache:(Nt=this.Si)===null||Nt===void 0?void 0:Nt.isMsgCache})},z.prototype.onPushEvent=function(T,F,ve){var Ae;switch(this.Ot.info(bn+" msgType: ".concat(T)),T){case _.MSG_TYPE_PC_ESTABLISHED:this.netPcStream.isFirst=!1,this.pcEstablished(F,this.netPcStream.StreamID);break;case _.MSG_TYPE_PC_BROKEN:this.pcBroken();break;case _.MSG_TYPE_PC_DOWNWARD_MESSAGE:this.Ot.info(bn+" ".concat(this.pi," down ").concat((F==null?void 0:F.ts)&&F.ts.toNumber&&F.ts.toNumber()||F.ts));var We=F.payload;!((Ae=this.Si)===null||Ae===void 0)&&Ae.encode&&(We=Yn(F.payload)),this.eventManager.emit("downLoadMessage",We,ve);break;case _.MSG_TYPE_PUSH_EXCEPTION:this.Ot.info(bn+" ".concat(this.pi," exception ").concat(JSON.stringify(F))),this.eventManager.emit("exception",F,ve)}},z.prototype.on=function(T,F){return this.eventManager.addEventHandler(T,F)},z.prototype.off=function(T,F){this.eventManager.removeEventHandler(T,F)},z.prototype.pcEstablished=function(T,F){this.Ot.info("zn.napr.pe call "+JSON.stringify(T)),this.setConnectState(H.CONNECTED);var ve=oe.MANUAL;this.lastConnectState===H.BROKEN&&this.connectState===H.CONNECTED&&(ve=oe.AUTO),this.stateChanged(H.CONNECTED,ve,void 0,{proxy_link_sources:T==null?void 0:T.from,connect_stream:F}),this.brokenTimer&&clearTimeout(this.brokenTimer)},z.prototype.pcBroken=function(){var T=this;this.Ot.info("zn.napr.pb call"),this.setConnectState(H.BROKEN),this.stateChanged(H.BROKEN),this.brokenTimer=setTimeout(function(){T.stateChanged(H.DISCONNECT,ue.TEMP,void 0,{code:de})},1e3*this.gi)},z.prototype.resetBrokenTimer=function(){this.brokenTimer&&clearTimeout(this.brokenTimer)},z.prototype.Ci=function(T,F,ve){var Ae;this.Ot.info("zn.napr.cr"+" close pc ".concat(this.pi," ").concat(((Ae=this.Ti)===null||Ae===void 0?void 0:Ae.StreamID)||-1," ").concat(T," ").concat(this.connectState," ").concat(F," ").concat(ve||"")),this.connectState===H.DISCONNECT&&T!=="disconnected"||(this.Ti&&(this.Ti.closeStream(0,""),this.Ti.destroyed(),this.Ti=null),this.resetBrokenTimer(),T==="broken"?this.stateChanged(H.BROKEN,ve,void 0,{code:F}):T==="disconnected"&&this.stateChanged(H.DISCONNECT,void 0,void 0,{code:F}),this.setConnectState(H.DISCONNECT))},z.prototype.closePc=function(T,F){this.connectState!==H.DISCONNECT&&this.Ci("broken",T,F)},z.prototype.closeRequest=function(){this.Ci("disconnected",0,ue.CLOSE)},z.prototype.setConnectState=function(T){this.connectState!==T&&(this.lastConnectState=this.connectState,this.connectState=T)},z.prototype.reportEvent=function(T,F){this.eventManager.emit(T,xn({service_no:this.pi},F))},z.prototype.stateChanged=function(T,F,ve,Ae){this.Ot.info("zn.napr.sc ".concat(T," ").concat(F," ").concat(JSON.stringify(ve))),this.pcEmitState===T?this.Ot.info("zn.napr.sc same"):(this.pcEmitState=T,T===H.BROKEN?(this.eventManager.emit("broken"),this.reportEvent("pcBrokenEvent",Ae)):T===H.DISCONNECT?(this.eventManager.emit("disconnected",F,{code:ve==null?void 0:ve.code}),this.reportEvent("pcDisconnectedEvent",Ae)):T===H.CONNECTED&&(this.eventManager.emit("connected",F),this.reportEvent("pcConnectedEvent",Ae)))},z}(),Zn=function(){function z(T,F){this.oi=T,this.lt=F,this.pcStreamRequests=[],this.pcEstablishTimeout=jn.pcEstablishTimeout}return Object.defineProperty(z.prototype,"Ot",{get:function(){return this.lt.logger},enumerable:!1,configurable:!0}),z.prototype.getRequest=function(T,F){var ve=new An(this.Ot,T,this.oi,this.pcEstablishTimeout,this.lt,F);return this.pcStreamRequests.push(ve),ve},z.prototype.updateConnectState=function(T,F,ve){this.Ot.info("zn.naprm.ucs call "+T+" "+F),this.pcStreamRequests.forEach(function(Ae){Ae.stateChanged(T,F,ve,{code:(ve==null?void 0:ve.code)||0})})},z.prototype.closePCs=function(T,F){this.pcStreamRequests.forEach(function(ve){ve.closePc(T,F)})},z.prototype.setEstablishTimeout=function(T){this.pcEstablishTimeout=T},z}(),Kn=function(){function z(T,F){this.Ot=T,this.lt=F,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryTimer=null,this.maxTimer=null,this.bi=1,this.mi=0,this.Oi=3,this.isOverTime=!1,this.RETRY_MAX_TIME=90,this.h3ClosedTimes=[],this.retryIPMaxTimes=2}return z.prototype.initLink=function(T){this.link=T},z.prototype.startMaxTime=function(){var T=this;this.Ot.info(In+" call"),this.maxTimer||(this.Ot.info(In+" start max timer"),this.maxTimer=setTimeout(function(){T.Ot.warn(In+" over max time ".concat(T.RETRY_MAX_TIME,"s, stop retry")),T.isOverTime=!0,T.link.destroySocket(A.NONE),T.stopMaxTime(),T.invalid(),T.onactive(!1,_r)},1e3*this.RETRY_MAX_TIME))},z.prototype.stopMaxTime=function(){this.Ot.info("zn.rlh.sm.1 call"),this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},z.prototype.active=function(T,F,ve){var Ae=this;if(F===void 0&&(F=!1),ve===void 0&&(ve=!1),this.Ot.info(an+" call "+T+" "+F+" "+ve+" "+this.bi),this.lt.isDestroyed)return!1;if(this.retryTimer)return this.Ot.info(an+" has actived, ignore"),!1;var We=this.lt.networkState==v.offline;if(We){if(this.Ot.info(an+" check if really offline. "+this.mi),this.mi>=this.Oi)return this.Ot.warn(an+" network is broken, stop retry"),!1}else this.mi=0;if(this.link.isConnecting()&&!ve)return this.Ot.info(an+" link is connecting, ignore"),!1;if(this.isOverTime)return this.Ot.info(an+" retry over time, stop retry"),!1;if(this.bi>this.retryIPMaxTimes)return this.invalid(),this.onRetryBeyondLimit(),!1;var Xe=function(){Ae.Ot.info(an+" interval "+Ae.Ri),Ae.retryTimer=setTimeout(function(){F||Ae.link.destroySocket(A.BROKEN),Ae.link.connectSocket(T,function(){Ae.Ot.info(an+" suc"),Ae.lt.networkState=v.online,Ae.stopMaxTime(),Ae.invalid(),Ae.onactive(!0)},function(){var lt,Tt;if(((Tt=Ae.link.socketService)===null||Tt===void 0?void 0:Tt.type)===C.WebTransport&&Ae.lt.networkState===v.online&&(Ae.h3ClosedTimes.push(Date.now()),Ae.h3ClosedTimes.length===3)){if(Ae.h3ClosedTimes[2]-Ae.h3ClosedTimes[0]<=15e3)return Ae.h3ClosedTimes=[],Ae.Ot.info(Ln+" reason:"+Ce.ClosedTooOften+" error:Links break too often"),ii(Ae.link.linkServerStorageKey,Ae.lt.env,Ae.lt.appID,((lt={})[Ae.link.connectServer]={status:!1,time:Date.now()},lt),!0),Ae.lt.enableHttp3=!1,!Ae.maxTimer&&Ae.startMaxTime(),void Ae.active(!1,!0);Ae.h3ClosedTimes.shift()}Ae.Ot.info(an+" fail"),!Ae.maxTimer&&Ae.startMaxTime(),Ae.active(!0,!1,!0)}),Ae.retryTimer&&clearTimeout(Ae.retryTimer),Ae.retryTimer=null,We?Ae.mi++:Ae.bi++},F?0:1e3*Ae.Ri)};if(this.bi==1)yi().then(function(lt){Ae.Ri=Math.floor(lt*(1-Ae.RETRY_START_TIME_INTERVAL)+Ae.RETRY_START_TIME_INTERVAL),Xe()}).catch(function(){Ae.Ri=.5*Ae.RETRY_START_TIME_INTERVAL,Xe()});else{var ot=Math.pow(2,Math.round(this.bi/this.RETRY_CONTINUE_COUNT+1));this.Ri=ot>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:ot,Xe()}return!0},z.prototype.onactive=function(){for(var T=[],F=0;F<arguments.length;F++)T[F]=arguments[F]},z.prototype.onRetryBeyondLimit=function(){},z.prototype.init=function(T,F,ve,Ae){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,typeof T=="number"&&T<3600&&(this.RETRY_MAX_TIME=T),typeof F=="number"&&(this.RETRY_START_TIME_INTERVAL=F),typeof ve=="number"&&(this.RETRY_CONTINUE_COUNT=ve),typeof Ae=="number"&&(this.RETRY_MAX_TIME_INTERVAL=Ae)},z.prototype.invalid=function(){this.Ot.info("zn.rlh.ivd end retry"),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.bi=1,this.mi=0},z}(),Bn=function(){function z(){this.networkState=v.online,this.appInfo={appID:0,env:0,mode:jn.modeNo,model:jn.model,connVer:jn.connectVer},this.useNetAgent=!0,this.specified=!1,this.clientIP="",this.byPassClientIP="",this.timeOffset=0,this.networkRTT=0,this.enableHttp3=!1,this.isDestroyed=!1,this.lastRecvMsgTime=0,this.customConfig={enableHttp3:!1,ipStackMode:1,probeByPassStrategy:0},this.linkIpStackDetection={IPv4:J.unknown,IPv6:J.unknown},this.isIpStackDetected=!1,this.currentIpStackType=se.IPv4,this.ipList={ipv4:[],ipv6:[]},this.enableHttp3=ht.isSupport()}return Object.defineProperty(z.prototype,"appID",{get:function(){return this.appInfo.appID},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"env",{get:function(){return this.appInfo.env},enumerable:!1,configurable:!0}),z.prototype.updateNTP=function(T,F,ve){if(!(T>ve)){var Ae=ve-T;this.timeOffset=Math.round((F-T+(F-ve))/2);var We=Math.round(F+Ae/2);(!this.networkRTT||Ae<this.networkRTT)&&(this.networkRTT=Ae,this.ntpTimeInfo={performanceTime:Math.round(performance.now()),ntp:We})}},z}(),Jr=function(){function z(){this.level=1}return z.prototype.setLogLevel=function(T){var F;return this.level=(F=ui[T])!==null&&F!==void 0?F:this.level,!0},z.prototype.log=function(){for(var T=[],F=0;F<arguments.length;F++)T[F]=arguments[F];if(!(this.level>1)){var ve=T.join(" ");console.log(ve)}},z.prototype.debug=function(){for(var T=[],F=0;F<arguments.length;F++)T[F]=arguments[F];if(!(this.level>0)){var ve=T.join(" ");console.debug(ve)}},z.prototype.info=function(){for(var T=[],F=0;F<arguments.length;F++)T[F]=arguments[F];if(!(this.level>1)){var ve=T.join(" ");console.info(ve)}},z.prototype.warn=function(){for(var T=[],F=0;F<arguments.length;F++)T[F]=arguments[F];if(!(this.level>2)){var ve=T.join(" ");console.warn(ve)}},z.prototype.error=function(){for(var T=[],F=0;F<arguments.length;F++)T[F]=arguments[F];if(!(this.level>3)){var ve=T.join(" ");console.error(ve)}},z}(),ui={debug:0,info:1,warn:2,error:3,report:99,disable:100},Zr=function(){return Zr=Object.assign||function(z){for(var T,F=1,ve=arguments.length;F<ve;F++)for(var Ae in T=arguments[F])Object.prototype.hasOwnProperty.call(T,Ae)&&(z[Ae]=T[Ae]);return z},Zr.apply(this,arguments)},kr=function(){function z(T,F,ve){this.Ot=T,this.oi=F,this.pi=ve}return Object.defineProperty(z.prototype,"netHttpStream",{get:function(){return this.oi.getFreeStream(L.HTTP)},enumerable:!1,configurable:!0}),z.prototype.sendRequest=function(T,F,ve,Ae,We){var Xe=this,ot=T.disableLog,lt={service_no:this.pi,ack:T.ack,headers:T.headers,body:fr(JSON.stringify(T.body)),id_name:T.idName,method_no:T.method_no,stick:T.stick,location:T.location,reduce_resp_header:T.reduceRspHeaders?1:0};this.netHttpStream.sendMessage(_.MSG_TYPE_HTTP_REQUEST,lt,function(Tt){var Nt=(Tt==null?void 0:Tt.headers).find(function(nn){return(nn==null?void 0:nn.name)==="Content-Encoding"});if((Nt==null?void 0:Nt.val)==="gzip")!ot&&Xe.Ot.info(Jn+" gzip");else if(Tt.body){var Yt=Yn(Tt.body);Tt.body=Yt}var Rn=Zr(Zr({},Tt),{body:void 0});!ot&&Xe.Ot.info(Jn+" suc "+JSON.stringify(Rn)),F&&F(Tt)},function(Tt,Nt,Yt){!ot&&Xe.Ot.error(Jn+" fail"),ve&&ve(Yt||Tt)},function(Tt){!ot&&Xe.Ot.error(Jn+" ack"),Ae&&Ae(Tt)},We)},z.prototype.sendRequest2=function(T,F,ve,Ae,We){var Xe=this,ot=T.format===1?fr(JSON.stringify(T.body)):T.body,lt={ack:T.ack,body:ot,id_name:T.idName,method:T.method,interface_id:T.interfaceID,token:T.token,reduce_resp_header:T.reduceRspHeaders?1:0};T.headers&&(lt.headers=T.headers),T.resID&&(lt.res_id=T.resID),T.urlParams&&(lt.params=T.urlParams),T.mode&&(lt.mode=T.mode),this.netHttpStream.sendMessage(_.MSG_TYPE_HTTP_REQUEST2,lt,function(Tt,Nt){var Yt=(Tt==null?void 0:Tt.headers).find(function(en){return(en==null?void 0:en.name)==="Content-Encoding"});if(Tt.status_code===200){if((Yt==null?void 0:Yt.val)==="gzip")Xe.Ot.info(zr+" gzip");else if(Tt.body&&T.format===1)try{nn=Yn(Tt.body),Tt.body=nn}catch(en){Xe.Ot.info(zr+" decode "+JSON.stringify(en))}var Rn=Zr(Zr({},Tt),{body:void 0});Xe.Ot.info(zr+" suc "+JSON.stringify(Rn)),F&&F(Tt,Nt)}else{try{var nn=Yn(Tt.body);Tt.body=nn}catch(en){Xe.Ot.info(zr+" status "+Tt.status_code+" "+JSON.stringify(en))}ve&&ve(Tt)}},function(Tt,Nt,Yt){Xe.Ot.error(zr+" fail"),ve&&ve(Yt||Tt)},function(Tt){Xe.Ot.error(zr+" ack"),Ae&&Ae(Tt)},We)},z}(),Fr=function(){function z(T,F,ve){this.type=T,this.Ai=F,this.gt=ve,this.isFree=!1,this.isFirst=!0,this.timestamp=0,this.id=Date.now()}return Object.defineProperty(z.prototype,"StreamID",{get:function(){return this.Ai},enumerable:!1,configurable:!0}),z.prototype.Pi=function(){this.timestamp=Date.now()},z.prototype.refresh=function(T){this.Ai=T,this.isFirst=!0,this.Pi()},z.prototype.sendMessage=function(T,F,ve,Ae,We,Xe){var ot=this;ve===void 0&&(ve=null),Ae===void 0&&(Ae=null),We===void 0&&(We=null),Xe===void 0&&(Xe={timeout:5e3,isInSendMap:!0}),this.isFree=!1,this.Pi();var lt=this.Ai;this.gt.sendMessage(T,lt,F,this.isFirst,function(Tt,Nt,Yt){ot.type!==L.PC&&(ot.isFree=!0,ot.Pi()),ot.isFirst&&lt===ot.StreamID&&(ot.isFirst=!1),ve&&ve(Tt,Yt)},function(Tt,Nt,Yt){ot.type!==L.PC&&(ot.isFree=!0,ot.Pi()),(Yt==null?void 0:Yt.code)===1100002?ot.destroyed():ot.isFirst&&lt===ot.StreamID&&(ot.isFirst=!1),Ae&&Ae(Tt,Nt,Yt)},We,Xe,this.type)},z.prototype.onPushEvent=function(T,F,ve){},z.prototype.closeStream=function(T,F){this.gt.sendMessage(_.MSG_TYPE_STREAM_CLOSED,this.Ai,{code:T,msg:F},void 0,void 0,void 0,void 0,{isInSendMap:!1},this.type)},z.prototype.destroyed=function(){var T,F;((F=(T=this.gt)===null||T===void 0?void 0:T.socketService)===null||F===void 0?void 0:F.type)===C.WebTransport&&this.gt.socketService.closeStream(this.Ai),this.onDestroyed()},z.prototype.isConnect=function(){return this.gt.isConnect()},z.prototype.onDestroyed=function(){},z}(),qr=function(z,T,F){if(F||arguments.length===2)for(var ve,Ae=0,We=T.length;Ae<We;Ae++)!ve&&Ae in T||(ve||(ve=Array.prototype.slice.call(T,0,Ae)),ve[Ae]=T[Ae]);return z.concat(ve||Array.prototype.slice.call(T))},Sr=function(){function z(T,F){var ve=this;this.gt=T,this.lt=F,this.streamID=1,this.pcStreams=[],this.streams=[],this.gt.onSocketClose=function(){ve.refreshAllStream()}}return Object.defineProperty(z.prototype,"Ot",{get:function(){return this.lt.logger},enumerable:!1,configurable:!0}),z.prototype.destroy=function(){this.clearStreams()},z.prototype.createStream=function(T){var F=this,ve=this.getNextStreamID(),Ae=new Fr(T,ve,this.gt);return T===L.PC?this.pcStreams.push(Ae):this.streams.push(Ae),Ae.onDestroyed=function(){T===L.PC?F.pcStreams=F.pcStreams.filter(function(We){return We.StreamID!==ve}):F.streams=F.streams.filter(function(We){return We.StreamID!==ve})},Ae},z.prototype.getHbStream=function(){var T=this;if(this.hbStream)return this.hbStream;var F=new Fr(L.OTHER,this.getNextStreamID(),this.gt);return F.onDestroyed=function(){T.hbStream=void 0},this.hbStream=F,F},z.prototype.getFreeStream=function(T){if(T!==L.PC){var F=this.streams.find(function(ve){return ve.isFree&&ve.type!==L.PC});if(F)return F.isFree=!1,F}return this.createStream(T)},z.prototype.onPushEvent=function(T,F,ve,Ae){var We=this.pcStreams.find(function(Xe){return Xe.StreamID===T});We&&We.onPushEvent(F,ve,Ae)},z.prototype.getNextStreamID=function(){return this.streamID=this.streamID+2,this.streamID},z.prototype.refreshAllStream=function(){var T=this;this.Ot.info("zn.sm.ras call"),qr(qr(qr([],this.streams,!0),this.pcStreams,!0),[this.hbStream],!1).forEach(function(F){return F==null?void 0:F.refresh(T.getNextStreamID())})},z.prototype.clearStreams=function(){this.streams=[],this.pcStreams=[],this.hbStream=void 0},z}(),Dn=function(){return Dn=Object.assign||function(z){for(var T,F=1,ve=arguments.length;F<ve;F++)for(var Ae in T=arguments[F])Object.prototype.hasOwnProperty.call(T,Ae)&&(z[Ae]=T[Ae]);return z},Dn.apply(this,arguments)},li=function(z,T,F){if(F||arguments.length===2)for(var ve,Ae=0,We=T.length;Ae<We;Ae++)!ve&&Ae in T||(ve||(ve=Array.prototype.slice.call(T,0,Ae)),ve[Ae]=T[Ae]);return z.concat(ve||Array.prototype.slice.call(T))};function Hr(z,T){return T===void 0&&(T="setAppInfo"),Error("Failed to execute ".concat(z," before ").concat(T,"."))}var Xr=function(){function z(T){var F=this;this.proxyCtrl=T,this.Ii=null,this.connectServers=[],this.http3Servers=[],this.wssV6Servers=[],this.http3V6Servers=[],this.specifiedServers=[],this.getAppConfigFailCount=0,this.getAppConfigTime=0,this.linkMsgMaxInterval=90,this.connectedTime=0,this.connectid="",this.reportSeq=1,this.connectSeq=0,this.Ni=0,this.listenNetworkState=!0,this.defaultConnectServers=[],this.Di=0,this.lastLinkConnectState=0,this._t=function(ve,Ae){F.logger.warn("zn.zca.btws h333 back to ws. ".concat(ve)),F.$t(!0,{code:ne,msg:(Ae==null?void 0:Ae.message)||JSON.stringify(Ae)}),F.yi()},this.Qt=function(ve){var Ae=F.stateCenter.ipList;F.stateCenter.clientIP&&F.wi(F.stateCenter.clientIP),F.stateCenter.byPassClientIP&&F.wi(F.stateCenter.byPassClientIP);var We={linkConnectDetection:ve};(Ae.ipv4.length>0||Ae.ipv6.length>0)&&(We.ipList=Ae),F.eventManager.emit("ipDetection",We)},this.Ft=function(ve,Ae){if(F.linkConnectState=2,F.zi(),F.appInfo.env===0){var We=F.reportSeq++;F.eventManager.emit("dispatchEvent",We,"start"),F.Mi().then(function(Xe){var ot,lt,Tt=Xe.servers,Nt=Xe.http3Servers,Yt=Xe.http3Domains,Rn=Xe.wssV6Servers,nn=Xe.http3V6Servers,en=Xe.wssV6Domains,Zt=Xe.http3V6Domains,Cn=Xe.domains.map(function(gr){return gr.host}),qn=Yt.map(function(gr){return gr.host}),hr=en.map(function(gr){return gr.host}),vr=Zt.map(function(gr){return gr.host});F.http3Servers&&F.http3Servers.length||(F.http3Servers=Nt,(ot=F.zegoLink)===null||ot===void 0||ot.setHttp3Servers(Nt,[])),F.http3V6Servers&&F.http3V6Servers.length||(F.http3V6Servers=nn,(lt=F.zegoLink)===null||lt===void 0||lt.setHttp3Servers([],nn)),F.eventManager.emit("dispatchEvent",We,"end",{servers:Tt,domains:Cn,http3Servers:Nt,http3Domains:qn,wssV6Domains:hr,http3V6Domains:vr}),Tt.length>0&&F.eventManager.emit("dispatchResultUpdate",{servers:Tt,http3Servers:Nt,domains:Cn,http3Domains:qn,wssV6Servers:Rn,http3V6Servers:nn})}).catch(function(Xe){}),F.Hi().then(function(Xe){F.eventManager.emit("svrAddrResultUpdate",{accesshub_domain:Xe.accesshub_domain,logreport_domain:Xe.logreport_domain,detaillog_domain:Xe.detaillog_domain,geofencing_id:Xe.geofencing_id,accesshub_v6_domain:Xe.accesshub_v6_domain,http3_v6_domain:Xe.http3_v6_domain,logreport_v6_domain:Xe.logreport_v6_domain,detaillog_v6_domain:Xe.detaillog_v6_domain})}).catch(function(Xe){})}F.eventManager.emit("connected"),F.Ui(ve,Ae)},this.Jt=function(){F.logger.info(me+" call"),F.linkConnectState=1},this.$t=function(ve,Ae,We){F.logger.info("zn.zca.ode"+" ".concat(ve," ").concat(JSON.stringify(Ae)));var Xe=F.linkConnectState;F.linkConnectState=0,ve?F.Gi(Ae==null?void 0:Ae.code,ue.TEMP):(Xe===1&&We&&F.Ui(We,Ae==null?void 0:Ae.code),Xe!==0&&(F.eventManager.emit("disconnected"),F.netAgentPCRequestMgr.updateConnectState(H.DISCONNECT,ue.CLOSE,Ae),F.ki((Ae==null?void 0:Ae.code)||0)))},this.Wt=function(ve,Ae,We,Xe){switch(Ae){case _.MSG_TYPE_REDIRECT:case _.MSG_TYPE_REDIRECT2:F.Vi(We);break;case _.MSG_TYPE_CLOSE_CONNECTION:F.Bi(We);break;case _.MSG_TYPE_PC_BROKEN:case _.MSG_TYPE_PC_ESTABLISHED:case _.MSG_TYPE_PC_DOWNWARD_MESSAGE:case _.MSG_TYPE_PUSH_EXCEPTION:F.streamManager.onPushEvent(ve,Ae,We,Xe);break;case _.MSG_TYPE_PUSH_APPCONFIG:F.businessRequestMgr.decodeConfigMessage(We.data)}},this.logger=new Jr,this.stateCenter=new Bn,this.stateCenter.logger=this.logger,this.protobuf=new Ze(this.stateCenter),this.eventManager=new Ke,this.zegoLink=new cn(this.protobuf,this.stateCenter,this.proxyCtrl),this.Yi(),this.streamManager=new Sr(this.zegoLink,this.stateCenter),this.businessRequestMgr=new _n(this.streamManager,this.protobuf,this.stateCenter),this.zegoLink.HBHandler=this.netHeartBeatHandler=new vn(this.streamManager,this.stateCenter),this.netAgentPCRequestMgr=new Zn(this.streamManager,this.stateCenter),this.zegoLink.initEvent(this.Ft,this.$t,this.Jt,this.Wt,this._t,this.Qt),this.zegoLink.onUpdateMsgTimeChanged=function(ve){F.Li()},this.Li(),this.$i()}return z.prototype.Yi=function(){var T=this;this.zegoLink.Lt=function(F,ve,Ae,We,Xe){if(T.Ni==0&&F==0){var ot=T.reportSeq++;T.Ni=ot,T.eventManager.emit("onceConnectEvent",ot,"start")}else if(T.Ni!=0&&F==1){var lt=kn(ve);T.eventManager.emit("onceConnectEvent",T.Ni,"end",{server:ve,error:Ae,connect_type:lt,h3_reason:We,message:Xe==null?void 0:Xe.message}),T.Ni=0}}},Object.defineProperty(z.prototype,"speed",{get:function(){return this.zegoLink.speed},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"isDestroy",{get:function(){return this.stateCenter.isDestroyed},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"xi",{get:function(){return this.stateCenter.useNetAgent},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"clientIP",{get:function(){return this.stateCenter.clientIP},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"timeOffset",{get:function(){return this.stateCenter.timeOffset},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"connectIPStackType",{get:function(){return this.stateCenter.currentIpStackType},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"linkConnectState",{get:function(){return this.Di},set:function(T){this.lastLinkConnectState=this.Di,this.Di=T},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"appInfo",{get:function(){return this.stateCenter.appInfo},enumerable:!1,configurable:!0}),z.prototype.init=function(){if(this.isDestroy)throw Error("instance have destroyed, invalid call")},z.prototype.unInit=function(){this.zegoLink.release()},z.prototype.setAppInfo=function(T){var F=ft+" ".concat(JSON.stringify(T)," ; ");if(this.stateCenter.appID>0)this.logger.warn(ft+" appInfo has exist, appID: ".concat(this.stateCenter.appID));else{if(T.appID<=0)throw Error("setAppInfo, invalid appID: ".concat(T.appID));this.stateCenter.appInfo=Dn(Dn({},this.stateCenter.appInfo),T),navigator&&(this.stateCenter.networkState=navigator.onLine?v.online:v.offline,F+=" oline: ".concat(navigator.onLine)),T.env===0?this.ji():T.env===1&&this.qi(),this.logger.info(F)}},z.prototype.checkAndConnect=function(T){if(!this.stateCenter.appID)throw Hr(T,"setAppInfo");if(this.connectServers.length<=0)throw Hr(T,"setNetAgentDefaultServers or setDispatchConnectServers");if(this.isDestroy)throw Error("instance have destroyed, invalid call");this.retryLinkHandler||this.yi()},z.prototype.setUserInfo=function(T){this.stateCenter.userId=T},z.prototype.setSettingConfig=function(T){this.logger.info("zn.zca.ssc"+" ".concat(JSON.stringify(T))),T.enableHttp3!==void 0&&(this.stateCenter.customConfig.enableHttp3=T.enableHttp3,ht.isSupport()),T.dispatchTag!==void 0&&(this.stateCenter.customConfig.dispatchTag=T.dispatchTag),T.ipStackMode!==void 0&&(this.stateCenter.customConfig.ipStackMode=T.ipStackMode),T.accesshubBypassConnectTime!==void 0&&(this.stateCenter.customConfig.accesshubBypassConnectTime=T.accesshubBypassConnectTime),T.probeByPassStrategy!==void 0&&(this.stateCenter.customConfig.probeByPassStrategy=T.probeByPassStrategy)},z.prototype.setNetAgentDefaultServers=function(T,F){F===void 0&&(F=[]),this.connectServers.length===0&&(this.connectServers=li([],T,!0)),this.wssV6Servers.length===0&&F.length!==0&&(this.wssV6Servers=li([],F,!0))},z.prototype.setNetAgentSpecifiedServers=function(T){throw Error("not support")},z.prototype.setBackupDomains=function(T){throw Error("not support")},z.prototype.setDispatchConnectServers=function(T,F,ve,Ae){F===void 0&&(F=[]),ve===void 0&&(ve=[]),Ae===void 0&&(Ae=[]),T.length>0&&(this.connectServers=li([],T,!0)),F.length>0&&(this.http3Servers=li([],F,!0)),ve.length>0&&(this.wssV6Servers=li([],ve,!0)),Ae.length>0&&(this.http3V6Servers=li([],Ae,!0)),this.stateCenter.appID>0&&this.yi()},z.prototype.startHttpRequest=function(T,F,ve,Ae,We){var Xe=this;if(this.checkAndConnect("startHttpRequest"),We&&typeof(We==null?void 0:We.timeout)=="number"&&((We==null?void 0:We.timeout)<1e3||(We==null?void 0:We.timeout)>1e4))throw Error("timeout must between 1 and 10 second");var ot=this.reportSeq++;this.eventManager.emit("requestEvent",ot,"start"),this.isConnect()||(this.logger.info(_t+" link is not connect"),this.innerReconnect()),new kr(this.logger,this.streamManager,T.service).sendRequest(T,function(lt){Xe.eventManager.emit("requestEvent",ot,"end",{na_req_location:T.location,status_code:lt.status_code,err_code:0}),F&&F(lt)},function(lt){Xe.eventManager.emit("requestEvent",ot,"end",{na_req_location:T.location,err_code:lt.code||0}),ve&&ve(lt)},Ae,We)},z.prototype.startHttpRequest2=function(T,F,ve,Ae,We){var Xe=this;this.checkAndConnect("startHttpRequest2");var ot=this.reportSeq++;this.eventManager.emit("requestEvent",ot,"start"),this.isConnect()||(this.logger.info(_t+" link is not connect"),this.innerReconnect()),new kr(this.logger,this.streamManager).sendRequest2(T,function(lt,Tt){Xe.eventManager.emit("requestEvent",ot,"end",{na_req_interface:T.interfaceID,status_code:lt.status_code,err_code:0}),F&&F(lt,Tt)},function(lt){Xe.eventManager.emit("requestEvent",ot,"end",{na_req_interface:T.interfaceID,err_code:lt.code||0}),ve&&ve(lt)},Ae,We)},z.prototype.getAppConfigByAgent=function(T,F,ve,Ae,We){if(this.checkAndConnect("getAppConfigByAgent"),!this.stateCenter.userId)throw Hr("getAppConfigByAgent","setUserInfo");return this.isConnect()||(this.logger.info("zn.gab.0 link is not connect"),this.innerReconnect()),this.Fi(T,this.stateCenter.userId,F,ve,Ae,We)},z.prototype.getPCRequest=function(T,F){var ve=this;if(!this.stateCenter.appInfo)throw Hr("getPCRequest");var Ae=this.netAgentPCRequestMgr.getRequest(T,F);return Ae.on("disconnected",function(We){ve.logger.warn("zn.zca.gpr "+T+" disconnect "+We),We===ue.TEMP&&(ve.Gi(de),ve.Ji())}),Ae.on("connectStart",function(){ve.innerReconnect()}),Ae},z.prototype.connectUa=function(){this.checkAndConnect("connectUa"),this.logger.info("zn.zca.cua call"),this.retryLinkHandler&&(this.retryLinkHandler.init(),this.Wi(!0))},z.prototype.destroyConnect=function(T){this.logger.info("zn.zca.dc.0 call"),this.Qi(T)},z.prototype.destroy=function(){this.logger.info("zn.zca.dy.0 call"),this.destroyConnect(this.linkConnectState===1?He:void 0),this.Ii&&clearTimeout(this.Ii),this.retryLinkHandler&&this.retryLinkHandler.invalid(),this.retryLinkHandler&&this.retryLinkHandler.stopMaxTime(),this.zegoLink.onUpdateMsgTimeChanged=void 0,this.stateCenter.isDestroyed=!0,this.streamManager.destroy(),this.zegoLink.release()},z.prototype.isConnect=function(){return this.zegoLink.isConnect()},z.prototype.isDisConnect=function(){return this.zegoLink.isDisConnect()},z.prototype.on=function(T,F){return this.logger.debug("zn.zca.o.0 "+T),!!this.eventManager.addEventHandler(T,F)},z.prototype.off=function(T,F){this.logger.debug("zn.zca.o.1 "+T),this.eventManager.removeEventHandler(T,F)},z.prototype.setLogger=function(T){this.logger=T,this.stateCenter.logger=T},z.prototype.setAccess=function(T){this.stateCenter.useNetAgent=T},z.prototype.getVersion=function(){return"1.2.10"},z.prototype.reconnectUA=function(){this.retryLinkHandler&&(this.retryLinkHandler.startMaxTime(),this.Gi(),this.Wi(!1,Le.detail))},z.prototype.$i=function(){var T=this;this.netHeartBeatHandler.onHBTimeout=function(){T.eventManager.emit("heartBeatTimeout")}},z.prototype.ji=function(){var T=this;this.listenNetworkState&&(window.addEventListener("offline",function(){T.Ki()}),window.addEventListener("online",function(){T.Zi()}))},z.prototype.qi=function(){var T=this;wx.onNetworkStatusChange(function(F){F.isConnected?T.Zi():T.Ki()})},z.prototype.Zi=function(){this.logger.info("zn.zca.noh.0 network is online"),this.stateCenter.networkState=v.online,this.xi&&this.Xi()},z.prototype.Ki=function(){this.logger.info("zn.zca.noh.1 network is broken"),this.stateCenter.networkState=v.offline,this.xi&&this.tn()},z.prototype.Li=function(){var T=this;this.stateCenter.useNetAgent&&(this.Ii&&clearTimeout(this.Ii),this.Ii=setTimeout(function(){T.logger.info("zn.zca.clm interval: "+T.linkMsgMaxInterval+" ; start time:"+T.zegoLink.updatedMsgTime),T.Qi(De)},1e3*this.linkMsgMaxInterval))},z.prototype.yi=function(){var T=this;this.connectServers.length<=0?this.logger.error(me+" #### not server url"):(this.zegoLink.setServers(this.connectServers,this.http3Servers,this.wssV6Servers,this.http3V6Servers),this.retryLinkHandler||(this.retryLinkHandler=new Kn(this.logger,this.stateCenter)),this.retryLinkHandler.init(),this.retryLinkHandler.initLink(this.zegoLink),this.retryLinkHandler.onactive=function(F,ve){ve===_r&&(T.eventManager.emit("disconnected",ve),T.ki((ve==null?void 0:ve.code)||0),T.netAgentPCRequestMgr.updateConnectState(H.DISCONNECT,ue.TIMEOUT,ve))},this.retryLinkHandler.onRetryBeyondLimit=function(){T.Wi(!0)},this.Wi(!0))},z.prototype.Wi=function(T,F){F===void 0&&(F=Le.single),this.logger.info("zn.cna.cbd call"),this.zegoLink.releaseSocketDetectTask(),this.resetIPDetection();var ve=this.getIpConnectRule();this.logger.info("zn.cna.cbd rules "+JSON.stringify(ve)),this.stateCenter.retryLevel=F,this.zegoLink.setIpStrategy(ve),this.Ji(!1,T)},z.prototype.resetIPDetection=function(){this.stateCenter.linkIpStackDetection={IPv4:J.unknown,IPv6:J.unknown},this.stateCenter.ipList={ipv4:[],ipv6:[]},this.stateCenter.clientIP="",this.stateCenter.byPassClientIP="",this.stateCenter.isIpStackDetected=!1,this.zegoLink.Nt=G.noProbe,this.zegoLink.removeSocketServiceEvent()},z.prototype.wi=function(T){var F=function(Xe){return function(ot){return/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(ot)}(Xe)?se.IPv4:function(ot){var lt=ot.trim().replace(/^$$|$$$/g,"");return/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|(:[0-9a-fA-F]{1,4}){1,7}|[0-9a-fA-F]{1,4}(:[0-9a-fA-F]{1,4}){1,7}:|::([0-9a-fA-F]{1,4}:){0,6}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:)$/.test(lt)}(Xe)?se.IPv6:-1}(T),ve=this.stateCenter.ipList,Ae=ve.ipv4,We=ve.ipv6;F===se.IPv4?!Ae.includes(T)&&Ae.push(T):F===se.IPv6&&!We.includes(T)&&We.push(T)},z.prototype.Qi=function(T){var F;this.netHeartBeatHandler&&this.netHeartBeatHandler.stop(),(F=this.retryLinkHandler)===null||F===void 0||F.invalid(),this.zegoLink&&this.zegoLink.destroySocket(A.DISCONNECT,T)},z.prototype.zi=function(){var T=this,F=new Date().getTime(),ve=function(Ae,We,Xe){var ot,lt;if(Xe)return T.logger.info(D+" fail "+JSON.stringify(Xe)),void(((lt=T.zegoLink.socketService)===null||lt===void 0?void 0:lt.type)===C.WebTransport&&T.stateCenter.networkState===v.online&&(T.logger.info(Ln+" reason:"+Ce.GetConfigFailed+" error: get config error "),T.stateCenter.enableHttp3=!1,ii(T.zegoLink.linkServerStorageKey,T.stateCenter.env,T.stateCenter.appID,((ot={})[T.zegoLink.connectServer]={status:!1,time:Date.now()},ot),!0),T._t(Ce.GetConfigFailed,"get config error")));Ae.code===0?(T.logger.info(D+" suc "+JSON.stringify(Ae)),T.nn(Ae,F)):T.logger.info(D+" fail "+JSON.stringify(Ae))};this.businessRequestMgr.getConfig(ve,ve)},z.prototype.nn=function(T,F){var ve,Ae;if(this.netHeartBeatHandler.init(T),this.netAgentPCRequestMgr.setEstablishTimeout(T.data.pc_establish_timeout),!((ve=T==null?void 0:T.data)===null||ve===void 0)&&ve.client_outer_ip&&(this.stateCenter.clientIP=T.data.client_outer_ip,this.stateCenter.ipList.ipv4.length===0&&this.stateCenter.ipList.ipv6.length===0&&(this.stateCenter.clientIP&&this.wi(this.stateCenter.clientIP),this.eventManager.emit("ipDetection",{ipList:this.stateCenter.ipList}))),(Ae=T==null?void 0:T.data)===null||Ae===void 0?void 0:Ae.ntp_time){var We=T.data.ntp_time,Xe=typeof We=="number"?We:We.toNumber(),ot=new Date().getTime();this.stateCenter.appInfo.env===0&&this.stateCenter.updateNTP(F,Xe,ot)}this.eventManager.emit("clientInfo",{clientIP:this.clientIP,timeOffset:this.timeOffset,geofencingID:T.data.geofencing_id})},z.prototype.Mi=function(){var T=this;return new Promise(function(F,ve){T.businessRequestMgr.dispatchURL(function(Ae){var We,Xe=Ae.data,ot=Xe.wss_groups,lt=Xe.http3_groups,Tt=Xe.wss_v6_groups,Nt=Xe.http3_v6_groups;T.logger.info("".concat(Ve," wss_groups: ").concat(JSON.stringify(ot)," http3_groups:").concat(JSON.stringify(lt)," wss_v6_groups:").concat(JSON.stringify(Tt)," http3_v6_groups:").concat(JSON.stringify(Nt)));var Yt=ot.some(function(uo){return uo.host.includes("geo")}),Rn=lt.some(function(uo){return uo.host.includes("geo")}),nn=Tt==null?void 0:Tt.some(function(uo){return uo.host.includes("geo")}),en=Nt==null?void 0:Nt.some(function(uo){return uo.host.includes("geo")}),Zt=(We=T.appInfo)===null||We===void 0?void 0:We.geoFencing,Cn=Zt||Yt?ot:T.en(ot),qn=Zt||Rn?lt:T.en(lt),hr=Zt||nn?Tt:T.en(Tt),vr=Zt||en?Nt:T.en(Nt),gr=T.sn(Cn),Wn=T.sn(qn,"https"),ur=T.sn(hr),Gi=T.sn(vr,"https");F({servers:gr,http3Servers:Wn,wssV6Servers:ur,http3V6Servers:Gi,domains:Cn,http3Domains:qn,wssV6Domains:hr,http3V6Domains:vr})},function(Ae){ve(Ae)})})},z.prototype.Hi=function(){var T=this;return new Promise(function(F,ve){T.businessRequestMgr.getSvrAddr().then(function(Ae){var We=Ae.code,Xe=Ae.msg,ot=Ae.data;if(We===0){var lt=ot.accesshub_domain,Tt=ot.logreport_domain,Nt=ot.detaillog_domain,Yt=ot.accesshub_v6_domain,Rn=ot.http3_v6_domain,nn=ot.logreport_v6_domain,en=ot.detaillog_v6_domain,Zt=ot.geofencing_id;T.logger.info("".concat(mt," domains: ").concat(lt," ").concat(Tt," ").concat(Nt," ").concat(Yt," ").concat(Rn," ").concat(nn," ").concat(en)),F({accesshub_domain:lt,logreport_domain:Tt,detaillog_domain:Nt,geofencing_id:Zt,accesshub_v6_domain:Yt,http3_v6_domain:Rn,logreport_v6_domain:nn,detaillog_v6_domain:en})}else ve({code:We,msg:Xe})}).catch(function(Ae){ve(Ae)})})},z.prototype.sn=function(T,F){return F===void 0&&(F=jn.scheme),Array.isArray(T)&&T.length>0?T.map(function(ve){return F+"://"+ve.host+"/"+jn.location}):[]},z.prototype.en=function(T){var F=li([],T,!0);return F.filter(function(ve){return!!ve.host})},z.prototype.Fi=function(T,F,ve,Ae,We,Xe){var ot=this;return new Promise(function(lt,Tt){typeof F=="string"&&typeof ve=="string"?ot.businessRequestMgr.getAppConfig(T,F,ve,Ae,We,Xe).then(function(Nt){lt(Dn(Dn({},Nt),{retryCount:ot.getAppConfigFailCount}))}).catch(function(Nt){if(ot.logger.error(ce+" "+JSON.stringify(Nt)),pe.indexOf(Nt.code)>-1){var Yt=ot.getAppConfigFailCount;return ot.getAppConfigFailCount=0,void Tt(Dn(Dn({},Nt),{retryCount:Yt}))}ot.getAppConfigFailCount++,(Nt.code===20008||Nt.code===1100002)&&ot.getAppConfigFailCount<3?ot.Fi(T,F,ve,We).then(function(Rn){return lt(Rn)}).catch(function(Rn){return Tt(Rn)}):(Yt=ot.getAppConfigFailCount,ot.getAppConfigFailCount=0,Tt(Dn(Dn({},Nt),{retryCount:Yt})))}):ot.logger.error(ce+" userID or token must be string")})},z.prototype.ki=function(T){var F=new Date().getTime()-this.connectedTime;this.connectid&&this.eventManager.emit("disConnectedEvent",{duration:F,server:this.zegoLink.connectServer,connectid:this.connectid,error:T})},z.prototype.Vi=function(T){var F=T.wss_groups,ve=T.http3_groups,Ae=T.wss_v6_groups,We=T.http3_v6_groups;this.logger.info("".concat(le," wss_groups: ").concat(JSON.stringify(F)," http3_groups:").concat(JSON.stringify(ve)," wss_v6_groups:").concat(JSON.stringify(Ae)," http3_v6_groups:").concat(JSON.stringify(We)));var Xe=this.sn(F),ot=this.sn(ve,"https"),lt=this.sn(Ae),Tt=this.sn(We,"https");Xe&&Array.isArray(Xe)&&Xe.length>0?(this.Gi(1100010),this.stateCenter.specified&&(this.logger.info(le+" specified"),Xe=this.specifiedServers),this.zegoLink.setServers(Xe,ot,lt,Tt),this.Ji(!1,!0)):this.logger.warn(le+" wss_groups null")},z.prototype.Bi=function(T){var F=this;switch(this.logger.info(et+" ".concat(T.reason," ").concat(T.msg," ").concat(T.action)),T.action){case Ee.ACTION_DISPATCH:var ve=this.reportSeq++;this.eventManager.emit("dispatchEvent",ve,"start"),this.Mi().then(function(Ae){var We=Ae.servers,Xe=Ae.domains,ot=Ae.http3Servers,lt=Ae.http3Domains,Tt=Ae.wssV6Servers,Nt=Ae.http3V6Servers,Yt=Ae.wssV6Domains,Rn=Ae.http3V6Domains;if(F.eventManager.emit("dispatchEvent",ve,"end",{domains:Xe.map(function(en){return en.host}),http3Domains:lt.map(function(en){return en.host}),wssV6Domains:Yt.map(function(en){return en.host}),http3V6Domains:Rn.map(function(en){return en.host}),reason:"ConnectClosed"}),Array.isArray(We)&&We.length>0){F.eventManager.emit("dispatchResultUpdate",{servers:We,http3Servers:ot,domains:Xe.map(function(en){return en.host}),http3Domains:lt.map(function(en){return en.host}),wssV6Servers:Tt,http3V6Servers:Nt});var nn=F.stateCenter.specified?F.specifiedServers:We;F.Gi(T.reason),F.zegoLink.setServers(nn,ot,Tt,Nt),F.Ji(!1,!0)}}).catch(function(Ae){F.logger.info(et+" dispatch fail")});break;case Ee.ACTION_IDLE:T.reason===20020&&(this.Gi(T.reason),this.Ji(!1));break;case Ee.ACTION_RETRY:this.Gi(T.reason),this.Ji(!1);break;case Ee.ACTION_NEXT_GROUP:this.netAgentPCRequestMgr.closePCs(T.reason),this.eventManager.emit("broken",be.CLOSE),this.Ji()}},z.prototype.Xi=function(){this.retryLinkHandler&&(this.zegoLink.isConnect()?this.retryLinkHandler.stopMaxTime():this.Wi(!1,Le.detail))},z.prototype.tn=function(){this.Gi(1100003),this.retryLinkHandler&&(this.retryLinkHandler.invalid(),this.retryLinkHandler.startMaxTime(),this.zegoLink.setState(0))},z.prototype.innerReconnect=function(){this.logger.info(ze+" call ".concat(!!this.retryLinkHandler)),this.isDestroy?this.logger.info(ze+" destroy"):this.retryLinkHandler&&(this.retryLinkHandler.startMaxTime(),this.Ji())},z.prototype.Ji=function(T,F){var ve;!((ve=this.retryLinkHandler)===null||ve===void 0)&&ve.active(T,F)&&this.rn()},z.prototype.rn=function(){if(this.connectSeq===0){var T=this.reportSeq++;this.connectSeq=T,this.eventManager.emit("connectedEvent",T,"start")}},z.prototype.Ui=function(T,F){var ve,Ae=this;this.connectedTime=new Date().getTime(),function(We,Xe,ot,lt){return new(ot||(ot=Promise))(function(Tt,Nt){function Yt(en){try{nn(lt.next(en))}catch(Zt){Nt(Zt)}}function Rn(en){try{nn(lt.throw(en))}catch(Zt){Nt(Zt)}}function nn(en){var Zt;en.done?Tt(en.value):(Zt=en.value,Zt instanceof ot?Zt:new ot(function(Cn){Cn(Zt)})).then(Yt,Rn)}nn((lt=lt.apply(We,Xe||[])).next())})}(void 0,void 0,void 0,function(){var We,Xe,ot,lt,Tt,Nt;return function(Yt,Rn){var nn,en,Zt,Cn,qn={label:0,sent:function(){if(1&Zt[0])throw Zt[1];return Zt[1]},trys:[],ops:[]};return Cn={next:hr(0),throw:hr(1),return:hr(2)},typeof Symbol=="function"&&(Cn[Symbol.iterator]=function(){return this}),Cn;function hr(vr){return function(gr){return function(Wn){if(nn)throw new TypeError("Generator is already executing.");for(;Cn&&(Cn=0,Wn[0]&&(qn=0)),qn;)try{if(nn=1,en&&(Zt=2&Wn[0]?en.return:Wn[0]?en.throw||((Zt=en.return)&&Zt.call(en),0):en.next)&&!(Zt=Zt.call(en,Wn[1])).done)return Zt;switch(en=0,Zt&&(Wn=[2&Wn[0],Zt.value]),Wn[0]){case 0:case 1:Zt=Wn;break;case 4:return qn.label++,{value:Wn[1],done:!1};case 5:qn.label++,en=Wn[1],Wn=[0];continue;case 7:Wn=qn.ops.pop(),qn.trys.pop();continue;default:if(!((Zt=(Zt=qn.trys).length>0&&Zt[Zt.length-1])||Wn[0]!==6&&Wn[0]!==2)){qn=0;continue}if(Wn[0]===3&&(!Zt||Wn[1]>Zt[0]&&Wn[1]<Zt[3])){qn.label=Wn[1];break}if(Wn[0]===6&&qn.label<Zt[1]){qn.label=Zt[1],Zt=Wn;break}if(Zt&&qn.label<Zt[2]){qn.label=Zt[2],qn.ops.push(Wn);break}Zt[2]&&qn.ops.pop(),qn.trys.pop();continue}Wn=Rn.call(Yt,qn)}catch(ur){Wn=[6,ur],en=0}finally{nn=Zt=0}if(5&Wn[0])throw Wn[1];return{value:Wn[0]?Wn[1]:void 0,done:!0}}([vr,gr])}}}(this,function(Yt){switch(Yt.label){case 0:We="0123456789".split(""),Xe=[],ve=We.length,ot=0,Yt.label=1;case 1:return ot<16?[4,yi()]:[3,4];case 2:lt=Yt.sent(),Xe[ot]=We[0|lt*ve],Yt.label=3;case 3:return ot++,[3,1];case 4:return[3,9];case 5:Tt=void 0,Xe[8]=Xe[13]=Xe[18]=Xe[23]="-",Xe[14]="4",ot=0,Yt.label=6;case 6:return ot<36?Xe[ot]?[3,8]:[4,yi()]:[3,9];case 7:Nt=Yt.sent(),Tt=0|16*Nt,Xe[ot]=We[ot==19?3&Tt|8:Tt],Yt.label=8;case 8:return ot++,[3,6];case 9:return[2,Xe.join("")]}})}).then(function(We){Ae.connectid=We;var Xe=kn(T[0]),ot=kn(Ae.zegoLink.connectServer);Ae.eventManager.emit("connectedEvent",Ae.connectSeq,"end",{first_connect_type:Xe,connect_type:ot,count:T.length,connectid:Ae.connectid,server:Ae.zegoLink.connectServer,error:F}),Ae.connectSeq=0})},z.prototype.Gi=function(T,F){T===void 0&&(T=0),this.logger.info("zn.zca.dc.1 call"),this.netAgentPCRequestMgr.closePCs(T,F),this.zegoLink.closeSocket(),this.linkConnectState=0,this.eventManager.emit("broken"),this.lastLinkConnectState===2&&this.linkConnectState===0&&this.ki(T)},z.prototype.getNetworkTimeInfo=function(){var T=Date.now()+this.stateCenter.timeOffset,F=Math.round(this.stateCenter.networkRTT/2),ve=this.stateCenter.ntpTimeInfo;if(ve){var Ae=performance.now()-ve.performanceTime;T=Math.round(ve.ntp+Ae)}return{timestamp:T,maxDeviation:F}},z.prototype.setHeartBeatMode=function(T){var F=this.netHeartBeatHandler.mode;F!==T&&(this.logger.info("zn.shbm"+" change mode from ".concat(F," to ").concat(T)),this.netHeartBeatHandler.mode=T)},z.prototype.setLogLevel=function(T){return this.logger.setLogLevel(T)},z.prototype.getIpConnectRule=function(){var T,F,ve=[];if(this.proxyCtrl)ve.push(se.IPv4);else{var Ae=((T=this.connectServers)===null||T===void 0?void 0:T.length)!==0,We=((F=this.wssV6Servers)===null||F===void 0?void 0:F.length)!==0;switch(this.stateCenter.customConfig.ipStackMode){case 0:default:Ae&&ve.push(se.IPv4);break;case 1:Ae&&ve.push(se.IPv4),We&&ve.push(se.IPv6);break;case 2:We&&ve.push(se.IPv6),Ae&&ve.push(se.IPv4)}ve.length===0&&ve.push(se.IPv4)}return ve},z}()})(),nt})(),It.exports=E(Te(6994),Te(3788))},3052:function(It,Ye,Te){Te.d(Ye,{AF:function(){return U},D2:function(){return W},GG:function(){return Q},I2:function(){return E},OQ:function(){return Me},UV:function(){return nt},XV:function(){return se},Xs:function(){return J},b$:function(){return Re},t0:function(){return Ne},t3:function(){return we},zD:function(){return G}});var E,w,Re="NORMAL";(function(C){C[C.SWITCH_ONE=1]="SWITCH_ONE",C[C.SWITCH_TWO=2]="SWITCH_TWO"})(E||(E={})),function(C){C[C.ZegoGeoFenceTypeNone=0]="ZegoGeoFenceTypeNone",C[C.ZegoGeoFenceTypeInclude=1]="ZegoGeoFenceTypeInclude",C[C.ZegoGeoFenceTypeExclude=2]="ZegoGeoFenceTypeExclude"}(w||(w={}));var we,he,Me={ROOM_SESSION_ID_ERR:1000000152};(function(C){C[C.TT_NONE=0]="TT_NONE",C[C.TT_PC=1]="TT_PC",C[C.TT_IOS=2]="TT_IOS",C[C.TT_ANDROID=3]="TT_ANDROID",C[C.TT_MAC=4]="TT_MAC",C[C.TT_LINUX=5]="TT_LINUX",C[C.TT_WEB=6]="TT_WEB",C[C.TT_MINIPROGRAM=7]="TT_MINIPROGRAM",C[C.TT_UNKNOWN=32]="TT_UNKNOWN"})(we||(we={})),function(C){C[C.disconnected=0]="disconnected",C[C.connecting=1]="connecting",C[C.connected=2]="connected"}(he||(he={}));var nt,Ne,W,Q;(function(C){C[C.logout=0]="logout",C[C.trylogin=1]="trylogin",C[C.login=2]="login"})(nt||(nt={})),function(C){C[C.I=0]="I",C[C.H=10]="H",C[C.M=100]="M",C[C.L=1e3]="L"}(Ne||(Ne={})),function(C){C[C.offline=0]="offline",C[C.online=1]="online"}(W||(W={})),function(C){C[C.NT_NONE=0]="NT_NONE",C[C.NT_LINE=1]="NT_LINE",C[C.NT_WIFI=2]="NT_WIFI",C[C.NT_2G=3]="NT_2G",C[C.NT_3G=4]="NT_3G",C[C.NT_4G=5]="NT_4G",C[C.NT_UNKNOWN=32]="NT_UNKNOWN"}(Q||(Q={}));var se=3e3,J=3e4,G=1e5,U={MESSAGE:""}},3509:function(It,Ye,Te){Te.d(Ye,{AudioMix:function(){return Se}});var E="zc.pe.0",w="zc.pe.1",Re="zc.aep",we="zc.sev",he="zc.sma.0",Me="zc.sma.1",nt="zc.mb",Ne="zc.smb",W="zc.p.0.pe.0",Q="zc.p.0.pe.1",se="zc.p.0.re",J="zc.p.0.se",G="zc.p.0.sma.0",U="zc.smav",C="zc.p.0.mb",N="zc.p.0.smav",v=Te(8627),f=Te(5794),_=Te(6493),b=function(){function ue(oe,be,Le,pe,k){this.an=oe,this.ac=be,this.localStream=Le,this.destination=pe,this.rtcViewer=k,this.audioBufferList=[],this.replace=!1,this.effectEndedCallBack=null,this.effectEndedListener=null,this.startTimes=0,this.startOffset=0,this.pauseTimes=0,this.resumeOffset=0,this.paused=!1,this.isMixAudio=!1,this.isMixingBuffer=!1,this.loop=!1}return ue.prototype.playEffect=function(oe,be,Le,pe,k){var R=this;this.isMixAudio!==!0?this.audioBuffer?(this.startOffset=oe||0,this.loop=be||!1,this.replace=Le||!1,this.effectEndedCallBack=k,this.mixEffect(this.audioBuffer,function(){R.buffSource.loop=!!be,oe?R.buffSource.start(0,oe/1e3):R.buffSource.start(0),(0,_.HR)()&&(0,f.r)(),R.startTimes=Date.now(),R.effectEndedListener=R.effectEndedHandler.bind(R),R.buffSource.addEventListener("ended",R.effectEndedListener),pe&&pe()})):this.an.error("amu.pe.1 no audio buffer found"):this.an.warn("amu.pe.1 audio is mixing")},ue.prototype.stopMixingBuffer=function(){return this.isMixingBuffer=!1,this.stopMixingAudio()},ue.prototype.playRealTimeEffect=function(oe){var be=this;this.mixEffect(oe,function(){be.buffSource&&be.buffSource.start(0),be.buffSource&&be.buffSource.addEventListener("ended",function(){be.audioBufferList.shift(),be.audioBufferList.length>0&&be.isMixAudio&&be.playRealTimeEffect(be.audioBufferList[0])})})},ue.prototype.pauseEffect=function(){this.audioBufferList.length>0?this.an.error("amu.pe.0 real time buffer can not be paused"):(this.stopMixingAudio(!0),this.resumeOffset=(this.pauseTimes-this.startTimes+this.startOffset)%(1e3*this.audioBuffer.duration),this.paused=!0)},ue.prototype.resumeEffect=function(){return this.audioBufferList.length>0?(this.an.error("amu.pe.0 real time buffer can not be resume"),!1):(this.playEffect(this.resumeOffset,this.loop,this.replace,void 0,this.effectEndedCallBack),this.startOffset=this.resumeOffset,this.paused=!1,!0)},ue.prototype.mixEffect=function(oe,be){this.localStream?(this.gainNode=this.ac.createGain(),this.delayNode=this.ac.createDelay(1),this.delayNode.delayTime.value=0,this.buffSource=this.ac.createBufferSource(),this.buffSource.buffer=oe,this.buffSource.connect(this.gainNode),this.gainNode.connect(this.ac.destination),this.replaceTrack()&&be()):this.an.error("amu.me.0 localStream can not be found")},ue.prototype.replaceTrack=function(){if(!this.destination)return!1;this.gainNode.connect(this.delayNode),this.delayNode.connect(this.destination);var oe=this.destination.stream.getAudioTracks()[0],be=this.localStream.getTracks();return this.micTrack=this.localStream.getAudioTracks()[0],this.micTrack!==oe&&(this.micTrack?be.includes(this.micTrack)&&this.localStream.removeTrack(this.micTrack):this.an.warn("amu.rt.0 origin track not fonud"),be.includes(oe)||(this.localStream.addTrack(oe),this.rtcViewer&&this.rtcViewer.setAudio(oe))),this.isMixAudio=!0,!0},ue.prototype.effectEndedHandler=function(){this.stopMixingAudio(),this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null},ue.prototype.stopMixingAudio=function(oe){return oe===void 0&&(oe=!1),this.paused?(this.an.info("amu.sma.1 audioEffect is paused"),!oe&&this.effectEndedListener&&(this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null),!0):this.isMixAudio?this.localStream?(this.buffSource&&(this.buffSource.removeEventListener("ended",this.effectEndedListener),this.buffSource.stop(),this.pauseTimes=Date.now(),this.buffSource.disconnect(this.gainNode),this.buffSource=null),this.gainNode.disconnect(),this.delayNode.disconnect(),this.isMixAudio=!1,this.audioBufferList=[],!oe&&this.effectEndedListener&&(this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null),!0):(this.an.error("amu.sma.1 localStream can not be found"),!1):(this.an.warn("amu.sma.1 no mixing audio found"),!0)},ue.prototype.getProcess=function(){var oe=Date.now();return this.paused&&(oe=this.pauseTimes),(oe-this.startTimes+this.startOffset)%(1e3*this.audioBuffer.duration)},ue.prototype.seekTo=function(oe){oe===void 0&&(oe=0),this.startOffset=oe,this.paused?this.resumeOffset=oe:(this.stopMixingAudio(!0),this.playEffect(oe,this.loop,this.replace,void 0,this.effectEndedCallBack))},ue.prototype.mixingBuffer=function(oe,be){var Le=this;this.isMixAudio!==!0||this.audioBufferList.length!=0||this.isMixingBuffer!=0?(this.ac.resume(),this.ac.decodeAudioData(oe,function(pe){Le.audioBufferList.push(pe),Le.audioBufferList.length==1&&Le.playRealTimeEffect(Le.audioBufferList[0]),Le.isMixingBuffer=!0,be&&be()},function(pe){Le.an.error("amu.mb.0 "+pe),be&&be({code:v.S6t.code,message:v.S6t.message+" "+pe})})):this.an.error("amu.mb.0 audio is mixing")},ue.prototype.setMixingAudioVolume=function(oe){return this.gainNode?(console.error("ktv setVolume",oe),this.gainNode.gain.value=oe,!0):(this.an.error("amu.sma.2 no mixing audio found"),!1)},ue.prototype.setDelay=function(oe){return this.delayNode?(this.an.info("amu.sma.2 set delay: "+oe),this.delayNode.delayTime.value=oe,!0):(this.an.warn("amu.sma.2 no mixing audio found"),!1)},ue}(),y=function(){function ue(oe,be,Le,pe,k,R,Fe){Fe===void 0&&(Fe=1);var te=this;this.an=oe,this.acMgr=be,this.localStream=Le,this.browser=pe,this.destination=k,this.rtcViewer=R,this.volumeFactor=Fe,this.isMixAudio=!1,this.maxDelay=1,this.audioCurrentTimer=null,this.audioResumedTimer=null,this.audioEl=null,this.eventHandler={volumechange:function(Ue){var it=Ue.target;it&&te.audioNode&&te.isMediaElSrc&&(it.muted||it.paused?(te.an.info("amu.sma.0 ".concat(te.id," ").concat(Ue==null?void 0:Ue.type,": audio muted disconnect")),te.audioNode.disconnect()):(te.an.info("amu.sma.0 ".concat(te.id," ").concat(Ue==null?void 0:Ue.type,": audio is connected")),te.audioNode.connect(te.gainNode)))},canplay:function(Ue){var it=Ue.target;it&&!te.isMediaElSrc&&te.isMixAudio&&(te.an.info("amu.sma.1 ".concat(te.id," ").concat(it.id," canplay, remixing audio")),te.stopMixingAudio(),te.startMixingAudio(it))}},this.isMediaElSrc=!1,this.volume=1,this.delay=0,this.id=Date.now()%1e5+Math.floor(10*Math.random()),oe.info("amu.sma.0 ".concat(this.id," init audio mix"))}return Object.defineProperty(ue.prototype,"ac",{get:function(){return this.acMgr.ac},enumerable:!1,configurable:!0}),ue.prototype.startMixingAudio=function(oe){if(this.isMixAudio)return this.an.error("amu.sma.0 audio is mixing"),!1;if(!this.localStream)return this.an.error("amu.sma.0 localStream can not be found"),!1;var be;oe.captureStream=oe.captureStream||oe.mozCaptureStream||oe.webkitCaptureStream,this.isMixAudio=!0,this.gainNode||(this.gainNode=this.ac.createGain(),this.setMixingAudioVolume()),this.delayNode||(this.delayNode=this.ac.createDelay(this.maxDelay),this.an.info("amu.sma.1 ".concat(this.id," init set delay: ")+this.delay),this.delayNode.delayTime.value=this.delay);var Le=this.browser==="safari";this.isMediaElSrc=!0;try{var pe=this.acMgr.getMediaElementRenderer(oe);if(!pe)return!1;this.audioNode=pe.getMixNode().mixOutputNode,this.audioEl=oe}catch(Fe){be=Fe}oe.addEventListener("volumechange",this.eventHandler.volumechange),oe.addEventListener("pause",this.eventHandler.volumechange),oe.addEventListener("play",this.eventHandler.volumechange);var k=this.getBrowserInfo(),R=!1;return Le&&(k==null?void 0:k.sysVer)==="10.15.6"&&(k==null?void 0:k.ver)==="13.1.2"&&(R=!0),R&&(this.audioResumedTimer=setInterval(function(){oe.currentTime=oe.currentTime+.45},6e3)),be?(this.an.info("amu.sma.1 ".concat(this.id," create source failed: ")+be),!0):(this.audioNode&&(this.audioNode.connect(this.gainNode),this.an.info("amu.sma.1 ".concat(this.id," mix audio success."))),this.replaceTrack())},ue.prototype.getBrowserInfo=function(){var oe,be={},Le=(0,_.$t)().toLowerCase();oe=(Le.match(/x [\d._]+/gi)+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,"."),be.sysVer=oe;var pe=Le.match(/(msie|firefox|chrome|opera|version).*?([\d.]+)/);return pe&&(be.browser=pe[1].replace(/version/,"'safari"),be.ver=pe[2]),be},ue.prototype.replaceTrack=function(){if(!this.destination)return!1;this.gainNode.connect(this.delayNode),this.delayNode.connect(this.destination);var oe=this.destination.stream.getAudioTracks()[0],be=this.localStream.getTracks();return this.micTrack=this.localStream.getAudioTracks()[0],this.micTrack!==oe&&(this.micTrack?be.includes(this.micTrack)&&this.localStream.removeTrack(this.micTrack):this.an.warn("amu.rt.1 origin track not fonud"),be.includes(oe)||(this.localStream.addTrack(oe),this.rtcViewer&&this.rtcViewer.setAudio(oe))),!0},ue.prototype.stopMixingAudio=function(){return this.isMixAudio?this.localStream?(this.audioEl&&(this.audioEl.removeEventListener("volumechange",this.eventHandler.volumechange),this.audioEl.removeEventListener("pause",this.eventHandler.volumechange),this.audioEl.removeEventListener("play",this.eventHandler.volumechange),this.audioEl.removeEventListener("canplay",this.eventHandler.canplay),this.audioEl=null),this.audioNode&&(this.audioNode.disconnect(),this.audioNode=null,this.audioCurrentTimer&&(clearInterval(this.audioCurrentTimer),this.audioCurrentTimer=null),this.audioResumedTimer&&(clearInterval(this.audioResumedTimer),this.audioResumedTimer=null)),this.gainNode.disconnect(),this.delayNode.disconnect(),this.isMixAudio=!1,this.an.info("amu.sma.1 ".concat(this.id," stop mix audio success.")),!0):(this.an.error("amu.sma.1 localStream can not be found"),!1):(this.an.warn("amu.sma.1 no mixing audio found"),!0)},ue.prototype.setMixingAudioVolume=function(oe,be){if(oe===void 0?oe=this.volume:this.volume=oe,be===void 0?be=this.volumeFactor:this.volumeFactor=be,!this.gainNode)return this.an.error("amu.sma.2 no mixing audio found"),!1;var Le=oe*this.volumeFactor;return this.an.info("amu.sma.2 "+this.id+" set volume: "+Le),this.gainNode.gain.value=Le,!0},ue.prototype.setDelay=function(oe){return this.delayNode?(oe/=1e3,!isNaN(oe)&&(oe>this.maxDelay&&(oe=this.maxDelay),oe<0&&(oe=0),this.an.info("amu.sma.1 ".concat(this.id," set delay: ")+oe),this.delayNode.delayTime.value=oe,this.delay=oe,!0)):(this.an.warn("amu.sma.1 no mixing audio found"),!1)},ue}(),M=Te(4872),Y=function(){function ue(oe){this.mn=oe,this.audioDestNode=void 0,this._audioMixList=[],this._arrayBufferMap={},this._effectList=[],this.volumeFactor=1}return Object.defineProperty(ue.prototype,"delay",{get:function(){return this.pn.engineConfig.mixingAudioDelay+this.pn.engineConfig.baseMixingAudioDelay},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"an",{get:function(){return this.mn.logger},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"_localStream",{get:function(){return this.mn.localStream},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"gn",{get:function(){return this.mn.streamCenter},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"pn",{get:function(){return this.mn.stateCenter},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"ac",{get:function(){return this.acMgr.ac},enumerable:!1,configurable:!0}),Object.defineProperty(ue.prototype,"acMgr",{get:function(){return this.mn.acMgr},enumerable:!1,configurable:!0}),ue.prototype.startMixingAudio=function(oe){var be=this;if(this.an.info(G+" call"),!this._localStream)return this.an.error(G+" localStream not found"),!1;var Le=!0;return oe.forEach(function(pe){if(be._audioMixList.find(function(Fe){return Fe.media==pe}))be.an.warn(G+" mix audio already exist");else if(be._localStream){be.gn.soundLevelDelegate&&be.mn.stopSoundLevel();var k=be.createDestNode(),R=new y(be.an,be.acMgr,be._localStream,be.pn.browser,k,be.mn.rtcViewer,be.volumeFactor);be._audioMixList.push({audioMix:R,media:pe}),R.startMixingAudio(pe)||(Le=!1),R.setDelay(be.delay),be.gn.soundLevelDelegate&&be.mn.startSoundLevel()}}),Le},ue.prototype.stopMixingAudio=function(oe){var be=this;return this.an.info("zc.p.0.sma.1 call"),oe?oe.forEach(function(Le){for(var pe=0;pe<be._audioMixList.length;pe++)if(be._audioMixList[pe].media==Le){be._audioMixList[pe].audioMix.stopMixingAudio()&&be._audioMixList.splice(pe--,1);break}}):(this._audioMixList.forEach(function(Le){return Le.audioMix.stopMixingAudio()}),this._audioMixList=[]),!0},ue.prototype.setVolumeFactor=function(oe){this.an.info(N+" set factor: "+oe),isNaN(oe)&&this.an.error(N+" set factor failed"),this.volumeFactor=oe,this._audioMixList.forEach(function(be){be.audioMix.setMixingAudioVolume(void 0,oe)})},ue.prototype.setMixingAudioVolume=function(oe,be){this.an.info(N+" call");var Le=this._audioMixList.find(function(pe){return pe.media===be});return Le?(Le.audioMix.setMixingAudioVolume(oe),this.an.info(N+" call success"),!0):(this.an.error(N+" audio is not mixing"),!1)},ue.prototype.playEffect=function(oe,be,Le,pe){var k=this;if(this.an.info(W+" call"),this._localStream)if(this._effectList.find(function(Ue){return Ue.effectID==oe.effectID&&Ue.audioBuffer==be}))this.an.warn(W+" effect already exist ");else{this.gn.soundLevelDelegate&&this.mn.stopSoundLevel();var R=this.createDestNode(),Fe=new b(this.an,this.ac,this._localStream,R,this.mn.rtcViewer);Fe.audioBuffer=be;var te={processor:Fe,effectID:oe.effectID,audioBuffer:be};this._effectList.push(te),Fe.playEffect(oe.playTime,oe.loop,!1,function(){Le&&Le()},function(){for(var Ue=[],it=0;it<arguments.length;it++)Ue[it]=arguments[it];k._effectList=k._effectList.filter(function(ee){return ee!==te}),pe&&pe.apply(void 0,Ue)}),this.gn.soundLevelDelegate&&this.mn.startSoundLevel(),this.an.info(W+" play effect "+oe.effectID+" success")}else this.an.warn(W+" stream not found")},ue.prototype.pauseEffect=function(oe){var be=this._effectList.find(function(Le){return Le.effectID==oe});if(be)this.gn.soundLevelDelegate&&this.mn.stopSoundLevel(),be.processor.pauseEffect(),this.gn.soundLevelDelegate&&this.mn.startSoundLevel(),this.an.info(Q+" pause "+oe+" success");else{if(!(0,M.TE)(oe))return this.an.error(Q+" effect not found"),!1;this.gn.soundLevelDelegate&&this.mn.stopSoundLevel(),this._effectList.forEach(function(Le){return Le.processor.pauseEffect()}),this.gn.soundLevelDelegate&&this.mn.startSoundLevel()}return!0},ue.prototype.resumeEffect=function(oe){var be=this._effectList.find(function(pe){return pe.effectID==oe});if(be){this.gn.soundLevelDelegate&&this.mn.stopSoundLevel();var Le=be.processor.resumeEffect();return this.gn.soundLevelDelegate&&this.mn.startSoundLevel(),this.an.info(se+" resume "+oe+" success"),Le}return(0,M.TE)(oe)?(this.gn.soundLevelDelegate&&this.mn.stopSoundLevel(),this._effectList.forEach(function(pe){return pe.processor.resumeEffect()}),this.gn.soundLevelDelegate&&this.mn.startSoundLevel(),!0):(this.an.error(se+" no effect found"),!1)},ue.prototype.stopEffect=function(oe){var be=this._effectList.find(function(Le){return Le.effectID==oe});if(be)this.gn.soundLevelDelegate&&this.mn.stopSoundLevel(),be.processor.stopMixingAudio(),this._effectList=this._effectList.filter(function(Le){return Le!==be}),this.gn.soundLevelDelegate&&this.mn.startSoundLevel(),this.an.info(J+" pause "+oe+" success");else{if(!(0,M.TE)(oe))return this.an.error(J+" effect not found"),!1;this.gn.soundLevelDelegate&&this.mn.stopSoundLevel(),this._effectList.forEach(function(Le){return Le.processor.stopMixingAudio()}),this._effectList=[],this.gn.soundLevelDelegate&&this.mn.startSoundLevel()}return!0},ue.prototype.setEffectVolume=function(oe,be,Le){var pe=this._effectList.find(function(k){return k.effectID==be});if(pe)pe.processor.setMixingAudioVolume(oe),pe.processor.setDelay(Le||1e-7),this.an.info("zp.sev.0 set volume "+be+" success");else{if(!(0,M.TE)(be))return this.an.error("zp.sev.0 effect not found"),!1;this._effectList.forEach(function(k){return k.processor.setMixingAudioVolume(oe)})}return!0},ue.prototype.mixingBuffer=function(oe,be,Le){var pe=this;if(this.an.info(C+" call"),this._localStream)if(this._arrayBufferMap[oe])this.gn.soundLevelDelegate&&this.mn.stopSoundLevel(),this._arrayBufferMap[oe].mixingBuffer(be,function(){pe.gn.soundLevelDelegate&&pe.mn.startSoundLevel(),Le&&Le()});else{this.gn.soundLevelDelegate&&this.mn.stopSoundLevel();var k=this.createDestNode(),R=new b(this.an,this.ac,this._localStream,k,this.mn.rtcViewer);this._arrayBufferMap[oe]=R,R.mixingBuffer(be,function(){pe.gn.soundLevelDelegate&&pe.mn.startSoundLevel(),Le&&Le()})}},ue.prototype.stopMixingBuffer=function(oe){if(oe&&this._arrayBufferMap[oe])return this.gn.soundLevelDelegate&&this.mn.stopSoundLevel(),this._arrayBufferMap[oe].stopMixingBuffer(),delete this._arrayBufferMap[oe],this.gn.soundLevelDelegate&&this.mn.startSoundLevel(),!0;if((0,M.TE)(oe)){for(var be in this.gn.soundLevelDelegate&&this.mn.stopSoundLevel(),this._arrayBufferMap)this._arrayBufferMap[be].stopMixingBuffer();return this.gn.soundLevelDelegate&&this.mn.startSoundLevel(),!0}return this.an.warn(C+" arrayBuffer no found"),!1},ue.prototype.getEffectProgress=function(oe){var be=this._effectList.find(function(Le){return Le.effectID==oe});return be?be.processor.getProcess():(this.an.error(Re+"  effect not found"),0)},ue.prototype.seekAudioEffect=function(oe,be){var Le=this._effectList.find(function(pe){return pe.effectID==oe});return Le?(this.gn.soundLevelDelegate&&this.mn.stopSoundLevel(),Le.processor.seekTo(be),this.gn.soundLevelDelegate&&this.mn.startSoundLevel(),!0):(this.an.error(Re+" effect not found"),!1)},ue.prototype.stopAudioManager=function(){this.stopMixingAudio(),this.stopMixingBuffer(),this.stopEffect()},ue.prototype.createDestNode=function(){var oe=null,be=this.mn.createDestNode(this._localStream);return this.mn.audioNodeQueue||((oe=this.mn.createSrcNode()).disconnect(),oe.connect(be)),be},ue.prototype.setMixingDelay=function(oe){this._audioMixList.forEach(function(be){be.audioMix.setDelay(oe)})},ue}(),L=Te(8866),A=Te(327),H=function(ue,oe,be,Le){return new(be||(be=Promise))(function(pe,k){function R(Ue){try{te(Le.next(Ue))}catch(it){k(it)}}function Fe(Ue){try{te(Le.throw(Ue))}catch(it){k(it)}}function te(Ue){var it;Ue.done?pe(Ue.value):(it=Ue.value,it instanceof be?it:new be(function(ee){ee(it)})).then(R,Fe)}te((Le=Le.apply(ue,oe||[])).next())})},ge=function(ue,oe){var be,Le,pe,k,R={label:0,sent:function(){if(1&pe[0])throw pe[1];return pe[1]},trys:[],ops:[]};return k={next:Fe(0),throw:Fe(1),return:Fe(2)},typeof Symbol=="function"&&(k[Symbol.iterator]=function(){return this}),k;function Fe(te){return function(Ue){return function(it){if(be)throw new TypeError("Generator is already executing.");for(;k&&(k=0,it[0]&&(R=0)),R;)try{if(be=1,Le&&(pe=2&it[0]?Le.return:it[0]?Le.throw||((pe=Le.return)&&pe.call(Le),0):Le.next)&&!(pe=pe.call(Le,it[1])).done)return pe;switch(Le=0,pe&&(it=[2&it[0],pe.value]),it[0]){case 0:case 1:pe=it;break;case 4:return R.label++,{value:it[1],done:!1};case 5:R.label++,Le=it[1],it=[0];continue;case 7:it=R.ops.pop(),R.trys.pop();continue;default:if(pe=R.trys,!((pe=pe.length>0&&pe[pe.length-1])||it[0]!==6&&it[0]!==2)){R=0;continue}if(it[0]===3&&(!pe||it[1]>pe[0]&&it[1]<pe[3])){R.label=it[1];break}if(it[0]===6&&R.label<pe[1]){R.label=pe[1],pe=it;break}if(pe&&R.label<pe[2]){R.label=pe[2],R.ops.push(it);break}pe[2]&&R.ops.pop(),R.trys.pop();continue}it=oe.call(ue,R)}catch(ee){it=[6,ee],Le=0}finally{be=pe=0}if(5&it[0])throw it[1];return{value:it[0]?it[1]:void 0,done:!0}}([te,Ue])}}},Ee=function(){function ue(oe,be,Le,pe,k,R){var Fe=this;this.an=oe,this.dataReport=be,this.pn=Le,this.gn=pe,this.ac=k,this.rtcModules=R,this.buffer=null,this.blank=null,this.mixingDelay=0,(0,_.nr)()&&this.blank==null&&this.buffer==null&&(this.buffer=this.ac.createBuffer(1,1,this.ac.sampleRate),this.blank=this.ac.createBufferSource(),this.blank.buffer=this.buffer,this.blank.connect(this.ac.destination),this.blank.start()),this.rtcModules.bindListener("_engineConfigUpdate",function(te){var Ue=te.mixingAudioDelay+te.baseMixingAudioDelay;isNaN(Ue)||Ue===Fe.mixingDelay||(Fe.an.info("zc.am.mdu delay update:"+Ue+", origin:"+Fe.mixingDelay),Fe.mixingDelay=Ue,Fe.gn.previewStreamList.forEach(function(it){it.audioMixManager&&it.audioMixManager.setMixingDelay(Ue)}))})}return ue.prototype.preloadEffect=function(oe,be,Le){if(this.checkPreviewer(E,{effectID:oe},{effectID:!0}))if(be&&(0,M.QP)(be)){if(this.pn.audioEffectBuffer[oe])return this.an.warn(E+" audio buffer already exists"),void(Le&&Le());this.an.info(E+" start preload effect"),this._preloadEffect(this.ac,oe,be,Le)}else this.an.error(E+" params error")},ue.prototype.checkPreviewer=function(oe,be,Le){be===void 0&&(be={});var pe=!!(Le!=null&&Le.effectID),k=!!(Le!=null&&Le.streamID),R=!!(Le!=null&&Le.previewer),Fe=be.effectID,te=be.streamID,Ue=te&&((0,M.QP)(te)?te:(0,A.L)(te,this.an));if((k||Ue)&&!(0,M.QP)(Ue)&&!(0,M.dr)(Ue))return this.an.error(oe+" stream type error"),!1;if(pe&&!Fe)return this.an.error(oe+" effectID required"),!1;if(Fe&&!(0,M.QP)(Fe))return this.an.error(oe+" effectID type error"),!1;if(R){var it=this.gn.getPreviewer(Ue);return it||((0,M.QP)(Ue)?this.an.error(oe+" stream is not publishing",{streamid:Ue}):this.an.error(oe+" stream doesn't exist"),!1)}return!0},ue.prototype.getEffectDuration=function(oe){if(!this.checkPreviewer(Re,{effectID:oe},{effectID:!0}))return 0;var be=this.pn.audioEffectBuffer[oe];return be?be.duration?Math.floor(1e3*be.duration):0:(this.an.error(Re+" effect not found"),0)},ue.prototype.getEffectProgress=function(oe,be){var Le=this.checkPreviewer(Re,{streamID:oe,effectID:be},{effectID:!0,streamID:!0,previewer:!0});return(0,M.dd)(Le)?0:this.getAudioManager(Le).getEffectProgress(be)},ue.prototype.seekAudioEffect=function(oe,be,Le){if(Le<0)return this.an.error(Re+" param time error "),!1;var pe=this.checkPreviewer(Re,{streamID:oe,effectID:be},{effectID:!0,streamID:!0,previewer:!0});return!(0,M.dd)(pe)&&this.getAudioManager(pe).seekAudioEffect(be,Le)},ue.prototype.playEffect=function(oe,be,Le){return H(this,void 0,void 0,function(){var pe,k,R,Fe,te=this;return ge(this,function(Ue){switch(Ue.label){case 0:return pe=(0,A.L)(oe.stream,this.an)||oe.streamID,k=oe.path,this.checkPreviewer(w,{streamID:pe,effectID:R=oe.effectID},{streamID:!0,effectID:!0})?(Fe=this.pn.audioEffectBuffer[R],k?Fe?(this.an.warn(w+" audio effect already exists"),[3,3]):[3,1]:[3,4]):[2];case 1:return[4,new L.l3(function(it,ee){te.preloadEffect(R,k,function(ae){ae?(te.an.error(w+" preload audio effect failed"),ee(ae)):it(void 0)})})];case 2:Ue.sent(),Ue.label=3;case 3:return[3,5];case 4:if(!Fe)return this.an.error(w+" audio effect doesn't exists"),[2];Ue.label=5;case 5:return this._playEffect(oe,be,Le),[2]}})})},ue.prototype.pauseEffect=function(oe,be){var Le=(0,M.QP)(oe)?oe:(0,A.L)(oe,this.an);return this._pauseEffect(Le,be)},ue.prototype.resumeEffect=function(oe,be){var Le=(0,M.QP)(oe)?oe:(0,A.L)(oe,this.an);return this._resumeEffect(Le,be)},ue.prototype.stopEffect=function(oe,be){var Le=(0,M.QP)(oe)?oe:(0,A.L)(oe,this.an);return this._stopEffect(Le,be)},ue.prototype.unloadEffect=function(oe){return!!this.checkPreviewer("zc.ue",{effectID:oe},{effectID:!0})&&(delete this.pn.audioEffectBuffer[oe],!0)},ue.prototype.setEffectVolume=function(oe,be,Le,pe){if(!(0,M.Cs)(be)||be<0||be>200)return this.an.error(we+" volume must be a number between 0 and 200"),!1;var k=(0,M.QP)(oe)?oe:(0,A.L)(oe,this.an),R=this.checkPreviewer(we,{streamID:k,effectID:Le},{streamID:!0,previewer:!0});return!(0,M.dd)(R)&&this.getAudioManager(R).setEffectVolume(be/100,Le,pe)},ue.prototype.startMixingAudio=function(oe,be){var Le=(0,M.QP)(oe)?oe:(0,A.L)(oe,this.an);return this.an.info(he+" call "+Le),Le?be?(this.an.info(he+" end "+Le),Array.isArray(be)&&be.length!==0&&be.every(function(pe){return(0,M.Si)(pe)})?this.bn(Le,be):(this.an.error(he+" audio list param type error"),!1)):(this.an.error(he+" no audio"),!1):(this.an.error(he+" stream not found"),!1)},ue.prototype.stopMixingAudio=function(oe,be){var Le=(0,M.QP)(oe)?oe:(0,A.L)(oe,this.an);return Le?Array.isArray(be)&&be.length!==0||(0,M.TE)(be)?this._stopMixingAudio(Le,be):(this.an.error(Me+" audio param type error"),!1):(this.an.error(Me+" stream not found"),!1)},ue.prototype.mixingBuffer=function(oe,be,Le,pe){var k=(0,M.QP)(oe)?oe:(0,A.L)(oe,this.an);this.an.info(nt+" call streamID: "+JSON.stringify(k)+" sourceID:"+be),k?be&&(0,M.QP)(be)?(this._mixingBuffer(k,be,Le,pe),this.an.info(nt+" end")):this.an.error(nt+" param source id format error"):this.an.error(nt+" param streamid format error")},ue.prototype.stopMixingBuffer=function(oe,be){var Le=(0,M.QP)(oe)?oe:(0,A.L)(oe,this.an);return this._stopMixingBuffer(Le,be)},ue.prototype.setMixingAudioVolume=function(oe,be,Le){if(this.an.info(U+" call"),!oe)return this.an.error(U+" stream not found"),!1;if(!(0,M.Cs)(be)||be<0||be>200)return this.an.error(U+" volume must be a number between 0 and 200"),!1;if(!Le||!(0,M.Si)(Le))return this.an.error(U+" no audio"),!1;var pe=(0,M.QP)(oe)?oe:(0,A.L)(oe,this.an);return this._setMixingAudioVolume(pe,be,Le)},ue.prototype.getSoundLevel=function(oe,be,Le){var pe="zc.gsl";(0,L.rA)(this.an,pe);var k=this.gn.getCloudSoundInterval();try{var R=this.gn.createSoundLevel(this.ac,oe,this.gn.soundLevelInterval,k,function(Fe){be(Fe)});this.pn.audioStreamList[oe.id]={mic:R.mic,script:R.soundMeter}}catch(Fe){Le(Fe)}(0,L.EK)(this.an,pe)},ue.prototype.stopSoundLevel=function(oe){this.an.info("zc.ssl call");var be=this.pn.audioStreamList[oe.id];be.mic.disconnect(),be.script.destroy(),delete this.pn.audioStreamList[oe.id]},ue.prototype._preloadEffect=function(oe,be,Le,pe){var k=this,R=new XMLHttpRequest;R.open("GET",Le,!0),R.setRequestHeader("Range","none"),R.responseType="arraybuffer",R.onload=function(){if(R.status==200||R.status==304)oe.decodeAudioData(R.response,function(te){k.an.info("zc.pe.0 effect '".concat(be,"' preload success")),k.pn.audioEffectBuffer[be]=te,pe&&pe()},function(te){k.an.error("zc.pe.0 effect '".concat(be,"' preload fail. ")+te),pe&&pe(te)});else{var Fe=R.statusText;k.an.error("zc.pe.0 effect '".concat(be,"' preload fail.")+Fe),pe&&pe(Fe)}},R.send()},ue.prototype._playEffect=function(oe,be,Le){var pe=(0,A.L)(oe.stream,this.an)||oe.streamID,k=this.pn.audioEffectBuffer[oe.effectID];if(k){var R=this.checkPreviewer(w,{streamID:pe,effectID:oe.effectID},{streamID:!0,effectID:!0,previewer:!0});(0,M.dd)(R)||this.getAudioManager(R).playEffect(oe,k,be,Le)}else this.an.error(w+" no audio buffer found")},ue.prototype._pauseEffect=function(oe,be){var Le=this.checkPreviewer("zc.pe.2",{streamID:oe,effectID:be},{streamID:!0,previewer:!0});return!(0,M.dd)(Le)&&this.getAudioManager(Le).pauseEffect(be)},ue.prototype._resumeEffect=function(oe,be){var Le=this.checkPreviewer("zc.re",{streamID:oe,effectID:be},{streamID:!0,previewer:!0});return!(0,M.dd)(Le)&&this.getAudioManager(Le).resumeEffect(be)},ue.prototype._stopEffect=function(oe,be){var Le=this.checkPreviewer("zc.se",{streamID:oe,effectID:be},{streamID:!0,previewer:!0});return!(0,M.dd)(Le)&&this.getAudioManager(Le).stopEffect(be)},ue.prototype._setMixingAudioVolume=function(oe,be,Le){var pe=this.gn.getPreviewer(oe);return pe?this.getAudioManager(pe).setMixingAudioVolume(be/100,Le):(this.an.error("zc.sma.2 publisher doesn't exist"),!1)},ue.prototype.bn=function(oe,be){var Le=this.gn.getPreviewer(oe);return Le?this.getAudioManager(Le).startMixingAudio(be):((0,M.QP)(oe)?this.an.error("zc.sma.0 "+oe+" stream is not publishing"):this.an.error("zc.sma.0 stream doesn't exist"),!1)},ue.prototype._stopMixingAudio=function(oe,be){var Le=this.gn.getPreviewer(oe);return Le?this.getAudioManager(Le).stopMixingAudio(be):(this.an.error("zc.sma.0 stream doesn't exist"),!1)},ue.prototype._mixingBuffer=function(oe,be,Le,pe){var k=this.checkPreviewer(Ne,{streamID:oe,effectID:be},{effectID:!0,streamID:!0,previewer:!0});(0,M.dd)(k)||((0,M.SY)(Le)?this.getAudioManager(k).mixingBuffer(be,Le,pe):this.an.error("zc.mb.0 array buffer not found"))},ue.prototype._stopMixingBuffer=function(oe,be){var Le=this.checkPreviewer(Ne,{streamID:oe,effectID:be},{effectID:!0,streamID:!0,previewer:!0});return!(0,M.dd)(Le)&&this.getAudioManager(Le).stopMixingBuffer(be)},ue.prototype.getAudioManager=function(oe){var be=oe.audioMixManager;return be||(be=new Y(oe),this.pn.engineConfig.choirRole===1&&be.setVolumeFactor(.6),oe.audioMixManager=be),be},ue}(),Se={type:"AudioMix",install:function(ue){Object.defineProperty(ue.prototype,"initAudioMix",{value:function(){this.audioMixModule=new Ee(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.ac,this)}})}}},3788:function(It){It.exports=sn},4636:function(It,Ye,Te){var E;It.exports=(E=Te(9021),function(w){var Re=E,we=Re.lib,he=we.WordArray,Me=we.Hasher,nt=Re.algo,Ne=[];(function(){for(var U=0;U<64;U++)Ne[U]=4294967296*w.abs(w.sin(U+1))|0})();var W=nt.MD5=Me.extend({_doReset:function(){this._hash=new he.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(U,C){for(var N=0;N<16;N++){var v=C+N,f=U[v];U[v]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8)}var _=this._hash.words,b=U[C+0],y=U[C+1],M=U[C+2],Y=U[C+3],L=U[C+4],A=U[C+5],H=U[C+6],ge=U[C+7],Ee=U[C+8],Se=U[C+9],ue=U[C+10],oe=U[C+11],be=U[C+12],Le=U[C+13],pe=U[C+14],k=U[C+15],R=_[0],Fe=_[1],te=_[2],Ue=_[3];R=Q(R,Fe,te,Ue,b,7,Ne[0]),Ue=Q(Ue,R,Fe,te,y,12,Ne[1]),te=Q(te,Ue,R,Fe,M,17,Ne[2]),Fe=Q(Fe,te,Ue,R,Y,22,Ne[3]),R=Q(R,Fe,te,Ue,L,7,Ne[4]),Ue=Q(Ue,R,Fe,te,A,12,Ne[5]),te=Q(te,Ue,R,Fe,H,17,Ne[6]),Fe=Q(Fe,te,Ue,R,ge,22,Ne[7]),R=Q(R,Fe,te,Ue,Ee,7,Ne[8]),Ue=Q(Ue,R,Fe,te,Se,12,Ne[9]),te=Q(te,Ue,R,Fe,ue,17,Ne[10]),Fe=Q(Fe,te,Ue,R,oe,22,Ne[11]),R=Q(R,Fe,te,Ue,be,7,Ne[12]),Ue=Q(Ue,R,Fe,te,Le,12,Ne[13]),te=Q(te,Ue,R,Fe,pe,17,Ne[14]),R=se(R,Fe=Q(Fe,te,Ue,R,k,22,Ne[15]),te,Ue,y,5,Ne[16]),Ue=se(Ue,R,Fe,te,H,9,Ne[17]),te=se(te,Ue,R,Fe,oe,14,Ne[18]),Fe=se(Fe,te,Ue,R,b,20,Ne[19]),R=se(R,Fe,te,Ue,A,5,Ne[20]),Ue=se(Ue,R,Fe,te,ue,9,Ne[21]),te=se(te,Ue,R,Fe,k,14,Ne[22]),Fe=se(Fe,te,Ue,R,L,20,Ne[23]),R=se(R,Fe,te,Ue,Se,5,Ne[24]),Ue=se(Ue,R,Fe,te,pe,9,Ne[25]),te=se(te,Ue,R,Fe,Y,14,Ne[26]),Fe=se(Fe,te,Ue,R,Ee,20,Ne[27]),R=se(R,Fe,te,Ue,Le,5,Ne[28]),Ue=se(Ue,R,Fe,te,M,9,Ne[29]),te=se(te,Ue,R,Fe,ge,14,Ne[30]),R=J(R,Fe=se(Fe,te,Ue,R,be,20,Ne[31]),te,Ue,A,4,Ne[32]),Ue=J(Ue,R,Fe,te,Ee,11,Ne[33]),te=J(te,Ue,R,Fe,oe,16,Ne[34]),Fe=J(Fe,te,Ue,R,pe,23,Ne[35]),R=J(R,Fe,te,Ue,y,4,Ne[36]),Ue=J(Ue,R,Fe,te,L,11,Ne[37]),te=J(te,Ue,R,Fe,ge,16,Ne[38]),Fe=J(Fe,te,Ue,R,ue,23,Ne[39]),R=J(R,Fe,te,Ue,Le,4,Ne[40]),Ue=J(Ue,R,Fe,te,b,11,Ne[41]),te=J(te,Ue,R,Fe,Y,16,Ne[42]),Fe=J(Fe,te,Ue,R,H,23,Ne[43]),R=J(R,Fe,te,Ue,Se,4,Ne[44]),Ue=J(Ue,R,Fe,te,be,11,Ne[45]),te=J(te,Ue,R,Fe,k,16,Ne[46]),R=G(R,Fe=J(Fe,te,Ue,R,M,23,Ne[47]),te,Ue,b,6,Ne[48]),Ue=G(Ue,R,Fe,te,ge,10,Ne[49]),te=G(te,Ue,R,Fe,pe,15,Ne[50]),Fe=G(Fe,te,Ue,R,A,21,Ne[51]),R=G(R,Fe,te,Ue,be,6,Ne[52]),Ue=G(Ue,R,Fe,te,Y,10,Ne[53]),te=G(te,Ue,R,Fe,ue,15,Ne[54]),Fe=G(Fe,te,Ue,R,y,21,Ne[55]),R=G(R,Fe,te,Ue,Ee,6,Ne[56]),Ue=G(Ue,R,Fe,te,k,10,Ne[57]),te=G(te,Ue,R,Fe,H,15,Ne[58]),Fe=G(Fe,te,Ue,R,Le,21,Ne[59]),R=G(R,Fe,te,Ue,L,6,Ne[60]),Ue=G(Ue,R,Fe,te,oe,10,Ne[61]),te=G(te,Ue,R,Fe,M,15,Ne[62]),Fe=G(Fe,te,Ue,R,Se,21,Ne[63]),_[0]=_[0]+R|0,_[1]=_[1]+Fe|0,_[2]=_[2]+te|0,_[3]=_[3]+Ue|0},_doFinalize:function(){var U=this._data,C=U.words,N=8*this._nDataBytes,v=8*U.sigBytes;C[v>>>5]|=128<<24-v%32;var f=w.floor(N/4294967296),_=N;C[15+(v+64>>>9<<4)]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),C[14+(v+64>>>9<<4)]=16711935&(_<<8|_>>>24)|4278255360&(_<<24|_>>>8),U.sigBytes=4*(C.length+1),this._process();for(var b=this._hash,y=b.words,M=0;M<4;M++){var Y=y[M];y[M]=16711935&(Y<<8|Y>>>24)|4278255360&(Y<<24|Y>>>8)}return b},clone:function(){var U=Me.clone.call(this);return U._hash=this._hash.clone(),U}});function Q(U,C,N,v,f,_,b){var y=U+(C&N|~C&v)+f+b;return(y<<_|y>>>32-_)+C}function se(U,C,N,v,f,_,b){var y=U+(C&v|N&~v)+f+b;return(y<<_|y>>>32-_)+C}function J(U,C,N,v,f,_,b){var y=U+(C^N^v)+f+b;return(y<<_|y>>>32-_)+C}function G(U,C,N,v,f,_,b){var y=U+(N^(C|~v))+f+b;return(y<<_|y>>>32-_)+C}Re.MD5=Me._createHelper(W),Re.HmacMD5=Me._createHmacHelper(W)}(Math),E.MD5)},4872:function(It,Ye,Te){function E(f){return typeof f=="number"}function w(f){return typeof f=="string"}function Re(f){return typeof f=="boolean"}function we(f){return f===void 0}function he(f){return f!==null&&f instanceof Object}function Me(f){return f===null}function nt(f){return typeof f=="function"}function Ne(f){return f instanceof Array}function W(f){return f instanceof Float32Array}function Q(f){return f instanceof Int16Array}function se(f){return f instanceof Uint8Array}function J(f){return f instanceof MediaStream}function G(f){return f instanceof HTMLElement}function U(f){return f instanceof HTMLMediaElement}function C(f){return f instanceof ArrayBuffer}function N(f){return(f.startsWith("preset-id://")||f.startsWith("http")||f.startsWith("https"))&&(f.endsWith(".jpg")||f.endsWith(".jpeg")||f.endsWith(".png"))}function v(f){return E(f)&&f!==0}Te.d(Ye,{$C:function(){return N},C9:function(){return Ne},Cp:function(){return Q},Cs:function(){return E},G0:function(){return se},JO:function(){return nt},QP:function(){return w},SY:function(){return C},Si:function(){return U},TE:function(){return we},dd:function(){return Re},dr:function(){return J},j5:function(){return W},kb:function(){return v},qi:function(){return G},uy:function(){return Me},w:function(){return he}})},4883:function(It,Ye,Te){It.exports=function(E,w,Re,we,he){return nt=[function(W,Q,se){Object.defineProperty(Q,"__esModule",{value:!0}),Q.SETTINGFETCHHANDLER_FETCHSETTING=Q.SETTINGCACHEHANDLER_STORE_SETTING=Q.SETTINGCACHEHANDLER_GET_CACHE_SETTING_SYNC=Q.SETTINGCACHEHANDLER_GET_CACHE_SETTING=Q.SETTING_POLLING_SETTING=Q.SETTING_GET_CLOUD_SETTING=Q.SETTING__FETCH_SETTING=Q.SETTING_FETCH_SETTING=Q.SETTING_INIT=Q.constRUCTOR=void 0,Q.constRUCTOR="zs.0",Q.SETTING_INIT="zs.ii.0",Q.SETTING_FETCH_SETTING="zs.fs.0",Q.SETTING__FETCH_SETTING="zs.fs.1",Q.SETTING_GET_CLOUD_SETTING="zs.gcs.0",Q.SETTING_POLLING_SETTING="zs.ps.0",Q.SETTINGCACHEHANDLER_GET_CACHE_SETTING="zs.sch.gcs.0",Q.SETTINGCACHEHANDLER_GET_CACHE_SETTING_SYNC="zs.sch.gcss.0",Q.SETTINGCACHEHANDLER_STORE_SETTING="zs.sch.ss.0",Q.SETTINGFETCHHANDLER_FETCHSETTING="zs.sfh.fs.0"},function(W,Q,se){var J=this&&this.__read||function(f,_){var b=typeof Symbol=="function"&&f[Symbol.iterator];if(!b)return f;var y,M,Y=b.call(f),L=[];try{for(;(_===void 0||0<_--)&&!(y=Y.next()).done;)L.push(y.value)}catch(A){M={error:A}}finally{try{y&&!y.done&&(b=Y.return)&&b.call(Y)}finally{if(M)throw M.error}}return L},G=this&&this.__spread||function(){for(var f=[],_=0;_<arguments.length;_++)f=f.concat(J(arguments[_]));return f},U=this&&this.__importDefault||function(f){return f&&f.__esModule?f:{default:f}},C=(Object.defineProperty(Q,"__esModule",{value:!0}),Q.decryptStores=Q.encryptStores=Q.decodeString=Q.generateUUID=Q.checkValidNumber=Q.analyzeKey=Q.getCurrentTime=Q.getBrowser=void 0,U(se(13))),N=U(se(14));Q.getBrowser=function(){var f=window.navigator.userAgent,_=window.ActiveXObject!=null&&f.indexOf("MSIE")!=-1,b=f.indexOf("Firefox")!=-1,y=window.opr!=null,M=f.indexOf("Chrome")&&window.chrome,Y=f.indexOf("Safari")!=-1&&f.indexOf("Version")!=-1;return f=f.toLowerCase().match(/MicroMessenger/i)&&f.toLowerCase().match(/MicroMessenger/i)[0]==="micromessenger",_?"IE":b?"FIREFOX":y?"OPERA":M?"CHROME":Y?"SAFARI":f?"WEIXIN":"UNKOWN"};var v=["00","01","02","03","04","05","06","07","08","09"];Q.getCurrentTime=function(){var f=new Date;return[f.getFullYear()+"/",(v[f.getMonth()+1]||f.getMonth()+1)+"/",(v[f.getDate()]||f.getDate())+" ",(v[f.getHours()]||f.getHours())+":",(v[f.getMinutes()]||f.getMinutes())+":",v[f.getSeconds()]||f.getSeconds(),"."+f.getTime()%1e3].join("")},Q.analyzeKey=function(f){return f=f.split("_"),{level:Number(f[0]),timestamp:f[1],seq:f[2]}},Q.checkValidNumber=function(f,_,b){return _=_||1,b=b||1e4,typeof f=="number"&&f%1==0&&_<=f&&f<=b},Q.generateUUID=function(f){if((f=f===void 0?0:f)===0)try{b=localStorage.getItem("z_deviceID")}catch{}else wx.getStorageSync("z_deviceID");if(!b){var _=new Date().getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(y){var M=(_+16*Math.random())%16|0;return _=Math.floor(_/16),(y=="x"?M:3&M|8).toString(36)});if(f===0)try{localStorage.setItem("z_deviceID",b)}catch{}else wx.setStorageSync("z_deviceID",b)}return b},Q.decodeString=function(f){return decodeURIComponent(window.escape(String.fromCharCode.apply(String,G(Array.from(f)))))},Q.encryptStores=function(f,_){return C.default.encrypt(f,_).toString()},Q.decryptStores=function(f,_){try{return C.default.decrypt(f,_).toString(N.default)}catch{return""}}},function(W,Q,se){Object.defineProperty(Q,"__esModule",{value:!0}),Q.AUTH_FAIL=Q.MULTI_FILE_NOT_EXIST=Q.INFLATE_DATA_FAIL=Q.FILE_REQUEST_FAIL=Q.NOT_INIT=void 0,Q.NOT_INIT={code:1001,msg:"not init"},Q.FILE_REQUEST_FAIL={code:1002,msg:"fetch request fail"},Q.INFLATE_DATA_FAIL={code:1003,msg:"inflate fail"},Q.MULTI_FILE_NOT_EXIST={code:1004,msg:"get multi file fail"},Q.AUTH_FAIL={code:1005,msg:"auth failed"}},function(W,Q,se){Object.defineProperty(Q,"__esModule",{value:!0}),se=(se=se(4)).default||se,Q.default=se},function(W,Q){W.exports=E},function(W,Q){W.exports=w},function(W,Q,se){Object.defineProperty(Q,"__esModule",{value:!0}),Q.INIT_CONFIG=void 0,Q.INIT_CONFIG={env:0,compress:!0,p_version:1,unify:!0}},function(W,Q,se){Object.defineProperty(Q,"__esModule",{value:!0}),Q.ZegoSetting=void 0;var J=se(8);Object.defineProperty(Q,"ZegoSetting",{enumerable:!0,get:function(){return J.ZegoSetting}})},function(W,Q,se){var J=this&&this.__assign||function(){return(J=Object.assign||function(L){for(var A,H=1,ge=arguments.length;H<ge;H++)for(var Ee in A=arguments[H])Object.prototype.hasOwnProperty.call(A,Ee)&&(L[Ee]=A[Ee]);return L}).apply(this,arguments)},G=this&&this.__awaiter||function(L,A,H,ge){return new(H=H||Promise)(function(Ee,Se){function ue(Le){try{be(ge.next(Le))}catch(pe){Se(pe)}}function oe(Le){try{be(ge.throw(Le))}catch(pe){Se(pe)}}function be(Le){var pe;Le.done?Ee(Le.value):((pe=Le.value)instanceof H?pe:new H(function(k){k(pe)})).then(ue,oe)}be((ge=ge.apply(L,A||[])).next())})},U=this&&this.__generator||function(L,A){var H,ge,Ee,Se={label:0,sent:function(){if(1&Ee[0])throw Ee[1];return Ee[1]},trys:[],ops:[]},ue={next:oe(0),throw:oe(1),return:oe(2)};return typeof Symbol=="function"&&(ue[Symbol.iterator]=function(){return this}),ue;function oe(be){return function(Le){var pe=[be,Le];if(H)throw new TypeError("Generator is already executing.");for(;Se;)try{if(H=1,ge&&(Ee=2&pe[0]?ge.return:pe[0]?ge.throw||((Ee=ge.return)&&Ee.call(ge),0):ge.next)&&!(Ee=Ee.call(ge,pe[1])).done)return Ee;switch(ge=0,(pe=Ee?[2&pe[0],Ee.value]:pe)[0]){case 0:case 1:Ee=pe;break;case 4:return Se.label++,{value:pe[1],done:!1};case 5:Se.label++,ge=pe[1],pe=[0];continue;case 7:pe=Se.ops.pop(),Se.trys.pop();continue;default:if(!(Ee=0<(Ee=Se.trys).length&&Ee[Ee.length-1])&&(pe[0]===6||pe[0]===2)){Se=0;continue}if(pe[0]===3&&(!Ee||pe[1]>Ee[0]&&pe[1]<Ee[3]))Se.label=pe[1];else if(pe[0]===6&&Se.label<Ee[1])Se.label=Ee[1],Ee=pe;else{if(!(Ee&&Se.label<Ee[2])){Ee[2]&&Se.ops.pop(),Se.trys.pop();continue}Se.label=Ee[2],Se.ops.push(pe)}}pe=A.call(L,Se)}catch(k){pe=[6,k],ge=0}finally{H=Ee=0}if(5&pe[0])throw pe[1];return{value:pe[0]?pe[1]:void 0,done:!0}}}},C=(Object.defineProperty(Q,"__esModule",{value:!0}),Q.ZegoSetting=void 0,se(2)),N=se(9),v=se(10),f=se(11),_=se(15),b=se(6),y=se(1),M=se(0);function Y(){this.u=[],this.h={},this.v={},this.g=null,this._=300,this.O=!1,this.j=0,this.S=!1,this.log=new v.ZegoLog}Object.defineProperty(Y.prototype,"envVariable",{get:function(){return Object.assign({},this.h,this.v)},enumerable:!1,configurable:!0}),Y.prototype.init=function(L){var A,H=this;return L.pollingFreq&&!y.checkValidNumber(L.pollingFreq)?(this.log.error(M.SETTING_INIT+" pollingFreq must be integer number"),!1):L.inflate?(this.D=Object.assign({},b.INIT_CONFIG,L),this.N(),this.I=new _.SettingFetchHandler(this.D,this.log),this.I.setDataReport(this.D.reportNotify),L=Math.round(60*Math.random()),this.log.info(M.SETTING_INIT+" delay "+L),this.M&&(clearTimeout(this.M),this.M=null),this.D.pollingFreq&&60<=this.D.pollingFreq&&(this._=this.D.pollingFreq),this.M=setTimeout(function(){H.T(1e3*H._,!1)},1e3*L),this.R=new f.SettingCacheHandler("setting_"+(this.D.online?"online_":"test_")+(L=this.D.product||this.D.productNum)+"_"+this.D.appID,this.log,this.D),[0,1,2,3,4,5].includes(L)&&(A=N.ProductMap[L])&&(L===1&&this.R.dropOldStore("setting_"+(this.D.online?"online_":"test_")+"undefined_"+this.D.appID),this.R.dropOldStore("setting_"+(this.D.online?"online_":"test_")+A+"_"+this.D.appID)),(L=this.D)!=null&&L.unify&&this.D.connection&&(L=(A=this.D)==null?void 0:A.connection)!=null&&L.on("connected",function(){H.I.checkUnSendMsgs(H.I.unSendCommandList)}),this.C(),this.O=!0):(this.log.error(M.SETTING_INIT+" need input pako inflate function"),!1)},Y.prototype.uninit=function(){this.g&&(clearTimeout(this.g),this.g=null)},Y.prototype.setEnvVariable=function(L,A){this.v[L]=String(A)},Y.prototype.getEnvVariable=function(L){return this.envVariable[L]},Y.prototype.setEnvVariables=function(L){var A=this;Object.keys(L).forEach(function(H){typeof L[H]!="string"&&typeof L[H]!="number"&&A.log.error("zs.sev env "+H+" type error"),A.v[H]=String(L[H])})},Y.prototype.getEnvVariables=function(){return this.envVariable},Y.prototype.enablePolling=function(L,A){var H=this;A?A.forEach(function(ge){var Ee=H.u.find(function(Se){return Se.fileName===ge});Ee&&(Ee.needPolling=L)}):this.u.forEach(function(ge){return ge.needPolling=L})},Y.prototype.setToken=function(L){this.P!==L&&this.C(),this.P=L},Y.prototype.setUserID=function(L){this.q!==L&&this.C(),this.q=L},Y.prototype.getSettingCache=function(L){return G(this,void 0,void 0,function(){var A,H;return U(this,function(ge){switch(ge.label){case 0:return this.O?(A=this.u.find(function(Ee){return Ee.fileName===L}))?[2,Promise.resolve({setting:A.setting,versions:A.versions})]:[3,1]:[2,Promise.reject(C.NOT_INIT)];case 1:return[4,this.R.getCacheSetting(L)];case 2:return(A=ge.sent())&&(this.u.find(function(Ee){return Ee.fileName===L})||this.u.push({fileName:L,fetchedTime:0,needPolling:!1,setting:A.setting,versions:A.versions}),H={setting:A.setting,versions:A.versions}),[2,Promise.resolve(H)]}})})},Y.prototype.fetchSetting=function(L,A,H){return A===void 0&&(A={}),H===void 0&&(H=!0),this.log.info(M.SETTING_FETCH_SETTING+" call "+L),this.O?(this.activePolling(),0<Object.keys(A).length?(this.log.info(M.SETTING_FETCH_SETTING+" get file with params"),this.A(L,J(J({},this.envVariable),A))):(A=this.u.find(function(ge){return ge.fileName===L}))?(this.log.info(M.SETTING_FETCH_SETTING+" file exist"),new Date().getTime()-A.fetchedTime<1e3*this._?(this.log.info(M.SETTING_FETCH_SETTING+" fetch time interval in freq"),A.needPolling=H,Promise.resolve({setting:A.setting,versions:A.versions})):this.k(L,A,H)):(this.log.info(M.SETTING_FETCH_SETTING+" file not found"),this.k(L,A,H))):Promise.reject(C.NOT_INIT)},Y.prototype.fetchMultiSetting=function(L,A,H){var ge=this;return A===void 0&&(A={}),H===void 0&&(H=!0),this.log.info(M.SETTING_FETCH_SETTING+" call "+JSON.stringify(L)),this.O?(this.activePolling(),0<Object.keys(A).length?(this.log.info(M.SETTING_FETCH_SETTING+" get file with params"),this.A(L,J(J({},this.envVariable),A))):new Promise(function(Ee,Se){var ue={},oe=[];if(L.forEach(function(be){return G(ge,void 0,void 0,function(){var Le;return U(this,function(pe){return(Le=this.u.find(function(k){return k.fileName===be}))&&new Date().getTime()-Le.fetchedTime<1e3*this._?(this.log.info(M.SETTING_FETCH_SETTING+" fetch time interval in freq"),ue[be]={setting:Le.setting,versions:Le.versions}):oe.push(be),[2]})})}),!(0<oe.length))return Ee(ue);ge.A(oe,ge.envVariable).then(function(be){return ge.J(be,H),Object.assign(ue,be),Ee(ue)}).catch(function(be){oe.forEach(function(Le){return G(ge,void 0,void 0,function(){var pe;return U(this,function(k){switch(k.label){case 0:return(pe=this.u.find(function(R){return R.fileName==Le}))?pe.fetchedTime=new Date().getTime():this.u.find(function(R){return R.fileName===Le})||this.u.push({fileName:Le,fetchedTime:new Date().getTime(),needPolling:H,setting:{},versions:{}}),[4,this.R.getCacheSetting(Le)];case 1:return pe=k.sent(),ue[Le]={setting:pe.setting,versions:pe.versions},[2]}})})}),0<Object.keys(ue).length?Ee(ue):Se(be)})})):(this.log.info(M.SETTING_FETCH_SETTING+" not init"),Promise.reject(C.NOT_INIT))},Y.prototype.setOptions=function(L){L&&typeof L.unify=="boolean"&&(this.D.unify=L.unify,this.I.setOptions(this.D))},Y.prototype.setLog=function(L){this.log=L},Y.prototype.A=function(L,A){var H=this;return new Promise(function(ge,Ee){return G(H,void 0,void 0,function(){var Se,ue,oe,be,Le,pe,k,R,Fe,te=this;return U(this,function(Ue){switch(Ue.label){case 0:if(Ue.trys.push([0,6,,7]),this.S)return this.log.warn(M.SETTING_GET_CLOUD_SETTING+" check fail"),Ee(C.AUTH_FAIL),[2];ue=(Se=L instanceof Array)?L:[L],oe=[],be={},Le=function(it){return it=it.map(function(ee){return te.R.getCacheSetting(ee)}),Promise.all(it)},Ue.label=1;case 1:return Ue.trys.push([1,3,,4]),[4,Le(ue)];case 2:return pe=Ue.sent(),ue.forEach(function(it,ee){var ae=typeof(ae=(ae=pe[ee].versions)==null?void 0:ae.hash)=="string"?new Uint8Array(ae.split(",").map(function(xe){return parseInt(xe)})):new Uint8Array;oe.push({file_name:it,hash:ae,g_version:(ae=pe[ee].versions)==null?void 0:ae.g_version}),be[it]=pe[ee]}),[3,4];case 3:return Ue.sent(),ue.forEach(function(it){oe.push({file_name:it})}),[3,4];case 4:return[4,this.I.fetchSetting(oe,A,this.P,this.q,!1)];case 5:return Fe=Ue.sent(),k=Fe.data,Fe=Fe.polling_interval,this.j=0,this.log.info(M.SETTING_GET_CLOUD_SETTING+" suc"),typeof Fe=="number"&&5<=Fe&&this._!==60*Fe&&(this.log.warn(M.SETTING_GET_CLOUD_SETTING+" polling interval change"),this._=60*Fe,this.uninit(),this.activePolling()),Se?(R={},L.forEach(function(it){var ee;((ee=k[it])==null?void 0:ee.code)==0&&(k[it].hashChange?(te.log.info(M.SETTING_GET_CLOUD_SETTING+" file "+it+" changed"),R[it]={setting:(ee=k[it])==null?void 0:ee.data,versions:(ee=k[it])==null?void 0:ee.versions}):be[it]&&(R[it]={setting:(ee=be[it])==null?void 0:ee.setting,versions:(ee=be[it])==null?void 0:ee.versions}))}),0<Object.keys(R).length?ge(R):Ee(C.MULTI_FILE_NOT_EXIST)):((Fe=k[L])==null?void 0:Fe.code)===0&&(Fe=k[L])!=null&&Fe.data?ge({setting:(Fe=k[L])==null?void 0:Fe.data,versions:(Fe=k[L])==null?void 0:Fe.versions}):Ee({code:(Fe=k[L])==null?void 0:Fe.code,msg:(Fe=k[L])==null?void 0:Fe.message}),[3,7];case 6:return Fe=Ue.sent(),this.log.error(M.SETTING_GET_CLOUD_SETTING+" fail "+JSON.stringify(Fe)),(Fe==null?void 0:Fe.code)!==21002&&(Fe==null?void 0:Fe.status_code)!==401||(this.j+=1),2<=this.j&&(this.S=!0),Ee(Fe),[3,7];case 7:return[2]}})})})},Y.prototype.J=function(L,A){var H=this;Object.keys(L).forEach(function(ge){var Ee=((Ee=H.u.find(function(Se){return Se.fileName==ge}))?(Ee.fetchedTime=new Date().getTime(),Ee.setting=L[ge].setting,Ee.versions=L[ge].versions,Ee.needPolling=A):H.u.find(function(Se){return Se.fileName===ge})||H.u.push({fileName:ge,fetchedTime:new Date().getTime(),needPolling:A,setting:L[ge].setting,versions:L[ge].versions}),ge);H.R.storeSetting(Ee,L[ge])})},Y.prototype.k=function(L,A,H){var ge=this;return new Promise(function(Ee,Se){ge.log.info(M.SETTING__FETCH_SETTING+" call"),ge.A(L,ge.envVariable).then(function(ue){A?(A.fetchedTime=new Date().getTime(),A.setting=ue.setting,A.versions=ue.versions,A.needPolling=H):ge.u.find(function(oe){return oe.fileName===L})||ge.u.push({fileName:L,fetchedTime:new Date().getTime(),needPolling:H,setting:ue.setting,versions:ue.versions}),ge.R.storeSetting(L,ue),Ee(ue),ge.log.info(M.SETTING__FETCH_SETTING+" call suc")}).catch(function(ue){return G(ge,void 0,void 0,function(){var oe,be;return U(this,function(Le){switch(Le.label){case 0:A?A.fetchedTime=new Date().getTime():this.u.find(function(pe){return pe.fileName===L})||this.u.push({fileName:L,fetchedTime:new Date().getTime(),needPolling:H,setting:{},versions:{}}),oe=L,Le.label=1;case 1:return Le.trys.push([1,3,,4]),[4,this.R.getCacheSetting(oe)];case 2:return be=Le.sent(),Ee(be),[3,4];case 3:return Le.sent(),Se(ue),[3,4];case 4:return this.log.info(M.SETTING__FETCH_SETTING+" setting not contain or fetch file fail"),[2]}})})})})},Y.prototype.N=function(){var L;this.D.env==0?(this.h.userAgent=navigator.userAgent,this.h.platform=navigator.platform,this.h.browser=y.getBrowser(),this.h.deviceid=y.generateUUID()):this.D.env==1&&(L=wx.getSystemInfoSync(),this.h.brand=L.brand,this.h.model=L.model,this.h.system=L.system,this.h.platform=L.platform,this.h.wechatVersion=L.version,this.h.wechatSDKVersion=L.SDKVersion,this.h.deviceid=y.generateUUID(this.D.env))},Y.prototype.T=function(L,A){return A===void 0&&(A=!0),G(this,void 0,void 0,function(){var H,ge,Ee,Se,ue=this;return U(this,function(oe){switch(oe.label){case 0:if(this.log.info(M.SETTING_POLLING_SETTING+" call "+L+" "+A),H=L,A){if(ge=[],this.u.forEach(function(be){var Le,pe;be.needPolling&&(pe=typeof((Le=be.versions)==null?void 0:Le.hash)=="string"?new Uint8Array((Le=be.versions)==null?void 0:Le.hash.split(",").map(function(k){return parseInt(k)})):new Uint8Array,ge.push({file_name:be.fileName,hash:pe,g_version:be.versions.g_version}))}),!this.S)return[3,1];this.log.warn(M.SETTING_GET_CLOUD_SETTING+" has checked fail")}return[3,7];case 1:if(!(0<ge.length))return[3,6];oe.label=2;case 2:return oe.trys.push([2,4,,5]),[4,this.I.fetchSetting(ge,this.envVariable,this.P,this.q)];case 3:return Se=oe.sent(),Ee=Se.data,Se=Se.polling_interval,this.log.info(M.SETTING_POLLING_SETTING+" fetch suc"),this.j=0,typeof Se=="number"&&5<=Se&&this._!==60*Se&&(this.log.warn(M.SETTING_POLLING_SETTING+" polling interval change"),this._=60*Se,H=1e3*this._),this.u.forEach(function(be){return G(ue,void 0,void 0,function(){var Le,pe,k,R,Fe,te,Ue,it,ee;return U(this,function(ae){switch(ae.label){case 0:return be.fetchedTime=new Date().getTime(),Le=be.fileName,ee=(R=Ee[be.fileName]).code,Ue=R.data,it=R.versions,pe=R.message,k=R.hashChange,R&&ee===0&&Ue?(R=JSON.stringify(Ue),Fe=JSON.stringify(be.setting),te={setting:Ue,versions:it,code:ee,message:pe},k&&Fe!==R&&(this.log.info(M.SETTING_POLLING_SETTING+" "+be.fileName+" setting changed"),be.setting=te.setting,be.versions=te.versions,this.D.pollingNotify(be.fileName,te)),[4,this.R.getCacheSetting(Le)]):[3,2];case 1:Ue=ae.sent(),it=JSON.stringify(Ue),ee=JSON.stringify(te),k&&it!==ee&&this.R.storeSetting(Le,te),ae.label=2;case 2:return[2]}})})}),[3,5];case 4:return Se=oe.sent(),this.log.error(M.SETTING_POLLING_SETTING+" fetch fail "+JSON.stringify(Se)),(Se==null?void 0:Se.code)!==21002&&(Se==null?void 0:Se.status_code)!==401||(this.j+=1),2<=this.j&&(this.S=!0),[3,5];case 5:return[3,7];case 6:this.log.info(M.SETTING_POLLING_SETTING+" polling no file"),oe.label=7;case 7:return this.g&&clearTimeout(this.g),this.g=setTimeout(function(){ue.T(H)},H),[2]}})})},Y.prototype.activePolling=function(){this.g||this.T(1e3*this._)},Y.prototype.C=function(){this.j=0,this.S=!1},Q.ZegoSetting=Y},function(W,Q,se){var J;Object.defineProperty(Q,"__esModule",{value:!0}),Q.ProductMap=Q.Product=Q.SOCKET_DISCONNECT=Q.ENUM_REMOTE_TYPE=Q.ZEGO_BROWSER_TYPE=Q.ZEGO_ENV=Q.PROTO_VERSION=void 0,Q.PROTO_VERSION="1.1.8",(J=Q.ZEGO_ENV||(Q.ZEGO_ENV={}))[J.BROWSER=0]="BROWSER",J[J.WEIXINMINI=1]="WEIXINMINI",(J=Q.ZEGO_BROWSER_TYPE||(Q.ZEGO_BROWSER_TYPE={}))[J.IE=0]="IE",J[J.FIREFOX=1]="FIREFOX",J[J.CHROME=2]="CHROME",J[J.SAFARI=3]="SAFARI",J[J.OPERA=4]="OPERA",J[J.WEIXIN=5]="WEIXIN",J[J.WEIXINMINI=6]="WEIXINMINI",J[J.UNKOWN=7]="UNKOWN",(J=Q.ENUM_REMOTE_TYPE||(Q.ENUM_REMOTE_TYPE={}))[J.DISABLE=0]="DISABLE",J[J.WEBSOCKET=1]="WEBSOCKET",J[J.HTTPS=2]="HTTPS",Q.SOCKET_DISCONNECT=-1,(J=Q.Product||(Q.Product={}))[J.RTC=0]="RTC",J[J.WEB_RTC=1]="WEB_RTC",J[J.ZIM=2]="ZIM",J[J.ROOM_KIT=3]="ROOM_KIT",J[J.DOC_SHARE=4]="DOC_SHARE",J[J.WHITE_BOARD=5]="WHITE_BOARD",J[J.SELF_CHECK=999]="SELF_CHECK",J[J.TEST_ANOOUS=1e3]="TEST_ANOOUS",Q.ProductMap={0:"rtc_sdk_native",1:"Web_SDK",2:"ZIM",3:"roomkitWeb",4:"docsshare",5:"WhiteBoard"}},function(W,Q,se){function J(){}Object.defineProperty(Q,"__esModule",{value:!0}),Q.ZegoLog=void 0,J.prototype.log=function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];var C=G.join(" ");console.log(C)},J.prototype.debug=function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];var C=G.join(" ");console.debug(C)},J.prototype.info=function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];var C=G.join(" ");console.info(C)},J.prototype.warn=function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];var C=G.join(" ");console.warn(C)},J.prototype.error=function(){for(var G=[],U=0;U<arguments.length;U++)G[U]=arguments[U];var C=G.join(" ");console.error(C)},Q.ZegoLog=J},function(W,Q,se){var J=this&&this.__awaiter||function(b,y,M,Y){return new(M=M||Promise)(function(L,A){function H(Se){try{Ee(Y.next(Se))}catch(ue){A(ue)}}function ge(Se){try{Ee(Y.throw(Se))}catch(ue){A(ue)}}function Ee(Se){var ue;Se.done?L(Se.value):((ue=Se.value)instanceof M?ue:new M(function(oe){oe(ue)})).then(H,ge)}Ee((Y=Y.apply(b,y||[])).next())})},G=this&&this.__generator||function(b,y){var M,Y,L,A={label:0,sent:function(){if(1&L[0])throw L[1];return L[1]},trys:[],ops:[]},H={next:ge(0),throw:ge(1),return:ge(2)};return typeof Symbol=="function"&&(H[Symbol.iterator]=function(){return this}),H;function ge(Ee){return function(Se){var ue=[Ee,Se];if(M)throw new TypeError("Generator is already executing.");for(;A;)try{if(M=1,Y&&(L=2&ue[0]?Y.return:ue[0]?Y.throw||((L=Y.return)&&L.call(Y),0):Y.next)&&!(L=L.call(Y,ue[1])).done)return L;switch(Y=0,(ue=L?[2&ue[0],L.value]:ue)[0]){case 0:case 1:L=ue;break;case 4:return A.label++,{value:ue[1],done:!1};case 5:A.label++,Y=ue[1],ue=[0];continue;case 7:ue=A.ops.pop(),A.trys.pop();continue;default:if(!(L=0<(L=A.trys).length&&L[L.length-1])&&(ue[0]===6||ue[0]===2)){A=0;continue}if(ue[0]===3&&(!L||ue[1]>L[0]&&ue[1]<L[3]))A.label=ue[1];else if(ue[0]===6&&A.label<L[1])A.label=L[1],L=ue;else{if(!(L&&A.label<L[2])){L[2]&&A.ops.pop(),A.trys.pop();continue}A.label=L[2],A.ops.push(ue)}}ue=y.call(b,A)}catch(oe){ue=[6,oe],Y=0}finally{M=L=0}if(5&ue[0])throw ue[1];return{value:ue[0]?ue[1]:void 0,done:!0}}}},U=this&&this.__importDefault||function(b){return b&&b.__esModule?b:{default:b}},C=(Object.defineProperty(Q,"__esModule",{value:!0}),Q.SettingCacheHandler=void 0,U(se(12))),N=se(0),v=se(1),f="0c9e6e0f8c0a8f4e";function _(b,y,M){this._storeName=b,this._log=y}_.prototype.getStore=function(){this.store||(this.store=C.default.createInstance({name:this._storeName}))},_.prototype.getCacheSetting=function(b){return J(this,void 0,void 0,function(){var y,M;return G(this,function(Y){switch(Y.label){case 0:if(this._log.info(N.SETTINGCACHEHANDLER_GET_CACHE_SETTING+" call "+b),y=void 0,!(M=localStorage.getItem(this._storeName+"_"+b)))return[3,1];if(M=v.decryptStores(M,f))try{y=JSON.parse(M),this._log.info(N.SETTINGCACHEHANDLER_GET_CACHE_SETTING_SYNC+" res "+b)}catch(L){this._log.info(N.SETTINGCACHEHANDLER_GET_CACHE_SETTING_SYNC+" fail "+b+" "+(L==null?void 0:L.message))}return[3,3];case 1:return this._log.info(N.SETTINGCACHEHANDLER_GET_CACHE_SETTING+" get cache from db "+b),this.getStore(),[4,this.store.getItem(b)];case 2:y=Y.sent(),Y.label=3;case 3:return this._log.info(N.SETTINGCACHEHANDLER_GET_CACHE_SETTING+" res "+b),[2,y]}})})},_.prototype.storeSetting=function(b,y){return J(this,void 0,void 0,function(){var M;return G(this,function(Y){switch(Y.label){case 0:this._log.info(N.SETTINGCACHEHANDLER_STORE_SETTING+" call "+b),Y.label=1;case 1:return Y.trys.push([1,2,,4]),M=JSON.stringify(y),M=v.encryptStores(M,f),localStorage.setItem(this._storeName+"_"+b,M),[3,4];case 2:return M=Y.sent(),this._log.info(N.SETTINGCACHEHANDLER_STORE_SETTING+" fail "+b+" "+(M==null?void 0:M.message)),localStorage.removeItem(this._storeName+"_"+b),this._log.info(N.SETTINGCACHEHANDLER_STORE_SETTING+" set data to db "+b),this.getStore(),[4,this.store.setItem(b,y)];case 3:return Y.sent(),[3,4];case 4:return[2]}})})},_.prototype.dropOldStore=function(b){C.default.dropInstance({name:b}).then(function(){console.debug("Dropped ",b)}).catch(function(y){console.warn(y)})},Q.SettingCacheHandler=_},function(W,Q){W.exports=Re},function(W,Q){W.exports=we},function(W,Q){W.exports=he},function(W,Q,se){var J,G,U=this&&this.__assign||function(){return(U=Object.assign||function(L){for(var A,H=1,ge=arguments.length;H<ge;H++)for(var Ee in A=arguments[H])Object.prototype.hasOwnProperty.call(A,Ee)&&(L[Ee]=A[Ee]);return L}).apply(this,arguments)},C=this&&this.__importDefault||function(L){return L&&L.__esModule?L:{default:L}},N=(Object.defineProperty(Q,"__esModule",{value:!0}),Q.SettingFetchHandler=void 0,se(16)),v=se(1),f=se(17),_=se(6),b=C(se(3)),y=se(0),M=se(2);function Y(L,A){this._options=L,this._log=A,this.seq=0,this.userID="",this.unSendCommandList=new N.LinkedList,this.testNetPackageSize=!1,this.protobuf=new f.CloudSettingProtoBuf}(J=J||{})[J.SERVICE_ClOUD_SETTING=10]="SERVICE_ClOUD_SETTING",(C=G=G||{})[C.METHOD_UNSET=0]="METHOD_UNSET",C[C.METHOD_GET=1]="METHOD_GET",C[C.METHOD_POST=2]="METHOD_POST",Y.prototype.setOptions=function(L){this._options=L},Y.prototype.setDataReport=function(L){this.W=L},Y.prototype.setUserID=function(L){this.userID=L},Y.prototype.fetchSetting=function(L,A,H,ge,Ee){var Se=this;return Ee===void 0&&(Ee=!0),new Promise(function(ue,oe){function be(ae){var xe,Z=ae.code,$=ae.data,K=ae.polling_interval;ae=ae.reportData,Se._log.info(y.SETTINGFETCHHANDLER_FETCHSETTING+" suc "+Z),$&&(xe=[],Object.keys($).forEach(function(X){var B;xe.push({name:X,code:$[X].code,message:(B=$[X])==null?void 0:B.message,versions:JSON.stringify((B=$[X])==null?void 0:B.versions),content:JSON.stringify((B=$[X])==null?void 0:B.data)})})),Se.W&&Se.W(Fe,"request_end",{code:Z,reportData:ae,params:R,requestKV:k,files:xe,polling:Ee}),ue({data:$,polling_interval:K})}function Le(ae){var xe=ae.code,Z=ae.msg,$=ae.status_code;ae=ae.reportData,Se._log.warn(y.SETTINGFETCHHANDLER_FETCHSETTING+" fail "+xe),Se.W&&Se.W(Fe,"request_end",{code:xe,params:R,requestKV:k,reportData:ae,polling:Ee}),oe({code:xe,msg:Z,status_code:$})}var pe={product:Se._options.product,files:L.map(function(ae){return ae.file_name}),param:U(U({},A),{deviceid:void 0}),appid:Se._options.appID,token:H,id_name:ge,timestamp:new Date().getTime(),biztype:0,deviceid:A.deviceid||v.generateUUID(Se._options.env),compress:!1,mode:Se._options.online?"online":"test"},k=pe.param,R={appid:pe.appid,token:pe.token,id_name:pe.id_name,deviceid:pe.deviceid},Fe=Se.seq++;if(Se.W&&Se.W(Fe,"request_start",{polling:Ee}),!Se._options.connection)throw Error("connection required");if(Se._options.productNum!==void 0){var te,Ue=[];for(te in pe.param)pe.param[te]!==void 0&&Ue.push({key:te,value:pe.param[te]});var it={product:Se._options.productNum,response_compress:_.INIT_CONFIG.compress?0:1,files:L,param_list:Ue,p_version:_.INIT_CONFIG.p_version},ee=(Se._log.info(y.SETTINGFETCHHANDLER_FETCHSETTING+" files "+JSON.stringify(it.files)+" compress "+it.response_compress),Se._options.online?1:2);Se.sendCloudPBRequest(ge,it,H,ee,be,Le)}else Se.sendCloudRequest(ge,pe,"/cloud-setting/get",function(ae){be(ae)},function(ae){Le(ae)})})},Y.prototype.sendCloudRequest=function(L,A,H,ge,Ee,Se,ue){var oe=this,be=(Se===void 0&&(Se=3),ue===void 0&&(ue=[]),new Date().getTime());this.sendNetAgentHttpRequest({service:J.SERVICE_ClOUD_SETTING,body:A,ack:!1,idName:L,method_no:G.METHOD_POST,location:H},function(Le){var pe,k,R,Fe,te;(Le==null?void 0:Le.status_code)===200?(pe=(Fe=JSON.parse(Le.body)).code,k=Fe.message,R=Fe.data,Fe=Fe.polling_interval,te=new Date().getTime()-be,ue.push({timestamp:be,url:H,error:pe,duration:te}),pe===0?ge({code:pe,msg:k,data:R,polling_interval:Fe,reportData:ue}):Ee({code:pe,msg:k,reportData:ue})):(te=new Date().getTime()-be,ue.push({timestamp:be,url:H,error:Le==null?void 0:Le.status_code,duration:te}),0<Se?(Se--,oe.sendCloudRequest(L,A,H,ge,Ee,Se,ue)):Ee(U(U({},M.FILE_REQUEST_FAIL),{reportData:ue})))},function(Le){var pe=new Date().getTime()-be;ue.push({timestamp:be,url:H,error:Le.code,duration:pe}),!oe._options.connection||(pe=oe._options.connection)!=null&&pe.isDestroy?Ee(U(U({},M.FILE_REQUEST_FAIL),{reportData:ue,status_code:Le==null?void 0:Le.status_code})):0<Se?(Se--,oe.sendCloudRequest(L,A,H,ge,Ee,Se,ue)):Ee(U(U({},M.FILE_REQUEST_FAIL),{reportData:ue}))},null,{timeout:4e3})},Y.prototype.sendNetAgentHttpRequest=function(L,A,H,ge,Ee){L={param:L,suc:A,err:H,ack:ge,option:Ee},(A=this._options.connection)!=null&&A.isConnect()?this.sendNetUintData(L):this.unSendCommandList.push(L)},Y.prototype.sendNetUintData=function(L){var A;(A=this._options.connection)!=null&&A.startHttpRequest(L.param,L.suc,L.err,L.ack,L.option)},Y.prototype.checkUnSendMsgs=function(L){for(var A=L.getFirst();A!=null;)L.remove(A),A._data&&A._data.param&&this.sendNetUintData(A._data),A=L.getFirst()},Y.prototype.sendCloudPBRequest=function(L,A,H,ge,Ee,Se,ue,oe){var be,Le=this,pe=(ue===void 0&&(ue=3),oe===void 0&&(oe=[]),new Date().getTime()),k=this.protobuf.encodeCloudSettingReq(A);(be=this._options.connection)!=null&&be.startHttpRequest2({interfaceID:14,body:k,ack:!1,idName:L,method:G.METHOD_POST,token:H,mode:ge,reduceRspHeaders:!0},function(R,Fe){if((R==null?void 0:R.status_code)===200){var te=Le.protobuf.decodeCloudSettingRsp(R.body),Ue=te.message,it=te.polling_interval,ee=te.code||0,ae=(b.default.isLong(ee)&&(ee=ee.toNumber()),new Date().getTime()-pe);if(oe.push({timestamp:pe,error:ee,duration:ae}),ee===0){for(var xe={},Z=0;Z<te.file_response.length;Z++){var $=(Ce=te.file_response[Z]).message,K=Ce.file_name,X=Ce.hash,B=Ce.g_version,fe=Ce.json_data,Ce=(Le._log.info(y.SETTINGFETCHHANDLER_FETCHSETTING+" file rsp "+K+" "+B+" "+X.toString()),Ce.code||0),Ze=(b.default.isLong(Ce)&&(Ce=Ce.toNumber()),{}),st="";if(0<(X==null?void 0:X.byteLength)&&0<(fe==null?void 0:fe.byteLength))try{var Ie=A.response_compress===0?Le._options.inflate(fe,{to:"string"}):v.decodeString(fe);Ze=JSON.parse(Ie),st=X.toString()}catch(D){Le._log.info(y.SETTINGFETCHHANDLER_FETCHSETTING+" decode fail "+(D==null?void 0:D.message)?D.message:JSON.stringify(D))}xe[K]={code:Ce,message:$,versions:{hash:st,g_version:B},data:Ze,hashChange:X.byteLength===0?0:1}}Ee({code:ee,msg:Ue,data:xe,polling_interval:it,reportData:oe})}else Se({code:ee,msg:Ue,reportData:oe})}else ae=new Date().getTime()-pe,oe.push({timestamp:pe,error:R==null?void 0:R.status_code,duration:ae}),0<ue?(ue--,Le.sendCloudPBRequest(L,A,H,ge,Ee,Se,ue,oe)):Se(U(U({},M.FILE_REQUEST_FAIL),{reportData:oe,status_code:R==null?void 0:R.status_code}))},function(R){var Fe=new Date().getTime()-pe;oe.push({timestamp:pe,error:R.code,duration:Fe}),Le._options.connection&&((Fe=Le._options.connection)==null||!Fe.isDestroy)&&0<ue?(ue--,Le.sendCloudPBRequest(L,A,H,ge,Ee,Se,ue,oe)):Se(U(U({},M.FILE_REQUEST_FAIL),{reportData:oe,status_code:R==null?void 0:R.status_code}))},null,{timeout:4e3,extras:{protoCmd:"GetCloudSettingConfigRequest"}})},Q.SettingFetchHandler=se=Y},function(W,Q,se){Object.defineProperty(Q,"__esModule",{value:!0}),Q.LinkedList=Q.ListNode=void 0,Object.defineProperty(G.prototype,"id",{get:function(){return this._id||null},set:function(C){this._id=C},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"data",{get:function(){return this._data},set:function(C){this._data=C},enumerable:!1,configurable:!0}),G.prototype.hasNext=function(){return this.next&&this.next.id},G.prototype.hasPrev=function(){return this.prev&&this.prev.id};var J=G;function G(C,N){C===void 0&&(C=null),N===void 0&&(N=null),this.next=null,this.prev=null,this._id=C,this._data=N}function U(){this.start=new J,this.end=new J,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}Q.ListNode=J,U.prototype.insertBefore=function(C,N){return(N=new J(this._idCounter,N)).next=C,N.prev=C.prev,C.prev&&(C.prev.next=N),C.prev=N,++this._idCounter,++this._numNodes,N},U.prototype.addLast=function(C){return this.insertBefore(this.end,C)},U.prototype.add=function(C){return this.addLast(C)},U.prototype.getFirst=function(){return this._numNodes===0?null:this.start.next},U.prototype.getLast=function(){return this._numNodes===0?null:this.end.prev},U.prototype.size=function(){return this._numNodes},U.prototype.getFromFirst=function(C){var N=0,v=this.start.next;if(0<=C)for(;N<C&&v!==null;)v=v.next,++N;else v=null;if(v===null)throw"Index out of bounds.";return v},U.prototype.get=function(C){return C===0?this.getFirst():C===this._numNodes-1?this.getLast():this.getFromFirst(C)},U.prototype.remove=function(C){return C.prev&&(C.prev.next=C.next),C.next&&(C.next.prev=C.prev),--this._numNodes,C},U.prototype.removeFirst=function(){var C=null;return 0<this._numNodes&&this.start.next?this.remove(this.start.next):C},U.prototype.removeLast=function(){var C=null;return 0<this._numNodes&&this.end.prev?this.remove(this.end.prev):C},U.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},U.prototype.each=function(C){for(var N=this.start;N.hasNext();)C(N=N.next)},U.prototype.find=function(C){for(var N=this.start,v=!1,f=null;N.hasNext()&&!v;)C(N=N.next)&&(f=N,v=!0);return f},U.prototype.map=function(C){for(var N=this.start,v=[];N.hasNext();)C(N=N.next)&&v.push(N);return v},U.prototype.push=function(C){return this.addLast(C)},U.prototype.unshift=function(C){this.insertBefore(0<this._numNodes?this.start.next:this.end,C)},U.prototype.pop=function(){return this.removeLast()},U.prototype.shift=function(){return this.removeFirst()},Q.LinkedList=U},function(W,Q,se){var J=this&&this.__createBinding||(Object.create?function(_,b,y,M){M===void 0&&(M=y),Object.defineProperty(_,M,{enumerable:!0,get:function(){return b[y]}})}:function(_,b,y,M){_[M=M===void 0?y:M]=b[y]}),G=this&&this.__setModuleDefault||(Object.create?function(_,b){Object.defineProperty(_,"default",{enumerable:!0,value:b})}:function(_,b){_.default=b}),U=this&&this.__importStar||function(_){if(_&&_.__esModule)return _;var b={};if(_!=null)for(var y in _)y!=="default"&&Object.hasOwnProperty.call(_,y)&&J(b,_,y);return G(b,_),b},C=this&&this.__importDefault||function(_){return _&&_.__esModule?_:{default:_}},N=(Object.defineProperty(Q,"__esModule",{value:!0}),Q.CloudSettingProtoBuf=void 0,C(se(3))),v=(U=U(se(5)),C(se(18)).default.cloudsetting);function f(){}U.util.Long=N.default,U.configure(),f.prototype.encodeCloudSettingReq=function(_){var b=v.GetCloudSettingConfigRequest;return _=b.create(_),b.encode(_).finish()},f.prototype.decodeCloudSettingRsp=function(_){return v.GetCloudSettingConfigResponse.decode(_)},Q.CloudSettingProtoBuf=f},function(W,Q,se){se.r(Q);var J=se(5);se=se(4),(J=J.default||J).util.Long=se.default||se;let G=J.util.Long.fromBits||function(){return 0};for(var U=J.roots,C=J.types?J.types.basic:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0,string:2,bytes:2},N=J.types?J.types.packed:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0},v=Object.keys(C),f={$:function(y){return f[y]?f[y].call(this):U[y].decode?U[y].decode(this,this.uint32()):f.$.call(this,"int32")}},_={$:function(y,M,Y){var L=C[y];return L===void 0?U[y].encode?(this.uint32(Y<<3|2).fork(),U[y].encode(M,this).ldelim()):_.$.call(this,"int32",M,Y):_[y].call(this.uint32(Y<<3|L),M)}},b=0;b<v.length;b++)f[v[b]]=J.Reader.prototype[v[b]],_[v[b]]=J.Writer.prototype[v[b]];(function y(M,Y,L,A){for(var H=0,ge=Object.keys(M);H<ge.length;H++){var Ee=ge[H];if(M[Ee].$m&&Object.keys(M[Ee].$m).every(function(Se){return Number(Se)})){if(L[Ee])throw Error(`nested type ${L}.${Ee} has already exist`);L[Ee]=((Se,ue)=>{function oe(R){for(var Fe in Se)(Fe=Se[Fe])[1].charAt(0)==="{"?this[Fe[0]]={}:Fe[1].charAt(0)!=="["&&Fe[1].charAt(0)!=="<"||(this[Fe[0]]=[]);if(R)for(var te=Object.keys(R),Ue=0;Ue<te.length;++Ue)R[te[Ue]]!=null&&(this[te[Ue]]=R[te[Ue]])}var be,Le={};for(be in Se){var pe=Se[be],k=pe[1];k.charAt(0)==="{"?(oe.prototype[pe[0]]=J.util.emptyObject,Le[k]={$m:k.substring(1).split(",").map(function(R,Fe){return["$"+(Fe+1),R,null]}).reduce(function(R,Fe,te){return R[te+1]=Fe,R},{})}):oe.prototype[pe[0]]=k.charAt(0)==="["||k.charAt(0)==="<"?J.util.emptyArray:k==="bytes"?J.util.newBuffer([]):pe[2]&&pe[2].hasOwnProperty("low")&&pe[2].hasOwnProperty("high")?G(pe[2].low,pe[2].high,pe[2].unsigned):pe[2]}return oe.create=function(R){return new oe(R)},oe.decode=function(R,Fe){R instanceof J.Reader||(R=J.Reader.create(R));for(var te=Fe===void 0?R.len:R.pos+Fe,Ue=new oe;R.pos<te;){var it=R.uint32();if(0<(xe=it>>>3)&&Se[xe]){var ee=Se[xe][0];if((ae=Se[xe][1]).charAt(0)==="{")Ue[ee]===J.util.emptyObject&&(Ue[ee]={}),xe=oe.$namespace[ae].decode(R,R.uint32()),Ue[ee][xe.$1]=xe.$2;else if(ae.charAt(0)==="["||ae.charAt(0)==="<"){ae=ae.substring(1),Ue[ee]&&Ue[ee].length||(Ue[ee]=[]);var ae,xe=!f[ae]&&!U[ae].decode;if(N[ae=xe?"int32":ae]!==void 0&&(7&it)==2)for(var Z=R.uint32()+R.pos;R.pos<Z;)Ue[ee].push(f.$.call(R,ae));else Ue[ee].push(f.$.call(R,ae))}else Ue[ee]=f.$.call(R,ae)}else R.skipType(7&it)}return Ue},oe.encode=function(R,Fe){for(var te in Fe=Fe||J.Writer.create(),Se){var Ue=Se[te][0];if((Z=Se[te][1]).charAt(0)==="{"){if(R[Ue]!=null&&R.hasOwnProperty(Ue))for(var it=0,ee=Object.keys(R[Ue]);it<ee.length;++it)Fe.uint32(te<<3|2).fork(),oe.$namespace[Z].encode({$1:ee[it],$2:R[Ue][ee[it]]},Fe).ldelim()}else if(Z.charAt(0)==="["||Z.charAt(0)==="<"){var ae=Z.charAt(0)==="<",xe=(Z=Z.substring(1),R[Ue]);if(xe!=null&&xe.length){var Z=C[Z]!==void 0||U[Z].encode?Z:"int32";if(ae&&N[Z]!==void 0){for(Fe.uint32(te<<3|2).fork(),it=0;it<xe.length;it++)_[Z].call(Fe,xe[it]);Fe.ldelim()}else for(it=0;it<xe.length;it++)_.$.call(Fe,Z,xe[it],te)}}else R[Ue]!=null&&R.hasOwnProperty(Ue)&&_.$.call(Fe,Z,R[Ue],te)}return Fe},Object.keys(Le).length&&(oe.$namespace=y(Le,Y+"."+ue,oe.$namespace||{},!0)),oe})(M[Ee].$m,Ee)}else M[Ee].$s?L[Ee]=((Se,ue)=>{function oe(be,Le,pe){J.rpc.Service.call(this,be,Le,pe)}return((oe.prototype=Object.create(J.rpc.Service.prototype)).constructor=oe).create=function(be,Le,pe){return new oe(be,Le,pe)},Object.keys(Se).forEach(function(be){var Le=Se[be];function pe(k,R){return this.rpcCall(pe,U[Le[0]],U[Le[1]],k,R)}Object.defineProperty(pe,"name",{value:be}),Object.defineProperty(pe,"path",{value:Y+"."+ue}),oe.prototype[be]=pe}),oe})(M[Ee].$s,Ee):M[Ee].$e&&Object.values(M[Ee].$e).every(function(Se){return Number(Se)===Se})&&(L[Ee]=(Se=>{for(var ue=Object.keys(Se),oe={},be=0;be<ue.length;be++)oe[oe[ue[be]]=Se[ue[be]]]=ue[be];return oe})(M[Ee].$e));L[Ee]&&!A&&(U[Y+"."+Ee]=L[Ee]),delete M[Ee].$m,delete M[Ee].$s,delete M[Ee].$e,L[Ee]=y(M[Ee],Y?Y+"."+Ee:Ee,L[Ee]||{})}return L})({cloudsetting:{cloudsetting:{CloudSettingFileResponse:{$m:{1:["code","int64",{low:0,high:0,unsigned:!1}],2:["message","string",""],3:["file_name","string",""],4:["global_version","string",""],5:["version","string",""],6:["app_version","string",""],7:["json_data","bytes",[]],8:["hash","bytes",[]],9:["g_version","uint32",0]}},File:{$m:{1:["file_name","string",""],2:["hash","bytes",[]],3:["g_version","uint32",0]}},GetCloudSettingConfigRequest:{$m:{1:["product","cloudsetting.cloudsetting.Product",0],2:["response_compress","int32",0],3:["file_list","<string",null],4:["param_list","<cloudsetting.cloudsetting.Param",null],5:["files","<cloudsetting.cloudsetting.File",null],6:["p_version","uint32",0]}},GetCloudSettingConfigResponse:{$m:{1:["code","int64",{low:0,high:0,unsigned:!1}],2:["message","string",""],3:["polling_interval","int32",0],4:["file_response","<cloudsetting.cloudsetting.CloudSettingFileResponse",null]}},Param:{$m:{1:["key","string",""],2:["value","string",""]}},Product:{$e:{RTC:0,WEB_RTC:1,ZIM:2,ROOM_KIT:3,DOC_SHARE:4,WHITE_BOARD:5,SELF_CHECK:999,TEST_ANOOUS:1e3}}}}},"",U,!1),J.util.global.cloudsetting=U.cloudsetting,Q.default=U.cloudsetting}],Ne={},Me.m=nt,Me.c=Ne,Me.d=function(W,Q,se){Me.o(W,Q)||Object.defineProperty(W,Q,{enumerable:!0,get:se})},Me.r=function(W){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(W,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(W,"__esModule",{value:!0})},Me.t=function(W,Q){if(1&Q&&(W=Me(W)),8&Q||4&Q&&typeof W=="object"&&W&&W.__esModule)return W;var se=Object.create(null);if(Me.r(se),Object.defineProperty(se,"default",{enumerable:!0,value:W}),2&Q&&typeof W!="string")for(var J in W)Me.d(se,J,(function(G){return W[G]}).bind(null,J));return se},Me.n=function(W){var Q=W&&W.__esModule?function(){return W.default}:function(){return W};return Me.d(Q,"a",Q),Q},Me.o=function(W,Q){return Object.prototype.hasOwnProperty.call(W,Q)},Me.p="",Me(Me.s=7);function Me(W){var Q;return(Ne[W]||(Q=Ne[W]={i:W,l:!1,exports:{}},nt[W].call(Q.exports,Q,Q.exports,Me),Q.l=!0,Q)).exports}var nt,Ne}(Te(6994),Te(3788),Te(6361),Te(955),Te(5178))},4908:function(It,Ye,Te){Te.d(Ye,{$7:function(){return Si},$9:function(){return Rr},$H:function(){return De},$Q:function(){return nr},$g:function(){return Fe},AJ:function(){return be},AW:function(){return _t},B$:function(){return he},BY:function(){return P},Bc:function(){return or},CK:function(){return ir},Cp:function(){return Ce},D1:function(){return zr},E$:function(){return Ze},EV:function(){return pr},F:function(){return sr},FQ:function(){return Nn},Fv:function(){return ne},GV:function(){return Wr},HF:function(){return _r},Hu:function(){return zn},Io:function(){return fr},J8:function(){return ee},Jd:function(){return Qn},Jv:function(){return H},KG:function(){return oe},KZ:function(){return it},Kt:function(){return Fn},Lk:function(){return le},MJ:function(){return K},Mc:function(){return Yn},Mu:function(){return y},Mw:function(){return Tn},N7:function(){return J},Nr:function(){return Se},ON:function(){return X},Of:function(){return Ai},Og:function(){return _},Oq:function(){return se},Ov:function(){return an},Pe:function(){return rn},RI:function(){return dr},S2:function(){return jn},Sb:function(){return ri},TW:function(){return ft},Ux:function(){return fn},V0:function(){return ze},Vz:function(){return ge},We:function(){return ae},Wg:function(){return A},Xk:function(){return et},YO:function(){return L},Yu:function(){return Re},Z1:function(){return C},_F:function(){return mt},_T:function(){return Ee},_g:function(){return Ot},_u:function(){return bn},aH:function(){return mn},aT:function(){return Le},bs:function(){return Vr},ch:function(){return b},co:function(){return me},e7:function(){return Q},eH:function(){return G},eU:function(){return Ne},er:function(){return k},es:function(){return kn},fF:function(){return Ue},fj:function(){return In},fn:function(){return Ie},fo:function(){return M},gf:function(){return te},i6:function(){return Me},iJ:function(){return Yr},k1:function(){return B},kA:function(){return ce},kn:function(){return Jn},lZ:function(){return de},li:function(){return ii},nO:function(){return W},ns:function(){return Qr},ny:function(){return Z},oI:function(){return R},oW:function(){return pe},oe:function(){return yi},oq:function(){return nt},ov:function(){return xe},pR:function(){return Lr},pT:function(){return U},r2:function(){return Ln},rH:function(){return D},rP:function(){return $},r_:function(){return f},tH:function(){return ye},tI:function(){return st},tp:function(){return v},v2:function(){return Y},vB:function(){return tr},vW:function(){return we},wH:function(){return Ve},w_:function(){return He},wd:function(){return Ci},x6:function(){return fe},xp:function(){return N},zF:function(){return ue}});var E=Te(8627),w=Te(5095),Re="/sdk/init",we={event:Re,error:{_n:E.ZEp},system_info:w.tK,servers:w.yp},he={event:"/sdk/login"},Me={event:"listener"},nt={event:Re},Ne={event:"/sdk/create_stream",error:{yn:E.OrZ,wn:E.LLz,Sn:E.t85,En:E.yK,In:E.L8E,Rn:E.FB3,Tn:E.mrK,Cn:E.zs3,An:E.Be2,zn:E.JSm},stream_type:w.tK,screen:w.Gq,camera:w.Gq,custom:w.Gq,preview_conf:w.Gq,media_stream_id:w.tK},W={event:"/sdk/create_zego_stream",local_stream_id:w.tK,stream_options:w.Gq},Q={event:"/sdk/start_capture_mic",local_stream_id:w.tK,stream_options:w.Gq},se={event:"/sdk/start_capture_camera",local_stream_id:w.tK,stream_options:w.Gq},J={event:"/sdk/start_capture_camera_mic",local_stream_id:w.tK,stream_options:w.Gq},G={event:"/sdk/start_capture_custom_audio",local_stream_id:w.tK,stream_options:w.Gq},U={event:"/sdk/start_capture_custom_video",local_stream_id:w.tK,stream_options:w.Gq},C={event:"/sdk/start_capture_custom_video_audio",local_stream_id:w.tK,stream_options:w.Gq},N={event:"/sdk/start_capture_screen_video",local_stream_id:w.tK,stream_options:w.Gq},v={event:"/sdk/start_capture_screen_video_audio",local_stream_id:w.tK,stream_options:w.Gq},f={event:"/sdk/update_publish_stream",local_stream_id:w.tK,update_type:w.Tr},_={event:"/sdk/start_publish",error:{Dn:E.LLz,Nn:E.Q9p,Pn:E.xfZ,Mn:E.gSF,xn:E.PA0,jn:E.fzq,qn:E.f43,Ln:E.qvY,Bn:E.S4u,Un:E.SRE,Gn:E.Xxx,Jn:E.g9p,Fn:E.jZ$,Hn:E.$wo,Vn:E.SmZ,Qn:E.VU9,Yn:E.MrD,Kn:E.ZpF,Zn:E.iei,Xn:E.aa2,Wn:E.HCP,$n:E.dg1,te:E._68,ie:E.kbF,ne:E.kOd,ee:E.WP4,re:E.JDv,se:E.Q3v,ue:E.RBR,ae:E.NCg,ce:E.xbZ,he:E.OdW,fe:E.sJH,le:E.MrS},urls:w.yp,server_url:w.tK,publish_option:w.Gq,message:w.tK,stream_id:w.tK,stream_sid:w.Tr,room_id:w.tK,video_en_codec_id:w.Tr,cap_w:w.Tr,cap_h:w.Tr,w:w.Tr,h:w.Tr,video_en_fps:w.Tr,video_en_bps:w.Tr,audio_c_channel_count:w.Tr,audio_en_bps:w.Tr,aec_level:w.Tr,ans_level:w.Tr,agc:w.yS,traffic_control_min_video_bitrate:{bitrate:w.Tr,mode:w.Tr},cap_volume:w.Tr,enable_camera:w.yS,enable_mic:w.yS,video_activate:w.yS,audio_activate:w.yS,gw_version:w.Tr,is_dual_stream:w.Tr,is_mini:w.yS,is_peer:w.yS},b={event:"/publish/start",is_peer:w.yS,reason:w.tK,url:w.tK,ip:w.tK,peer_id:w.Tr,source_type:w.tK,net_protocol:w.tK,wait_consume:w.Tr,dispatch_consume:w.Tr,signal_consume:w.Tr,is_dual_stream:w.Tr,is_mini:w.yS,mini_error:w.Tr,port:w.Tr},y={event:"/publish/rtc_dispatch",ip_mode:w.Tr,gw_nodes:w.yp,ip_infos:w.Gq,ip_v6_infos:w.Gq},M={event:"/publish/restart",stream_id:w.tK,server_url:w.tK,reason_code:w.Tr,is_dual_stream:w.Tr,is_mini:w.yS,mini_error:w.Tr},Y={event:"/sdk/publish",room_id:w.tK,room_sid_string:w.tK,retry_btime:w.Tr,max_retry_interval:w.Tr,fail_cnt:w.Tr,continuous_fail_cnt:w.Tr,probe_ip_cnt:w.Tr,valid_probe_ip_cnt:w.Tr,poor_quality_retry_cnt:w.Tr,use_resource_type:w.yp,probe_not_trigger_retry_info:w.Gq,stop_reason:w.tK,child_error:w.Tr,try_time:w.Tr,try_cnt:w.Tr,server_url:w.tK,publish_begin_time:w.Tr,publish_state_time:w.Tr,bitrate:w.Tr,h:w.Tr,w:w.Tr,cap_w:w.Tr,cap_h:w.Tr,fps:w.Tr,use_na:w.Tr,env:w.Tr,webrtc_sid:w.Tr,stream_id:w.tK,itemtype:w.tK,total_d:w.Tr,valid_d:w.Tr,tempbroken_cnt:w.Tr},L={event:"/sdk/api/publish_video_c_size",webrtc_sid:w.Tr,w:w.Tr,h:w.Tr},A={event:"/sdk/play_video_size_changed",webrtc_sid:w.Tr,w:w.Tr,h:w.Tr},H={event:"/rtc/publish",tryidx:w.Tr,url:w.tK,ip:w.tK,net_protocol:w.tK,lsttime:w.Tr,denied_info:w.tK,dispatch_external_ip:w.tK,total_stat:w.Gq,room_id:w.tK,room_sid_string:w.tK,resource_type:w.tK,protocol:w.tK,stop_reason:w.tK,try_time:w.Tr},ge={event:"/sdk/stop_publish",error:{wn:E.LLz},stream_id:w.tK,stream_sid:w.Tr,room_id:w.tK},Ee={event:"/rtc/publish_stream_state_error"},Se={event:"/sdk/start_play",error:{de:E.d49,ve:E.ann,me:E.clM,pe:E.J79,ge:E.S4u,be:E.RfS,_e:E.Q9p,ye:E.xfZ,we:E.gSF,Se:E.PA0,Ee:E.b1q,ke:E.RZs,Oe:E.XHx,Ie:E.cMG,Re:E.zML,Te:E.ekj,Vn:E.dqB,Qn:E.gHA,Kn:E.MK1,Yn:E.dXc,Zn:E.hje,Xn:E.Zws,Wn:E.SB8,te:E.B3d,$n:E.wxm,Ce:E.Arx,ne:E.lgu,ee:E.Tij,Ae:E.pWJ,ze:E.MuX,De:E.I4J,he:E.OdW,Ne:E.ckD,Me:E.hYx,xe:E.T_8},room_id:w.tK,urls:w.yp,server_url:w.tK,video_layer:w.Tr,play_option:w.Gq,message:w.tK,stream_id:w.tK,stream_sid:w.Tr,resource_mode:w.Tr,src:w.tK,video_codec_id:w.tK,room_sid_string:w.tK,is_multi:w.yS,audio_activate:w.yS,video_activate:w.yS,gw_version:w.Tr,use_na:w.Tr,biz_product:w.Tr,is_peer:w.yS,is_mini:w.yS},ue={event:"/play/start",tryidx:w.Tr,is_peer:w.yS,reason:w.tK,url:w.tK,ip:w.tK,port:w.Tr,peer_id:w.Tr,source_type:w.tK,net_protocol:w.tK,wait_consume:w.Tr,dispatch_consume:w.Tr,signal_consume:w.Tr,biz_product:w.Tr,is_mini:w.yS},oe={event:"/play/rtc_dispatch",ip_mode:w.Tr,gw_nodes:w.yp,ip_infos:w.Gq,ip_v6_infos:w.Gq},be={event:"/play/l3_dispatch",ip_mode:w.Tr,gw_nodes:w.yp,ip_infos:w.Gq,ip_v6_infos:w.Gq},Le={event:"/play/restart",stream_id:w.tK,server_url:w.tK,reason_code:w.Tr,ip:w.tK,is_mini:w.yS},pe={event:"/sdk/play",audio_cumulative_break_time:w.Tr,audio_cumulative_decode_time:w.Tr,video_cumulative_break_time:w.Tr,video_cumulative_decode_time:w.Tr,l3_a_break_time:w.Tr,l3_a_decode_time:w.Tr,l3_v_break_time:w.Tr,l3_v_decode_time:w.Tr,rtc_a_break_time:w.Tr,rtc_a_decode_time:w.Tr,rtc_v_break_time:w.Tr,rtc_v_decode_time:w.Tr,fft_audio:w.Tr,fft_video:w.Tr,room_id:w.tK,room_sid_string:w.tK,retry_btime:w.Tr,max_retry_interval:w.Tr,use_na:w.Tr,fail_cnt:w.Tr,continuous_fail_cnt:w.Tr,probe_ip_cnt:w.Tr,valid_probe_ip_cnt:w.Tr,poor_quality_retry_cnt:w.Tr,probe_not_trigger_retry_info:w.Gq,use_resource_type:w.yp,stop_reason:w.tK,child_error:w.Tr,try_time:w.Tr,try_cnt:w.Tr,webrtc_sid:w.Tr,itemtype:w.tK,server_url:w.tK,play_begin_time:w.Tr,play_state_time:w.Tr,play_state_cnt:w.Tr,first_frame_time:w.Tr,protocol:w.tK,dispatch_external_ip:w.tK,total_stat:w.Gq,w:w.Tr,h:w.Tr,abrc:w.Tr,vbrc:w.Tr,vinfo:w.Gq,total_d:w.Tr,valid_d:w.Tr,tempbroken_cnt:w.Tr},k={event:"/rtc/play",tryidx:w.Tr,url:w.tK,ip:w.tK,stream_id:w.tK,room_id:w.tK,room_sid_string:w.tK,net_protocol:w.tK,lsttime:w.Tr,denied_info:w.tK,stop_reason:w.tK,dispatch_external_ip:w.tK,env:w.Tr,resource_type:w.tK,protocol:w.tK,total_stat:w.Gq,vinfo:w.Gq,try_time:w.Tr},R={event:"/sdk/stop_play",error:{wn:E.LLz},room_id:w.tK,stream_id:w.tK,webrtc_sid:w.Tr,stream_sid:w.Tr,biz_product:w.Tr},Fe={event:"/rtc/play_stream_state_error"},te={event:"/device/list",error:{yn:E.OrZ,je:E.s_m},dev_list:w.Gq,dev_kind:w.tK},Ue={event:"/device/audio_device_changed",error:{yn:E.OrZ,je:E.s_m},interrupt:w.Tr,device:w.tK,device_name:w.tK},it={event:"/device/video_device_changed",error:{yn:E.OrZ,je:E.s_m},interrupt:w.Tr,device:w.tK,device_name:w.tK},ee={event:"/sdk/check_system",capability:w.Gq},ae={event:"/sdk/remote_camera_update",stream_id:w.tK,camera_status:w.tK,status_code:w.Tr},xe={event:"/sdk/remote_mic_update",stream_id:w.tK,mic_status:w.tK,status_code:w.Tr},Z={event:"/sdk/destroy_stream",error:{qe:E.S5f},stop_reason:w.tK},$={event:"/device/api/audio_output",device:w.tK,device_name:w.tK,reason_type:w.tK},K={event:"/liveroom/recv_stream_update_info",stream_update_type:w.tK,stream_seq:w.Tr,stream_list:w.Gq,error:{Le:E.sVF}},X={event:"/liveroom/send_stream_update_info",stream_update_type:w.tK,stream_extra_info:w.tK,stream_id:w.tK,send_seq:w.Tr,use_na:w.Tr},B={event:"/liveroom/get_current_stream_list",room_id:w.tK,room_sid_string:w.tK,stream_seq:w.Tr,stream_size:w.Tr,stream_list:w.Gq,use_ua:w.Tr,error:{wn:E.LLz,NOT_LOGIN:E.S4u}},fe={event:"/sdk/net_first_video_frame",webrtc_sid:w.Tr,fft_consumed:w.Gq,resource_type:w.tK,reliability:w.Tr,push_consumed:w.Tr,prepare_recv_consumed:w.Tr,connected_consumed:w.Tr,protocol:w.tK,biz_product:w.Tr,dev_changed:w.yS},Ce={event:"/sdk/net_first_audio_frame",webrtc_sid:w.Tr,fft_consumed:w.Gq,resource_type:w.tK,reliability:w.Tr,push_consumed:w.Tr,prepare_recv_consumed:w.Tr,connected_consumed:w.Tr,protocol:w.tK,biz_product:w.Tr,dev_changed:w.yS},Ze={event:"/app/lifecycle",state:w.tK},st={event:"/sdk/publish_volume_changed",old_cap_volume:w.Tr,cap_volume:w.Tr,change_duration:w.Tr,error:{wn:E.ZEp}},Ie={event:"/sdk/listener"},D={event:"/sdk/network_change",current_client_ip:w.tK,last_client_ip:w.tK},me={event:"/sdk/network_first_ntp_sync",ntp_source:w.Tr,ntp_offset:w.Tr},ce={event:"/sdk/net_probe",net_quality:w.Tr,node_list:w.yp},le={event:"/sdk/net_probe_result",is_switch:w.yS,is_publish:w.yS,stream_id:w.tK,result:w.Tr,node:w.tK,net_quality:w.Tr,probe_net_quality:w.Tr},et={event:"/cloud_setting/cache",files:w.Gq},ze={event:"/cdn/play",protocol:w.tK,tryidx:w.Tr,url:w.tK,stop_reason:w.tK,biz_product:w.Tr},ft={event:"/l3/play",protocol:w.tK,tryidx:w.Tr,url:w.tK,stop_reason:w.tK,biz_product:w.Tr,try_time:w.Tr},_t={event:"/sdk/play_src_changed",last_src:w.tK,src:w.tK,biz_product:w.Tr},mt={event:"/publish/create_offer",sdp:w.tK,stream_type:w.tK,is_mini:w.yS,is_dual_stream:w.Tr},Ve={event:"/publish/set_local_sdp",sdp:w.tK,stream_type:w.tK,is_mini:w.yS,is_dual_stream:w.Tr},Ot={event:"/publish/create_session",sdp:w.tK,is_mini:w.yS,gw_nodes:w.yp,gw_nodes_ttl:w.Tr,gw_version:w.Tr,webrtc_sid:w.Tr},rn={event:"/publish/set_remote_sdp",sdp:w.tK,is_mini:w.yS,webrtc_sid:w.Tr,is_dual_stream:w.Tr},an={event:"/publish/ice_connected",webrtc_sid:w.Tr},In={event:"/publish/rtc_publish_event",event_state:w.Tr,webrtc_sid:w.Tr},Tn={event:"/rtc/play_event_message",event_state:w.Tr,webrtc_sid:w.Tr},fn={event:"/rtc/recv_close_session",err_info:w.Gq},Rr={event:"/rtc/recv_reset_session"},ir={event:"/rtc/ice_connection_state_changed",ice_state:w.tK},Ln={event:"/publish/send_media_desc",webrtc_sid:w.Tr,remote_sdp:w.tK},mn={event:"/publish/send_ice_candidate",candidate_info:w.Gq},Qn={event:"/play/create_offer",sdp:w.tK,is_mini:w.yS,stream_type:w.tK},Nn={event:"/play/set_local_sdp",sdp:w.tK,is_mini:w.yS,stream_type:w.tK},or={event:"/play/create_session",sdp:w.tK,is_mini:w.yS,gw_nodes:w.yp,gw_nodes_ttl:w.Tr,gw_version:w.Tr,webrtc_sid:w.Tr},pr={event:"/play/set_remote_sdp",sdp:w.tK,is_mini:w.yS,webrtc_sid:w.Tr},sr={event:"/play/ice_connected",webrtc_sid:w.Tr},Wr={event:"/play/send_media_desc",webrtc_sid:w.Tr,remote_sdp:w.tK},tr={event:"/play/send_ice_candidate",candidate_info:w.Gq},zn={event:"/zegoconn/connect"},bn={event:"/sdk/net_ip_stack",ipv4:w.tK,ipv6:w.tK},Jn={event:"/sdk/media_login_req"},zr={event:"/zegoconn/proxy_connect",service_no:w.Tr,proxy_link_sources:w.Tr,recv_time:w.Tr,connect_stream:w.Tr},jn={event:"/zegoconn/proxy_broken",service_no:w.Tr},Lr={event:"/zegoconn/proxy_disconnect",service_no:w.Tr},Vr={event:"/rtc/exception_update",stream:w.tK,code:w.Tr,message:w.tK},Ai={event:"/sdk/publish_target",error:{wn:E.ZEp,Be:E.xU2,Ue:E.S4u,Ge:E.I7C,Je:E.HO9,Fe:E.aUw,He:E.Oy0}},Yr={event:"/mss/pushadd",error:{wn:E.ZEp},stream_id:w.tK,url:w.tK},Qr={event:"/mss/pushdel",error:{wn:E.ZEp},stream_id:w.tK,url:w.tK},Ci={event:"/sdk/set_video_config",error:{wn:E.ZEp,qe:E.S5f},video_params:w.Gq,video_conf:w.Gq},Si={event:"/sdk/set_audio_config",error:{wn:E.ZEp,qe:E.S5f},audio_params:w.Gq,audio_conf:w.Gq},ri={event:"/sdk/api/publish_video_en_size",w:w.Tr,h:w.Tr},fr={event:"/sdk/api/publish_video_en_bps",bitrate:w.Tr},Yn={event:"/sdk/api/publish_video_en_fps",fps:w.Tr},yi={event:"/sdk/replace_track",error:{wn:E.ZEp},track_kind:w.tK},dr={event:"/device/api/video_c",error:{wn:E.ZEp,Ve:E.ckg,qe:E.S5f,Qe:E.jut},device:w.tK,device_name:w.tK,facing_mode:w.tK},ii={event:"/device/api/audio_c",error:{wn:E.ZEp,Ve:E.ckg,qe:E.S5f},device:w.tK,device_name:w.tK},kn={event:"/sdk/play_content_changed",webrtc_sid:w.Tr,video_activate:w.yS,audio_activate:w.yS,video_layer:w.Tr},nr={event:"/sdk/mute_publish_video",mute_type:w.Tr,retain:w.yS},Fn={event:"/sdk/mute_publish_audio",mute_type:w.Tr},_r={event:"/device/enable_mic",enable:w.yS,stream_list:w.Gq},P={event:"/device/enable_camera",enable:w.yS,stream_list:w.Gq},He={event:"/sdk/mute_play_video",mute_type:w.Tr},de={event:"/sdk/mute_play_audio",mute_type:w.Tr},ne={event:"/liveroom/send_stream_extra_info",error:{wn:E.ZEp,Ye:E.PTE,Ue:E.S4u,Be:E.xU2,Ke:E.m6U,_zpg_kExtraInfoNull:E.PTE,_zpg_kExtraInfoTooLong:E.V2t},stream_id:w.tK,send_seq:w.Tr,stream_extra_info:w.Gq,room_id:w.tK,room_sid_string:w.tK,use_na:w.Tr},De={event:"/active/sei",action:w.Tr,info_type:w.Tr},ye=["sdp","remote_sdp"]},5095:function(It,Ye,Te){Te.d(Ye,{Gq:function(){return E},Tr:function(){return we},tK:function(){return w},yS:function(){return he},yp:function(){return Re}});var E=function(Me){return Me},w=function(Me){return Me},Re=function(Me){return Me},we=function(Me){return Me},he=function(Me){return Me}},5178:function(It,Ye,Te){var E;It.exports=(E=Te(9021),E.enc.Utf8)},5471:function(It,Ye,Te){var E,w,Re,we,he,Me,nt;It.exports=(nt=Te(9021),Re=(w=(E=nt).lib).WordArray,he=[],Me=E.algo.SHA1=(we=w.Hasher).extend({_doReset:function(){this._hash=new Re.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(Ne,W){for(var Q=this._hash.words,se=Q[0],J=Q[1],G=Q[2],U=Q[3],C=Q[4],N=0;N<80;N++){if(N<16)he[N]=0|Ne[W+N];else{var v=he[N-3]^he[N-8]^he[N-14]^he[N-16];he[N]=v<<1|v>>>31}var f=(se<<5|se>>>27)+C+he[N];f+=N<20?1518500249+(J&G|~J&U):N<40?1859775393+(J^G^U):N<60?(J&G|J&U|G&U)-1894007588:(J^G^U)-899497514,C=U,U=G,G=J<<30|J>>>2,J=se,se=f}Q[0]=Q[0]+se|0,Q[1]=Q[1]+J|0,Q[2]=Q[2]+G|0,Q[3]=Q[3]+U|0,Q[4]=Q[4]+C|0},_doFinalize:function(){var Ne=this._data,W=Ne.words,Q=8*this._nDataBytes,se=8*Ne.sigBytes;return W[se>>>5]|=128<<24-se%32,W[14+(se+64>>>9<<4)]=Math.floor(Q/4294967296),W[15+(se+64>>>9<<4)]=Q,Ne.sigBytes=4*W.length,this._process(),this._hash},clone:function(){var Ne=we.clone.call(this);return Ne._hash=this._hash.clone(),Ne}}),E.SHA1=we._createHelper(Me),E.HmacSHA1=we._createHmacHelper(Me),nt.SHA1)},5733:function(It){It.exports=Dt},5772:function(It,Ye,Te){Te.d(Ye,{BeautyEffect:function(){return xe}});var E=Te(8627),w=Te(8866),Re=Te(4872),we=Te(327),he=function(Z,$,K,X){return new(K||(K=Promise))(function(B,fe){function Ce(Ie){try{st(X.next(Ie))}catch(D){fe(D)}}function Ze(Ie){try{st(X.throw(Ie))}catch(D){fe(D)}}function st(Ie){var D;Ie.done?B(Ie.value):(D=Ie.value,D instanceof K?D:new K(function(me){me(D)})).then(Ce,Ze)}st((X=X.apply(Z,$||[])).next())})},Me=function(Z,$){var K,X,B,fe,Ce={label:0,sent:function(){if(1&B[0])throw B[1];return B[1]},trys:[],ops:[]};return fe={next:Ze(0),throw:Ze(1),return:Ze(2)},typeof Symbol=="function"&&(fe[Symbol.iterator]=function(){return this}),fe;function Ze(st){return function(Ie){return function(D){if(K)throw new TypeError("Generator is already executing.");for(;fe&&(fe=0,D[0]&&(Ce=0)),Ce;)try{if(K=1,X&&(B=2&D[0]?X.return:D[0]?X.throw||((B=X.return)&&B.call(X),0):X.next)&&!(B=B.call(X,D[1])).done)return B;switch(X=0,B&&(D=[2&D[0],B.value]),D[0]){case 0:case 1:B=D;break;case 4:return Ce.label++,{value:D[1],done:!1};case 5:Ce.label++,X=D[1],D=[0];continue;case 7:D=Ce.ops.pop(),Ce.trys.pop();continue;default:if(B=Ce.trys,!((B=B.length>0&&B[B.length-1])||D[0]!==6&&D[0]!==2)){Ce=0;continue}if(D[0]===3&&(!B||D[1]>B[0]&&D[1]<B[3])){Ce.label=D[1];break}if(D[0]===6&&Ce.label<B[1]){Ce.label=B[1],B=D;break}if(B&&Ce.label<B[2]){Ce.label=B[2],Ce.ops.push(D);break}B[2]&&Ce.ops.pop(),Ce.trys.pop();continue}D=$.call(Z,Ce)}catch(me){D=[6,me],X=0}finally{K=B=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([st,Ie])}}},nt="zc.p.0.sbe.3",Ne=function(){function Z($){this.an=$,this.recordedFrameCount=0,this.targetFrameRate=0,this.recordingDuration=0}return Z.prototype.startRecordBeautyEffectOutput=function($){return he(this,void 0,void 0,function(){var K,X,B,fe=this;return Me(this,function(Ce){switch(Ce.label){case 0:return K=6,this.recordID?(this.an.warn(nt+" detector is already recording"),[2,{result:!0}]):(X=new Date().getTime(),this.recordID=X,this.targetFrameRate=$,this.recordedFrameCount=0,this.recordingDuration=K,[4,new w.l3(function(Ze){window.setTimeout(Ze,1e3*fe.recordingDuration)})]);case 1:return Ce.sent(),this.recordID!==X?(this.recordID=void 0,[2,{result:!0}]):(this.recordID=void 0,B=this.recordedFrameCount/K,this.recordedFrameCount<this.targetFrameRate*this.recordingDuration/2?(this.an.warn(nt+" detect effect overload: current fps: "+B),[2,{result:!1,targetFPS:this.targetFrameRate,currentFPS:B}]):(this.an.info(nt+" detect effect current fps: "+B),[2,{result:!0}]))}})})},Z.prototype.stopRecordBeautyEffectOutput=function(){this.recordedFrameCount=this.targetFrameRate=0,this.recordID=void 0},Z.prototype.addFrame=function(){this.recordID&&(this.recordedFrameCount+=1)},Z}();function W(Z){for(var $=Z,K="",X=0;X<$.length;X++){var B=$.charCodeAt(X),fe=B;B>=65&&B<=90&&(fe=(B-65-13+26)%26+65),B>=97&&B<=122&&(fe=(B-97-13+26)%26+97),K+=String.fromCharCode(fe)}return K}var Q,se=function(){function Z($,K,X){this.gl=$,this.width=K,this.height=X,this.type="baseShader",this.program=null,this.program=null}return Z.prototype.setEffectConfig=function($){},Z.prototype.setConstUniforms=function(){},Z.prototype.resetResolution=function($,K){this.width=$||this.width,this.height=K||this.height},Z.prototype.render=function(){},Z.prototype.renderPreTextures=function($,K,X){},Z.prototype.makeProgram=function($,K){var X=this.gl,B=W($),fe=W(K),Ce=this.makeShader(B,X.VERTEX_SHADER),Ze=this.makeShader(fe,X.FRAGMENT_SHADER),st=X.createProgram();return X.attachShader(st,Ce),X.attachShader(st,Ze),X.linkProgram(st),X.getProgramParameter(st,X.LINK_STATUS),st},Z.prototype.release=function(){},Z.prototype.makeShader=function($,K){var X=this.gl,B=X.createShader(K);return X.shaderSource(B,$),X.compileShader(B),X.getShaderParameter(B,X.COMPILE_STATUS),B},Z}(),J=`nggevohgr irp4 nCbfvgvba;
nggevohgr irp4 nGrkPbbeqvangr;
havsbez uvtuc sybng grkOyheJvqguBssfrg;
havsbez uvtuc sybng grkOyheUrvtugBssfrg;
inelvat irp2 i_grkpbbeq0;
inelvat irp4 grkgherFuvsg_1;
inelvat irp4 grkgherFuvsg_2;
inelvat irp4 grkgherFuvsg_3;
inelvat irp4 grkgherFuvsg_4;
ibvq znva()
{
  ty_Cbfvgvba = nCbfvgvba;
  i_grkpbbeq0 = nGrkPbbeqvangr.kl;

  irp2 fvatyrFgrcBssfrg = irp2(grkOyheJvqguBssfrg, grkOyheUrvtugBssfrg)*2.5;

  grkgherFuvsg_1 = irp4(nGrkPbbeqvangr.kl - fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + fvatyrFgrcBssfrg);
  grkgherFuvsg_2 = irp4(nGrkPbbeqvangr.kl - 2.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 2.0 * fvatyrFgrcBssfrg);
  grkgherFuvsg_3 = irp4(nGrkPbbeqvangr.kl - 3.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 3.0 * fvatyrFgrcBssfrg);
  grkgherFuvsg_4 = irp4(nGrkPbbeqvangr.kl - 4.0 * fvatyrFgrcBssfrg, nGrkPbbeqvangr.kl + 4.0 * fvatyrFgrcBssfrg);
}`,G=`cerpvfvba zrqvhzc sybng;
havsbez fnzcyre2Q hGrkgher;
inelvat irp2 i_grkpbbeq0;
inelvat uvtuc irp4 grkgherFuvsg_1;
inelvat uvtuc irp4 grkgherFuvsg_2;
inelvat uvtuc irp4 grkgherFuvsg_3;
inelvat uvtuc irp4 grkgherFuvsg_4;
ibvq znva(ibvq) { 
  zrqvhzc irp3 fhz = grkgher2Q(hGrkgher, i_grkpbbeq0).eto;
  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_1.kl).eto;
  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_1.mj).eto;
  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_2.kl).eto;
  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_2.mj).eto;
  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_3.kl).eto;
  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_3.mj).eto;
  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_4.kl).eto;
  fhz += grkgher2Q(hGrkgher, grkgherFuvsg_4.mj).eto;
  ty_SentPbybe = irp4(fhz * 0.1111, 1.0); 
}`,U=(Q=function(Z,$){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(K,X){K.__proto__=X}||function(K,X){for(var B in X)Object.prototype.hasOwnProperty.call(X,B)&&(K[B]=X[B])},Q(Z,$)},function(Z,$){if(typeof $!="function"&&$!==null)throw new TypeError("Class extends value "+String($)+" is not a constructor or null");function K(){this.constructor=Z}Q(Z,$),Z.prototype=$===null?Object.create($):(K.prototype=$.prototype,new K)}),C=function(Z){function $(K,X,B){var fe=Z.call(this,K,X,B)||this;return fe.width=X,fe.height=B,fe.type="BlurShader",fe.blurXProgram=null,fe.blurYProgram=null,fe.diffProgram=null,fe.uIntensity=null,fe.smoothIntensity=.5,fe.blurTextureList=[],fe.blurBufferList=[],fe.blurXProgram=fe.makeProgram(J,G),fe.setBorderBlurProgram(fe.blurXProgram,1/(X||1),0),fe.blurYProgram=fe.makeProgram(J,G),fe.setBorderBlurProgram(fe.blurYProgram,0,1/(B||1)),fe.diffProgram=fe.makeProgram(`nggevohgr irp4 nCbfvgvba;
nggevohgr irp4 nGrkPbbeqvangr;
havsbez zng4 hCZIZngevk;
inelvat irp2 i_grkpbbeq0;
ibvq znva()
{
  // ty_Cbfvgvba = hCZIZngevk * nCbfvgvba;
  ty_Cbfvgvba = nCbfvgvba;
  i_grkpbbeq0 = nGrkPbbeqvangr.kl;
}`,`cerpvfvba zrqvhzc sybng;
havsbez fnzcyre2Q hGrkgher;
inelvat irp2 i_grkpbbeq0;
havsbez fnzcyre2Q oyheGrkgher;
ibvq znva(ibvq) {
  irp4 vPbybe = grkgher2Q(oyheGrkgher, i_grkpbbeq0);
  irp4 zrnaPbybe = grkgher2Q(hGrkgher, i_grkpbbeq0);
  irp4 qvssPbybe = vPbybe - zrnaPbybe;
  qvssPbybe.e = zva(qvssPbybe.e * 50.0 * qvssPbybe.e, 1.0);
  qvssPbybe.t = zva(qvssPbybe.t * 50.0 * qvssPbybe.t, 1.0);
  qvssPbybe.o = zva(qvssPbybe.o * 50.0 * qvssPbybe.o, 1.0);
  ty_SentPbybe = irp4(qvssPbybe.eto, 1.0);
}`),fe.setDiffBlurProgram(fe.diffProgram),fe.program=fe.makeProgram(`
nggevohgr irp4 nCbfvgvba;
nggevohgr irp4 nGrkPbbeqvangr;
inelvat irp2 i_grkpbbeq0;
havsbez sybng jvqguBssfrg;
havsbez sybng urvtugBssfrg;
inelvat irp2 grkgherFuvsg_1;
inelvat irp2 grkgherFuvsg_2;
inelvat irp2 grkgherFuvsg_3;
inelvat irp2 grkgherFuvsg_4;
ibvq znva()
{
  ty_Cbfvgvba = nCbfvgvba;
  i_grkpbbeq0 = nGrkPbbeqvangr.kl;
  grkgherFuvsg_1 = irp2(i_grkpbbeq0 + 0.5 * irp2(jvqguBssfrg,urvtugBssfrg));
  grkgherFuvsg_2 = irp2(i_grkpbbeq0 + 0.5 * irp2(-jvqguBssfrg,-urvtugBssfrg));
  grkgherFuvsg_3 = irp2(i_grkpbbeq0 + 0.5 * irp2(-jvqguBssfrg,urvtugBssfrg));
  grkgherFuvsg_4 = irp2(i_grkpbbeq0 + 0.5 * irp2(jvqguBssfrg,-urvtugBssfrg));
}
`,`
cerpvfvba zrqvhzc sybng;
havsbez fnzcyre2Q hGrkgher;
inelvat irp2 i_grkpbbeq0;
havsbez fnzcyre2Q oyheGrkgher;
havsbez fnzcyre2Q oyheQvssGrkgher;
havsbez ybjc sybng oyheNycun;
ibvq znva(ibvq) {
  ybjc irp4 vPbybe = grkgher2Q(hGrkgher, i_grkpbbeq0);
  ybjc irp4 zrnaPbybe = grkgher2Q(oyheGrkgher, i_grkpbbeq0);
  ybjc irp4 inePbybe = grkgher2Q(oyheQvssGrkgher, i_grkpbbeq0);
  ybjc sybng nycun = oyheNycun * 1.0;
  ybjc sybng gurgn = 0.1;
  zrqvhzc sybng c = pynzc((zva(vPbybe.e, zrnaPbybe.e - 0.1) - 0.2) * 4.0, 0.0, 1.0);
  zrqvhzc sybng zrnaIne = znk(znk(inePbybe.e, inePbybe.t), inePbybe.o);
  zrqvhzc sybng xZva = 0.1;
  ybjc irp3 erfhygPbybe;
  xZva = (1.0 - zrnaIne / (zrnaIne + gurgn)) * c * nycun;
  erfhygPbybe = zvk(vPbybe.eto, zrnaPbybe.eto, xZva);
  erfhygPbybe = zvk(vPbybe.eto, erfhygPbybe, zva(1.0,nycun));
  ty_SentPbybe = irp4(erfhygPbybe,1.0);
}`),fe.initBlurBuffer(),fe}return U($,Z),$.prototype.setEffectConfig=function(K){isNaN(K.smoothIntensity)||(this.smoothIntensity=K.smoothIntensity/100)},$.prototype.render=function(){this.gl.uniform1f(this.uIntensity,this.smoothIntensity)},$.prototype.initBlurBuffer=function(){var K=this,X=this.gl;this.blurTextureList.forEach(function(Ze){var st;Ze&&((st=K.gl)===null||st===void 0||st.deleteTexture(Ze))}),this.blurBufferList.forEach(function(Ze){var st;Ze&&((st=K.gl)===null||st===void 0||st.deleteFramebuffer(Ze))}),this.blurTextureList=[],this.blurBufferList=[];for(var B=0;B<3;B++){var fe=X.createTexture();if(!fe)return;X.bindTexture(X.TEXTURE_2D,fe),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,!0),X.texImage2D(X.TEXTURE_2D,0,X.RGBA,this.width,this.height,0,X.RGBA,X.UNSIGNED_BYTE,null);var Ce=X.createFramebuffer();if(!Ce)return;X.bindFramebuffer(X.FRAMEBUFFER,Ce),X.framebufferTexture2D(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_2D,fe,0),this.blurTextureList.push(fe),this.blurBufferList.push(Ce)}},$.prototype.renderPreTextures=function(K,X,B){var fe=this,Ce=this.gl,Ze=[0,1,0],st=[1,1,2];[this.blurXProgram,this.blurYProgram,this.diffProgram].forEach(function(Ie,D){if(Ie){Ce.useProgram(Ie);var me=Ce.getUniformLocation(Ie,"uTexture");Ce.uniform1i(me,Ze[D]);var ce=Ce.createBuffer();Ce.bindBuffer(Ce.ARRAY_BUFFER,ce),Ce.bufferData(Ce.ARRAY_BUFFER,new Float32Array(K),Ce.STATIC_DRAW);var le=Ce.createBuffer();Ce.bindBuffer(Ce.ELEMENT_ARRAY_BUFFER,le),Ce.bufferData(Ce.ELEMENT_ARRAY_BUFFER,new Uint16Array(X),Ce.STATIC_DRAW);var et=Ce.getAttribLocation(Ie,"aPosition");Ce.enableVertexAttribArray(et),Ce.vertexAttribPointer(et,3,Ce.FLOAT,!1,0,0);var ze=Ce.createBuffer();Ce.bindBuffer(Ce.ARRAY_BUFFER,ze),Ce.bufferData(Ce.ARRAY_BUFFER,new Float32Array(B),Ce.STATIC_DRAW);var ft=Ce.getAttribLocation(Ie,"aTexCoordinate");Ce.enableVertexAttribArray(ft),Ce.vertexAttribPointer(ft,2,Ce.FLOAT,!1,0,0),Ce.bindFramebuffer(Ce.FRAMEBUFFER,fe.blurBufferList[D]),Ce.clearColor(0,0,0,1),Ce.clear(Ce.COLOR_BUFFER_BIT),Ce.drawElements(Ce.TRIANGLES,6,Ce.UNSIGNED_SHORT,0),Ce.activeTexture(Ce.TEXTURE0+st[D]),Ce.bindTexture(Ce.TEXTURE_2D,fe.blurTextureList[D])}})},$.prototype.setConstUniforms=function(){var K=this.width,X=this.height,B=this.program;if(B){var fe=this.gl;fe.useProgram(B);var Ce=fe.getUniformLocation(B,"widthOffset");fe.uniform1f(Ce,1/K);var Ze=fe.getUniformLocation(B,"heightOffset");fe.uniform1f(Ze,1/X),this.uIntensity=fe.getUniformLocation(B,"blurAlpha"),fe.uniform1f(this.uIntensity,this.smoothIntensity);var st=fe.getUniformLocation(B,"blurTexture");fe.uniform1i(st,1);var Ie=fe.getUniformLocation(B,"blurDiffTexture");fe.uniform1i(Ie,2)}},$.prototype.resetResolution=function(K,X){this.width=K||this.width,this.height=X||this.height,this.blurXProgram&&this.setBorderBlurProgram(this.blurXProgram,1/(K||1),0),this.blurYProgram&&this.setBorderBlurProgram(this.blurYProgram,0,1/(X||1)),this.setConstUniforms(),this.initBlurBuffer()},$.prototype.setBorderBlurProgram=function(K,X,B){var fe=this.gl;fe.useProgram(K);var Ce=fe.getUniformLocation(K,"texBlurWidthOffset");fe.uniform1f(Ce,X);var Ze=fe.getUniformLocation(K,"texBlurHeightOffset");fe.uniform1f(Ze,B)},$.prototype.setDiffBlurProgram=function(K){var X=this.gl;X.useProgram(K);var B=X.getUniformLocation(K,"blurTexture");X.uniform1i(B,1)},$}(se),N=function(){var Z=function($,K){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,B){X.__proto__=B}||function(X,B){for(var fe in B)Object.prototype.hasOwnProperty.call(B,fe)&&(X[fe]=B[fe])},Z($,K)};return function($,K){if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");function X(){this.constructor=$}Z($,K),$.prototype=K===null?Object.create(K):(X.prototype=K.prototype,new X)}}(),v=function(Z){function $(K,X,B){var fe=Z.call(this,K,X,B)||this;return fe.width=X,fe.height=B,fe.type="LightShader",fe.uLightIntensity=null,fe.uRedIntensity=null,fe.whitenIntensity=.5,fe.rosyIntensity=.5,fe.program=fe.makeProgram(`cerpvfvba uvtuc sybng;
nggevohgr irp2 nGrkPbbeqvangr;
nggevohgr irp4 nCbfvgvba;
havsbez zng4 hCZIZngevk;
inelvat irp2 iGrkPbbeq;
ibvq znva() {
    ty_Cbfvgvba = hCZIZngevk * nCbfvgvba;
    iGrkPbbeq = nGrkPbbeqvangr;
}`,`cerpvfvba uvtuc sybng;
inelvat irp2 iGrkPbbeq;
havsbez fnzcyre2Q hGrkgher;
havsbez sybng vagrafvgl;
havsbez sybng ebflVagrafvgl;
irp3 oevtugarffNaqPbagenfg(irp3 pbybe){
  sybng v = vagrafvgl * 1.0;
  sybng CV = 3.1415926;
  sybng O = 0.12 * v;
  sybng p = 0.1 * v;
  sybng x = gna((45. + 44. * p) / 180.0 * CV);
  pbybe = ((pbybe*255.0 - 127.5 * (1.0 - O)) * x + 127.5 * (1.0 + O)) / 255.0;
  erghea pbybe;
}
ibvq znva() {
  irp4 grkgherPbybe = grkgher2Q(hGrkgher, iGrkPbbeq);
  grkgherPbybe = irp4(oevtugarffNaqPbagenfg(grkgherPbybe.eto), grkgherPbybe.j);
  grkgherPbybe.e = zva(grkgherPbybe.e + 0.06 * ebflVagrafvgl, 1.0);
  ty_SentPbybe = grkgherPbybe;
}`),fe}return N($,Z),$.prototype.setEffectConfig=function(K){isNaN(K.whitenIntensity)||(this.whitenIntensity=K.whitenIntensity/100),isNaN(K.rosyIntensity)||(this.rosyIntensity=K.rosyIntensity/100)},$.prototype.render=function(){var K=this.gl;K.uniform1f(this.uLightIntensity,this.whitenIntensity),K.uniform1f(this.uRedIntensity,this.rosyIntensity)},$.prototype.setConstUniforms=function(){var K=this.program;if(K){var X=this.gl;X.useProgram(K),this.uLightIntensity=X.getUniformLocation(K,"intensity"),X.uniform1f(this.uLightIntensity,this.whitenIntensity),this.uRedIntensity=X.getUniformLocation(K,"rosyIntensity"),X.uniform1f(this.uRedIntensity,this.rosyIntensity);var B=X.getUniformLocation(K,"uPMVMatrix");X.uniformMatrix4fv(B,!1,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},$}(se),f=function(){var Z=function($,K){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,B){X.__proto__=B}||function(X,B){for(var fe in B)Object.prototype.hasOwnProperty.call(B,fe)&&(X[fe]=B[fe])},Z($,K)};return function($,K){if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");function X(){this.constructor=$}Z($,K),$.prototype=K===null?Object.create(K):(X.prototype=K.prototype,new X)}}(),_=function(Z,$,K,X){return new(K||(K=Promise))(function(B,fe){function Ce(Ie){try{st(X.next(Ie))}catch(D){fe(D)}}function Ze(Ie){try{st(X.throw(Ie))}catch(D){fe(D)}}function st(Ie){var D;Ie.done?B(Ie.value):(D=Ie.value,D instanceof K?D:new K(function(me){me(D)})).then(Ce,Ze)}st((X=X.apply(Z,$||[])).next())})},b=function(Z,$){var K,X,B,fe,Ce={label:0,sent:function(){if(1&B[0])throw B[1];return B[1]},trys:[],ops:[]};return fe={next:Ze(0),throw:Ze(1),return:Ze(2)},typeof Symbol=="function"&&(fe[Symbol.iterator]=function(){return this}),fe;function Ze(st){return function(Ie){return function(D){if(K)throw new TypeError("Generator is already executing.");for(;fe&&(fe=0,D[0]&&(Ce=0)),Ce;)try{if(K=1,X&&(B=2&D[0]?X.return:D[0]?X.throw||((B=X.return)&&B.call(X),0):X.next)&&!(B=B.call(X,D[1])).done)return B;switch(X=0,B&&(D=[2&D[0],B.value]),D[0]){case 0:case 1:B=D;break;case 4:return Ce.label++,{value:D[1],done:!1};case 5:Ce.label++,X=D[1],D=[0];continue;case 7:D=Ce.ops.pop(),Ce.trys.pop();continue;default:if(B=Ce.trys,!((B=B.length>0&&B[B.length-1])||D[0]!==6&&D[0]!==2)){Ce=0;continue}if(D[0]===3&&(!B||D[1]>B[0]&&D[1]<B[3])){Ce.label=D[1];break}if(D[0]===6&&Ce.label<B[1]){Ce.label=B[1],B=D;break}if(B&&Ce.label<B[2]){Ce.label=B[2],Ce.ops.push(D);break}B[2]&&Ce.ops.pop(),Ce.trys.pop();continue}D=$.call(Z,Ce)}catch(me){D=[6,me],X=0}finally{K=B=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([st,Ie])}}},y=function(Z){function $(K,X,B){var fe=Z.call(this,K,X,B)||this;return fe.width=X,fe.height=B,fe.type="LowLightShader",fe.uIntensity=null,fe.lowlightEnhancement=!1,fe.lutTex=null,fe.lutImg=null,fe.lutTexIdx=10,fe.uLutTex=null,fe.program=fe.makeProgram(`
nggevohgr irp4 nCbfvgvba;
nggevohgr irp4 nGrkPbbeqvangr;
havsbez sybng grkryJvqgu;
havsbez sybng grkryUrvtug;
inelvat irp2 grkgherPbbeqvangr[9];
inelvat irp2 grkgherPbbeqvangr2;
havsbez zng4 hCZIZngevk;
ibvq znva(){
    ty_Cbfvgvba = hCZIZngevk * nCbfvgvba;
    grkgherPbbeqvangr2 = nGrkPbbeqvangr.kl;
    grkgherPbbeqvangr[0] = nGrkPbbeqvangr.kl;
    irp2 jvqguFgrc = irp2(grkryJvqgu, 0.0);
    irp2 urvtugFgrc = irp2(0.0, grkryUrvtug);
    irp2 jvqguUrvtugFgrc = irp2(grkryJvqgu, grkryUrvtug);
    irp2 jvqguArtngvirUrvtugFgrc = irp2(grkryJvqgu, -grkryUrvtug);
    
    grkgherPbbeqvangr[0] = nGrkPbbeqvangr.kl;
    grkgherPbbeqvangr[1] = nGrkPbbeqvangr.kl - jvqguFgrc;
    grkgherPbbeqvangr[2] = nGrkPbbeqvangr.kl + jvqguFgrc;
    
    grkgherPbbeqvangr[3] = nGrkPbbeqvangr.kl - urvtugFgrc;
    grkgherPbbeqvangr[4] = nGrkPbbeqvangr.kl - jvqguUrvtugFgrc;
    grkgherPbbeqvangr[5] = nGrkPbbeqvangr.kl + jvqguArtngvirUrvtugFgrc;
    
    grkgherPbbeqvangr[6] = nGrkPbbeqvangr.kl + urvtugFgrc;
    grkgherPbbeqvangr[7] = nGrkPbbeqvangr.kl - jvqguArtngvirUrvtugFgrc;
    grkgherPbbeqvangr[8] = nGrkPbbeqvangr.kl + jvqguUrvtugFgrc;
}
`,`cerpvfvba uvtuc sybng;
inelvat uvtuc irp2 grkgherPbbeqvangr[9];
inelvat uvtuc irp2 grkgherPbbeqvangr2;
havsbez fnzcyre2Q hGrkgher;
havsbez fnzcyre2Q vachgVzntrGrkgher2;
havsbez uvtuc zng3 zngLHIgbETO;
havsbez uvtuc zng3 zngETOgbLHI;
havsbez sybng hVagrafvgl;
pbafg irp3 pbzcIrp = irp3(-0.0/255.0, -128.0/255.0, -128.0/255.0);
irp4 eto2lhi(irp4 vachgETO) {
    irp3 bhgchgLHI;
    bhgchgLHI = zngETOgbLHI * vachgETO.eto;
    bhgchgLHI -= pbzcIrp;
    erghea irp4(pynzc(bhgchgLHI,
                        irp3(0.0, 0.0, 0.0),
                        irp3(1.0, 1.0, 1.0)),
                        vachgETO.n);
}
irp2 fnghengvba(irp2 bet, sybng snpgbe) {
    irp2 zbq = irp2((bet.k - 128.0/255.0) * snpgbe + 128.0/255.0,
                    (bet.l - 128.0/255.0) * snpgbe + 128.0/255.0);
    erghea pynzc(zbq, irp2(0.0, 0.0), irp2(1.0, 1.0));
}
irp4 lhi2eto(irp4 vachgLHI) {
    irp3 bhgchgETO;
    vachgLHI.eto += pbzcIrp;
    bhgchgETO = zngLHIgbETO * vachgLHI.eto;
    erghea irp4(pynzc(bhgchgETO,
                        irp3(0.0, 0.0, 0.0),
                        irp3(1.0, 1.0, 1.0)),
                        vachgLHI.n);
}
ibvq znva(){
    irp4 lhi[9];
    sbe(vag v = 0; v < 9; v++){
        lhi[v] = eto2lhi(grkgher2Q(hGrkgher, grkgherPbbeqvangr[v]));
    }
    sybng fzbbguL = 0.0;
    fzbbguL += 1.0*lhi[4].e + 2.0*lhi[3].e + 1.0*lhi[5].e;
    fzbbguL += 2.0*lhi[1].e + 4.0*lhi[0].e + 2.0*lhi[2].e;
    fzbbguL += 1.0*lhi[7].e + 2.0*lhi[6].e + 1.0*lhi[8].e;
    fzbbguL = fzbbguL / 16.0;
    sybng bhgchgL = grkgher2Q(vachgVzntrGrkgher2, irp2(fzbbguL, lhi[0].e)).e;
    irp3 arjLHI = irp3(zvk(fzbbguL, bhgchgL, hVagrafvgl), lhi[0].to);
    ty_SentPbybe = lhi2eto(irp4(arjLHI.eto, lhi[0].n));
}
`),fe}return f($,Z),$.prototype.setEffectConfig=function(K){this.lowlightEnhancement=K.lowlightEnhancement===1},$.prototype.release=function(){this.gl.deleteTexture(this.lutTex)},$.prototype.render=function(){var K=this.gl;K.uniform1f(this.uIntensity,this.lowlightEnhancement?.6:0);var X=this,B=X.program,fe=X.width,Ce=X.height,Ze=X.lutTex;if(B){var st=K.getUniformLocation(B,"texelWidth");K.uniform1f(st,1/fe);var Ie=K.getUniformLocation(B,"texelHeight");K.uniform1f(Ie,1/Ce),K.activeTexture(K.TEXTURE0+this.lutTexIdx),K.bindTexture(K.TEXTURE_2D,Ze)}},$.prototype.setConstUniforms=function(){return _(this,void 0,void 0,function(){var K,X,B,fe,Ce,Ze,st,Ie,D,me,ce=this;return b(this,function(le){switch(le.label){case 0:return K=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X=[1,1,1,0,-.344,1.772,1.402,-.714,0],B=[.298973,-.168721,.500019,.58706,-.331298,-.41873,.113967,.500019,-.081289],(fe=this.program)?((Ce=this.gl).useProgram(fe),this.uIntensity=Ce.getUniformLocation(fe,"uIntensity"),Ze=Ce.getUniformLocation(fe,"matYUVtoRGB"),Ce.uniformMatrix3fv(Ze,!1,X),st=Ce.getUniformLocation(fe,"matRGBtoYUV"),Ce.uniformMatrix3fv(st,!1,B),Ie=Ce.getUniformLocation(fe,"uPMVMatrix"),Ce.uniformMatrix4fv(Ie,!1,K),D=Ce.getUniformLocation(fe,"inputImageTexture2"),me=this,[4,new w.l3(function(et){var ze=Ce.createTexture(),ft=ce.lutTexIdx,_t=ce.lutImg;_t||(_t=new Image),_t.onload=function(){Ce.useProgram(fe),ce.lutImg=_t,Ce.activeTexture(Ce.TEXTURE0+ft),Ce.bindTexture(Ce.TEXTURE_2D,ze),Ce.pixelStorei(Ce.UNPACK_FLIP_Y_WEBGL,!1),Ce.texImage2D(Ce.TEXTURE_2D,0,Ce.LUMINANCE,Ce.LUMINANCE,Ce.UNSIGNED_BYTE,_t),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_WRAP_S,Ce.CLAMP_TO_EDGE),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_WRAP_T,Ce.CLAMP_TO_EDGE),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_MIN_FILTER,Ce.NEAREST),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_MAG_FILTER,Ce.NEAREST),Ce.uniform1i(D,ft),ze&&et(ze)},_t.src=`
data:image/png;base64,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`})]):[2];case 1:return me.lutTex=le.sent(),[2]}})})},$}(se),M=function(){var Z=function($,K){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,B){X.__proto__=B}||function(X,B){for(var fe in B)Object.prototype.hasOwnProperty.call(B,fe)&&(X[fe]=B[fe])},Z($,K)};return function($,K){if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");function X(){this.constructor=$}Z($,K),$.prototype=K===null?Object.create(K):(X.prototype=K.prototype,new X)}}(),Y=function(Z){function $(K,X,B){var fe=Z.call(this,K,X,B)||this;return fe.width=X,fe.height=B,fe.type="SharpnessShader",fe.uIntensity=null,fe.sharpenIntensity=.5,fe.program=fe.makeProgram(`
nggevohgr irp4 nCbfvgvba;
nggevohgr irp4 nGrkPbbeqvangr;
havsbez sybng vzntrJvqguSnpgbe;
havsbez sybng vzntrUrvtugSnpgbe;
havsbez sybng funecarff; 
inelvat irp2 iGrkPbbeq;
inelvat irp2 yrsgGrkgherPbbeqvangr;
inelvat irp2 evtugGrkgherPbbeqvangr;
inelvat irp2 gbcGrkgherPbbeqvangr;
inelvat irp2 obggbzGrkgherPbbeqvangr;
inelvat sybng pragreZhygvcyvre;
inelvat sybng rqtrZhygvcyvre;
ibvq znva() {
  ty_Cbfvgvba = nCbfvgvba;
  irp2 jvqguFgrc = irp2(vzntrJvqguSnpgbe, 0.0);
  irp2 urvtugFgrc = irp2(0.0, vzntrUrvtugSnpgbe);
  iGrkPbbeq = nGrkPbbeqvangr.kl;
  yrsgGrkgherPbbeqvangr = nGrkPbbeqvangr.kl - jvqguFgrc;
  evtugGrkgherPbbeqvangr = nGrkPbbeqvangr.kl + jvqguFgrc;
  gbcGrkgherPbbeqvangr = nGrkPbbeqvangr.kl + urvtugFgrc;
  obggbzGrkgherPbbeqvangr = nGrkPbbeqvangr.kl - urvtugFgrc;
  pragreZhygvcyvre = 1.0 + 4.0 * funecarff;
  rqtrZhygvcyvre = funecarff;
}
`,`
cerpvfvba uvtuc sybng;
inelvat uvtuc irp2 iGrkPbbeq;
inelvat uvtuc irp2 yrsgGrkgherPbbeqvangr;
inelvat uvtuc irp2 evtugGrkgherPbbeqvangr;
inelvat uvtuc irp2 gbcGrkgherPbbeqvangr;
inelvat uvtuc irp2 obggbzGrkgherPbbeqvangr;
inelvat uvtuc sybng pragreZhygvcyvre;
inelvat uvtuc sybng rqtrZhygvcyvre;
havsbez fnzcyre2Q hGrkgher;
ibvq znva() {
  zrqvhzc irp4 nPbybe = grkgher2Q(hGrkgher, iGrkPbbeq);
  zrqvhzc irp3 grkgherPbybe = nPbybe.eto;
  zrqvhzc irp3 yrsgGrkgherPbybe = grkgher2Q(hGrkgher, yrsgGrkgherPbbeqvangr).eto;
  zrqvhzc irp3 evtugGrkgherPbybe = grkgher2Q(hGrkgher, evtugGrkgherPbbeqvangr).eto;
  zrqvhzc irp3 gbcGrkgherPbybe = grkgher2Q(hGrkgher, gbcGrkgherPbbeqvangr).eto;
  zrqvhzc irp3 obggbzGrkgherPbybe = grkgher2Q(hGrkgher, obggbzGrkgherPbbeqvangr).eto;
  ty_SentPbybe = irp4((grkgherPbybe * pragreZhygvcyvre - (yrsgGrkgherPbybe * rqtrZhygvcyvre + evtugGrkgherPbybe * rqtrZhygvcyvre + gbcGrkgherPbybe * rqtrZhygvcyvre + obggbzGrkgherPbybe * rqtrZhygvcyvre)), nPbybe.n);
}`),fe}return M($,Z),$.prototype.setEffectConfig=function(K){isNaN(K.sharpenIntensity)||(this.sharpenIntensity=K.sharpenIntensity/100)},$.prototype.render=function(){this.gl.uniform1f(this.uIntensity,.5*this.sharpenIntensity)},$.prototype.resetResolution=function(K,X){this.width=K||this.width,this.height=X||this.height,this.setConstUniforms()},$.prototype.setConstUniforms=function(){var K=this.width,X=this.height,B=this.program;if(B){var fe=this.gl;fe.useProgram(B);var Ce=fe.getUniformLocation(B,"imageWidthFactor");fe.uniform1f(Ce,1/K);var Ze=fe.getUniformLocation(B,"imageHeightFactor");fe.uniform1f(Ze,1/X),this.uIntensity=fe.getUniformLocation(B,"sharpness"),fe.uniform1f(this.uIntensity,.5*this.sharpenIntensity)}},$}(se),L=function(Z,$,K,X){return new(K||(K=Promise))(function(B,fe){function Ce(Ie){try{st(X.next(Ie))}catch(D){fe(D)}}function Ze(Ie){try{st(X.throw(Ie))}catch(D){fe(D)}}function st(Ie){var D;Ie.done?B(Ie.value):(D=Ie.value,D instanceof K?D:new K(function(me){me(D)})).then(Ce,Ze)}st((X=X.apply(Z,$||[])).next())})},A=function(Z,$){var K,X,B,fe,Ce={label:0,sent:function(){if(1&B[0])throw B[1];return B[1]},trys:[],ops:[]};return fe={next:Ze(0),throw:Ze(1),return:Ze(2)},typeof Symbol=="function"&&(fe[Symbol.iterator]=function(){return this}),fe;function Ze(st){return function(Ie){return function(D){if(K)throw new TypeError("Generator is already executing.");for(;fe&&(fe=0,D[0]&&(Ce=0)),Ce;)try{if(K=1,X&&(B=2&D[0]?X.return:D[0]?X.throw||((B=X.return)&&B.call(X),0):X.next)&&!(B=B.call(X,D[1])).done)return B;switch(X=0,B&&(D=[2&D[0],B.value]),D[0]){case 0:case 1:B=D;break;case 4:return Ce.label++,{value:D[1],done:!1};case 5:Ce.label++,X=D[1],D=[0];continue;case 7:D=Ce.ops.pop(),Ce.trys.pop();continue;default:if(B=Ce.trys,!((B=B.length>0&&B[B.length-1])||D[0]!==6&&D[0]!==2)){Ce=0;continue}if(D[0]===3&&(!B||D[1]>B[0]&&D[1]<B[3])){Ce.label=D[1];break}if(D[0]===6&&Ce.label<B[1]){Ce.label=B[1],B=D;break}if(B&&Ce.label<B[2]){Ce.label=B[2],Ce.ops.push(D);break}B[2]&&Ce.ops.pop(),Ce.trys.pop();continue}D=$.call(Z,Ce)}catch(me){D=[6,me],X=0}finally{K=B=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([st,Ie])}}},H="zc.p.0.sbe.2",ge={errorCode:E.QYE.code,extendedData:E.QYE.message},Ee=function(){function Z($,K){this.an=$,this.vcMgr=K,this.gl=null,this.shouldClear=!0,this.effectConfig={sharpenIntensity:.5,whitenIntensity:.5,rosyIntensity:.5,smoothIntensity:.5,lowlightEnhancement:0},this._originResolution={width:0,height:0},this._shaderList=[],this._frameBufferList=[],this.Ze=[],this.Xe=null,this.isNoInput=!0,this.failedTimes=0,this.onRenderError=function(X){},this.enableBeauty=!1}return Z.prototype.setEnableBeauty=function($){this.enableBeauty=!!$},Z.prototype.handleInitError=function(){this.failedTimes++,this.failedTimes>30&&(this.failedTimes=0,this.an.error(H+" get webgl context failed"),this.onRenderError(ge))},Z.prototype.init=function($,K){return L(this,void 0,void 0,function(){var X,B,fe,Ce,Ze,st,Ie,D,me;return A(this,function(ce){switch(ce.label){case 0:return this.vcMgr?(fe=(X=this.vcMgr).gl,Ce=X.originWidth,Ze=X.originHeight,(B=X.canvasEl)&&fe&&Ce&&Ze?(this._canvasEl=B,this.gl=fe,this.initGL($=$||Ce,K=K||Ze),this.Xe?[4,(st=new y(this.gl,$,K)).setConstUniforms()]:(this.an.error(H+" input texture not found"),this.handleInitError(),[2])):(this.handleInitError(),[2])):(this.handleInitError(),[2]);case 1:return ce.sent(),(Ie=new C(this.gl,$,K)).setConstUniforms(),(D=new v(this.gl,$,K)).setConstUniforms(),(me=new Y(this.gl,$,K)).setConstUniforms(),this._shaderList=[st,Ie,D,me],this.setEffectConfig(this.effectConfig),[2]}})})},Z.prototype.render=function($){return L(this,void 0,void 0,function(){var K,X,B,fe,Ce=this;return A(this,function(Ze){switch(Ze.label){case 0:return(K=this.gl)&&this._canvasEl&&!K.isContextLost()?[3,4]:this._canvasEl?(this.an.warn(H+" gl lost, restart effect"),this.release(),[4,this.init($.videoWidth,$.videoHeight)]):[3,2];case 1:return Ze.sent(),[3,3];case 2:this.an.error(H+" canvas lost"),this.onRenderError(ge),Ze.label=3;case 3:return[2];case 4:return(this._originResolution.height!==$.videoHeight||this._originResolution.width!==$.videoWidth)&&(Math.abs(this._originResolution.height-$.videoHeight)>2||Math.abs(this._originResolution.width-$.videoWidth)>2)?$.videoHeight===0||$.videoWidth===0?[2]:(this._canvasEl.width=$.videoWidth,this._canvasEl.height=$.videoHeight,$.setAttribute("width",$.videoWidth.toString()),$.setAttribute("height",$.videoHeight.toString()),!this.gl||this.gl.isContextLost()?[3,5]:(this.an.info(H+" resolution changed to ".concat($.videoWidth,"x").concat($.videoHeight,", reset resolution.")),this.resetResolution($.videoWidth,$.videoHeight),this._shaderList.forEach(function(st){st.resetResolution($.videoWidth,$.videoHeight)}),[3,7])):[3,7];case 5:return this.an.warn(H+" resolution changed and gl context lost, restart effect"),this.release(),[4,this.init($.videoWidth,$.videoHeight)];case 6:Ze.sent(),Ze.label=7;case 7:return X=[-1,-1,0,1,-1,0,1,1,0,-1,1,0],B=[0,1,2,0,2,3],fe=[0,0,1,0,1,1,0,1],K.viewport(0,0,$.width,$.height),K.activeTexture(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,this.Xe),this.isNoInput&&K.texImage2D(K.TEXTURE_2D,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,$),this._shaderList.forEach(function(st,Ie){var D=st.program;if(D){st.renderPreTextures&&st.renderPreTextures(X,B,fe),K.useProgram(D),st.render();var me=K.getUniformLocation(D,"uTexture"),ce=K.createBuffer();K.bindBuffer(K.ARRAY_BUFFER,ce),K.bufferData(K.ARRAY_BUFFER,new Float32Array(X),K.STATIC_DRAW);var le=K.createBuffer();K.bindBuffer(K.ELEMENT_ARRAY_BUFFER,le),K.bufferData(K.ELEMENT_ARRAY_BUFFER,new Uint16Array(B),K.STATIC_DRAW);var et=K.getAttribLocation(D,"aPosition");K.enableVertexAttribArray(et),K.vertexAttribPointer(et,3,K.FLOAT,!1,0,0);var ze=K.createBuffer();K.bindBuffer(K.ARRAY_BUFFER,ze),K.bufferData(K.ARRAY_BUFFER,new Float32Array(fe),K.STATIC_DRAW);var ft=K.getAttribLocation(D,"aTexCoordinate");K.enableVertexAttribArray(ft),K.vertexAttribPointer(ft,2,K.FLOAT,!1,0,0);var _t=Ie===Ce._shaderList.length-1?null:Ce.Ze[Ie];K.bindFramebuffer(K.FRAMEBUFFER,Ie===Ce._shaderList.length-1?null:Ce._frameBufferList[Ie]),Ce.shouldClear&&(K.clearColor(0,0,0,1),K.clear(K.COLOR_BUFFER_BIT)),K.drawElements(K.TRIANGLES,6,K.UNSIGNED_SHORT,0),K.activeTexture(K.TEXTURE0),_t&&K.bindTexture(K.TEXTURE_2D,_t),K.uniform1i(me,0)}}),[2]}})})},Z.prototype.setEffectConfig=function($){var K=this;isNaN($.sharpenIntensity)||(this.effectConfig.sharpenIntensity=$.sharpenIntensity),isNaN($.whitenIntensity)||(this.effectConfig.whitenIntensity=$.whitenIntensity),isNaN($.rosyIntensity)||(this.effectConfig.rosyIntensity=$.rosyIntensity),isNaN($.smoothIntensity)||(this.effectConfig.smoothIntensity=$.smoothIntensity),isNaN($.lowlightEnhancement)||(this.effectConfig.lowlightEnhancement=$.lowlightEnhancement),this._shaderList.forEach(function(X){X.setEffectConfig(K.effectConfig)})},Z.prototype.release=function(){var $=this;this._shaderList.forEach(function(K){var X;K.program&&((X=$.gl)===null||X===void 0||X.deleteProgram(K.program))}),this.Ze.forEach(function(K){var X;K&&((X=$.gl)===null||X===void 0||X.deleteTexture(K))}),this._frameBufferList.forEach(function(K){var X;K&&((X=$.gl)===null||X===void 0||X.deleteFramebuffer(K))}),this._shaderList.forEach(function(K){K.release()}),this._shaderList=[],this.Ze=[],this._frameBufferList=[]},Z.prototype.initGL=function($,K){var X=this.gl;if(!X)return this.an.error(H+" webgl context not found");this.isNoInput&&(this.Xe=X.createTexture(),X.bindTexture(X.TEXTURE_2D,this.Xe),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,X.LINEAR));for(var B=0;4>B;B++){var fe=X.createTexture();if(!fe)return this.an.warn(H+" create texture failed");X.bindTexture(X.TEXTURE_2D,fe),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texImage2D(X.TEXTURE_2D,0,X.RGBA,$,K,0,X.RGBA,X.UNSIGNED_BYTE,null);var Ce=X.createFramebuffer();if(!Ce)return this.an.warn(H+" create frame buffer failed");X.bindFramebuffer(X.FRAMEBUFFER,Ce),X.framebufferTexture2D(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_2D,fe,0),this.Ze.push(fe),this._frameBufferList.push(Ce)}X.viewport(0,0,$,K),this._originResolution.width=$,this._originResolution.height=K},Z.prototype.setInputInfo=function($,K){if(this.isNoInput=$,K){var X=K.texture;X&&(this.Xe=X)}},Z.prototype.resetResolution=function($,K){var X,B=this.gl;if(!B)return this.an.warn(H+" can not find webgl context");for(var fe=0;fe<this.Ze.length;fe++)B.bindTexture(B.TEXTURE_2D,this.Ze[fe]),B.texImage2D(B.TEXTURE_2D,0,B.RGBA,$,K,0,B.RGBA,B.UNSIGNED_BYTE,null);(X=this.vcMgr)===null||X===void 0||X.resetResolution($,K),this.onResolutionChange(),B.viewport(0,0,$,K),this._originResolution.width=$,this._originResolution.height=K},Z.prototype.onResolutionChange=function(){},Z}(),Se=Te(1350),ue=function(){var Z=function($,K){return Z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(X,B){X.__proto__=B}||function(X,B){for(var fe in B)Object.prototype.hasOwnProperty.call(B,fe)&&(X[fe]=B[fe])},Z($,K)};return function($,K){if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");function X(){this.constructor=$}Z($,K),$.prototype=K===null?Object.create(K):(X.prototype=K.prototype,new X)}}(),oe=function(Z,$,K,X){return new(K||(K=Promise))(function(B,fe){function Ce(Ie){try{st(X.next(Ie))}catch(D){fe(D)}}function Ze(Ie){try{st(X.throw(Ie))}catch(D){fe(D)}}function st(Ie){var D;Ie.done?B(Ie.value):(D=Ie.value,D instanceof K?D:new K(function(me){me(D)})).then(Ce,Ze)}st((X=X.apply(Z,$||[])).next())})},be=function(Z,$){var K,X,B,fe,Ce={label:0,sent:function(){if(1&B[0])throw B[1];return B[1]},trys:[],ops:[]};return fe={next:Ze(0),throw:Ze(1),return:Ze(2)},typeof Symbol=="function"&&(fe[Symbol.iterator]=function(){return this}),fe;function Ze(st){return function(Ie){return function(D){if(K)throw new TypeError("Generator is already executing.");for(;fe&&(fe=0,D[0]&&(Ce=0)),Ce;)try{if(K=1,X&&(B=2&D[0]?X.return:D[0]?X.throw||((B=X.return)&&B.call(X),0):X.next)&&!(B=B.call(X,D[1])).done)return B;switch(X=0,B&&(D=[2&D[0],B.value]),D[0]){case 0:case 1:B=D;break;case 4:return Ce.label++,{value:D[1],done:!1};case 5:Ce.label++,X=D[1],D=[0];continue;case 7:D=Ce.ops.pop(),Ce.trys.pop();continue;default:if(B=Ce.trys,!((B=B.length>0&&B[B.length-1])||D[0]!==6&&D[0]!==2)){Ce=0;continue}if(D[0]===3&&(!B||D[1]>B[0]&&D[1]<B[3])){Ce.label=D[1];break}if(D[0]===6&&Ce.label<B[1]){Ce.label=B[1],B=D;break}if(B&&Ce.label<B[2]){Ce.label=B[2],Ce.ops.push(D);break}B[2]&&Ce.ops.pop(),Ce.trys.pop();continue}D=$.call(Z,Ce)}catch(me){D=[6,me],X=0}finally{K=B=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([st,Ie])}}},Le={errorCode:E.zgL.code,extendedData:E.zgL.message},pe="zc.p.0.sbe.1",k=function(Z){function $(K,X,B,fe){var Ce=Z.call(this)||this;return Ce.an=K,Ce.preview=B,Ce.pn=fe,Ce.kind="video",Ce._enabled=!1,Ce.effectTrack=null,Ce.lastRenderTime=0,Ce.renderCount=0,Ce.tr=0,Ce.stateFlag={base:!1,lowLight:!1},Ce.isStarting=!1,Ce.animationFrameId=0,Ce.fps=15,Ce.detector=new Ne(K),Ce.lastRenderTime=0,Ce.manager=new Ee(K,Ce.vcMgr),Ce.manager.onRenderError=function(Ze){Ze.errorCode===1103072&&Ce.stopEffect(),Ce.onError(Ze)},Ce.manager.onResolutionChange=function(){},Ce.setVcMgrInfo(),Ce}return ue($,Z),Object.defineProperty($.prototype,"enabled",{get:function(){return this._enabled},set:function(K){this._enabled=K},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"output",{get:function(){return{track:this._output||this.input||null}},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"vcMgr",{get:function(){return this.preview.vcMgr},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"ir",{get:function(){return this.pn.browser},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"options",{get:function(){return this.manager.effectConfig||{}},enumerable:!1,configurable:!0}),$.prototype.setBeautyEffectOptions=function(K,X){return X===void 0&&(X={}),oe(this,void 0,void 0,function(){return be(this,function(B){switch(B.label){case 0:return K&&this.manager.setEffectConfig(X),this.enabled===K?[3,5]:(this.manager.setEnableBeauty(K),this.enabled!==K&&this.an.info(pe+" effect enabled "+K+"; options: "+JSON.stringify(X)),this.enabled=K,K?[4,this.startEffect()]:[3,2]);case 1:return B.sent(),[3,4];case 2:return[4,this.stopEffect()];case 3:B.sent(),B.label=4;case 4:B.label=5;case 5:return[2]}})})},$.prototype.startEffect=function(K){return K===void 0&&(K=!0),oe(this,void 0,void 0,function(){var X,B=this;return be(this,function(fe){switch(fe.label){case 0:return this.isStarting=!0,this.an.info(pe+" call start effect"),this.input?(X=this,[4,this.startWebGLProcessor().catch(function(Ce){throw B.stopEffect(),Ce})]):(this.an.error(pe+" start effect failed, input track is null"),[2]);case 1:return X.effectTrack=fe.sent(),this.startEffectTask(K),[4,new w.l3(function(Ce){B.waitForOutputTrack=function(){B.waitForOutputTrack=void 0,Ce(void 0)}})];case 2:return fe.sent(),this.an.info(pe+" start effect success"),[2]}})})},$.prototype.startEffectTask=function(K){var X,B=this;K===void 0&&(K=!0),this.enabled=!0,this.detector.startRecordBeautyEffectOutput(this.fps).then(function(fe){!fe.result&&B.onError&&B.onError(Le,{targetFPS:fe.targetFPS,currentFPS:fe.currentFPS})}),K&&((X=this.vcMgr)===null||X===void 0||X.setRenderTask(!0,"beauty")),this.isStarting=!1},$.prototype.stopEffect=function(K){var X,B;return K===void 0&&(K=!0),oe(this,void 0,void 0,function(){var fe=this;return be(this,function(Ce){return this.enabled=!1,this.an.info(pe+" call stop effect"),K&&((X=this.vcMgr)===null||X===void 0||X.setRenderTask(!1,"beauty")),(B=this.vcMgr)===null||B===void 0||B.off("renderFrame"),this.detector.stopRecordBeautyEffectOutput(),this.manager.release(),this.renderCount=0,this.removeDomTimer===void 0&&(this.removeDomTimer=window.setTimeout(function(){fe.enabled===!1&&fe.destroy()},18e4)),[2]})})},$.prototype.destroy=function(){this.an.info(pe+" destroy hidden elements"),this.canvasEl&&this.canvasEl.remove(),this.videoEl&&this.videoEl.remove(),this.videoEl=this.canvasEl=void 0,this.removeDomTimer&&(clearTimeout(this.removeDomTimer),this.removeDomTimer=void 0)},$.prototype.startWebGLProcessor=function(){var K;return oe(this,void 0,void 0,function(){return be(this,function(X){switch(X.label){case 0:return this.an.info(pe+" start webgl processor"),this.removeDomTimer&&(clearTimeout(this.removeDomTimer),this.removeDomTimer=void 0),[4,this.videoRendering()];case 1:return X.sent(),this.setVcMgrInfo(),[2,(K=this.vcMgr)===null||K===void 0?void 0:K.getCanvasTrack()]}})})},$.prototype.setInput=function(K,X){var B,fe,Ce,Ze,st,Ie;return oe(this,void 0,void 0,function(){var D,me,ce=this;return be(this,function(le){return this.an.info(pe+" input call"),D=!1,K!=null&&K.track&&(me=!1,this.trackWidth===((B=this.vcMgr)===null||B===void 0?void 0:B.originWidth)&&this.trackHeight===((fe=this.vcMgr)===null||fe===void 0?void 0:fe.originHeight)||(me=!0,this.an.info(pe+" input track wh change")),!me&&this.input===(K==null?void 0:K.track)||this.ir!=="safari"||(this.an.info(pe+" input track change"),this.effectTrack=null,this.stopEffect(!1),D=!0),this.input=K==null?void 0:K.track,this.trackWidth=(Ce=this.vcMgr)===null||Ce===void 0?void 0:Ce.originWidth,this.trackHeight=(Ze=this.vcMgr)===null||Ze===void 0?void 0:Ze.originHeight),K&&(this.manager.setInputInfo(this.isFirstNode,K.frameInfo),(st=this.vcMgr)===null||st===void 0||st.off("renderFrame"),(Ie=this.vcMgr)===null||Ie===void 0||Ie.on("renderFrame",function(){ce.renderOutput()}),D&&this.startEffect()),this.tr==1&&(this.setVcMgrInfo(),this.tr=0,this.startEffect()),[2]})})},$.prototype.renderOutput=function(){this.renderCount++,this.manager.render(this.videoEl),this.detector.addFrame(),this.renderCount>=3&&this.updateOutput(this.effectTrack)},$.prototype.setVcMgrInfo=function(){var K;if(this.vcMgr&&(!((K=this.vcMgr)===null||K===void 0)&&K.inited)){var X=this.vcMgr,B=X.canvasEl,fe=X.videoEl,Ce=X.originWidth,Ze=X.originHeight;fe&&(this.videoEl=fe),B&&(this.canvasEl=B,this.manager.setInputInfo(this.isFirstNode),this.manager.init(Ce,Ze))}},$.prototype.videoRendering=function(){return oe(this,void 0,void 0,function(){var K=this;return be(this,function(X){return[2,new Promise(function(B,fe){var Ce;K.vcMgr&&!(!((Ce=K.vcMgr)===null||Ce===void 0)&&Ce.inited)?(K.vcMgr.onInited=function(){B()},K.vcMgr.onRenderFail=function(Ze){K.tr=1,fe(Ze)}):B()})]})})},$.prototype.removeInput=function(){return oe(this,void 0,void 0,function(){return be(this,function(K){switch(K.label){case 0:return this.input=void 0,[4,this.stopEffect()];case 1:return K.sent(),[2]}})})},$.prototype.updateOutput=function(K){return oe(this,void 0,void 0,function(){return be(this,function(X){switch(X.label){case 0:return this._output===K?[3,3]:(this._output=K,this.onOutputChange?[4,this.onOutputChange(this._output)]:[3,2]);case 1:X.sent(),X.label=2;case 2:X.label=3;case 3:return this.waitForOutputTrack&&this.waitForOutputTrack(),[2]}})})},$.prototype.onOutputChange=function(K){var X;return oe(this,void 0,void 0,function(){return be(this,function(B){switch(B.label){case 0:return[4,(X=this.next)===null||X===void 0?void 0:X.setInput({track:K||this.input||null})];case 1:return B.sent(),[2]}})})},$.prototype.onError=function(K,X){},$}(Se.E),R=k,Fe=function(){return Fe=Object.assign||function(Z){for(var $,K=1,X=arguments.length;K<X;K++)for(var B in $=arguments[K])Object.prototype.hasOwnProperty.call($,B)&&(Z[B]=$[B]);return Z},Fe.apply(this,arguments)},te=function(Z,$,K,X){return new(K||(K=Promise))(function(B,fe){function Ce(Ie){try{st(X.next(Ie))}catch(D){fe(D)}}function Ze(Ie){try{st(X.throw(Ie))}catch(D){fe(D)}}function st(Ie){var D;Ie.done?B(Ie.value):(D=Ie.value,D instanceof K?D:new K(function(me){me(D)})).then(Ce,Ze)}st((X=X.apply(Z,$||[])).next())})},Ue=function(Z,$){var K,X,B,fe,Ce={label:0,sent:function(){if(1&B[0])throw B[1];return B[1]},trys:[],ops:[]};return fe={next:Ze(0),throw:Ze(1),return:Ze(2)},typeof Symbol=="function"&&(fe[Symbol.iterator]=function(){return this}),fe;function Ze(st){return function(Ie){return function(D){if(K)throw new TypeError("Generator is already executing.");for(;fe&&(fe=0,D[0]&&(Ce=0)),Ce;)try{if(K=1,X&&(B=2&D[0]?X.return:D[0]?X.throw||((B=X.return)&&B.call(X),0):X.next)&&!(B=B.call(X,D[1])).done)return B;switch(X=0,B&&(D=[2&D[0],B.value]),D[0]){case 0:case 1:B=D;break;case 4:return Ce.label++,{value:D[1],done:!1};case 5:Ce.label++,X=D[1],D=[0];continue;case 7:D=Ce.ops.pop(),Ce.trys.pop();continue;default:if(B=Ce.trys,!((B=B.length>0&&B[B.length-1])||D[0]!==6&&D[0]!==2)){Ce=0;continue}if(D[0]===3&&(!B||D[1]>B[0]&&D[1]<B[3])){Ce.label=D[1];break}if(D[0]===6&&Ce.label<B[1]){Ce.label=B[1],B=D;break}if(B&&Ce.label<B[2]){Ce.label=B[2],Ce.ops.push(D);break}B[2]&&Ce.ops.pop(),Ce.trys.pop();continue}D=$.call(Z,Ce)}catch(me){D=[6,me],X=0}finally{K=B=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([st,Ie])}}},it="zc.p.0.sbe.0",ee={setBeautyEffect:function(Z,$,K,X){var B=this;return X===void 0&&(X=!0),new w.l3(function(fe,Ce){var Ze,st,Ie=(0,we.L)(Z,B.logger);if(!(0,Re.dr)(Ie))return B.logger.error(it+" localStream not found"),void Ce({errorCode:1100001,extendedData:" localStream no found"});var D=function(et){fe(et)},me=B.streamCenter.checkPreview(Ie);if(!me)return B.logger.error("zc.sbe.0 preview no found"),void D({errorCode:E.fzq.code,extendedData:E.fzq.message});var ce=((Ze=me.videoEffect)===null||Ze===void 0?void 0:Ze.stateFlag)||{base:!1,lowLight:!1};if(X)!($=!!$)&&ce.lowLight?K={sharpenIntensity:0,whitenIntensity:0,rosyIntensity:0,smoothIntensity:0,lowlightEnhancement:ce.lowLight?1:0}:$&&(K=Fe({lowlightEnhancement:ce.lowLight?1:0},K)),ce.base=$;else{var le=K.lowlightEnhancement;K=!((st=me.videoEffect)===null||st===void 0)&&st.enabled||le!==1?{lowlightEnhancement:le}:{sharpenIntensity:0,whitenIntensity:0,rosyIntensity:0,smoothIntensity:0,lowlightEnhancement:le},ce.lowLight=le===1}me.setBeautyEffect(ce.base||ce.lowLight,K,ce).then(function(){D({errorCode:0,extendedData:""})}).catch(function(et){Ce({errorCode:et.errorCode||et.code||-1,extendedData:et.extendedData||et.message||et.toString()})})})},setLowlightEnhance:function(Z,$){return this.setBeautyEffect(Z,!0,{lowlightEnhancement:$},!1)}},ae={setBeautyEffect:function(Z,$,K){var X;return te(this,void 0,void 0,function(){var B,fe,Ce,Ze=this;return Ue(this,function(st){switch(st.label){case 0:if(!this.videoTrack)return this.logger.error(it+" video track no found"),[2];if((0,Re.TE)(WebGLRenderingContext))throw{errorCode:B=E.QYE.code,extendedData:fe=E.QYE.message};return Ce=function(){var Ie;try{(Ie=Ze.vcMgr)===null||Ie===void 0||Ie.init(Ze.videoTrack)}catch(D){if(D.code==1001)throw{errorCode:B,extendedData:fe}}},R?(this.videoEffect||(Ce(),this.videoEffect=new R(this.logger,this.videoTrack,this,this.stateCenter),this.videoEffect.onError=function(Ie,D){Ze.stateCenter.actionListener("beautyEffectError",Ze.localStream,Ie.errorCode,Ie.extendedData,D)}),Z?this.videoNodeQueue.isConnected(this.videoEffect)?[3,4]:this.videoTrack&&((X=this.vcMgr)===null||X===void 0?void 0:X.renderTrack)!==this.videoTrack?[4,this.videoNodeQueue.replaceNewSourceByTrack(this.videoTrack)]:[3,2]:[3,5]):[3,9];case 1:st.sent(),st.label=2;case 2:return[4,this.videoNodeQueue.pushBack(this.videoEffect)];case 3:st.sent(),st.label=4;case 4:return[3,7];case 5:return[4,this.videoNodeQueue.remove(this.videoEffect)];case 6:st.sent(),st.label=7;case 7:return[4,this.videoEffect.setBeautyEffectOptions(Z,$)];case 8:return st.sent(),this.videoEffect.stateFlag=K,[3,10];case 9:this.logger.error(it+" beauty effect module no found"),st.label=10;case 10:return[2]}})})}},xe={type:"BeautyEffect",install:function(Z,$){for(var K in ae)Object.defineProperty($.prototype,K,{value:ae[K],writable:!1});for(var K in ee)Object.defineProperty(Z.prototype,K,{value:ee[K],writable:!1})}}},5794:function(It,Ye,Te){function E(){var w=document.createElement("audio");w.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=",w.play(),setTimeout(function(){w.pause(),w.remove()},1e3)}Te.d(Ye,{r:function(){return E}})},5830:function(It,Ye,Te){Te.d(Ye,{StreamCDN:function(){return Le}});var E,w=Te(8627),Re=Te(4908),we=Te(4872),he=Te(1290),Me=Te(8866),nt=function(pe,k,R,Fe){return new(R||(R=Promise))(function(te,Ue){function it(xe){try{ae(Fe.next(xe))}catch(Z){Ue(Z)}}function ee(xe){try{ae(Fe.throw(xe))}catch(Z){Ue(Z)}}function ae(xe){var Z;xe.done?te(xe.value):(Z=xe.value,Z instanceof R?Z:new R(function($){$(Z)})).then(it,ee)}ae((Fe=Fe.apply(pe,k||[])).next())})},Ne=function(pe,k){var R,Fe,te,Ue,it={label:0,sent:function(){if(1&te[0])throw te[1];return te[1]},trys:[],ops:[]};return Ue={next:ee(0),throw:ee(1),return:ee(2)},typeof Symbol=="function"&&(Ue[Symbol.iterator]=function(){return this}),Ue;function ee(ae){return function(xe){return function(Z){if(R)throw new TypeError("Generator is already executing.");for(;Ue&&(Ue=0,Z[0]&&(it=0)),it;)try{if(R=1,Fe&&(te=2&Z[0]?Fe.return:Z[0]?Fe.throw||((te=Fe.return)&&te.call(Fe),0):Fe.next)&&!(te=te.call(Fe,Z[1])).done)return te;switch(Fe=0,te&&(Z=[2&Z[0],te.value]),Z[0]){case 0:case 1:te=Z;break;case 4:return it.label++,{value:Z[1],done:!1};case 5:it.label++,Fe=Z[1],Z=[0];continue;case 7:Z=it.ops.pop(),it.trys.pop();continue;default:if(te=it.trys,!((te=te.length>0&&te[te.length-1])||Z[0]!==6&&Z[0]!==2)){it=0;continue}if(Z[0]===3&&(!te||Z[1]>te[0]&&Z[1]<te[3])){it.label=Z[1];break}if(Z[0]===6&&it.label<te[1]){it.label=te[1],te=Z;break}if(te&&it.label<te[2]){it.label=te[2],it.ops.push(Z);break}te[2]&&it.ops.pop(),it.trys.pop();continue}Z=k.call(pe,it)}catch($){Z=[6,$],Fe=0}finally{R=te=0}if(5&Z[0])throw Z[1];return{value:Z[0]?Z[1]:void 0,done:!0}}([ae,xe])}}},W=function(){function pe(k,R){this.an=k,this.pn=R,this.attempt=0,this.rr=.3,this.sr=4.8,this.ur=0,this.retryTimer=null,this.maxTimer=null,this.isOverTime=!1,this.RETRY_MAX_TIME=60}return pe.prototype.setRetryRule=function(k){switch(this.ur=k,k){case 1:this.rr=.3,this.sr=32;break;case 0:this.rr=.3,this.sr=4.8}},pe.prototype.getRetryDelayByCount=function(k){return nt(this,void 0,void 0,function(){var R,Fe,te,Ue;return Ne(this,function(it){switch(it.label){case 0:return R=this.ur===1?k+2:k<2?0:k,Fe=Math.min(this.sr,this.rr*Math.pow(2,R)),[4,(0,Me.UY)()];case 1:return te=it.sent(),Ue=Math.floor(te*(1e3*Fe+1)),this.an.info("".concat(he.RnN," ").concat(this.attempt," ").concat(Fe," ").concat(Ue)),[2,Ue]}})})},pe.prototype.initCallback=function(k,R){this.sucCallBack=k,this.failCallBack=R},pe.prototype.startMaxTime=function(){var k,R=this;this.an.info("".concat(he.zUi," ").concat((k=this.requestInfo)===null||k===void 0?void 0:k.streamID," call")),this.maxTimer?this.an.warn("".concat(he.zUi," max timer")):(this.maxTimer=setTimeout(function(){var Fe;R.an.warn("".concat(he.zUi," ").concat((Fe=R.requestInfo)===null||Fe===void 0?void 0:Fe.streamID," over max time ").concat(R.RETRY_MAX_TIME,"s, stop retry")),R.isOverTime=!0,R.requestFail(R._err)},1e3*this.RETRY_MAX_TIME),this.an.info("".concat(he.zUi," maxTimer=").concat(this.maxTimer)))},pe.prototype.invalid=function(){this.clearRetryTimer(),this.attempt=0},pe.prototype.clearRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},pe.prototype.requestFail=function(k){this.invalid(),this.stopMaxTime(),this.failCallBack&&(this.failCallBack(k),this.resetCallback())},pe.prototype.stopMaxTime=function(){this.an.info("".concat(he.zub," stop max timer")),this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},pe.prototype.resetCallback=function(){this.sucCallBack=void 0,this.failCallBack=void 0},pe}(),Q=(E=function(pe,k){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,Fe){R.__proto__=Fe}||function(R,Fe){for(var te in Fe)Object.prototype.hasOwnProperty.call(Fe,te)&&(R[te]=Fe[te])},E(pe,k)},function(pe,k){if(typeof k!="function"&&k!==null)throw new TypeError("Class extends value "+String(k)+" is not a constructor or null");function R(){this.constructor=pe}E(pe,k),pe.prototype=k===null?Object.create(k):(R.prototype=k.prototype,new R)}),se=function(pe){function k(R,Fe,te){var Ue=pe.call(this,R,Fe)||this;return Ue.an=R,Ue.pn=Fe,Ue.ar=te,Ue.RETRY_MAX_TIME=8,Ue}return Q(k,pe),k.prototype.initReqParams=function(R,Fe){this.streamId=R,this.cdnPushConfig=Fe},k.prototype.active=function(R){var Fe=this;if(R===void 0&&(R=!1),this.retryTimer)this.an.warn("".concat(he.v$W," was actived, ignore"));else if(this.isOverTime)this.an.warn("".concat(he.v$W," retry over time, stop retry"));else{var te=function(){Fe.clearRetryTimer(),Fe.ar.sendCDNRequest(Fe.streamId,Fe.cdnPushConfig,function(Ue,it){var ee=Ue.body;Fe.invalid(),Fe.stopMaxTime(),Fe.sucCallBack&&(Fe.sucCallBack&&Fe.sucCallBack(ee,it),Fe.resetCallback())},function(Ue){Fe._err=Ue;var it=Ue.status_code;Fe.isOverTime?Fe.requestFail(Ue):((it===429||it>=500&&it<600)&&Fe.setRetryRule(1),Fe.active())}),R||Fe.attempt++};R?te():this.getRetryDelayByCount(this.attempt).then(function(Ue){Fe.retryTimer=setTimeout(te,Ue)})}},k}(W),J=Te(3788);const G=Te(6994);(J=J.default||J).util.Long=G.default||G,J.util.Long.fromBits=J.util.Long.fromBits||function(){return 0};for(var U=J.roots,C=J.types?J.types.basic:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0,string:2,bytes:2},N=J.types?J.types.packed:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0},v=Object.keys(C),f={$:function(pe){return f[pe]?f[pe].call(this):U[pe].decode?U[pe].decode(this,this.uint32()):f.$.call(this,"int32")}},_={$:function(pe,k,R){var Fe=C[pe];return Fe===void 0?U[pe].encode?(this.uint32(R<<3|2).fork(),U[pe].encode(k,this).ldelim()):_.$.call(this,"int32",k,R):_[pe].call(this.uint32(R<<3|Fe),k)}},b=0;b<v.length;b++)f[v[b]]=J.Reader.prototype[v[b]],_[v[b]]=J.Writer.prototype[v[b]];(function pe(k,R,Fe,te){for(var Ue=0,it=Object.keys(k);Ue<it.length;Ue++){var ee=it[Ue];if(k[ee].$m&&Object.keys(k[ee].$m).every(function(ae){return Number(ae)})){if(Fe[ee])throw Error(`nested type ${Fe}.${ee} has already exist`);Fe[ee]=function(ae,xe){function Z(fe){for(var Ce in ae){var Ze=ae[Ce];Ze[1].charAt(0)==="{"?this[Ze[0]]={}:Ze[1].charAt(0)!=="["&&Ze[1].charAt(0)!=="<"||(this[Ze[0]]=[])}if(fe)for(var st=Object.keys(fe),Ie=0;Ie<st.length;++Ie)fe[st[Ie]]!=null&&(this[st[Ie]]=fe[st[Ie]])}var $={};for(var K in ae){var X=ae[K],B=X[1];B.charAt(0)==="{"?(Z.prototype[X[0]]=J.util.emptyObject,$[B]={$m:B.substring(1).split(",").map(function(fe,Ce){return[`$${Ce+1}`,fe,null]}).reduce(function(fe,Ce,Ze){return fe[Ze+1]=Ce,fe},{})}):Z.prototype[X[0]]=B.charAt(0)==="["||B.charAt(0)==="<"?J.util.emptyArray:B==="bytes"?J.util.newBuffer([]):X[2]&&X[2].hasOwnProperty("low")&&X[2].hasOwnProperty("high")?J.util.Long.fromBits(X[2].low,X[2].high,X[2].unsigned):X[2]}return Z.create=function(fe){return new Z(fe)},Z.decode=function(fe,Ce){fe instanceof J.Reader||(fe=J.Reader.create(fe));for(var Ze=Ce===void 0?fe.len:fe.pos+Ce,st=new Z;fe.pos<Ze;){var Ie=fe.uint32(),D=Ie>>>3;if(D>0&&ae[D]){var me=ae[D][0],ce=ae[D][1];if(ce.charAt(0)==="{"){st[me]===J.util.emptyObject&&(st[me]={});var le=Z.$namespace[ce].decode(fe,fe.uint32());st[me][le.$1]=le.$2}else if(ce.charAt(0)==="["||ce.charAt(0)==="<")if(ce=ce.substring(1),st[me]&&st[me].length||(st[me]=[]),N[ce=!f[ce]&&!U[ce].decode?"int32":ce]!==void 0&&(7&Ie)==2)for(var et=fe.uint32()+fe.pos;fe.pos<et;)st[me].push(f.$.call(fe,ce));else st[me].push(f.$.call(fe,ce));else st[me]=f.$.call(fe,ce)}else fe.skipType(7&Ie)}return st},Z.encode=function(fe,Ce){for(var Ze in Ce||(Ce=J.Writer.create()),ae){var st=ae[Ze][0],Ie=ae[Ze][1];if(Ie.charAt(0)==="{"){if(fe[st]!=null&&fe.hasOwnProperty(st))for(var D=0,me=Object.keys(fe[st]);D<me.length;++D)Ce.uint32(Ze<<3|2).fork(),Z.$namespace[Ie].encode({$1:me[D],$2:fe[st][me[D]]},Ce).ldelim()}else if(Ie.charAt(0)==="["||Ie.charAt(0)==="<"){var ce=Ie.charAt(0)==="<";Ie=Ie.substring(1);var le=fe[st];if(le!=null&&le.length)if(Ie=C[Ie]===void 0&&!U[Ie].encode?"int32":Ie,ce&&N[Ie]!==void 0){for(Ce.uint32(Ze<<3|2).fork(),D=0;D<le.length;D++)_[Ie].call(Ce,le[D]);Ce.ldelim()}else for(D=0;D<le.length;D++)_.$.call(Ce,Ie,le[D],Ze)}else fe[st]!=null&&fe.hasOwnProperty(st)&&_.$.call(Ce,Ie,fe[st],Ze)}return Ce},Object.keys($).length&&(Z.$namespace=pe($,R+"."+xe,Z.$namespace||{},!0)),Z}(k[ee].$m,ee)}else k[ee].$s?Fe[ee]=function(ae,xe){function Z($,K,X){J.rpc.Service.call(this,$,K,X)}return(Z.prototype=Object.create(J.rpc.Service.prototype)).constructor=Z,Z.create=function($,K,X){return new Z($,K,X)},Object.keys(ae).forEach(function($){var K=ae[$];function X(B,fe){return this.rpcCall(X,U[K[0]],U[K[1]],B,fe)}Object.defineProperty(X,"name",{value:$}),Object.defineProperty(X,"path",{value:`${R}.${xe}`}),Z.prototype[$]=X}),Z}(k[ee].$s,ee):k[ee].$e&&Object.values(k[ee].$e).every(function(ae){return Number(ae)===ae})&&(Fe[ee]=function(ae){for(var xe=Object.keys(ae),Z={},$=0;$<xe.length;$++)Z[Z[xe[$]]=ae[xe[$]]]=xe[$];return Z}(k[ee].$e));Fe[ee]&&!te&&(U[`${R}.${ee}`]=Fe[ee]),delete k[ee].$m,delete k[ee].$s,delete k[ee].$e,Fe[ee]=pe(k[ee],R?`${R}.${ee}`:ee,Fe[ee]||{})}return Fe})({media:{proto_media:{MediaServerCommonResponse:{$m:{1:["code","uint32",0],2:["message","string",""]}},NotifySdkNeedStreamRequest:{$m:{1:["request_seq","uint32",0],2:["stream_id","string",""],3:["playAddr","string",""],4:["transCodecId","int32",0],5:["transCodecSuffix","string",""],6:["cdnType","int32",0],7:["retry","int32",0]}},NotifySdkNeedStreamResponse:{$m:{1:["request_seq","uint32",0],2:["response","media.proto_media.MediaServerCommonResponse",null],3:["transCodecSuffix","string",""],4:["action","int32",0],5:["action_delay","int32",0],6:["ttl","int32",0]}},RelayPublishCdnRequest:{$m:{1:["request_seq","uint32",0],2:["request_cmd","int32",0],3:["streamid","string",""],4:["cdn_server","string",""],5:["publish_timeout","uint32",0],6:["request_seq_v2","uint64",{low:0,high:0,unsigned:!0}]}},RelayPublishCdnResponse:{$m:{1:["request_seq","uint32",0],2:["response","media.proto_media.MediaServerCommonResponse",null],3:["request_seq_v2","uint64",{low:0,high:0,unsigned:!0}]}}}}},"",U,!1);var y=U.media,M=Te(3788),Y=Te.n(M),L=Te(7202);Y().util.Long=L.A,Y().configure();var A,H=y.proto_media,ge=function(){function pe(){}return pe.prototype.encodeRelayPublishCdnReq=function(k){var R=H.RelayPublishCdnRequest.create(k);return H.RelayPublishCdnRequest.encode(R).finish()},pe.prototype.decodeRelayPublishCdnRsp=function(k){var R=H.RelayPublishCdnResponse.decode(k);return R.request_seq_v2&&L.A.isLong(R.request_seq_v2)&&(R.request_seq_v2=R.request_seq_v2.toNumber()),R},pe.prototype.encodeNotifySdkNeedStreamReq=function(k){var R=H.NotifySdkNeedStreamRequest.create(k);return H.NotifySdkNeedStreamRequest.encode(R).finish()},pe.prototype.decodeNotifySdkNeedStreamRsp=function(k){return H.NotifySdkNeedStreamResponse.decode(k)},pe}(),Ee=function(){var pe=function(k,R){return pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Fe,te){Fe.__proto__=te}||function(Fe,te){for(var Ue in te)Object.prototype.hasOwnProperty.call(te,Ue)&&(Fe[Ue]=te[Ue])},pe(k,R)};return function(k,R){if(typeof R!="function"&&R!==null)throw new TypeError("Class extends value "+String(R)+" is not a constructor or null");function Fe(){this.constructor=k}pe(k,R),k.prototype=R===null?Object.create(R):(Fe.prototype=R.prototype,new Fe)}}(),Se=function(pe){function k(R,Fe,te){var Ue=pe.call(this,R,Fe)||this;return Ue.an=R,Ue.pn=Fe,Ue.ar=te,Ue.RETRY_MAX_TIME=90,Ue}return Ee(k,pe),k.prototype.initReqParams=function(R,Fe){this.streamID=R,this.transCodecConfig=Fe},k.prototype.active=function(R){var Fe=this;if(R===void 0&&(R=!1),this.an.info("".concat(he.nkr," call")),this.retryTimer)this.an.warn("".concat(he.nkr," was active, ignore"));else if(this.isOverTime)this.an.warn("".concat(he.nkr," retry over time, stop retry"));else{var te=function(){Fe.clearRetryTimer(),Fe.ar.sendNotifySdkNeedStreamHttpRes(Fe.streamID,Fe.transCodecConfig,function(Ue,it){var ee=Ue.body;Fe.invalid(),Fe.stopMaxTime(),Fe.sucCallBack&&(Fe.sucCallBack&&Fe.sucCallBack(ee,it),Fe.resetCallback())},function(Ue){Fe._err=Ue;var it=Ue.status_code;Fe.isOverTime?Fe.requestFail(Ue):((it===429||it>=500&&it<600)&&Fe.setRetryRule(1),Fe.active())}),R||Fe.attempt++};R?te():this.getRetryDelayByCount(this.attempt).then(function(Ue){Fe.retryTimer=setTimeout(te,Ue)})}},k}(W);(function(pe){pe[pe.I=0]="I",pe[pe.H=10]="H",pe[pe.M=100]="M",pe[pe.L=1e3]="L"})(A||(A={}));var ue={},oe={_sendCDNPublishByAccessHub:function(pe,k,R,Fe){var te=this;this.mediaProtoBuf||(this.mediaProtoBuf=new ge);var Ue=new se(this.logger,this.stateCenter,this);Ue.initReqParams(pe,k);var it=function(ee,ae){try{var xe=te.mediaProtoBuf.decodeRelayPublishCdnRsp(ee);te.logger.info("zb.sh.pt rsp decode ".concat(JSON.stringify(xe)));var Z=(xe==null?void 0:xe.response)||{};return{code:Z.code,msg:Z.message}}catch{return{code:-1}}};Ue.initCallback(function(ee,ae){var xe=it(ee),Z=xe.code,$=xe.msg;Z&&Z!=0?(te.logger.error("zb.sh.pt "+k.type+" error code: "+Z+" "+$),Fe(Z===5004?w.yTe:w.Oy0," cmd: ".concat(k.type," ").concat(Z," ").concat($))):(te.logger.info("zb.sh.pt "+k.type+" success"),R&&R({errorCode:0,extendedData:""}))},function(ee){var ae=ee.status_code,xe=ee.body,Z=ee.code,$=ee.msg,K=JSON.parse(JSON.stringify(Re.Of.error.He)),X="";if(Z)K={code:Z,msg:$},X=$;else if(ae===200)te.logger.info("zb.sh.pt error: "),K=Re.Of.error.He,X="cmd: ".concat(k.type);else{var B="";if((0,we.QP)(xe))B=xe;else{var fe=it(xe);B=fe.code+" "+fe.msg}X="request media server fail, error: "+ae+" "+B}te.logger.error("zb.sh.pt "+X),Fe&&Fe(K,X)}),Ue.startMaxTime(),Ue.active(!0)},sendCDNRequest:function(pe,k,R,Fe){var te=this,Ue=k.type==="addpush"?1:2,it={request_seq:this.stateCenter.cdnSeq++,request_cmd:Ue,streamid:pe,cdn_server:k.pushUrl,request_seq_v2:this.stateCenter.cdnSeqV2++};this.logger.info("zb.sh.scpba "+JSON.stringify(it));var ee=this.mediaProtoBuf.encodeRelayPublishCdnReq(it);this.sendHttpPBRequest({interfaceID:6,resID:this.stateCenter.appid+"/"+pe},ee,function(ae,xe){te.logger.info("zb.sh.pt receive message "+(ae==null?void 0:ae.status_code)),R&&R(ae,xe)},function(ae){Fe&&Fe(ae)},{timeout:4e3})},_publishTarget:function(pe,k,R){this.logger.info("zb.sh.pt call");var Fe=pe.streamID;this.stateCenter.testEnvironment&&(Fe="zegotest-"+this.stateCenter.appid+"-"+pe.streamID),this._sendCDNPublishByAccessHub(Fe,pe,k,R)},notifySdkNeedStream:function(pe,k,R,Fe){var te=this;this.mediaProtoBuf||(this.mediaProtoBuf=new ge);var Ue=new Se(this.logger,this.stateCenter,this);return Ue.initReqParams(pe,k),Ue.initCallback(function(it){try{var ee=te.mediaProtoBuf.decodeNotifySdkNeedStreamRsp(it);te.logger.info("zb.sh.nsns receive message:"+JSON.stringify(ee));var ae=(ee==null?void 0:ee.response)||{},xe=ae.code;xe&&xe!=0?Fe({code:xe,message:ae.message||""},ee):R&&R(ee)}catch(Z){Z({code:-1})}},function(it){te.logger.error("zb.sh.nsns err:"+JSON.stringify(it)),Fe&&Fe(it)}),Ue.startMaxTime(),Ue.active(!0),Ue},sendNotifySdkNeedStreamHttpRes:function(pe,k,R,Fe){this.mediaProtoBuf||(this.mediaProtoBuf=new ge);var te=k.playAddr,Ue=k.transCodecID,it=k.transCodecSuffix,ee=k.retry,ae={request_seq:this.stateCenter.cdnSeq++,stream_id:pe,playAddr:te,transCodecId:Ue,transCodecSuffix:it,cdnType:0,retry:ee};this.logger.info("zb.sh.nsns request body:"+JSON.stringify(ae));var xe=this.mediaProtoBuf.encodeNotifySdkNeedStreamReq(ae);this.sendHttpPBRequest({interfaceID:19,resID:this.stateCenter.appid+"/"+pe},xe,function(Z,$){R&&R(Z,$)},function(Z){Fe&&Fe(Z)},{timeout:4e3})}},be=function(){function pe(k,R,Fe,te){this.an=k,this.dataReport=R,this.gn=Fe,this.pn=te,this.screenShotReady=!1}return Object.defineProperty(pe.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),pe.prototype.publishTarget=function(k){var R=this,Fe="";switch(k.type){case"addpush":Fe=Re.iJ.event;break;case"delpush":case"clearpush":Fe=Re.ns.event}var te=this.cr.createSpan(A.H,{key:Re.Og.event,par:k.streamID},{key:""},Fe);return te.setAttributes({url:Re.ns.url(k.pushUrl)}),new Me.l3(function(Ue,it){var ee=function(xe,Z){R.an.error("zb.pt "+(Z||xe.message)),R.cr.setError(te,xe,Z),it({errorCode:xe.code,extendedData:xe.message+(Z?" "+Z:"")})};if(["addpush","delpush","clearpush"].indexOf(k.type)==-1)return R.an.error("zb.sh.pt cdn push type error"),void ee(w.rBJ,"type error");if(k.streamID&&(0,we.QP)(k.streamID))if(k.pushUrl&&(0,we.QP)(k.pushUrl))if(R.pn.publishStreamList[k.streamID]){var ae=R.gn.getRoomByStreamID(k.streamID);ae?ae.streamHandler._publishTarget(k,function(xe){te.end(),Ue(xe)},ee):ee(Re.Of.error.Ue)}else ee(Re.Of.error.Be);else ee(Re.Of.error.wn,"push url error");else ee(Re.Of.error.wn,"stream id type error")})},pe}(),Le={type:"StreamCDN",install:function(pe,k,R){for(var Fe in Object.defineProperty(k.prototype,"initStreamCDN",{value:function(){this.streamCDNModule=new be(this.logger,this.dataReport,this.streamCenter,this.stateCenter)},writable:!1}),ue)Object.defineProperty(pe.prototype,Fe,{value:ue[Fe],writable:!1});for(var Fe in oe)Object.defineProperty(R.prototype,Fe,{value:oe[Fe],writable:!1})}}},6361:function(It){It.exports=ct},6440:function(It,Ye,Te){var E;It.exports=(E=Te(9021),function(){if(typeof ArrayBuffer=="function"){var w=E.lib.WordArray,Re=w.init,we=w.init=function(he){if(he instanceof ArrayBuffer&&(he=new Uint8Array(he)),(he instanceof Int8Array||typeof Uint8ClampedArray<"u"&&he instanceof Uint8ClampedArray||he instanceof Int16Array||he instanceof Uint16Array||he instanceof Int32Array||he instanceof Uint32Array||he instanceof Float32Array||he instanceof Float64Array)&&(he=new Uint8Array(he.buffer,he.byteOffset,he.byteLength)),he instanceof Uint8Array){for(var Me=he.byteLength,nt=[],Ne=0;Ne<Me;Ne++)nt[Ne>>>2]|=he[Ne]<<24-Ne%4*8;Re.call(this,nt,Me)}else Re.apply(this,arguments)};we.prototype=w}}(),E.lib.WordArray)},6493:function(It,Ye,Te){Te.d(Ye,{$t:function(){return w},Fr:function(){return J},H8:function(){return W},HR:function(){return he},UN:function(){return U},Wu:function(){return Me},_Z:function(){return nt},aR:function(){return Re},e8:function(){return se},gm:function(){return Q},hL:function(){return G},hU:function(){return C},m0:function(){return we},nr:function(){return Ne}});var E=Te(2638);function w(){return navigator.userAgent||""}function Re(){return navigator.platform.match(/iPhone|iPod|iPad|ios/i)!==null}function we(){return w().match(/Android|android/i)!==null}function he(){return w().match(/OpenHarmony|HarmonyOS/i)!==null}function Me(){return he()&&w().match(/ArkWeb/i)!==null}function nt(){var N,v=navigator.userAgent,f=v.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];return/trident/i.test(f[1])?{name:"IE",version:(N=/\brv[ :]+([\d\.]+)/g.exec(v)||[])[1]||""}:f[1]==="Chrome"&&(N=v.match(/\bOPR|Edge\/([\d\.]+)/))!=null?{name:"Opera",version:N[1]}:(f=f[2]?[f[1],f[2]]:[navigator.appName,navigator.appVersion,"-?"],(N=v.match(/version\/([\d+\.]+)/i))!=null&&f.splice(1,1,N[1]),{name:f[0],version:f[1]})}function Ne(){return nt().name.toLowerCase()=="safari"}function W(){return nt().name.toLowerCase()=="chrome"}function Q(){return nt().name.toLowerCase()=="firefox"}function se(){return W()&&!!navigator.userAgent.toLocaleLowerCase().match(/redmi\snote\s8/)}function J(){var N=w();return!!(N.match(/Mobi/i)||N.match(/Android/i)||N.match(/iPhone/i))}function G(){var N,v;return!!(!((v=(N=w())===null||N===void 0?void 0:N.toLowerCase())===null||v===void 0)&&v.match(/MicroMessenger/i))}function U(){var N=w().toLowerCase().match(/cpu iphone os (.*?) like mac os/);return N&&N[1]||""}function C(){return Re()?E.B7.IOS:we()?E.B7.ANDROID:navigator.platform.match(/Mac|Mac68K|MacPPC|MacIntel/i)!==null?E.B7.MAC:navigator.platform.match("Win32")!==null&&w().match(/WOW64|Win64|x86_64|x86-64|x64;|amd64|AMD64|x64_64/i)===null?E.B7.WIN32:he()?E.B7.Harmony:E.B7.UNKNOWN}},6794:function(It){It.exports=function(){function Ye(Te,E,w){function Re(Me,nt){if(!E[Me]){if(!Te[Me]){if(we)return we(Me,!0);var Ne=new Error("Cannot find module '"+Me+"'");throw Ne.code="MODULE_NOT_FOUND",Ne}var W=E[Me]={exports:{}};Te[Me][0].call(W.exports,function(Q){return Re(Te[Me][1][Q]||Q)},W,W.exports,Ye,Te,E,w)}return E[Me].exports}for(var we=void 0,he=0;he<w.length;he++)Re(w[he]);return Re}return Ye}()({1:[function(Ye,Te,E){var w=(0,Ye("./adapter_factory.js").adapterFactory)({window});Te.exports=w},{"./adapter_factory.js":2}],2:[function(Ye,Te,E){Object.defineProperty(E,"__esModule",{value:!0}),E.adapterFactory=W;var w=Ne(Ye("./utils")),Re=Ne(Ye("./chrome/chrome_shim")),we=Ne(Ye("./edge/edge_shim")),he=Ne(Ye("./firefox/firefox_shim")),Me=Ne(Ye("./safari/safari_shim")),nt=Ne(Ye("./common_shim"));function Ne(Q){if(Q&&Q.__esModule)return Q;var se={};if(Q!=null)for(var J in Q)Object.prototype.hasOwnProperty.call(Q,J)&&(se[J]=Q[J]);return se.default=Q,se}function W(){var Q=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).window,se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},J=w.log,G=w.detectBrowser(Q),U={browserDetails:G,commonShim:nt,extractVersion:w.extractVersion,disableLog:w.disableLog,disableWarnings:w.disableWarnings};switch(G.browser){case"chrome":if(!Re||!Re.shimPeerConnection||!se.shimChrome)return J("Chrome shim is not included in this adapter release."),U;J("adapter.js shimming chrome."),U.browserShim=Re,Re.shimGetUserMedia(Q),Re.shimMediaStream(Q),Re.shimPeerConnection(Q),Re.shimOnTrack(Q),Re.shimAddTrackRemoveTrack(Q),Re.shimGetSendersWithDtmf(Q),Re.shimGetStats(Q),Re.shimSenderReceiverGetStats(Q),Re.fixNegotiationNeeded(Q),nt.shimRTCIceCandidate(Q),nt.shimConnectionState(Q),nt.shimMaxMessageSize(Q),nt.shimSendThrowTypeError(Q),nt.removeAllowExtmapMixed(Q);break;case"firefox":if(!he||!he.shimPeerConnection||!se.shimFirefox)return J("Firefox shim is not included in this adapter release."),U;J("adapter.js shimming firefox."),U.browserShim=he,he.shimGetUserMedia(Q),he.shimPeerConnection(Q),he.shimOnTrack(Q),he.shimRemoveStream(Q),he.shimSenderGetStats(Q),he.shimReceiverGetStats(Q),he.shimRTCDataChannel(Q),nt.shimRTCIceCandidate(Q),nt.shimConnectionState(Q),nt.shimMaxMessageSize(Q),nt.shimSendThrowTypeError(Q);break;case"edge":if(!we||!we.shimPeerConnection||!se.shimEdge)return J("MS edge shim is not included in this adapter release."),U;J("adapter.js shimming edge."),U.browserShim=we,we.shimGetUserMedia(Q),we.shimGetDisplayMedia(Q),we.shimPeerConnection(Q),we.shimReplaceTrack(Q),nt.shimMaxMessageSize(Q),nt.shimSendThrowTypeError(Q);break;case"safari":if(!Me||!se.shimSafari)return J("Safari shim is not included in this adapter release."),U;J("adapter.js shimming safari."),U.browserShim=Me,Me.shimRTCIceServerUrls(Q),Me.shimCreateOfferLegacy(Q),Me.shimCallbacksAPI(Q),Me.shimLocalStreamsAPI(Q),Me.shimRemoteStreamsAPI(Q),Me.shimTrackEventTransceiver(Q),Me.shimGetUserMedia(Q),nt.shimRTCIceCandidate(Q),nt.shimMaxMessageSize(Q),nt.shimSendThrowTypeError(Q),nt.removeAllowExtmapMixed(Q);break;default:J("Unsupported browser!")}return U}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(Ye,Te,E){Object.defineProperty(E,"__esModule",{value:!0}),E.shimGetDisplayMedia=E.shimGetUserMedia=void 0;var w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},Re=Ye("./getusermedia");Object.defineProperty(E,"shimGetUserMedia",{enumerable:!0,get:function(){return Re.shimGetUserMedia}});var we=Ye("./getdisplaymedia");Object.defineProperty(E,"shimGetDisplayMedia",{enumerable:!0,get:function(){return we.shimGetDisplayMedia}}),E.shimMediaStream=nt,E.shimOnTrack=Ne,E.shimGetSendersWithDtmf=W,E.shimGetStats=Q,E.shimSenderReceiverGetStats=se,E.shimAddTrackRemoveTrackWithNative=J,E.shimAddTrackRemoveTrack=G,E.shimPeerConnection=U,E.fixNegotiationNeeded=C;var he=Me(Ye("../utils.js"));function Me(N){if(N&&N.__esModule)return N;var v={};if(N!=null)for(var f in N)Object.prototype.hasOwnProperty.call(N,f)&&(v[f]=N[f]);return v.default=N,v}function nt(N){N.MediaStream=N.MediaStream||N.webkitMediaStream}function Ne(N){if((N===void 0?"undefined":w(N))==="object"&&N.RTCPeerConnection&&!("ontrack"in N.RTCPeerConnection.prototype)){Object.defineProperty(N.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(f){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=f)},enumerable:!0,configurable:!0});var v=N.RTCPeerConnection.prototype.setRemoteDescription;N.RTCPeerConnection.prototype.setRemoteDescription=function(){var f=this;return this._ontrackpoly||(this._ontrackpoly=function(_){_.stream.addEventListener("addtrack",function(b){var y=void 0;y=N.RTCPeerConnection.prototype.getReceivers?f.getReceivers().find(function(Y){return Y.track&&Y.track.id===b.track.id}):{track:b.track};var M=new Event("track");M.track=b.track,M.receiver=y,M.transceiver={receiver:y},M.streams=[_.stream],f.dispatchEvent(M)}),_.stream.getTracks().forEach(function(b){var y=void 0;y=N.RTCPeerConnection.prototype.getReceivers?f.getReceivers().find(function(Y){return Y.track&&Y.track.id===b.id}):{track:b};var M=new Event("track");M.track=b,M.receiver=y,M.transceiver={receiver:y},M.streams=[_.stream],f.dispatchEvent(M)})},this.addEventListener("addstream",this._ontrackpoly)),v.apply(this,arguments)}}else he.wrapPeerConnectionEvent(N,"track",function(f){return f.transceiver||Object.defineProperty(f,"transceiver",{value:{receiver:f.receiver}}),f})}function W(N){if((N===void 0?"undefined":w(N))==="object"&&N.RTCPeerConnection&&!("getSenders"in N.RTCPeerConnection.prototype)&&"createDTMFSender"in N.RTCPeerConnection.prototype){var v=function(Y,L){return{track:L,get dtmf(){return this._dtmf===void 0&&(this._dtmf=L.kind==="audio"?Y.createDTMFSender(L):null),this._dtmf},_pc:Y}};if(!N.RTCPeerConnection.prototype.getSenders){N.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var f=N.RTCPeerConnection.prototype.addTrack;N.RTCPeerConnection.prototype.addTrack=function(Y,L){var A=f.apply(this,arguments);return A||(A=v(this,Y),this._senders.push(A)),A};var _=N.RTCPeerConnection.prototype.removeTrack;N.RTCPeerConnection.prototype.removeTrack=function(Y){_.apply(this,arguments);var L=this._senders.indexOf(Y);L!==-1&&this._senders.splice(L,1)}}var b=N.RTCPeerConnection.prototype.addStream;N.RTCPeerConnection.prototype.addStream=function(Y){var L=this;this._senders=this._senders||[],b.apply(this,[Y]),Y.getTracks().forEach(function(A){L._senders.push(v(L,A))})};var y=N.RTCPeerConnection.prototype.removeStream;N.RTCPeerConnection.prototype.removeStream=function(Y){var L=this;this._senders=this._senders||[],y.apply(this,[Y]),Y.getTracks().forEach(function(A){var H=L._senders.find(function(ge){return ge.track===A});H&&L._senders.splice(L._senders.indexOf(H),1)})}}else if((N===void 0?"undefined":w(N))==="object"&&N.RTCPeerConnection&&"getSenders"in N.RTCPeerConnection.prototype&&"createDTMFSender"in N.RTCPeerConnection.prototype&&N.RTCRtpSender&&!("dtmf"in N.RTCRtpSender.prototype)){var M=N.RTCPeerConnection.prototype.getSenders;N.RTCPeerConnection.prototype.getSenders=function(){var Y=this,L=M.apply(this,[]);return L.forEach(function(A){return A._pc=Y}),L},Object.defineProperty(N.RTCRtpSender.prototype,"dtmf",{get:function(){return this._dtmf===void 0&&(this._dtmf=this.track.kind==="audio"?this._pc.createDTMFSender(this.track):null),this._dtmf}})}}function Q(N){if(N.RTCPeerConnection){var v=N.RTCPeerConnection.prototype.getStats;N.RTCPeerConnection.prototype.getStats=function(f,_,b){var y=this,M=arguments;if(arguments.length>0&&typeof f=="function")return v.apply(this,arguments);if(v.length===0&&(arguments.length===0||typeof arguments[0]!="function"))return v.apply(this,[]);var Y=function(A){var H={};return A.result().forEach(function(ge){var Ee={id:ge.id,timestamp:ge.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[ge.type]||ge.type};ge.names().forEach(function(Se){Ee[Se]=ge.stat(Se)}),H[Ee.id]=Ee}),H},L=function(A){return new Map(Object.keys(A).map(function(H){return[H,A[H]]}))};return arguments.length>=2?v.apply(this,[function(A){M[1](L(Y(A)))},arguments[0]]):new Promise(function(A,H){v.apply(y,[function(ge){A(L(Y(ge)))},H])}).then(_,b)}}}function se(N){if((N===void 0?"undefined":w(N))==="object"&&N.RTCPeerConnection&&N.RTCRtpSender&&N.RTCRtpReceiver){if(!("getStats"in N.RTCRtpSender.prototype)){var v=N.RTCPeerConnection.prototype.getSenders;v&&(N.RTCPeerConnection.prototype.getSenders=function(){var y=this,M=v.apply(this,[]);return M.forEach(function(Y){return Y._pc=y}),M});var f=N.RTCPeerConnection.prototype.addTrack;f&&(N.RTCPeerConnection.prototype.addTrack=function(){var y=f.apply(this,arguments);return y._pc=this,y}),N.RTCRtpSender.prototype.getStats=function(){var y=this;return this._pc.getStats().then(function(M){return he.filterStats(M,y.track,!0)})}}if(!("getStats"in N.RTCRtpReceiver.prototype)){var _=N.RTCPeerConnection.prototype.getReceivers;_&&(N.RTCPeerConnection.prototype.getReceivers=function(){var y=this,M=_.apply(this,[]);return M.forEach(function(Y){return Y._pc=y}),M}),he.wrapPeerConnectionEvent(N,"track",function(y){return y.receiver._pc=y.srcElement,y}),N.RTCRtpReceiver.prototype.getStats=function(){var y=this;return this._pc.getStats().then(function(M){return he.filterStats(M,y.track,!1)})}}if("getStats"in N.RTCRtpSender.prototype&&"getStats"in N.RTCRtpReceiver.prototype){var b=N.RTCPeerConnection.prototype.getStats;N.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof N.MediaStreamTrack){var y=arguments[0],M=void 0,Y=void 0,L=void 0;return this.getSenders().forEach(function(A){A.track===y&&(M?L=!0:M=A)}),this.getReceivers().forEach(function(A){return A.track===y&&(Y?L=!0:Y=A),A.track===y}),L||M&&Y?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):M?M.getStats():Y?Y.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return b.apply(this,arguments)}}}}function J(N){N.RTCPeerConnection.prototype.getLocalStreams=function(){var y=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(M){return y._shimmedLocalStreams[M][0]})};var v=N.RTCPeerConnection.prototype.addTrack;N.RTCPeerConnection.prototype.addTrack=function(y,M){if(!M)return v.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var Y=v.apply(this,arguments);return this._shimmedLocalStreams[M.id]?this._shimmedLocalStreams[M.id].indexOf(Y)===-1&&this._shimmedLocalStreams[M.id].push(Y):this._shimmedLocalStreams[M.id]=[M,Y],Y};var f=N.RTCPeerConnection.prototype.addStream;N.RTCPeerConnection.prototype.addStream=function(y){var M=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},y.getTracks().forEach(function(A){if(M.getSenders().find(function(H){return H.track===A}))throw new DOMException("Track already exists.","InvalidAccessError")});var Y=this.getSenders();f.apply(this,arguments);var L=this.getSenders().filter(function(A){return Y.indexOf(A)===-1});this._shimmedLocalStreams[y.id]=[y].concat(L)};var _=N.RTCPeerConnection.prototype.removeStream;N.RTCPeerConnection.prototype.removeStream=function(y){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[y.id],_.apply(this,arguments)};var b=N.RTCPeerConnection.prototype.removeTrack;N.RTCPeerConnection.prototype.removeTrack=function(y){var M=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},y&&Object.keys(this._shimmedLocalStreams).forEach(function(Y){var L=M._shimmedLocalStreams[Y].indexOf(y);L!==-1&&M._shimmedLocalStreams[Y].splice(L,1),M._shimmedLocalStreams[Y].length===1&&delete M._shimmedLocalStreams[Y]}),b.apply(this,arguments)}}function G(N){if(N.RTCPeerConnection){var v=he.detectBrowser(N);if(N.RTCPeerConnection.prototype.addTrack&&v.version>=65)return J(N);var f=N.RTCPeerConnection.prototype.getLocalStreams;N.RTCPeerConnection.prototype.getLocalStreams=function(){var A=this,H=f.apply(this);return this._reverseStreams=this._reverseStreams||{},H.map(function(ge){return A._reverseStreams[ge.id]})};var _=N.RTCPeerConnection.prototype.addStream;N.RTCPeerConnection.prototype.addStream=function(A){var H=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},A.getTracks().forEach(function(Ee){if(H.getSenders().find(function(Se){return Se.track===Ee}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[A.id]){var ge=new N.MediaStream(A.getTracks());this._streams[A.id]=ge,this._reverseStreams[ge.id]=A,A=ge}_.apply(this,[A])};var b=N.RTCPeerConnection.prototype.removeStream;N.RTCPeerConnection.prototype.removeStream=function(A){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},b.apply(this,[this._streams[A.id]||A]),delete this._reverseStreams[this._streams[A.id]?this._streams[A.id].id:A.id],delete this._streams[A.id]},N.RTCPeerConnection.prototype.addTrack=function(A,H){var ge=this;if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var Ee=[].slice.call(arguments,1);if(Ee.length!==1||!Ee[0].getTracks().find(function(oe){return oe===A}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(oe){return oe.track===A}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var Se=this._streams[H.id];if(Se)Se.addTrack(A),Promise.resolve().then(function(){ge.dispatchEvent(new Event("negotiationneeded"))});else{var ue=new N.MediaStream([A]);this._streams[H.id]=ue,this._reverseStreams[ue.id]=H,this.addStream(ue)}return this.getSenders().find(function(oe){return oe.track===A})},["createOffer","createAnswer"].forEach(function(A){var H=N.RTCPeerConnection.prototype[A];N.RTCPeerConnection.prototype[A]=function(){var ge=this,Ee=arguments;return arguments.length&&typeof arguments[0]=="function"?H.apply(this,[function(Se){var ue=Y(ge,Se);Ee[0].apply(null,[ue])},function(Se){Ee[1]&&Ee[1].apply(null,Se)},arguments[2]]):H.apply(this,arguments).then(function(Se){return Y(ge,Se)})}});var y=N.RTCPeerConnection.prototype.setLocalDescription;N.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=L(this,arguments[0]),y.apply(this,arguments)):y.apply(this,arguments)};var M=Object.getOwnPropertyDescriptor(N.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(N.RTCPeerConnection.prototype,"localDescription",{get:function(){var A=M.get.apply(this);return A.type===""?A:Y(this,A)}}),N.RTCPeerConnection.prototype.removeTrack=function(A){var H=this;if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!A._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(A._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var ge=void 0;Object.keys(this._streams).forEach(function(Ee){H._streams[Ee].getTracks().find(function(Se){return A.track===Se})&&(ge=H._streams[Ee])}),ge&&(ge.getTracks().length===1?this.removeStream(this._reverseStreams[ge.id]):ge.removeTrack(A.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Y(A,H){var ge=H.sdp;return Object.keys(A._reverseStreams||[]).forEach(function(Ee){var Se=A._reverseStreams[Ee];ge=ge.replace(new RegExp(A._streams[Se.id].id,"g"),Se.id)}),new RTCSessionDescription({type:H.type,sdp:ge})}function L(A,H){var ge=H.sdp;return Object.keys(A._reverseStreams||[]).forEach(function(Ee){var Se=A._reverseStreams[Ee],ue=A._streams[Se.id];ge=ge.replace(new RegExp(Se.id,"g"),ue.id)}),new RTCSessionDescription({type:H.type,sdp:ge})}}function U(N){if(!N.RTCPeerConnection&&N.webkitRTCPeerConnection&&(N.RTCPeerConnection=N.webkitRTCPeerConnection),N.RTCPeerConnection){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(f){var _=N.RTCPeerConnection.prototype[f];N.RTCPeerConnection.prototype[f]=function(){return arguments[0]=new(f==="addIceCandidate"?N.RTCIceCandidate:N.RTCSessionDescription)(arguments[0]),_.apply(this,arguments)}});var v=N.RTCPeerConnection.prototype.addIceCandidate;N.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?v.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}}function C(N){he.wrapPeerConnectionEvent(N,"negotiationneeded",function(v){if(v.target.signalingState==="stable")return v})}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(Ye,Te,E){function w(Re,we){Re.navigator.mediaDevices&&"getDisplayMedia"in Re.navigator.mediaDevices||Re.navigator.mediaDevices&&(typeof we=="function"?Re.navigator.mediaDevices.getDisplayMedia=function(he){return we(he).then(function(Me){var nt=he.video&&he.video.width,Ne=he.video&&he.video.height;return he.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:Me,maxFrameRate:he.video&&he.video.frameRate||3}},nt&&(he.video.mandatory.maxWidth=nt),Ne&&(he.video.mandatory.maxHeight=Ne),Re.navigator.mediaDevices.getUserMedia(he)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}Object.defineProperty(E,"__esModule",{value:!0}),E.shimGetDisplayMedia=w},{}],5:[function(Ye,Te,E){Object.defineProperty(E,"__esModule",{value:!0});var w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(nt){return typeof nt}:function(nt){return nt&&typeof Symbol=="function"&&nt.constructor===Symbol&&nt!==Symbol.prototype?"symbol":typeof nt};E.shimGetUserMedia=Me;var Re=we(Ye("../utils.js"));function we(nt){if(nt&&nt.__esModule)return nt;var Ne={};if(nt!=null)for(var W in nt)Object.prototype.hasOwnProperty.call(nt,W)&&(Ne[W]=nt[W]);return Ne.default=nt,Ne}var he=Re.log;function Me(nt){var Ne=nt&&nt.navigator;if(Ne.mediaDevices){var W=Re.detectBrowser(nt),Q=function(C){if((C===void 0?"undefined":w(C))!=="object"||C.mandatory||C.optional)return C;var N={};return Object.keys(C).forEach(function(v){if(v!=="require"&&v!=="advanced"&&v!=="mediaSource"){var f=w(C[v])==="object"?C[v]:{ideal:C[v]};f.exact!==void 0&&typeof f.exact=="number"&&(f.min=f.max=f.exact);var _=function(y,M){return y?y+M.charAt(0).toUpperCase()+M.slice(1):M==="deviceId"?"sourceId":M};if(f.ideal!==void 0){N.optional=N.optional||[];var b={};typeof f.ideal=="number"?(b[_("min",v)]=f.ideal,N.optional.push(b),(b={})[_("max",v)]=f.ideal,N.optional.push(b)):(b[_("",v)]=f.ideal,N.optional.push(b))}f.exact!==void 0&&typeof f.exact!="number"?(N.mandatory=N.mandatory||{},N.mandatory[_("",v)]=f.exact):["min","max"].forEach(function(y){f[y]!==void 0&&(N.mandatory=N.mandatory||{},N.mandatory[_(y,v)]=f[y])})}}),C.advanced&&(N.optional=(N.optional||[]).concat(C.advanced)),N},se=function(C,N){if(W.version>=61)return N(C);if((C=JSON.parse(JSON.stringify(C)))&&w(C.audio)==="object"){var v=function(y,M,Y){M in y&&!(Y in y)&&(y[Y]=y[M],delete y[M])};v((C=JSON.parse(JSON.stringify(C))).audio,"autoGainControl","googAutoGainControl"),v(C.audio,"noiseSuppression","googNoiseSuppression"),C.audio=Q(C.audio)}if(C&&w(C.video)==="object"){var f=C.video.facingMode;f=f&&((f===void 0?"undefined":w(f))==="object"?f:{ideal:f});var _=W.version<66;if(f&&(f.exact==="user"||f.exact==="environment"||f.ideal==="user"||f.ideal==="environment")&&(!Ne.mediaDevices.getSupportedConstraints||!Ne.mediaDevices.getSupportedConstraints().facingMode||_)){delete C.video.facingMode;var b=void 0;if(f.exact==="environment"||f.ideal==="environment"?b=["back","rear"]:f.exact!=="user"&&f.ideal!=="user"||(b=["front"]),b)return Ne.mediaDevices.enumerateDevices().then(function(y){var M=(y=y.filter(function(Y){return Y.kind==="videoinput"})).find(function(Y){return b.some(function(L){return Y.label.toLowerCase().includes(L)})});return!M&&y.length&&b.includes("back")&&(M=y[y.length-1]),M&&(C.video.deviceId=f.exact?{exact:M.deviceId}:{ideal:M.deviceId}),C.video=Q(C.video),he("chrome: "+JSON.stringify(C)),N(C)})}C.video=Q(C.video)}return he("chrome: "+JSON.stringify(C)),N(C)},J=function(C){return W.version>=64?C:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[C.name]||C.name,message:C.message,constraint:C.constraint||C.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},G=function(C,N,v){se(C,function(f){Ne.webkitGetUserMedia(f,N,function(_){v&&v(J(_))})})};if(Ne.getUserMedia=G.bind(Ne),Ne.mediaDevices.getUserMedia){var U=Ne.mediaDevices.getUserMedia.bind(Ne.mediaDevices);Ne.mediaDevices.getUserMedia=function(C){return se(C,function(N){return U(N).then(function(v){if(N.audio&&!v.getAudioTracks().length||N.video&&!v.getVideoTracks().length)throw v.getTracks().forEach(function(f){f.stop()}),new DOMException("","NotFoundError");return v},function(v){return Promise.reject(J(v))})})}}}}},{"../utils.js":15}],6:[function(Ye,Te,E){Object.defineProperty(E,"__esModule",{value:!0});var w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(J){return typeof J}:function(J){return J&&typeof Symbol=="function"&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J};E.shimRTCIceCandidate=nt,E.shimMaxMessageSize=Ne,E.shimSendThrowTypeError=W,E.shimConnectionState=Q,E.removeAllowExtmapMixed=se;var Re=Me(Ye("sdp")),we=he(Ye("./utils"));function he(J){if(J&&J.__esModule)return J;var G={};if(J!=null)for(var U in J)Object.prototype.hasOwnProperty.call(J,U)&&(G[U]=J[U]);return G.default=J,G}function Me(J){return J&&J.__esModule?J:{default:J}}function nt(J){if(!(!J.RTCIceCandidate||J.RTCIceCandidate&&"foundation"in J.RTCIceCandidate.prototype)){var G=J.RTCIceCandidate;J.RTCIceCandidate=function(U){if((U===void 0?"undefined":w(U))==="object"&&U.candidate&&U.candidate.indexOf("a=")===0&&((U=JSON.parse(JSON.stringify(U))).candidate=U.candidate.substr(2)),U.candidate&&U.candidate.length){var C=new G(U),N=Re.default.parseCandidate(U.candidate),v=Object.assign(C,N);return v.toJSON=function(){return{candidate:v.candidate,sdpMid:v.sdpMid,sdpMLineIndex:v.sdpMLineIndex,usernameFragment:v.usernameFragment}},v}return new G(U)},J.RTCIceCandidate.prototype=G.prototype,we.wrapPeerConnectionEvent(J,"icecandidate",function(U){return U.candidate&&Object.defineProperty(U,"candidate",{value:new J.RTCIceCandidate(U.candidate),writable:"false"}),U})}}function Ne(J){if(!J.RTCSctpTransport&&J.RTCPeerConnection){var G=we.detectBrowser(J);"sctp"in J.RTCPeerConnection.prototype||Object.defineProperty(J.RTCPeerConnection.prototype,"sctp",{get:function(){return this._sctp===void 0?null:this._sctp}});var U=function(_){if(!_||!_.sdp)return!1;var b=Re.default.splitSections(_.sdp);return b.shift(),b.some(function(y){var M=Re.default.parseMLine(y);return M&&M.kind==="application"&&M.protocol.indexOf("SCTP")!==-1})},C=function(_){var b=_.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(b===null||b.length<2)return-1;var y=parseInt(b[1],10);return y!=y?-1:y},N=function(_){var b=65536;return G.browser==="firefox"&&(b=G.version<57?_===-1?16384:2147483637:G.version<60?G.version===57?65535:65536:2147483637),b},v=function(_,b){var y=65536;G.browser==="firefox"&&G.version===57&&(y=65535);var M=Re.default.matchPrefix(_.sdp,"a=max-message-size:");return M.length>0?y=parseInt(M[0].substr(19),10):G.browser==="firefox"&&b!==-1&&(y=2147483637),y},f=J.RTCPeerConnection.prototype.setRemoteDescription;J.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,U(arguments[0])){var _=C(arguments[0]),b=N(_),y=v(arguments[0],_),M=void 0;M=b===0&&y===0?Number.POSITIVE_INFINITY:b===0||y===0?Math.max(b,y):Math.min(b,y);var Y={};Object.defineProperty(Y,"maxMessageSize",{get:function(){return M}}),this._sctp=Y}return f.apply(this,arguments)}}}function W(J){if(J.RTCPeerConnection&&"createDataChannel"in J.RTCPeerConnection.prototype){var G=J.RTCPeerConnection.prototype.createDataChannel;J.RTCPeerConnection.prototype.createDataChannel=function(){var C=G.apply(this,arguments);return U(C,this),C},we.wrapPeerConnectionEvent(J,"datachannel",function(C){return U(C.channel,C.target),C})}function U(C,N){var v=C.send;C.send=function(){var f=arguments[0];if(C.readyState==="open"&&N.sctp&&(f.length||f.size||f.byteLength)>N.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+N.sctp.maxMessageSize+" bytes)");return v.apply(C,arguments)}}}function Q(J){if(J.RTCPeerConnection&&!("connectionState"in J.RTCPeerConnection.prototype)){var G=J.RTCPeerConnection.prototype;Object.defineProperty(G,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(G,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(U){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),U&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=U)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(U){var C=G[U];G[U]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(N){var v=N.target;if(v._lastConnectionState!==v.connectionState){v._lastConnectionState=v.connectionState;var f=new Event("connectionstatechange",N);v.dispatchEvent(f)}return N},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),C.apply(this,arguments)}})}}function se(J){if(J.RTCPeerConnection){var G=we.detectBrowser(J);if(!(G.browser==="chrome"&&G.version>=71)){var U=J.RTCPeerConnection.prototype.setRemoteDescription;J.RTCPeerConnection.prototype.setRemoteDescription=function(C){return C&&C.sdp&&C.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1&&(C.sdp=C.sdp.split(`
`).filter(function(N){return N.trim()!=="a=extmap-allow-mixed"}).join(`
`)),U.apply(this,arguments)}}}}},{"./utils":15,sdp:17}],7:[function(Ye,Te,E){Object.defineProperty(E,"__esModule",{value:!0}),E.shimGetDisplayMedia=E.shimGetUserMedia=void 0;var w=Ye("./getusermedia");Object.defineProperty(E,"shimGetUserMedia",{enumerable:!0,get:function(){return w.shimGetUserMedia}});var Re=Ye("./getdisplaymedia");Object.defineProperty(E,"shimGetDisplayMedia",{enumerable:!0,get:function(){return Re.shimGetDisplayMedia}}),E.shimPeerConnection=W,E.shimReplaceTrack=Q;var we=Ne(Ye("../utils")),he=Ye("./filtericeservers"),Me=nt(Ye("rtcpeerconnection-shim"));function nt(se){return se&&se.__esModule?se:{default:se}}function Ne(se){if(se&&se.__esModule)return se;var J={};if(se!=null)for(var G in se)Object.prototype.hasOwnProperty.call(se,G)&&(J[G]=se[G]);return J.default=se,J}function W(se){var J=we.detectBrowser(se);if(se.RTCIceGatherer&&(se.RTCIceCandidate||(se.RTCIceCandidate=function(C){return C}),se.RTCSessionDescription||(se.RTCSessionDescription=function(C){return C}),J.version<15025)){var G=Object.getOwnPropertyDescriptor(se.MediaStreamTrack.prototype,"enabled");Object.defineProperty(se.MediaStreamTrack.prototype,"enabled",{set:function(C){G.set.call(this,C);var N=new Event("enabled");N.enabled=C,this.dispatchEvent(N)}})}se.RTCRtpSender&&!("dtmf"in se.RTCRtpSender.prototype)&&Object.defineProperty(se.RTCRtpSender.prototype,"dtmf",{get:function(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=new se.RTCDtmfSender(this):this.track.kind==="video"&&(this._dtmf=null)),this._dtmf}}),se.RTCDtmfSender&&!se.RTCDTMFSender&&(se.RTCDTMFSender=se.RTCDtmfSender);var U=(0,Me.default)(se,J.version);se.RTCPeerConnection=function(C){return C&&C.iceServers&&(C.iceServers=(0,he.filterIceServers)(C.iceServers,J.version),we.log("ICE servers after filtering:",C.iceServers)),new U(C)},se.RTCPeerConnection.prototype=U.prototype}function Q(se){se.RTCRtpSender&&!("replaceTrack"in se.RTCRtpSender.prototype)&&(se.RTCRtpSender.prototype.replaceTrack=se.RTCRtpSender.prototype.setTrack)}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(Ye,Te,E){Object.defineProperty(E,"__esModule",{value:!0}),E.filterIceServers=we;var w=Re(Ye("../utils"));function Re(he){if(he&&he.__esModule)return he;var Me={};if(he!=null)for(var nt in he)Object.prototype.hasOwnProperty.call(he,nt)&&(Me[nt]=he[nt]);return Me.default=he,Me}function we(he,Me){var nt=!1;return(he=JSON.parse(JSON.stringify(he))).filter(function(Ne){if(Ne&&(Ne.urls||Ne.url)){var W=Ne.urls||Ne.url;Ne.url&&!Ne.urls&&w.deprecated("RTCIceServer.url","RTCIceServer.urls");var Q=typeof W=="string";return Q&&(W=[W]),W=W.filter(function(se){if(se.indexOf("stun:")===0)return!1;var J=se.startsWith("turn")&&!se.startsWith("turn:[")&&se.includes("transport=udp");return J&&!nt?(nt=!0,!0):J&&!nt}),delete Ne.url,Ne.urls=Q?W[0]:W,!!W.length}})}},{"../utils":15}],9:[function(Ye,Te,E){function w(Re){"getDisplayMedia"in Re.navigator&&Re.navigator.mediaDevices&&(Re.navigator.mediaDevices&&"getDisplayMedia"in Re.navigator.mediaDevices||(Re.navigator.mediaDevices.getDisplayMedia=Re.navigator.getDisplayMedia.bind(Re.navigator)))}Object.defineProperty(E,"__esModule",{value:!0}),E.shimGetDisplayMedia=w},{}],10:[function(Ye,Te,E){function w(Re){var we=Re&&Re.navigator,he=function(nt){return{name:{PermissionDeniedError:"NotAllowedError"}[nt.name]||nt.name,message:nt.message,constraint:nt.constraint,toString:function(){return this.name}}},Me=we.mediaDevices.getUserMedia.bind(we.mediaDevices);we.mediaDevices.getUserMedia=function(nt){return Me(nt).catch(function(Ne){return Promise.reject(he(Ne))})}}Object.defineProperty(E,"__esModule",{value:!0}),E.shimGetUserMedia=w},{}],11:[function(Ye,Te,E){Object.defineProperty(E,"__esModule",{value:!0}),E.shimGetDisplayMedia=E.shimGetUserMedia=void 0;var w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},Re=Ye("./getusermedia");Object.defineProperty(E,"shimGetUserMedia",{enumerable:!0,get:function(){return Re.shimGetUserMedia}});var we=Ye("./getdisplaymedia");Object.defineProperty(E,"shimGetDisplayMedia",{enumerable:!0,get:function(){return we.shimGetDisplayMedia}}),E.shimOnTrack=nt,E.shimPeerConnection=Ne,E.shimSenderGetStats=W,E.shimReceiverGetStats=Q,E.shimRemoveStream=se,E.shimRTCDataChannel=J;var he=Me(Ye("../utils"));function Me(G){if(G&&G.__esModule)return G;var U={};if(G!=null)for(var C in G)Object.prototype.hasOwnProperty.call(G,C)&&(U[C]=G[C]);return U.default=G,U}function nt(G){(G===void 0?"undefined":w(G))==="object"&&G.RTCTrackEvent&&"receiver"in G.RTCTrackEvent.prototype&&!("transceiver"in G.RTCTrackEvent.prototype)&&Object.defineProperty(G.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function Ne(G){var U=he.detectBrowser(G);if((G===void 0?"undefined":w(G))==="object"&&(G.RTCPeerConnection||G.mozRTCPeerConnection)){!G.RTCPeerConnection&&G.mozRTCPeerConnection&&(G.RTCPeerConnection=G.mozRTCPeerConnection),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(f){var _=G.RTCPeerConnection.prototype[f];G.RTCPeerConnection.prototype[f]=function(){return arguments[0]=new(f==="addIceCandidate"?G.RTCIceCandidate:G.RTCSessionDescription)(arguments[0]),_.apply(this,arguments)}});var C=G.RTCPeerConnection.prototype.addIceCandidate;G.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?C.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var N={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},v=G.RTCPeerConnection.prototype.getStats;G.RTCPeerConnection.prototype.getStats=function(f,_,b){return v.apply(this,[f||null]).then(function(y){if(U.version<53&&!_)try{y.forEach(function(M){M.type=N[M.type]||M.type})}catch(M){if(M.name!=="TypeError")throw M;y.forEach(function(Y,L){y.set(L,Object.assign({},Y,{type:N[Y.type]||Y.type}))})}return y}).then(_,b)}}}function W(G){if((G===void 0?"undefined":w(G))==="object"&&G.RTCPeerConnection&&G.RTCRtpSender&&(!G.RTCRtpSender||!("getStats"in G.RTCRtpSender.prototype))){var U=G.RTCPeerConnection.prototype.getSenders;U&&(G.RTCPeerConnection.prototype.getSenders=function(){var N=this,v=U.apply(this,[]);return v.forEach(function(f){return f._pc=N}),v});var C=G.RTCPeerConnection.prototype.addTrack;C&&(G.RTCPeerConnection.prototype.addTrack=function(){var N=C.apply(this,arguments);return N._pc=this,N}),G.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function Q(G){if((G===void 0?"undefined":w(G))==="object"&&G.RTCPeerConnection&&G.RTCRtpSender&&(!G.RTCRtpSender||!("getStats"in G.RTCRtpReceiver.prototype))){var U=G.RTCPeerConnection.prototype.getReceivers;U&&(G.RTCPeerConnection.prototype.getReceivers=function(){var C=this,N=U.apply(this,[]);return N.forEach(function(v){return v._pc=C}),N}),he.wrapPeerConnectionEvent(G,"track",function(C){return C.receiver._pc=C.srcElement,C}),G.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function se(G){G.RTCPeerConnection&&!("removeStream"in G.RTCPeerConnection.prototype)&&(G.RTCPeerConnection.prototype.removeStream=function(U){var C=this;he.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(N){N.track&&U.getTracks().includes(N.track)&&C.removeTrack(N)})})}function J(G){G.DataChannel&&!G.RTCDataChannel&&(G.RTCDataChannel=G.DataChannel)}},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(Ye,Te,E){function w(Re,we){Re.navigator.mediaDevices&&"getDisplayMedia"in Re.navigator.mediaDevices||Re.navigator.mediaDevices&&(Re.navigator.mediaDevices.getDisplayMedia=function(he){if(!he||!he.video){var Me=new DOMException("getDisplayMedia without video constraints is undefined");return Me.name="NotFoundError",Me.code=8,Promise.reject(Me)}return he.video===!0?he.video={mediaSource:we}:he.video.mediaSource=we,Re.navigator.mediaDevices.getUserMedia(he)})}Object.defineProperty(E,"__esModule",{value:!0}),E.shimGetDisplayMedia=w},{}],13:[function(Ye,Te,E){Object.defineProperty(E,"__esModule",{value:!0});var w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Me){return typeof Me}:function(Me){return Me&&typeof Symbol=="function"&&Me.constructor===Symbol&&Me!==Symbol.prototype?"symbol":typeof Me};E.shimGetUserMedia=he;var Re=we(Ye("../utils"));function we(Me){if(Me&&Me.__esModule)return Me;var nt={};if(Me!=null)for(var Ne in Me)Object.prototype.hasOwnProperty.call(Me,Ne)&&(nt[Ne]=Me[Ne]);return nt.default=Me,nt}function he(Me){var nt=Re.detectBrowser(Me),Ne=Me&&Me.navigator,W=Me&&Me.MediaStreamTrack;if(Ne.getUserMedia=function(U,C,N){Re.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),Ne.mediaDevices.getUserMedia(U).then(C,N)},!(nt.version>55&&"autoGainControl"in Ne.mediaDevices.getSupportedConstraints())){var Q=function(U,C,N){C in U&&!(N in U)&&(U[N]=U[C],delete U[C])},se=Ne.mediaDevices.getUserMedia.bind(Ne.mediaDevices);if(Ne.mediaDevices.getUserMedia=function(U){return(U===void 0?"undefined":w(U))==="object"&&w(U.audio)==="object"&&(U=JSON.parse(JSON.stringify(U)),Q(U.audio,"autoGainControl","mozAutoGainControl"),Q(U.audio,"noiseSuppression","mozNoiseSuppression")),se(U)},W&&W.prototype.getSettings){var J=W.prototype.getSettings;W.prototype.getSettings=function(){var U=J.apply(this,arguments);return Q(U,"mozAutoGainControl","autoGainControl"),Q(U,"mozNoiseSuppression","noiseSuppression"),U}}if(W&&W.prototype.applyConstraints){var G=W.prototype.applyConstraints;W.prototype.applyConstraints=function(U){return this.kind==="audio"&&(U===void 0?"undefined":w(U))==="object"&&(U=JSON.parse(JSON.stringify(U)),Q(U,"autoGainControl","mozAutoGainControl"),Q(U,"noiseSuppression","mozNoiseSuppression")),G.apply(this,[U])}}}}},{"../utils":15}],14:[function(Ye,Te,E){Object.defineProperty(E,"__esModule",{value:!0});var w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G};E.shimLocalStreamsAPI=he,E.shimRemoteStreamsAPI=Me,E.shimCallbacksAPI=nt,E.shimGetUserMedia=Ne,E.shimConstraints=W,E.shimRTCIceServerUrls=Q,E.shimTrackEventTransceiver=se,E.shimCreateOfferLegacy=J;var Re=we(Ye("../utils"));function we(G){if(G&&G.__esModule)return G;var U={};if(G!=null)for(var C in G)Object.prototype.hasOwnProperty.call(G,C)&&(U[C]=G[C]);return U.default=G,U}function he(G){if((G===void 0?"undefined":w(G))==="object"&&G.RTCPeerConnection){if("getLocalStreams"in G.RTCPeerConnection.prototype||(G.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in G.RTCPeerConnection.prototype)){var U=G.RTCPeerConnection.prototype.addTrack;G.RTCPeerConnection.prototype.addStream=function(C){var N=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(C)||this._localStreams.push(C),C.getTracks().forEach(function(v){return U.call(N,v,C)})},G.RTCPeerConnection.prototype.addTrack=function(C,N){return N&&(this._localStreams?this._localStreams.includes(N)||this._localStreams.push(N):this._localStreams=[N]),U.call(this,C,N)}}"removeStream"in G.RTCPeerConnection.prototype||(G.RTCPeerConnection.prototype.removeStream=function(C){var N=this;this._localStreams||(this._localStreams=[]);var v=this._localStreams.indexOf(C);if(v!==-1){this._localStreams.splice(v,1);var f=C.getTracks();this.getSenders().forEach(function(_){f.includes(_.track)&&N.removeTrack(_)})}})}}function Me(G){if((G===void 0?"undefined":w(G))==="object"&&G.RTCPeerConnection&&("getRemoteStreams"in G.RTCPeerConnection.prototype||(G.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in G.RTCPeerConnection.prototype))){Object.defineProperty(G.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(C){var N=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=C),this.addEventListener("track",this._onaddstreampoly=function(v){v.streams.forEach(function(f){if(N._remoteStreams||(N._remoteStreams=[]),!N._remoteStreams.includes(f)){N._remoteStreams.push(f);var _=new Event("addstream");_.stream=f,N.dispatchEvent(_)}})})}});var U=G.RTCPeerConnection.prototype.setRemoteDescription;G.RTCPeerConnection.prototype.setRemoteDescription=function(){var C=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(N){N.streams.forEach(function(v){if(C._remoteStreams||(C._remoteStreams=[]),!(C._remoteStreams.indexOf(v)>=0)){C._remoteStreams.push(v);var f=new Event("addstream");f.stream=v,C.dispatchEvent(f)}})}),U.apply(C,arguments)}}}function nt(G){if((G===void 0?"undefined":w(G))==="object"&&G.RTCPeerConnection){var U=G.RTCPeerConnection.prototype,C=U.createOffer,N=U.createAnswer,v=U.setLocalDescription,f=U.setRemoteDescription,_=U.addIceCandidate;U.createOffer=function(y,M){var Y=C.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return M?(Y.then(y,M),Promise.resolve()):Y},U.createAnswer=function(y,M){var Y=N.apply(this,[arguments.length>=2?arguments[2]:arguments[0]]);return M?(Y.then(y,M),Promise.resolve()):Y};var b=function(y,M,Y){var L=v.apply(this,[y]);return Y?(L.then(M,Y),Promise.resolve()):L};U.setLocalDescription=b,U.setRemoteDescription=b=function(y,M,Y){var L=f.apply(this,[y]);return Y?(L.then(M,Y),Promise.resolve()):L},U.addIceCandidate=b=function(y,M,Y){var L=_.apply(this,[y]);return Y?(L.then(M,Y),Promise.resolve()):L}}}function Ne(G){var U=G&&G.navigator;if(U.mediaDevices&&U.mediaDevices.getUserMedia){var C=U.mediaDevices,N=C.getUserMedia.bind(C);U.mediaDevices.getUserMedia=function(v){return N(W(v))}}!U.getUserMedia&&U.mediaDevices&&U.mediaDevices.getUserMedia&&(U.getUserMedia=(function(v,f,_){U.mediaDevices.getUserMedia(v).then(f,_)}).bind(U))}function W(G){return G&&G.video!==void 0?Object.assign({},G,{video:Re.compactObject(G.video)}):G}function Q(G){var U=G.RTCPeerConnection;G.RTCPeerConnection=function(C,N){if(C&&C.iceServers){for(var v=[],f=0;f<C.iceServers.length;f++){var _=C.iceServers[f];!_.hasOwnProperty("urls")&&_.hasOwnProperty("url")?(Re.deprecated("RTCIceServer.url","RTCIceServer.urls"),(_=JSON.parse(JSON.stringify(_))).urls=_.url,delete _.url,v.push(_)):v.push(C.iceServers[f])}C.iceServers=v}return new U(C,N)},G.RTCPeerConnection.prototype=U.prototype,"generateCertificate"in G.RTCPeerConnection&&Object.defineProperty(G.RTCPeerConnection,"generateCertificate",{get:function(){return U.generateCertificate}})}function se(G){(G===void 0?"undefined":w(G))==="object"&&G.RTCPeerConnection&&"receiver"in G.RTCTrackEvent.prototype&&!G.RTCTransceiver&&Object.defineProperty(G.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function J(G){var U=G.RTCPeerConnection.prototype.createOffer;G.RTCPeerConnection.prototype.createOffer=function(C){if(C){C.offerToReceiveAudio!==void 0&&(C.offerToReceiveAudio=!!C.offerToReceiveAudio);var N=this.getTransceivers().find(function(f){return f.receiver.track.kind==="audio"});C.offerToReceiveAudio===!1&&N?N.direction==="sendrecv"?N.setDirection?N.setDirection("sendonly"):N.direction="sendonly":N.direction==="recvonly"&&(N.setDirection?N.setDirection("inactive"):N.direction="inactive"):C.offerToReceiveAudio!==!0||N||this.addTransceiver("audio"),C.offerToReceiveVideo!==void 0&&(C.offerToReceiveVideo=!!C.offerToReceiveVideo);var v=this.getTransceivers().find(function(f){return f.receiver.track.kind==="video"});C.offerToReceiveVideo===!1&&v?v.direction==="sendrecv"?v.setDirection?v.setDirection("sendonly"):v.direction="sendonly":v.direction==="recvonly"&&(v.setDirection?v.setDirection("inactive"):v.direction="inactive"):C.offerToReceiveVideo!==!0||v||this.addTransceiver("video")}return U.apply(this,arguments)}}},{"../utils":15}],15:[function(Ye,Te,E){Object.defineProperty(E,"__esModule",{value:!0});var w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N};function Re(N,v,f){return v in N?Object.defineProperty(N,v,{value:f,enumerable:!0,configurable:!0,writable:!0}):N[v]=f,N}E.extractVersion=Me,E.wrapPeerConnectionEvent=nt,E.disableLog=Ne,E.disableWarnings=W,E.log=Q,E.deprecated=se,E.detectBrowser=J,E.compactObject=G,E.walkStats=U,E.filterStats=C;var we=!0,he=!0;function Me(N,v,f){var _=N.match(v);return _&&_.length>=f&&parseInt(_[f],10)}function nt(N,v,f){if(N.RTCPeerConnection){var _=N.RTCPeerConnection.prototype,b=_.addEventListener;_.addEventListener=function(M,Y){if(M!==v)return b.apply(this,arguments);var L=function(A){var H=f(A);H&&Y(H)};return this._eventMap=this._eventMap||{},this._eventMap[Y]=L,b.apply(this,[M,L])};var y=_.removeEventListener;_.removeEventListener=function(M,Y){if(M!==v||!this._eventMap||!this._eventMap[Y])return y.apply(this,arguments);var L=this._eventMap[Y];return delete this._eventMap[Y],y.apply(this,[M,L])},Object.defineProperty(_,"on"+v,{get:function(){return this["_on"+v]},set:function(M){this["_on"+v]&&(this.removeEventListener(v,this["_on"+v]),delete this["_on"+v]),M&&this.addEventListener(v,this["_on"+v]=M)},enumerable:!0,configurable:!0})}}function Ne(N){return typeof N!="boolean"?new Error("Argument type: "+(N===void 0?"undefined":w(N))+". Please use a boolean."):(we=N,N?"adapter.js logging disabled":"adapter.js logging enabled")}function W(N){return typeof N!="boolean"?new Error("Argument type: "+(N===void 0?"undefined":w(N))+". Please use a boolean."):(he=!N,"adapter.js deprecation warnings "+(N?"disabled":"enabled"))}function Q(){if((typeof window>"u"?"undefined":w(window))==="object"){if(we)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function se(N,v){he&&console.warn(N+" is deprecated, please use "+v+" instead.")}function J(N){var v=N.navigator,f={browser:null,version:null};if(N===void 0||!N.navigator)return f.browser="Not a browser.",f;if(v.mozGetUserMedia)f.browser="firefox",f.version=Me(v.userAgent,/Firefox\/(\d+)\./,1);else if(v.webkitGetUserMedia||N.isSecureContext===!1&&N.webkitRTCPeerConnection&&!N.RTCIceGatherer)f.browser="chrome",f.version=Me(v.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(v.mediaDevices&&v.userAgent.match(/Edge\/(\d+).(\d+)$/))f.browser="edge",f.version=Me(v.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!N.RTCPeerConnection||!v.userAgent.match(/AppleWebKit\/(\d+)\./))return f.browser="Not a supported browser.",f;f.browser="safari",f.version=Me(v.userAgent,/AppleWebKit\/(\d+)\./,1)}return f}function G(N){return(N===void 0?"undefined":w(N))!=="object"?N:Object.keys(N).reduce(function(v,f){var _=w(N[f])==="object",b=_?G(N[f]):N[f],y=_&&!Object.keys(b).length;return b===void 0||y?v:Object.assign(v,Re({},f,b))},{})}function U(N,v,f){v&&!f.has(v.id)&&(f.set(v.id,v),Object.keys(v).forEach(function(_){_.endsWith("Id")?U(N,N.get(v[_]),f):_.endsWith("Ids")&&v[_].forEach(function(b){U(N,N.get(b),f)})}))}function C(N,v,f){var _=f?"outbound-rtp":"inbound-rtp",b=new Map;if(v===null)return b;var y=[];return N.forEach(function(M){M.type==="track"&&M.trackIdentifier===v.id&&y.push(M)}),y.forEach(function(M){N.forEach(function(Y){Y.type===_&&Y.trackId===M.id&&U(N,Y,b)})}),b}},{}],16:[function(Ye,Te,E){var w=Ye("sdp");function Re(Q){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[Q.type]||Q.type}function we(Q,se,J,G,U){var C=w.writeRtpDescription(Q.kind,se);if(C+=w.writeIceParameters(Q.iceGatherer.getLocalParameters()),C+=w.writeDtlsParameters(Q.dtlsTransport.getLocalParameters(),J==="offer"?"actpass":U||"active"),C+="a=mid:"+Q.mid+`\r
`,C+=Q.rtpSender&&Q.rtpReceiver?`a=sendrecv\r
`:Q.rtpSender?`a=sendonly\r
`:Q.rtpReceiver?`a=recvonly\r
`:`a=inactive\r
`,Q.rtpSender){var N=Q.rtpSender._initialTrackId||Q.rtpSender.track.id;Q.rtpSender._initialTrackId=N;var v="msid:"+(G?G.id:"-")+" "+N+`\r
`;C+="a="+v,C+="a=ssrc:"+Q.sendEncodingParameters[0].ssrc+" "+v,Q.sendEncodingParameters[0].rtx&&(C+="a=ssrc:"+Q.sendEncodingParameters[0].rtx.ssrc+" "+v,C+="a=ssrc-group:FID "+Q.sendEncodingParameters[0].ssrc+" "+Q.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return C+="a=ssrc:"+Q.sendEncodingParameters[0].ssrc+" cname:"+w.localCName+`\r
`,Q.rtpSender&&Q.sendEncodingParameters[0].rtx&&(C+="a=ssrc:"+Q.sendEncodingParameters[0].rtx.ssrc+" cname:"+w.localCName+`\r
`),C}function he(Q,se){var J=!1;return(Q=JSON.parse(JSON.stringify(Q))).filter(function(G){if(G&&(G.urls||G.url)){var U=G.urls||G.url;G.url&&!G.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var C=typeof U=="string";return C&&(U=[U]),U=U.filter(function(N){return N.indexOf("turn:")!==0||N.indexOf("transport=udp")===-1||N.indexOf("turn:[")!==-1||J?N.indexOf("stun:")===0&&se>=14393&&N.indexOf("?transport=udp")===-1:(J=!0,!0)}),delete G.url,G.urls=C?U[0]:U,!!U.length}})}function Me(Q,se){var J={codecs:[],headerExtensions:[],fecMechanisms:[]},G=function(C,N){C=parseInt(C,10);for(var v=0;v<N.length;v++)if(N[v].payloadType===C||N[v].preferredPayloadType===C)return N[v]},U=function(C,N,v,f){var _=G(C.parameters.apt,v),b=G(N.parameters.apt,f);return _&&b&&_.name.toLowerCase()===b.name.toLowerCase()};return Q.codecs.forEach(function(C){for(var N=0;N<se.codecs.length;N++){var v=se.codecs[N];if(C.name.toLowerCase()===v.name.toLowerCase()&&C.clockRate===v.clockRate){if(C.name.toLowerCase()==="rtx"&&C.parameters&&v.parameters.apt&&!U(C,v,Q.codecs,se.codecs))continue;(v=JSON.parse(JSON.stringify(v))).numChannels=Math.min(C.numChannels,v.numChannels),J.codecs.push(v),v.rtcpFeedback=v.rtcpFeedback.filter(function(f){for(var _=0;_<C.rtcpFeedback.length;_++)if(C.rtcpFeedback[_].type===f.type&&C.rtcpFeedback[_].parameter===f.parameter)return!0;return!1});break}}}),Q.headerExtensions.forEach(function(C){for(var N=0;N<se.headerExtensions.length;N++){var v=se.headerExtensions[N];if(C.uri===v.uri){J.headerExtensions.push(v);break}}}),J}function nt(Q,se,J){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[se][Q].indexOf(J)!==-1}function Ne(Q,se){var J=Q.getRemoteCandidates().find(function(G){return se.foundation===G.foundation&&se.ip===G.ip&&se.port===G.port&&se.priority===G.priority&&se.protocol===G.protocol&&se.type===G.type});return J||Q.addRemoteCandidate(se),!J}function W(Q,se){var J=new Error(se);return J.name=Q,J.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[Q],J}Te.exports=function(Q,se){function J(v,f){f.addTrack(v),f.dispatchEvent(new Q.MediaStreamTrackEvent("addtrack",{track:v}))}function G(v,f){f.removeTrack(v),f.dispatchEvent(new Q.MediaStreamTrackEvent("removetrack",{track:v}))}function U(v,f,_,b){var y=new Event("track");y.track=f,y.receiver=_,y.transceiver={receiver:_},y.streams=b,Q.setTimeout(function(){v._dispatchEvent("track",y)})}var C=function(v){var f=this,_=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(y){f[y]=_[y].bind(_)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",v=JSON.parse(JSON.stringify(v||{})),this.usingBundle=v.bundlePolicy==="max-bundle",v.rtcpMuxPolicy==="negotiate")throw W("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(v.rtcpMuxPolicy||(v.rtcpMuxPolicy="require"),v.iceTransportPolicy){case"all":case"relay":break;default:v.iceTransportPolicy="all"}switch(v.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:v.bundlePolicy="balanced"}if(v.iceServers=he(v.iceServers||[],se),this._iceGatherers=[],v.iceCandidatePoolSize)for(var b=v.iceCandidatePoolSize;b>0;b--)this._iceGatherers.push(new Q.RTCIceGatherer({iceServers:v.iceServers,gatherPolicy:v.iceTransportPolicy}));else v.iceCandidatePoolSize=0;this._config=v,this.transceivers=[],this._sdpSessionId=w.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(C.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(C.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),C.prototype.onicecandidate=null,C.prototype.onaddstream=null,C.prototype.ontrack=null,C.prototype.onremovestream=null,C.prototype.onsignalingstatechange=null,C.prototype.oniceconnectionstatechange=null,C.prototype.onconnectionstatechange=null,C.prototype.onicegatheringstatechange=null,C.prototype.onnegotiationneeded=null,C.prototype.ondatachannel=null,C.prototype._dispatchEvent=function(v,f){this._isClosed||(this.dispatchEvent(f),typeof this["on"+v]=="function"&&this["on"+v](f))},C.prototype._emitGatheringStateChange=function(){var v=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",v)},C.prototype.getConfiguration=function(){return this._config},C.prototype.getLocalStreams=function(){return this.localStreams},C.prototype.getRemoteStreams=function(){return this.remoteStreams},C.prototype._createTransceiver=function(v,f){var _={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:v,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&this.transceivers.length>0)_.iceTransport=this.transceivers[0].iceTransport,_.dtlsTransport=this.transceivers[0].dtlsTransport;else{var b=this._createIceAndDtlsTransports();_.iceTransport=b.iceTransport,_.dtlsTransport=b.dtlsTransport}return f||this.transceivers.push(_),_},C.prototype.addTrack=function(v,f){if(this._isClosed)throw W("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var _;if(this.transceivers.find(function(y){return y.track===v}))throw W("InvalidAccessError","Track already exists.");for(var b=0;b<this.transceivers.length;b++)this.transceivers[b].track||this.transceivers[b].kind!==v.kind||(_=this.transceivers[b]);return _||(_=this._createTransceiver(v.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(f)===-1&&this.localStreams.push(f),_.track=v,_.stream=f,_.rtpSender=new Q.RTCRtpSender(v,_.dtlsTransport),_.rtpSender},C.prototype.addStream=function(v){var f=this;if(se>=15025)v.getTracks().forEach(function(b){f.addTrack(b,v)});else{var _=v.clone();v.getTracks().forEach(function(b,y){var M=_.getTracks()[y];b.addEventListener("enabled",function(Y){M.enabled=Y.enabled})}),_.getTracks().forEach(function(b){f.addTrack(b,_)})}},C.prototype.removeTrack=function(v){if(this._isClosed)throw W("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(v instanceof Q.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var f=this.transceivers.find(function(b){return b.rtpSender===v});if(!f)throw W("InvalidAccessError","Sender was not created by this connection.");var _=f.stream;f.rtpSender.stop(),f.rtpSender=null,f.track=null,f.stream=null,this.transceivers.map(function(b){return b.stream}).indexOf(_)===-1&&this.localStreams.indexOf(_)>-1&&this.localStreams.splice(this.localStreams.indexOf(_),1),this._maybeFireNegotiationNeeded()},C.prototype.removeStream=function(v){var f=this;v.getTracks().forEach(function(_){var b=f.getSenders().find(function(y){return y.track===_});b&&f.removeTrack(b)})},C.prototype.getSenders=function(){return this.transceivers.filter(function(v){return!!v.rtpSender}).map(function(v){return v.rtpSender})},C.prototype.getReceivers=function(){return this.transceivers.filter(function(v){return!!v.rtpReceiver}).map(function(v){return v.rtpReceiver})},C.prototype._createIceGatherer=function(v,f){var _=this;if(f&&v>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var b=new Q.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(b,"state",{value:"new",writable:!0}),this.transceivers[v].bufferedCandidateEvents=[],this.transceivers[v].bufferCandidates=function(y){var M=!y.candidate||Object.keys(y.candidate).length===0;b.state=M?"completed":"gathering",_.transceivers[v].bufferedCandidateEvents!==null&&_.transceivers[v].bufferedCandidateEvents.push(y)},b.addEventListener("localcandidate",this.transceivers[v].bufferCandidates),b},C.prototype._gather=function(v,f){var _=this,b=this.transceivers[f].iceGatherer;if(!b.onlocalcandidate){var y=this.transceivers[f].bufferedCandidateEvents;this.transceivers[f].bufferedCandidateEvents=null,b.removeEventListener("localcandidate",this.transceivers[f].bufferCandidates),b.onlocalcandidate=function(M){if(!(_.usingBundle&&f>0)){var Y=new Event("icecandidate");Y.candidate={sdpMid:v,sdpMLineIndex:f};var L=M.candidate,A=!L||Object.keys(L).length===0;if(A)b.state!=="new"&&b.state!=="gathering"||(b.state="completed");else{b.state==="new"&&(b.state="gathering"),L.component=1,L.ufrag=b.getLocalParameters().usernameFragment;var H=w.writeCandidate(L);Y.candidate=Object.assign(Y.candidate,w.parseCandidate(H)),Y.candidate.candidate=H,Y.candidate.toJSON=function(){return{candidate:Y.candidate.candidate,sdpMid:Y.candidate.sdpMid,sdpMLineIndex:Y.candidate.sdpMLineIndex,usernameFragment:Y.candidate.usernameFragment}}}var ge=w.getMediaSections(_._localDescription.sdp);ge[Y.candidate.sdpMLineIndex]+=A?`a=end-of-candidates\r
`:"a="+Y.candidate.candidate+`\r
`,_._localDescription.sdp=w.getDescription(_._localDescription.sdp)+ge.join("");var Ee=_.transceivers.every(function(Se){return Se.iceGatherer&&Se.iceGatherer.state==="completed"});_.iceGatheringState!=="gathering"&&(_.iceGatheringState="gathering",_._emitGatheringStateChange()),A||_._dispatchEvent("icecandidate",Y),Ee&&(_._dispatchEvent("icecandidate",new Event("icecandidate")),_.iceGatheringState="complete",_._emitGatheringStateChange())}},Q.setTimeout(function(){y.forEach(function(M){b.onlocalcandidate(M)})},0)}},C.prototype._createIceAndDtlsTransports=function(){var v=this,f=new Q.RTCIceTransport(null);f.onicestatechange=function(){v._updateIceConnectionState(),v._updateConnectionState()};var _=new Q.RTCDtlsTransport(f);return _.ondtlsstatechange=function(){v._updateConnectionState()},_.onerror=function(){Object.defineProperty(_,"state",{value:"failed",writable:!0}),v._updateConnectionState()},{iceTransport:f,dtlsTransport:_}},C.prototype._disposeIceAndDtlsTransports=function(v){var f=this.transceivers[v].iceGatherer;f&&(delete f.onlocalcandidate,delete this.transceivers[v].iceGatherer);var _=this.transceivers[v].iceTransport;_&&(delete _.onicestatechange,delete this.transceivers[v].iceTransport);var b=this.transceivers[v].dtlsTransport;b&&(delete b.ondtlsstatechange,delete b.onerror,delete this.transceivers[v].dtlsTransport)},C.prototype._transceive=function(v,f,_){var b=Me(v.localCapabilities,v.remoteCapabilities);f&&v.rtpSender&&(b.encodings=v.sendEncodingParameters,b.rtcp={cname:w.localCName,compound:v.rtcpParameters.compound},v.recvEncodingParameters.length&&(b.rtcp.ssrc=v.recvEncodingParameters[0].ssrc),v.rtpSender.send(b)),_&&v.rtpReceiver&&b.codecs.length>0&&(v.kind==="video"&&v.recvEncodingParameters&&se<15019&&v.recvEncodingParameters.forEach(function(y){delete y.rtx}),b.encodings=v.recvEncodingParameters.length?v.recvEncodingParameters:[{}],b.rtcp={compound:v.rtcpParameters.compound},v.rtcpParameters.cname&&(b.rtcp.cname=v.rtcpParameters.cname),v.sendEncodingParameters.length&&(b.rtcp.ssrc=v.sendEncodingParameters[0].ssrc),v.rtpReceiver.receive(b))},C.prototype.setLocalDescription=function(v){var f,_,b=this;if(["offer","answer"].indexOf(v.type)===-1)return Promise.reject(W("TypeError",'Unsupported type "'+v.type+'"'));if(!nt("setLocalDescription",v.type,b.signalingState)||b._isClosed)return Promise.reject(W("InvalidStateError","Can not set local "+v.type+" in state "+b.signalingState));if(v.type==="offer")f=w.splitSections(v.sdp),_=f.shift(),f.forEach(function(M,Y){var L=w.parseRtpParameters(M);b.transceivers[Y].localCapabilities=L}),b.transceivers.forEach(function(M,Y){b._gather(M.mid,Y)});else if(v.type==="answer"){f=w.splitSections(b._remoteDescription.sdp),_=f.shift();var y=w.matchPrefix(_,"a=ice-lite").length>0;f.forEach(function(M,Y){var L=b.transceivers[Y],A=L.iceGatherer,H=L.iceTransport,ge=L.dtlsTransport,Ee=L.localCapabilities,Se=L.remoteCapabilities;if(!(w.isRejected(M)&&w.matchPrefix(M,"a=bundle-only").length===0||L.rejected)){var ue=w.getIceParameters(M,_),oe=w.getDtlsParameters(M,_);y&&(oe.role="server"),b.usingBundle&&Y!==0||(b._gather(L.mid,Y),H.state==="new"&&H.start(A,ue,y?"controlling":"controlled"),ge.state==="new"&&ge.start(oe));var be=Me(Ee,Se);b._transceive(L,be.codecs.length>0,!1)}})}return b._localDescription={type:v.type,sdp:v.sdp},b._updateSignalingState(v.type==="offer"?"have-local-offer":"stable"),Promise.resolve()},C.prototype.setRemoteDescription=function(v){var f=this;if(["offer","answer"].indexOf(v.type)===-1)return Promise.reject(W("TypeError",'Unsupported type "'+v.type+'"'));if(!nt("setRemoteDescription",v.type,f.signalingState)||f._isClosed)return Promise.reject(W("InvalidStateError","Can not set remote "+v.type+" in state "+f.signalingState));var _={};f.remoteStreams.forEach(function(H){_[H.id]=H});var b=[],y=w.splitSections(v.sdp),M=y.shift(),Y=w.matchPrefix(M,"a=ice-lite").length>0,L=w.matchPrefix(M,"a=group:BUNDLE ").length>0;f.usingBundle=L;var A=w.matchPrefix(M,"a=ice-options:")[0];return f.canTrickleIceCandidates=!!A&&A.substr(14).split(" ").indexOf("trickle")>=0,y.forEach(function(H,ge){var Ee=w.splitLines(H),Se=w.getKind(H),ue=w.isRejected(H)&&w.matchPrefix(H,"a=bundle-only").length===0,oe=Ee[0].substr(2).split(" ")[2],be=w.getDirection(H,M),Le=w.parseMsid(H),pe=w.getMid(H)||w.generateIdentifier();if(ue||Se==="application"&&(oe==="DTLS/SCTP"||oe==="UDP/DTLS/SCTP"))f.transceivers[ge]={mid:pe,kind:Se,protocol:oe,rejected:!0};else{var k,R,Fe,te,Ue,it,ee,ae,xe;!ue&&f.transceivers[ge]&&f.transceivers[ge].rejected&&(f.transceivers[ge]=f._createTransceiver(Se,!0));var Z,$,K=w.parseRtpParameters(H);ue||(Z=w.getIceParameters(H,M),($=w.getDtlsParameters(H,M)).role="client"),ee=w.parseRtpEncodingParameters(H);var X=w.parseRtcpParameters(H),B=w.matchPrefix(H,"a=end-of-candidates",M).length>0,fe=w.matchPrefix(H,"a=candidate:").map(function(st){return w.parseCandidate(st)}).filter(function(st){return st.component===1});if((v.type==="offer"||v.type==="answer")&&!ue&&L&&ge>0&&f.transceivers[ge]&&(f._disposeIceAndDtlsTransports(ge),f.transceivers[ge].iceGatherer=f.transceivers[0].iceGatherer,f.transceivers[ge].iceTransport=f.transceivers[0].iceTransport,f.transceivers[ge].dtlsTransport=f.transceivers[0].dtlsTransport,f.transceivers[ge].rtpSender&&f.transceivers[ge].rtpSender.setTransport(f.transceivers[0].dtlsTransport),f.transceivers[ge].rtpReceiver&&f.transceivers[ge].rtpReceiver.setTransport(f.transceivers[0].dtlsTransport)),v.type!=="offer"||ue)v.type!=="answer"||ue||(R=(k=f.transceivers[ge]).iceGatherer,Fe=k.iceTransport,te=k.dtlsTransport,Ue=k.rtpReceiver,it=k.sendEncodingParameters,ae=k.localCapabilities,f.transceivers[ge].recvEncodingParameters=ee,f.transceivers[ge].remoteCapabilities=K,f.transceivers[ge].rtcpParameters=X,fe.length&&Fe.state==="new"&&(!Y&&!B||L&&ge!==0?fe.forEach(function(st){Ne(k.iceTransport,st)}):Fe.setRemoteCandidates(fe)),L&&ge!==0||(Fe.state==="new"&&Fe.start(R,Z,"controlling"),te.state==="new"&&te.start($)),!Me(k.localCapabilities,k.remoteCapabilities).codecs.filter(function(st){return st.name.toLowerCase()==="rtx"}).length&&k.sendEncodingParameters[0].rtx&&delete k.sendEncodingParameters[0].rtx,f._transceive(k,be==="sendrecv"||be==="recvonly",be==="sendrecv"||be==="sendonly"),!Ue||be!=="sendrecv"&&be!=="sendonly"?delete k.rtpReceiver:(xe=Ue.track,Le?(_[Le.stream]||(_[Le.stream]=new Q.MediaStream),J(xe,_[Le.stream]),b.push([xe,Ue,_[Le.stream]])):(_.default||(_.default=new Q.MediaStream),J(xe,_.default),b.push([xe,Ue,_.default]))));else{(k=f.transceivers[ge]||f._createTransceiver(Se)).mid=pe,k.iceGatherer||(k.iceGatherer=f._createIceGatherer(ge,L)),fe.length&&k.iceTransport.state==="new"&&(!B||L&&ge!==0?fe.forEach(function(st){Ne(k.iceTransport,st)}):k.iceTransport.setRemoteCandidates(fe)),ae=Q.RTCRtpReceiver.getCapabilities(Se),se<15019&&(ae.codecs=ae.codecs.filter(function(st){return st.name!=="rtx"})),it=k.sendEncodingParameters||[{ssrc:1001*(2*ge+2)}];var Ce,Ze=!1;be==="sendrecv"||be==="sendonly"?(Ze=!k.rtpReceiver,Ue=k.rtpReceiver||new Q.RTCRtpReceiver(k.dtlsTransport,Se),Ze&&(xe=Ue.track,Le&&Le.stream==="-"||(Le?(_[Le.stream]||(_[Le.stream]=new Q.MediaStream,Object.defineProperty(_[Le.stream],"id",{get:function(){return Le.stream}})),Object.defineProperty(xe,"id",{get:function(){return Le.track}}),Ce=_[Le.stream]):(_.default||(_.default=new Q.MediaStream),Ce=_.default)),Ce&&(J(xe,Ce),k.associatedRemoteMediaStreams.push(Ce)),b.push([xe,Ue,Ce]))):k.rtpReceiver&&k.rtpReceiver.track&&(k.associatedRemoteMediaStreams.forEach(function(st){var Ie=st.getTracks().find(function(D){return D.id===k.rtpReceiver.track.id});Ie&&G(Ie,st)}),k.associatedRemoteMediaStreams=[]),k.localCapabilities=ae,k.remoteCapabilities=K,k.rtpReceiver=Ue,k.rtcpParameters=X,k.sendEncodingParameters=it,k.recvEncodingParameters=ee,f._transceive(f.transceivers[ge],!1,Ze)}}}),f._dtlsRole===void 0&&(f._dtlsRole=v.type==="offer"?"active":"passive"),f._remoteDescription={type:v.type,sdp:v.sdp},f._updateSignalingState(v.type==="offer"?"have-remote-offer":"stable"),Object.keys(_).forEach(function(H){var ge=_[H];if(ge.getTracks().length){if(f.remoteStreams.indexOf(ge)===-1){f.remoteStreams.push(ge);var Ee=new Event("addstream");Ee.stream=ge,Q.setTimeout(function(){f._dispatchEvent("addstream",Ee)})}b.forEach(function(Se){ge.id===Se[2].id&&U(f,Se[0],Se[1],[ge])})}}),b.forEach(function(H){H[2]||U(f,H[0],H[1],[])}),Q.setTimeout(function(){f&&f.transceivers&&f.transceivers.forEach(function(H){H.iceTransport&&H.iceTransport.state==="new"&&H.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),H.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},C.prototype.close=function(){this.transceivers.forEach(function(v){v.iceTransport&&v.iceTransport.stop(),v.dtlsTransport&&v.dtlsTransport.stop(),v.rtpSender&&v.rtpSender.stop(),v.rtpReceiver&&v.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},C.prototype._updateSignalingState=function(v){this.signalingState=v;var f=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",f)},C.prototype._maybeFireNegotiationNeeded=function(){var v=this;this.signalingState==="stable"&&this.needNegotiation!==!0&&(this.needNegotiation=!0,Q.setTimeout(function(){if(v.needNegotiation){v.needNegotiation=!1;var f=new Event("negotiationneeded");v._dispatchEvent("negotiationneeded",f)}},0))},C.prototype._updateIceConnectionState=function(){var v,f={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(b){b.iceTransport&&!b.rejected&&f[b.iceTransport.state]++}),v="new",f.failed>0?v="failed":f.checking>0?v="checking":f.disconnected>0?v="disconnected":f.new>0?v="new":f.connected>0?v="connected":f.completed>0&&(v="completed"),v!==this.iceConnectionState){this.iceConnectionState=v;var _=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",_)}},C.prototype._updateConnectionState=function(){var v,f={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(b){b.iceTransport&&b.dtlsTransport&&!b.rejected&&(f[b.iceTransport.state]++,f[b.dtlsTransport.state]++)}),f.connected+=f.completed,v="new",f.failed>0?v="failed":f.connecting>0?v="connecting":f.disconnected>0?v="disconnected":f.new>0?v="new":f.connected>0&&(v="connected"),v!==this.connectionState){this.connectionState=v;var _=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",_)}},C.prototype.createOffer=function(){var v=this;if(v._isClosed)return Promise.reject(W("InvalidStateError","Can not call createOffer after close"));var f=v.transceivers.filter(function(Y){return Y.kind==="audio"}).length,_=v.transceivers.filter(function(Y){return Y.kind==="video"}).length,b=arguments[0];if(b){if(b.mandatory||b.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");b.offerToReceiveAudio!==void 0&&(f=b.offerToReceiveAudio===!0?1:b.offerToReceiveAudio===!1?0:b.offerToReceiveAudio),b.offerToReceiveVideo!==void 0&&(_=b.offerToReceiveVideo===!0?1:b.offerToReceiveVideo===!1?0:b.offerToReceiveVideo)}for(v.transceivers.forEach(function(Y){Y.kind==="audio"?--f<0&&(Y.wantReceive=!1):Y.kind==="video"&&--_<0&&(Y.wantReceive=!1)});f>0||_>0;)f>0&&(v._createTransceiver("audio"),f--),_>0&&(v._createTransceiver("video"),_--);var y=w.writeSessionBoilerplate(v._sdpSessionId,v._sdpSessionVersion++);v.transceivers.forEach(function(Y,L){var A=Y.track,H=Y.kind,ge=Y.mid||w.generateIdentifier();Y.mid=ge,Y.iceGatherer||(Y.iceGatherer=v._createIceGatherer(L,v.usingBundle));var Ee=Q.RTCRtpSender.getCapabilities(H);se<15019&&(Ee.codecs=Ee.codecs.filter(function(ue){return ue.name!=="rtx"})),Ee.codecs.forEach(function(ue){ue.name==="H264"&&ue.parameters["level-asymmetry-allowed"]===void 0&&(ue.parameters["level-asymmetry-allowed"]="1"),Y.remoteCapabilities&&Y.remoteCapabilities.codecs&&Y.remoteCapabilities.codecs.forEach(function(oe){ue.name.toLowerCase()===oe.name.toLowerCase()&&ue.clockRate===oe.clockRate&&(ue.preferredPayloadType=oe.payloadType)})}),Ee.headerExtensions.forEach(function(ue){(Y.remoteCapabilities&&Y.remoteCapabilities.headerExtensions||[]).forEach(function(oe){ue.uri===oe.uri&&(ue.id=oe.id)})});var Se=Y.sendEncodingParameters||[{ssrc:1001*(2*L+1)}];A&&se>=15019&&H==="video"&&!Se[0].rtx&&(Se[0].rtx={ssrc:Se[0].ssrc+1}),Y.wantReceive&&(Y.rtpReceiver=new Q.RTCRtpReceiver(Y.dtlsTransport,H)),Y.localCapabilities=Ee,Y.sendEncodingParameters=Se}),v._config.bundlePolicy!=="max-compat"&&(y+="a=group:BUNDLE "+v.transceivers.map(function(Y){return Y.mid}).join(" ")+`\r
`),y+=`a=ice-options:trickle\r
`,v.transceivers.forEach(function(Y,L){y+=we(Y,Y.localCapabilities,"offer",Y.stream,v._dtlsRole),y+=`a=rtcp-rsize\r
`,!Y.iceGatherer||v.iceGatheringState==="new"||L!==0&&v.usingBundle||(Y.iceGatherer.getLocalCandidates().forEach(function(A){A.component=1,y+="a="+w.writeCandidate(A)+`\r
`}),Y.iceGatherer.state==="completed"&&(y+=`a=end-of-candidates\r
`))});var M=new Q.RTCSessionDescription({type:"offer",sdp:y});return Promise.resolve(M)},C.prototype.createAnswer=function(){var v=this;if(v._isClosed)return Promise.reject(W("InvalidStateError","Can not call createAnswer after close"));if(v.signalingState!=="have-remote-offer"&&v.signalingState!=="have-local-pranswer")return Promise.reject(W("InvalidStateError","Can not call createAnswer in signalingState "+v.signalingState));var f=w.writeSessionBoilerplate(v._sdpSessionId,v._sdpSessionVersion++);v.usingBundle&&(f+="a=group:BUNDLE "+v.transceivers.map(function(y){return y.mid}).join(" ")+`\r
`),f+=`a=ice-options:trickle\r
`;var _=w.getMediaSections(v._remoteDescription.sdp).length;v.transceivers.forEach(function(y,M){if(!(M+1>_)){if(y.rejected)return y.kind==="application"?f+=y.protocol==="DTLS/SCTP"?`m=application 0 DTLS/SCTP 5000\r
`:"m=application 0 "+y.protocol+` webrtc-datachannel\r
`:y.kind==="audio"?f+=`m=audio 0 UDP/TLS/RTP/SAVPF 0\r
a=rtpmap:0 PCMU/8000\r
`:y.kind==="video"&&(f+=`m=video 0 UDP/TLS/RTP/SAVPF 120\r
a=rtpmap:120 VP8/90000\r
`),void(f+=`c=IN IP4 0.0.0.0\r
a=inactive\r
a=mid:`+y.mid+`\r
`);var Y;y.stream&&(y.kind==="audio"?Y=y.stream.getAudioTracks()[0]:y.kind==="video"&&(Y=y.stream.getVideoTracks()[0]),Y&&se>=15019&&y.kind==="video"&&!y.sendEncodingParameters[0].rtx&&(y.sendEncodingParameters[0].rtx={ssrc:y.sendEncodingParameters[0].ssrc+1}));var L=Me(y.localCapabilities,y.remoteCapabilities);!L.codecs.filter(function(A){return A.name.toLowerCase()==="rtx"}).length&&y.sendEncodingParameters[0].rtx&&delete y.sendEncodingParameters[0].rtx,f+=we(y,L,"answer",y.stream,v._dtlsRole),y.rtcpParameters&&y.rtcpParameters.reducedSize&&(f+=`a=rtcp-rsize\r
`)}});var b=new Q.RTCSessionDescription({type:"answer",sdp:f});return Promise.resolve(b)},C.prototype.addIceCandidate=function(v){var f,_=this;return v&&v.sdpMLineIndex===void 0&&!v.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(b,y){if(!_._remoteDescription)return y(W("InvalidStateError","Can not add ICE candidate without a remote description"));if(v&&v.candidate!==""){var M=v.sdpMLineIndex;if(v.sdpMid){for(var Y=0;Y<_.transceivers.length;Y++)if(_.transceivers[Y].mid===v.sdpMid){M=Y;break}}var L=_.transceivers[M];if(!L)return y(W("OperationError","Can not add ICE candidate"));if(L.rejected)return b();var A=Object.keys(v.candidate).length>0?w.parseCandidate(v.candidate):{};if(A.protocol==="tcp"&&(A.port===0||A.port===9)||A.component&&A.component!==1)return b();if((M===0||M>0&&L.iceTransport!==_.transceivers[0].iceTransport)&&!Ne(L.iceTransport,A))return y(W("OperationError","Can not add ICE candidate"));var H=v.candidate.trim();H.indexOf("a=")===0&&(H=H.substr(2)),(f=w.getMediaSections(_._remoteDescription.sdp))[M]+="a="+(A.type?H:"end-of-candidates")+`\r
`,_._remoteDescription.sdp=w.getDescription(_._remoteDescription.sdp)+f.join("")}else for(var ge=0;ge<_.transceivers.length&&(_.transceivers[ge].rejected||(_.transceivers[ge].iceTransport.addRemoteCandidate({}),(f=w.getMediaSections(_._remoteDescription.sdp))[ge]+=`a=end-of-candidates\r
`,_._remoteDescription.sdp=w.getDescription(_._remoteDescription.sdp)+f.join(""),!_.usingBundle));ge++);b()})},C.prototype.getStats=function(v){if(v&&v instanceof Q.MediaStreamTrack){var f=null;if(this.transceivers.forEach(function(b){b.rtpSender&&b.rtpSender.track===v?f=b.rtpSender:b.rtpReceiver&&b.rtpReceiver.track===v&&(f=b.rtpReceiver)}),!f)throw W("InvalidAccessError","Invalid selector.");return f.getStats()}var _=[];return this.transceivers.forEach(function(b){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(y){b[y]&&_.push(b[y].getStats())})}),Promise.all(_).then(function(b){var y=new Map;return b.forEach(function(M){M.forEach(function(Y){y.set(Y.id,Y)})}),y})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(v){var f=Q[v];if(f&&f.prototype&&f.prototype.getStats){var _=f.prototype.getStats;f.prototype.getStats=function(){return _.apply(this).then(function(b){var y=new Map;return Object.keys(b).forEach(function(M){b[M].type=Re(b[M]),y.set(M,b[M])}),y})}}});var N=["createOffer","createAnswer"];return N.forEach(function(v){var f=C.prototype[v];C.prototype[v]=function(){var _=arguments;return typeof _[0]=="function"||typeof _[1]=="function"?f.apply(this,[arguments[2]]).then(function(b){typeof _[0]=="function"&&_[0].apply(null,[b])},function(b){typeof _[1]=="function"&&_[1].apply(null,[b])}):f.apply(this,arguments)}}),(N=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(v){var f=C.prototype[v];C.prototype[v]=function(){var _=arguments;return typeof _[1]=="function"||typeof _[2]=="function"?f.apply(this,arguments).then(function(){typeof _[1]=="function"&&_[1].apply(null)},function(b){typeof _[2]=="function"&&_[2].apply(null,[b])}):f.apply(this,arguments)}}),["getStats"].forEach(function(v){var f=C.prototype[v];C.prototype[v]=function(){var _=arguments;return typeof _[1]=="function"?f.apply(this,arguments).then(function(){typeof _[1]=="function"&&_[1].apply(null)}):f.apply(this,arguments)}}),C}},{sdp:17}],17:[function(Ye,Te,E){var w={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};w.localCName=w.generateIdentifier(),w.splitLines=function(Re){return Re.trim().split(`
`).map(function(we){return we.trim()})},w.splitSections=function(Re){return Re.split(`
m=`).map(function(we,he){return(he>0?"m="+we:we).trim()+`\r
`})},w.getDescription=function(Re){var we=w.splitSections(Re);return we&&we[0]},w.getMediaSections=function(Re){var we=w.splitSections(Re);return we.shift(),we},w.matchPrefix=function(Re,we){return w.splitLines(Re).filter(function(he){return he.indexOf(we)===0})},w.parseCandidate=function(Re){for(var we,he={foundation:(we=Re.indexOf("a=candidate:")===0?Re.substring(12).split(" "):Re.substring(10).split(" "))[0],component:parseInt(we[1],10),protocol:we[2].toLowerCase(),priority:parseInt(we[3],10),ip:we[4],address:we[4],port:parseInt(we[5],10),type:we[7]},Me=8;Me<we.length;Me+=2)switch(we[Me]){case"raddr":he.relatedAddress=we[Me+1];break;case"rport":he.relatedPort=parseInt(we[Me+1],10);break;case"tcptype":he.tcpType=we[Me+1];break;case"ufrag":he.ufrag=we[Me+1],he.usernameFragment=we[Me+1];break;default:he[we[Me]]=we[Me+1]}return he},w.writeCandidate=function(Re){var we=[];we.push(Re.foundation),we.push(Re.component),we.push(Re.protocol.toUpperCase()),we.push(Re.priority),we.push(Re.address||Re.ip),we.push(Re.port);var he=Re.type;return we.push("typ"),we.push(he),he!=="host"&&Re.relatedAddress&&Re.relatedPort&&(we.push("raddr"),we.push(Re.relatedAddress),we.push("rport"),we.push(Re.relatedPort)),Re.tcpType&&Re.protocol.toLowerCase()==="tcp"&&(we.push("tcptype"),we.push(Re.tcpType)),(Re.usernameFragment||Re.ufrag)&&(we.push("ufrag"),we.push(Re.usernameFragment||Re.ufrag)),"candidate:"+we.join(" ")},w.parseIceOptions=function(Re){return Re.substr(14).split(" ")},w.parseRtpMap=function(Re){var we=Re.substr(9).split(" "),he={payloadType:parseInt(we.shift(),10)};return we=we[0].split("/"),he.name=we[0],he.clockRate=parseInt(we[1],10),he.channels=we.length===3?parseInt(we[2],10):1,he.numChannels=he.channels,he},w.writeRtpMap=function(Re){var we=Re.payloadType;Re.preferredPayloadType!==void 0&&(we=Re.preferredPayloadType);var he=Re.channels||Re.numChannels||1;return"a=rtpmap:"+we+" "+Re.name+"/"+Re.clockRate+(he!==1?"/"+he:"")+`\r
`},w.parseExtmap=function(Re){var we=Re.substr(9).split(" ");return{id:parseInt(we[0],10),direction:we[0].indexOf("/")>0?we[0].split("/")[1]:"sendrecv",uri:we[1]}},w.writeExtmap=function(Re){return"a=extmap:"+(Re.id||Re.preferredId)+(Re.direction&&Re.direction!=="sendrecv"?"/"+Re.direction:"")+" "+Re.uri+`\r
`},w.parseFmtp=function(Re){for(var we,he={},Me=Re.substr(Re.indexOf(" ")+1).split(";"),nt=0;nt<Me.length;nt++)he[(we=Me[nt].trim().split("="))[0].trim()]=we[1];return he},w.writeFmtp=function(Re){var we="",he=Re.payloadType;if(Re.preferredPayloadType!==void 0&&(he=Re.preferredPayloadType),Re.parameters&&Object.keys(Re.parameters).length){var Me=[];Object.keys(Re.parameters).forEach(function(nt){Me.push(Re.parameters[nt]?nt+"="+Re.parameters[nt]:nt)}),we+="a=fmtp:"+he+" "+Me.join(";")+`\r
`}return we},w.parseRtcpFb=function(Re){var we=Re.substr(Re.indexOf(" ")+1).split(" ");return{type:we.shift(),parameter:we.join(" ")}},w.writeRtcpFb=function(Re){var we="",he=Re.payloadType;return Re.preferredPayloadType!==void 0&&(he=Re.preferredPayloadType),Re.rtcpFeedback&&Re.rtcpFeedback.length&&Re.rtcpFeedback.forEach(function(Me){we+="a=rtcp-fb:"+he+" "+Me.type+(Me.parameter&&Me.parameter.length?" "+Me.parameter:"")+`\r
`}),we},w.parseSsrcMedia=function(Re){var we=Re.indexOf(" "),he={ssrc:parseInt(Re.substr(7,we-7),10)},Me=Re.indexOf(":",we);return Me>-1?(he.attribute=Re.substr(we+1,Me-we-1),he.value=Re.substr(Me+1)):he.attribute=Re.substr(we+1),he},w.parseSsrcGroup=function(Re){var we=Re.substr(13).split(" ");return{semantics:we.shift(),ssrcs:we.map(function(he){return parseInt(he,10)})}},w.getMid=function(Re){var we=w.matchPrefix(Re,"a=mid:")[0];if(we)return we.substr(6)},w.parseFingerprint=function(Re){var we=Re.substr(14).split(" ");return{algorithm:we[0].toLowerCase(),value:we[1]}},w.getDtlsParameters=function(Re,we){return{role:"auto",fingerprints:w.matchPrefix(Re+we,"a=fingerprint:").map(w.parseFingerprint)}},w.writeDtlsParameters=function(Re,we){var he="a=setup:"+we+`\r
`;return Re.fingerprints.forEach(function(Me){he+="a=fingerprint:"+Me.algorithm+" "+Me.value+`\r
`}),he},w.getIceParameters=function(Re,we){var he=w.splitLines(Re);return{usernameFragment:(he=he.concat(w.splitLines(we))).filter(function(Me){return Me.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:he.filter(function(Me){return Me.indexOf("a=ice-pwd:")===0})[0].substr(10)}},w.writeIceParameters=function(Re){return"a=ice-ufrag:"+Re.usernameFragment+`\r
a=ice-pwd:`+Re.password+`\r
`},w.parseRtpParameters=function(Re){for(var we={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},he=w.splitLines(Re)[0].split(" "),Me=3;Me<he.length;Me++){var nt=he[Me],Ne=w.matchPrefix(Re,"a=rtpmap:"+nt+" ")[0];if(Ne){var W=w.parseRtpMap(Ne),Q=w.matchPrefix(Re,"a=fmtp:"+nt+" ");switch(W.parameters=Q.length?w.parseFmtp(Q[0]):{},W.rtcpFeedback=w.matchPrefix(Re,"a=rtcp-fb:"+nt+" ").map(w.parseRtcpFb),we.codecs.push(W),W.name.toUpperCase()){case"RED":case"ULPFEC":we.fecMechanisms.push(W.name.toUpperCase())}}}return w.matchPrefix(Re,"a=extmap:").forEach(function(se){we.headerExtensions.push(w.parseExtmap(se))}),we},w.writeRtpDescription=function(Re,we){var he="";he+="m="+Re+" ",he+=we.codecs.length>0?"9":"0",he+=" UDP/TLS/RTP/SAVPF ",he+=we.codecs.map(function(nt){return nt.preferredPayloadType!==void 0?nt.preferredPayloadType:nt.payloadType}).join(" ")+`\r
`,he+=`c=IN IP4 0.0.0.0\r
`,he+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,we.codecs.forEach(function(nt){he+=w.writeRtpMap(nt),he+=w.writeFmtp(nt),he+=w.writeRtcpFb(nt)});var Me=0;return we.codecs.forEach(function(nt){nt.maxptime>Me&&(Me=nt.maxptime)}),Me>0&&(he+="a=maxptime:"+Me+`\r
`),he+=`a=rtcp-mux\r
`,we.headerExtensions&&we.headerExtensions.forEach(function(nt){he+=w.writeExtmap(nt)}),he},w.parseRtpEncodingParameters=function(Re){var we,he=[],Me=w.parseRtpParameters(Re),nt=Me.fecMechanisms.indexOf("RED")!==-1,Ne=Me.fecMechanisms.indexOf("ULPFEC")!==-1,W=w.matchPrefix(Re,"a=ssrc:").map(function(G){return w.parseSsrcMedia(G)}).filter(function(G){return G.attribute==="cname"}),Q=W.length>0&&W[0].ssrc,se=w.matchPrefix(Re,"a=ssrc-group:FID").map(function(G){return G.substr(17).split(" ").map(function(U){return parseInt(U,10)})});se.length>0&&se[0].length>1&&se[0][0]===Q&&(we=se[0][1]),Me.codecs.forEach(function(G){if(G.name.toUpperCase()==="RTX"&&G.parameters.apt){var U={ssrc:Q,codecPayloadType:parseInt(G.parameters.apt,10)};Q&&we&&(U.rtx={ssrc:we}),he.push(U),nt&&((U=JSON.parse(JSON.stringify(U))).fec={ssrc:Q,mechanism:Ne?"red+ulpfec":"red"},he.push(U))}}),he.length===0&&Q&&he.push({ssrc:Q});var J=w.matchPrefix(Re,"b=");return J.length&&(J=J[0].indexOf("b=TIAS:")===0?parseInt(J[0].substr(7),10):J[0].indexOf("b=AS:")===0?1e3*parseInt(J[0].substr(5),10)*.95-16e3:void 0,he.forEach(function(G){G.maxBitrate=J})),he},w.parseRtcpParameters=function(Re){var we={},he=w.matchPrefix(Re,"a=ssrc:").map(function(Ne){return w.parseSsrcMedia(Ne)}).filter(function(Ne){return Ne.attribute==="cname"})[0];he&&(we.cname=he.value,we.ssrc=he.ssrc);var Me=w.matchPrefix(Re,"a=rtcp-rsize");we.reducedSize=Me.length>0,we.compound=Me.length===0;var nt=w.matchPrefix(Re,"a=rtcp-mux");return we.mux=nt.length>0,we},w.parseMsid=function(Re){var we,he=w.matchPrefix(Re,"a=msid:");if(he.length===1)return{stream:(we=he[0].substr(7).split(" "))[0],track:we[1]};var Me=w.matchPrefix(Re,"a=ssrc:").map(function(nt){return w.parseSsrcMedia(nt)}).filter(function(nt){return nt.attribute==="msid"});return Me.length>0?{stream:(we=Me[0].value.split(" "))[0],track:we[1]}:void 0},w.generateSessionId=function(){return Math.random().toString().substr(2,21)},w.writeSessionBoilerplate=function(Re,we,he){var Me=we!==void 0?we:2;return`v=0\r
o=`+(he||"thisisadapterortc")+" "+(Re||w.generateSessionId())+" "+Me+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},w.writeMediaSection=function(Re,we,he,Me){var nt=w.writeRtpDescription(Re.kind,we);if(nt+=w.writeIceParameters(Re.iceGatherer.getLocalParameters()),nt+=w.writeDtlsParameters(Re.dtlsTransport.getLocalParameters(),he==="offer"?"actpass":"active"),nt+="a=mid:"+Re.mid+`\r
`,nt+=Re.direction?"a="+Re.direction+`\r
`:Re.rtpSender&&Re.rtpReceiver?`a=sendrecv\r
`:Re.rtpSender?`a=sendonly\r
`:Re.rtpReceiver?`a=recvonly\r
`:`a=inactive\r
`,Re.rtpSender){var Ne="msid:"+Me.id+" "+Re.rtpSender.track.id+`\r
`;nt+="a="+Ne,nt+="a=ssrc:"+Re.sendEncodingParameters[0].ssrc+" "+Ne,Re.sendEncodingParameters[0].rtx&&(nt+="a=ssrc:"+Re.sendEncodingParameters[0].rtx.ssrc+" "+Ne,nt+="a=ssrc-group:FID "+Re.sendEncodingParameters[0].ssrc+" "+Re.sendEncodingParameters[0].rtx.ssrc+`\r
`)}return nt+="a=ssrc:"+Re.sendEncodingParameters[0].ssrc+" cname:"+w.localCName+`\r
`,Re.rtpSender&&Re.sendEncodingParameters[0].rtx&&(nt+="a=ssrc:"+Re.sendEncodingParameters[0].rtx.ssrc+" cname:"+w.localCName+`\r
`),nt},w.getDirection=function(Re,we){for(var he=w.splitLines(Re),Me=0;Me<he.length;Me++)switch(he[Me]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return he[Me].substr(2)}return we?w.getDirection(we):"sendrecv"},w.getKind=function(Re){return w.splitLines(Re)[0].split(" ")[0].substr(2)},w.isRejected=function(Re){return Re.split(" ",2)[1]==="0"},w.parseMLine=function(Re){var we=w.splitLines(Re)[0].substr(2).split(" ");return{kind:we[0],port:parseInt(we[1],10),protocol:we[2],fmt:we.slice(3).join(" ")}},w.parseOLine=function(Re){var we=w.matchPrefix(Re,"o=")[0].substr(2).split(" ");return{username:we[0],sessionId:we[1],sessionVersion:parseInt(we[2],10),netType:we[3],addressType:we[4],address:we[5]}},w.isValidSDP=function(Re){if(typeof Re!="string"||Re.length===0)return!1;for(var we=w.splitLines(Re),he=0;he<we.length;he++)if(we[he].length<2||we[he].charAt(1)!=="=")return!1;return!0},typeof Te=="object"&&(Te.exports=w)},{}]},{},[1])(1)},6994:function(It){It.exports=on},7165:function(It,Ye,Te){var E;It.exports=(E=Te(9021),Te(9506),void(E.lib.Cipher||function(w){var Re=E,we=Re.lib,he=we.Base,Me=we.WordArray,nt=we.BufferedBlockAlgorithm,Ne=Re.enc,W=Ne.Base64,Q=Re.algo.EvpKDF,se=we.Cipher=nt.extend({cfg:he.extend(),createEncryptor:function(y,M){return this.create(this._ENC_XFORM_MODE,y,M)},createDecryptor:function(y,M){return this.create(this._DEC_XFORM_MODE,y,M)},init:function(y,M,Y){this.cfg=this.cfg.extend(Y),this._xformMode=y,this._key=M,this.reset()},reset:function(){nt.reset.call(this),this._doReset()},process:function(y){return this._append(y),this._process()},finalize:function(y){return y&&this._append(y),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function y(M){return typeof M=="string"?b:f}return function(M){return{encrypt:function(Y,L,A){return y(L).encrypt(M,Y,L,A)},decrypt:function(Y,L,A){return y(L).decrypt(M,Y,L,A)}}}}()}),J=(we.StreamCipher=se.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),Re.mode={}),G=we.BlockCipherMode=he.extend({createEncryptor:function(y,M){return this.Encryptor.create(y,M)},createDecryptor:function(y,M){return this.Decryptor.create(y,M)},init:function(y,M){this._cipher=y,this._iv=M}}),U=J.CBC=function(){var y=G.extend();function M(Y,L,A){var H,ge=this._iv;ge?(H=ge,this._iv=w):H=this._prevBlock;for(var Ee=0;Ee<A;Ee++)Y[L+Ee]^=H[Ee]}return y.Encryptor=y.extend({processBlock:function(Y,L){var A=this._cipher,H=A.blockSize;M.call(this,Y,L,H),A.encryptBlock(Y,L),this._prevBlock=Y.slice(L,L+H)}}),y.Decryptor=y.extend({processBlock:function(Y,L){var A=this._cipher,H=A.blockSize,ge=Y.slice(L,L+H);A.decryptBlock(Y,L),M.call(this,Y,L,H),this._prevBlock=ge}}),y}(),C=(Re.pad={}).Pkcs7={pad:function(y,M){for(var Y=4*M,L=Y-y.sigBytes%Y,A=L<<24|L<<16|L<<8|L,H=[],ge=0;ge<L;ge+=4)H.push(A);var Ee=Me.create(H,L);y.concat(Ee)},unpad:function(y){y.sigBytes-=255&y.words[y.sigBytes-1>>>2]}},N=(we.BlockCipher=se.extend({cfg:se.cfg.extend({mode:U,padding:C}),reset:function(){var y;se.reset.call(this);var M=this.cfg,Y=M.iv,L=M.mode;this._xformMode==this._ENC_XFORM_MODE?y=L.createEncryptor:(y=L.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==y?this._mode.init(this,Y&&Y.words):(this._mode=y.call(L,this,Y&&Y.words),this._mode.__creator=y)},_doProcessBlock:function(y,M){this._mode.processBlock(y,M)},_doFinalize:function(){var y,M=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(M.pad(this._data,this.blockSize),y=this._process(!0)):(y=this._process(!0),M.unpad(y)),y},blockSize:4}),we.CipherParams=he.extend({init:function(y){this.mixIn(y)},toString:function(y){return(y||this.formatter).stringify(this)}})),v=(Re.format={}).OpenSSL={stringify:function(y){var M=y.ciphertext,Y=y.salt;return(Y?Me.create([1398893684,1701076831]).concat(Y).concat(M):M).toString(W)},parse:function(y){var M,Y=W.parse(y),L=Y.words;return L[0]==1398893684&&L[1]==1701076831&&(M=Me.create(L.slice(2,4)),L.splice(0,4),Y.sigBytes-=16),N.create({ciphertext:Y,salt:M})}},f=we.SerializableCipher=he.extend({cfg:he.extend({format:v}),encrypt:function(y,M,Y,L){L=this.cfg.extend(L);var A=y.createEncryptor(Y,L),H=A.finalize(M),ge=A.cfg;return N.create({ciphertext:H,key:Y,iv:ge.iv,algorithm:y,mode:ge.mode,padding:ge.padding,blockSize:y.blockSize,formatter:L.format})},decrypt:function(y,M,Y,L){return L=this.cfg.extend(L),M=this._parse(M,L.format),y.createDecryptor(Y,L).finalize(M.ciphertext)},_parse:function(y,M){return typeof y=="string"?M.parse(y,this):y}}),_=(Re.kdf={}).OpenSSL={execute:function(y,M,Y,L,A){if(L||(L=Me.random(8)),A)H=Q.create({keySize:M+Y,hasher:A}).compute(y,L);else var H=Q.create({keySize:M+Y}).compute(y,L);var ge=Me.create(H.words.slice(M),4*Y);return H.sigBytes=4*M,N.create({key:H,iv:ge,salt:L})}},b=we.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:_}),encrypt:function(y,M,Y,L){var A=(L=this.cfg.extend(L)).kdf.execute(Y,y.keySize,y.ivSize,L.salt,L.hasher);L.iv=A.iv;var H=f.encrypt.call(this,y,M,A.key,L);return H.mixIn(A),H},decrypt:function(y,M,Y,L){L=this.cfg.extend(L),M=this._parse(M,L.format);var A=L.kdf.execute(Y,y.keySize,y.ivSize,M.salt,L.hasher);return L.iv=A.iv,f.decrypt.call(this,y,M,A.key,L)}})}()))},7202:function(It,Ye,Te){var E=Te(6994);Ye.A=E.default||E},8627:function(It,Ye,Te){Te.d(Ye,{$wo:function(){return Ze},A1v:function(){return Hr},Arx:function(){return Ci},B3d:function(){return Lr},BMv:function(){return Xe},Be2:function(){return fn},E9Y:function(){return b},F$4:function(){return H},FB3:function(){return ze},GY7:function(){return Lt},H6b:function(){return P},HCP:function(){return le},HED:function(){return y},HO9:function(){return L},I4J:function(){return ne},I7C:function(){return In},J79:function(){return Me},JDv:function(){return ir},JSm:function(){return Rr},KbN:function(){return Ae},L8E:function(){return Ie},LBO:function(){return nr},LLz:function(){return Fe},MK1:function(){return zn},MrD:function(){return Ot},MrS:function(){return pe},MuX:function(){return de},NCg:function(){return ve},NJN:function(){return Sr},O2H:function(){return Fr},OdW:function(){return De},OrZ:function(){return te},Oy0:function(){return G},PA0:function(){return nt},PTE:function(){return be},Q3v:function(){return Ln},Q9p:function(){return se},QYE:function(){return z},Qo5:function(){return v},R54:function(){return kr},RBR:function(){return Qn},RZs:function(){return ii},RfS:function(){return ce},S4u:function(){return Re},S5f:function(){return Ne},S6t:function(){return Kn},SB8:function(){return Ai},SCx:function(){return He},SQb:function(){return xn},SRE:function(){return et},SmZ:function(){return Z},Srw:function(){return _},T1C:function(){return St},T_8:function(){return sr},TgN:function(){return We},Tij:function(){return ri},UZK:function(){return C},V2t:function(){return Le},VEp:function(){return vn},VU9:function(){return $},WP4:function(){return Ve},WgV:function(){return Dn},XHx:function(){return Qr},Xxx:function(){return Se},YDn:function(){return kn},ZEp:function(){return Q},ZpF:function(){return xe},Zws:function(){return Vr},_5H:function(){return _r},_68:function(){return B},_9F:function(){return _n},_HD:function(){return N},aUw:function(){return ge},aa2:function(){return Ce},akY:function(){return F},akb:function(){return Nn},ann:function(){return Wr},aq0:function(){return Xr},b1q:function(){return dr},bVX:function(){return k},cGQ:function(){return tr},cMG:function(){return Fn},ckD:function(){return Qe},ckg:function(){return ui},clM:function(){return we},d49:function(){return he},dNl:function(){return ot},dU8:function(){return An},dXc:function(){return Yn},dg1:function(){return K},dqB:function(){return bn},drM:function(){return $e},ekj:function(){return Yr},f43:function(){return me},f5Z:function(){return ht},fFX:function(){return Jr},fzq:function(){return D},g9p:function(){return Y},gHA:function(){return Jn},gSF:function(){return M},hYx:function(){return Ke},hje:function(){return jn},iei:function(){return X},jZ$:function(){return fe},jut:function(){return ee},kOd:function(){return mt},kbF:function(){return _t},lgu:function(){return Si},lph:function(){return U},lwJ:function(){return li},m6U:function(){return an},mHY:function(){return W},mrK:function(){return rn},oCq:function(){return ye},p7L:function(){return Ut},pGN:function(){return at},pWJ:function(){return yi},ph7:function(){return qr},pn5:function(){return ue},pzL:function(){return J},qvY:function(){return mn},rBJ:function(){return Zn},rV9:function(){return R},sJH:function(){return ae},sP3:function(){return cn},sVF:function(){return Ee},s_m:function(){return it},t85:function(){return st},tlN:function(){return Ct},ton:function(){return Zr},ulL:function(){return f},wxm:function(){return zr},xU2:function(){return ft},xbZ:function(){return or},xfZ:function(){return A},yK:function(){return Ue},yTe:function(){return oe},z0D:function(){return pr},zML:function(){return fr},zcJ:function(){return Bn},zgL:function(){return T},zgf:function(){return kt},zs3:function(){return Tn}});var E=Te(8866),w="the user cancels the stream request.",Re={code:1000002,message:"not login room"},we={code:1000014,message:"stream ID is too long"},he={code:1000015,message:"streamID is empty"},Me={code:1000016,message:"stream ID contains illegal characters"},nt={code:1000017,message:E.Rl},Ne={code:1000018,message:E.qC},W={code:1001021,message:"set geoFence fail"},Q={code:1100001,message:E.dO},se={code:1100002,message:"network timeout."},J={code:1100003,msg:"socket close"},G={code:1100999,message:"unknown server error"},U={code:1101002,message:"get app config fail"},C={code:1101003,message:"Module not imported"},N={code:1101005,message:"signal hb fail"},v={code:1002011,message:"room ID is empty"},f={code:1002012,message:"room ID contains illegal characters"},_={code:1002013,message:"room ID is too long"},b={code:1002099,message:"room inner error"},y={code:1102016,message:"token error"},M={code:1102017,message:"dispatch error"},Y={code:1102018,message:"token expired"},L={code:1102021,message:"biz channel error."},A={code:1102022,message:"dispatch request timeout"},H={code:1102023,message:"connect signal fail"},ge={code:1102024,message:"invalid channel"},Ee={code:1102026,msg:E.fT},Se={code:1003025,message:"stream is forbided by media server"},ue={code:1003028,message:"There are duplicate stream ids in the room"},oe={code:1003040,message:"Pushing CDN status failed. It may be an error in the CDN url"},be={code:1003050,message:"the extra info of the stream is null"},Le={code:1003051,message:"the extra info of the stream is too long"},pe={code:1003080,message:"browser does not support the codec"},k={code:1003099,message:"publish inner error"},R={code:1003081,message:"B-frames detected in the video stream"},Fe={code:1103001,message:E.dO},te={code:1103002,message:"browser do not support"},Ue={code:1103010,message:"screen fail"},it={code:1103011,message:"enumerate devices fail"},ee={code:1103012,message:"use camera device fail"},ae={code:1103019,message:"publish streams auth fail"},xe={code:1103021,message:"session request fail"},Z={code:1103022,message:"create offer error"},$={code:1103023,message:"setLocalDescription error"},K={code:1103024,message:"mediaDesc error"},X={code:1103025,message:"other side offer error"},B={code:1103026,message:"candidate error"},fe={code:1103027,message:"server session closed"},Ce={code:1103028,message:"ice connection error"},Ze={code:1103030,message:"negotiation timeout"},st={code:1103042,message:"screen canceled"},Ie={code:1103043,message:"screen not support"},D={code:1103044,message:E.aw},me={code:1103099,message:"stream is not capturing"},ce={code:1103049,message:"repeated pull same stream"},le={code:1103050,message:"websocket disconnected"},et={code:1103051,message:"publisher retry timeout"},ze={code:1103053,message:"https is required"},ft={code:1103055,message:E.Wk},_t={code:1103056,message:"publish is publishing"},mt={code:1103058,message:"client ip changed"},Ve={code:1103059,message:"ttl over time"},Ot={code:1103060,message:"session request timeout"},rn={code:1103061,message:"get media fail"},an={code:1103062,message:"update stream info fail"},In={code:1103063,message:"publish target no response"},Tn={code:1103064,message:"get device not allowed"},fn={code:1103065,message:"device is not readable"},Rr={code:1103066,message:"device does not meet constraints"},ir={code:1103067,message:"update sdp time out"},Ln={code:1103068,message:"update sdp fail"},mn={code:1103073,message:"video effect is starting, please operate after video effect is started"},Qn={code:1103078,message:"publish stream poor and net probe poor"},Nn={code:1103103,message:"remote sdp no candidate "},or={code:1103089,message:w},pr={code:1103093,message:"set audio out put error"},sr={code:1004099,message:"internal exeception"},Wr={code:1104001,message:"input parm error"},tr={code:1104020,message:"dispatch request fail"},zn={code:1104021,message:"session request fail"},bn={code:1104022,message:"create offer error"},Jn={code:1104023,message:"setLocalDescription error"},zr={code:1104024,message:"mediaDesc error"},jn={code:1104025,message:"other side offer error"},Lr={code:1104026,message:"candidate error"},Vr={code:1104028,message:"ice connection error"},Ai={code:1104029,message:"websocket disconnected"},Yr={code:1104030,message:"negotiation timeout"},Qr={code:1104031,message:"player retry timeout"},Ci={code:1104032,message:"player is playing"},Si={code:1104033,message:"client ip changed"},ri={code:1104034,message:"ttl is over time"},fr={code:1104035,message:"reset session push"},Yn={code:1104036,message:"session request timeout"},yi={code:1104037,message:"probe time out"},dr={code:1104038,message:"resource mode is not supported"},ii={code:1104039,message:"play stream not found"},kn={code:1104027,message:"server session closed"},nr={code:1004002,message:"play stream not found"},Fn={code:1004020,message:"play stream interrupted"},_r={code:1004025,message:"stream is forbided by media server"},P={code:1004080,message:"browser does not support the codec"},He={code:1004081,message:"decode video failed"},de={code:1104041,message:"stream quality poor and net probe poor"},ne={code:1104042,message:w},De={code:1104043,message:"mini sdp error"},ye={code:1104044,message:"stream is not playing"},Qe={code:1104045,message:"play streams is out limit"},Ke={code:1104046,message:"play streams auth fail"},$e={code:1104047,message:"remote sdp no candidate "},at={code:1006006,message:"the device is unplugged"},ht={code:1106007,message:"the microphone may be loose, and audio data collection is abnormal."},Ct={code:1106008,message:"the camera may be loose, and video data collection is abnormal."},St={code:1106009,message:"mic track ended."},kt={code:1106010,message:"camera track ended."},Ut={code:1000067,message:"Logged in room, setting scenario is not supported"},Lt={code:1103083,message:"sdp wrong format"},cn={code:1103084,message:"mini sdp buffer size exceeded"},_n={code:1103085,message:"url size exceeded"},vn={code:1103086,message:"this publish stream id is not created by CreateZegoStream"},xn={code:1103087,message:"the zego stream does not capture audio"},An={code:1103088,message:"the zego stream does not capture video"},Zn={code:1103052,message:"publisher cdn push error"},Kn={code:1103057,message:"decode audio data fail"},Bn={code:1103074,message:"video track is not readable"},Jr={code:1103047,message:"track is not found"},ui={code:1103048,message:E.pt},Zr={code:1103029,message:"constraint error"},kr={code:1103045,message:"video is false"},Fr={code:1103046,message:"audio is false"},qr={code:1103101,message:"only stream which have one track and kind no exist can add track"},Sr={code:1103069,message:"publisher state wrong"},Dn={code:1103070,message:"not support handle track"},li={code:1103071,message:"video effect processor is running"},Hr={code:1103071,message:"background processor is running"},Xr={code:1103079,message:"replace track fail"},z={code:1103072,message:"not support beauty effect"},T={code:1103075,message:"beauty effect overload"},F={code:1103076,message:"audio track is not readable"},ve={code:1103100,message:"background process is start, but not subscribe yet"},Ae={code:1017130,message:"get mini sdp error"},We={code:1017131,message:"parse mini sdp error"},Xe={code:1017132,message:"worker is invalid"},ot={code:1017133,message:"mini trans timeout"}},8754:function(){var It=function(){function Ye(P,He){postMessage({action:Si,cbn:He,result:P})}function Te(P){var He=[];return He[P-1]=void 0,He}function E(P,He){return we(P[0]+He[0],P[1]+He[1])}function w(P,He){return function(de,ne){var De,ye;return De=de*fr,ye=ne,0>ne&&(ye+=fr),[ye,De]}(Math.max(Math.min(P[1]/fr,2147483647),-2147483648)&Math.max(Math.min(He[1]/fr,2147483647),-2147483648),nt(P)&nt(He))}function Re(P,He){var de,ne;return P[0]==He[0]&&P[1]==He[1]?0:(ne=0>He[1],(de=0>P[1])&&!ne?-1:!de&&ne?1:se(P,He)[1]<0?-1:1)}function we(P,He){var de,ne;for(P%=18446744073709552e3,He=(He%=18446744073709552e3)-(de=He%fr)+(ne=Math.floor(P/fr)*fr),P=P-ne+de;0>P;)P+=fr,He-=fr;for(;P>4294967295;)P-=fr,He+=fr;for(He%=18446744073709552e3;He>9223372032559809e3;)He-=18446744073709552e3;for(;-9223372036854776e3>He;)He+=18446744073709552e3;return[P,He]}function he(P,He){return P[0]==He[0]&&P[1]==He[1]}function Me(P){return P>=0?[P,0]:[P+fr,-fr]}function nt(P){return P[0]>=2147483648?~~Math.max(Math.min(P[0]-fr,2147483647),-2147483648):~~Math.max(Math.min(P[0],2147483647),-2147483648)}function Ne(P){return 30>=P?1<<P:Ne(30)*Ne(P-30)}function W(P,He){var de,ne,De,ye;if(He&=63,he(P,yi))return He?dr:P;if(0>P[1])throw Error("Neg");return ye=Ne(He),ne=P[1]*ye%18446744073709552e3,(ne+=de=(De=P[0]*ye)-De%fr)>=9223372036854776e3&&(ne-=18446744073709552e3),[De-=de,ne]}function Q(P,He){var de;return de=Ne(He&=63),we(Math.floor(P[0]/de),P[1]/de)}function se(P,He){return we(P[0]-He[0],P[1]-He[1])}function J(P,He){return P.Mc=He,P.Lc=0,P.Yb=He.length,P}function G(P){return P.Lc>=P.Yb?-1:255&P.Mc[P.Lc++]}function U(P,He,de,ne){return P.Lc>=P.Yb?-1:(ne=Math.min(ne,P.Yb-P.Lc),_(P.Mc,P.Lc,He,de,ne),P.Lc+=ne,ne)}function C(P){return P.Mc=Te(32),P.Yb=0,P}function N(P){var He=P.Mc;return He.length=P.Yb,He}function v(P,He){P.Mc[P.Yb++]=He<<24>>24}function f(P,He,de,ne){_(He,de,P.Mc,P.Yb,ne),P.Yb+=ne}function _(P,He,de,ne,De){for(var ye=0;De>ye;++ye)de[ne+ye]=P[He+ye]}function b(P,He,de,ne,De){var ye,Qe;if(Re(ne,Yn)<0)throw Error("invalid length "+ne);for(P.Tb=ne,function(Ke,$e){(function(at,ht){at.ab=ht;for(var Ct=0;ht>1<<Ct;++Ct);at.$b=2*Ct})($e,1<<Ke.s),$e.n=Ke.f,function(at,ht){var Ct=at.X;at.X=ht,at.b&&Ct!=at.X&&(at.wb=-1,at.b=null)}($e,Ke.m),$e.eb=0,$e.fb=3,$e.Y=2,$e.y=3}(De,ye=X({})),ye.Gc=It.disableEndMark===void 0,function(Ke,$e){Ke.fc[0]=9*(5*Ke.Y+Ke.eb)+Ke.fb<<24>>24;for(var at=0;4>at;++at)Ke.fc[1+at]=Ke.ab>>8*at<<24>>24;f($e,Ke.fc,0,5)}(ye,de),Qe=0;64>Qe;Qe+=8)v(de,255&nt(Q(ne,Qe)));P.yb=(ye.W=0,ye.oc=He,ye.pc=0,function(Ke){var $e,at;Ke.b||($e={},at=4,Ke.X||(at=2),function(ht,Ct){ht.qb=Ct>2,ht.qb?(ht.w=0,ht.xb=4,ht.R=66560):(ht.w=2,ht.xb=3,ht.R=0)}($e,at),Ke.b=$e),Ot(Ke.A,Ke.eb,Ke.fb),(Ke.ab!=Ke.wb||Ke.Hb!=Ke.n)&&(Se(Ke.b,Ke.ab,4096,Ke.n,274),Ke.wb=Ke.ab,Ke.Hb=Ke.n)}(ye),ye.d.Ab=de,function(Ke){(function(at){at.l=0,at.J=0;for(var ht=0;4>ht;++ht)at.v[ht]=0})(Ke),function(at){at.mc=dr,at.xc=dr,at.E=-1,at.Jb=1,at.Oc=0}(Ke.d),zn(Ke.C),zn(Ke._),zn(Ke.bb),zn(Ke.hb),zn(Ke.Ub),zn(Ke.vc),zn(Ke.Sb),function(at){var ht,Ct=1<<at.u+at.I;for(ht=0;Ct>ht;++ht)zn(at.V[ht].tb)}(Ke.A);for(var $e=0;4>$e;++$e)zn(Ke.K[$e].G);et(Ke.$,1<<Ke.Y),et(Ke.i,1<<Ke.Y),zn(Ke.S.G),Ke.N=0,Ke.jb=0,Ke.q=0,Ke.s=0}(ye),fe(ye),B(ye),ye.$.rb=ye.n+1-2,Ve(ye.$,1<<ye.Y),ye.i.rb=ye.n+1-2,Ve(ye.i,1<<ye.Y),ye.g=dr,function(Ke,$e){return Ke.cb=$e,Ke.Z=null,Ke.zc=1,Ke}({},ye))}function y(P,He,de){return P.Nb=C({}),b(P,J({},He),P.Nb,Me(He.length),de),P}function M(P,He,de){var ne,De,ye,Qe,Ke="",$e=[];for(De=0;5>De;++De){if((ye=G(He))==-1)throw Error("truncated input");$e[De]=ye<<24>>24}if(!function(at,ht){var Ct,St,kt,Ut,Lt,cn,_n;if(5>ht.length)return 0;for(kt=(_n=255&ht[0])%9,Ut=(cn=~~(_n/9))%5,Lt=~~(cn/5),Ct=0,St=0;4>St;++St)Ct+=(255&ht[1+St])<<8*St;return Ct>99999999||!function(vn,xn,An,Zn){if(xn>8||An>4||Zn>4)return 0;Z(vn.gb,An,xn);var Kn=1<<Zn;return it(vn.Rb,Kn),it(vn.sb,Kn),vn.Dc=Kn-1,1}(at,kt,Ut,Lt)?0:function(vn,xn){return 0>xn?0:(vn.Ob!=xn&&(vn.Ob=xn,vn.nb=Math.max(vn.Ob,1),be(vn.B,Math.max(vn.nb,4096))),1)}(at,Ct)}(ne=Ue({}),$e))throw Error("corrupted input");for(De=0;64>De;De+=8){if((ye=G(He))==-1)throw Error("truncated input");(ye=ye.toString(16)).length==1&&(ye="0"+ye),Ke=ye+""+Ke}/^0+$|^f+$/i.test(Ke)?P.Tb=Yn:(Qe=parseInt(Ke,16),P.Tb=Qe>4294967295?Yn:Me(Qe)),P.yb=function(at,ht,Ct,St){return at.e.Ab=ht,k(at.B),at.B.cc=Ct,function(kt){kt.B.h=0,kt.B.o=0,zn(kt.Gb),zn(kt.pb),zn(kt.Zb),zn(kt.Cb),zn(kt.Db),zn(kt.Eb),zn(kt.kc),function(Lt){var cn,_n;for(_n=1<<Lt.u+Lt.I,cn=0;_n>cn;++cn)zn(Lt.V[cn].Ib)}(kt.gb);for(var Ut=0;4>Ut;++Ut)zn(kt.kb[Ut].G);xe(kt.Rb),xe(kt.sb),zn(kt.Fb.G),function(Lt){Lt.Bb=0,Lt.E=-1;for(var cn=0;5>cn;++cn)Lt.Bb=Lt.Bb<<8|G(Lt.Ab)}(kt.e)}(at),at.U=0,at.ib=0,at.Jc=0,at.Ic=0,at.Qc=0,at.Nc=St,at.g=dr,at.jc=0,function(kt,Ut){return kt.Z=Ut,kt.cb=null,kt.zc=1,kt}({},at)}(ne,He,de,P.Tb)}function Y(P,He){return P.Nb=C({}),M(P,J({},He),P.Nb),P}function L(P,He){return P.c[P.f+P.o+He]}function A(P,He,de,ne){var De,ye;for(P.T&&P.o+He+ne>P.h&&(ne=P.h-(P.o+He)),++de,ye=P.f+P.o+He,De=0;ne>De&&P.c[ye+De]==P.c[ye+De-de];++De);return De}function H(P){return P.h-P.o}function ge(P){var He,de;if(!P.T)for(;;){if(!(de=-P.f+P.Kb-P.h))return;if((He=U(P.cc,P.c,P.f+P.h,de))==-1)return P.zb=P.h,P.f+P.zb>P.H&&(P.zb=P.H-P.f),void(P.T=1);P.h+=He,P.h>=P.o+P._b&&(P.zb=P.h-P._b)}}function Ee(P,He){P.f+=He,P.zb-=He,P.o-=He,P.h-=He}function Se(P,He,de,ne,De){var ye,Qe;1073741567>He&&(P.Fc=16+(ne>>1),function(Ke,$e,at,ht){var Ct;Ke.Bc=$e,Ke._b=at,Ct=$e+at+ht,(Ke.c==null||Ke.Kb!=Ct)&&(Ke.c=null,Ke.Kb=Ct,Ke.c=Te(Ke.Kb)),Ke.H=Ke.Kb-at}(P,He+de,ne+De,256+~~((He+de+ne+De)/2)),P.ob=ne,P.p!=(ye=He+1)&&(P.L=Te(2*(P.p=ye))),Qe=65536,P.qb&&(Qe=He-1,Qe|=Qe>>1,Qe|=Qe>>2,Qe|=Qe>>4,Qe|=Qe>>8,Qe>>=1,(Qe|=65535)>16777216&&(Qe>>=1),P.Ec=Qe,++Qe,Qe+=P.R),Qe!=P.rc&&(P.ub=Te(P.rc=Qe)))}function ue(P){var He;++P.k>=P.p&&(P.k=0),function(de){++de.o,de.o>de.zb&&(de.f+de.o>de.H&&function(ne){var De,ye,Qe;for((Qe=ne.f+ne.o-ne.Bc)>0&&--Qe,ye=ne.f+ne.h-Qe,De=0;ye>De;++De)ne.c[De]=ne.c[Qe+De];ne.f-=Qe}(de),ge(de))}(P),P.o==1073741823&&(oe(P.L,2*P.p,He=P.o-P.p),oe(P.ub,P.rc,He),Ee(P,He))}function oe(P,He,de){var ne,De;for(ne=0;He>ne;++ne)de>=(De=P[ne]||0)?De=0:De-=de,P[ne]=De}function be(P,He){(P.Lb==null||P.M!=He)&&(P.Lb=Te(He)),P.M=He,P.o=0,P.h=0}function Le(P){var He=P.o-P.h;He&&(f(P.cc,P.Lb,P.h,He),P.o>=P.M&&(P.o=0),P.h=P.o)}function pe(P,He){var de=P.o-He-1;return 0>de&&(de+=P.M),P.Lb[de]}function k(P){Le(P),P.cc=null}function R(P){return 4>(P-=2)?P:3}function Fe(P){return 4>P?0:10>P?P-3:P-6}function te(P){if(!P.zc)throw Error("bad state");return P.cb?function(He){(function(de,ne,De,ye){var Qe,Ke,$e,at,ht,Ct,St,kt,Ut,Lt,cn,_n,vn,xn,An;if(ne[0]=dr,De[0]=dr,ye[0]=1,de.oc&&(de.b.cc=de.oc,function(Zn){Zn.f=0,Zn.o=0,Zn.h=0,Zn.T=0,ge(Zn),Zn.k=0,Ee(Zn,-1)}(de.b),de.W=1,de.oc=null),!de.pc){if(de.pc=1,xn=de.g,he(de.g,dr)){if(!H(de.b))return void Ce(de,nt(de.g));me(de),vn=nt(de.g)&de.y,bn(de.d,de.C,(de.l<<4)+vn,0),de.l=Fe(de.l),$e=L(de.b,-de.s),an(rn(de.A,nt(de.g),de.J),de.d,$e),de.J=$e,--de.s,de.g=E(de.g,ii)}if(!H(de.b))return void Ce(de,nt(de.g));for(;;){if(St=Ze(de,nt(de.g)),Lt=de.mb,vn=nt(de.g)&de.y,Ke=(de.l<<4)+vn,St==1&&Lt==-1)bn(de.d,de.C,Ke,0),$e=L(de.b,-de.s),An=rn(de.A,nt(de.g),de.J),7>de.l?an(An,de.d,$e):(Ut=L(de.b,-de.v[0]-1-de.s),In(An,de.d,Ut,$e)),de.J=$e,de.l=Fe(de.l);else{if(bn(de.d,de.C,Ke,1),4>Lt){if(bn(de.d,de.bb,de.l,1),Lt?(bn(de.d,de.hb,de.l,1),Lt==1?bn(de.d,de.Ub,de.l,0):(bn(de.d,de.Ub,de.l,1),bn(de.d,de.vc,de.l,Lt-2))):(bn(de.d,de.hb,de.l,0),bn(de.d,de._,Ke,St==1?0:1)),St==1?de.l=7>de.l?9:11:(ft(de.i,de.d,St-2,vn),de.l=7>de.l?8:11),at=de.v[Lt],Lt!=0){for(Ct=Lt;Ct>=1;--Ct)de.v[Ct]=de.v[Ct-1];de.v[0]=at}}else{for(bn(de.d,de.bb,de.l,0),de.l=7>de.l?7:10,ft(de.$,de.d,St-2,vn),_n=le(Lt-=4),kt=R(St),Qn(de.K[kt],de.d,_n),_n>=4&&(cn=Lt-(Qe=(2|1&_n)<<(ht=(_n>>1)-1)),14>_n?sr(de.Sb,Qe-_n-1,de.d,ht,cn):(Jn(de.d,cn>>4,ht-4),or(de.S,de.d,15&cn),++de.Qb)),at=Lt,Ct=3;Ct>=1;--Ct)de.v[Ct]=de.v[Ct-1];de.v[0]=at,++de.Mb}de.J=L(de.b,St-1-de.s)}if(de.s-=St,de.g=E(de.g,Me(St)),!de.s){if(de.Mb>=128&&fe(de),de.Qb>=16&&B(de),ne[0]=de.g,De[0]=zr(de.d),!H(de.b))return void Ce(de,nt(de.g));if(Re(se(de.g,xn),[4096,0])>=0)return de.pc=0,void(ye[0]=0)}}}})(He.cb,He.cb.Xb,He.cb.uc,He.cb.Kc),He.Pb=He.cb.Xb[0],He.cb.Kc[0]&&(function(de){ce(de),de.d.Ab=null}(He.cb),He.zc=0)}(P):function(He){var de=function(ne){var De,ye,Qe,Ke,$e,at;if(at=nt(ne.g)&ne.Dc,tr(ne.e,ne.Gb,(ne.U<<4)+at)){if(tr(ne.e,ne.Zb,ne.U))Qe=0,tr(ne.e,ne.Cb,ne.U)?(tr(ne.e,ne.Db,ne.U)?(tr(ne.e,ne.Eb,ne.U)?(ye=ne.Qc,ne.Qc=ne.Ic):ye=ne.Ic,ne.Ic=ne.Jc):ye=ne.Jc,ne.Jc=ne.ib,ne.ib=ye):tr(ne.e,ne.pb,(ne.U<<4)+at)||(ne.U=7>ne.U?9:11,Qe=1),Qe||(Qe=ee(ne.sb,ne.e,at)+2,ne.U=7>ne.U?8:11);else if(ne.Qc=ne.Ic,ne.Ic=ne.Jc,ne.Jc=ne.ib,Qe=2+ee(ne.Rb,ne.e,at),ne.U=7>ne.U?7:10,($e=Ln(ne.kb[R(Qe)],ne.e))>=4){if(ne.ib=(2|1&$e)<<(Ke=($e>>1)-1),14>$e)ne.ib+=function(ht,Ct,St,kt){var Ut,Lt,cn=1,_n=0;for(Lt=0;kt>Lt;++Lt)Ut=tr(St,ht,Ct+cn),cn<<=1,cn+=Ut,_n|=Ut<<Lt;return _n}(ne.kc,ne.ib-$e-1,ne.e,Ke);else if(ne.ib+=function(ht,Ct){var St,kt,Ut=0;for(St=Ct;St!=0;--St)ht.E>>>=1,ht.Bb-=ht.E&(kt=ht.Bb-ht.E>>>31)-1,Ut=Ut<<1|1-kt,-16777216&ht.E||(ht.Bb=ht.Bb<<8|G(ht.Ab),ht.E<<=8);return Ut}(ne.e,Ke-4)<<4,ne.ib+=function(ht,Ct){var St,kt,Ut=1,Lt=0;for(kt=0;ht.F>kt;++kt)St=tr(Ct,ht.G,Ut),Ut<<=1,Ut+=St,Lt|=St<<kt;return Lt}(ne.Fb,ne.e),0>ne.ib)return ne.ib==-1?1:-1}else ne.ib=$e;if(Re(Me(ne.ib),ne.g)>=0||ne.ib>=ne.nb)return-1;(function(ht,Ct,St){var kt=ht.o-Ct-1;for(0>kt&&(kt+=ht.M);St!=0;--St)kt>=ht.M&&(kt=0),ht.Lb[ht.o++]=ht.Lb[kt++],ht.o>=ht.M&&Le(ht)})(ne.B,ne.ib,Qe),ne.g=E(ne.g,Me(Qe)),ne.jc=pe(ne.B,0)}else De=function(ht,Ct,St){return ht.V[((Ct&ht.qc)<<ht.u)+((255&St)>>>8-ht.u)]}(ne.gb,nt(ne.g),ne.jc),ne.jc=7>ne.U?function(ht,Ct){var St=1;do St=St<<1|tr(Ct,ht.Ib,St);while(256>St);return St<<24>>24}(De,ne.e):function(ht,Ct,St){var kt,Ut,Lt=1;do if(Ut=St>>7&1,St<<=1,kt=tr(Ct,ht.Ib,(1+Ut<<8)+Lt),Lt=Lt<<1|kt,Ut!=kt){for(;256>Lt;)Lt=Lt<<1|tr(Ct,ht.Ib,Lt);break}while(256>Lt);return Lt<<24>>24}(De,ne.e,pe(ne.B,ne.ib)),function(ht,Ct){ht.Lb[ht.o++]=Ct,ht.o>=ht.M&&Le(ht)}(ne.B,ne.jc),ne.U=Fe(ne.U),ne.g=E(ne.g,ii);return 0}(He.Z);if(de==-1)throw Error("corrupted input");He.Pb=Yn,He.Pc=He.Z.g,(de||Re(He.Z.Nc,dr)>=0&&Re(He.Z.g,He.Z.Nc)>=0)&&(Le(He.Z.B),k(He.Z.B),He.Z.e.Ab=null,He.zc=0)}(P),P.zc}function Ue(P){P.B={},P.e={},P.Gb=Te(192),P.Zb=Te(12),P.Cb=Te(12),P.Db=Te(12),P.Eb=Te(12),P.pb=Te(192),P.kb=Te(4),P.kc=Te(114),P.Fb=ir({},4),P.Rb=ae({}),P.sb=ae({}),P.gb={};for(var He=0;4>He;++He)P.kb[He]=ir({},6);return P}function it(P,He){for(;He>P.O;++P.O)P.ec[P.O]=ir({},3),P.hc[P.O]=ir({},3)}function ee(P,He,de){return tr(He,P.wc,0)?8+(tr(He,P.wc,1)?8+Ln(P.tc,He):Ln(P.hc[de],He)):Ln(P.ec[de],He)}function ae(P){return P.wc=Te(2),P.ec=Te(16),P.hc=Te(16),P.tc=ir({},8),P.O=0,P}function xe(P){zn(P.wc);for(var He=0;P.O>He;++He)zn(P.ec[He].G),zn(P.hc[He].G);zn(P.tc.G)}function Z(P,He,de){var ne,De;if(P.V==null||P.u!=de||P.I!=He)for(P.I=He,P.qc=(1<<He)-1,P.u=de,P.V=Te(De=1<<P.u+P.I),ne=0;De>ne;++ne)P.V[ne]=$({})}function $(P){return P.Ib=Te(768),P}function K(P,He){var de,ne,De,ye;P.jb=He,De=P.a[He].r,ne=P.a[He].j;do P.a[He].t&&(Rr(P.a[De]),P.a[De].r=De-1,P.a[He].Ac&&(P.a[De-1].t=0,P.a[De-1].r=P.a[He].r2,P.a[De-1].j=P.a[He].j2)),de=ne,ne=P.a[ye=De].j,De=P.a[ye].r,P.a[ye].j=de,P.a[ye].r=He,He=ye;while(He>0);return P.mb=P.a[0].j,P.q=P.a[0].r}function X(P){var He;for(P.v=Te(4),P.a=[],P.d={},P.C=Te(192),P.bb=Te(12),P.hb=Te(12),P.Ub=Te(12),P.vc=Te(12),P._=Te(192),P.K=[],P.Sb=Te(114),P.S=mn({},4),P.$=_t({}),P.i=_t({}),P.A={},P.m=[],P.P=[],P.lb=[],P.nc=Te(16),P.x=Te(4),P.Q=Te(4),P.Xb=[dr],P.uc=[dr],P.Kc=[0],P.fc=Te(5),P.yc=Te(128),P.vb=0,P.X=1,P.D=0,P.Hb=-1,P.mb=0,He=0;4096>He;++He)P.a[He]={};for(He=0;4>He;++He)P.K[He]=mn({},6);return P}function B(P){for(var He=0;16>He;++He)P.nc[He]=pr(P.S,He);P.Qb=0}function fe(P){var He,de,ne,De,ye,Qe,Ke,$e;for(De=4;128>De;++De)Qe=le(De),P.yc[De]=Wr(P.Sb,(He=(2|1&Qe)<<(ne=(Qe>>1)-1))-Qe-1,ne,De-He);for(ye=0;4>ye;++ye){for(de=P.K[ye],Ke=ye<<6,Qe=0;P.$b>Qe;++Qe)P.P[Ke+Qe]=Nn(de,Qe);for(Qe=14;P.$b>Qe;++Qe)P.P[Ke+Qe]+=(Qe>>1)-1-4<<6;for($e=128*ye,De=0;4>De;++De)P.lb[$e+De]=P.P[Ke+De];for(;128>De;++De)P.lb[$e+De]=P.P[Ke+le(De)]+P.yc[De]}P.Mb=0}function Ce(P,He){ce(P),function(ne,De){if(ne.Gc){bn(ne.d,ne.C,(ne.l<<4)+De,1),bn(ne.d,ne.bb,ne.l,0),ne.l=7>ne.l?7:10,ft(ne.$,ne.d,0,De);var ye=R(2);Qn(ne.K[ye],ne.d,63),Jn(ne.d,67108863,26),or(ne.S,ne.d,15)}}(P,He&P.y);for(var de=0;5>de;++de)jn(P.d)}function Ze(P,He){var de,ne,De,ye,Qe,Ke,$e,at,ht,Ct,St,kt,Ut,Lt,cn,_n,vn,xn,An,Zn,Kn,Bn,Jr,ui,Zr,kr,Fr,qr,Sr,Dn,li,Hr,Xr,z,T,F,ve,Ae,We,Xe,ot,lt,Tt,Nt;if(P.jb!=P.q)return Ut=P.a[P.q].r-P.q,P.mb=P.a[P.q].j,P.q=P.a[P.q].r,Ut;if(P.q=P.jb=0,P.N?(kt=P.vb,P.N=0):kt=me(P),kr=P.D,2>(ui=H(P.b)+1))return P.mb=-1,1;for(ui>273&&(ui=273),We=0,ht=0;4>ht;++ht)P.x[ht]=P.v[ht],P.Q[ht]=A(P.b,-1,P.x[ht],273),P.Q[ht]>P.Q[We]&&(We=ht);if(P.Q[We]>=P.n)return P.mb=We,D(P,(Ut=P.Q[We])-1),Ut;if(kt>=P.n)return P.mb=P.m[kr-1]+4,D(P,kt-1),kt;if($e=L(P.b,-1),vn=L(P.b,-P.v[0]-1-1),2>kt&&$e!=vn&&2>P.Q[We])return P.mb=-1,1;if(P.a[0].Hc=P.l,P.a[1].z=Fn[P.C[(P.l<<4)+(Xr=He&P.y)]>>>2]+fn(rn(P.A,He,P.J),P.l>=7,vn,$e),Rr(P.a[1]),Ae=(xn=Fn[2048-P.C[(P.l<<4)+Xr]>>>2])+Fn[2048-P.bb[P.l]>>>2],vn==$e&&(Xe=Ae+function(Yt,Rn,nn){return Fn[Yt.hb[Rn]>>>2]+Fn[Yt._[(Rn<<4)+nn]>>>2]}(P,P.l,Xr),P.a[1].z>Xe&&(P.a[1].z=Xe,function(Yt){Yt.j=0,Yt.t=0}(P.a[1]))),2>(St=kt>=P.Q[We]?kt:P.Q[We]))return P.mb=P.a[1].j,1;P.a[1].r=0,P.a[0].bc=P.x[0],P.a[0].ac=P.x[1],P.a[0].dc=P.x[2],P.a[0].lc=P.x[3],Ct=St;do P.a[Ct--].z=268435455;while(Ct>=2);for(ht=0;4>ht;++ht)if(!(2>(ve=P.Q[ht]))){T=Ae+Ie(P,ht,P.l,Xr);do ye=T+mt(P.i,ve-2,Xr),(Dn=P.a[ve]).z>ye&&(Dn.z=ye,Dn.r=0,Dn.j=ht,Dn.t=0);while(--ve>=2)}if(Jr=xn+Fn[P.bb[P.l]>>>2],kt>=(Ct=P.Q[0]>=2?P.Q[0]+1:2)){for(Fr=0;Ct>P.m[Fr];)Fr+=2;for(;ye=Jr+st(P,at=P.m[Fr+1],Ct,Xr),(Dn=P.a[Ct]).z>ye&&(Dn.z=ye,Dn.r=0,Dn.j=at+4,Dn.t=0),Ct!=P.m[Fr]||(Fr+=2)!=kr;++Ct);}for(de=0;;){if(++de==St)return K(P,de);if(An=me(P),kr=P.D,An>=P.n)return P.vb=An,P.N=1,K(P,de);if(++He,Hr=P.a[de].r,P.a[de].t?(--Hr,P.a[de].Ac?(lt=P.a[P.a[de].r2].Hc,lt=4>P.a[de].j2?7>lt?8:11:7>lt?7:10):lt=P.a[Hr].Hc,lt=Fe(lt)):lt=P.a[Hr].Hc,Hr==de-1?lt=P.a[de].j?Fe(lt):7>lt?9:11:(P.a[de].t&&P.a[de].Ac?(Hr=P.a[de].r2,li=P.a[de].j2,lt=7>lt?8:11):lt=4>(li=P.a[de].j)?7>lt?8:11:7>lt?7:10,Sr=P.a[Hr],4>li?li?li==1?(P.x[0]=Sr.ac,P.x[1]=Sr.bc,P.x[2]=Sr.dc,P.x[3]=Sr.lc):li==2?(P.x[0]=Sr.dc,P.x[1]=Sr.bc,P.x[2]=Sr.ac,P.x[3]=Sr.lc):(P.x[0]=Sr.lc,P.x[1]=Sr.bc,P.x[2]=Sr.ac,P.x[3]=Sr.dc):(P.x[0]=Sr.bc,P.x[1]=Sr.ac,P.x[2]=Sr.dc,P.x[3]=Sr.lc):(P.x[0]=li-4,P.x[1]=Sr.bc,P.x[2]=Sr.ac,P.x[3]=Sr.dc)),P.a[de].Hc=lt,P.a[de].bc=P.x[0],P.a[de].ac=P.x[1],P.a[de].dc=P.x[2],P.a[de].lc=P.x[3],Ke=P.a[de].z,$e=L(P.b,-1),vn=L(P.b,-P.x[0]-1-1),ne=Ke+Fn[P.C[(lt<<4)+(Xr=He&P.y)]>>>2]+fn(rn(P.A,He,L(P.b,-2)),lt>=7,vn,$e),Zn=0,(Kn=P.a[de+1]).z>ne&&(Kn.z=ne,Kn.r=de,Kn.j=-1,Kn.t=0,Zn=1),Ae=(xn=Ke+Fn[2048-P.C[(lt<<4)+Xr]>>>2])+Fn[2048-P.bb[lt]>>>2],vn!=$e||de>Kn.r&&!Kn.j||Kn.z>=(Xe=Ae+(Fn[P.hb[lt]>>>2]+Fn[P._[(lt<<4)+Xr]>>>2]))&&(Kn.z=Xe,Kn.r=de,Kn.j=0,Kn.t=0,Zn=1),!(2>(ui=Zr=(Zr=H(P.b)+1)>4095-de?4095-de:Zr))){if(ui>P.n&&(ui=P.n),!Zn&&vn!=$e&&(Nt=Math.min(Zr-1,P.n),(cn=A(P.b,0,P.x[0],Nt))>=2)){for(Tt=Fe(lt),Bn=ne+Fn[2048-P.C[(Tt<<4)+(z=He+1&P.y)]>>>2]+Fn[2048-P.bb[Tt]>>>2],qr=de+1+cn;qr>St;)P.a[++St].z=268435455;ye=Bn+(mt(P.i,cn-2,z)+Ie(P,0,Tt,z)),(Dn=P.a[qr]).z>ye&&(Dn.z=ye,Dn.r=de+1,Dn.j=0,Dn.t=1,Dn.Ac=0)}for(ot=2,F=0;4>F;++F)if(!(2>(Lt=A(P.b,-1,P.x[F],ui)))){_n=Lt;do{for(;de+Lt>St;)P.a[++St].z=268435455;ye=Ae+(mt(P.i,Lt-2,Xr)+Ie(P,F,lt,Xr)),(Dn=P.a[de+Lt]).z>ye&&(Dn.z=ye,Dn.r=de,Dn.j=F,Dn.t=0)}while(--Lt>=2);if(Lt=_n,F||(ot=Lt+1),Zr>Lt&&(Nt=Math.min(Zr-1-Lt,P.n),(cn=A(P.b,Lt,P.x[F],Nt))>=2)){for(Tt=7>lt?8:11,z=He+Lt&P.y,De=Ae+(mt(P.i,Lt-2,Xr)+Ie(P,F,lt,Xr))+Fn[P.C[(Tt<<4)+z]>>>2]+fn(rn(P.A,He+Lt,L(P.b,Lt-1-1)),1,L(P.b,Lt-1-(P.x[F]+1)),L(P.b,Lt-1)),Tt=Fe(Tt),Bn=De+Fn[2048-P.C[(Tt<<4)+(z=He+Lt+1&P.y)]>>>2]+Fn[2048-P.bb[Tt]>>>2],qr=Lt+1+cn;de+qr>St;)P.a[++St].z=268435455;ye=Bn+(mt(P.i,cn-2,z)+Ie(P,0,Tt,z)),(Dn=P.a[de+qr]).z>ye&&(Dn.z=ye,Dn.r=de+Lt+1,Dn.j=0,Dn.t=1,Dn.Ac=1,Dn.r2=de,Dn.j2=F)}}if(An>ui){for(An=ui,kr=0;An>P.m[kr];kr+=2);P.m[kr]=An,kr+=2}if(An>=ot){for(Jr=xn+Fn[P.bb[lt]>>>2];de+An>St;)P.a[++St].z=268435455;for(Fr=0;ot>P.m[Fr];)Fr+=2;for(Lt=ot;;++Lt)if(ye=Jr+st(P,Qe=P.m[Fr+1],Lt,Xr),(Dn=P.a[de+Lt]).z>ye&&(Dn.z=ye,Dn.r=de,Dn.j=Qe+4,Dn.t=0),Lt==P.m[Fr]){if(Zr>Lt&&(Nt=Math.min(Zr-1-Lt,P.n),(cn=A(P.b,Lt,Qe,Nt))>=2)){for(De=ye+Fn[P.C[((Tt=7>lt?7:10)<<4)+(z=He+Lt&P.y)]>>>2]+fn(rn(P.A,He+Lt,L(P.b,Lt-1-1)),1,L(P.b,Lt-(Qe+1)-1),L(P.b,Lt-1)),Tt=Fe(Tt),Bn=De+Fn[2048-P.C[(Tt<<4)+(z=He+Lt+1&P.y)]>>>2]+Fn[2048-P.bb[Tt]>>>2],qr=Lt+1+cn;de+qr>St;)P.a[++St].z=268435455;ye=Bn+(mt(P.i,cn-2,z)+Ie(P,0,Tt,z)),(Dn=P.a[de+qr]).z>ye&&(Dn.z=ye,Dn.r=de+Lt+1,Dn.j=0,Dn.t=1,Dn.Ac=1,Dn.r2=de,Dn.j2=Qe+4)}if((Fr+=2)==kr)break}}}}}function st(P,He,de,ne){var De=R(de);return(128>He?P.lb[128*De+He]:P.P[(De<<6)+function(ye){return 131072>ye?nr[ye>>6]+12:134217728>ye?nr[ye>>16]+32:nr[ye>>26]+52}(He)]+P.nc[15&He])+mt(P.$,de-2,ne)}function Ie(P,He,de,ne){var De;return He?(De=Fn[2048-P.hb[de]>>>2],He==1?De+=Fn[P.Ub[de]>>>2]:(De+=Fn[2048-P.Ub[de]>>>2],De+=Lr(P.vc[de],He-2))):(De=Fn[P.hb[de]>>>2],De+=Fn[2048-P._[(de<<4)+ne]>>>2]),De}function D(P,He){He>0&&(function(de,ne){var De,ye,Qe,Ke,$e,at,ht,Ct,St,kt,Ut,Lt,cn,_n,vn;do{if(de.h>=de.o+de.ob)kt=de.ob;else if(de.xb>(kt=de.h-de.o)){ue(de);continue}for(Ut=de.o>de.p?de.o-de.p:0,ye=de.f+de.o,de.qb?(de.ub[1023&(vn=kn[255&de.c[ye]]^255&de.c[ye+1])]=de.o,de.ub[1024+(65535&(vn^=(255&de.c[ye+2])<<8))]=de.o,at=(vn^kn[255&de.c[ye+3]]<<5)&de.Ec):at=255&de.c[ye]^(255&de.c[ye+1])<<8,Qe=de.ub[de.R+at],de.ub[de.R+at]=de.o,cn=1+(de.k<<1),_n=de.k<<1,Ct=St=de.w,De=de.Fc;;){if(Ut>=Qe||De--==0){de.L[cn]=de.L[_n]=0;break}if(Ke=(de.k>=($e=de.o-Qe)?de.k-$e:de.k-$e+de.p)<<1,de.c[(Lt=de.f+Qe)+(ht=St>Ct?Ct:St)]==de.c[ye+ht]){for(;++ht!=kt&&de.c[Lt+ht]==de.c[ye+ht];);if(ht==kt){de.L[_n]=de.L[Ke],de.L[cn]=de.L[Ke+1];break}}(255&de.c[ye+ht])>(255&de.c[Lt+ht])?(de.L[_n]=Qe,Qe=de.L[_n=Ke+1],St=ht):(de.L[cn]=Qe,Qe=de.L[cn=Ke],Ct=ht)}ue(de)}while(--ne!=0)}(P.b,He),P.s+=He)}function me(P){var He=0;return P.D=function(de,ne){var De,ye,Qe,Ke,$e,at,ht,Ct,St,kt,Ut,Lt,cn,_n,vn,xn,An,Zn,Kn,Bn,Jr;if(de.h>=de.o+de.ob)_n=de.ob;else if(de.xb>(_n=de.h-de.o))return ue(de),0;for(An=0,vn=de.o>de.p?de.o-de.p:0,ye=de.f+de.o,xn=1,Ct=0,St=0,de.qb?(Ct=1023&(Jr=kn[255&de.c[ye]]^255&de.c[ye+1]),St=65535&(Jr^=(255&de.c[ye+2])<<8),kt=(Jr^kn[255&de.c[ye+3]]<<5)&de.Ec):kt=255&de.c[ye]^(255&de.c[ye+1])<<8,Qe=de.ub[de.R+kt]||0,de.qb&&(Ke=de.ub[Ct]||0,$e=de.ub[1024+St]||0,de.ub[Ct]=de.o,de.ub[1024+St]=de.o,Ke>vn&&de.c[de.f+Ke]==de.c[ye]&&(ne[An++]=xn=2,ne[An++]=de.o-Ke-1),$e>vn&&de.c[de.f+$e]==de.c[ye]&&($e==Ke&&(An-=2),ne[An++]=xn=3,ne[An++]=de.o-$e-1,Ke=$e),An!=0&&Ke==Qe&&(An-=2,xn=1)),de.ub[de.R+kt]=de.o,Kn=1+(de.k<<1),Bn=de.k<<1,Lt=cn=de.w,de.w!=0&&Qe>vn&&de.c[de.f+Qe+de.w]!=de.c[ye+de.w]&&(ne[An++]=xn=de.w,ne[An++]=de.o-Qe-1),De=de.Fc;;){if(vn>=Qe||De--==0){de.L[Kn]=de.L[Bn]=0;break}if(at=(de.k>=(ht=de.o-Qe)?de.k-ht:de.k-ht+de.p)<<1,de.c[(Zn=de.f+Qe)+(Ut=cn>Lt?Lt:cn)]==de.c[ye+Ut]){for(;++Ut!=_n&&de.c[Zn+Ut]==de.c[ye+Ut];);if(Ut>xn&&(ne[An++]=xn=Ut,ne[An++]=ht-1,Ut==_n)){de.L[Bn]=de.L[at],de.L[Kn]=de.L[at+1];break}}(255&de.c[ye+Ut])>(255&de.c[Zn+Ut])?(de.L[Bn]=Qe,Qe=de.L[Bn=at+1],cn=Ut):(de.L[Kn]=Qe,Qe=de.L[Kn=at],Lt=Ut)}return ue(de),An}(P.b,P.m),P.D>0&&(He=P.m[P.D-2])==P.n&&(He+=A(P.b,He-1,P.m[P.D-1],273-He)),++P.s,He}function ce(P){P.b&&P.W&&(P.b.cc=null,P.W=0)}function le(P){return 2048>P?nr[P]:2097152>P?nr[P>>10]+20:nr[P>>20]+40}function et(P,He){zn(P.db);for(var de=0;He>de;++de)zn(P.Vb[de].G),zn(P.Wb[de].G);zn(P.ic.G)}function ze(P,He,de,ne,De){var ye,Qe,Ke,$e,at;for(ye=Fn[P.db[0]>>>2],Ke=(Qe=Fn[2048-P.db[0]>>>2])+Fn[P.db[1]>>>2],$e=Qe+Fn[2048-P.db[1]>>>2],at=0,at=0;8>at;++at){if(at>=de)return;ne[De+at]=ye+Nn(P.Vb[He],at)}for(;16>at;++at){if(at>=de)return;ne[De+at]=Ke+Nn(P.Wb[He],at-8)}for(;de>at;++at)ne[De+at]=$e+Nn(P.ic,at-8-8)}function ft(P,He,de,ne){(function(De,ye,Qe,Ke){8>Qe?(bn(ye,De.db,0,0),Qn(De.Vb[Ke],ye,Qe)):(Qe-=8,bn(ye,De.db,0,1),8>Qe?(bn(ye,De.db,1,0),Qn(De.Wb[Ke],ye,Qe)):(bn(ye,De.db,1,1),Qn(De.ic,ye,Qe-8)))})(P,He,de,ne),--P.sc[ne]==0&&(ze(P,ne,P.rb,P.Cc,272*ne),P.sc[ne]=P.rb)}function _t(P){return function(He){He.db=Te(2),He.Vb=Te(16),He.Wb=Te(16),He.ic=mn({},8);for(var de=0;16>de;++de)He.Vb[de]=mn({},3),He.Wb[de]=mn({},3)}(P),P.Cc=[],P.sc=[],P}function mt(P,He,de){return P.Cc[272*de+He]}function Ve(P,He){for(var de=0;He>de;++de)ze(P,de,P.rb,P.Cc,272*de),P.sc[de]=P.rb}function Ot(P,He,de){var ne,De;if(P.V==null||P.u!=de||P.I!=He)for(P.I=He,P.qc=(1<<He)-1,P.u=de,P.V=Te(De=1<<P.u+P.I),ne=0;De>ne;++ne)P.V[ne]=Tn({})}function rn(P,He,de){return P.V[((He&P.qc)<<P.u)+((255&de)>>>8-P.u)]}function an(P,He,de){var ne,De,ye=1;for(De=7;De>=0;--De)bn(He,P.tb,ye,ne=de>>De&1),ye=ye<<1|ne}function In(P,He,de,ne){var De,ye,Qe,Ke,$e=1,at=1;for(ye=7;ye>=0;--ye)De=ne>>ye&1,Ke=at,$e&&(Ke+=1+(Qe=de>>ye&1)<<8,$e=Qe==De),bn(He,P.tb,Ke,De),at=at<<1|De}function Tn(P){return P.tb=Te(768),P}function fn(P,He,de,ne){var De,ye,Qe=1,Ke=7,$e=0;if(He){for(;Ke>=0;--Ke)if($e+=Lr(P.tb[(1+(ye=de>>Ke&1)<<8)+Qe],De=ne>>Ke&1),Qe=Qe<<1|De,ye!=De){--Ke;break}}for(;Ke>=0;--Ke)$e+=Lr(P.tb[Qe],De=ne>>Ke&1),Qe=Qe<<1|De;return $e}function Rr(P){P.j=-1,P.t=0}function ir(P,He){return P.F=He,P.G=Te(1<<He),P}function Ln(P,He){var de,ne=1;for(de=P.F;de!=0;--de)ne=(ne<<1)+tr(He,P.G,ne);return ne-(1<<P.F)}function mn(P,He){return P.F=He,P.G=Te(1<<He),P}function Qn(P,He,de){var ne,De,ye=1;for(De=P.F;De!=0;)--De,bn(He,P.G,ye,ne=de>>>De&1),ye=ye<<1|ne}function Nn(P,He){var de,ne,De=1,ye=0;for(ne=P.F;ne!=0;)--ne,ye+=Lr(P.G[De],de=He>>>ne&1),De=(De<<1)+de;return ye}function or(P,He,de){var ne,De,ye=1;for(De=0;P.F>De;++De)bn(He,P.G,ye,ne=1&de),ye=ye<<1|ne,de>>=1}function pr(P,He){var de,ne,De=1,ye=0;for(ne=P.F;ne!=0;--ne)de=1&He,He>>>=1,ye+=Lr(P.G[De],de),De=De<<1|de;return ye}function sr(P,He,de,ne,De){var ye,Qe,Ke=1;for(Qe=0;ne>Qe;++Qe)bn(de,P,He+Ke,ye=1&De),Ke=Ke<<1|ye,De>>=1}function Wr(P,He,de,ne){var De,ye,Qe=1,Ke=0;for(ye=de;ye!=0;--ye)De=1&ne,ne>>>=1,Ke+=Fn[(2047&(P[He+Qe]-De^-De))>>>2],Qe=Qe<<1|De;return Ke}function tr(P,He,de){var ne,De=He[de];return(-2147483648^(ne=(P.E>>>11)*De))>(-2147483648^P.Bb)?(P.E=ne,He[de]=De+(2048-De>>>5)<<16>>16,-16777216&P.E||(P.Bb=P.Bb<<8|G(P.Ab),P.E<<=8),0):(P.E-=ne,P.Bb-=ne,He[de]=De-(De>>>5)<<16>>16,-16777216&P.E||(P.Bb=P.Bb<<8|G(P.Ab),P.E<<=8),1)}function zn(P){for(var He=P.length-1;He>=0;--He)P[He]=1024}function bn(P,He,de,ne){var De,ye=He[de];De=(P.E>>>11)*ye,ne?(P.xc=E(P.xc,w(Me(De),[4294967295,0])),P.E-=De,He[de]=ye-(ye>>>5)<<16>>16):(P.E=De,He[de]=ye+(2048-ye>>>5)<<16>>16),-16777216&P.E||(P.E<<=8,jn(P))}function Jn(P,He,de){for(var ne=de-1;ne>=0;--ne)P.E>>>=1,(He>>>ne&1)==1&&(P.xc=E(P.xc,Me(P.E))),-16777216&P.E||(P.E<<=8,jn(P))}function zr(P){return E(E(Me(P.Jb),P.mc),[4,0])}function jn(P){var He,de=nt(function(ne,De){var ye;return ye=Q(ne,De&=63),0>ne[1]&&(ye=E(ye,W([2,0],63-De))),ye}(P.xc,32));if(de!=0||Re(P.xc,[4278190080,0])<0){P.mc=E(P.mc,Me(P.Jb)),He=P.Oc;do v(P.Ab,He+de),He=255;while(--P.Jb!=0);P.Oc=nt(P.xc)>>>24}++P.Jb,P.xc=W(w(P.xc,[16777215,0]),8)}function Lr(P,He){return Fn[(2047&(P-He^-He))>>>2]}function Vr(P){for(var He,de,ne,De=0,ye=0,Qe=P.length,Ke=[],$e=[];Qe>De;++De,++ye){if(128&(He=255&P[De]))if((224&He)==192){if(De+1>=Qe||(192&(de=255&P[++De]))!=128)return P;$e[ye]=(31&He)<<6|63&de}else{if((240&He)!=224||De+2>=Qe||(192&(de=255&P[++De]))!=128||(192&(ne=255&P[++De]))!=128)return P;$e[ye]=(15&He)<<12|(63&de)<<6|63&ne}else{if(!He)return P;$e[ye]=He}ye==16383&&(Ke.push(String.fromCharCode.apply(String,$e)),ye=-1)}return ye>0&&($e.length=ye,Ke.push(String.fromCharCode.apply(String,$e))),Ke.join("")}function Ai(P){var He,de,ne,De=[],ye=0,Qe=P.length;if(typeof P=="object")return P;for(function(Ke,$e,at,ht,Ct){var St;for(St=$e;at>St;++St)ht[Ct++]=Ke.charCodeAt(St)}(P,0,Qe,De,0),ne=0;Qe>ne;++ne)(He=De[ne])>=1&&127>=He?++ye:ye+=!He||He>=128&&2047>=He?2:3;for(de=[],ye=0,ne=0;Qe>ne;++ne)(He=De[ne])>=1&&127>=He?de[ye++]=He<<24>>24:!He||He>=128&&2047>=He?(de[ye++]=(192|He>>6&31)<<24>>24,de[ye++]=(128|63&He)<<24>>24):(de[ye++]=(224|He>>12&15)<<24>>24,de[ye++]=(128|He>>6&63)<<24>>24,de[ye++]=(128|63&He)<<24>>24);return de}function Yr(P){return P[1]+P[0]}var Qr=1,Ci=2,Si=3,ri=typeof setImmediate=="function"?setImmediate:setTimeout,fr=4294967296,Yn=[4294967295,-fr],yi=[0,-9223372036854776e3],dr=[0,0],ii=[1,0],kn=function(){var P,He,de,ne=[];for(P=0;256>P;++P){for(de=P,He=0;8>He;++He)1&de?de=de>>>1^-306674912:de>>>=1;ne[P]=de}return ne}(),nr=function(){var P,He,de,ne=2,De=[0,1];for(de=2;22>de;++de)for(He=1<<(de>>1)-1,P=0;He>P;++P,++ne)De[ne]=de<<24>>24;return De}(),Fn=function(){var P,He,de,ne=[];for(He=8;He>=0;--He)for(P=1<<9-He,de=1<<9-He-1;P>de;++de)ne[de]=(He<<6)+(P-de<<6>>>9-He-1);return ne}(),_r=function(){var P=[{s:16,f:64,m:0},{s:20,f:64,m:0},{s:19,f:64,m:1},{s:20,f:64,m:1},{s:21,f:128,m:1},{s:22,f:128,m:1},{s:23,f:128,m:1},{s:24,f:255,m:1},{s:25,f:255,m:1}];return function(He){return P[He-1]||P[6]}}();return typeof onmessage>"u"||typeof window<"u"&&window.document!==void 0||(onmessage=function(P){P&&P.gc&&(P.gc.action==Ci?It.decompress(P.gc.gc,P.gc.cbn):P.gc.action==Qr&&It.compress(P.gc.gc,P.gc.Rc,P.gc.cbn))}),{compress:function(P,He,de,ne){var De,ye,Qe={},Ke=de===void 0&&ne===void 0;if(typeof de!="function"&&(ye=de,de=ne=0),ne=ne||function($e){return ye!==void 0?Ye($e,ye):void 0},de=de||function($e,at){return ye!==void 0?postMessage({action:Qr,cbn:ye,result:$e,error:at}):void 0},Ke){for(Qe.c=y({},Ai(P),_r(He));te(Qe.c.yb););return N(Qe.c.Nb)}try{Qe.c=y({},Ai(P),_r(He)),ne(0)}catch($e){return de(null,$e)}ri(function $e(){try{for(var at,ht=new Date().getTime();te(Qe.c.yb);)if(De=Yr(Qe.c.yb.Pb)/Yr(Qe.c.Tb),new Date().getTime()-ht>200)return ne(De),ri($e,0),0;ne(1),at=N(Qe.c.Nb),ri(de.bind(null,at),0)}catch(Ct){de(null,Ct)}},0)},decompress:function(P,He,de){var ne,De,ye,Qe,Ke={},$e=He===void 0&&de===void 0;if(typeof He!="function"&&(De=He,He=de=0),de=de||function(at){return De!==void 0?Ye(ye?at:-1,De):void 0},He=He||function(at,ht){return De!==void 0?postMessage({action:Ci,cbn:De,result:at,error:ht}):void 0},$e){for(Ke.d=Y({},P);te(Ke.d.yb););return Vr(N(Ke.d.Nb))}try{Ke.d=Y({},P),Qe=Yr(Ke.d.Tb),ye=Qe>-1,de(0)}catch(at){return He(null,at)}ri(function at(){try{for(var ht,Ct=0,St=new Date().getTime();te(Ke.d.yb);)if(++Ct%1e3==0&&new Date().getTime()-St>200)return ye&&(ne=Yr(Ke.d.yb.Z.g)/Qe,de(ne)),ri(at,0),0;de(1),ht=Vr(N(Ke.d.Nb)),ri(He.bind(null,ht),0)}catch(kt){He(null,kt)}},0)}}}();this.G=It},8866:function(It,Ye,Te){Te.d(Ye,{AA:function(){return U},EK:function(){return J},FP:function(){return W},M$:function(){return N},OY:function(){return se},P1:function(){return k},QS:function(){return Le},Rl:function(){return Ee},UY:function(){return R},VJ:function(){return nt},VU:function(){return ue},Wk:function(){return ge},aw:function(){return Y},d1:function(){return G},dO:function(){return L},fT:function(){return y},fU:function(){return Se},gU:function(){return _},h2:function(){return H},iq:function(){return be},jy:function(){return v},kP:function(){return f},l3:function(){return Me},lA:function(){return oe},pl:function(){return C},pt:function(){return M},qC:function(){return A},rA:function(){return Q},sb:function(){return Ne},sg:function(){return te},v5:function(){return pe},yo:function(){return Fe},zQ:function(){return b}});var E=Te(7202),w=Te(8627),Re=Te(4872),we=Te(4908),he=function(Ue,it,ee){if(ee||arguments.length===2)for(var ae,xe=0,Z=it.length;xe<Z;xe++)!ae&&xe in it||(ae||(ae=Array.prototype.slice.call(it,0,xe)),ae[xe]=it[xe]);return Ue.concat(ae||Array.prototype.slice.call(it))},Me=Promise,nt=document;function Ne(Ue,it,ee){ee===void 0&&(ee=!0);var ae=nt.createElement("video");return Ue&&(ae.style.width=Ue+"px;"),it&&(ae.style.height=it+"px;"),ae.setAttribute("muted",""),ae.muted=!0,ee&&(ae.setAttribute("autoplay",""),ae.autoplay=!0),ae.setAttribute("playsinline",""),ae.setAttribute("webkit-playsinline",""),ae}function W(Ue,it){var ee=nt.createElement("canvas");return ee.width=Ue,ee.height=it,ee}function Q(Ue,it,ee){ee===void 0&&(ee=""),Ue.info("".concat(it," call ").concat(ee))}function se(Ue,it,ee){ee===void 0&&(ee=""),Ue.info("".concat(it," end ").concat(ee))}function J(Ue,it,ee){ee===void 0&&(ee=""),Ue.info("".concat(it," success ").concat(ee))}function G(Ue,it){var ee=function(ae){var xe=ae.reduce(function(Z,$,K){var X="".concat($," module");return K==0?X:K==ae.length-1?"".concat(Z," and ").concat(X):"".concat(Z,", ").concat(X)},"");return"should install ".concat(xe)}(Ue);return console.error(ee),{errorCode:it||w.UZK.code,extendedData:ee}}function U(Ue,it){return new Me(function(ee,ae){ae(G(Ue,it))})}function C(Ue){return E.A.isLong(Ue)?Ue.toNumber():0}function N(Ue,it){for(var ee in Ue){if(E.A.isLong(Ue[ee])||(0,Re.JO)(Ue[ee]||(0,Re.G0)(Ue[ee])))return;Array.isArray(Ue[ee])?Ue[ee].forEach(function(ae,xe){N(ae)}):(0,Re.w)(Ue[ee])?N(Ue[ee]):Ue.hasOwnProperty(ee)||((0,Re.Cs)(Ue[ee])&&(Ue[ee]=0),(0,Re.QP)(Ue[ee])&&(Ue[ee]=""))}}function v(Ue){return/^([0-9a-zA-Z#!$%&()`'+-;<=.>@^_~,\\*])+$/.test(Ue)&&/^[^:/]*$/g.test(Ue)}function f(Ue){return/^([0-9a-zA-Z-_])+$/.test(Ue)}function _(Ue){return!!(Ue.startsWith("rtmp://")||Ue.startsWith("avertp://")||Ue.startsWith("https://")&&Ue.endsWith(".flv")||Ue.startsWith("https://")&&Ue.endsWith(".m3u8"))}function b(Ue,it){return it==0?(0,Re.Cs)(Ue)&&Ue%1==0&&Ue>=0:(0,Re.Cs)(Ue)&&Ue%1==0&&Ue>0}var y="room not exist",M="device is not found",Y="stream is not from zego",L="input param error",A="local stream wrong",H="no preview",ge="publish stream no found",Ee="network is broken";function Se(Ue,it,ee,ae,xe,Z,$){return $===void 0&&($=!1),Ue.createSpan(it,{key:xe,bak_key:Z,par:ee},{key:ae,par:ee},ae,$)}function ue(Ue,it,ee){for(var ae in ee)we.tH.includes(ae)&&Ue>=1&&it.setAttribute(ae,ee[ae])}function oe(Ue,it,ee){it&&Ue.setAttributes(it),Ue.end(ee)}function be(Ue){return JSON.stringify(Ue)}function Le(Ue){return JSON.parse(Ue)}function pe(Ue,it){for(var ee=[],ae=2;ae<arguments.length;ae++)ee[ae-2]=arguments[ae];return setTimeout.apply(void 0,he([Ue,it],ee,!1))}function k(Ue){return clearTimeout(Ue)}var R=function(){return new Promise(function(Ue,it){Ue(Math.random())})};function Fe(Ue,it){return Ue===void 0&&(Ue=0),it||(it="_zegom{codecid}"),Ue===0?"_zego264":it.replace("{codecid}",Ue+"")}function te(Ue,it){var ee;return it===void 0&&(it=100),function(){for(var ae=[],xe=0;xe<arguments.length;xe++)ae[xe]=arguments[xe];var Z=this;clearTimeout(ee),ee=window.setTimeout(function(){Ue.apply(Z,ae)},it)}}},8899:function(It,Ye,Te){var E,w,Re,we;Te.d(Ye,{UF:function(){return Re},eI:function(){return E},ju:function(){return we},kf:function(){return w}}),function(he){he[he.Off=0]="Off",he[he.TurningOn=1]="TurningOn",he[he.On=2]="On"}(E||(E={})),function(he){he[he.World=0]="World",he[he.Team=1]="Team",he[he.SecretTeam=2]="SecretTeam"}(w||(w={})),function(he){he[he.All=0]="All",he[he.World=1]="World",he[he.Team=2]="Team"}(Re||(Re={})),function(he){he[he.All=0]="All",he[he.World=1]="World",he[he.Team=2]="Team"}(we||(we={}))},9021:function(It,Ye,Te){var E;It.exports=(E=E||function(w,Re){var we;if(typeof window<"u"&&window.crypto&&(we=window.crypto),typeof self<"u"&&self.crypto&&(we=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(we=globalThis.crypto),!we&&typeof window<"u"&&window.msCrypto&&(we=window.msCrypto),!we&&Te.g!==void 0&&Te.g.crypto&&(we=Te.g.crypto),!we)try{we=Te(477)}catch{}var he=function(){if(we){if(typeof we.getRandomValues=="function")try{return we.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof we.randomBytes=="function")try{return we.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},Me=Object.create||function(){function v(){}return function(f){var _;return v.prototype=f,_=new v,v.prototype=null,_}}(),nt={},Ne=nt.lib={},W=Ne.Base={extend:function(v){var f=Me(this);return v&&f.mixIn(v),f.hasOwnProperty("init")&&this.init!==f.init||(f.init=function(){f.$super.init.apply(this,arguments)}),f.init.prototype=f,f.$super=this,f},create:function(){var v=this.extend();return v.init.apply(v,arguments),v},init:function(){},mixIn:function(v){for(var f in v)v.hasOwnProperty(f)&&(this[f]=v[f]);v.hasOwnProperty("toString")&&(this.toString=v.toString)},clone:function(){return this.init.prototype.extend(this)}},Q=Ne.WordArray=W.extend({init:function(v,f){v=this.words=v||[],this.sigBytes=f!=Re?f:4*v.length},toString:function(v){return(v||J).stringify(this)},concat:function(v){var f=this.words,_=v.words,b=this.sigBytes,y=v.sigBytes;if(this.clamp(),b%4)for(var M=0;M<y;M++)f[b+M>>>2]|=(_[M>>>2]>>>24-M%4*8&255)<<24-(b+M)%4*8;else for(var Y=0;Y<y;Y+=4)f[b+Y>>>2]=_[Y>>>2];return this.sigBytes+=y,this},clamp:function(){var v=this.words,f=this.sigBytes;v[f>>>2]&=4294967295<<32-f%4*8,v.length=w.ceil(f/4)},clone:function(){var v=W.clone.call(this);return v.words=this.words.slice(0),v},random:function(v){for(var f=[],_=0;_<v;_+=4)f.push(he());return new Q.init(f,v)}}),se=nt.enc={},J=se.Hex={stringify:function(v){for(var f=v.words,_=v.sigBytes,b=[],y=0;y<_;y++){var M=f[y>>>2]>>>24-y%4*8&255;b.push((M>>>4).toString(16)),b.push((15&M).toString(16))}return b.join("")},parse:function(v){for(var f=v.length,_=[],b=0;b<f;b+=2)_[b>>>3]|=parseInt(v.substr(b,2),16)<<24-b%8*4;return new Q.init(_,f/2)}},G=se.Latin1={stringify:function(v){for(var f=v.words,_=v.sigBytes,b=[],y=0;y<_;y++)b.push(String.fromCharCode(f[y>>>2]>>>24-y%4*8&255));return b.join("")},parse:function(v){for(var f=v.length,_=[],b=0;b<f;b++)_[b>>>2]|=(255&v.charCodeAt(b))<<24-b%4*8;return new Q.init(_,f)}},U=se.Utf8={stringify:function(v){try{return decodeURIComponent(escape(G.stringify(v)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(v){return G.parse(unescape(encodeURIComponent(v)))}},C=Ne.BufferedBlockAlgorithm=W.extend({reset:function(){this._data=new Q.init,this._nDataBytes=0},_append:function(v){typeof v=="string"&&(v=U.parse(v)),this._data.concat(v),this._nDataBytes+=v.sigBytes},_process:function(v){var f,_=this._data,b=_.words,y=_.sigBytes,M=this.blockSize,Y=y/(4*M),L=(Y=v?w.ceil(Y):w.max((0|Y)-this._minBufferSize,0))*M,A=w.min(4*L,y);if(L){for(var H=0;H<L;H+=M)this._doProcessBlock(b,H);f=b.splice(0,L),_.sigBytes-=A}return new Q.init(f,A)},clone:function(){var v=W.clone.call(this);return v._data=this._data.clone(),v},_minBufferSize:0}),N=(Ne.Hasher=C.extend({cfg:W.extend(),init:function(v){this.cfg=this.cfg.extend(v),this.reset()},reset:function(){C.reset.call(this),this._doReset()},update:function(v){return this._append(v),this._process(),this},finalize:function(v){return v&&this._append(v),this._doFinalize()},blockSize:16,_createHelper:function(v){return function(f,_){return new v.init(_).finalize(f)}},_createHmacHelper:function(v){return function(f,_){return new N.HMAC.init(v,_).finalize(f)}}}),nt.algo={});return nt}(Math),E)},9506:function(It,Ye,Te){var E,w,Re,we,he,Me,nt;It.exports=(nt=Te(9021),Te(5471),Te(1025),we=(w=(E=nt).lib).WordArray,Me=(he=E.algo).EvpKDF=(Re=w.Base).extend({cfg:Re.extend({keySize:4,hasher:he.MD5,iterations:1}),init:function(Ne){this.cfg=this.cfg.extend(Ne)},compute:function(Ne,W){for(var Q,se=this.cfg,J=se.hasher.create(),G=we.create(),U=G.words,C=se.keySize,N=se.iterations;U.length<C;){Q&&J.update(Q),Q=J.update(Ne).finalize(W),J.reset();for(var v=1;v<N;v++)Q=J.finalize(Q),J.reset();G.concat(Q)}return G.sigBytes=4*C,G}}),E.EvpKDF=function(Ne,W,Q){return Me.create(Q).compute(Ne,W)},nt.EvpKDF)},9674:function(It,Ye,Te){Te.d(Ye,{MixStream:function(){return xe}});var E=Te(8627),w={NOT_LOGIN:E.S4u,INPUT_PARAM:E.ZEp,TIMEOUT:E.Q9p,MIXER_NO_SERVICES:{code:1005e3,message:"no mix stream service"},MIXER_TASK_ID_NULL:{code:1005001,message:"mixer task is null"},MIXER_TASK_ID_TOO_LONG:{code:1005002,message:"task ID is too long"},MIXER_TASK_ID_INVALID_CHARACTER:{code:1005003,message:"task ID contains illegal characters"},MIXER_NO_OUTPUT_TARGET:{code:1005005,message:"task configuration does not specify output"},MIXER_OUTPUT_TARGET_INVALID:{code:1005006,message:"stream output target is incorrect"},MIXER_START_REQUEST_ERROR:{code:1005010,message:"start mixer task fail, possibly due to network reasons"},MIXER_STOP_REQUEST_ERROR:{code:1005011,message:"stop mixer task fail, possibly due to network reasons"},MIXER_NOT_OWNER_STOP_MIXER:{code:1005012,message:" maxed task must be stopped by the start user of the task"},MIXER_INPUTLIST_NULL:{code:1005020,message:"Mixed stream task input list is null"},MIXER_OUTPUTLIST_NULL:{code:1005021,message:"Mixed stream task output list is null"},MIXER_VIDEO_CONFIG_INVALID:{code:1005023,message:"invalid mixed stream task video configuration"},MIXER_EXCEED_MAX_INPUT_COUNT:{code:1005025,message:"more than the maximum number of input streams"},MIXER_INPUT_STREAM_NOT_EXISTS:{code:1005026,message:"Input stream does not exist"},MIXER_INPUT_PARAMETERS_ERROR:{code:1005027,message:"mix stream input parameters are wrong"},MIXER_INPUT_LABEL_TOO_LONG:{code:1005028,message:"Input stream label text is too long"},MIXER_OUTPUT_TARGET_TOO_LONG:{code:1005029,message:"Output stream target is too long"},MIXER_EXCEED_MAX_OUTPUT_COUNT:{code:1005030,message:"more than the maximum number of output streams"},MIXER_INPUT_IMAGE_URL_TOO_LONG:{code:1005034,message:"Input stream image url too long"},MIXER_INPUT_IMAGE_FORMAT_WRONG:{code:1005035,message:"Input stream image format wrong"},MIXER_INPUT_IMAGE_GET_FAIL:{code:1005036,message:"Input stream image get fail"},MIXER_AUTHENTICATION_FAILED:{code:1005050,message:"mixed stream authentication failed"},MIXER_WATERMARK_NULL:{code:1005061,mag:"input watermark is null"},MIXER_WATERMARK_PARAMETERS_ERROR:{code:1005062,message:"input watermark parameter is wrong"},MIXER_WATERMARK_URL_INVALID:{code:1005063,message:"illegal input watermark URL"},MIXER_BACKGROUND_IMAGE_URL_INVALID:{code:1005067,message:"illegal input background image URL"},MIXER_REPEAT_INPUT:{code:1005099,message:"mix stream input repeat"},MIXER_INNER_ERROR:{code:1005099,message:"mixer internal error"}},Re=Te(9728),we=Te(3788);const he=Te(6994);(we=we.default||we).util.Long=he.default||he,we.util.Long.fromBits=we.util.Long.fromBits||function(){return 0};for(var Me=we.roots,nt=we.types?we.types.basic:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0,string:2,bytes:2},Ne=we.types?we.types.packed:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0},W=Object.keys(nt),Q={$:function(Z){return Q[Z]?Q[Z].call(this):Me[Z].decode?Me[Z].decode(this,this.uint32()):Q.$.call(this,"int32")}},se={$:function(Z,$,K){var X=nt[Z];return X===void 0?Me[Z].encode?(this.uint32(K<<3|2).fork(),Me[Z].encode($,this).ldelim()):se.$.call(this,"int32",$,K):se[Z].call(this.uint32(K<<3|X),$)}},J=0;J<W.length;J++)Q[W[J]]=we.Reader.prototype[W[J]],se[W[J]]=we.Writer.prototype[W[J]];(function Z($,K,X,B){for(var fe=0,Ce=Object.keys($);fe<Ce.length;fe++){var Ze=Ce[fe];if($[Ze].$m&&Object.keys($[Ze].$m).every(function(st){return Number(st)})){if(X[Ze])throw Error(`nested type ${X}.${Ze} has already exist`);X[Ze]=function(st,Ie){function D(ze){for(var ft in st){var _t=st[ft];_t[1].charAt(0)==="{"?this[_t[0]]={}:_t[1].charAt(0)!=="["&&_t[1].charAt(0)!=="<"||(this[_t[0]]=[])}if(ze)for(var mt=Object.keys(ze),Ve=0;Ve<mt.length;++Ve)ze[mt[Ve]]!=null&&(this[mt[Ve]]=ze[mt[Ve]])}var me={};for(var ce in st){var le=st[ce],et=le[1];et.charAt(0)==="{"?(D.prototype[le[0]]=we.util.emptyObject,me[et]={$m:et.substring(1).split(",").map(function(ze,ft){return[`$${ft+1}`,ze,null]}).reduce(function(ze,ft,_t){return ze[_t+1]=ft,ze},{})}):D.prototype[le[0]]=et.charAt(0)==="["||et.charAt(0)==="<"?we.util.emptyArray:et==="bytes"?we.util.newBuffer([]):le[2]&&le[2].hasOwnProperty("low")&&le[2].hasOwnProperty("high")?we.util.Long.fromBits(le[2].low,le[2].high,le[2].unsigned):le[2]}return D.create=function(ze){return new D(ze)},D.decode=function(ze,ft){ze instanceof we.Reader||(ze=we.Reader.create(ze));for(var _t=ft===void 0?ze.len:ze.pos+ft,mt=new D;ze.pos<_t;){var Ve=ze.uint32(),Ot=Ve>>>3;if(Ot>0&&st[Ot]){var rn=st[Ot][0],an=st[Ot][1];if(an.charAt(0)==="{"){mt[rn]===we.util.emptyObject&&(mt[rn]={});var In=D.$namespace[an].decode(ze,ze.uint32());mt[rn][In.$1]=In.$2}else if(an.charAt(0)==="["||an.charAt(0)==="<")if(an=an.substring(1),mt[rn]&&mt[rn].length||(mt[rn]=[]),Ne[an=!Q[an]&&!Me[an].decode?"int32":an]!==void 0&&(7&Ve)==2)for(var Tn=ze.uint32()+ze.pos;ze.pos<Tn;)mt[rn].push(Q.$.call(ze,an));else mt[rn].push(Q.$.call(ze,an));else mt[rn]=Q.$.call(ze,an)}else ze.skipType(7&Ve)}return mt},D.encode=function(ze,ft){for(var _t in ft||(ft=we.Writer.create()),st){var mt=st[_t][0],Ve=st[_t][1];if(Ve.charAt(0)==="{"){if(ze[mt]!=null&&ze.hasOwnProperty(mt))for(var Ot=0,rn=Object.keys(ze[mt]);Ot<rn.length;++Ot)ft.uint32(_t<<3|2).fork(),D.$namespace[Ve].encode({$1:rn[Ot],$2:ze[mt][rn[Ot]]},ft).ldelim()}else if(Ve.charAt(0)==="["||Ve.charAt(0)==="<"){var an=Ve.charAt(0)==="<";Ve=Ve.substring(1);var In=ze[mt];if(In!=null&&In.length)if(Ve=nt[Ve]===void 0&&!Me[Ve].encode?"int32":Ve,an&&Ne[Ve]!==void 0){for(ft.uint32(_t<<3|2).fork(),Ot=0;Ot<In.length;Ot++)se[Ve].call(ft,In[Ot]);ft.ldelim()}else for(Ot=0;Ot<In.length;Ot++)se.$.call(ft,Ve,In[Ot],_t)}else ze[mt]!=null&&ze.hasOwnProperty(mt)&&se.$.call(ft,Ve,ze[mt],_t)}return ft},Object.keys(me).length&&(D.$namespace=Z(me,K+"."+Ie,D.$namespace||{},!0)),D}($[Ze].$m,Ze)}else $[Ze].$s?X[Ze]=function(st,Ie){function D(me,ce,le){we.rpc.Service.call(this,me,ce,le)}return(D.prototype=Object.create(we.rpc.Service.prototype)).constructor=D,D.create=function(me,ce,le){return new D(me,ce,le)},Object.keys(st).forEach(function(me){var ce=st[me];function le(et,ze){return this.rpcCall(le,Me[ce[0]],Me[ce[1]],et,ze)}Object.defineProperty(le,"name",{value:me}),Object.defineProperty(le,"path",{value:`${K}.${Ie}`}),D.prototype[me]=le}),D}($[Ze].$s,Ze):$[Ze].$e&&Object.values($[Ze].$e).every(function(st){return Number(st)===st})&&(X[Ze]=function(st){for(var Ie=Object.keys(st),D={},me=0;me<Ie.length;me++)D[D[Ie[me]]=st[Ie[me]]]=Ie[me];return D}($[Ze].$e));X[Ze]&&!B&&(Me[`${K}.${Ze}`]=X[Ze]),delete $[Ze].$m,delete $[Ze].$s,delete $[Ze].$e,X[Ze]=Z($[Ze],K?`${K}.${Ze}`:Ze,X[Ze]||{})}return X})({mixstream:{proto_mixstream:{AutoRoomMixOutputStream:{$m:{1:["stream_out_common","mixstream.proto_mixstream.MixOutputStreamCommon",null],2:["audio_channel_cnt","int32",0]}},AutoRoomMixStreamStartRequest:{$m:{1:["request_seq","uint32",0],2:["mix_stream_common","mixstream.proto_mixstream.MixStreamCommon",null],3:["mix_source","string",""],4:["room_id","string",""],5:["task_id","string",""],6:["water_mark","mixstream.proto_mixstream.MixWaterMark",null],7:["output_stream","<mixstream.proto_mixstream.AutoRoomMixOutputStream",null],8:["extra_params","<mixstream.proto_mixstream.MixAdvanceConfig",null],9:["has_recv_buffer_level","bool",!1],10:["recv_buffer_level","sint32",0]}},AutoRoomMixStreamStartResponse:{$m:{1:["request_seq","uint32",0],2:["common_response","mixstream.proto_mixstream.MixstreamServerCommonResponse",null]}},AutoRoomMixStreamStopRequest:{$m:{1:["request_seq","uint32",0],2:["task_id","string",""],3:["room_id","string",""]}},AutoRoomMixStreamStopResponse:{$m:{1:["request_seq","uint32",0],2:["common_response","mixstream.proto_mixstream.MixstreamServerCommonResponse",null]}},GetMixStreamStatusRequest:{$m:{1:["request_seq","uint32",0],2:["task_id","string",""]}},GetMixStreamStatusResponse:{$m:{1:["request_seq","uint32",0],2:["common_response","mixstream.proto_mixstream.MixstreamServerCommonResponse",null],3:["push_url","<mixstream.proto_mixstream.PushUrl",null],4:["version","int32",0],5:["task_id","string",""]}},MixAdvanceConfig:{$m:{1:["key","string",""],2:["value","string",""]}},MixImage:{$m:{1:["url","string",""],2:["display_mode","int32",0]}},MixInputStream:{$m:{1:["stream_input_common","mixstream.proto_mixstream.MixInputStreamCommon",null],2:["volume","int32",0],3:["audio_focus","int32",0],4:["audio_h_angle","int32",0],5:["render_mode","int32",0],6:["corner_radius","uint32",0],7:["label","mixstream.proto_mixstream.MixLabel",null],8:["image","mixstream.proto_mixstream.MixImage",null]}},MixInputStreamCommon:{$m:{1:["stream_id","string",""],2:["sound_level_id","uint32",0],3:["content_control","int32",0],4:["layer_rect","mixstream.proto_mixstream.MixRect",null],5:["stream_url","string",""]}},MixLabel:{$m:{1:["text","string",""],2:["text_left","int32",0],3:["text_top","int32",0],4:["font","mixstream.proto_mixstream.MixLableFont",null]}},MixLableFont:{$m:{1:["font_type","int32",0],2:["font_size","int32",0],3:["font_color","int32",0],4:["font_transparency","int32",0],5:["font_border_color","sint32",0]}},MixOutputStream:{$m:{1:["output_stream_common","mixstream.proto_mixstream.MixOutputStreamCommon",null],2:["video_enc_id","int32",0],3:["video_encode_latency","int32",0],4:["video_encode_profile","int32",0],5:["low_bitrate_hd","int32",0]}},MixOutputStreamCommon:{$m:{1:["is_url","int32",0],2:["target","string",""],3:["video_fps","int32",0],4:["rate_control_mode","int32",0],5:["video_bitrate","int32",0],6:["video_width","int32",0],7:["video_height","int32",0],8:["output_quality","int32",0],9:["audio_bitrate","int32",0],10:["audio_enc_id","int32",0]}},MixRect:{$m:{1:["top","int32",0],2:["left","int32",0],3:["bottom","int32",0],4:["right","int32",0],5:["layer","int32",0]}},MixStartReplyData:{$m:{1:["request_id","string",""],2:["play_infos","<mixstream.proto_mixstream.PlayInfo",null]}},MixStreamCommon:{$m:{1:["user_data","string",""],2:["output_bg_color","int32",0],3:["output_bg_image","string",""],4:["with_sound_level","int32",0],5:["single_stream_pass_through","int32",0],6:["alignment_type","int32",0]}},MixstreamServerCommonResponse:{$m:{1:["code","uint32",0],2:["message","string",""]}},MixStreamStartRequest:{$m:{1:["request_seq","uint32",0],2:["mix_protocol_version","int32",0],3:["task_id","string",""],4:["room_id","string",""],5:["mix_stream_common","mixstream.proto_mixstream.MixStreamCommon",null],6:["audio_channel_cnt","int32",0],7:["audio_mix_mode","int32",0],8:["recv_buffer_level","sint32",0],9:["input_stream","<mixstream.proto_mixstream.MixInputStream",null],10:["water_mark","mixstream.proto_mixstream.MixWaterMark",null],11:["advance_config","<mixstream.proto_mixstream.MixAdvanceConfig",null],12:["output_stream","<mixstream.proto_mixstream.MixOutputStream",null],13:["white_board","mixstream.proto_mixstream.MixWhiteBoard",null],14:["timestamp","int64",{low:0,high:0,unsigned:!1}],15:["check_image_mode","int32",0]}},MixStreamStartResponse:{$m:{1:["request_seq","uint32",0],2:["common_response","mixstream.proto_mixstream.MixstreamServerCommonResponse",null],3:["data","mixstream.proto_mixstream.MixStartReplyData",null],4:["error_streamid_list","<string",null]}},MixStreamStopRequest:{$m:{1:["request_seq","uint32",0],2:["task_id","string",""],3:["room_id","string",""],4:["is_url","int32",0],5:["target","string",""],6:["timestamp","int64",{low:0,high:0,unsigned:!1}]}},MixStreamStopResponse:{$m:{1:["request_seq","uint32",0],2:["common_response","mixstream.proto_mixstream.MixstreamServerCommonResponse",null]}},MixStreamTaskHbRequest:{$m:{1:["request_seq","uint32",0],2:["task_id","string",""]}},MixStreamTaskHbResponse:{$m:{1:["request_seq","uint32",0],2:["common_response","mixstream.proto_mixstream.MixstreamServerCommonResponse",null],3:["status","uint32",0],4:["hb_interval","uint32",0]}},MixWaterMark:{$m:{1:["image","string",""],2:["layout_rect","mixstream.proto_mixstream.MixRect",null]}},MixWhiteBoard:{$m:{1:["whiteboard_id","uint64",{low:0,high:0,unsigned:!0}],2:["horizontal_ratio","int32",0],3:["vertical_ratio","int32",0],4:["is_ppt_animation","int32",0],5:["layout_rect","mixstream.proto_mixstream.MixRect",null],6:["background_color","int32",0]}},PlayInfo:{$m:{1:["stream_alias","string",""],2:["rtmp_url","string",""],3:["hls_url","string",""],4:["hdl_url","string",""]}},PushUrl:{$m:{1:["status","int32",0],2:["url","string",""],3:["mod_time","int64",{low:0,high:0,unsigned:!1}],4:["reason","int32",0]}}}}},"",Me,!1);var G,U,C=Me.mixstream,N=Te(7202);G=C.proto_mixstream,(U=(U=Te(3788)).default||U).util.Long=N.A,U.configure();var v,f=function(){function Z(){}return Z.prototype.encodeMixStreamStartReq=function($){var K=G.MixStreamStartRequest.create($);return G.MixStreamStartRequest.encode(K).finish()},Z.prototype.decodeMixStreamStartRsp=function($){return G.MixStreamStartResponse.decode($)},Z.prototype.encodeMixStreamStopReq=function($){var K=G.MixStreamStopRequest.create($);return G.MixStreamStopRequest.encode(K).finish()},Z.prototype.decodeMixStreamStopRsp=function($){return G.MixStreamStopResponse.decode($)},Z.prototype.encodeGetMixStreamStatusReq=function($){var K=G.GetMixStreamStatusRequest.create($);return G.GetMixStreamStatusRequest.encode(K).finish()},Z.prototype.decodeGetMixStreamStatusRsp=function($){return G.GetMixStreamStatusResponse.decode($)},Z.prototype.encodeAutoRoomMixStreamStartReq=function($){var K=G.AutoRoomMixStreamStartRequest.create($);return G.AutoRoomMixStreamStartRequest.encode(K).finish()},Z.prototype.decodeAutoRoomMixStreamStartRsp=function($){return G.AutoRoomMixStreamStartResponse.decode($)},Z.prototype.encodeAutoRoomMixStreamStopReq=function($){var K=G.AutoRoomMixStreamStopRequest.create($);return G.AutoRoomMixStreamStopRequest.encode(K).finish()},Z.prototype.decodeAutoRoomMixStreamStopRsp=function($){return G.AutoRoomMixStreamStopResponse.decode($)},Z.prototype.encodeMixStreamTaskHbReq=function($){var K=G.MixStreamTaskHbRequest.create($);return G.MixStreamTaskHbRequest.encode(K).finish()},Z.prototype.decodeMixStreamTaskHbRsp=function($){return G.MixStreamTaskHbResponse.decode($)},Z}(),_=Te(5095),b={event:"/mix/start_mix",error:{wn:w.INPUT_PARAM,hr:w.MIXER_TASK_ID_NULL,lr:w.MIXER_TASK_ID_TOO_LONG,vr:w.MIXER_TASK_ID_INVALID_CHARACTER,mr:w.MIXER_INPUTLIST_NULL,pr:w.MIXER_OUTPUTLIST_NULL,gr:w.MIXER_OUTPUT_TARGET_INVALID,br:w.MIXER_NO_OUTPUT_TARGET,_r:w.MIXER_OUTPUT_TARGET_TOO_LONG,yr:w.MIXER_START_REQUEST_ERROR,wr:w.MIXER_INNER_ERROR,Sr:w.MIXER_INPUT_LABEL_TOO_LONG,Er:w.MIXER_INPUT_IMAGE_URL_TOO_LONG,kr:w.MIXER_INPUT_IMAGE_FORMAT_WRONG,Or:w.MIXER_WATERMARK_URL_INVALID,Ir:w.MIXER_WATERMARK_PARAMETERS_ERROR,Ue:w.NOT_LOGIN},mix_stream_conf:_.Gq,stop_reason:_.tK},y={event:"/mix/stop_mix",error:{wn:w.INPUT_PARAM,hr:w.MIXER_TASK_ID_NULL,yr:w.MIXER_STOP_REQUEST_ERROR,wr:w.MIXER_INNER_ERROR,Ue:w.NOT_LOGIN}},M={event:"/mix/config_mix",error:{wn:w.INPUT_PARAM,Rr:w.MIXER_VIDEO_CONFIG_INVALID,Cr:w.MIXER_BACKGROUND_IMAGE_URL_INVALID,Ue:w.NOT_LOGIN},mix_params:_.Gq},Y="/automix/start",L="/automix/stop",A=Te(4872),H=Te(8866),ge=Te(4908),Ee=function(){return Ee=Object.assign||function(Z){for(var $,K=1,X=arguments.length;K<X;K++)for(var B in $=arguments[K])Object.prototype.hasOwnProperty.call($,B)&&(Z[B]=$[B]);return Z},Ee.apply(this,arguments)},Se=256,ue=1024,oe=1e4;v=N.A;var be,Le=["NO_RELAY","RELAYING","RELAY_REQUESTING","NO_RELAY"],pe={0:"NONE",8:"SERVER_ERROR",9:"HANDSHAKE_FAILED",10:"ACCESS_POINT_ERROR",11:"CREATE_STREAM_FAILED",12:"BAD_NAME",13:"CDN_SERVER_DISCONNECTED",14:"DISCONNECTED",1214:"ALL_INPUT_STREAM_CLOSED",1215:"ALL_INPUT_STREAM_NO_DATA",1230:"SERVER_INTERNAL_ERROR"};function k(Z,$){var K,X,B,fe,Ce="",Ze=w;return $.errorCode<2e9&&$.errorCode>1e9?(B={1:"MIXER_START_REQUEST_ERROR",2:"MIXER_START_REQUEST_ERROR",3:"MIXER_AUTHENTICATION_FAILED",141:"MIXER_INPUT_IMAGE_FORMAT_WRONG",142:"MIXER_INPUT_IMAGE_GET_FAIL",150:"MIXER_INPUT_STREAM_NOT_EXISTS",151:"MIXER_START_REQUEST_ERROR",152:"MIXER_STOP_REQUEST_ERROR",153:"MIXER_INPUT_PARAMETERS_ERROR",154:"MIXER_EXCEED_MAX_OUTPUT_COUNT",155:"MIXER_INPUT_PARAMETERS_ERROR",156:"MIXER_VIDEO_CONFIG_INVALID",157:"MIXER_NO_SERVICES",158:"MIXER_EXCEED_MAX_INPUT_COUNT",159:"MIXER_START_REQUEST_ERROR",160:"MIXER_NOT_OWNER_STOPMIXER",170:"MIXER_WATERMARK_PARAMETERS_ERROR",171:"MIXER_WATERMARK_NULL",175:"MIXER_REPEAT_INPUT",179:"MIXER_INPUT_LABEL_TOO_LONG",190:"MIXER_START_REQUEST_ERROR"},fe="MIXER_INNER_ERROR",(X=$.errorCode-oe)>1e9&&B[X-1e9]&&(fe=B[X-1e9]),K=Ze[Ce=fe]):$.errorCode<1e6&&(K=Z.decodeServerError($.errorCode,$.extendedData),Ce=Z.getLiveRoomError($.errorCode)),{reportErr:K,actualError:Ze[Ce]}}(function(Z){Z[Z.I=0]="I",Z[Z.H=10]="H",Z[Z.M=100]="M",Z[Z.L=1e3]="L"})(be||(be={}));var R,Fe={VIDEO:0,AUDIO:1,VIDEO_ONLY:2},te={"H.264":0,"H.265":3};function Ue(Z){var $=R.AUDIO_ENC_HE_AAC;switch(Z){case Re.Xk.ZegoAudioCodecIDNormal2:$=R.AUDIO_ENC_AAC_LC;break;case Re.Xk.ZegoAudioCodecIDLow3:$=R.AUDIO_ENC_OPUS;break;default:$=R.AUDIO_ENC_HE_AAC}return $}(function(Z){Z[Z.AUDIO_ENC_HE_AAC=0]="AUDIO_ENC_HE_AAC",Z[Z.AUDIO_ENC_AAC_LC=1]="AUDIO_ENC_AAC_LC",Z[Z.AUDIO_ENC_MP3=2]="AUDIO_ENC_MP3",Z[Z.AUDIO_ENC_OPUS=3]="AUDIO_ENC_OPUS",Z[Z.AUDIO_ENC_SILK=4]="AUDIO_ENC_SILK",Z[Z.AUDIO_ENC_EVS=5]="AUDIO_ENC_EVS"})(R||(R={}));var it={},ee={startMixerTask:function(Z){var $=this;return new H.l3(function(K,X){var B,fe,Ce,Ze,st,Ie,D,me,ce,le,et,ze,ft,_t,mt,Ve,Ot,rn,an=$.reporter.createSpan(be.H,{key:ge.oq.event},{key:b.event,par:Z.taskID},b.event,!0),In={errorCode:w.MIXER_INPUT_PARAMETERS_ERROR.code,extendedData:w.MIXER_INPUT_PARAMETERS_ERROR.message};if(Z!=null&&Z.inputList.find(function(kn){return kn.streamID==null&&(In.extendedData=In.extendedData+". streamID should be of string type",!0)}))return $.reporter.setError(an,w.MIXER_INPUT_PARAMETERS_ERROR),void X(In);var Tn=Z.outputConfig;Tn&&Tn.outputFps&&(Tn.outputFPS=Tn.outputFps);var fn=function(kn){var nr=k($.stateCenter,kn),Fn=nr.reportErr,_r=nr.actualError;kn.errorCode===1000010150&&an.setAttributes({stop_reason:"UnmatchStreamId"}),$.reporter.setError(an,Fn||kn),$.reporter.spanEnd({key:b.event,par:Z.taskID}),_r&&(kn.errorCode=_r==null?void 0:_r.code,kn.extendedData=(_r==null?void 0:_r.message)||""),X(kn)},Rr=$.stateCenter.roomList[0];if(Rr){var ir=[];if(!Z.noTaskID&&!Z.taskID)return $.logger.error("zb.sh.ums no taskId found"),void fn({errorCode:b.error.hr.code,extendedData:b.error.hr.message});if(!Z.noTaskID&&!(0,A.QP)(Z.taskID))return $.logger.error("zb.rh.lg taskId must be string"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(!Z.noTaskID&&Z.taskID.length>Se)return $.logger.error("zb.sh.ums taskId is too long"),void fn({errorCode:b.error.lr.code,extendedData:b.error.lr.message});if(!Z.noTaskID&&!(0,H.jy)(Z.taskID))return $.logger.error("zb.sh.ums task ID contains illegal characters"),void fn({errorCode:b.error.vr.code,extendedData:b.error.vr.message});if(!Z.inputList||Z.inputList.length==0)return $.logger.error("zb.sh.ums input list wrong"),void fn({errorCode:b.error.mr.code,extendedData:b.error.mr.message});if(Z.inputList.some(function(kn){return(0,A.w)(kn)&&!kn.streamID}))return $.logger.error("zb.sh.ums input stream is null"),void fn({errorCode:b.error.mr.code,extendedData:b.error.mr.message});for(var Ln=0;Ln<Z.inputList.length;Ln++){var mn=Z.inputList[Ln],Qn={errorCode:b.error.wn.code,extendedData:b.error.wn.message};if(!(0,A.w)(mn.layout))return $.logger.error("zb.sh.ums input layout must be object"),void fn(Qn);var Nn=mn.layout,or=Nn.bottom,pr=Nn.left,sr=Nn.right;if(!((0,H.zQ)(Nn.top,!1)&&(0,H.zQ)(or,!1)&&(0,H.zQ)(pr,!1)&&(0,H.zQ)(sr,!1)))return $.logger.error("zb.sh.ums topleftbottomright must be integer number"),void fn(Qn);if(!(0,A.TE)(mn.renderMode)&&![0,1].includes(mn.renderMode))return $.logger.error("zb.sh.ums render_mode is wrong"),void fn(Qn);if((0,A.w)(mn.imageInfo)){if(!(0,A.QP)(mn.imageInfo.url))return $.logger.error("zb.sh.ums image url is require string"),void fn(Qn);if(mn.imageInfo.url.length>1024)return $.logger.error("zb.sh.ums input image url length too long"),void fn({errorCode:b.error.Er.code,extendedData:b.error.Er.message})}if((0,A.w)(mn.label)){if(!(0,A.QP)((B=mn.label)===null||B===void 0?void 0:B.text))return $.logger.error("zb.sh.ums input label text is not string"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message+" label text is not string"});if(((Ce=(fe=mn.label)===null||fe===void 0?void 0:fe.text)===null||Ce===void 0?void 0:Ce.length)>=300)return $.logger.error("zb.sh.ums input label text is  too long"),void fn({errorCode:b.error.Sr.code,extendedData:b.error.Sr.message});var Wr=mn.label,tr=Wr.left,zn=Wr.top;if(tr!==void 0&&!(0,H.zQ)(tr,!1)||zn!==void 0&&!(0,H.zQ)(zn,!1))return $.logger.error("zb.sh.ums input label left and top should be integer"),void fn(Qn)}if(mn.cornerRadius!==void 0&&!(0,A.Cs)(mn.cornerRadius))return $.logger.error("zb.sh.ums cornerRadius is wrong"),void fn(Qn);if(mn.soundLevelID!==void 0&&!(0,H.zQ)(mn.soundLevelID,!1))return $.logger.error("zb.sh.ums soundLevelID is wrong"),void fn(Qn);if(mn.volume!==void 0&&!(0,H.zQ)(mn.volume,!1))return $.logger.error("zb.sh.ums volume is wrong"),void fn(Qn)}if(!Z.outputList||Z.outputList.length==0)return $.logger.error("zb.sh.ums no output list found"),void fn({errorCode:b.error.pr.code,extendedData:b.error.pr.message});if(Z.outputList.some(function(kn){return kn===""||(0,A.w)(kn)&&!(0,A.QP)(kn.target)}))return $.logger.error("zb.sh.ums stream output target is nul"),void fn({errorCode:b.error.pr.code,extendedData:b.error.pr.message});if(Z.outputList.some(function(kn){return(0,A.QP)(kn)&&!(0,H.gU)(kn)&&kn.length>ue||(0,A.w)(kn)&&(0,A.QP)(kn.target)&&kn.target.length>ue}))return $.logger.error("zb.sh.ums stream output target is too long"),void fn({errorCode:b.error._r.code,extendedData:b.error._r.message});if(Z.outputList.some(function(kn){return(0,A.QP)(kn)&&!(0,H.gU)(kn)&&!(0,H.jy)(kn)||(0,A.w)(kn)&&(0,A.QP)(kn.target)&&!(0,H.gU)(kn.target)&&!(0,H.jy)(kn.target)}))return $.logger.error("zb.sh.ums stream output target is incorrect"),void fn({errorCode:b.error.gr.code,extendedData:b.error.gr.message});if(!Tn||!(0,A.w)(Tn))return $.logger.error("zb.sh.ums no output config found"),void fn({errorCode:b.error.br.code,extendedData:b.error.br.message});if(!Tn.outputBitrate||!(0,H.zQ)(Tn.outputBitrate))return $.logger.error("zb.sh.ums bitrate param is required and must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(!Tn.outputFPS||!(0,H.zQ)(Tn.outputFPS))return $.logger.error("zb.sh.ums fps param is required and must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(!Tn.outputWidth||!(0,H.zQ)(Tn.outputWidth))return $.logger.error("zb.sh.ums width param is required and must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(!Tn.outputHeight||!(0,H.zQ)(Tn.outputHeight))return $.logger.error("zb.sh.ums height param is required and must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(Tn.outputAudioCodecID!==void 0&&!(0,H.zQ)(Tn.outputAudioCodecID,!1))return $.logger.error("zb.sh.ums AudioCodecID param must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(Tn.outputAudioBitrate!==void 0&&!(0,H.zQ)(Tn.outputAudioBitrate))return $.logger.error("zb.sh.ums AudioBitrate param must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(Tn.outputAudioChannels!==void 0&&!(0,H.zQ)(Tn.outputAudioChannels,!1))return $.logger.error("zb.sh.ums AudioChannels param must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if((0,A.w)(Z.watermark)){if(!(0,A.QP)((Ze=Z.watermark)===null||Ze===void 0?void 0:Ze.imageURL))return $.logger.error("zb.sh.ums watermark image type error"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(((st=Z.watermark)===null||st===void 0?void 0:st.imageURL)!==""&&!(0,A.$C)((Ie=Z.watermark)===null||Ie===void 0?void 0:Ie.imageURL))return $.logger.error("zb.sh.ums watermark image url invalid"),void fn({errorCode:b.error.Or.code,extendedData:b.error.Or.message});if(!(0,A.w)((D=Z.watermark)===null||D===void 0?void 0:D.layout))return $.logger.error("zb.sh.ums watermark layout must be object"),void fn({errorCode:b.error.Ir.code,extendedData:b.error.Ir.message});var bn=(me=Z.watermark)===null||me===void 0?void 0:me.layout;if(or=bn.bottom,pr=bn.left,sr=bn.right,!((0,H.zQ)(bn.top,!1)&&(0,H.zQ)(or,!1)&&(0,H.zQ)(pr,!1)&&(0,H.zQ)(sr,!1)))return $.logger.error("zb.sh.ums watermark topleftbottomright must be integer number"),void fn({errorCode:b.error.Ir.code,extendedData:b.error.Ir.message})}if((0,A.w)(Z.whiteboard)){if(!(0,A.QP)((ce=Z.whiteboard)===null||ce===void 0?void 0:ce.whiteboardID))return $.logger.error("zb.sh.ums whiteboard is required and must be string"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(!(0,A.w)((le=Z.whiteboard)===null||le===void 0?void 0:le.layout))return $.logger.error("zb.sh.ums whiteboard layout must be object"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});var Jn=(et=Z.whiteboard)===null||et===void 0?void 0:et.layout;if(or=Jn.bottom,pr=Jn.left,sr=Jn.right,!((0,H.zQ)(Jn.top,!1)&&(0,H.zQ)(or,!1)&&(0,H.zQ)(pr,!1)&&(0,H.zQ)(sr,!1)))return $.logger.error("zb.sh.ums whiteboard topleftbottomright must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});var zr=Z.whiteboard,jn=zr.horizontalRatio,Lr=zr.verticalRatio,Vr=zr.isPPTAnimation,Ai=zr.zOrder,Yr=zr.backgroundColor;if(!(0,A.TE)(jn)&&!(0,H.zQ)(jn))return $.logger.error("zb.sh.ums horizontalRatio must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(!(0,A.TE)(Lr)&&!(0,H.zQ)(Lr))return $.logger.error("zb.sh.ums verticalRatio must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(!(0,A.TE)(Vr)&&!(0,A.dd)(Vr))return $.logger.error("zb.sh.ums isPPTAnimation must be boolean"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(!(0,A.TE)(Ai)&&!(0,H.zQ)(Ai,!1))return $.logger.error("zb.sh.ums zOrder must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(!(0,A.TE)(Yr)&&!(0,H.zQ)(Yr,!1))return $.logger.error("zb.sh.ums backgroundColor must be integer number"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message})}if(!(0,A.TE)(Z.enableSoundLevel)&&!(0,A.dd)(Z.enableSoundLevel))return $.logger.error("zb.sh.ums enableSoundLevel is not bool"),void fn({errorCode:b.error.wn.code,extendedData:b.error.wn.message});for(Ln=0;Ln<Z.inputList.length;Ln++){var Qr=Z.inputList[Ln],Ci=Qr.streamID;$.stateCenter.testEnvironment&&(Ci="zegotest-"+$.stateCenter.appid+"-"+Qr.streamID),ir.push({stream_id:Ci,content_control:Fe[Qr.contentType||"VIDEO"]||0,top:(ze=Qr.layout)===null||ze===void 0?void 0:ze.top,left:(ft=Qr.layout)===null||ft===void 0?void 0:ft.left,bottom:(_t=Qr.layout)===null||_t===void 0?void 0:_t.bottom,right:(mt=Qr.layout)===null||mt===void 0?void 0:mt.right,render_mode:Qr.renderMode,corner_radius:Qr.cornerRadius,image:Qr.imageInfo,label:Qr.label})}var Si=[];Z.outputList.forEach(function(kn){var nr="";(0,A.QP)(kn)?nr=kn:(0,A.w)(kn)&&kn.target&&(nr=kn.target);var Fn=0;(nr.startsWith("rtmp://")||nr.startsWith("https://")&&nr.endsWith(".flv")||nr.startsWith("https://")&&nr.endsWith(".m3u8"))&&(Fn=1);var _r={target:nr,is_url:Fn?"true":"false"};if(Z.outputConfig){var P=Z.outputConfig,He=P.outputAudioBitrate,de=P.outputAudioCodecID;(0,A.Cs)(He)&&(_r.audio_bitrate=1e3*He),(0,A.Cs)(de)&&(_r.audio_enc_id=de)}if((0,A.w)(kn)&&kn.videoConfig){var ne=kn.videoConfig,De=ne.bitrate,ye=ne.encodeProfile,Qe=ne.encodeLatency,Ke=ne.videoCodecID,$e=ne.enableLowBitrateHD;(0,A.Cs)(De)&&(_r.video_bitrate=1e3*De),(0,A.Cs)(ye)&&(_r.video_encode_profile=ye),(0,A.Cs)(Qe)&&(_r.video_encode_latency=Qe),(0,A.QP)(Ke)&&(_r.video_enc_id=Ke),(0,A.dd)($e)&&(_r.low_bitrate_hd=$e?1:0)}Si.push(_r)});var ri=Tn,fr={};if(it){var Yn=it.backgroundImage;(0,A.Cs)(Yr=it.backgroundColor)&&(fr.output_bg_color=Yr),(0,A.QP)(Yn)&&(fr.output_bg_image=Yn)}var yi={};if(Z.watermark){var dr=Z.watermark,ii=dr.layout;yi.image=dr.imageURL,yi.layout=ii}yi&&(fr.water_mark=yi),$.reporter.spanSetAttributes({key:b.event,par:Z.taskID},{mix_stream_conf:b.mix_stream_conf(Ee(Ee({fps:ri.outputFPS,bitrate:1e3*ri.outputBitrate,w:ri.outputWidth,h:ri.outputHeight,stream_cnt:ir.length,mix_task_id:Z.taskID},fr),{with_sound_level:Z.enableSoundLevel?1:0,bypass:!((Ve=Z.outputConfig)===null||Ve===void 0)&&Ve.singleStreamPassThrough?1:0,audio_channel_cnt:(rn=(Ot=Z.outputConfig)===null||Ot===void 0?void 0:Ot.outputAudioChannels)!==null&&rn!==void 0?rn:1,input_stream_list:ir,output_target_list:Si}))}),Rr.streamHandler.updateMixStream(Z,it,function(kn){$.reporter.spanEnd({key:b.event,par:Z.taskID}),K(kn)},fn)}else fn({errorCode:b.error.Ue.code,extendedData:b.error.Ue.message})})},setMixerTaskConfig:function(Z){var $=this;return new H.l3(function(K,X){var B,fe=$.reporter.createSpan(be.H,{key:ge.oq.event},{key:""},M.event),Ce={},Ze=function(me){$.reporter.setError(fe,me),X(me)};if(Z&&Z.videoCodec){var st=Z.videoCodec.toLowerCase();if(["vp8","h264","h265"].indexOf(st)==-1)return $.logger.error("zb.sh.ums param videoCode error"),Ze({errorCode:M.error.Rr.code,extendedData:M.error.Rr.message}),!1;Ce.videoCodec=st}if(Z.backgroundColor){if(!(0,H.zQ)(Z.backgroundColor))return $.logger.error("zb.sh.ums param backgroundColor must be integer number"),Ze({errorCode:M.error.wn.code,extendedData:M.error.wn.message}),!1;Ce.backgroundColor=Z.backgroundColor}var Ie=Z.backgroundImage;if(Ie){if(!(0,A.QP)(Ie))return $.logger.error("zb.sh.ums param outputBgImage error"),Ze({errorCode:M.error.wn.code,extendedData:M.error.wn.message}),!1;if(!(0,A.$C)(Ie))return $.logger.error("zb.sh.ums illegal input background image URL"),Ze({errorCode:M.error.Cr.code,extendedData:M.error.Cr.message}),!1;Ce.backgroundImage=Ie}var D=Z&&Z.userData;if(D){if(!(0,A.G0)(D))return $.logger.error("zb.sh.ums param userData required Uint8Array"),Ze({errorCode:M.error.wn.code,extendedData:M.error.wn.message}),!1;if(D.byteLength>1e3)return $.logger.error("zb.sh.ums param userData should shorter than 1000"),Ze({errorCode:M.error.wn.code,extendedData:M.error.wn.message}),!1;Ce.userData=D}Z.extraParams&&(Ce.extraParams||(Ce.extraParams=[]),(B=Ce.extraParams).push.apply(B,Z.extraParams)),it=Ce,fe.setAttributes({mix_params:M.mix_params(Z)}),$.stateCenter.roomList[0]?(fe.end(),K({errorCode:0,extendedData:""})):Ze({errorCode:M.error.Ue.code,extendedData:M.error.Ue.message})})},stopMixerTask:function(Z){var $=this;return new H.l3(function(K,X){var B=$.reporter.createSpan(be.H,{key:ge.oq.event},{key:""},y.event);if(!Z||!(0,A.QP)(Z)||Z.length>Se||!(0,H.jy)(Z))return $.logger.error("zb.rh.lg taskID must be string less 256"),$.reporter.setError(B,y.error.wn," param taskID error"),void X({errorCode:y.error.wn.code,extendedData:y.error.wn.message+" param taskID error"});B.setAttributes({mix_task_id:Z});var fe=function(Ze){var st=k($.stateCenter,Ze),Ie=st.actualError;$.reporter.setError(B,st.reportErr||Ze),Ie&&(Ze.errorCode=Ie==null?void 0:Ie.code,Ze.extendedData=(Ie==null?void 0:Ie.message)||""),X(Ze)},Ce=$.stateCenter.roomList[0];Ce?Ce.streamHandler.stopMixStream(Z,function(Ze){B.end(),K(Ze)},fe):fe({errorCode:y.error.Ue.code,extendedData:y.error.Ue.message})})},startAutoMixerTask:function(Z){var $=this;return new H.l3(function(K,X){var B,fe,Ce=$.reporter.createSpan(be.H,{key:ge.oq.event},{key:Y,par:Z.taskID},Y,!0),Ze=function(D){var me=k($.stateCenter,D),ce=me.reportErr;D.errorCode===1000010150&&Ce.setAttributes({stop_reason:"UnmatchStreamId"}),$.reporter.setError(Ce,ce||D),$.reporter.spanEnd({key:Y,par:Z.taskID}),X(D)},st=$.stateCenter.roomList[0];if(st){if(!Z.taskID)return $.logger.error("zb.sh.ums no taskId found"),void Ze({errorCode:b.error.hr.code,extendedData:b.error.hr.message});if(!(0,A.QP)(Z.taskID))return $.logger.error("zb.rh.lg taskId must be string"),void Ze({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(Z.taskID.length>Se)return $.logger.error("zb.sh.ums taskId is too long"),void Ze({errorCode:b.error.lr.code,extendedData:b.error.lr.message});if(!(0,H.jy)(Z.taskID))return $.logger.error("zb.sh.ums task ID contains illegal characters"),void Ze({errorCode:b.error.vr.code,extendedData:b.error.vr.message});if(!Z.roomID)return $.logger.error("zb.sh.ums no roomID found"),void Ze({errorCode:E.Qo5.code,extendedData:E.Qo5.message});if(!(0,A.QP)(Z.roomID))return $.logger.error("zb.rh.lg roomID must be string"),void Ze({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(Z.roomID.length>128)return $.logger.error("zb.sh.ums roomID is too long"),void Ze({errorCode:E.Srw.code,extendedData:E.Srw.message});if(!(0,H.jy)(Z.roomID))return $.logger.error("zb.sh.ums room ID contains illegal characters"),void Ze({errorCode:E.ulL.code,extendedData:E.ulL.message});if(!Z.outputList||Z.outputList.length==0)return $.logger.error("zb.sh.ums no output list found"),void Ze({errorCode:b.error.pr.code,extendedData:b.error.pr.message});if(Z.outputList.some(function(D){return(0,A.w)(D)&&!D.target}))return $.logger.error("zb.sh.ums stream output target is nul"),void Ze({errorCode:b.error.pr.code,extendedData:b.error.pr.message});if(Z.outputList.some(function(D){return(0,A.w)(D)&&(0,A.QP)(D.target)&&D.target.length>ue}))return $.logger.error("zb.sh.ums stream output target is too long"),void Ze({errorCode:b.error._r.code,extendedData:b.error._r.message});if(Z.outputList.some(function(D){return(0,A.w)(D)&&D.target&&!(0,H.gU)(D.target)&&!(0,H.jy)(D.target)}))return $.logger.error("zb.sh.ums stream output target is incorrect"),void Ze({errorCode:b.error.gr.code,extendedData:b.error.gr.message});if(Z.audioConfig){if(((B=Z.audioConfig)===null||B===void 0?void 0:B.bitrate)!==void 0&&!(0,H.zQ)((fe=Z.audioConfig)===null||fe===void 0?void 0:fe.bitrate))return $.logger.error("zb.sh.ums audio bitrate param is required and must be integer number"),void Ze({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(Z.audioConfig.codecID!==void 0&&!(0,H.zQ)(Z.audioConfig.codecID,!1))return $.logger.error("zb.sh.ums AudioCodecID param must be integer number"),void Ze({errorCode:b.error.wn.code,extendedData:b.error.wn.message});if(Z.audioConfig.channel!==void 0&&![1,2].includes(Z.audioConfig.channel))return $.logger.error("zb.sh.ums AudioChannels param must be 1 or 2"),void Ze({errorCode:b.error.wn.code,extendedData:b.error.wn.message})}if(!(0,A.TE)(Z.enableSoundLevel)&&!(0,A.dd)(Z.enableSoundLevel))return $.logger.error("zb.sh.ums enableSoundLevel is not bool"),void Ze({errorCode:b.error.wn.code,extendedData:b.error.wn.message});var Ie=[];Z.outputList.forEach(function(D){var me=D.target,ce={};if(me.startsWith("rtmp://")||me.startsWith("https://")&&me.endsWith(".flv")||me.startsWith("https://")&&me.endsWith(".m3u8")?ce.url=me:ce.stream=me,D.videoConfig){var le=D.videoConfig,et=le.encodeProfile,ze=le.encodeLatency,ft=le.videoCodecID,_t=le.enableLowBitrateHD;(0,A.Cs)(mt=le.bitrate)&&(ce.video_bitrate=1e3*mt),(0,A.Cs)(et)&&(ce.video_encode_profile=et),(0,A.Cs)(ze)&&(ce.video_encode_latency=ze),(0,A.QP)(ft)&&(ce.video_enc_id=ft),(0,A.dd)(_t)&&(ce.low_bitrate_hd=_t?1:0)}if(Z.audioConfig){var mt,Ve=Z.audioConfig,Ot=Ve.channel,rn=Ve.codecID;(0,A.Cs)(mt=Ve.bitrate)&&(ce.audio_bitrate=1e3*mt),(0,A.Cs)(rn)&&(ce.audio_enc_id=rn),(0,A.Cs)(Ot)&&(ce.audio_channel_cnt=Ot)}Ie.push(ce)}),$.reporter.spanSetAttributes({key:Y,par:Z.taskID},{task_id:Z.taskID,room_id:Z.roomID,with_sound_level:Z.enableSoundLevel?1:0,alignment_type:Z.streamAlignmentMode||0,recv_buffer_level:Z.minPlayStreamBufferLength||0,output_target_list:Ie}),st.streamHandler.updateAutoMixStream(Z,function(D){$.reporter.spanEnd({key:Y,par:Z.taskID}),K(D)},Ze)}else Ze({errorCode:b.error.Ue.code,extendedData:b.error.Ue.message})})},stopAutoMixerTask:function(Z){var $=this;return new H.l3(function(K,X){var B=$.reporter.createSpan(be.H,{key:ge.oq.event},{key:""},L);if(!Z.taskID||!(0,A.QP)(Z.taskID)||Z.taskID.length>Se||!(0,H.jy)(Z.taskID))return $.logger.error("zb.rh.lg taskID must be string less 256"),$.reporter.setError(B,y.error.wn," param taskID error"),void X({errorCode:y.error.wn.code,extendedData:y.error.wn.message+" param taskID error"});B.setAttributes({task_id:Z.taskID,room_id:Z.roomID});var fe=function(Ze){var st=k($.stateCenter,Ze);$.reporter.setError(B,st.reportErr||Ze),X(Ze)},Ce=$.stateCenter.roomList[0];Ce?Ce.streamHandler.stopAutoMixStream(Z,function(Ze){B.end(),K(Ze)},fe):fe({errorCode:y.error.Ue.code,extendedData:y.error.Ue.message})})}},ae={_sendMixStopReqByAccessHub:function(Z,$,K){var X=this;this.mixStreamProtoBuf||(this.mixStreamProtoBuf=new f),Z.timestamp=v.fromInt(Math.ceil(new Date().getTime()/1e3)),this.logger.info("zb.sh.smseba.1 req "+JSON.stringify(Z));var B=this.mixStreamProtoBuf.encodeMixStreamStopReq(Z),fe=function(Ce,Ze){try{var st=X.mixStreamProtoBuf.decodeMixStreamStopRsp(Ce);(0,H.M$)(st),X.logger.info("zb.sh.smseba.1 rsp "+JSON.stringify(Z));var Ie=(st==null?void 0:st.common_response)||{};return{code:Ie.code,msg:Ie.message}}catch{return{code:-1}}};this.sendMixRequest({interfaceID:16},B,function(Ce,Ze){var st=fe(Ce),Ie=st.code,D=st.msg;Ie!=0&&Ie!=null||!(0,A.JO)($)?K&&K({errorCode:Ie,extendedData:D||""}):$({errorCode:Ie,extendedData:D})},function(Ce,Ze,st){var Ie="";if(st)return st.code==w.TIMEOUT.code&&(st=b.error.wr),st.code&&st.code===20010&&(st=JSON.parse(JSON.stringify(w.MIXER_NO_SERVICES))),void(K&&K(st,Ie));st=b.error.wr;var D="";if((0,A.QP)(Ze))D=Ze;else{var me=fe(Ze);D=me.code+" "+me.msg}X.logger.error("zb.sh.pt "+(Ie="request media server fail, error: "+Ce+" "+D)),K&&K(st,Ie)})},stopMixStream:function(Z,$,K,X,B){var fe=this;this.logger.info("zb.sh.sms call");var Ce=this.getStopMixStreamParams(Z,X,B);this._sendMixStopReqByAccessHub(Ce.mixStopReq,function(Ze){fe.mixStreamHbList[Z]&&(fe.mixStreamHbList[Z].timer&&clearTimeout(fe.mixStreamHbList[Z].timer),delete fe.mixStreamHbList[Z]),$(Ze)},K)},_sendMixStartReqByAccessHub:function(Z,$,K,X){var B=this;this.mixStreamProtoBuf||(this.mixStreamProtoBuf=new f),Z.timestamp=v.fromInt(Math.ceil(new Date().getTime()/1e3)),this.logger.info("zb.sh.smseba.0 req "+JSON.stringify(Z));var fe=this.mixStreamProtoBuf.encodeMixStreamStartReq(Z),Ce=function(Ze,st){try{var Ie=B.mixStreamProtoBuf.decodeMixStreamStartRsp(Ze);(0,H.M$)(Ie),B.logger.info("zb.sh.smseba.0 rsp "+JSON.stringify(Ie));var D=Ie.common_response;return{code:D.code,msg:D.message,data:Ie.data,errStreamList:Ie.error_streamid_list}}catch{return{code:-1}}};this.sendMixRequest({interfaceID:15},fe,function(Ze,st){var Ie=Ce(Ze),D=Ie.code,me=Ie.data,ce=Ie.errStreamList;if(D===void 0||D==0){var le=me.play_infos.map(function(mt){var Ve={rtmpURL:"",hlsURL:"",flvURL:""},Ot=mt.stream_alias||"";return B.stateCenter.testEnvironment&&Ot&&Ot.startsWith($)&&(Ot=Ot.slice($.length)),Ve.streamID=Ot,mt.rtmp_url&&mt.rtmp_url.length>0&&(Ve.rtmpURL=mt.rtmp_url),mt.hls_url&&mt.hls_url.length>0&&(Ve.hlsURL=mt.hls_url),mt.hdl_url&&mt.hdl_url.length>0&&(Ve.flvURL=mt.hdl_url),Ve});if(me.request_id){B.mixStreamTaskList[Z.task_id]||(B.mixStreamTaskList[Z.task_id]={mixStatusVer:0,requestId:me.request_id}),B.mixStreamTaskList[Z.task_id].requestId=me.request_id;var et=B.mixRequestIdList.findIndex(function(mt){return mt==me.request_id});et>-1&&(B.fetchMixStreamStatus(B.stateCenter.appid+":"+Z.task_id),B.mixRequestIdList.splice(et,1))}K&&K({errorCode:0,extendedData:JSON.stringify({mixerOutputList:le})})}else{var ze="",ft=D+1e9;if(ft==1000000150&&ce){var _t=ce.map(function(mt){return B.stateCenter.testEnvironment&&mt.startsWith($)?mt.slice($.length):mt})||[];_t.length>0&&(B.logger.debug("zb.sh.ums not exist streams: "+_t),ze=_t.join(","))}X&&X({errorCode:B.stateCenter.getServerError(oe+ft).code,extendedData:ze})}},function(Ze,st,Ie){var D="";if(Ie)return Ie.code==w.TIMEOUT.code&&(Ie=b.error.yr),Ie.code&&Ie.code===20010&&(Ie=JSON.parse(JSON.stringify(w.MIXER_NO_SERVICES))),void(X&&X(Ie,D));Ie=b.error.wr;var me="";if((0,A.QP)(st))me=st;else{var ce=Ce(st);me=ce.code+" "+ce.msg}B.logger.error("zb.sh.pt "+(D="request media server fail, error: "+Ze+" "+me)),X&&X(Ie,D)})},getStartMixStreamParams:function(Z,$){var K,X,B=this,fe={request_seq:this.stateCenter.getSeq(),mix_protocol_version:1,task_id:Z.taskID,room_id:this.roomID,mix_stream_common:{},input_stream:[],advance_config:[],output_stream:[]},Ce=Z.outputConfig||{};Ce.singleStreamPassThrough&&(0,A.dd)(Ce.singleStreamPassThrough)&&(fe.mix_stream_common.single_stream_pass_through=Ce.singleStreamPassThrough?1:0);var Ze=$;if(Ze&&(Ze.videoCodec&&((K=fe.advance_config)===null||K===void 0||K.push({key:"video_encode",value:Ze.videoCodec})),Ze.backgroundColor&&(fe.mix_stream_common.output_bg_color=Ze.backgroundColor),Ze.backgroundImage&&(fe.mix_stream_common.output_bg_image=Ze.backgroundImage),Ze.userData&&(fe.mix_stream_common.user_data=this.stateCenter.uint8arrayToBase64(Ze.userData)),Ze.extraParams&&((X=fe.advance_config)===null||X===void 0||X.push.apply(X,Ze.extraParams))),Z.enableSoundLevel!==void 0&&(fe.mix_stream_common.with_sound_level=Z.enableSoundLevel?1:0),Z.inputList.forEach(function(ze,ft){var _t,mt,Ve,Ot,rn,an,In,Tn,fn,Rr,ir,Ln,mn,Qn,Nn,or,pr,sr,Wr,tr,zn,bn=ze.streamID;B.stateCenter.testEnvironment&&(bn="zegotest-"+B.stateCenter.appid+"-"+ze.streamID);var Jn={stream_input_common:{stream_id:bn,content_control:Fe[ze.contentType||"VIDEO"]||0,layer_rect:{layer:ft,top:(_t=ze.layout)===null||_t===void 0?void 0:_t.top,left:(mt=ze.layout)===null||mt===void 0?void 0:mt.left,bottom:(Ve=ze.layout)===null||Ve===void 0?void 0:Ve.bottom,right:(Ot=ze.layout)===null||Ot===void 0?void 0:Ot.right}},volume:(rn=ze.volume)!==null&&rn!==void 0?rn:100,audio_focus:ze.isAudioFocus?1:0,audio_h_angle:-1,render_mode:ze.renderMode,corner_radius:ze.cornerRadius};if(!((an=ze.label)===null||an===void 0)&&an.text){var zr={font_type:((Tn=(In=ze.label)===null||In===void 0?void 0:In.font)===null||Tn===void 0?void 0:Tn.type)||0,font_size:((Rr=(fn=ze.label)===null||fn===void 0?void 0:fn.font)===null||Rr===void 0?void 0:Rr.size)||24,font_color:((Ln=(ir=ze.label)===null||ir===void 0?void 0:ir.font)===null||Ln===void 0?void 0:Ln.color)||16777215,font_transparency:((Qn=(mn=ze.label)===null||mn===void 0?void 0:mn.font)===null||Qn===void 0?void 0:Qn.transparency)||0};zr.font_border_color=!((or=(Nn=ze.label)===null||Nn===void 0?void 0:Nn.font)===null||or===void 0)&&or.border?(sr=(pr=ze.label)===null||pr===void 0?void 0:pr.font)===null||sr===void 0?void 0:sr.borderColor:-1;var jn={text:(Wr=ze.label)===null||Wr===void 0?void 0:Wr.text,text_left:((tr=ze.label)===null||tr===void 0?void 0:tr.left)||0,text_top:((zn=ze.label)===null||zn===void 0?void 0:zn.top)||0,font:zr};Jn.label=jn}ze.imageInfo&&(Jn.image={url:ze.imageInfo.url,display_mode:ze.imageInfo.displayMode||0}),ze.soundLevelID&&(Jn.stream_input_common.sound_level_id=ze.soundLevelID),fe.input_stream.push(Jn)}),Z.outputList.forEach(function(ze){var ft,_t,mt,Ve,Ot,rn,an,In,Tn,fn,Rr,ir,Ln,mn="";(0,A.QP)(ze)?mn=ze:(0,A.w)(ze)&&ze.target?mn=ze.target:B.logger.error("zb.sh.ums output target required"),(0,H.gU)(mn)?(ir=1,Ln=mn):(ir=0,Ln=B.stateCenter.testEnvironment?"zegotest-"+B.stateCenter.appid+"-"+mn:mn);var Qn=Ce.outputBitrate;typeof ze!="string"&&(!((ft=ze.videoConfig)===null||ft===void 0)&&ft.bitrate)&&(Qn=(_t=ze.videoConfig)===null||_t===void 0?void 0:_t.bitrate);var Nn={is_url:ir,target:Ln,video_bitrate:1e3*Qn,video_fps:Ce.outputFPS,video_width:Ce.outputWidth,video_height:Ce.outputHeight,output_quality:23};Ce.outputAudioCodecID&&(Nn.audio_enc_id=Ce.outputAudioCodecID),Ze.videoCodec==="vp8"?Nn.audio_enc_id=3:Ze.videoCodec!=="h264"&&Ze.videoCodec!=="h265"||(Nn.audio_enc_id=0),Ce.outputAudioBitrate&&(Nn.audio_bitrate=1e3*Ce.outputAudioBitrate);var or={output_stream_common:Nn};typeof ze!="string"&&(!((mt=ze.videoConfig)===null||mt===void 0)&&mt.videoCodecID&&(or.video_enc_id=te[(Ve=ze.videoConfig)===null||Ve===void 0?void 0:Ve.videoCodecID]||0),!((Ot=ze.videoConfig)===null||Ot===void 0)&&Ot.encodeProfile&&[0,1,2,3].includes((rn=ze.videoConfig)===null||rn===void 0?void 0:rn.encodeProfile)&&(or.video_encode_profile=function(pr){var sr=1;switch(pr){case Re.zN.ZegoEncodeProfileDefault:case Re.zN.ZegoEncodeProfileMain:sr=1;break;case Re.zN.ZegoEncodeProfileBaseline:sr=0;break;case Re.zN.ZegoEncodeProfileHigh:sr=2}return sr}((an=ze.videoConfig)===null||an===void 0?void 0:an.encodeProfile)),(0,A.Cs)((In=ze.videoConfig)===null||In===void 0?void 0:In.encodeLatency)&&(or.video_encode_latency=(Tn=ze.videoConfig)===null||Tn===void 0?void 0:Tn.encodeLatency),(0,A.dd)((fn=ze.videoConfig)===null||fn===void 0?void 0:fn.enableLowBitrateHD)&&(or.low_bitrate_hd=!((Rr=ze.videoConfig)===null||Rr===void 0)&&Rr.enableLowBitrateHD?1:0)),fe.output_stream.push(or)}),Z.watermark&&Z.watermark.imageURL!==""&&(fe.water_mark={image:Z.watermark.imageURL,layout_rect:Z.watermark.layout}),Z.whiteboard){var st=Z.whiteboard,Ie=st.horizontalRatio,D=st.verticalRatio,me=st.layout,ce=st.zOrder,le=st.isPPTAnimation,et=st.backgroundColor;fe.white_board={whiteboard_id:v.fromString(st.whiteboardID),horizontal_ratio:Ie||16,vertical_ratio:D||9,is_ppt_animation:le===!0?1:0,layout_rect:Ee(Ee({},me),{layer:ce||0}),background_color:et||4059296768}}return isNaN(Z.streamAlignmentMode)||(fe.mix_stream_common.alignment_type=Z.streamAlignmentMode),fe.audio_channel_cnt=Ce.outputAudioChannels?Ce.outputAudioChannels:1,Ce.audioMixMode&&(fe.audio_mix_mode=Ce.audioMixMode),{mixStartReq:fe}},updateMixStream:function(Z,$,K,X){var B=this;this.logger.info("zb.sh.ums call"),this.logger.info("zb.sh.ums send command");var fe=this.getStartMixStreamParams(Z,$).mixStartReq;return this._sendMixStartReqByAccessHub(fe,"zegotest-"+this.stateCenter.appid+"-",function(Ce){B.startMixHb(Z.taskID),K(Ce)},X),!0},updateAutoMixStream:function(Z,$,K){var X=this;this.logger.info("zb.sh.uams.0 call");var B=Z.taskID,fe=Z.roomID,Ce=Z.audioConfig,Ze=Z.outputList,st=Z.enableSoundLevel,Ie=Z.streamAlignmentMode,D=Z.minPlayStreamBufferLength;this.mixStreamProtoBuf||(this.mixStreamProtoBuf=new f);var me=[];Ze.forEach(function(ze){var ft=ze.target,_t=0;(ft.startsWith("rtmp://")||ft.startsWith("avertp://")||ft.startsWith("https://")&&ft.endsWith(".flv")||ft.startsWith("https://")&&ft.endsWith(".m3u8"))&&(_t=1),me.push({stream_out_common:{target:ft,is_url:_t,audio_bitrate:Ce!=null&&Ce.bitrate?1e3*(Ce==null?void 0:Ce.bitrate):48e3,audio_enc_id:(0,A.TE)(Ce==null?void 0:Ce.codecID)?0:Ue(Ce==null?void 0:Ce.codecID),video_fps:1,video_bitrate:1,video_width:1,video_height:1},audio_channel_cnt:(Ce==null?void 0:Ce.channel)||1})});var ce={request_seq:this.stateCenter.getSeq(),mix_stream_common:{with_sound_level:st?1:0,alignment_type:Ie},room_id:fe,task_id:B,output_stream:me};(0,A.Cs)(D)&&D>=0&&(ce.has_recv_buffer_level=!0,ce.recv_buffer_level=D),this.logger.info("zb.sh.uams.0 params "+JSON.stringify(ce));var le=this.mixStreamProtoBuf.encodeAutoRoomMixStreamStartReq(ce),et=function(ze,ft){try{var _t=X.mixStreamProtoBuf.decodeAutoRoomMixStreamStartRsp(ze);(0,H.M$)(_t),X.logger.info("zb.sh.uams.0 rsp "+JSON.stringify(_t));var mt=_t.common_response;return{code:mt.code,msg:mt.message}}catch{return{code:-1}}};return this.sendMixRequest({interfaceID:10},le,function(ze,ft){X.mixSucFun(ze,$,K,et,"zb.sh.uams.0")},function(ze,ft,_t){X.mixFailFun(ze,ft,_t,K,et,"zb.sh.uams.0")},6),!0},stopAutoMixStream:function(Z,$,K){var X=this,B=Z.taskID,fe=Z.roomID,Ce={request_seq:this.stateCenter.getSeq(),room_id:fe,task_id:B};this.logger.info("zb.sh.uams.1 params "+JSON.stringify(Ce));var Ze=this.mixStreamProtoBuf.encodeAutoRoomMixStreamStopReq(Ce),st=function(Ie,D){try{var me=X.mixStreamProtoBuf.decodeAutoRoomMixStreamStopRsp(Ie);(0,H.M$)(me),X.logger.info("zb.sh.smseba.0 rsp "+JSON.stringify(me));var ce=me.common_response;return{code:ce.code,msg:ce.message}}catch{return{code:-1}}};this.sendMixRequest({interfaceID:11},Ze,function(Ie,D){X.mixSucFun(Ie,$,K,st,"zb.sh.uams.1")},function(Ie,D,me){X.mixFailFun(Ie,D,me,K,st,"zb.sh.uams.1")},6)},mixSucFun:function(Z,$,K,X,B,fe){var Ce=X(Z,fe),Ze=Ce.code,st=Ce.msg;Ze===void 0||Ze===0?(this.logger.info(B+" suc"),$&&$({errorCode:0,extendedData:""})):(this.logger.info(B+" fail "+Ze+" "+st),K&&K({errorCode:this.stateCenter.getServerError(oe+(Ze+1e9)).code,extendedData:st}))},mixFailFun:function(Z,$,K,X,B,fe){var Ce="";if(K)return K.code==w.TIMEOUT.code&&(K=b.error.wr),K.code&&K.code===20010&&(K=JSON.parse(JSON.stringify(w.MIXER_NO_SERVICES))),void(X&&X(K,Ce));K=b.error.wr;var Ze="";if((0,A.QP)($))Ze=$;else{var st=B($);Ze=st.code+" "+st.msg}Ce="request media server fail, error: "+Z+" "+Ze,this.logger.error("".concat(fe," http fail ").concat(Ce)),X&&X(K,Ce)},getStopMixStreamParams:function(Z,$,K){var X={id_name:this.stateCenter.idName,live_channel:this.roomID,appid:this.stateCenter.appid,version:"3.11.0"},B={request_seq:this.stateCenter.getSeq(),room_id:this.roomID};if((0,A.QP)(Z)&&(X.task_id=Z,B.task_id=Z),$!=null){var fe=void 0;X.stream_id=fe=this.stateCenter.testEnvironment?"zegotest-"+this.stateCenter.appid+"-"+$:$,B.is_url=0,B.target=fe}else K!=null&&(X.mixurl=K,B.is_url=1,B.target=K);return{req_body:X,mixStopReq:B}},getMixStreamStatus:function(Z){this.logger.info("zb.sh.fmss call");for(var $=0;$<Z.length;$++){var K=Z[$],X=K.trans_type.replace("mixpushstatus:",""),B=X.replace(this.stateCenter.appid+":",""),fe=this.mixStreamTaskList[B],Ce=JSON.parse(K.trans_data),Ze=Ce.request_id;if(fe&&fe.requestId===Ze){var st=parseInt(Ce.version);st<=fe.mixStatusVer&&st!=1?this.logger.info("zb.sh.fmss data ver is not new"):this.fetchMixStreamStatus(X)}else this.logger.info("zb.sh.fmss taskId don't exist"),this.mixRequestIdList.push(Ze)}},fetchMixStreamStatus:function(Z){var $=this;this.mixStreamProtoBuf||(this.mixStreamProtoBuf=new f);var K={request_seq:this.stateCenter.getSeq(),task_id:Z},X=this.mixStreamProtoBuf.encodeGetMixStreamStatusReq(K),B=Z.replace(this.stateCenter.appid+":","");this.sendMixRequest({interfaceID:13},X,function(fe,Ce){var Ze=function(ze){try{var ft=$.mixStreamProtoBuf.decodeGetMixStreamStatusRsp(ze);(0,H.M$)(ft),$.logger.info("zb.sh.fmss rsp "+JSON.stringify(ft));var _t=ft.common_response;return{code:_t.code,msg:_t.message,push_url:ft.push_url,request_seq:ft.request_seq,task_id:ft.task_id,version:ft.version}}catch{return{code:-1}}}(fe),st=Ze.code,Ie=Ze.msg,D=Ze.push_url,me=Ze.task_id,ce=Ze.version;if(st!==void 0&&st!==0||!(0,A.Cs)(ce))$.logger.warn("zb.sh.fmss fail "+st+" "+Ie);else{var le=$.mixStreamTaskList[B];if(!le)return void $.logger.info("zb.sh.fmss taskId don't exist");if(ce<=le.mixStatusVer&&ce!=1)return void $.logger.warn("zb.sh.fmss data ver is not new");le.mixStatusVer=ce;var et=[];D.forEach(function(ze){et.push({url:ze.url,state:Le[ze.status],updateReason:pe[ze.reason],stateTime:v.isLong(ze.mod_time)?ze.mod_time.toNumber():ze.mod_time})}),$.stateCenter.actionListener("mixerRelayCDNStateUpdate",me,et)}},function(fe,Ce,Ze){$.logger.warn("zb.sh.fmss http fail "+fe+" "+JSON.stringify(Ze))})},startMixHb:function(Z){var $=this;this.logger.info("zb.sh.smh.0 call");var K={request_seq:this.stateCenter.getSeq(),task_id:"".concat(Z)},X=this.mixStreamProtoBuf.encodeMixStreamTaskHbReq(K);this.sendMixRequest({interfaceID:12},X,function(B,fe){var Ce=function(me){try{var ce=$.mixStreamProtoBuf.decodeMixStreamTaskHbRsp(me);(0,H.M$)(ce),$.logger.info("zb.sh.smh.0 rsp "+JSON.stringify(ce));var le=ce.common_response;return{code:le.code,msg:le.message,status:ce.status,hb_interval:ce.hb_interval}}catch{return{code:-1}}}(B),Ze=Ce.code,st=Ce.msg,Ie=Ce.status,D=Ce.hb_interval;Ze===void 0||Ze===0?($.logger.info("zb.sh.smh.0 suc ".concat(Ie," ").concat(D)),(0,A.Cs)(D)&&Ie===0&&(!$.mixStreamHbList[Z]&&($.mixStreamHbList[Z]={}),$.mixStreamHbList[Z].timer=setTimeout(function(){$.startMixHb(Z)},1e3*D))):$.logger.info("zb.sh.smh.0 fail ".concat(Ze," ").concat(st))},function(B,fe,Ce){$.logger.info("zb.sh.smh.0 send err ".concat(B," ").concat(Ce))})}},xe={type:"MixStream",install:function(Z,$){for(var K in ee)Object.defineProperty(Z.prototype,K,{value:ee[K],writable:!1});for(var K in ae)Object.defineProperty($.prototype,K,{value:ae[K],writable:!1})}}},9728:function(It,Ye,Te){var E,w,Re,we,he;Te.d(Ye,{Xk:function(){return we},zN:function(){return he}}),function(Me){Me[Me.AspectFill=0]="AspectFill",Me[Me.AspectFit=1]="AspectFit"}(E||(E={})),function(Me){Me[Me.ZegoFontTypeSourceHanSans=0]="ZegoFontTypeSourceHanSans",Me[Me.ZegoFontTypeAlibabaSans=1]="ZegoFontTypeAlibabaSans",Me[Me.ZegoFontTypePangMenZhengDaoTitle=2]="ZegoFontTypePangMenZhengDaoTitle",Me[Me.ZegoFontTypeHappyZcool=3]="ZegoFontTypeHappyZcool"}(w||(w={})),function(Me){Me[Me.ZegoAudioMixModeRaw=0]="ZegoAudioMixModeRaw",Me[Me.ZegoAudioMixModeFocused=1]="ZegoAudioMixModeFocused"}(Re||(Re={})),function(Me){Me[Me.ZegoAudioCodecIDNormal=1]="ZegoAudioCodecIDNormal",Me[Me.ZegoAudioCodecIDNormal2=2]="ZegoAudioCodecIDNormal2",Me[Me.ZegoAudioCodecIDLow3=6]="ZegoAudioCodecIDLow3"}(we||(we={})),function(Me){Me[Me.ZegoEncodeProfileDefault=0]="ZegoEncodeProfileDefault",Me[Me.ZegoEncodeProfileBaseline=1]="ZegoEncodeProfileBaseline",Me[Me.ZegoEncodeProfileMain=2]="ZegoEncodeProfileMain",Me[Me.ZegoEncodeProfileHigh=3]="ZegoEncodeProfileHigh"}(he||(he={}))}},dt={};function pt(It){var Ye=dt[It];if(Ye!==void 0)return Ye.exports;var Te=dt[It]={exports:{}};return bt[It].call(Te.exports,Te,Te.exports,pt),Te.exports}pt.n=function(It){var Ye=It&&It.__esModule?function(){return It.default}:function(){return It};return pt.d(Ye,{a:Ye}),Ye},pt.d=function(It,Ye){for(var Te in Ye)pt.o(Ye,Te)&&!pt.o(It,Te)&&Object.defineProperty(It,Te,{enumerable:!0,get:Ye[Te]})},pt.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),pt.o=function(It,Ye){return Object.prototype.hasOwnProperty.call(It,Ye)},pt.r=function(It){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(It,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(It,"__esModule",{value:!0})};var Ft={};return function(){pt.r(Ft),pt.d(Ft,{WebRTCUtil:function(){return Pc},ZegoExpressEngine:function(){return If}});var It,Ye,Te=pt(3052),E=pt(2638);(function(o){o[o.CN=2]="CN",o[o.NA=3]="NA",o[o.EU=4]="EU",o[o.AS=5]="AS",o[o.IN=6]="IN",o[o.NCN=7]="NCN"})(It||(It={})),function(o){o[o.ZegoDefined=0]="ZegoDefined",o[o.UserUnregister=1]="UserUnregister"}(Ye||(Ye={}));var w,Re,we;(function(o){o[o.disconnected=0]="disconnected",o[o.connecting=1]="connecting",o[o.connected=2]="connected"})(w||(w={})),function(o){o[o.tryProbe=0]="tryProbe",o[o.probed=2]="probed"}(Re||(Re={})),function(o){o[o.replaceNew=0]="replaceNew",o[o.changeResolution=1]="changeResolution"}(we||(we={}));var he,Me={0:{code:1,description:"user_stop_publishing_stream_normal"},1:{code:2,description:"user_heart_beat_timeout"},2:{code:3,description:"user_repeat_login"},3:{code:4,description:"user_kicked_out"},4:{code:5,description:"user_offline"},100:{code:6,description:"remove_by_server"}};(function(o){o[o.UNKNOWN=0]="UNKNOWN",o[o.CDN=1]="CDN",o[o.RTC=2]="RTC",o[o.L3=3]="L3"})(he||(he={}));var nt,Ne;(function(o){o[o.publish_quality=0]="publish_quality",o[o.play_quality=1]="play_quality",o[o.charge=2]="charge"})(nt||(nt={})),function(o){o[o.low=1]="low",o[o.stantard=2]="stantard",o[o.hight=3]="hight",o[o.custome=4]="custome"}(Ne||(Ne={}));var W,Q,se={stop:0,start:1,waiterAnswer:2,waitingCandidate:3,sendCandidate:4,iceConnected:5,iceDisconnected:6,iceClosed:7,iceFailed:8};(function(o){o[o.Delete=0]="Delete",o[o.Add=1]="Add"})(W||(W={})),function(o){o[o.captureFpsToLow=1001]="captureFpsToLow",o[o.captureVolumeToLow=1002]="captureVolumeToLow",o[o.sendVideoBitrateToLow=1003]="sendVideoBitrateToLow",o[o.sendFpsToLow=1004]="sendFpsToLow",o[o.sendAudioBitrateToLow=1005]="sendAudioBitrateToLow",o[o.receiveVolumeToLow=1006]="receiveVolumeToLow",o[o.receiveAudioDecodedFail=1007]="receiveAudioDecodedFail",o[o.receiveVideoDecodedFail=1008]="receiveVideoDecodedFail",o[o.receiveVideoFpsDecodedToLow=1009]="receiveVideoFpsDecodedToLow",o[o.renderVideoFpsToLow=1010]="renderVideoFpsToLow",o[o.captureFpsNormal=2001]="captureFpsNormal",o[o.captureVolumeNormal=2002]="captureVolumeNormal",o[o.sendVideoBitrateNormal=2003]="sendVideoBitrateNormal",o[o.sendFpsNormal=2004]="sendFpsNormal",o[o.sendAudioBitrateNormal=2005]="sendAudioBitrateNormal",o[o.receiveVolumeNormal=2006]="receiveVolumeNormal",o[o.receiveAudioDecodedNormal=2007]="receiveAudioDecodedNormal",o[o.receiveVideoDecodedNormal=2008]="receiveVideoDecodedNormal",o[o.receiveVideoFpsDecodedNormal=2009]="receiveVideoFpsDecodedNormal",o[o.renderVideoFpsNormal=2010]="renderVideoFpsNormal"}(Q||(Q={}));var J,G,U,C;(function(o){o[o.PortraitSegmentation=0]="PortraitSegmentation"})(J||(J={})),function(o){o[o.BASE_LINE=1]="BASE_LINE",o[o.MAIN=2]="MAIN",o[o.HIGH=3]="HIGH"}(G||(G={})),function(o){o[o.METHOD_UNSET=0]="METHOD_UNSET",o[o.METHOD_GET=1]="METHOD_GET",o[o.METHOD_POST=2]="METHOD_POST",o[o.METHOD_PUT=3]="METHOD_PUT",o[o.METHOD_PATCH=4]="METHOD_PATCH",o[o.METHOD_DELETE=5]="METHOD_DELETE",o[o.METHOD_HEAD=6]="METHOD_HEAD",o[o.METHOD_OPTIONS=7]="METHOD_OPTIONS"}(U||(U={})),function(o){o[o.SERVICE_UNSET=0]="SERVICE_UNSET",o[o.SERVICE_MEDIAGW=1]="SERVICE_MEDIAGW",o[o.SERVICE_LIVEROOM=2]="SERVICE_LIVEROOM",o[o.SERVICE_MIX=3]="SERVICE_MIX",o[o.SERVICE_ZEUS=4]="SERVICE_ZEUS",o[o.SERVICE_ZPUSH=5]="SERVICE_ZPUSH",o[o.SERVICE_L3=6]="SERVICE_L3",o[o.SERVICE_TALKLINE=7]="SERVICE_TALKLINE",o[o.SERVICE_EDUSUITE=8]="SERVICE_EDUSUITE",o[o.SERVICE_ZIM=9]="SERVICE_ZIM",o[o.SERVICE_ClOUD_SETTING=10]="SERVICE_ClOUD_SETTING",o[o.SERVICE_ZEUSHB=11]="SERVICE_ZEUSHB",o[o.SERVICE_USER_LOGIC=12]="SERVICE_USER_LOGIC",o[o.SERVICE_UNIFYDISPATCH=13]="SERVICE_UNIFYDISPATCH",o[o.SERVICE_QUALITY=14]="SERVICE_QUALITY",o[o.SERVICE_SECURITY=15]="SERVICE_SECURITY",o[o.SERVICE_KTVCPR=16]="SERVICE_KTVCPR",o[o.SERVICE_SWITCH4LIVEROOM=17]="SERVICE_SWITCH4LIVEROOM",o[o.SERVICE_WEBRTC_SIGNAL=18]="SERVICE_WEBRTC_SIGNAL",o[o.SERVICE_L3_WEBRTC_SIGNAL=19]="SERVICE_L3_WEBRTC_SIGNAL",o[o.SERVICE_VIDEOCPR=20]="SERVICE_VIDEOCPR",o[o.SERVICE_CDN=21]="SERVICE_CDN",o[o.SERVICE_CLOUDRECORD=22]="SERVICE_CLOUDRECORD",o[o.SERVICE_INNER_ECHO=23]="SERVICE_INNER_ECHO",o[o.SERVICE_OUTER_ECHO=24]="SERVICE_OUTER_ECHO",o[o.SERVICE_LOCALHOST_ECHO=25]="SERVICE_LOCALHOST_ECHO",o[o.SERVICE_ECHO=26]="SERVICE_ECHO",o[o.SERVICE_DOCSERVICE=27]="SERVICE_DOCSERVICE",o[o.SERVICE_AUTHSVR=28]="SERVICE_AUTHSVR"}(C||(C={}));var N,v={width:320,height:240,frameRate:15,bitRate:300},f={width:640,height:480,frameRate:15,bitRate:800},_={width:1280,height:720,frameRate:20,bitRate:1500},b={frameRate:20,bitRate:800},y={frameRate:15,bitRate:1500},M={frameRate:5,bitRate:2e3};(function(o){o[o.IPv4Only=0]="IPv4Only",o[o.IPv4Prefer=1]="IPv4Prefer",o[o.IPv6Prefer=2]="IPv6Prefer"})(N||(N={}));var Y,L,A,H,ge,Ee,Se,ue,oe,be,Le={0:"IPv4Only",1:"IPv4Prefer",2:"IPv6Prefer"};(function(o){o[o.IPv4=0]="IPv4",o[o.IPv6=1]="IPv6"})(Y||(Y={})),function(o){o[o.kV4Only=0]="kV4Only",o[o.kV4AndV6=1]="kV4AndV6",o[o.kV6AndV4=2]="kV6AndV4"}(L||(L={})),function(o){o[o.ZV4Only=0]="ZV4Only",o[o.ZV4Priority=1]="ZV4Priority",o[o.ZV6Priority=2]="ZV6Priority",o[o.ZV6AndV4Priority=3]="ZV6AndV4Priority"}(A||(A={})),function(o){o[o.unreachable=0]="unreachable",o[o.unknown=1]="unknown",o[o.reachable=2]="reachable"}(H||(H={})),function(o){o[o.probed=0]="probed",o[o.noProbe=1]="noProbe",o[o.probing=2]="probing"}(ge||(ge={})),function(o){o[o.LOGOUT=0]="LOGOUT",o[o.TRY_LOGIN=1]="TRY_LOGIN",o[o.LOGIN=2]="LOGIN"}(Ee||(Ee={})),function(o){o[o.RSP=0]="RSP",o[o.PUSH=1]="PUSH"}(Se||(Se={})),function(o){o.Logining="LOGINING",o.Logined="LOGINED",o.LoginFailed="LOGIN_FAILED",o.Reconnecting="RECONNECTING",o.Reconnected="RECONNECTED",o.ReconnectFailed="RECONNECT_FAILED",o.Kickout="KICKOUT",o.Logout="LOGOUT",o.LogoutFailed="LOGOUT_FAILED"}(ue||(ue={})),function(o){o[o.ZegoRoomTransparentMessageModeOnlyClient=0]="ZegoRoomTransparentMessageModeOnlyClient",o[o.ZegoRoomTransparentMessageModeOnlyServer=1]="ZegoRoomTransparentMessageModeOnlyServer",o[o.ZegoRoomTransparentMessageModeClientAndServer=2]="ZegoRoomTransparentMessageModeClientAndServer"}(oe||(oe={})),function(o){o[o.ZegoRoomTransparentMessageNormal=0]="ZegoRoomTransparentMessageNormal",o[o.ZegoRoomTransparentMessageSequence=1]="ZegoRoomTransparentMessageSequence"}(be||(be={}));var pe={SERVER:{code:0,msg:"liverooom cmd error"},SUCCESS:{code:0,msg:"success."},INIT:{code:2000000001,msg:"init sdk wrong"},NOT_LOGIN:{code:1000002,msg:"not login"},APPID_INVALID:{code:1001004,msg:"appid invalid"},SDK_NOT_SPECIAL:{code:1001005,msg:"sdk require special"},NETWORK_BROKEN:{code:1000017,msg:"network is broken"},GEO_SET_ERROR:{code:1000018,msg:"geo set error"},INPUT_PARAM:{code:1100001,msg:"input parm error."},TIMEOUT:{code:1100002,msg:"network timeout."},SOCKET_CLOSE:{code:1100003,msg:"socket close"},NET_SOCKET_TIMEOUT:{code:1100004,msg:"net agent timeout"},NET_HB_TIMEOUT:{code:1100005,msg:"net hb timeout"},INIT_SDK_WRONG:{code:1101e3,msg:"init sdk wrong"},ROOM_COUNT_EXCEED:{code:1002001,msg:"login rooms exceeds the upper limit"},MULTI_ROOM_COUNT_EXCEED:{code:1002037,msg:"login rooms exceeds the upper limit"},ROOM_ROOMID_INCORRECT:{code:1002002,msg:"have not logged in with this room ID"},USER_ID_NULL:{code:1002005,msg:"user ID is empty"},USER_ID_INVALID_CHARACTER:{code:1002006,msg:"user ID contains illegal characters"},USER_ID_TOO_LONG:{code:1002007,msg:"user ID is too long"},USER_NAME_NULL:{code:1002008,msg:"username is empty"},USER_NAME_TOO_LONG:{code:1002010,msg:"username is too long"},ROOM_ID_NULL:{code:1002011,msg:"room ID is empty"},ROOM_ID_INVALID_CHARACTER:{code:1002012,msg:"room ID contains illegal characters"},ROOM_ID_TOO_LONG:{code:1002013,msg:"room ID is too long"},ROOM_NOT_EXIST:{code:1002014,msg:"room not exist"},ROOM_EXTRA_INFO_KEY_LIMIT:{code:1002017,msg:"room extra info key exceed the limit"},DIFFERENT_USER_ID:{code:1002018,msg:"In multi-room mode, only the same user id can be used."},NO_PUBLISH_AUTH:{code:1002082,msg:"Token does not have the permission to publish current stream."},USER_HAD_LOGIN_OTHER:{code:1002086,msg:"the user had logined in other device"},LOGIN_TIMEOUT:{code:1002031,msg:"login timeout"},ROOM_MAX_USER_COUNT:{code:1002034,msg:"users logging into the room exceeds the maximum number"},MULTI_ROOM_UNABLE:{code:1002036,msg:"multi room unable"},MULTIPLE_LOGIN_KICKOUT:{code:1002050,msg:"kickout may be the same user ID login other"},NETWORK_RECOVERY:{code:1002051,msg:"network recovery"},ROOM_RETRY_TIMEOUT:{code:1002053,msg:"network is broken and login fail."},MANUAL_KICKOUT:{code:1002055,msg:"server has sent a signal to kick out"},REPEATEDLY_LOGIN:{code:1002056,msg:"user repeatedly login"},REPEATEDLY_ENTER_ROOM:{code:1002057,msg:"user repeatedly enter room"},ALREADY_LOGIN:{code:1002058,msg:"user already logged in"},LOGIN_BEFORE_LOGOUT_BY_SAME_ROOMID:{code:1002064,msg:"the roomID is used by the login room interface"},FORBID_BLACK_USER:{code:1002066,msg:"forbid black user"},TOKEN_USERID_ERROR:{code:1002077,msg:"the token userid error"},NATIVE_TOKEN_EXPIRED:{code:1002078,msg:"token expire error"},WHITE_BOARD_VERSION_ERROR:{code:1002098,msg:"Mismatch with RTC SDK version, please upgrade ZegoSuperBoard or ZegoWhiteboardView SDK to the latest version"},ROOM_INNER_ERROR:{code:1002099,msg:"room inner error"},HEARTBEAT_TIMEOUT:{code:1102001,msg:"heartbeat timeout."},PARSE_JSON_ERROR:{code:1102011,msg:"parse json error."},LOGIN_PROCESSING:{code:1102012,msg:"login is processing."},LIVEROMM_REQUEST_ERROR:{code:1102013,msg:"liveroom request error."},ZPUSH_REQUEST_FAIL:{code:1102014,msg:"zpush request fail."},LOGIN_STATE_WRONG:{code:1102015,msg:"user login state is wrong."},TOKEN_ERROR:{code:1102016,msg:"token error"},DIAPATCH_ERROR:{code:1102017,msg:"dispatch error"},TOKEN_EXPIRED:{code:1102018,msg:"token expired"},SUBCMD_ERROR:{code:1102019,msg:"subcmd error."},ZEGO_AUTH_ERROR:{code:1102020,msg:"zego auth error."},BIZ_CHANNEL_ERROR:{code:1102021,msg:"biz channel error."},UPLOAD_LOG_ERROR:{code:1102025,msg:"upload zip logs failed"}},k=pt(4908),R=pt(4872),Fe=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],te=pt(8866),Ue=pt(955),it=pt.n(Ue),ee=pt(5178),ae=pt.n(ee),xe="TOKEN_ERROR",Z="TOKEN_EXPIRED",$="ROOM_INNER_ERROR";function K(o,e,t){e.success&&(t[o+"SuccessCallback"]=e.success),e.error&&(t[o+"ErrorCallback"]=e.error)}function X(o,e){return e[o+"SuccessCallback"]}function B(o,e,t,n){K(o,{success:function(r,i){for(var s=[],c=2;c<arguments.length;c++)s[c-2]=arguments[c];(function(u,l,a,h,m){switch(a){case"eventStart":u.eventStart(l,h);break;case"eventEndWithMsgInfo":u.eventEndWithMsgInfo(l,h,m[0]);break;case"addEventMsg":u.addEventMsg(l,h,m[0],m[1]);break;case"addEvent":u.addEvent(l,h);break;case"eventEnd":u.eventEnd(l,h);break;case"addMsgInfo":u.addMsgInfo(l,m[0])}})(e,t,r,i,s)}},n)}function fe(o,e){return{code:o,msg:e||"liveroom error"}}function Ce(o,e){delete e[o+"SuccessCallback"],delete e[o+"ErrorCallback"]}function Ze(o,e){var t={code:o,message:"server error"};return t.code=o+52e6,e&&(t.message=e),t}function st(o,e){var t={1016:"MULTI_ROOM_UNABLE",1105:"ROOM_MAX_USER_COUNT",1012:"PUBLISHER_ERROR_REPETITIVE_PUBLISH_STREAM",2002:xe,2003:"ROOM_ERROR_LOGIN_TIMEOUT",2010:xe,5022:"MULTI_ROOM_COUNT_EXCEED",5030:"FORBID_BLACK_USER"};return o>2e5&&o<3e5?t[o-2e5]||$:o<2e5?{50013:"USER_HAD_LOGIN_OTHER",50116:xe,50117:Z,50118:xe,50119:xe,50120:xe,50121:xe,50122:xe,50123:Z,50124:xe,50125:xe,50126:xe,50127:xe,50128:xe}[o]||t[o]||$:t[o]||$}function Ie(o,e,t,n){var r,i=[],s=[],c=[],u=[];t||(t=[]);for(var l=0;l<t.length;l++)if(t[l].anchor_id_name!=o&&t[l].id_name!=o&&t[l].user_id!=o){r=!1;for(var a=0;a<e.length;a++)if(t[l].stream_id===e[a].stream_id){t[l].extra_info!==e[a].extra_info&&c.push(t[l]),JSON.stringify(t[l].stream_attr_opts)!==JSON.stringify(e[a].stream_attr_opts)&&u.push(t[l]),r=!0;break}r||i.push(t[l])}for(var h=0;h<e.length;h++)if(e[h].anchor_id_name!=o&&e[h].id_name!=o&&e[h].user_id!=o){r=!1;for(var m=0;m<t.length;m++)if(e[h].stream_id===t[m].stream_id&&t[m].stream_state!==1){r=!0;break}r||s.push(e[h])}for(e.splice(0),l=0;l<t.length;l++)e.push(t[l]);n(i,s,c,u)}function D(o,e,t){return e=e??1,t=t??1e4,(0,R.Cs)(o)&&o%1==0&&o>=e&&o<=t}function me(o,e){var t,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[];if(e=e||n.length,o)for(t=0;t<o;t++)r[t]=n[0|Math.random()*e];else{var i=void 0;for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",t=0;t<36;t++)r[t]||(i=0|16*Math.random(),r[t]=n[t==19?3&i|8:i])}return r.join("")}function ce(o,e,t){return o.push(e),o.length>t&&o.shift(),o.reduce(function(n,r){return n+r})/o.length}function le(o){return o<600?97-Math.pow(.09*o,1.1):18*Math.exp(.002*(600-o))}function et(o,e){if(e)return o<=55?99-Math.pow(.8*o,1.18):E.Bl.PoorMinQuality;var t=100*o;return t<=40?96-Math.pow(t,1.22):E.Bl.PoorMinQuality}function ze(o,e,t){if((0,R.TE)(t))return Math.min(le(o),et(e,!0));var n=function(r){return r<=50?98-Math.pow(r,1.15):E.Bl.PoorMinQuality}(t);return .15*n+.85*Math.min(le(o),et(e,!1))}function ft(o){return o>=E.Bl.ExcellentMinQuality?E.b3.Excellent:o>=E.Bl.GoodMinQuality?E.b3.Good:o>=E.Bl.MiddleMinQuality?E.b3.Middle:o>=E.Bl.PoorMinQuality?E.b3.Poor:E.b3.Die}function _t(){var o=!!window.RTCRtpScriptTransform;if(!o){var e=!!RTCRtpSender.prototype.createEncodedStreams,t=!1;try{new ReadableStream,t=!0}catch{console.error("Transferable streams are not supported.")}o=e&&t}return o}function mt(){return typeof RTCPeerConnection.prototype.setConfiguration=="function"}function Ve(o){for(var e,t=0,n=o.length,r="";t<n;)e=o.subarray(t,Math.min(t+32768,n)),r+=String.fromCharCode.apply(null,Array.from(e)),t+=32768;return btoa(r)}function Ot(o){var e=[];return o.getTracks().forEach(function(t){e.push(t.kind==="audio"?"mic(".concat(t.id,",").concat(t.label,",").concat(t.muted,",").concat(t.enabled,",").concat(t.readyState,")"):"camera(".concat(t.id,",").concat(t.label,",").concat(t.muted,",").concat(t.enabled,",").concat(t.readyState,")"))}),e.join("|")}function rn(o,e,t,n){var r=n!=null&&n.streamID?" ".concat(n.streamID," "):"";e.info(o.kind==="audio"?t+" mic(".concat(o.id,",").concat(o.label,",").concat(o.muted,",").concat(o.enabled,",").concat(o.readyState,")"):t+" camera(".concat(o.id,",").concat(o.label,",").concat(o.muted,",").concat(o.enabled,",").concat(o.readyState,")"),{streamid:r})}function an(o,e){var t={};if(o)for(var n=0,r=Object.keys(o);n<r.length;n++){var i=r[n];e.includes(i)||(t[i]=o[i])}return t}var In=function(o){var e=0;if(o.length==0)return e;for(var t=0;t<o.length;t++)e=(e<<5)-e+o.charCodeAt(t),e&=e;return e>>>0};function Tn(o,e,t){var n=new Date().getTime(),r=(0,E.wN)(),i="".concat(o,"_").concat(e,"_").concat(t,"_").concat(n,"_").concat(r);return In(i)}function fn(o,e){return(o&1<<e)>>e}function Rr(){var o=window.navigator.userAgent,e=window.ActiveXObject!=null&&o.indexOf("MSIE")!=-1,t=o.indexOf("Firefox")!=-1,n=window.opr!=null,r=o.indexOf("Chrome")&&window.chrome,i=o.indexOf("Safari")!=-1&&o.indexOf("Version")!=-1;return e?"IE":t?"Firefox":n?"Opera":r?"Chrome":i?"Safari":"Unkown"}function ir(){var o=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return((o==null?void 0:o.effectiveType)||(o==null?void 0:o.type)||"unknown").toUpperCase()}function Ln(o,e){return it().encrypt(o,e).toString()}function mn(o,e){try{return it().decrypt(o,e).toString(ae())}catch{return""}}function Qn(o,e){try{localStorage.setItem(o,e)}catch{}}function Nn(o){try{return localStorage.getItem(o)}catch{}}function or(o,e,t,n){return{interResolve:function(r){o.uploadReport(e),t(r)},interReject:function(r,i){var s;i===void 0&&(i=""),(s=r.code<2e9&&r.code>1e9?Ze(r.code,r.msg):{code:r.code,message:r.msg})&&o.addMsgInfo(e,{error:s.code,message:s.message+i}),o.uploadReport(e),n({errorCode:r.code||r.errorCode})}}}function pr(o){return!(!o.startsWith("wss")||o.indexOf("test")===-1||!o.endsWith("ws"))}function sr(o){try{var e=Uint8Array.from(function(r){var i,s,c,u,l,a,h;for(a=r.length,l=0,h="";l<a;){do i=Fe[255&r.charCodeAt(l++)];while(l<a&&i==-1);if(i==-1)break;do s=Fe[255&r.charCodeAt(l++)];while(l<a&&s==-1);if(s==-1)break;h+=String.fromCharCode(i<<2|(48&s)>>4);do{if((c=255&r.charCodeAt(l++))==61)return h;c=Fe[c]}while(l<a&&c==-1);if(c==-1)break;h+=String.fromCharCode((15&s)<<4|(60&c)>>2);do{if((u=255&r.charCodeAt(l++))==61)return h;u=Fe[u]}while(l<a&&u==-1);if(u==-1)break;h+=String.fromCharCode((3&c)<<6|u)}return h}(o),function(r){return r.charCodeAt(0)}),t=new DataView(e.buffer),n=void 0;return n=(0,R.JO)(t.getBigInt64)?t.getBigUint64(0):function(r,i,s){var c=s.getUint32(r,i),u=s.getUint32(r+4,i),l=i?c+Math.pow(2,32)*u:Math.pow(2,32)*c+u;return Number.isSafeInteger(l)||console.warn(l,"exceeds MAX_SAFE_INTEGER. Precision may be lost"),l}(0,!1,t),Number(n>0?n:t.getBigUint64(0,!0))}catch{console.error("token error")}return-1}function Wr(o){var e=new Date().getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),(r=="x"?i:3&i|8).toString(36)});if(o===0){var n=function(r){var i=document.createElement("canvas"),s=i.getContext("2d"),c=r;s.textBaseline="top",s.font="14px 'Arial'",s.fillStyle="#f60",s.fillRect(125,1,62,20),s.fillStyle="#069",s.fillText(c,2,15),s.fillStyle="rgba(102, 204, 0, 0.7)",s.fillText(c,4,17);var u=i.toDataURL().replace("data:image/png;base64,",""),l=function(a){var h,m,S,x="";for(h=0,m=(a+="").length;h<m;h++)x+=(S=a.charCodeAt(h).toString(16)).length<2?"0"+S:S;return x}(atob(u).slice(-16,-12));return l}("hello, zego");t=n+t.slice(8)}return t}function tr(){var o=Te.GG.NT_UNKNOWN,e="",t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return(e=((t==null?void 0:t.effectiveType)||(t==null?void 0:t.type)||"unknown").toUpperCase()).indexOf("4G")>-1?o=Te.GG.NT_4G:e.indexOf("2G")>-1?o=Te.GG.NT_2G:e.indexOf("3G")>-1?o=Te.GG.NT_3G:e.indexOf("WIFI")>-1?o=Te.GG.NT_WIFI:e.indexOf("LINE")>-1?o=Te.GG.NT_LINE:e.indexOf("NONE")>-1&&(o=Te.GG.NT_NONE),o}var zn,bn,Jn=pt(2799),zr=1,jn={product:"rtc_web",importLevel:Te.t0.H,levels:[0,10,100,1e3],bps:32e3},Lr="0c9e6e0f8c0a8f4e",Vr="z_net_access_servers",Ai="z_net_http3_access_servers",Yr="z_net_v6_access_servers",Qr="z_net_http3_v6_access_servers",Ci="z_appconfig",Si="z_appconfig_etag",ri="z_geos",fr="z_rtc_domains",Yn={domains:["accesshub-wss.zego.im","accesshub-wss.coolzcloud.com","accesshub-wss.zegocloud.com"],logreportDomain:"weblogger-wss.coolfcloud.com",prefixDomain:"accesshub-wss",rtcLogPath:"zglog/ws",wssV6preFixDomain:"accesshub-wss-v6",normalPriDomains:["coolbcloud.com","coolgcloud.com"],specialDomain:"cooldcloud.com",mode:"online",modeNo:Jn.Mode.MODE_ONLINE,sdkType:3,connectVer:4,pcEstablishTimeout:15,scheme:"wss",location:"accesshub",wssMessageType:1},yi="weblogger-wss",dr="detaillog-global",ii=[{id:2,relative_geofencings:[],accesshub:"accesshub-wss-geo-2",wssV6Accesshub:"accesshub-wss-geo-2-v6",logreport:"weblogger-wss-geo-2",detaillog:"detaillog-geo-2"},{id:3,relative_geofencings:[7],accesshub:"accesshub-wss-geo-3",wssV6Accesshub:"accesshub-wss-geo-3-v6",logreport:"weblogger-wss-geo-3",detaillog:"detaillog-geo-3"},{id:4,relative_geofencings:[7],accesshub:"accesshub-wss-geo-4",wssV6Accesshub:"accesshub-wss-geo-4-v6",logreport:"weblogger-wss-geo-4",detaillog:"detaillog-geo-4"},{id:5,relative_geofencings:[7],accesshub:"accesshub-wss-geo-5",wssV6Accesshub:"accesshub-wss-geo-5-v6",logreport:"weblogger-wss-geo-5",detaillog:"detaillog-geo-5"},{id:6,relative_geofencings:[7],accesshub:"accesshub-wss-geo-6",wssV6Accesshub:"accesshub-wss-geo-6-v6",logreport:"weblogger-wss-geo-6",detaillog:"detaillog-geo-6"},{id:7,relative_geofencings:[3,4,5,6,1],accesshub:"accesshub-wss-geo-7",wssV6Accesshub:"accesshub-wss-geo-7-v6",logreport:"weblogger-wss-geo-7",detaillog:"detaillog-geo-7"}],kn=[2,3,4,5,6],nr="zm.0",Fn="zm.wl",_r="zm.slf",P="zm.lg",He="zm.lo",de="zm.sr",ne="zm.fac",De="zm.fac.tk",ye="zm.hlu",Qe="zm.cna",Ke="zm.gsac",$e="zm.zpl.url",at="zm.glgf",ht="zm.scsu",Ct="zm.on",St="zm.off",kt="zm.rntk",Ut="zm.emr",Lt="zm.rm.lg",cn="zm.rm.tl",_n="zm.rm.lgr",vn="zm.rm.lo",xn="zm.rm.rr",An="zm.rm.kco",Zn="zm.rm.gwl",Kn="zm.hhl",Bn="zm.hb.st",Jr="zm.hb.rsp",ui="zm.rrh.hlf",Zr="zm.us.ftu",kr="zm.us.urp",Fr="zm.us.uph",qr="zm.us.mg",Sr="zm.st.at",Dn="ON_LISTENER",li="zm.st.ofls",Hr="zm.lrh.sm",Xr="zm.lrh.hp",z="zm.lrh.hsp",T="zm.lrh.gs",F="zm.lrh.lgi",ve="zm.lrh.ful",Ae="zm.lrh.lgo",We="zm.lrh.sru",Xe="zm.lrh.scc",ot="zm.lrh.hd",lt="zm.lrh.hb",Tt="zm.tc.ii",Nt="zm.nt.od",Yt=function(o){return o},Rn=function(o){return o},nn=function(o){return o},en=function(o){return o},Zt=function(o){return o},Cn={event:"/sdk/init",error:{kInvalidParamError:pe.INPUT_PARAM},system_info:nn,servers:function(o){return o},is_from_cache:Zt,project:nn,liveroom_version:nn,biz_type:en,lua_md5:nn,sev_env:nn,use_na:en},qn="listener",hr="/sdk/set_debug",vr=nn,gr={event:"/sdk/set_log_config",error:{kInvalidParamError:pe.INPUT_PARAM},log_level:function(o){return o},remote_log_level:nn,log_url:nn},Wn="/log/upload",ur={event:"/sdk/login",room_id:nn,room_sid_string:nn,user_state_update:en,max_member_cnt:en,message:nn,token:nn,svr_env:nn,server:nn,try_cnt:en,room_mode:en,role:en,audience_create_room:en,liveroom_sid_string:nn,error:{ROOM_ID_NULL:pe.ROOM_ID_NULL,INPUT_PARAM:pe.INPUT_PARAM,ROOM_ID_TOO_LONG:pe.ROOM_ID_TOO_LONG,ROOM_ID_INVALID_CHARACTER:pe.ROOM_ID_INVALID_CHARACTER,USER_ID_NULL:pe.USER_ID_NULL,USER_ID_TOO_LONG:pe.USER_ID_TOO_LONG,USER_ID_INVALID_CHARACTER:pe.USER_ID_INVALID_CHARACTER,USER_NAME_NULL:pe.USER_NAME_NULL,USER_NAME_TOO_LONG:pe.USER_NAME_TOO_LONG,REPEATEDLY_LOGIN:pe.REPEATEDLY_LOGIN,LOGIN_TIMEOUT:pe.LOGIN_TIMEOUT,INNER_ERROR:pe.ROOM_INNER_ERROR,NETWORK_BROKEN:pe.NETWORK_BROKEN,ROOM_COUNT_EXCEED:pe.ROOM_COUNT_EXCEED,DIFFERENT_USER_ID:pe.DIFFERENT_USER_ID,LOGIN_BEFORE_LOGOUT_BY_SAME_ROOMID:pe.LOGIN_BEFORE_LOGOUT_BY_SAME_ROOMID}},Gi="/sdk/sublogin",uo={event:"/zpush/login",sdk_zpush_sessionid_string:nn},nl={event:"/liveroom/enter"},Ts={event:"/sdk/renew_token",error:{INPUT_PARAM:pe.INPUT_PARAM,NOT_LOGIN:pe.NOT_LOGIN},token:nn},rl="/zpush/hb_timeout",ji={event:"/sdk/logout",error:{INPUT_PARAM:pe.INPUT_PARAM,ROOM_ROOMID_INCORRECT:pe.ROOM_ROOMID_INCORRECT},room_id:nn,room_sid_string:nn,is_multi:Zt,is_send_cmd_net:Zt,liveroom_sid_string:nn,reason:nn},Ta="/switch/logout_user",il="/liveroom/quit",ol=nn,sl=nn,al="/zpush/multi_logout_user",Yc="/sdk/relogin",Es={event:"/liveroom/tempbroken"},lc={event:"/sdk/reconnect",room_broken_time:en},dc={event:"/sdk/disconnect",valid_d:en,total_d:en,tempbroken_cnt:en},Zc="/sdk/kickout",cl=en,Ea=en,lo={event:"/liveroom/hb",room_id:nn,room_sid_string:nn,interval:en,stream_seq:en,server_user_seq:en,error:{NOT_LOGIN:pe.NOT_LOGIN,HB_TIMEOUT:pe.TIMEOUT}},ul="/liveroom/recv_user_update_info",ll="/sdk/listener",ro={event:"/sdk/enable_multi_room",is_multi:Zt,error:{kInvalidParamError:pe.INPUT_PARAM,kAlreadyLoginError:pe.ALREADY_LOGIN}},Xc="/cloud_setting/cache",$c=Rn,dl="/cloud_setting/refresh",eu=Rn,Ca=Rn,Cs="/cloud_setting/request",Oo=Rn,wa=Rn,Qs={event:"/liveroom/get_current_user_list",user_index:en,is_time_ascend:Zt,use_na:en},Mr="/zegoconn/connect",hl=nn,pl=en,tu="/zegoconn/create_socket",nu="/zegoconn/disconnect",fl=nn,cs=nn,ru=en,iu="/zegoconn/auto_dispatch",ou=Yt,su=Yt,au=Yt,hc=Yt,Ia="/zegoconn/request",cu=Rn,No="/sdk_config/init",ml=Rn,uu=en,vl={event:"/zegoconn/proxy_connect",service_no:en,proxy_link_sources:en,recv_time:en,connect_stream:en},gl={event:"/zegoconn/proxy_broken",service_no:en},Js={event:"/zegoconn/proxy_disconnect",service_no:en},pc=[50116,50118,50119,50120,50121,50122,50124,50125,50126,50127,50128],Ks=function(){function o(){this.RETRY_MAX_TIME=300,this.RETRY_START_TIME_INTERVAL=4,this.RETRY_CONTINUE_COUNT=2,this.RETRY_MAX_TIME_INTERVAL=32,this.retryStartTime=0,this.retryActiveCount=1,this.isOverTime=!1}return o.prototype.init=function(e,t,n,r){this.invalid(),this.stopMaxTime(),this.isOverTime=!1,(0,R.Cs)(e)&&e<3600&&(this.RETRY_MAX_TIME=e),(0,R.Cs)(t)&&(this.RETRY_START_TIME_INTERVAL=t),(0,R.Cs)(n)&&(this.RETRY_CONTINUE_COUNT=n),(0,R.Cs)(r)&&(this.RETRY_MAX_TIME_INTERVAL=r)},o.prototype.invalid=function(){this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.startRetryTimer&&clearTimeout(this.startRetryTimer),this.startRetryTimer=null,this.retryStartTime=0,this.retryActiveCount=1},o.prototype.isRetrying=function(){return this.retryTimer!==null||this.startRetryTimer!==null||this.maxTimer!==null},o}(),Et=pt(8627),lu=(zn=function(o,e){return zn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},zn(o,e)},function(o,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function t(){this.constructor=o}zn(o,e),o.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}),du=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))},Ra=function(o){function e(t,n,r){var i=o.call(this)||this;return i.an=t,i.pn=n,i.Ar=r,i.zr=0,i.Dr=0,i.Pr=3,i.Mr="",i.lastError=0,i.loginCompleted=!1,i.loginRoomCallback={},i}return lu(e,o),Object.defineProperty(e.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),e.prototype.renewLocalToken=function(t,n){this.token=t,this.Ar.token=this.token;var r=new Date().getTime(),i=parseInt(t.substring(0,2)),s=void 0;if(n&&(0,R.Cs)(n))s=1e3*n;else if((0,R.QP)(t)&&i>=3){var c=1e3*sr(t.substring(2));this.an.info("zm.rm.rlt time "+c+" "+r+" "+this.pn.local_time_deviation),s=c-(r-this.pn.local_time_deviation)}s&&this.roomHandler.resetTokenTimer(s),this.an.setTokenInfo(t),this.pn.actionListener("_tokenRenewed",t,this.Ar.roomID)},e.prototype.initRoom=function(t,n,r,i,s){this.roomHandler=t,this.roomID=n,this.renewLocalToken(r),this.user=i,this.config=s},e.prototype.active=function(t,n){var r,i,s,c=this;t===void 0&&(t=!1),this.an.info(Lt+" retry call "+((r=this.Ar)===null||r===void 0?void 0:r.roomID)+" "+t);var u=!((i=this.loginRoomCallback)===null||i===void 0)&&i.success?Gi:Yc;if(this.jr||(this.jr=this.cr.createSpan(E.t0.H,{key:ur.event,par:this.roomID},{key:u,par:this.roomID},u,!0),this.Mr=u),this.roomHandler.setRunState(Te.UV.trylogin),this.Ar.isMulti&&((s=this.pn.roomModulesList.find(function(m){return!m.isMulti}))===null||s===void 0?void 0:s.runState)!==Te.UV.login)this.an.info(Lt+" service is disconnected, multi room stop retry");else if(this.retryTimer)this.an.info(Lt+" has actived, ignore");else{var l=this.pn.networkState==Te.D2.offline;if(l){if(this.an.info(Lt+" check if really offline. "+this.Dr),this.Dr>=this.Pr)return void this.an.warn(Lt+" network is broken, stop retry")}else this.Dr=0;if(this.isOverTime)this.an.info(Lt+" retry over time, stop retry");else{var a=function(){c.an.info(Lt+" interval "+c.retryActiveInterval),c.retryTimer=setTimeout(function(){c.roomHandler.login(c.roomID,c.token,c.user,c.config,function(m){c.pn.networkState=Te.D2.online,c.handleLoginFinish(m)},function(m,S){c.handleLoginFinish(!1,m,S)},n),c.retryTimer&&clearTimeout(c.retryTimer),c.retryTimer=null,l?c.Dr++:c.retryActiveCount++},t?0:1e3*c.retryActiveInterval)};if(this.retryActiveCount==1)(0,te.UY)().then(function(m){c.retryActiveInterval=Math.floor(m*(1-c.RETRY_START_TIME_INTERVAL)+c.RETRY_START_TIME_INTERVAL),a()}).catch(function(m){c.retryActiveInterval=.5*c.RETRY_START_TIME_INTERVAL,a()});else{var h=Math.pow(2,Math.round(this.retryActiveCount/this.RETRY_CONTINUE_COUNT+1));this.retryActiveInterval=h>this.RETRY_MAX_TIME_INTERVAL?this.RETRY_MAX_TIME_INTERVAL:h,a()}}}},e.prototype.startMaxTime=function(){var t=this;this.maxTimer||(this.an.info(Lt+" start max timer"),this.zr===0&&(this.zr=new Date().getTime()),this.maxTimer=setTimeout(function(){var n;t.an.info(Lt+" over max time ".concat(t.RETRY_MAX_TIME,"s, stop retry")),t.isOverTime=!0,t.roomHandler.resetRoom(),t.zr!==0&&(n=(n=new Date().getTime()-t.zr)>0?n:void 0),t.qr(!1,pe.LOGIN_TIMEOUT),t.jr&&(t.cr.spanEnd({key:t.Mr,par:t.roomID},{error:pe.LOGIN_TIMEOUT.code,message:pe.LOGIN_TIMEOUT.msg,try_time:n}),t.jr=null),t.loginRoomCallback.fail&&(t.loginRoomCallback.fail(pe.LOGIN_TIMEOUT),t.roomHandler.disconnectedHandle(pe.LOGIN_TIMEOUT),t.resetCallBack())},1e3*this.RETRY_MAX_TIME))},e.prototype.stopMaxTime=function(){this.an.info(Lt+" stop max timer"),this.zr!==0&&(this.zr=0),this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},e.prototype.onactive=function(t,n){},e.prototype.retryLoginRoom=function(t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1),!this.maxTimer&&this.startMaxTime(),n&&this.Ar.resetSessionInfo(),this.active(t,r)},e.prototype.handleError=function(t,n){if(this.RETRY_MAX_TIME<3)return!1;var r=t.code;if(n){var i=[200207,200208];if(r>=40001&&r<=40100||r>=50200&&r<=50299||[201002,30019].includes(r))return this.Ar.resetSessionInfo(),!0;var s=du(du([202002,205030,205035],pc,!0),[50013],!1);return r===10015?(this.Ar.retryConnect(),!0):!(s!=null&&s.includes(r))&&(!!i.includes(r)||this.Ar.lastRunState==Te.UV.login&&(this.an.warn("zm.rrh.he reset"),this.Ar.resetUserSession(),this.invalid(),!0))}return!0},e.prototype.setLoginRoomCallback=function(t,n){this.loginRoomCallback.success=t,this.loginRoomCallback.fail=n},e.prototype.loginFail=function(t){this.roomHandler.resetRoom(),this.qr(!1,t),this.loginRoomCallback.fail&&(this.loginRoomCallback.fail(t),this.roomHandler.disconnectedHandle(t),this.resetCallBack())},e.prototype.handleLoginFinish=function(t,n,r){var i;if(this.an.info(ui+" "+t+" "+JSON.stringify(n)),n){if(this.jr){var s=void 0;this.zr!==0&&(s=(s=new Date().getTime()-this.zr)>0?s:void 0),this.cr.spanEnd({key:this.Mr,par:this.roomID},{error:n.code,message:n.msg,try_time:s}),this.jr=null}if(this.handleError(n,r))this.an.info(ui+" retry"),[40001].includes(n.code)?(this.pn.roomModulesList.forEach(function(l){l.userHandler.updateUserDelete(l.roomID)}),this.retryLoginRoom(!1,!1,pe.NETWORK_RECOVERY)):this.retryLoginRoom();else{this.an.info(ui+" reset"),this.roomHandler.resetRoom(),this.qr(t,n);var c=this.Lr(n.code);if(this.loginRoomCallback.fail){this.loginRoomCallback.fail(n);var u="";r&&n.code===Et.E9Y.code&&(u=JSON.stringify({server_code:c})),this.roomHandler.disconnectedHandle(n,{extendedData:u}),this.resetCallBack()}}}else s=void 0,this.zr!==0&&(s=(s=new Date().getTime()-this.zr)>0?s:void 0),this.qr(t,{code:0,msg:""}),this.jr&&(this.cr.spanEnd({key:this.Mr,par:this.roomID},{room_id:this.roomID,room_sid_string:(i=this.Ar)===null||i===void 0?void 0:i.roomSidString,try_time:s}),this.jr=null),this.loginRoomCallback.success&&(this.loginRoomCallback.success(t),this.resetCallBack())},e.prototype.invalid=function(){this.an.info("zm.rh.ivd end retry"),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.retryActiveCount=1,this.Dr=0},e.prototype.qr=function(t,n){this.stopMaxTime(),this.invalid(),this.onactive(t,n)},e.prototype.Lr=function(t){return E.Kk+t},e.prototype.resetCallBack=function(){this.loginRoomCallback.success=void 0,this.loginRoomCallback.fail=void 0,this.loginCompleted=!0},e.prototype.resetError=function(){this.lastError=0},e}(Ks);(function(o){o.NOT_EMPTY="NOT_EMPTY",o.ILLEGAL_CHARACTERS="ILLEGAL_CHARACTERS",o.TYPE_STRING="TYPE_STRING",o.TYPE_INTEGER="TYPE_INTEGER",o.TYPE_OBJECT="TYPE_OBJECT",o.MAX_LENGTH_10="MAX_LENGTH_10",o.MAX_LENGTH_64="MAX_LENGTH_64",o.MAX_LENGTH_100="MAX_LENGTH_100",o.MAX_LENGTH_128="MAX_LENGTH_128",o.MAX_LENGTH_256="MAX_LENGTH_256",o.MAX_LENGTH_1024="MAX_LENGTH_1024"})(bn||(bn={}));var Vi={error:{code:0,msg:"suc"}},rr={NOT_EMPTY:function(o,e,t,n,r){return e===void 0||e===""||e===null?(n.error("".concat(t," ").concat(o," is empty")),r):Vi},ILLEGAL_CHARACTERS:function(o,e,t,n,r){return(0,te.jy)(e)?Vi:(n.error("".concat(t," ").concat(o," contains illegal characters")),r)},TYPE_STRING:function(o,e,t,n,r){return(0,R.QP)(e)?Vi:(n.error("".concat(t," ").concat(o," must be string")),r)},TYPE_INTEGER:function(o,e,t,n,r){return(0,te.zQ)(e,!1)?Vi:(n.error("".concat(t," ").concat(o,"  must be integer number")),r)},TYPE_OBJECT:function(o,e,t,n,r){return e&&(0,R.w)(e)?Vi:(n.error("".concat(t," ").concat(o,"  must be object")),r)},MAX_LENGTH_10:function(o,e,t,n,r){return e.length>10?(n.error("".concat(t," ").concat(o," is too long")),r):Vi},MAX_LENGTH_64:function(o,e,t,n,r){return e.length>64?(n.error("".concat(t," ").concat(o," is too long")),r):Vi},MAX_LENGTH_100:function(o,e,t,n,r){return e.length>100?(n.error("".concat(t," ").concat(o," is too long")),r):Vi},MAX_LENGTH_128:function(o,e,t,n,r){return e.length>128?(n.error("".concat(t," ").concat(o," is too long")),r):Vi},MAX_LENGTH_256:function(o,e,t,n,r){return e.length>256?(n.error("".concat(t," ").concat(o," is too long")),r):Vi},MAX_LENGTH_1024:function(o,e,t,n,r){return e.length>1024?(n.error("".concat(t," ").concat(o," is too long")),r):Vi}};function ka(o,e){var t=[],n={};for(var r in o)n[o[r].order]=o[r],o[r].key=r;for(var i in n)t.push(n[i]);for(var s=0;s<t.length;s++)for(var c=t[s].rules,u=0;u<c.length;u++){var l={key:t[s].key,value:t[s].value,action:e.action,logger:e.logger},a=l.value,h=c[u].name?""+c[u].name:"";if((a===void 0&&h===bn.NOT_EMPTY||a!==void 0)&&rr[h]){var m=rr[h](l.key,a,l.action,l.logger,c[u]);if(m!=Vi)return m}}return Vi}var us=pt(5733),yl=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Ys=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},fc=function(){function o(e,t){this.an=e,this._dataReport=t,this.id="",this._debug=!1,this.appConfigEtag=-1,this.appConfigFetched=!1,this.customSetLogURL=!1,this.requestList={},this.mode=Jn.Mode.MODE_ONLINE,this.connectState="connected",this.testNetPackageSize=!1,this.netGeoFencing={},this.agentIpStackDetection={IPv4:H.unknown,IPv6:H.unknown},this.isFlutter=!1,this.agentConnectIPStackType=Y.IPv4,this.advanceConfig={},this.svrDomains={},this.userListenerList=["roomUserUpdate","roomOnlineUserCountUpdate","IMRecvCustomCommand","IMRecvBroadcastMessage","roomExtraInfoUpdate","IMRecvBarrageMessage","roomStateUpdate","tokenWillExpire","roomStateChanged","recvRoomTransparentMessage"],this._testEnvironment=!1,this._env=0,this.type="PUBLIC",this.debugCustom=!1,this.configOK=!1,this.role=2,this.relateService=[],this.maxMemberCount=0,this.roomCreateFlag=1,this.local_time_deviation=0,this.callbackList={},this.listenerList={roomUserUpdate:[],roomOnlineUserCountUpdate:[],getAnchorInfo:[],_getAnchorInfo:[],IMRecvCustomCommand:[],IMRecvBroadcastMessage:[],recvReliableMessage:[],roomExtraInfoUpdate:[],IMRecvBarrageMessage:[],recvJoinLiveRequest:[],recvInviteJoinLiveRequest:[],recvEndJoinLiveCommand:[],roomLoginResponse:[],_roomLogin:[],_appConfigRsp:[],_netAppConfigRsp:[],_connectChanged:[],HBResponse:[],roomStateUpdate:[],_roomStateUpdate:[],_getTotalUserList:[],_userStateUpdate:[],_recvBigRoomMessage:[],_recvRoomMsg:[],_kickout:[],tokenWillExpire:[],_stopStream:[],roomStateChanged:[],_userTransUpdate:[],_uaHeartBeatTimeout:[],roomTokenWillExpire:[],_tokenRenewed:[],_protobufResponse:[],_cloudSettingNotify:[],_settingCanFetch:[],_beforeSwitchRoom:[],_afterSwitchRoom:[],_experimentalAPICallback:[],recvRoomTransparentMessage:[]},this.reportList={},this.reportSeqList={login:0,relogin:0},this.networkState=Te.D2.online,this.roomRetryTime=300,this.roomModulesList=[],this.isMultiRoom=!1,this.setMultiRoom=!1,this.protoFormat="json",this.settingFetched=!1,this.configRoomAuth=!1,this.configCheckToken=!1,this.Br=!1,this._sdkVersion="unknown",this.Ur=void 0,this.mode=Yn.modeNo}return Object.defineProperty(o.prototype,"selectIPStackMode",{get:function(){var e;return this.settingConfig.getSettingWithUserParams("ip_stack_mode",(e=p.engineOptions)===null||e===void 0?void 0:e.ipStackMode)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"debug",{get:function(){return this._debug},set:function(e){this._debug=e,us.LoggerStateCenter.getInstance().debug=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"testEnvironment",{get:function(){return this._testEnvironment},set:function(e){this._testEnvironment=e,us.LoggerStateCenter.getInstance().testEnvironment=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"ENV",{get:function(){return this._env},set:function(e){this._env=e,us.LoggerStateCenter.getInstance().ENV=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"roomid",{get:function(){return this.roomModulesList[0]?this.roomModulesList[0].roomID:""},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"serverTimeOffset",{get:function(){return this.roomModulesList[0]?this.roomModulesList[0].messageHandler.Gr:0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"enableWSLog",{get:function(){var e,t;return((t=(e=this.appConfig)===null||e===void 0?void 0:e.log_config)===null||t===void 0?void 0:t.ws_log)===1||this.Br},enumerable:!1,configurable:!0}),o.prototype.getRequestId=function(){return this.idName+"-"+(0,E.Mo)()},o.prototype.actionListener=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=["roomStateChanged","roomExtraInfoUpdate","tokenWillExpire"].includes(e);if(i&&this.listenerList[e]){var s=this.reporter.createSpan(E.t0.H,{key:qn},{key:""},ll);s.setAttributes({listener:e,listener_params:JSON.stringify(n)}),s.end()}i&&this.an.info("zm.al ".concat(e," ").concat(JSON.stringify(n),". pageID: ").concat(p.pageID," , instID: ").concat(this.id)),this.listenerList[e]&&this.listenerList[e].forEach(function(c){if(t.userListenerList.includes(e))setTimeout(function(){try{c.apply(void 0,n)}catch(u){throw t.an.error(Sr+" "+e+" "+JSON.stringify(u)),u}},0);else try{c.apply(void 0,n)}catch(u){throw t.an.error(Sr+" "+e+" "+JSON.stringify(u)),u}})},o.prototype.onListener=function(e,t){return this.listenerList[e]?(0,R.JO)(t)?(this.listenerList[e].indexOf(t)==-1&&this.listenerList[e].push(t),!0):(this.an.error(Dn+" listener callBack must be funciton"),!1):(this.an.error(Dn+" event "+e+" no found"),!1)},o.prototype.offListener=function(e,t){return this.listenerList[e]?(0,R.JO)(t)?(this.listenerList[e].indexOf(t)!==-1&&(this.listenerList[e]=this.listenerList[e].filter(function(n){return n!==t})),!0):(this.an.error(li+" listener callBack must be funciton"),!1):(this.an.error(li+" event "+e+" no found"),!1)},Object.defineProperty(o.prototype,"sdKVersion",{get:function(){return this._sdkVersion},set:function(e){this._sdkVersion=e},enumerable:!1,configurable:!0}),o.prototype.getLogWhiteList=function(e,t){var n,r;return e===void 0&&(e=!1),t===void 0&&(t=5),yl(this,void 0,void 0,function(){var i,s,c,u,l,a,h,m,S,x,q,V=this;return Ys(this,function(_e){switch(_e.label){case 0:i=""+t,s=(0,te.fU)(this.reporter,E.t0.H,"","/log/whitelist",Cn.event),(0,R.Cs)(c=this.Ur)&&((0,te.P1)(c),this.Ur=void 0),u=((r=(n=this.appConfig)===null||n===void 0?void 0:n.log_config)===null||r===void 0?void 0:r.ws_log)===1,t===5&&(this.an.enableWebSocketLog(u||!this.logDomain),i+=" ; ws_log: ".concat(u)),_e.label=1;case 1:return _e.trys.push([1,3,,4]),t--,[4,this.an.getWhiteList()];case 2:return l=_e.sent(),i+=" ".concat((0,te.iq)(l)),a=!1,h=!1,m=void 0,l.code===0&&1&(S=l.data).type&&(1&S.upload_log_type&&(m=S,a=!0,e?this.an.uploadStorageLog().catch(function(ke){V.an.warn("".concat(Zn," all zip log upload error: ")+JSON.stringify(ke)+ke)}):this.an.makeZipLogSpaceUpload().catch(function(ke){V.an.warn("".concat(Zn," history zip log upload error: ")+JSON.stringify(ke)+ke)})),this.Br=h=!!(64&S.upload_log_type),this.an.enableWebSocketLog(this.enableWSLog||!this.logDomain)),(0,te.lA)(s,{need_retry:!1,need_report:a,need_ws:h,log_type:m==null?void 0:m.upload_log_type,log_start_time:m==null?void 0:m.start_time,log_end_time:m==null?void 0:m.end_time}),[3,4];case 3:return x=_e.sent(),i+=" ".concat(x),q=!1,t>0&&(q=!0,this.Ur=(0,te.v5)(function(){V.getLogWhiteList(e,t--)},3e3)),s.setAttributes({need_retry:q}),this.reporter.setError(s,{code:-1,message:""+x}),[3,4];case 4:return this.an.info("".concat(Zn," ").concat(i)),[2]}})})},o}(),mc=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},bl=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},vc=function(){function o(e,t,n,r,i){this.an=e,this.pn=t,this._dataReport=n,this.Jr=r,this.Ar=i,this.Hr=null,this.Vr=Te.zD,this.Qr=null,this.Yr=0,this.Kr=!1,this.Zr=0,this.Xr=0,this.Wr=36e5}return Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),o.prototype.$r=function(){var e=this;this.rs(),this.Qr=setTimeout(function(){e.an.warn("zm.hb.to call. "+e.Vr),e.hbLogout(pe.HEARTBEAT_TIMEOUT),e.cr.createSpan(E.t0.H,{key:ur.event,par:e.Ar.roomID},{key:""},rl).end()},this.Vr)},o.prototype.rs=function(){this.Qr&&clearTimeout(this.Qr)},o.prototype.init=function(e){var t,n,r,i,s=this;this.Kr=!1,this.Xr=0,this.Zr=0,i=(0,R.kb)((t=e.body)===null||t===void 0?void 0:t.hearbeat_interval)?e.body.hearbeat_interval<Te.XV?Te.XV:e.body.hearbeat_interval:Te.Xs,this.Vr=(0,R.kb)((n=e.body)===null||n===void 0?void 0:n.hearbeat_timeout)?(r=e.body)===null||r===void 0?void 0:r.hearbeat_timeout:Te.zD;var c=Math.floor(Math.random()*i);this.rs(),this.Hr&&clearTimeout(this.Hr),this.Hr=setTimeout(function(){s.start(i)},c),this.Yr++},o.prototype.start=function(e){return mc(this,void 0,void 0,function(){var t,n,r,i,s=this;return bl(this,function(c){switch(c.label){case 0:return this.an.info(Bn+" call"),t=this.cr.createSpan(E.t0.H,{key:ur.event,par:this.Ar.roomID},{key:""},lo.event),this.Ar.isLogin()?(n=function(u,l){var a,h,m,S,x=!0;if(u.header&&u.body){if((u.body&&u.body.err_code)!==0){var q=Ze(u.body.err_code||u.body.code,u.body.err_message||u.body.message);t.setAttributes({error:q.code,message:q.message+u.body.err_code}),x=!1}}else t.setAttributes({error:u.code>0?u.code:pe.ROOM_INNER_ERROR.code,message:u.msg?u.msg:pe.ROOM_INNER_ERROR}),x=!1;s.ss(u,l),((a=u==null?void 0:u.body)===null||a===void 0?void 0:a.err_code)===0&&t.setAttributes({interval:lo.interval((h=u==null?void 0:u.body)===null||h===void 0?void 0:h.hearbeat_interval),stream_seq:lo.stream_seq((m=u==null?void 0:u.body)===null||m===void 0?void 0:m.stream_seq),server_user_seq:lo.server_user_seq((S=u==null?void 0:u.body)===null||S===void 0?void 0:S.server_user_seq)});var V=!1;x?V=!s.Xr||performance.now()-s.Xr>=s.Wr:V=!0,V&&(s.Xr=performance.now(),t.end())},this.Jr.heartBeat(n,n,this.Ar,this.Vr),this.us=e,r=this.us,this.Yr>=2?[4,(0,te.UY)()]:[3,2]):(this.an.error(Bn+" state error"),this.Xr=performance.now(),this.cr.setError(t,lo.error.NOT_LOGIN),[2]);case 1:return i=c.sent(),r=Math.round(i*(this.us+1)),this.Yr=1,[3,3];case 2:r=this.us,c.label=3;case 3:return this.Qr||this.$r(),this.Hr=setTimeout(function(){s.start(s.us)},r),this.an.info(Bn+" call success"),[2]}})})},o.prototype.ss=function(e,t){var n,r;if(e.body&&e.body.err_code&&e.body.err_code!==0)return this.an.error(Jr+" disconnect, server error="+e.body.err_code),e.body.err_code==40001?void 0:e.body.err_code==Te.OQ.ROOM_SESSION_ID_ERR?void this.hbLogout(pe.HEARTBEAT_TIMEOUT):void this.hbLogout(fe(e.body.err_code));if(!e.header||!e.body)return this.an.error(Jr+" disconnect, error="+JSON.stringify(e)+", seq = "+t),void this.hbLogout(e);(0,R.kb)((n=e.body)===null||n===void 0?void 0:n.hearbeat_interval)&&(this.us=e.body.hearbeat_interval,this.us<Te.XV&&(this.us=Te.XV)),(0,R.kb)((r=e.body)===null||r===void 0?void 0:r.hearbeat_timeout)&&(this.Vr=e.body.hearbeat_timeout),this.Zr=new Date().getTime(),this.Kr?this.an.info(Jr+" has reset"):this.$r(),this.heartbeatRspNotiFy(e,this.Ar.roomID),this.an.info(Jr+" call success "+t)},o.prototype.heartbeatRspNotiFy=function(e,t){},o.prototype.hbLogout=function(e){},o.prototype.resetHeartbeat=function(){clearTimeout(this.Hr),this.Hr=null,this.Kr=!0,this.rs(),this.Yr=0,this.Xr=0,this.Zr=0,this.an.info("zm.hb.rst call success")},o}(),Zs={code:1102026,msg:"cancel login"},ar=function(o){return function(e){var t=unescape||window.unescape;return Uint8Array.from(Array.from(t(encodeURIComponent(e))).map(function(n){return n.charCodeAt(0)}))}(o=o??"")},Lo=function(o){return function(e){var t=escape||window.escape;return decodeURIComponent(t(String.fromCharCode.apply(String,Array.from(e))))}(o)};function Pa(o){if(typeof TextEncoder<"u")return new TextEncoder().encode(o).length;for(var e=0,t=0;t<o.length;t++){var n=o.charCodeAt(t);e+=n<=127?1:n<=2047?2:n<=65535?3:4}return e}var ws="DISCONNECTED",Pr="CONNECTED",Is="CONNECTING",di=pt(7202),hu=function(){function o(e,t,n,r,i){this.an=e,this.pn=t,this._dataReport=n,this.Ar=r,this.Jr=i,this.cs=null,this.hs=1e4,this.fs=null,this.ls=0,this.ds=0,this.validTime=0,this.totalTime=0,this.brokenCounts=0,this.vs=0,this.ps=0,this.gs=!1,this.loginCallback={}}return Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"_s",{get:function(){return this.Ar.roomID},enumerable:!1,configurable:!0}),o.prototype.resetTokenTimer=function(e){var t=this;this.an.info("zm.rm.rst  call: "+(e=(e=(e-=3e4)<0?0:e)>2147483647?2147483647:e)),this.fs&&clearTimeout(this.fs),this.fs=setTimeout(function(){t.pn.actionListener("tokenWillExpire",t._s),t.pn.actionListener("roomTokenWillExpire",t._s)},e)},o.prototype.ys=function(){this.fs&&clearTimeout(this.fs),this.fs=null},o.prototype.setRunState=function(e){this.Ar.runState!==e&&(this.Ar.lastRunState=this.Ar.runState,this.Ar.runState=e)},o.prototype.ws=function(){this.cs&&clearTimeout(this.cs),this.cs=null},o.prototype.Ss=function(e){var t,n,r,i,s,c,u,l,a=this.cr.createSpan(E.t0.H,{key:ji.event,par:this._s},{key:""},this.pn.isMultiRoom?il:Ta);e&&this.Jr.zPushSid==="0"&&(this.Jr.zPushSid=(n=(t=this.Jr)===null||t===void 0?void 0:t.switchSessionID)===null||n===void 0?void 0:n.toString()),this.updateTimes();var h=e?(r=this.Jr)===null||r===void 0?void 0:r.zPushSid:(s=(i=this.Jr)===null||i===void 0?void 0:i.switchSessionID)===null||s===void 0?void 0:s.toString();a.setAttributes({room_id:ji.room_id((c=this.Ar)===null||c===void 0?void 0:c.roomID),room_sid_string:ji.room_sid_string((u=this.Ar)===null||u===void 0?void 0:u.roomSidString),liveroom_sid_string:ol((l=this.Ar)===null||l===void 0?void 0:l.userSidString),sdk_zpush_sessionid_string:sl(h),valid_d:this.validTime,total_d:this.totalTime,tempbroken_cnt:this.brokenCounts}),a.end()},o.prototype.resetRoom=function(e){var t,n=this;if(this.an.info(xn+" call"),this.pn.roomModulesList.length>1&&!e&&(this.Ar.isMulti=!0),this.ws(),this.Ar.sessionExist&&this.Ar.runState!==Te.UV.logout&&!this.Ar.isDisConnect()){var r=function(s){n.ks(s,!n.Ar.isMulti)};this.Jr.logout(this.Ar,r,r)}this.Ss(e),this.setRunState(Te.UV.logout),this.Ar.resetRoomSession(),this.Ar.resetUserSession(),this.Ar.isMulti||(this.pn.userid="",this.an.setSessionInfo(this.pn.appid,this._s,this.Ar.userSidString,this.pn.idName,this.pn.nickName,this.pn.sdKVersion),(t=this.Jr)===null||t===void 0||t.reset()),this.resetRoomCallBack(),this.pn.roomModulesList=this.pn.roomModulesList.filter(function(s){return s!==n.Ar});var i=this.pn.roomModulesList[0];i&&(i.isMulti=!1,i.runState!==Te.UV.login&&i&&i.retryRoom()),this.pn.isMultiRoom&&this.pn.roomModulesList.length===0&&(this.cr.createSpan(E.t0.H,{key:ji.event,par:this._s},{key:""},al).end(),this.Jr.zPushSid="0"),this.an.info(xn+" call success")},o.prototype.resetRoomCallBack=function(){},o.prototype.loginSuccessCallBack=function(e,t){},o.prototype.handlePushKickout=function(e,t,n){var r,i,s,c,u,l=this;this.an.info(An+"  call "+JSON.stringify(e));var a=function(x){var q={code:x,message:"kickout reason = "+x},V={code:63000005,message:"zpush token expired",name:Z};switch(x){case 1:return{code:63000001,message:"zpush multiple login kickout",name:"MULTIPLE_LOGIN_KICKOUT"};case 2:return{code:63000002,message:"zpush manual kickout",name:"MANUAL_KICKOUT"};case 4:return V;default:q.code=x,q.message="kickout reason = "+x}return q}(e.body.reason||((r=e.body)===null||r===void 0?void 0:r.kickout_reason)),h=this.cr.createSpan(E.t0.H,{key:ur.event,par:this._s},{key:""},Zc);this.updateTimes(),h.setAttributes({error:(i=pe[a.name||"ROOM_INNER_ERROR"])===null||i===void 0?void 0:i.code,message:a.message,kickout_reason:cl(((s=e.body)===null||s===void 0?void 0:s.reason)||((c=e.body)===null||c===void 0?void 0:c.kickout_reason)),need_relogin:Ea((u=e==null?void 0:e.body)===null||u===void 0?void 0:u.need_relogin),valid_d:this.validTime,total_d:this.totalTime,tempbroken_cnt:this.brokenCounts}),h.end();var m=this.Ar.roomTryHandler;if(m)if(m.onactive=function(x,q){l.an.info(An+" onactive"),l.disconnectedHandle(q),l.pn.actionListener("_kickout",q)},e.body.need_relogin&&e.body.need_relogin==1)this.Ar.retryRoom(!1,!0);else{this.setRunState(Te.UV.logout),this.resetRoom(t);var S={};e&&e.body.custom_reason?S.custom_kickout_message=e.body.custom_reason:a.name&&pe[a.name]&&(S.custom_kickout_message=pe[a.name].msg+"; kickout reason: "+(e.body.reason||e.body.kickout_reason)),this.disconnectedHandle(a.name&&pe[a.name]?pe[a.name]:pe.ROOM_INNER_ERROR,{extendedData:JSON.stringify(S),isKickout:!0}),this.pn.actionListener("_kickout",{code:pe.MANUAL_KICKOUT.code,msg:pe.MANUAL_KICKOUT.msg+e.body.reason||e.body.kickout_reason})}else this.an.info(An+" try handler no found")},o.prototype.handleHbLogout=function(e){var t,n=this,r=this.Ar.roomTryHandler;r&&(r.onactive=function(i,s){n.an.warn(Kn+" onactive"),n.transError(s),n.disconnectedHandle(s)},[pe.HEARTBEAT_TIMEOUT.code].includes(e==null?void 0:e.code)||[105,152,2001].includes(e==null?void 0:e.code)||e.msg.endsWith("1000002001")||e.msg.endsWith("1000000152")||e.msg.endsWith("1000000105")?[pe.HEARTBEAT_TIMEOUT.code].includes(e.code)?(this.pn.roomModulesList.forEach(function(i){i.roomTryHandler&&(i.roomTryHandler.lastError=pe.NETWORK_RECOVERY.code)}),this.Ar.retryRoom(!1,!1,pe.NETWORK_RECOVERY)):((t=this.Ar.roomTryHandler)===null||t===void 0?void 0:t.lastError)===pe.NETWORK_RECOVERY.code?this.Ar.retryRoom(!1,!1,pe.NETWORK_RECOVERY):this.Ar.retryRoom():[pe.TIMEOUT.code,pe.SOCKET_CLOSE.code].includes(e==null?void 0:e.code)?this.an.warn(Kn+" timeout "+(0,te.iq)(e)):(this.an.warn(Kn+" unexpected error: ".concat(JSON.stringify(e))),this.logoutByError(e)))},o.prototype.logoutByError=function(e){var t=this.Ar.roomTryHandler;t&&(t.stopMaxTime(),t.invalid(),this.resetRoom(),this.disconnectedHandle(e))},o.prototype.onConnecting=function(e){this._roomStateHandle(Is,ue.Logining,e)},o.prototype.disconnectedHandle=function(e,t){if(e&&e.code!==0){this.ys();var n=t!=null&&t.isKickout?ue.Kickout:ue.ReconnectFailed;this.transError(e),this._roomStateHandle(ws,n,e,(t==null?void 0:t.extendedData)||e.msg)}else this._roomStateHandle(Pr,ue.Reconnected,e,t==null?void 0:t.extendedData)},o.prototype.updateTimes=function(){this.updateValidTime(),this.updateTotalTime()},o.prototype.updateValidTime=function(){this.vs&&(this.validTime=this.validTime+Date.now()-this.vs,this.vs=0)},o.prototype.updateTotalTime=function(){this.ps&&(this.totalTime=Date.now()-this.ps)},o.prototype._roomStateHandle=function(e,t,n,r,i){var s,c,u,l,a=this,h=this.Ar.roomID,m=Date.now();if(t&&t==ue.Reconnecting){if(this.ds++,this.ls===0&&(this.ls=new Date().getTime(),this.roomSpan(Es,h,t,{error:n,extendedData:r||""})),this.ds===1)return clearTimeout(this.Os),void(this.Os=setTimeout(function(){a.ds===1&&a._roomStateHandle(e,t,n,r,i)},8e3));clearTimeout(this.Os)}this.an.info("zm.rm.scb "+e+" "+JSON.stringify(n)),[Pr,ws].includes(e)&&(this.ds=0,clearTimeout(this.Os),this.gs&&this.brokenCounts++),e!==Pr&&this.updateTimes(),t&&[ue.LoginFailed,ue.ReconnectFailed].includes(t)&&(t=!((s=this.Ar.roomTryHandler)===null||s===void 0)&&s.loginCompleted?ue.ReconnectFailed:ue.LoginFailed),t&&[ue.Logined,ue.Reconnected].includes(t)&&(!((c=this.Ar.roomTryHandler)===null||c===void 0)&&c.loginCompleted?t=ue.Reconnected:(t=ue.Logined,this.ps=this.ps||m),this.gs=!1,this.vs=m),t&&[ue.Logining,ue.Reconnecting].includes(t)&&(t=!((u=this.Ar.roomTryHandler)===null||u===void 0)&&u.loginCompleted?ue.Reconnecting:ue.Logining,this.ps&&(this.gs=!0));var S=0;switch(t){case ue.Reconnecting:break;case ue.ReconnectFailed:l=dc,this.ls!==0&&(this.ls=0);break;case ue.Reconnected:l=lc,this.ls!==0&&(S=new Date().getTime()-this.ls,this.ls=0)}if(this.Ar.lastRoomState=this.Ar.roomState,this.Ar.roomState=e,this.Ar.roomReasonState=t,this.Ar.roomState!==this.Ar.lastRoomState){this.pn.actionListener("_roomStateUpdate",h,e,n?n.code:0,r,t,i);var x=(n==null?void 0:n.code)||0;x==Zs.code&&(x=0),this.pn.actionListener("roomStateUpdate",h,e,x,r),this.pn.actionListener("roomStateChanged",h,t,x,r),l&&this.roomSpan(l,h,t,{error:n,extendedData:r||"",brokenTime:S})}e===ws&&(this.ps=0,this.totalTime=0,this.validTime=0,this.brokenCounts=0)},o.prototype.roomSpan=function(e,t,n,r){var i,s,c=this.cr.createSpan(E.t0.H,{key:ur.event,par:t},{key:""},e.event);c.setAttributes(n===ue.Reconnected?{room_broken_time:lc.room_broken_time((r==null?void 0:r.brokenTime)||0)}:{error:((i=r==null?void 0:r.error)===null||i===void 0?void 0:i.code)||0,message:(r==null?void 0:r.extendedData)||""}),e===Es&&c.setAttributes({last_hb_success_ts:(s=this.Ar.heartBeatHandler)===null||s===void 0?void 0:s.Zr}),e==dc&&c.setAttributes({valid_d:this.validTime,total_d:this.totalTime,tempbroken_cnt:this.brokenCounts}),c.end()},o.prototype.transError=function(e){if(this.an.info("zm.rm.te "+JSON.stringify(e)),e.code!==0&&(e.code<2e9&&e.code>1e9||e.code<1e6)){var t=st(e.code);t&&pe[t]&&(e.code=pe[t].code,e.msg=pe[t].msg)}},o.prototype.login=function(e,t,n,r,i,s,c){if(this.an.info(Lt+" call:"+e),this.an.remoteReport(Lt+" call:"+t),!this.Ar.isMulti&&this.an.setSessionInfo(this.pn.appid,e,"",n.userID,"",this.pn.sdKVersion),r){var u=r.userUpdate,l=r.maxMemberCount;u&&(0,R.dd)(u)&&(this.Ar.userStateUpdate=u),l&&(0,R.Cs)(l)&&(this.Ar.maxMemberCount=l)}if(!this.pn.configOK)return this.an.error(Lt+" init sdk wrong"),void s(pe.INIT);this.Ar.runState!==Te.UV.trylogin&&this.setRunState(Te.UV.trylogin),this.Ar.isCancelLogin=!1,this.Ar.roomID=e,this.Ar.token=t,this.Ar.thirdToken=t,this.pn.idName=n.userID,this.pn.nickName=n.userName||n.userID,this.loginCallback.success=i,this.loginCallback.fail=s,this.Is=this.Ar.isMulti?nl:uo,this.cr.createSpan(E.t0.H,{key:Gi,bak_key:Yc,par:this._s},{key:this.Is.event,par:this._s},this.Is.event,!0),this.ws(),this.onConnecting(c||{code:0,msg:""}),this.Rs(),this.an.info(Lt+" call success")},o.prototype.Rs=function(){var e,t,n,r,i=this;if(this.Ar.runState===Te.UV.trylogin)if(this.Ar.isMulti&&this.Ar.isDisConnect())this.an.warn(cn+" liveroom is not connected");else{var s=function(c,u){i.Ts(c,u)};!((e=this.Jr)===null||e===void 0)&&e.isUaConnect?(this.cr.spanSetAttributes({key:this.Is.event,par:(t=this.Ar)===null||t===void 0?void 0:t.roomID},{sdk_zpush_sessionid_string:(r=(n=this.Jr)===null||n===void 0?void 0:n.switchSessionID)===null||r===void 0?void 0:r.toString()}),this.Jr.login(this.Ar,s,s)):(this.cs=setTimeout(function(){i.an.info(cn+" over time no response, login timeout"),i.loginCallback.fail&&i.loginCallback.fail(ur.error.LOGIN_TIMEOUT)},this.hs),this.an.warn(cn+" ua is not connected")),this.an.info(cn+" call success")}else this.an.error("zb.rh.tl state error")},o.prototype.Ts=function(e,t){if(this.an.info(_n+" seq: "+t+" "+JSON.stringify(e)),this.Ar.runState===Te.UV.trylogin)if(e.header&&e.body){if(e.header.seq!==t&&this.Ar.isMulti==0)return void this.an.error(_n+" in wrong seq, local="+t+",recv="+e.header.seq);e.body.err_code!==0?(this.an.error(_n+" server error="+e.body.err_code),this.As(e)):(this.an.info(_n+" call success."),this.zs(e))}else this.an.error(_n+" "+JSON.stringify(e)),this.As(e);else this.Ar.isCancelLogin?(this.As(Zs),this.Ar.isCancelLogin=!1):this.an.error(_n+" state error")},o.prototype.As=function(e){this.ws();var t=ur.error.INNER_ERROR;e.header&&e.body?t=fe(e.body.err_code):e.code&&e.msg&&(t=e),this.cr.spanEnd({key:this.Is.event,par:this._s},{error:t.code,message:t.msg}),this.loginCallback.fail&&this.loginCallback.fail(t,!0)},o.prototype.zs=function(e){var t,n,r,i,s;this.Ar.checkRoomSession(e.body.room_session_id)&&(this.Ar.loginTime=Date.now());var c=this.Ar.lastRunState;this.setRunState(Te.UV.login),this.pn.userid=e.body.user_id,this.Ar.longRoomSid=e.body.room_session_id,this.Ar.longSid=e.body.session_id;var u=((t={})[this._s]={room_sid_string:this.Ar.roomSidString},t);this.cr.setPublicPros(u);var l=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.token_remain_time;this.pn.configRoomAuth=l>0;var a=parseInt(this.Ar.token.substring(0,2));if(e.body.ret_timestamp&&a>=3){var h=new Date().getTime(),m=h-e.body.ret_timestamp;this.pn.local_time_deviation=m<5e3?0:m;var S=l>0?1e3*l:1e3*sr(this.Ar.token.substring(2))-(h-this.pn.local_time_deviation);this.resetTokenTimer(S)}!this.Ar.isMulti&&this.an.setSessionInfo(this.pn.appid,this._s,this.Ar.userSidString,this.pn.idName,this.pn.nickName,this.pn.sdKVersion),this.cr.spanEnd({key:this.Is.event,par:this._s},{room_id:(r=this.Ar)===null||r===void 0?void 0:r.roomID,room_sid_string:(i=this.Ar)===null||i===void 0?void 0:i.roomSidString,zpush_sessionid_string:di.A.isLong(this.Jr.switchSessionID)?this.Jr.switchSessionID.toString():"0",liveroom_sid_string:(s=this.Ar)===null||s===void 0?void 0:s.userSidString}),this.ws(),this.loginSuccessCallBack(c,e),this._roomStateHandle(Pr,ue.Logined,{code:0,msg:""}),this.pn.getLogWhiteList(),this.loginCallback.success&&this.loginCallback.success(!0)},o.prototype.logout=function(e,t){this.an.info(vn+" call");var n={code:0,msg:""};this.Ar.runState!==Te.UV.logout?(this.Ar.runState===Te.UV.trylogin&&(this.Ar.isCancelLogin=!0,n=Zs),this.resetRoom(e),this._roomStateHandle(ws,ue.Logout,n,void 0,t),this.ys(),this.an.info(vn+" call success")):this.an.warn("zb.rh.lo at logout")},o.prototype.ks=function(e,t){var n;this.an.info(vn+" result="+(e.body&&e.body.err_code?e.body.err_code:"-1")),t&&((n=this.Jr)===null||n===void 0||n.closeRequest())},o}(),Aa=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))},pu=function(){function o(e,t,n,r,i){this.an=e,this.pn=t,this._dataReport=n,this.Jr=r,this.Ar=i,this.Ds=!1,this.Ns=[],this.Ps=0,this.Ms=0,this.xs=[],this.js=null,this.qs=3e4,this.Ls=5e3,this.Bs={anchor_id:"",anchor_id_name:"",anchor_nick_name:""}}return o.prototype.loginRsp=function(e,t){this.Bs=e.body.anchor_info||this.Bs,this.qs=e.body.userlist_interval||this.qs,this.Ls=e.body.userlist_merge_timeout||this.Ls,e.body.anchor_info&&(this.pn.actionListener("getAnchorInfo",e.body.anchor_info.anchor_id_name,e.body.anchor_info.anchor_nick_name),this.pn.actionListener("_getAnchorInfo",e.body.anchor_info.anchor_id_name,e.body.anchor_info.anchor_nick_name)),e.body.online_count&&this.pn.actionListener("roomOnlineUserCountUpdate",this.Ar.roomID,e.body.online_count),this.an.info("zm.us.lgr  userStateUpdate "+this.Ar.userStateUpdate),this.Ar.userStateUpdate&&this.Us(t)},o.prototype.patchUserList=function(e){var t=this;e.body.server_user_seq!==this.Ps&&this.Ar.userStateUpdate&&!this.js&&(this.an.info("zm.us.pt call update user "+this.Ps+" server "+e.body.server_user_seq),this.js||(this.js={}),this.Gs&&clearTimeout(this.Gs),this.Gs=setTimeout(function(){t.Js()},this.Ls)),this.Ms=e.body.server_user_seq,e.body.online_count!=null&&e.body.online_count!=0&&this.pn.actionListener("roomOnlineUserCountUpdate",this.Ar.roomID,e.body.online_count)},o.prototype.resetUserHandler=function(){this.Ds=!1,this.Fs=0,this.Ns=[],this.Ps=0,this.Ms=0,this.xs=void 0,this.js={},this.Gs=void 0,this.Hs=void 0,this.qs=3e4,this.Ls=5e3,this.Bs={anchor_id:"",anchor_id_name:"",anchor_nick_name:""}},o.prototype.Us=function(e){this.Ds?this.an.warn(Zr+" is already querying"):(this.Ds=!0,this.Ns=[],this.Vs(0,e||0),this.an.info(Zr+" the first time call"))},o.prototype.Vs=function(e,t){var n,r=this,i=function(u){r.Qs(u,t)},s={user_index:e,sort_type:0},c=Qs;this.pn.reporter.createSpan(E.t0.H,{key:ur.event,par:this.Ar.roomID},{key:c.event,par:this.Ar.roomID},c.event,!0).setAttribute("user_index",c.user_index(e)),(n=this.Jr)===null||n===void 0||n.fetchUserList(s,i,i,this.Ar)},o.prototype.Qs=function(e,t){var n,r,i=this;if(this.pn.reporter.spanEnd({key:Qs.event,par:this.Ar.roomID},{error:((n=e==null?void 0:e.body)===null||n===void 0?void 0:n.err_code)||(e==null?void 0:e.code),message:((r=e==null?void 0:e.body)===null||r===void 0?void 0:r.err_message)||(e==null?void 0:e.msg)}),e.body&&e.body.err_code!=0)return this.Ds=!1,this.Fs=Date.now()+this.qs,void this.an.info(kr+" fetch error "+e.body.err_code);if(!e.header||!e.body)return this.Ds=!1,this.Fs=Date.now()+this.qs,void this.an.info(kr+" fetch error "+e);if(this.Ar.userStateUpdate){this.Ns=Aa(Aa([],this.Ns,!0),e.body.user_baseinfos,!0);var s=e.body.ret_user_index;if(s!=e.body.server_user_index)return this.an.info(kr+" fetch another page"),void this.Vs(s+1,t);this.Ps=e.body.server_user_seq;for(var c=[],u=[],l=0;l<this.Ns.length;l++){var a={userID:this.Ns[l].id_name,userName:this.Ns[l].nick_name,role:this.Ns[l].role};a.role!==4&&(c.push(a),u.push({idName:this.Ns[l].id_name,nickName:this.Ns[l].nick_name,role:this.Ns[l].role}))}this.pn.actionListener("_getTotalUserList",this.Ar.roomID,u),t==Te.UV.login?(this.xs&&function(h,m,S,x){h.debug("msl.0 call");var q,V=[],_e=[];S||(S=[]);for(var ke=0;ke<S.length;ke++){q=!1;for(var Pe=0;Pe<m.length;Pe++)if(S[ke].userID===m[Pe].userID){q=!0;break}q||V.push(S[ke])}for(var Oe=0;Oe<m.length;Oe++){q=!1;for(var Ge=0;Ge<S.length;Ge++)if(m[Oe].userID===S[Ge].userID){q=!0;break}q||_e.push(m[Oe])}for(m.splice(0),ke=0;ke<S.length;ke++)m.push(m[ke]);x(V,_e),h.debug("msl.0 call success")}(this.an,this.xs,c,function(h,m){h.length!==0&&i.onUserStateUpdate(i.Ar.roomID,"ADD",h),m.length!==0&&i.onUserStateUpdate(i.Ar.roomID,"DELETE",m)}),this.xs=c):(this.xs=c,c.length!==0&&this.onUserStateUpdate(this.Ar.roomID,"ADD",c)),this.Ds=!1,this.Fs=Date.now()+this.qs,this.Ns=[],this.an.info(kr+" call success user_list "+c+", count: "+c.length+", seq: "+this.Ps)}else this.an.info(kr+" not update")},o.prototype.handlePushUserStateUpdateMsg=function(e){var t=this;if(this.an.info(Fr+" call"),this.Ar.userStateUpdate)if(this.Ps!==e.body.user_list_seq)if(this.Ps+e.body.user_actions.length===e.body.user_list_seq){this.Ps=e.body.user_list_seq;for(var n=[],r=0;r<e.body.user_actions.length;r++){var i={action:e.body.user_actions[r].Action,idName:e.body.user_actions[r].IdName,nickName:e.body.user_actions[r].NickName,role:e.body.user_actions[r].Role,loginTime:e.body.user_actions[r].LoginTime};i.role===4||n.push(i)}this.pn.actionListener("_userStateUpdate",e.body.room_id,n);var s=[],c=[];n.forEach(function(u){var l;u.action==1?s.push({userID:u.idName,userName:u.nickName,role:u.role}):u.action==2&&(!((l=t.xs)===null||l===void 0)&&l.find(function(a){return a.userID===u.idName})?c.push({userID:u.idName,userName:u.nickName,role:u.role}):t.an.info(Fr+" user "+u.idName+" not exist"))}),this.xs&&(this.xs=this.xs.concat(s).filter(function(u){return!c.some(function(l){return l.userID==u.userID})})),s.length!==0&&this.onUserStateUpdate(e.body.room_id,"ADD",s),c.length!==0&&this.onUserStateUpdate(e.body.room_id,"DELETE",c),this.an.info(Fr+" call success")}else this.Ys(e.body.user_list_seq,e.body.user_actions);else this.an.warn(Fr+" user_list_seq is the same with local seq");else this.an.info(Fr+" userStateUpdate is false")},o.prototype.onUserStateUpdate=function(e,t,n){var r=this,i=n.filter(function(s){return s.userID!==r.pn.idName});i.length!=0&&(i=i.map(function(s){return{userID:s.userID,userName:s.userName}}),this.pn.actionListener("roomUserUpdate",e,t,i))},o.prototype.Ys=function(e,t){var n=this;this.js||(this.an.warn(qr+" new merge userlist "+this.Ps+" server "+e),this.js={},this.Gs&&clearTimeout(this.Gs),this.Gs=setTimeout(function(){n.Js()},this.Ls)),this.js[e]=t,this.an.warn(qr+"  merge userlist "+this.Ps+" server "+e+" userlist "+t.length)},o.prototype.Zs=function(e){var t=this;this.an.info("zm.us.mg merge userlist "+this.Ps+" userSeqList "+e.join(",")),this.Ps=e[e.length-1],this.Fs=Date.now()+this.qs;var n={};e.forEach(function(c){t.js&&t.js[c].forEach(function(u){n[u.IdName]=u})}),this.js=null;var r=Object.values(n).map(function(c){return{action:c.Action,idName:c.IdName,nickName:c.NickName,role:c.Role,loginTime:c.LoginTime?String(c.LoginTime):""}}).filter(function(c){return c.role!==4});r.sort(function(c,u){return c.loginTime.localeCompare(u.loginTime)});var i=[],s=[];r.forEach(function(c){c.action==1?i.push({userID:c.idName,userName:c.nickName,role:c.role}):c.action==2&&s.push({userID:c.idName,userName:c.nickName,role:c.role})}),this.xs=this.xs&&this.xs.concat(i).filter(function(c){return!s.some(function(u){return u.userID==c.userID})}),i.length!==0&&this.onUserStateUpdate(this.Ar.roomID,"ADD",i),s.length!==0&&this.onUserStateUpdate(this.Ar.roomID,"DELETE",s),this.pn.actionListener("_userStateUpdate",this.Ar.roomID,r)},o.prototype.Js=function(){var e=this,t=Object.keys(this.js).map(function(r){return+r}).sort(function(r,i){return r-i});if(t[t.length-1]-t[0]+1===t.length||t[t.length-1]>=this.Ms)this.Zs(t);else{this.js=null;var n=this.Fs-Date.now();this.an.info("zm.us.mto  fetch merge userlist "+this.Ps+" userSeqList "+t.join(",")+" wait "+n),n>0?(this.Hs&&clearTimeout(this.Hs),this.Hs=setTimeout(function(){e.Us()},n)):this.Us()}},o.prototype.updateUserDelete=function(e){this.xs&&this.xs.length&&(this.onUserStateUpdate(e,"DELETE",this.xs),this.xs=[])},o}(),ls=function(){function o(e,t,n,r,i,s){this.roomID=e,this.pn=t,this.an=n,this.dataReport=r,this.rtm=i,this.Jr=s,this.runState=Te.UV.logout,this.lastRunState=Te.UV.logout,this.lastRoomState="DISCONNECTED",this.roomState="DISCONNECTED",this.roomReasonState=ue.Logout,this.roomSessionID="0",this.sessionID="0",this.longSid=null,this.longRoomSid=null,this.isMulti=!1,this.token="",this.thirdToken="",this.loginTime=0,this.userStateUpdate=!1,this.maxMemberCount=0,this.roomName="",this.isCancelLogin=!1,this.roomHandler=new hu(this.an,this.pn,this.dataReport,this,s),this.heartBeatHandler=new vc(this.an,this.pn,this.dataReport,this.Jr,this),this.userHandler=new pu(this.an,this.pn,this.dataReport,this.Jr,this),this.initMessageHandler(),this.initLiveHandler(),this.init()}return Object.defineProperty(o.prototype,"logger",{get:function(){return this.an},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"stateCenter",{get:function(){return this.pn},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"liveRoomHandler",{get:function(){return this.Jr},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sessionExist",{get:function(){return this.longSid!==null||this.sessionID!=="0"},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"roomSidString",{get:function(){return this.longRoomSid?this.longRoomSid.toString():"0"},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"userSidString",{get:function(){return this.longSid?this.longSid.toString():"0"},enumerable:!1,configurable:!0}),o.prototype.initMessageHandler=function(){},o.prototype.initLiveHandler=function(){},o.prototype.init=function(){this.bindHeatBeatHandler(),this.bindRoomHandler(),this.bindMessageHandler(),this.bindLiveHandler()},o.prototype.bindHeatBeatHandler=function(){var e=this;this.heartBeatHandler.hbLogout=function(t){e.roomHandler.handleHbLogout(t)},this.heartBeatHandler.heartbeatRspNotiFy=function(t,n){e.messageHandler&&e.messageHandler.loginRsp(t),e.userHandler.patchUserList(t),e._HBResponse(t,n)}},o.prototype.bindRoomHandler=function(){var e=this;this.roomHandler.loginSuccessCallBack=function(t,n){var r;e.an.info("zm.lrm.brh login suc "+t),e.heartBeatHandler.init(n),e.Jr.startCheck(),e.userHandler.loginRsp(n,t),e.messageHandler&&e.messageHandler.loginRsp(n),(r=e.roomTryHandler)===null||r===void 0||r.resetError(),e.isMulti||e.Ws(),e.io(n)},this.roomHandler.resetRoomCallBack=function(){e.heartBeatHandler.resetHeartbeat(),e.liveHandler&&e.liveHandler.resetLiveHandler(),e.messageHandler&&e.messageHandler.resetMessageInfo(),e.Jr&&e.Jr.stopCheck(),e.userHandler.resetUserHandler(),e.roomTryHandler&&(e.roomTryHandler.invalid(),e.roomTryHandler.stopMaxTime())}},o.prototype.bindUserHandler=function(){},o.prototype.bindMessageHandler=function(){},o.prototype.bindLiveHandler=function(){},o.prototype._HBResponse=function(e,t){this.pn.actionListener("HBResponse",e,t)},o.prototype.io=function(e){this.pn.actionListener("roomLoginResponse",e)},o.prototype.checkRoomSession=function(e){return this.longRoomSid!==null&&this.longRoomSid.eq(e)},o.prototype.Ws=function(){this.pn.roomModulesList.forEach(function(e){var t=e.roomTryHandler;e.runState!==Te.UV.login&&t&&e.isMulti==1&&(t.onactive=function(n,r){if(r&&r.code!==0){var i=st(r.code);i&&pe[i]&&(r=pe[i]),e.roomHandler._roomStateHandle("DISCONNECTED",ue.ReconnectFailed,r,r.msg)}else e.roomHandler._roomStateHandle("CONNECTED",ue.Reconnected,r)},t.lastError===pe.NETWORK_RECOVERY.code?t.retryLoginRoom(!0,!1,pe.NETWORK_RECOVERY):t.retryLoginRoom())})},o.prototype.isLogin=function(){return this.runState===Te.UV.login},o.prototype.isLogout=function(){return this.runState===Te.UV.logout},o.prototype.isTryLogin=function(){return this.runState===Te.UV.trylogin},o.prototype.isDisConnect=function(){return this.Jr.isDisConnect()},o.prototype.retryConnect=function(){this.an.info("zm.lrm.rc call"),this.resetSessionInfo(),this.Jr.closeRequest()},o.prototype.retryRoom=function(e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1),this.an.info("zm.lrm.rr.0 call retryNow:"+e+" resetSession: "+t+" "+(0,te.iq)(n));var r=this.roomTryHandler;r&&this.rtm.isUaConnect&&r.retryLoginRoom(e,t,n)},o.prototype.resetSessionInfo=function(){var e;this.an.info("zm.lrm.rsi call"),this.resetRoomSession(),this.resetUserSession(),(e=this.Jr)===null||e===void 0||e.reset()},o.prototype.resetRoomSession=function(){this.roomSessionID="0",this.longRoomSid=null},o.prototype.resetUserSession=function(){this.sessionID="0",this.longSid=null},o}(),gc=pt(4883),yc=function(){function o(e){e===void 0&&(e=!1),this.close=!1,this.isLoad=!1,this.callBackList=[],this.close=e,this.close||(this.no=new gc.ZegoSetting)}return o.prototype.setLog=function(e){var t;(t=this.no)===null||t===void 0||t.setLog(e)},o.prototype.init=function(e){var t;(t=this.no)===null||t===void 0||t.init(e)},o.prototype.setEnvVariable=function(e,t){var n;(n=this.no)===null||n===void 0||n.setEnvVariable(e,t)},o.prototype.getEnvVariables=function(){var e;return(e=this.no)===null||e===void 0?void 0:e.getEnvVariables()},o.prototype.fetchSetting=function(e,t,n){return this.no?this.no.fetchSetting(e,t,n):Promise.resolve()},o.prototype.fetchMultiSetting=function(e,t,n){return this.no?this.no.fetchMultiSetting(e,t,n):Promise.resolve()},o.prototype.setOptions=function(e){var t;return this.close||(t=this.no)===null||t===void 0?void 0:t.setOptions(e)},o.prototype.getSettingCache=function(e){var t;return this.no?(t=this.no)===null||t===void 0?void 0:t.getSettingCache(e):Promise.resolve()},o.prototype.setToken=function(e){var t;(t=this.no)===null||t===void 0||t.setToken(e)},o.prototype.setUserID=function(e){var t;(t=this.no)===null||t===void 0||t.setUserID(e)},o.prototype.activePolling=function(){var e;(e=this.no)===null||e===void 0||e.activePolling()},o.prototype.uninit=function(){var e;(e=this.no)===null||e===void 0||e.uninit()},o.prototype.getEnvVariable=function(e){var t;(t=this.no)===null||t===void 0||t.getEnvVariable(e)},o}(),wi=function(){function o(e){this.eo=-1,this.ro=3e4,this.so=0,this.ro=e}return o.prototype.trigger=function(){var e,t=performance.now();return this.so++,this.eo===-1?(e={toReport:!0,failCount:this.so},this.eo=t,this.so=0):t-this.eo>this.ro?(e={toReport:!0,failCount:this.so},this.eo=t,this.so=0):e={toReport:!1},e},o}(),jo=pt(757),Vn=pt(6493),Xs=function(){return Xs=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},Xs.apply(this,arguments)},_l=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},fu=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Da=function(){function o(e){this.an=e,this.oo=jn.product,this.uo={},this.ao={},this.isUnload=!1,new jo.DynamicCode,this.ho=new jo.ZegoTracer(p.proxyCtrl),this.ho.setSampleConfig({level:E.t0.L}),this.lo=(0,Vn.hU)()}return Object.defineProperty(o.prototype,"tracer",{get:function(){return this.ho},enumerable:!1,configurable:!0}),o.prototype.init=function(e,t,n){var r=this;this.ho.init({product:this.oo,version:"1.0.0",env:t,appID:e,deviceID:n,importantLevel:jn.importLevel,levels:jn.levels,bps:jn.bps,spanStart:function(i){try{(0,R.JO)(window.scriptSpanStart)&&scriptSpanStart(r.ao,r.ho,i)}catch(s){r.an.warn(Tt+" dy span start "+s)}},spanBeforeEnd:function(i){i.setAttribute("ntype_end",ir())},spanEnd:function(i,s){try{(0,R.JO)(window.scriptSpanEnd)&&scriptSpanEnd(r.ao,r.ho,i)}catch(c){r.an.warn(Tt+" dy span end "+JSON.stringify(c))}},resources:{product:this.oo,appid:e,device_id:n,console:t==0?"rtc":"ali"},deflate:this.an.deflate})},o.prototype.setConfig=function(e){this.ho.setConfig(e)},o.prototype.loadScript=function(e,t,n,r){return _l(this,void 0,void 0,function(){var i;return fu(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.ho.loadJs(e,t,n,r,`
function scriptSpanStart(states, tracer, span) {
    
}
function scriptSpanEnd(states, tracer, span) {
    if (span['tags']['msg_content']) {
        span['tags']['msg_content_size'] = span['tags']['msg_content'].length;
        delete span['tags']['msg_content'];
    }
    delete span['tags']['resp'];
    const filterSpans = ['/rtc/login', '/rtc/hb', '/rtc/recv_remote_stream'];
    if (filterSpans.includes(span.name)) {
        console.log(span.name + ' do not report');
        span.droped = true;
    }
}
function scriptInit(states, tracer) {

}

`,{})];case 1:return s.sent(),(0,R.JO)(window.scriptInit)&&scriptInit(this.ao,this.ho),[3,3];case 2:return i=s.sent(),this.an.warn("zm.tc.ls load script fail "+JSON.stringify(i)),[3,3];case 3:return[2]}})})},o.prototype.setReporterInfo=function(e,t){var n=new Map;n.set("userID",e),n.set("token",t),this.ho.startReport(n)},o.prototype.flush=function(e){this.ho.flush(e)},o.prototype.destroy=function(){this.ho.destroy()},o.prototype.setCommonStates=function(e){this.ao=e},o.prototype.setResource=function(e){this.ho.setResource(e)},o.prototype.setCommonAttributes=function(e){this.uo=Object.assign({},this.uo,e)},o.prototype.deleteCommonAttributes=function(e){var t=this;e.forEach(function(n){delete t.uo[n]})},o.prototype.createSpan=function(e,t,n){var r=this.ho.createSpan(e,t,{parent:n});return o.reportCustomerContext>0&&r.setAttributes({customer_context:o.reportCustomerContext}),r.setAttributes(Xs({ntype:ir(),os_type:this.lo,error:0,message:""},this.uo)),r},o.prototype.spanEnd=function(e,t,n){e&&t&&e.setAttributes(Xs({},t)),e&&e.end(n)},o.prototype.spanReport=function(e){e&&e.spanReport()},o.prototype.spanSetAttributes=function(e,t){e&&e.setAttributes(t)},o.prototype.spanAppendAttribute=function(e,t,n){e&&e.appendAttribute(t,n)},o.prototype.setError=function(e,t,n){n===void 0&&(n=""),e.setAttributes({error:t.code||t.errorCode,message:(t.msg||t.message||t.extendedData)+" "+n}),e.end()},o.prototype.setLogger=function(e){this.ho.setLogger(e)},o.prototype.setTimeOffset=function(e){this.ho.setTimeOffset(e)},o.prototype.setUnloadState=function(e){this.isUnload=!0,this.ho.setUnloadState(e)},o.prototype.setNetStateCheck=function(){this.ho.setNetStateCheck()},o.prototype.getUploadStatus=function(){return this.ho.getUnloadStatus()},o.reportCustomerContext=0,o}(),Oa=function(){return Oa=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},Oa.apply(this,arguments)},mu=["/sdk/start_publish","/publish/start","/publish/restart"],bc=["/sdk/start_play","/play/start","/play/restart"],Na=function(){function o(e){this.an=e,this.do={},this.vo={},this.mo={},this.po=new Map,this.tracerHandler=new Da(e)}return o.setReportCustomerContext=function(e){Da.reportCustomerContext=e},o.prototype.init=function(e,t,n){this.tracerHandler.init(e,t,n)},o.prototype.setConfig=function(e){this.tracerHandler.setConfig(e)},o.prototype.loadScript=function(e,t,n,r){return this.tracerHandler.loadScript(e,t,n,r)},o.prototype.setReporterInfo=function(e,t){this.tracerHandler.setReporterInfo(e,t)},o.prototype.flush=function(e){this.tracerHandler.flush(e)},o.prototype.destroy=function(){this.tracerHandler.destroy(),this.po.clear()},o.prototype.setCommonStates=function(e){this.tracerHandler.setCommonStates(e)},o.prototype.setResource=function(e){this.tracerHandler.setResource(e)},o.prototype.setCommonAttributes=function(e){this.tracerHandler.setCommonAttributes(e)},o.prototype.deleteCommonAttributes=function(e){this.tracerHandler.deleteCommonAttributes(e)},o.prototype.clearRoomSpans=function(e){var t=this;e.forEach(function(n){for(var r in t.do)t.do[r].span==null&&delete t.do[r][n]})},o.prototype.setPublicPros=function(e){this.vo=Object.assign({},this.vo,e)},o.prototype.createSpan=function(e,t,n,r,i){var s,c,u,l;if(t&&t.key&&t.par){var a=t.par1?"_"+t.par1:"";!(u=(s=this.do[t.key])===null||s===void 0?void 0:s[t.par+a])&&t.bak_key&&(u=(c=this.do[t.bak_key])===null||c===void 0?void 0:c[t.par+a])}else t&&!(u=this.do[t.key])&&t.bak_key&&(u=this.do[t.bak_key]);return u||(u=this.do[Cn.event]),l=this.tracerHandler.createSpan(e,r,u),t.key==="/sdk/login"&&(l.setAttribute("room_id",t.par),this.vo[t.par]&&l.setAttributes(this.vo[t.par])),(mu.includes(t.key)||bc.includes(t.key))&&l.setAttribute("stream_id",t.par),mu.includes(t.key)&&this.vo["_publish_"+t.par]&&l.setAttributes(this.vo["_publish_"+t.par]),bc.includes(t.key)&&this.vo["_play_"+t.par]&&l.setAttributes(this.vo["_play_"+t.par]),i&&(n.par?(!this.do[n.key]&&(this.do[n.key]={}),this.do[n.key][n.par+(a=n.par1?"_"+n.par1:"")]=l):this.do[n.key]=l),l},o.prototype.setSpanInMap=function(e,t){t.par?(!this.do[t.key]&&(this.do[t.key]={}),this.do[t.key][t.par+(t.par2?"_"+t.par2:"")]=e):this.do[t.key]=e},o.prototype.spanEnd=function(e,t,n,r){var i;e.par?(i=this.do[e.key]&&this.do[e.key][e.par+(e.par1?"_"+e.par1:"")],this.do[e.key]&&!n&&delete this.do[e.key][e.par]):(i=this.do[e.key],!n&&delete this.do[e.key]),this.tracerHandler.spanEnd(i,t,r)},o.prototype.spanReport=function(e){var t;e.par?(t=this.do[e.key]&&this.do[e.key][e.par+(e.par1?"_"+e.par1:"")],this.do[e.key]&&delete this.do[e.key][e.par]):(t=this.do[e.key],delete this.do[e.key]),this.tracerHandler.spanReport(t)},o.prototype.spanSetAttributes=function(e,t){var n;if(e.par){var r=e.par1?"_"+e.par1:"";!(n=this.do[e.key]&&this.do[e.key][e.par+r])&&e.bak_key&&(n=this.do[e.bak_key]&&this.do[e.bak_key][e.par+r])}else!(n=this.do[e.key])&&e.bak_key&&(n=this.do[e.key]);this.tracerHandler.spanSetAttributes(n,t)},o.prototype.spanAppendAttribute=function(e,t,n){var r;if(e.par){var i=e.par1?"_"+e.par1:"";!(r=this.do[e.key]&&this.do[e.key][e.par+i])&&e.bak_key&&(r=this.do[e.bak_key]&&this.do[e.bak_key][e.par+i])}else!(r=this.do[e.key])&&e.bak_key&&(r=this.do[e.key]);this.tracerHandler.spanAppendAttribute(r,t,n)},o.prototype.setError=function(e,t,n){this.tracerHandler.setError(e,t,n)},o.prototype.setLogger=function(e){this.tracerHandler.setLogger(e)},o.prototype.setTimeOffset=function(e){this.tracerHandler.setTimeOffset(e)},o.prototype.setUnloadState=function(e){this.tracerHandler.setUnloadState(e)},o.prototype.setNetStateCheck=function(){this.tracerHandler.setNetStateCheck()},o.prototype.setAPIErrorReport=function(e,t){this.mo[e]=t},o.prototype.getAPIErrorReport=function(e){return this.mo[e]},o.prototype.takeAPIErrorReport=function(e,t,n,r){if(n){var i=this.po.get(e);i||(i=new wi(n),this.po.set(e,i));var s=i.trigger(),c=s.failCount;if(s.toReport){var u=this.createSpan(E.t0.I,{key:Cn.event},{key:""},e);u.setAttributes(Oa({api_fail_count:c},r)),this.setError(u,t)}}},o}(),oi=pt(3788);const vu=pt(6994);(oi=oi.default||oi).util.Long=vu.default||vu,oi.util.Long.fromBits=oi.util.Long.fromBits||function(){return 0};for(var io=oi.roots,$s=oi.types?oi.types.basic:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0,string:2,bytes:2},_c=oi.types?oi.types.packed:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0},ea=Object.keys($s),Mo={$:function(o){return Mo[o]?Mo[o].call(this):io[o].decode?io[o].decode(this,this.uint32()):Mo.$.call(this,"int32")}},Wo={$:function(o,e,t){var n=$s[o];return n===void 0?io[o].encode?(this.uint32(t<<3|2).fork(),io[o].encode(e,this).ldelim()):Wo.$.call(this,"int32",e,t):Wo[o].call(this.uint32(t<<3|n),e)}},ds=0;ds<ea.length;ds++)Mo[ea[ds]]=oi.Reader.prototype[ea[ds]],Wo[ea[ds]]=oi.Writer.prototype[ea[ds]];(function o(e,t,n,r){for(var i=0,s=Object.keys(e);i<s.length;i++){var c=s[i];if(e[c].$m&&Object.keys(e[c].$m).every(function(u){return Number(u)})){if(n[c])throw Error(`nested type ${n}.${c} has already exist`);n[c]=function(u,l){function a(q){for(var V in u){var _e=u[V];_e[1].charAt(0)==="{"?this[_e[0]]={}:_e[1].charAt(0)!=="["&&_e[1].charAt(0)!=="<"||(this[_e[0]]=[])}if(q)for(var ke=Object.keys(q),Pe=0;Pe<ke.length;++Pe)q[ke[Pe]]!=null&&(this[ke[Pe]]=q[ke[Pe]])}var h={};for(var m in u){var S=u[m],x=S[1];x.charAt(0)==="{"?(a.prototype[S[0]]=oi.util.emptyObject,h[x]={$m:x.substring(1).split(",").map(function(q,V){return[`$${V+1}`,q,null]}).reduce(function(q,V,_e){return q[_e+1]=V,q},{})}):a.prototype[S[0]]=x.charAt(0)==="["||x.charAt(0)==="<"?oi.util.emptyArray:x==="bytes"?oi.util.newBuffer([]):S[2]&&S[2].hasOwnProperty("low")&&S[2].hasOwnProperty("high")?oi.util.Long.fromBits(S[2].low,S[2].high,S[2].unsigned):S[2]}return a.create=function(q){return new a(q)},a.decode=function(q,V){q instanceof oi.Reader||(q=oi.Reader.create(q));for(var _e=V===void 0?q.len:q.pos+V,ke=new a;q.pos<_e;){var Pe=q.uint32(),Oe=Pe>>>3;if(Oe>0&&u[Oe]){var Ge=u[Oe][0],Je=u[Oe][1];if(Je.charAt(0)==="{"){ke[Ge]===oi.util.emptyObject&&(ke[Ge]={});var tt=a.$namespace[Je].decode(q,q.uint32());ke[Ge][tt.$1]=tt.$2}else if(Je.charAt(0)==="["||Je.charAt(0)==="<")if(Je=Je.substring(1),ke[Ge]&&ke[Ge].length||(ke[Ge]=[]),_c[Je=!Mo[Je]&&!io[Je].decode?"int32":Je]!==void 0&&(7&Pe)==2)for(var ut=q.uint32()+q.pos;q.pos<ut;)ke[Ge].push(Mo.$.call(q,Je));else ke[Ge].push(Mo.$.call(q,Je));else ke[Ge]=Mo.$.call(q,Je)}else q.skipType(7&Pe)}return ke},a.encode=function(q,V){for(var _e in V||(V=oi.Writer.create()),u){var ke=u[_e][0],Pe=u[_e][1];if(Pe.charAt(0)==="{"){if(q[ke]!=null&&q.hasOwnProperty(ke))for(var Oe=0,Ge=Object.keys(q[ke]);Oe<Ge.length;++Oe)V.uint32(_e<<3|2).fork(),a.$namespace[Pe].encode({$1:Ge[Oe],$2:q[ke][Ge[Oe]]},V).ldelim()}else if(Pe.charAt(0)==="["||Pe.charAt(0)==="<"){var Je=Pe.charAt(0)==="<";Pe=Pe.substring(1);var tt=q[ke];if(tt!=null&&tt.length)if(Pe=$s[Pe]===void 0&&!io[Pe].encode?"int32":Pe,Je&&_c[Pe]!==void 0){for(V.uint32(_e<<3|2).fork(),Oe=0;Oe<tt.length;Oe++)Wo[Pe].call(V,tt[Oe]);V.ldelim()}else for(Oe=0;Oe<tt.length;Oe++)Wo.$.call(V,Pe,tt[Oe],_e)}else q[ke]!=null&&q.hasOwnProperty(ke)&&Wo.$.call(V,Pe,q[ke],_e)}return V},Object.keys(h).length&&(a.$namespace=o(h,t+"."+l,a.$namespace||{},!0)),a}(e[c].$m,c)}else e[c].$s?n[c]=function(u,l){function a(h,m,S){oi.rpc.Service.call(this,h,m,S)}return(a.prototype=Object.create(oi.rpc.Service.prototype)).constructor=a,a.create=function(h,m,S){return new a(h,m,S)},Object.keys(u).forEach(function(h){var m=u[h];function S(x,q){return this.rpcCall(S,io[m[0]],io[m[1]],x,q)}Object.defineProperty(S,"name",{value:h}),Object.defineProperty(S,"path",{value:`${t}.${l}`}),a.prototype[h]=S}),a}(e[c].$s,c):e[c].$e&&Object.values(e[c].$e).every(function(u){return Number(u)===u})&&(n[c]=function(u){for(var l=Object.keys(u),a={},h=0;h<l.length;h++)a[a[l[h]]=u[l[h]]]=l[h];return a}(e[c].$e));n[c]&&!r&&(io[`${t}.${c}`]=n[c]),delete e[c].$m,delete e[c].$s,delete e[c].$e,n[c]=o(e[c],t?`${t}.${c}`:c,n[c]||{})}return n})({rtc:{generalpclib:{CmbType:{$e:{CMD_TYPE_BUSINESS_REQUEST:100,CMD_TYPE_BUSINESS_RESPONSE:101}},Header:{$m:{1:["cmd","uint32",0]}}},liveroom_cs_v3:{AddStreamReq:{$m:{1:["stream_id","bytes",[]],2:["stream_title","bytes",[]],3:["stream_type","uint32",0],4:["stream_attr","bytes",[]],5:["extra_info","bytes",[]],6:["client_req_seq","uint32",0],7:["third_token","bytes",[]],8:["censor_mode","uint32",0],9:["need_gather","uint32",0],11:["stream_attr_opts","rtc.liveroom_cs_v3.StreamAttrOptions",null],12:["sdk_custom","bytes",[]]}},AddStreamRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["stream_seq","uint32",0],3:["stream_sid","string",""],4:["stream_ver","uint32",0],5:["stream_nid","uint32",0],6:["token_remain_time","uint32",0]}},AnchorInfo:{$m:{1:["id_name","bytes",[]],2:["user_id","uint64",{low:0,high:0,unsigned:!0}],3:["nick_name","bytes",[]]}},BigImData:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0],4:["msg_id","bytes",[]],5:["msg_category","uint32",0],6:["msg_type","uint32",0],7:["msg_content","bytes",[]],8:["msg_timestamp","int64",{low:0,high:0,unsigned:!1}]}},CapabilityParams:{$m:{1:["video_codec","uint32",0],2:["gop_mode","uint32",0],3:["nego_types","uint32",0]}},CapabilityResult:{$m:{1:["nego_type","uint32",0],2:["video_codec","uint32",0],3:["gop_mode","uint32",0]}},CommonRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null]}},DeleteStreamReq:{$m:{1:["stream_sid","string",""],2:["stream_id","bytes",[]],3:["client_req_seq","uint32",0]}},DeleteStreamRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["stream_seq","uint32",0],3:["stream_ver","uint32",0]}},EnterRoomReq:{$m:{1:["net_type","uint32",0],2:["conn_type","uint32",0],3:["room_id","bytes",[]],4:["room_name","bytes",[]],5:["role","uint32",0],6:["third_token","bytes",[]],7:["room_create_flag","uint32",0],8:["user_state_flag","uint32",0],9:["user_count_limit","uint32",0],10:["relate_service","string",""],11:["need_gather_stream","uint32",0],12:["callback_data","bytes",[]],13:["service_flags","uint32",0],14:["license_token","bytes",[]],15:["user_session_id","uint64",{low:0,high:0,unsigned:!0}],16:["capabilities","rtc.liveroom_cs_v3.CapabilityParams",null]}},EnterRoomRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["user_session_id","uint64",{low:0,high:0,unsigned:!0}],3:["room_session_id","uint64",{low:0,high:0,unsigned:!0}],4:["user_id","uint64",{low:0,high:0,unsigned:!0}],5:["ret_timestamp","int64",{low:0,high:0,unsigned:!1}],6:["big_im_time_window","uint32",0],7:["liveroom_hb_interval","uint32",0],8:["liveroom_hb_timeout","uint32",0],9:["online_count","uint32",0],10:["anchor_info","rtc.liveroom_cs_v3.AnchorInfo",null],11:["userlist_merge_timeout","uint32",0],12:["userlist_interval","uint32",0],13:["token_remain_time","uint32",0],14:["trans_list_seq","uint32",0],15:["trans_channel_list","<rtc.liveroom_cs_v3.TransChannel",null],16:["stream_count","uint32",0],17:["stream_list_seq","uint32",0],18:["stream_info_list","<rtc.liveroom_cs_v3.StreamInfo",null],19:["stream_fetch_flag","uint32",0],20:["stream_list_push_merge_timeout","uint32",0],21:["stream_list_hb_merge_timeout","uint32",0],22:["relate_result_list","<rtc.liveroom_cs_v3.RelateResult",null],23:["gather_list_seq","uint32",0],24:["gather_info_list","<rtc.liveroom_cs_v3.GatherInfo",null]}},EnumSignalTransmitResult:{$e:{ok:0,version_err:1}},EnumSignalTransparentMsgType:{$e:{SignalTransparentMsgTypeSDK:0,SignalTransparentMsgTypeServer:1,SignalTransparentMsgTypeBoth:2}},GatherInfo:{$m:{1:["gather_id","string",""]}},GetCapabilityReq:{$m:{}},GetCapabilityRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["capability_seq","int64",{low:0,high:0,unsigned:!1}],4:["capability_collection","<rtc.liveroom_cs_v3.CapabilityResult",null]}},GetGatherListReq:{$m:{}},GetGatherListRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["gather_list_seq","uint32",0],3:["gather_info_list","<rtc.liveroom_cs_v3.GatherInfo",null]}},GetImReq:{$m:{1:["msg_id","uint64",{low:0,high:0,unsigned:!0}],2:["sort_type","uint32",0],3:["msg_count","uint32",0]}},GetImRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["server_msg_id","uint64",{low:0,high:0,unsigned:!0}],3:["ret_msg_id","uint64",{low:0,high:0,unsigned:!0}],4:["msg_list","<rtc.liveroom_cs_v3.GetImRspImData",null]}},GetImRspImData:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0],4:["msg_id","uint64",{low:0,high:0,unsigned:!0}],5:["msg_category","uint32",0],6:["msg_type","uint32",0],7:["msg_content","bytes",[]],8:["send_time","int64",{low:0,high:0,unsigned:!1}]}},GetStreamListReq:{$m:{}},GetStreamListRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["stream_list_seq","uint32",0],3:["stream_info_list","<rtc.liveroom_cs_v3.StreamInfo",null],4:["stream_refresh","uint32",0]}},GetTransReq:{$m:{1:["trans_channel","bytes",[]],2:["trans_list","<rtc.liveroom_cs_v3.GetTransReqTransData",null]}},GetTransReqTransData:{$m:{1:["trans_type","bytes",[]],2:["trans_local_seq","uint32",0]}},GetTransRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["trans_channel","bytes",[]],3:["trans_list_seq","uint32",0],4:["trans_list","<rtc.liveroom_cs_v3.GetTransRspTransData",null]}},GetTransRspTransData:{$m:{1:["err_code","uint32",0],2:["trans_type","bytes",[]],3:["trans_data","bytes",[]],4:["trans_send_time","int64",{low:0,high:0,unsigned:!1}],5:["trans_seq","uint32",0],6:["id_name","bytes",[]],7:["nick_name","bytes",[]],8:["role","uint32",0]}},GetUserCountReq:{$m:{}},GetUserCountRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["get_interval","int64",{low:0,high:0,unsigned:!1}],3:["user_count","uint32",0],4:["admin_user_count","uint32",0]}},GetUserlistReq:{$m:{1:["sort_type","uint32",0],2:["user_index","uint32",0]}},GetUserlistRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["server_user_seq","uint64",{low:0,high:0,unsigned:!0}],3:["server_user_index","int64",{low:0,high:0,unsigned:!1}],4:["ret_user_index","int64",{low:0,high:0,unsigned:!1}],5:["user_base_info_list","<rtc.liveroom_cs_v3.UserBaseInfo",null]}},GetUserTransReq:{$m:{1:["trans_channel","bytes",[]],2:["user_trans_list","<rtc.liveroom_cs_v3.GetUserTransReqTransData",null]}},GetUserTransReqTransData:{$m:{1:["trans_type","bytes",[]],2:["trans_local_seq","uint32",0]}},GetUserTransRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["trans_channel","bytes",[]],3:["user_trans_list","<rtc.liveroom_cs_v3.GetUserTransRspTransData",null]}},GetUserTransRspTransData:{$m:{1:["err_code","uint32",0],2:["trans_type","bytes",[]],3:["trans_data","bytes",[]],4:["trans_send_time","int64",{low:0,high:0,unsigned:!1}],5:["trans_seq","uint32",0],6:["id_name","bytes",[]],7:["nick_name","bytes",[]],8:["role","uint32",0]}},HbReq:{$m:{}},HbRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["ret_timestamp","int64",{low:0,high:0,unsigned:!1}],3:["hb_interval","uint32",0],4:["hb_timeout","uint32",0],5:["stream_seq","uint32",0],6:["user_seq","int64",{low:0,high:0,unsigned:!1}],7:["online_count","uint32",0],8:["big_im_time_window","uint32",0],9:["trans_channel_list","<rtc.liveroom_cs_v3.TransChannel",null],10:["user_trans_channel_list","<rtc.liveroom_cs_v3.TransChannel",null],11:["stream_refresh","uint32",0],12:["trans_list_seq","uint32",0],13:["gather_list_seq","uint32",0],14:["capability_seq","int64",{low:0,high:0,unsigned:!1}]}},ImData:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0],4:["msg_id","uint64",{low:0,high:0,unsigned:!0}],5:["msg_category","uint32",0],6:["msg_type","uint32",0],7:["msg_content","bytes",[]],8:["send_time","int64",{low:0,high:0,unsigned:!1}]}},LiveroomSessionInfo:{$m:{1:["RoomId","bytes",[]],2:["UserSessionId","uint64",{low:0,high:0,unsigned:!0}],3:["RoomSessionId","uint64",{low:0,high:0,unsigned:!0}],4:["Role","uint32",0]}},PushBigIm:{$m:{1:["msg_list","<rtc.liveroom_cs_v3.BigImData",null]}},PushCapabilityChange:{$m:{1:["capability_seq","int64",{low:0,high:0,unsigned:!1}],3:["capability_collection","<rtc.liveroom_cs_v3.CapabilityResult",null]}},PushChannelMsg:{$m:{1:["sender_idname","bytes",[]],2:["sender_nickname","bytes",[]],3:["channel_type","uint32",0],4:["msg_type","uint32",0],5:["msg_content","bytes",[]]}},PushIm:{$m:{1:["server_msg_id","uint64",{low:0,high:0,unsigned:!0}],2:["ret_msg_id","uint64",{low:0,high:0,unsigned:!0}],4:["msg_list","<rtc.liveroom_cs_v3.ImData",null]}},PushStartGather:{$m:{1:["gather_id","string",""],2:["gather_seq","uint32",0]}},PushStopGather:{$m:{1:["gather_id","string",""],2:["gather_seq","uint32",0]}},PushStream:{$m:{1:["stream_seq","uint32",0],2:["stream_info_list","<rtc.liveroom_cs_v3.PushStreamInfo",null]}},PushStreamInfo:{$m:{1:["stream_id","bytes",[]],2:["stream_sid","string",""],3:["id_name","bytes",[]],4:["nick_name","bytes",[]],5:["stream_title","bytes",[]],6:["stream_ver","uint32",0],7:["stream_attr","bytes",[]],8:["stream_src","uint32",0],9:["stream_state","uint32",0],10:["stream_type","uint32",0],11:["stream_nid","uint32",0],12:["extra_info","bytes",[]],13:["create_time","int64",{low:0,high:0,unsigned:!1}],14:["close_type","uint32",0],15:["need_gather","uint32",0],17:["stream_attr_opts","rtc.liveroom_cs_v3.StreamAttrOptions",null],18:["sdk_custom","bytes",[]]}},PushTrans:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0],4:["trans_type","bytes",[]],5:["trans_data","bytes",[]],6:["trans_seq","uint32",0],7:["trans_send_time","int64",{low:0,high:0,unsigned:!1}],8:["trans_channel","bytes",[]],9:["trans_list_seq","uint32",0]}},PushTransparentMsg:{$m:{1:["msg_data","bytes",[]],2:["client_seq","uint64",{low:0,high:0,unsigned:!0}],3:["sender_idname","bytes",[]],4:["sender_nickname","bytes",[]]}},PushUserInfoUpdated:{$m:{1:["server_user_seq","int64",{low:0,high:0,unsigned:!1}],2:["user_action_list","<rtc.liveroom_cs_v3.UserAction",null]}},PushUserKickout:{$m:{1:["id_name","bytes",[]],2:["user_session_id","uint64",{low:0,high:0,unsigned:!0}],3:["kickout_reason","int32",0],4:["custom_reason","bytes",[]]}},PushUserLogReport:{$m:{}},PushUserTokenExpire:{$m:{1:["token","string",""],2:["stop_stream_info","rtc.liveroom_cs_v3.StopStream",null]}},PushUserTrans:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0],4:["trans_send_time","int64",{low:0,high:0,unsigned:!1}],5:["trans_channel","bytes",[]],6:["trans_seq_list","<rtc.liveroom_cs_v3.PushUserTransInfo",null]}},PushUserTransInfo:{$m:{1:["trans_type","bytes",[]],2:["trans_data","bytes",[]],3:["trans_seq","uint32",0]}},QuitRoomReq:{$m:{}},QuitRoomRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null]}},RelateResult:{$m:{1:["service","string",""],2:["relate_result","uint32",0]}},RenewTokenReq:{$m:{1:["token","string",""]}},RenewTokenRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["token_remain_time","uint32",0],3:["stop_stream_id_list","<bytes",null]}},RspHead:{$m:{1:["code","uint32",0],2:["message","string",""]}},SendBigImReq:{$m:{1:["msg_list","<rtc.liveroom_cs_v3.SendBigImReqMsgData",null]}},SendBigImReqMsgData:{$m:{1:["msg_category","uint32",0],2:["msg_type","uint32",0],3:["msg_content","bytes",[]],4:["msg_timestamp","int64",{low:0,high:0,unsigned:!1}],5:["msg_client_id","bytes",[]]}},SendBigImRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["big_im_time_window","uint32",0],3:["msg_list","<rtc.liveroom_cs_v3.SendBigImRspMsgData",null]}},SendBigImRspMsgData:{$m:{1:["msg_id","bytes",[]],2:["msg_client_id","bytes",[]]}},SendChannelMsgReq:{$m:{1:["channel_type","uint32",0],2:["msg_type","uint32",0],3:["msg_content","bytes",[]],4:["to_user_list","<bytes",null]}},SendChannelMsgRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null]}},SendImReq:{$m:{1:["msg_category","uint32",0],2:["msg_type","uint32",0],3:["msg_content","bytes",[]],4:["to_user_list","<rtc.liveroom_cs_v3.ToUser",null]}},SendImRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["msg_id","uint64",{low:0,high:0,unsigned:!0}]}},SetTransReq:{$m:{1:["trans_type","bytes",[]],2:["trans_data","bytes",[]],3:["trans_local_seq","uint32",0],4:["trans_channel","bytes",[]]}},SetTransRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["trans_type","bytes",[]],3:["trans_seq","uint32",0],4:["trans_list_seq","uint32",0],5:["trans_channel","bytes",[]]}},SetUserAttrReq:{$m:{1:["use_data_channel","uint32",0],2:["is_modify_use_data_channel","bool",!1],3:["user_type","uint32",0],4:["is_modify_user_type","bool",!1]}},SetUserAttrRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null]}},SignalLiveCustomReq:{$m:{1:["push_message","bytes",[]],2:["to_user_list","<rtc.liveroom_cs_v3.ToUser",null]}},SignalLiveCustomRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null]}},SignalLiveInviteReq:{$m:{1:["push_message","bytes",[]],2:["to_user_list","<rtc.liveroom_cs_v3.ToUser",null]}},SignalLiveInviteRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null]}},SignalLiveRequestReq:{$m:{1:["push_message","bytes",[]],2:["to_user_list","<rtc.liveroom_cs_v3.ToUser",null]}},SignalLiveRequestRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null]}},SignalLiveResultReq:{$m:{1:["push_message","bytes",[]],2:["to_user_list","<rtc.liveroom_cs_v3.ToUser",null]}},SignalLiveResultRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null]}},SignalLiveStopReq:{$m:{1:["push_message","bytes",[]],2:["to_user_list","<rtc.liveroom_cs_v3.ToUser",null]}},SignalLiveStopRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null]}},SignalTransmitReq:{$m:{1:["to_user_list","<bytes",null],2:["transmit_data","bytes",[]]}},SignalTransmitResult:{$m:{1:["to_user","bytes",[]],2:["result","rtc.liveroom_cs_v3.EnumSignalTransmitResult",0]}},SignalTransmitRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["result","<rtc.liveroom_cs_v3.SignalTransmitResult",null]}},SignalTransparentMsgReq:{$m:{1:["msg_type","rtc.liveroom_cs_v3.EnumSignalTransparentMsgType",0],2:["msg_data","bytes",[]],3:["to_user_list","<bytes",null],4:["client_seq","uint64",{low:0,high:0,unsigned:!0}]}},SignalTransparentMsgRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null]}},StopStream:{$m:{1:["stream_id_list","<bytes",null]}},StreamAttrOptions:{$m:{1:["stream_resource","sint32",0],2:["stream_codec","sint32",0],3:["play_mode","uint32",0],4:["forbid_play_expire_time","int64",{low:0,high:0,unsigned:!1}],5:["censor_flag","int32",0]}},StreamInfo:{$m:{1:["stream_id","bytes",[]],2:["stream_sid","string",""],3:["id_name","bytes",[]],4:["nick_name","bytes",[]],5:["stream_title","bytes",[]],6:["stream_ver","uint32",0],7:["stream_attr","bytes",[]],8:["create_time","int64",{low:0,high:0,unsigned:!1}],9:["stream_src","uint32",0],10:["stream_state","uint32",0],11:["stream_type","uint32",0],12:["stream_nid","uint32",0],13:["extra_info","bytes",[]],14:["need_gather","uint32",0],16:["stream_attr_opts","rtc.liveroom_cs_v3.StreamAttrOptions",null],17:["sdk_custom","bytes",[]]}},ToUser:{$m:{1:["id_name","bytes",[]],2:["user_id","uint64",{low:0,high:0,unsigned:!0}]}},TransChannel:{$m:{1:["trans_channel","bytes",[]],2:["trans_seq_list","<rtc.liveroom_cs_v3.TransSeq",null]}},TransSeq:{$m:{1:["trans_type","bytes",[]],2:["trans_seq","uint32",0]}},UpdateStreamAttrReq:{$m:{1:["stream_id","bytes",[]],2:["client_req_seq","uint32",0],3:["update_flag","uint32",0],5:["stream_attr_opts","rtc.liveroom_cs_v3.StreamAttrOptions",null],6:["sdk_custom","bytes",[]]}},UpdateStreamAttrRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["stream_seq","uint32",0]}},UpdateStreamReq:{$m:{1:["stream_sid","string",""],2:["stream_id","bytes",[]],3:["stream_title","bytes",[]],4:["stream_attr","bytes",[]],5:["extra_info","bytes",[]],6:["client_req_seq","uint32",0],7:["nick_name","bytes",[]]}},UpdateStreamRsp:{$m:{1:["rsp_head","rtc.liveroom_cs_v3.RspHead",null],2:["stream_seq","uint32",0],3:["stream_ver","uint32",0]}},UserAction:{$m:{1:["action","uint32",0],2:["id_name","bytes",[]],3:["nick_name","bytes",[]],4:["role","uint32",0],5:["login_time","int64",{low:0,high:0,unsigned:!1}]}},UserBaseInfo:{$m:{1:["id_name","bytes",[]],2:["nick_name","bytes",[]],3:["role","uint32",0]}}},logreport:{ChargeInfo:{$m:{1:["is_publishing","uint32",0],2:["play_stream_resolution_infos","<rtc.logreport.ResolutionInfo",null],3:["play_max_audio_bitrate","uint32",0],4:["no_playing","uint32",0],5:["p2p_charge_info","rtc.logreport.P2PChargeInfo",null],6:["sample_time_offset","uint32",0],7:["play_l3_stream_resolution_infos","<rtc.logreport.ResolutionInfo",null],8:["play_l3_max_audio_bitrate","uint32",0]}},ChargeInfos:{$m:{1:["timestamp_offset_begin","uint32",0],2:["timestamp_offset_end","uint32",0],3:["timestamp_diff_flag","uint32",0],4:["timestamp_diff","uint32",0],5:["room_id","string",""],6:["play_iframe","uint32",0],100:["infos","<rtc.logreport.ChargeInfo",null]}},DynQualityEvent:{$m:{1:["seq_no","string",""],2:["num","uint32",0],3:["dyn_quality_infos","<rtc.logreport.DynQualityInfos",null],4:["device_id","string",""],5:["latitude","uint32",0],6:["longitude","uint32",0],7:["country","string",""],8:["region","string",""],9:["city","string",""],10:["isp","string",""],11:["ve_mode","uint32",0]}},DynQualityInfo:{$m:{1:["time","uint64",{low:0,high:0,unsigned:!0}],2:["plr","uint32",0],3:["rtt","uint32",0],4:["score","uint32",0],5:["sample_time","uint32",0]}},DynQualityInfos:{$m:{1:["timestamp_offset_begin","uint64",{low:0,high:0,unsigned:!0}],2:["timestamp_offset_end","uint64",{low:0,high:0,unsigned:!0}],3:["server_ip","string",""],4:["infos","<rtc.logreport.DynQualityInfo",null],5:["network_type","uint32",0],6:["stream_id","string",""]}},HardwareInfo:{$m:{1:["sys_cpu_used","uint32",0],2:["app_cpu_used","uint32",0],3:["sys_mem_used","uint32",0],4:["app_mem_used","uint32",0],5:["sample_time_offset","uint32",0]}},HardwareInfos:{$m:{1:["timestamp_offset_begin","uint32",0],2:["timestamp_offset_end","uint32",0],3:["infos","<rtc.logreport.HardwareInfo",null],4:["sys_mem_total","uint32",0]}},NoBillingEvent:{$m:{1:["platform_info","string",""],2:["room_id","string",""]}},P2PChargeInfo:{$m:{1:["media_inc","uint64",{low:0,high:0,unsigned:!0}],2:["data_inc","uint64",{low:0,high:0,unsigned:!0}]}},PlayQualityInfo:{$m:{1:["audio_bitrate","uint32",0],2:["video_bitrate","uint32",0],3:["video_network_fps","uint32",0],4:["audio_break_count","uint32",0],5:["video_break_count","uint32",0],6:["downlink_plr","uint32",0],7:["peer_to_peer_plr","uint32",0],8:["peer_to_peer_delay","uint32",0],9:["audio_network_fps","uint32",0],10:["audio_break_duration","uint32",0],11:["video_break_duration","uint32",0],12:["audio_break_rate","uint32",0],13:["video_break_rate","uint32",0],14:["audio_break_cancel","uint32",0],15:["video_break_cancel","uint32",0],16:["rtt","uint32",0],17:["rendered_sound_level","uint32",0],18:["audio_break_cancel_duration","uint32",0],19:["video_break_cancel_duration","uint32",0],20:["audio_decode_time","uint32",0],21:["video_decode_time","uint32",0],22:["real_sampling_interval","uint32",0],23:["mos","int32",0],24:["audio_decode_fps","uint32",0],25:["video_decode_fps","uint32",0],26:["video_frames_decoded","uint32",0],27:["video_frames_dropped","uint32",0],28:["quality","int32",0],29:["evaluation_quality","int32",0],30:["break_stat_duration","uint32",0],31:["sample_time_offset","uint32",0],32:["peer_to_peer_net_delay","uint32",0],33:["audio_render_fps","uint32",0],34:["video_render_fps","uint32",0],35:["video_frame_interval_standard_deviation","uint32",0],100:["sample_time_window","uint32",0]}},PlayQualityInfos:{$m:{1:["timestamp_offset_begin","uint32",0],2:["timestamp_offset_end","uint32",0],3:["stream_id","string",""],4:["session_id","uint32",0],5:["video_width","uint32",0],6:["video_height","uint32",0],7:["ipv4","uint32",0],8:["ipv6","string",""],9:["resource_type","uint32",0],10:["infos","<rtc.logreport.PlayQualityInfo",null],11:["room_id","string",""],13:["session","string",""],14:["room_session_id","uint64",{low:0,high:0,unsigned:!0}],15:["protocol_type","uint32",0],16:["product","uint32",0],17:["resource_flag","uint32",0]}},PublishQualityInfo:{$m:{1:["audio_bitrate","uint32",0],2:["video_bitrate","uint32",0],3:["video_capture_fps","uint32",0],4:["video_network_fps","uint32",0],5:["uplink_plr","uint32",0],6:["rtt","uint32",0],7:["audio_network_fps","uint32",0],8:["captured_sound_level","uint32",0],9:["quality","uint32",0],10:["sample_time_offset","uint32",0],11:["tc_setting_audio_bitrate","uint32",0],12:["tc_setting_video_bitrate","uint32",0],13:["audio_capture_fps","uint32",0],14:["video_encode_fps","uint32",0],100:["sample_time_window","uint32",0]}},PublishQualityInfos:{$m:{1:["timestamp_offset_begin","uint32",0],2:["timestamp_offset_end","uint32",0],3:["stream_id","string",""],4:["session_id","uint32",0],5:["video_width","uint32",0],6:["video_height","uint32",0],7:["ipv4","uint32",0],8:["ipv6","string",""],9:["resource_type","uint32",0],10:["infos","<rtc.logreport.PublishQualityInfo",null],11:["room_id","string",""],13:["evnvironment","uint32",0],14:["ap","string",""],15:["session","string",""],16:["room_session_id","uint64",{low:0,high:0,unsigned:!0}],17:["protocol_type","uint32",0],18:["setting_video_bitrate","uint32",0],19:["setting_audio_bitrate","uint32",0],20:["setting_video_fps","uint32",0],21:["resource_flag","uint32",0]}},QualityEvent:{$m:{1:["hardware_infos","rtc.logreport.HardwareInfos",null],2:["publish_quality_infos","<rtc.logreport.PublishQualityInfos",null],3:["play_quality_infos","<rtc.logreport.PlayQualityInfos",null],4:["network_type","uint32",0],5:["charge_infos","rtc.logreport.ChargeInfos",null],6:["server_time","int64",{low:0,high:0,unsigned:!1}],100:["client_type","uint32",0]},ResourceType:{$e:{UNKNOWN:0,CDN:1,RTC:2,L3:3,P2P:4}}},ResolutionInfo:{$m:{1:["video_width","uint32",0],2:["video_height","uint32",0],3:["count","uint32",0]}},SpeedLogHead:{$m:{1:["version","uint32",0],2:["signature","bytes",[]],3:["timestamp","uint32",0],4:["event","uint32",0],5:["app_id","uint32",0],6:["user_id","string",""],7:["biz_type","uint32",0],8:["device_id","string",""],9:["lite_sign","bytes",[]],10:["token","bytes",[]],11:["os_type","string",""],12:["sdk_version","string",""],13:["time_offset","int64",{low:0,high:0,unsigned:!1}],14:["scenario","uint32",0],15:["report_version","uint32",0],16:["customer_context","uint32",0],17:["extlib_type","uint32",0]},BizType:{$e:{UNKNOWN:0,LIVE:1,RTV:2}},Event:{$e:{QUALITY_EVENT:0,NO_BILLING_EVENT:100,DETECT_QUALITY_EVENT:300}},ProtoVersion:{$e:{PROTO_VERSION:0,PROTO_VERSION1:1,PROTO_VERSION2:2,PROTO_VERSION3:3,PROTO_VERSION4:4,PROTO_VERSION5:5,PROTO_VERSION6:6,PROTO_VERSION7:7,PROTO_VERSION8:8,PROTO_VERSION9:9,PROTO_VERSION10:10,PROTO_VERSION11:11,PROTO_VERSION12:12,PROTO_VERSION13:13,PROTO_VERSION14:14,PROTO_VERSION15:15,PROTO_VERSION16:16,PROTO_VERSION17:17,PROTO_VERSION18:18,PROTO_VERSION19:19,PROTO_VERSION20:20,PROTO_VERSION21:21,PROTO_VERSION22:22}},ZegoScenario:{$e:{ZEGO_SCENARIO_GENERAL:0,ZEGO_SCENARIO_COMMUNICATION:1,ZEGO_SCENARIO_LIVE:2,ZEGO_SCENARIO_DEFAULT:3,ZEGO_SCENARIO_STANDARD_VIDEO_CALL:4,ZEGO_SCENARIO_HIGH_QUALITY_VIDEO_CALL:5,ZEGO_SCENARIO_STANDARD_CHATROOM:6,ZEGO_SCENARIO_HIGH_QUALITY_CHATROOM:7,ZEGO_SCENARIO_BROADCAST:8,ZEGO_SCENARIO_KARAOKE:9,ZEGO_SCENARIO_STANDARD_VOICE_CALL:10,ZEGO_SCENARIO_UNDEFINED:99}}},SpeedLogRsp:{$m:{1:["code","uint32",0],2:["message","string",""]}}},proto_switch_v3:{AnchorInfo:{$m:{1:["id_name","bytes",[]],2:["user_id","uint64",{low:0,high:0,unsigned:!0}],3:["nick_name","bytes",[]]}},Capabilities:{$m:{1:["video_codec","uint32",0],2:["gop_mode","uint32",0]}},CommonRsp:{$m:{1:["rsp_head","rtc.proto_switch_v3.RspHead",null]}},GatherInfo:{$m:{1:["gather_id","string",""]}},Header:{$m:{1:["cmd","uint32",0],2:["seq","uint32",0],3:["timestamp","int64",{low:0,high:0,unsigned:!1}],4:["controls","bytes",[]],5:["flags","bytes",[]],6:["context_key","uint32",0],101:["dev_traffic_label","bytes",[]]}},LiveroomProtoVersion:{$e:{PROTO_VERSION_NONE:0,RPOTO_V020000:131072}},LoginRoomReq:{$m:{1:["app_id","uint32",0],2:["biz_type","uint32",0],3:["room_id","bytes",[]],4:["room_name","bytes",[]],5:["role","uint32",0],6:["id_name","bytes",[]],7:["nick_name","bytes",[]],8:["device_id","string",""],9:["term_type","rtc.proto_switch_v3.TermType",0],10:["net_type","rtc.proto_switch_v3.NetType",0],11:["sdk_conn_type","rtc.proto_switch_v3.SdkConnType",0],12:["sdk_version","uint32",0],13:["biz_version","string",""],14:["client_stamp","bytes",[]],15:["login_logic","uint32",0],16:["third_token","bytes",[]],17:["login_token","bytes",[]],18:["relogin_token","bytes",[]],19:["switch_session_id","uint64",{low:0,high:0,unsigned:!0}],20:["user_session_id","uint64",{low:0,high:0,unsigned:!0}],21:["room_create_flag","uint32",0],22:["user_state_flag","uint32",0],23:["user_count_limit","uint32",0],24:["relate_service","string",""],25:["need_gather_stream","uint32",0],26:["callback_data","bytes",[]],27:["service_flags","uint32",0],28:["license_token","bytes",[]],29:["relogin_type","rtc.proto_switch_v3.ReloginType",0],30:["Capabilities","rtc.proto_switch_v3.Capabilities",null]}},LoginRoomRsp:{$m:{1:["rsp_head","rtc.proto_switch_v3.RspHead",null],2:["switch_session_id","uint64",{low:0,high:0,unsigned:!0}],3:["user_session_id","uint64",{low:0,high:0,unsigned:!0}],4:["room_session_id","uint64",{low:0,high:0,unsigned:!0}],5:["user_id","uint64",{low:0,high:0,unsigned:!0}],6:["ret_timestamp","int64",{low:0,high:0,unsigned:!1}],7:["big_im_time_window","uint32",0],8:["liveroom_hb_interval","uint32",0],9:["liveroom_hb_timeout","uint32",0],10:["online_count","uint32",0],11:["anchor_info","rtc.proto_switch_v3.AnchorInfo",null],12:["relogin_token","bytes",[]],13:["userlist_merge_timeout","uint32",0],14:["userlist_interval","uint32",0],15:["token_remain_time","uint32",0],16:["trans_list_seq","uint32",0],17:["trans_channel_list","<rtc.proto_switch_v3.TransChannel",null],18:["stream_count","uint32",0],19:["stream_list_seq","uint32",0],20:["stream_info_list","<rtc.proto_switch_v3.StreamInfo",null],21:["stream_fetch_flag","uint32",0],22:["stream_list_push_merge_timeout","uint32",0],23:["stream_list_hb_merge_timeout","uint32",0],24:["relate_result_list","<rtc.proto_switch_v3.RelateResult",null],25:["gather_list_seq","uint32",0],26:["gather_info_list","<rtc.proto_switch_v3.GatherInfo",null]}},LogoutRoomReq:{$m:{2:["logout_check","bytes",[]]}},LogoutRoomRsp:{$m:{1:["rsp_head","rtc.proto_switch_v3.RspHead",null]}},MergePushHead:{$m:{1:["qos_flag","uint32",0],2:["send_time","int64",{low:0,high:0,unsigned:!1}]}},MergePushInfo:{$m:{1:["sub_cmd","uint32",0],2:["sub_seq","uint32",0],3:["msg_body","bytes",[]]}},MergePushReq:{$m:{1:["head","rtc.proto_switch_v3.MergePushHead",null],2:["message_list","<rtc.proto_switch_v3.MergePushInfo",null]}},MergePushRsp:{$m:{1:["message_list","<rtc.proto_switch_v3.MergePushRspInfo",null],2:["server_send_time","int64",{low:0,high:0,unsigned:!1}]}},MergePushRspInfo:{$m:{1:["sub_cmd","uint32",0],2:["sub_seq","uint32",0]}},NetType:{$e:{NT_NONE:0,NT_LINE:1,NT_WIFI:2,NT_2G:3,NT_3G:4,NT_4G:5,NT_UNKNOWN:32}},PushKickout:{$m:{1:["reason","uint32",0],2:["message","string",""],3:["is_need_relogin","uint32",0]}},PushReq:{$m:{1:["head","rtc.proto_switch_v3.PushReqHead",null],2:["msg_body","bytes",[]]}},PushReqHead:{$m:{1:["sub_cmd","uint32",0],2:["qos_flag","uint32",0],3:["send_time","int64",{low:0,high:0,unsigned:!1}]}},PushRsp:{$m:{1:["code","uint32",0],2:["message","string",""],3:["sub_cmd","uint32",0],4:["server_send_time","int64",{low:0,high:0,unsigned:!1}]}},RelateResult:{$m:{1:["service","string",""],2:["relate_result","uint32",0]}},ReloginType:{$e:{ReloginType_None:0,ReloginType_SdkAuto:1}},RspHead:{$m:{1:["code","uint32",0],2:["message","string",""]}},SdkConnType:{$e:{SdkConnType_None:0,SdkConnType_Tcp:1,SdkConnType_Websocket:2}},StreamAttrOptions:{$m:{1:["stream_resource","sint32",0],2:["stream_codec","sint32",0],3:["play_mode","uint32",0],4:["forbid_play_expire_time","int64",{low:0,high:0,unsigned:!1}],5:["censor_flag","int32",0]}},StreamInfo:{$m:{1:["stream_id","bytes",[]],2:["stream_sid","string",""],3:["id_name","bytes",[]],4:["nick_name","bytes",[]],5:["create_time","int64",{low:0,high:0,unsigned:!1}],6:["extra_info","bytes",[]],7:["title","bytes",[]],8:["stream_ver","uint32",0],9:["stream_attr","bytes",[]],10:["stream_src","uint32",0],11:["stream_state","uint32",0],12:["stream_type","uint32",0],13:["stream_nid","uint32",0],14:["need_gather","uint32",0],16:["stream_attr_opts","rtc.proto_switch_v3.StreamAttrOptions",null],17:["sdk_custom","bytes",[]]}},TermType:{$e:{TT_NONE:0,TT_PC:1,TT_IOS:2,TT_ANDROID:3,TT_MAC:4,TT_LINUX:5,TT_WEB:6,TT_MINI_PROGRAM:7,TT_UNKNOWN:32}},TransChannel:{$m:{1:["trans_channel","bytes",[]],2:["trans_seq_list","<rtc.proto_switch_v3.TransSeq",null]}},TransSeq:{$m:{1:["trans_type","bytes",[]],2:["trans_seq","uint32",0]}}},webproxy:{HTTPHeader:{$m:{1:["name","string",""],2:["val","string",""]}},HTTPRequest:{$m:{1:["appid","uint32",0],2:["biz_type","uint32",0],3:["mode","rtc.webproxy.Mode",0],4:["id_name","string",""],5:["token","string",""],6:["url","string",""],7:["method","rtc.webproxy.Method",0],8:["headers","<rtc.webproxy.HTTPHeader",null],9:["body","bytes",[]]}},HTTPResponse:{$m:{1:["code","int32",0],2:["message","string",""],3:["data","rtc.webproxy.HTTPResponseData",null]}},HTTPResponseData:{$m:{1:["status_code","int32",0],2:["headers","<rtc.webproxy.HTTPHeader",null],3:["body","bytes",[]]}},IntranetCheckRequest:{$m:{1:["appid","uint32",0],2:["biz_type","uint32",0],3:["mode","rtc.webproxy.Mode",0],4:["id_name","string",""],5:["token","string",""],6:["vrs_ipv4","fixed32",0],7:["vrs_ipv6","rtc.webproxy.IPv6Addr",null]}},IntranetCheckResponse:{$m:{1:["code","int32",0],2:["message","string",""],3:["data","rtc.webproxy.IntranetCheckResponseData",null]}},IntranetCheckResponseData:{$m:{1:["intranet","bool",!1]}},IPv6Addr:{$m:{1:["high","fixed64",{low:0,high:0,unsigned:!1}],2:["low","fixed64",{low:0,high:0,unsigned:!1}]}},Method:{$e:{METHOD_UNSET:0,METHOD_GET:1,METHOD_POST:2,METHOD_PUT:3,METHOD_PATCH:4,METHOD_DELETE:5,METHOD_HEAD:6,METHOD_OPTIONS:7}},Mode:{$e:{MODE_UNSET:0,MODE_ONLINE:1,MODE_TEST:2}},TurnInfoRequest:{$m:{1:["appid","uint32",0],2:["biz_type","uint32",0],3:["mode","rtc.webproxy.Mode",0],4:["id_name","string",""],5:["token","string",""]}},TurnInfoResponse:{$m:{1:["code","int32",0],2:["message","string",""],3:["data","rtc.webproxy.TurnInfoResponseData",null]}},TurnInfoResponseData:{$m:{1:["username","string",""],2:["password","string",""],3:["turn_ipv4","fixed32",0],4:["turn_ipv6","rtc.webproxy.IPv6Addr",null],5:["turn_port","uint32",0],6:["expiration_in_seconds","uint32",0],7:["turn_internal_ipv4","fixed32",0]}},WssBindRequest:{$m:{1:["appid","uint32",0],2:["biz_type","uint32",0],3:["mode","rtc.webproxy.Mode",0],4:["id_name","string",""],5:["token","string",""],6:["url","string",""],7:["ack","bool",!1]}},WssBindRequestAck:{$m:{}},WssBindResponse:{$m:{1:["code","int32",0],2:["message","string",""]}}},webrtc_cmd:{ActivateAudioPlayStreamReq:{$m:{1:["seq","uint32",0],2:["active","sint32",0]}},ActivateAudioPlayStreamRsp:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},ActivateSEIInsertReq:{$m:{1:["seq","uint32",0],2:["action","sint32",0],3:["info_type","uint32",0]}},ActivateSEIInsertRsp:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},ActivateVideoPlayStreamReq:{$m:{1:["seq","uint32",0],2:["active","sint32",0],3:["layer","sint32",0]}},ActivateVideoPlayStreamRsp:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},BroadcasterStatusAck:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},BroadcasterStatusNotify:{$m:{1:["seq","uint32",0],2:["status","uint32",0]}},ClientInfoAck:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},ClientInfoPush:{$m:{1:["seq","uint32",0],2:["peer_id","uint32",0],3:["clientip","string",""]}},ClosePeerAck:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},ClosePeerPush:{$m:{1:["seq","uint32",0],2:["reason","sint32",0],3:["err_info","string",""]}},ClosePeerReq:{$m:{1:["seq","uint32",0],2:["reason","sint32",0]}},ClosePeerRsp:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},HeartBeatMsgSetAck:{$m:{1:["seq","uint32",0],2:["ts","int64",{low:0,high:0,unsigned:!1}],3:["result","sint32",0]}},HeartBeatMsgSetPush:{$m:{1:["seq","uint32",0],2:["ts","int64",{low:0,high:0,unsigned:!1}],3:["payloads","<rtc.webrtc_cmd.HeatbeatPayload",null]}},HeatbeatPayload:{$m:{1:["p2p_net_stat_rsp","rtc.webrtc_cmd.Peer2PeerNetStatsGetRsp",null],2:["play_net_stat","rtc.webrtc_cmd.PlayNetStatus",null],3:["play_stats_rsp","rtc.webrtc_cmd.PlayStatsRsp",null],4:["net_quality_push","rtc.webrtc_cmd.NetQualityGradePush",null],5:["pub_net_stat","rtc.webrtc_cmd.PublishNetStatus",null],6:["pub_quality_grade_rsp","rtc.webrtc_cmd.NetQualityGradeRsp",null],7:["stream_status_push","rtc.webrtc_cmd.StreamStatusNotify",null],8:["code_err_push","rtc.webrtc_cmd.MediaCodecErrorNotify",null],9:["play_event_push","rtc.webrtc_cmd.PlayEventPush",null],10:["pub_event_push","rtc.webrtc_cmd.PublishEventPush",null]}},MediaCodecErrorAck:{$m:{1:["result","sint32",0],2:["seq","uint32",0]}},MediaCodecErrorNotify:{$m:{1:["media_type","sint32",0],2:["error_type","sint32",0],3:["seq","uint32",0]}},NetQualityGradeAck:{$m:{1:["result","sint32",0],2:["seq","uint32",0]}},NetQualityGradePush:{$m:{1:["tx_quality","sint32",0],2:["rx_quality","sint32",0],3:["seq","uint32",0]}},NetQualityGradeReq:{$m:{1:["tx_quality","sint32",0],2:["rx_quality","sint32",0],3:["seq","uint32",0]}},NetQualityGradeRsp:{$m:{1:["result","sint32",0],2:["seq","uint32",0]}},NetQualityInfoAck:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},NetQualityInfoPush:{$m:{1:["seq","uint32",0],2:["lossrate","uint32",0],3:["rtt","uint32",0]}},NetQualityProbeReq:{$m:{1:["seq","uint32",0],2:["action","sint32",0]}},NetQualityProbeRsp:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},Peer2PeerNetStatsGetReq:{$m:{1:["seq","uint32",0]}},Peer2PeerNetStatsGetRsp:{$m:{1:["seq","uint32",0],2:["result","sint32",0],3:["p2p_lost_rate","uint32",0],4:["p2p_rtt","uint32",0]}},PeerExtendParamPush:{$m:{1:["turn_username","string",""],2:["turn_auth_key","string",""],3:["candidate","string",""],4:["sdpMid","string",""],5:["sdpMLineIndex","sint32",0],6:["turn_urls","string",""],7:["peer_id","uint32",0]}},PeerExtendParams:{$m:{1:["keyframe_intv","sint32",0],2:["min_play_buf_level_ms","sint32",0],3:["tc_type","sint32",0],4:["video_content_type","sint32",0],5:["sei_filter_pass","sint32",0],6:["client_class_type","sint32",0],7:["video_stream_type","sint32",0],8:["ktv_device_delay","sint32",0],9:["sync_ntp","sint32",0],10:["auto_switch_turn_type","sint32",0],11:["zg_proxy","sint32",0],12:["coturn_internal","uint32",0],13:["play_jitter_level","sint32",0],14:["tc_focuson_mode","sint32",0],15:["tc_min_video_kbps","sint32",0],16:["proto_flags","uint32",0],17:["req_poster_type","uint32",0],18:["enable_vid_clock_rate_est","sint32",0]}},PlayEventPush:{$m:{1:["seq","uint32",0],2:["event","sint32",0]}},PlayEventPushAck:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},PlayNetStatus:{$m:{1:["audio_tx_bitrate","sint32",0],2:["video_tx_bitrate","sint32",0],3:["video_red_rate","uint32",0],4:["traffic_control_stat","sint32",0],5:["traffic_control_bandwidth","sint32",0]}},PlayStatsReq:{$m:{1:["seq","uint32",0],2:["audio_jitter_ms","uint32",0]}},PlayStatsRsp:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},PublishEventAck:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},PublishEventPush:{$m:{1:["seq","uint32",0],2:["event","sint32",0]}},PublishNetStatus:{$m:{1:["video_recv_bitrate","sint32",0],2:["traffic_control_stat","sint32",0],3:["video_lost_rate","uint32",0],4:["audio_recv_bitrate","sint32",0],5:["audio_lost_rate","uint32",0]}},RestartICEReq:{$m:{1:["ice_ufrag","string",""],2:["ice_pwd","string",""],3:["seq","uint32",0]}},RestartICERsp:{$m:{1:["result","sint32",0],2:["seq","uint32",0]}},StreamPropertyUpdate:{$m:{1:["enable_stream_alignment_when_mix","sint32",0],2:["seq","uint32",0]}},StreamPropertyUpdateAck:{$m:{1:["result","sint32",0],2:["seq","uint32",0]}},StreamStatusAck:{$m:{1:["seq","uint32",0],2:["result","sint32",0]}},StreamStatusNotify:{$m:{1:["seq","uint32",0],2:["mic_status","sint32",0],3:["camera_status","sint32",0]}},UserUnregisteredSEIFilterReq:{$m:{1:["sei_filter","string",""],2:["seq","uint32",0]}},UserUnregisteredSEIFilterRsp:{$m:{1:["result","sint32",0],2:["seq","uint32",0]}},VideoStreamSubscribeReq:{$m:{1:["type","uint32",0],2:["seq","uint32",0]}},VideoStreamSubscribeRsp:{$m:{1:["result","sint32",0],2:["seq","uint32",0]}},WebrtcCmdReqMsg:{$m:{2:["video_stream_sub","rtc.webrtc_cmd.VideoStreamSubscribeReq",null],5:["usr_sei_filter","rtc.webrtc_cmd.UserUnregisteredSEIFilterReq",null],6:["net_quality_grade","rtc.webrtc_cmd.NetQualityGradeReq",null],7:["net_quality_grade_push","rtc.webrtc_cmd.NetQualityGradePush",null],8:["peer_extend_param","rtc.webrtc_cmd.PeerExtendParams",null],9:["stream_property_update","rtc.webrtc_cmd.StreamPropertyUpdate",null],10:["peer_ext_params_push","rtc.webrtc_cmd.PeerExtendParamPush",null],11:["codec_error_notify","rtc.webrtc_cmd.MediaCodecErrorNotify",null],13:["close_peer","rtc.webrtc_cmd.ClosePeerReq",null],15:["close_peer_push","rtc.webrtc_cmd.ClosePeerPush",null],16:["stream_status","rtc.webrtc_cmd.StreamStatusNotify",null],17:["broadcaster_status","rtc.webrtc_cmd.BroadcasterStatusNotify",null],18:["publish_event","rtc.webrtc_cmd.PublishEventPush",null],19:["play_event","rtc.webrtc_cmd.PlayEventPush",null],20:["active_audio_play","rtc.webrtc_cmd.ActivateAudioPlayStreamReq",null],21:["active_video_play","rtc.webrtc_cmd.ActivateVideoPlayStreamReq",null],22:["client_info","rtc.webrtc_cmd.ClientInfoPush",null],23:["net_quality_probe","rtc.webrtc_cmd.NetQualityProbeReq",null],24:["net_quality_push","rtc.webrtc_cmd.NetQualityInfoPush",null],25:["active_sei_insert","rtc.webrtc_cmd.ActivateSEIInsertReq",null],26:["p2p_net_stats_get","rtc.webrtc_cmd.Peer2PeerNetStatsGetReq",null],27:["play_stats","rtc.webrtc_cmd.PlayStatsReq",null],28:["restart_ice","rtc.webrtc_cmd.RestartICEReq",null],29:["heartbeat_msg_push","rtc.webrtc_cmd.HeartBeatMsgSetPush",null]}},WebrtcCmdRspMsg:{$m:{2:["video_stream_sub","rtc.webrtc_cmd.VideoStreamSubscribeRsp",null],5:["usr_sei_filter","rtc.webrtc_cmd.UserUnregisteredSEIFilterRsp",null],6:["net_quality_grade","rtc.webrtc_cmd.NetQualityGradeRsp",null],7:["net_quality_grade_ack","rtc.webrtc_cmd.NetQualityGradeAck",null],8:["stream_property_update_ack","rtc.webrtc_cmd.StreamPropertyUpdateAck",null],9:["codec_error_notify_ack","rtc.webrtc_cmd.MediaCodecErrorAck",null],11:["close_peer","rtc.webrtc_cmd.ClosePeerRsp",null],13:["close_peer_ack","rtc.webrtc_cmd.ClosePeerAck",null],14:["stream_status_ack","rtc.webrtc_cmd.StreamStatusAck",null],15:["broadcaster_status_ack","rtc.webrtc_cmd.BroadcasterStatusAck",null],16:["active_audio_play","rtc.webrtc_cmd.ActivateAudioPlayStreamRsp",null],17:["active_video_play","rtc.webrtc_cmd.ActivateVideoPlayStreamRsp",null],18:["client_info_ack","rtc.webrtc_cmd.ClientInfoAck",null],19:["net_quality_probe","rtc.webrtc_cmd.NetQualityProbeRsp",null],20:["net_quality_ack","rtc.webrtc_cmd.NetQualityInfoAck",null],21:["active_sei_insert","rtc.webrtc_cmd.ActivateSEIInsertRsp",null],22:["p2p_net_stats_get","rtc.webrtc_cmd.Peer2PeerNetStatsGetRsp",null],23:["publish_event_ack","rtc.webrtc_cmd.PublishEventAck",null],24:["play_stats","rtc.webrtc_cmd.PlayStatsRsp",null],25:["restart_ice","rtc.webrtc_cmd.RestartICERsp",null],26:["play_event_ack","rtc.webrtc_cmd.PlayEventPushAck",null],27:["heartbeat_msg_ack","rtc.webrtc_cmd.HeartBeatMsgSetAck",null]}}},webrtc_proto_v2:{ActivateAudioPlayStreamReq:{$m:{1:["active","sint32",0]}},ActivateAudioPlayStreamRsp:{$m:{1:["result","sint32",0]}},ActivateSEIInsertReq:{$m:{1:["peer_id","uint32",0],2:["action","sint32",0],3:["info_type","uint32",0]}},ActivateSEIInsertRsp:{$m:{1:["peer_id","uint32",0],2:["result","sint32",0]}},ActivateVideoPlayStreamReq:{$m:{1:["active","sint32",0],2:["layer","sint32",0]}},ActivateVideoPlayStreamRsp:{$m:{1:["result","sint32",0]}},BroadcasterStatusAck:{$m:{1:["result","sint32",0]}},BroadcasterStatusNotify:{$m:{1:["status","uint32",0]}},CandidateInfoAck:{$m:{1:["result","sint32",0]}},CandidateInfoPush:{$m:{1:["infos","<rtc.webrtc_proto_v2.OneCandidateInfo",null]}},CandidateInfoReq:{$m:{1:["infos","<rtc.webrtc_proto_v2.OneCandidateInfo",null]}},CandidateInfoRsp:{$m:{1:["result","sint32",0]}},ClientInfoAck:{$m:{1:["result","sint32",0]}},ClientInfoPush:{$m:{1:["peer_id","uint32",0],2:["client_ip","string",""]}},CloseSessionAck:{$m:{1:["result","sint32",0]}},CloseSessionPush:{$m:{1:["reason","sint32",0],2:["err_info","string",""]}},CloseSessionReq:{$m:{1:["reason","sint32",0]}},CloseSessionRsp:{$m:{1:["result","sint32",0]}},CmdAck:{$m:{1:["peer_id","uint32",0],2:["cmd_id","uint32",0],3:["body","bytes",[]]}},CmdPush:{$m:{1:["peer_id","uint32",0],2:["cmd_id","uint32",0],3:["body","bytes",[]]}},CmdReq:{$m:{1:["peer_id","uint32",0],2:["cmd_id","uint32",0],3:["body","bytes",[]]}},CmdRsp:{$m:{1:["peer_id","uint32",0],2:["cmd_id","uint32",0],3:["body","bytes",[]]}},CmdType:{$e:{NONE:0,LOGIN_REQ:1,LOGIN_RSP:2,CREATE_SESSION_REQ:3,CREATE_SESSION_RSP:4,CREATE_SESSION_WITH_SDP_REQ:5,CREATE_SESSION_WITH_SDP_RSP:6,SESSION_RESET_PUSH:7,SESSION_RESET_ACK:8,PUBLISH_EVENT_PUSH:9,PLAY_EVENT_PUSH:10,MEDIA_DESC_REQ:11,MEDIA_DESC_RSP:12,CANDIDATE_INFO_REQ:13,CANDIDATE_INFO_RSP:14,CLOSE_SESSION_REQ:15,CLOSE_SESSION_RSP:16,MEDIA_DESC_PUSH:17,MEDIA_DESC_ACK:18,CANDIDATE_INFO_PUSH:19,CANDIDATE_INFO_ACK:20,CLOSE_SESSION_PUSH:21,CLOSE_SESSION_ACK:22,STREAM_STATUS_NOTIFY:23,STREAM_STATUS_NOTIFY_ACK:24,STREAM_STATUS_NOTIFY_PUSH:25,STREAM_STATUS_NOTIFY_PUSH_ACK:26,BROADCASTER_STATUS_NOTIFY:27,BROADCASTER_STATUS_ACK:28,ACTIVATE_AUDIO_PLAY_STREAM_REQ:29,ACTIVATE_AUDIO_PLAY_STREAM_RSP:30,ACTIVATE_VIDEO_PLAY_STREAM_REQ:31,ACTIVATE_VIDEO_PLAY_STREAM_RSP:32,CLIENT_INFO_PUSH:33,CLIENT_INFO_ACK:34,NET_QUALITY_PROBE_REQ:35,NET_QUALITY_PROBE_RSP:36,NET_QUALITY_INFO_PUSH:37,NET_QUALITY_INFO_ACK:38,ACTIVATE_SEI_INSERT_REQ:39,ACTIVATE_SEI_INSERT_RSP:40,PEER2_PEER_NET_STATS_GET_REQ:41,PEER2_PEER_NET_STATS_GET_RSP:42,CMD_REQ:43,CMD_RSP:44,CMD_PUSH:45,CMD_ACK:46,WEBRTC_DISPATCH_REQ:47,WEBRTC_DISPATCH_RSP:48}},CreateSessionReq:{$m:{1:["type","sint32",0],2:["stream_id","string",""],3:["turn_server_host","string",""],4:["roomid","string",""],5:["strAuthParam","string",""],6:["params","string",""],7:["area_type","int32",0],8:["area_id_list","<int32",null],9:["ipv6_prefer","int32",0],10:["trans_codec_id","int32",0],11:["trans_codec_suffix","string",""]}},CreateSessionRsp:{$m:{1:["result","sint32",0],2:["turn_server","string",""],3:["turn_username","string",""],4:["turn_auth_key","string",""],5:["session_id","uint32",0],6:["session_token","string",""],7:["gw_version","uint32",0],8:["gw_nodes","<string",null],9:["gw_nodes_ttl","uint32",0],10:["client_ip","string",""],11:["ips","<rtc.webrtc_proto_v2.IpResult",null],12:["ipv6s","<rtc.webrtc_proto_v2.IpResult",null],13:["peer_id","uint32",0],14:["trans_codec_suffix","string",""]}},CreateSessionWithSdpReq:{$m:{1:["type","sint32",0],2:["stream_id","string",""],3:["sdp","string",""],4:["mini_sdp","bytes",[]],5:["media_server_host","string",""],6:["strAuthParam","string",""],7:["roomid","string",""],8:["params","string",""],9:["params_ext","bytes",[]],10:["area_type","int32",0],11:["area_id_list","<int32",null],12:["ipv6_prefer","int32",0],13:["trans_codec_id","int32",0],14:["trans_codec_suffix","string",""]}},CreateSessionWithSdpRsp:{$m:{1:["result","sint32",0],2:["gw_version","uint32",0],3:["sdp","string",""],4:["mini_sdp","bytes",[]],5:["session_token","string",""],6:["gw_nodes","<string",null],7:["gw_nodes_ttl","uint32",0],8:["client_ip","string",""],9:["params_ext","bytes",[]],10:["ips","<rtc.webrtc_proto_v2.IpResult",null],11:["ipv6s","<rtc.webrtc_proto_v2.IpResult",null],12:["peer_id","uint32",0],13:["trans_codec_suffix","string",""]}},DenyInfo:{$m:{1:["action","uint32",0],2:["err","uint32",0],3:["ins","<rtc.webrtc_proto_v2.IpPort",null],4:["action_delay","uint32",0]}},Head:{$m:{1:["cmd","uint32",0],2:["seq","uint32",0],3:["session_id","uint32",0]}},IpPort:{$m:{1:["Ip","string",""],2:["Port","uint32",0]}},IpResult:{$m:{1:["ip","string",""],2:["port","uint32",0],3:["isbgp","int32",0],4:["idcid","uint32",0],5:["tcp_port","uint32",0],6:["idc_code","string",""],7:["flag","uint32",0],8:["priority","int64",{low:0,high:0,unsigned:!1}],9:["mask","uint32",0],10:["vid","string",""]}},LoginReq:{$m:{1:["appid","uint32",0],2:["user_id","string",""],3:["tokenType","int32",0],4:["token","string",""],5:["sessions","<rtc.webrtc_proto_v2.SessionInfo",null],6:["roomid","string",""],7:["sdk_version","uint32",0],8:["app","string",""],9:["net_mode","int32",0]}},LoginRsp:{$m:{1:["result","int32",0],2:["tokenType","int32",0],3:["token","string",""]}},MediaDescReq:{$m:{1:["type","uint32",0],2:["update","uint32",0],3:["sdp","string",""],4:["mini_sdp","bytes",[]],5:["params_ext","bytes",[]]}},MediaDescRsp:{$m:{1:["result","sint32",0],2:["sdp","string",""],3:["mini_sdp","bytes",[]]}},NetQualityInfoAck:{$m:{1:["peer_id","uint32",0],2:["result","sint32",0]}},NetQualityInfoPush:{$m:{1:["peer_id","uint32",0],2:["lossrate","uint32",0],3:["rtt","uint32",0]}},NetQualityProbeReq:{$m:{1:["peer_id","uint32",0],2:["action","sint32",0]}},NetQualityProbeRsp:{$m:{1:["peer_id","uint32",0],2:["result","sint32",0]}},OneCandidateInfo:{$m:{1:["candidate","string",""],2:["sdpMid","string",""],3:["sdpMLineIndex","sint32",0]}},Peer2PeerNetStatsGetReq:{$m:{1:["peer_id","uint32",0]}},Peer2PeerNetStatsGetRsp:{$m:{1:["result","sint32",0],2:["peer_id","uint32",0],3:["p2p_lost_rate","uint32",0],4:["p2p_rtt","uint32",0]}},PlayEventPush:{$m:{1:["event","sint32",0]}},PublishEventPush:{$m:{1:["event","sint32",0]}},SessionInfo:{$m:{1:["session_id","uint32",0],2:["session_token","string",""]}},SessionResetAck:{$m:{1:["result","sint32",0]}},SessionResetPush:{$m:{1:["dwTimeStamp","uint32",0],2:["cResetType","uint32",0],3:["session_ids","<uint32",null],4:["reason","sint32",0]}},StreamStatusNotify:{$m:{1:["mic_status","sint32",0],2:["camera_status","sint32",0]}},StreamStatusNotifyAck:{$m:{1:["result","sint32",0]}},StreamStatusNotifyPush:{$m:{1:["mic_status","sint32",0],2:["camera_status","sint32",0]}},StreamStatusNotifyPushAck:{$m:{1:["result","sint32",0]}},WebRTCDispatchReq:{$m:{1:["type","sint32",0],2:["stream_id","string",""],10:["area_type","int32",0],11:["area_id_list","<int32",null],12:["ipv6_prefer","int32",0],13:["trans_codec_id","int32",0],14:["trans_codec_suffix","string",""]}},WebRTCDispatchRsp:{$m:{1:["gw_nodes","<string",null],2:["gw_nodes_ttl","uint32",0],3:["client_ip","string",""],4:["result","sint32",0],5:["ips","<rtc.webrtc_proto_v2.IpResult",null],6:["ipv6s","<rtc.webrtc_proto_v2.IpResult",null]}}}}},"",io,!1);var Rs,oo=io.rtc,La=function(){return La=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},La.apply(this,arguments)},ta=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},gu=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},xo=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))};(function(o){o[o.CONNECTING=0]="CONNECTING",o[o.OPEN=1]="OPEN",o[o.CLOSING=2]="CLOSING",o[o.CLOSED=3]="CLOSED"})(Rs||(Rs={}));var Sl=0,Qo=function(){function o(e,t,n){this.servers=e,this.params=t,this.activeServer=n,this.isConnecting=!1,this._binaryType="blob",this.eventMap={},this.url="",this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,this.id=Sl++,this.open()}return Object.defineProperty(o.prototype,"binaryType",{get:function(){return this._binaryType},set:function(e){this._binaryType=e},enumerable:!1,configurable:!0}),o.prototype.addEventListener=function(e,t,n){var r,i;this.eventMap[e]?(r=this.eventMap[e])===null||r===void 0||r.push(t):this.eventMap[e]=[t],e==="open"||(i=this.socket)===null||i===void 0||i.addEventListener(e,t,n)},o.prototype.removeEventListener=function(e,t,n){var r;this.eventMap[e]=(this.eventMap[e]||[]).filter(function(i){return i!==t}),e==="open"||(r=this.socket)===null||r===void 0||r.removeEventListener(e,t,n)},o.prototype.dispatchEvent=function(e){throw new Error("Method not implemented.")},Object.defineProperty(o.prototype,"readyState",{get:function(){var e;return this.isConnecting?Rs.CONNECTING:((e=this==null?void 0:this.socket)===null||e===void 0?void 0:e.readyState)||Rs.CLOSED},enumerable:!1,configurable:!0}),o.prototype.createSocket=function(){return ta(this,void 0,void 0,function(){var e,t,n,r,i,s=this;return gu(this,function(c){switch(c.label){case 0:if(this.socket&&this.socket.readyState!==Rs.CLOSED)return[2];e=null,t=this.activeServer?xo([this.activeServer],this.servers,!0):this.servers,n=function(u){var l,a,h;return gu(this,function(m){switch(m.label){case 0:a="wss://".concat(l=t[u],"/proxy/ws"),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,new Promise(function(S,x){var q=new WebSocket(a);Object.keys(s.eventMap).forEach(function(_e){_e!=="open"&&(s.eventMap[_e]||[]).forEach(function(ke){q.addEventListener(_e,ke)})}),q.binaryType="arraybuffer",q.onclose=function(_e){s.onclose&&s.onclose(_e)},q.onerror=function(_e){s.onerror&&s.onerror(_e),x(_e)};var V=0;q.onmessage=function(_e){V++;var ke=_e.data;if(V!==1)if(V===2){var Pe=oo.webproxy.WssBindResponse.decode(new Uint8Array(ke));if(Pe.code!==0)throw"zm.prx.1"+" cloud proxy token auth failed. result: ".concat(JSON.stringify(Pe));s.isConnecting=!1,(s.eventMap.open||[]).forEach(function(Oe){Oe(s,_e)}),s.onopen&&s.onopen()}else s.onmessage&&s.onmessage(_e)},q.onopen=function(_e){s.socket=q,S(_e),s.authProxy(q)}})];case 2:return m.sent(),[3,4];case 3:return h=m.sent(),e=h,[2,"continue"];case 4:return r.onActiveServer&&(r.onActiveServer(l),r.onActiveServer=void 0),r.url=a,[2,"break"]}})},r=this,i=0,c.label=1;case 1:return i<t.length?[5,n(i)]:[3,4];case 2:if(c.sent()==="break")return[3,4];c.label=3;case 3:return i++,[3,1];case 4:return this.socket||setTimeout(function(){throw e},0),[2]}})})},o.prototype.authProxy=function(e){var t=this.socket;if(t){var n=this.params,r=oo.webproxy.WssBindRequest.encode({appid:n.appid,biz_type:0,mode:1,id_name:n.userID,token:n.token,url:n.target,ack:!0}).finish();t.send(r)}},o.prototype.setParams=function(e){this.params=La(La({},this.params),e)},o.prototype.open=function(){this.isConnecting=!0,this.readyState!==Rs.CLOSED&&this.createSocket()},o.prototype.close=function(){var e;(e=this.socket)===null||e===void 0||e.close()},o.prototype.send=function(e){var t;(t=this.socket)===null||t===void 0||t.send(e)},o.prototype.onopen=function(){},o.prototype.onclose=function(e){},o.prototype.onerror=function(e){},o.prototype.onmessage=function(e){},Object.defineProperty(o.prototype,"bufferedAmount",{get:function(){var e;return((e=this.socket)===null||e===void 0?void 0:e.bufferedAmount)||0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"extensions",{get:function(){var e;return((e=this.socket)===null||e===void 0?void 0:e.extensions)||""},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"protocol",{get:function(){var e;return((e=this.socket)===null||e===void 0?void 0:e.protocol)||""},enumerable:!1,configurable:!0}),o}(),Jo=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Ko=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Ma=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))},Bo=oo.webproxy;function yu(o){for(var e=0,t=0;t<o.length;t++)e+=o[t].length;var n=new Uint8Array(e),r=0;for(t=0;t<o.length;t++)n.set(o[t],r),r+=o[t].length;return n}function Yo(o,e){return Jo(this,void 0,void 0,function(){var t,n,r,i,s,c;return Ko(this,function(u){switch(u.label){case 0:t=new Uint8Array,n=[],r=Array.from(o),i=function(l){var a,h;return Ko(this,function(m){switch(m.label){case 0:return a=r[l][0],h=r[l][1],n.push("--"+e),h instanceof Blob?[4,new Promise(function(S){var x=new FileReader;x.onloadend=function(){var q=x.result;if(q){n.push('Content-Disposition: form-data; name="'+a+'"; filename="'+((h==null?void 0:h.name)||"blob")+'"',"Content-Type: "+h.type,`\r
`);var V=ar(n.join(`\r
`));n=[];var _e=new Uint8Array(q);t=yu([t,V,_e]),S(0)}else S(0)},x.readAsArrayBuffer(h)})]:[3,2];case 1:return m.sent(),[3,3];case 2:n.push('Content-Disposition: form-data; name="'+a+'"',"",h),m.label=3;case 3:return[2]}})},s=0,u.label=1;case 1:return s<r.length?[5,i(s)]:[3,4];case 2:u.sent(),u.label=3;case 3:return s++,[3,1];case 4:return n.push("--"+e+"--"),c=ar(n.join(`\r
`)),n=[],[2,t=yu([t,c])]}})})}function Tl(o){return Jo(this,void 0,void 0,function(){var e,t,n;return Ko(this,function(r){switch(r.label){case 0:for(e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="----WebKitFormBoundary",n=0;n<16;n++)t+=e.charAt(Math.floor(62*Math.random()));return[4,Yo(o,t)];case 1:return[2,{body:r.sent(),contentType:"multipart/form-data; boundary="+t}]}})})}var bu,_u=function(){function o(e,t){this.proxyList=e,this.token=t,this.enable=!1,this.appID=0,this.userID="web_proxy_"+Date.now()}return Object.defineProperty(o.prototype,"urls",{get:function(){return this.proxyList.map(function(e){var t=e.port;return"".concat(e.hostName).concat(t?":"+t:"")})},enumerable:!1,configurable:!0}),o.prototype.bo=function(e){this.activeServer&&this.activeServer===e||(this.activeServer=e,this.turnInfo=void 0,this.turnExpireTime=void 0)},o.prototype.destroy=function(){this.proxyList=[]},o.prototype.init=function(e){this.appID=e.appID},o.prototype.createSocket=function(e,t){var n=this;if(!this.appID)throw"zego cloud proxy config error. can not init proxy.";var r=new Qo(this.urls,{target:e,appid:this.appID,token:this.token,userID:this.userID},this.activeServer);return r.onActiveServer=function(i){n.bo(i)},r},o.prototype.getTurnInfo=function(){var e;return Jo(this,void 0,void 0,function(){var t,n,r;return Ko(this,function(i){switch(i.label){case 0:return this.turnExpireTime&&this.turnInfo&&Date.now()<this.turnExpireTime?[2,this.turnInfo]:(this.turnExpireTime=void 0,this.turnInfo=void 0,t=Bo.TurnInfoRequest.encode({appid:this.appID,biz_type:0,mode:1,id_name:this.userID,token:this.token}).finish(),[4,this.handleFetch("/turn/info",t)]);case 1:return n=i.sent(),(r=Bo.TurnInfoResponse.decode(new Uint8Array(n))).code||(this.turnInfo=r,this.turnExpireTime=Date.now()+.8*(((e=r==null?void 0:r.data)===null||e===void 0?void 0:e.expiration_in_seconds)||0)*1e3),[2,r]}})})},o.prototype.handleFetch=function(e,t){return e===void 0&&(e="/"),Jo(this,void 0,void 0,function(){var n,r,i,s,c,u,l;return Ko(this,function(a){switch(a.label){case 0:n=null,r=null,i=this.activeServer?Ma([this.activeServer],this.urls,!0):this.urls,s=0,a.label=1;case 1:if(!(s<i.length))return[3,7];u="https://".concat(c=i[s]).concat(e),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,fetch(u,{method:"post",body:t})];case 3:return n=a.sent(),this.bo(c),[3,5];case 4:return l=a.sent(),r=l,[3,6];case 5:return[3,7];case 6:return s++,[3,1];case 7:if(r)throw r;return[4,n==null?void 0:n.arrayBuffer()];case 8:return[2,a.sent()||[]]}})})},o.prototype.intranetCheck=function(e,t){return Jo(this,void 0,void 0,function(){var n,r;return Ko(this,function(i){switch(i.label){case 0:return n=Bo.IntranetCheckRequest.encode({appid:this.appID,biz_type:0,mode:1,id_name:this.userID,token:this.token,vrs_ipv4:e,vrs_ipv6:t}).finish(),[4,this.handleFetch("/intranet/check",n)];case 1:return r=i.sent(),[2,Bo.IntranetCheckResponse.decode(new Uint8Array(r))]}})})},o.prototype.startHttpRequest=function(e,t,n,r){var i=this,s=!1;((r==null?void 0:r.timeout)||0)>0&&setTimeout(function(){s||(s=!0,n&&n({status_code:-1,headers:[],body:ar("request time out.")}))},r==null?void 0:r.timeout),new Promise(function(c,u){return Jo(i,void 0,void 0,function(){var l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je,tt;return Ko(this,function(ut){switch(ut.label){case 0:return(l=(tt=e.headers)===null||tt===void 0?void 0:tt.find(function(vt){return vt.name.toLowerCase()==="content-type"&&vt.val.toLowerCase().includes("multipart/form-data")}))&&e.body instanceof FormData?[4,Tl(e.body)]:[3,2];case 1:a=ut.sent(),h=a.contentType,e.body=a.body,l.val=h,ut.label=2;case 2:m=e.body,typeof e.body=="string"&&(m=ar(e.body)),S=Bo.HTTPRequest.encode({appid:this.appID,biz_type:0,mode:1,id_name:this.userID,url:e.location,token:this.token,method:e.method_no,headers:e.headers,body:m}).finish(),x=null,q=null,V=this.activeServer?Ma([this.activeServer],this.urls,!0):this.urls,_e=0,ut.label=3;case 3:if(!(_e<V.length))return[3,9];ke="https://".concat(V[_e],"/proxy/http"),ut.label=4;case 4:return ut.trys.push([4,6,,7]),[4,fetch(ke,{method:"post",body:S})];case 5:return x=ut.sent(),q=null,[3,7];case 6:return Pe=ut.sent(),q=Pe,[3,8];case 7:return[3,9];case 8:return _e++,[3,3];case 9:return q?(u({status_code:-1,headers:[],body:ar(JSON.stringify(q))}),[2]):[4,x==null?void 0:x.arrayBuffer()];case 10:if(Oe=ut.sent()||[],Ge=Bo.HTTPResponse.decode(new Uint8Array(Oe)),Je=Ge==null?void 0:Ge.data,(Ge==null?void 0:Ge.code)===0&&Je){if(!e.origin)try{Je.body=JSON.parse(Lo(Je.body))}catch{Je.body=Lo(Je.body)}c(Je)}else u({status_code:-1,headers:[],body:JSON.parse(Lo(Je.body))});return[2]}})})}).then(function(c){!s&&t&&(s=!0,t(c))}).catch(function(c){!s&&n&&(s=!0,n&&n({status_code:-1,headers:[],body:ar(JSON.stringify(c))}))})},o}(),Uo=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},El=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}};(function(o){o[o.Accesshub=0]="Accesshub",o[o.Logger=1]="Logger",o[o.Detaillog=2]="Detaillog"})(bu||(bu={}));var Su,br,Di,Sc=function(){function o(e){this._o=e}return o.prototype.init=function(e){},o.prototype.createSocket=function(e,t){try{return new WebSocket(this.wo(e,t))}catch(n){throw console.error(n),n}},o.prototype.wo=function(e,t){var n=this;return e.replace(/^(https?:\/\/|wss?:\/\/)([\w.-]+)(?::(\d+))?/,function(r,i,s,c){var u="";if(n._o){var l=n._o,a=l.accesshubProxy,h=l.loggerProxy,m=l.detaillogProxy;switch(t){case 0:a&&(u=i+a);break;case 1:h&&(u=i+h);break;case 2:m&&(u=i+m)}}return u?(u.endsWith("/")&&(u=u.substring(0,u.length-1)),u):r})},o.prototype.startHttpRequest=function(e,t,n,r){var i=this,s=!1;((r==null?void 0:r.timeout)||0)>0&&setTimeout(function(){s||(s=!0,n&&n({status_code:-1,headers:[],body:ar("request time out.")}))},r==null?void 0:r.timeout),new Promise(function(c,u){return Uo(i,void 0,void 0,function(){var l,a,h,m,S,x;return El(this,function(q){switch(q.label){case 0:l=e.body,a=null,h=null,m=this.wo(e.location,e.serviceType),q.label=1;case 1:return q.trys.push([1,3,,4]),[4,fetch(m,{method:e.method_no===1?"get":"post",body:l})];case 2:return a=q.sent(),h=null,[3,4];case 3:return S=q.sent(),h=S,[3,4];case 4:return h?(u({status_code:-1,headers:[],body:ar(JSON.stringify(h))}),[2]):[4,a==null?void 0:a.json()];case 5:return x=q.sent(),a?c({status_code:(a==null?void 0:a.status)||-1,body:x,headers:[]}):u({status_code:-1,headers:[],body:ar("request failed.")}),[2]}})})}).then(function(c){!s&&t&&(s=!0,t(c))}).catch(function(c){!s&&n&&(s=!0,n&&n({status_code:-1,headers:[],body:ar(JSON.stringify(c))}))})},o.prototype.destroy=function(){},o}(),Oi=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))},Cl=["relogin_token"],zo=["id_name","nick_name"],ho=Oi(Oi(["stream_id"],zo,!0),["extra_info","title","stream_attr","stream_title"],!1),Tc=["trans_type"],po=["trans_channel"],ks=Oi([],zo,!0),Ps=["msg_id","msg_client_id"],wl=Oi(["trans_type"],po,!0),Ii=Oi([],po,!0),jr=Oi(["trans_type","trans_data"],zo,!0),Tu=Oi([],po,!0),xa=Oi([],jr,!0),Ec=["stop_stream_id_list"],Eu=Oi([],zo,!0),Il=["id_name","custom_reason"],Cc=["stream_id_list"],Vo=["sender_idname","sender_nickname"],wc=Oi([],ho,!0),Ic=Oi(Oi([],zo,!0),["msg_content"],!1),Rc=Oi(Oi([],zo,!0),["msg_id","msg_content"],!1),As=Oi(Oi([],zo,!0),["trans_type","trans_data","trans_channel"],!1),Cu=Oi(Oi([],zo,!0),po,!0),Ba=["trans_type","trans_data"],na=["sender_idname","sender_nickname","msg_content"],Ds=[[1001,"LoginRoomReq"],[1002,"LoginRoomRsp"],[1003,"LogoutRoomReq"],[1004,"LogoutRoomRsp"],[1101,"PushReq"],[1102,"PushRsp"],[1103,"MergePushReq"],[1104,"MergePushRsp"],[1105,"PushKickout"],[10001,"PushUserInfoUpdated"],[10002,"PushUserKickout"],[10003,"PushUserLogReport"],[10004,"PushUserTokenExpire"],[11005,"PushSignalCustom"],[11001,"PushJoinliveRequest"],[11002,"PushJoinliveResult"],[11003,"PushJoinliveInvite"],[11004,"PushJoinliveStop"],[11007,"PushTransparentMsg"],[11008,"PushChannelMsg"],[12001,"PushStreamAdd"],[12002,"PushStreamDelete"],[12003,"PushStreamUpdate"],[13001,"PushIm"],[14001,"PushBigIm"],[15001,"PushTrans"],[15002,"PushUserTrans"],[301001,"EnterRoomReq"],[301002,"EnterRoomRsp"],[301003,"QuitRoomReq"],[301004,"QuitRoomRsp"],[301005,"HbReq"],[301006,"HbRsp"],[301007,"RenewTokenReq"],[301008,"RenewTokenRsp"],[301009,"SetUserAttrReq"],[301010,"SetUserAttrRsp"],[301011,"SetTransReq"],[301012,"SetTransRsp"],[301013,"GetTransReq"],[301014,"GetTransRsp"],[301015,"GetUserTransReq"],[301016,"GetUserTransRsp"],[302001,"AddStreamReq"],[302002,"AddStreamRsp"],[302003,"DeleteStreamReq"],[302004,"DeleteStreamRsp"],[302005,"UpdateStreamReq"],[302006,"UpdateStreamRsp"],[302007,"GetStreamListReq"],[302008,"GetStreamListRsp"],[303001,"SendImReq"],[303002,"SendImRsp"],[303003,"GetImReq"],[303004,"GetImRsp"],[303005,"SendBigImReq"],[303006,"SendBigImRsp"],[303009,"SignalLiveRequestReq"],[303010,"SignalLiveRequestRsp"],[303011,"SignalLiveResultReq"],[303012,"SignalLiveResultRsp"],[303013,"SignalLiveInviteReq"],[303014,"SignalLiveInviteRsp"],[303015,"SignalLiveStopReq"],[303016,"SignalLiveStopRsp"],[303017,"SignalLiveCustomReq"],[303018,"SignalLiveCustomRsp"],[303019,"SignalTransmitReq"],[303020,"SignalTransmitRsp"],[303021,"SignalTransparentMsgReq"],[303022,"SignalTransparentMsgRsp"],[303023,"SendChannelMsgReq"],[303024,"SendChannelMsgRsp"],[304001,"GetUserlistReq"],[304002,"GetUserlistRsp"]],ra=Ds.reduce(function(o,e){var t=e[0];return o[t]=[12001,12002,12003].includes(t)?"PushStream":e[1],o},{}),Xn=Ds.reduce(function(o,e){return o[e[1]]=e[0],o},{}),wu=pt(3788),Rl=pt(6440),kl=pt.n(Rl),Iu=pt(4636),Ua=pt.n(Iu),Pl=function(){function o(){}return o.prototype.md5Bytes=function(e){return this.wordArray2Uint8Array(Ua()(this.uint8Array2WordArray(e)))},o.prototype.wordArray2Uint8Array=function(e){for(var t=e.words,n=e.sigBytes,r=new Uint8Array(n),i=0;i<n;i++)r[i]=t[i>>>2]>>>24-i%4*8&255;return r},o.prototype.uint8Array2WordArray=function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e[r])<<24-r%4*8;return kl().create(n,t)},o}(),Ri=function(){return Ri=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},Ri.apply(this,arguments)},kc=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))};wu.util.Long=di.A,wu.configure(),Su=oo,br=oo.liveroom_cs_v3,Di=oo.proto_switch_v3;var xr,hi=1001,Al=1002,Ru=1003,za=1004;(function(o){o[o.disconnected=0]="disconnected",o[o.broken=1]="broken",o[o.connected=2]="connected"})(xr||(xr={}));var ia=function(){function o(e,t,n,r,i){var s,c,u,l,a,h,m,S,x=this;this.an=e,this.pn=t,this._ua=n,this._dataReport=r,this.rtm=i,this.seq=0,this.So={},this.Eo="",this.zPushSid="0",this.ko=[["user_session_id","session_id"],["liveroom_hb_interval","hearbeat_interval"],["liveroom_hb_timeout","hearbeat_timeout"],["big_im_time_window","bigim_time_window"],["trans_channel_list","trans_seqs"],["stream_list_seq","stream_seq"],["stream_info_list","stream_info"]],this.Oo=100,this.Ro=1e4,this.To=2e3,this.Co=Su,this.Ao={},this.zo={},this.Do={},this.No=[Xn.PushReq,Xn.MergePushReq,Xn.PushKickout],this.Po=[Xn.LoginRoomRsp,Xn.LogoutRoomRsp,Xn.PushKickout,Xn.PushReq,Xn.MergePushReq],this.xo=[1105],this.jo=xr.disconnected,this.qo=[11001,11002,11003,11004],this.Lo="",this.Bo=new Pl,this.Uo=this._ua.getPCRequest(Jn.BusinessService.SERVICE_SWITCH4LIVEROOM),this.switchSessionID=di.A.fromInt(0),(s=this.Uo)===null||s===void 0||s.on("connected",function(q){x.Go(q)}),(c=this.Uo)===null||c===void 0||c.on("broken",function(q){x.Jo()}),(u=this.Uo)===null||u===void 0||u.on("disconnected",function(q,V){x.Fo(q,V)}),(l=this.Uo)===null||l===void 0||l.on("downLoadMessage",function(q,V){x.handlePush(q,V)}),(a=this.Uo)===null||a===void 0||a.on("exception",function(q,V){x.an.info("zm.lrh.o.0 except "+JSON.stringify(q))}),(h=this.Uo)===null||h===void 0||h.on("pcBrokenEvent",function(q){var V=gl,_e=x.cr.createSpan(E.t0.H,{key:Mr},{key:""},V.event);_e.setAttributes({service_no:V.service_no(q==null?void 0:q.service_no),error:(q==null?void 0:q.code)||0}),_e.end()}),(m=this.Uo)===null||m===void 0||m.on("pcDisconnectedEvent",function(q){var V=Js,_e=x.cr.createSpan(E.t0.H,{key:Mr},{key:""},V.event);_e.setAttributes({service_no:V.service_no(q==null?void 0:q.service_no),error:(q==null?void 0:q.code)||0}),_e.end()}),(S=this.Uo)===null||S===void 0||S.on("pcConnectedEvent",function(q){var V=vl,_e=x.cr.createSpan(E.t0.H,{key:Mr},{key:""},V.event);_e.setAttributes({service_no:V.service_no(q.service_no),recv_time:V.recv_time(new Date().getTime()),proxy_link_sources:V.proxy_link_sources(q.proxy_link_sources),connect_stream:V.connect_stream(q.connect_stream)}),_e.end()})}return Object.defineProperty(o.prototype,"Ho",{get:function(){return Object.values(this.So)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"nickName",{get:function(){return ar(this.pn.nickName)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"TermType",{get:function(){return this.pn.ENV%2==0?Te.t3.TT_WEB:Te.t3.TT_MINIPROGRAM},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),o.prototype.isDisConnect=function(){return this.jo!==xr.connected},o.prototype.getHeader=function(e,t,n){var r={cmd:e,seq:t,timestamp:new Date().getTime()};this.Vo&&(r.controls=this.Vo),n!=null&&n.contextKey&&(r.context_key=n==null?void 0:n.contextKey);var i=Di.Header.create(r),s=Di.Header.encode(i).finish();return{seq:r.seq,content:s}},Object.defineProperty(o.prototype,"isUaConnect",{get:function(){return this._ua.isConnect()},enumerable:!1,configurable:!0}),o.prototype.sendMessage=function(e,t,n,r,i,s,c){var u,l,a=this;s===void 0&&(s={timeout:6e3,resend:!1}),c===void 0&&(c=!0),this.an.info(Hr+" call"),++this.seq;var h,m=function(){if(c){var Oe={seq:a.seq,sendTime:Date.parse(new Date+""),timeout:s.timeout,resend:s.resend,success:n,error:function(Ge,Je,tt){var ut;a.an.error(Hr+" error "+Je+" "+(0,te.iq)(Ge)+" "+(0,te.iq)(tt)+" "+!!r);var vt=Ge==null?void 0:Ge.body,gt=vt==null?void 0:vt.err_code,Pt=(ut=Ge==null?void 0:Ge.header)===null||ut===void 0?void 0:ut.cmd,wt=tt==null?void 0:tt.roomID;if(Pt!==Xn.LoginRoomRsp){var At=a.pn.roomModulesList.find(function(Vt){return Vt.roomID==wt});if([1002,105].indexOf(gt)>-1)return Pt===Xn.EnterRoomRsp&&At?At?void At.retryRoom(!1,!0):void a.an.error(Hr+" room no found ignore "):void a.rtm.retryRoom(!1,void 0,!0);if([141].includes(gt)&&At)return void At.roomHandler.logoutByError({code:gt,msg:vt==null?void 0:vt.err_message})}r&&r(Ge,Je)},params:i};s.resend&&(Oe.cmdN=e,Oe.sendBody=t),a.So[Oe.seq]=Oe}};if(e!=="LoginRoomReq"&&this.jo!==xr.connected)return this.an.info(Hr+" state "+this.jo+" "+s.resend),s.resend?m():r&&r(Et.pzL),-1;if((0,R.Cs)(e))h=e;else if((0,R.TE)(h=Xn[e]))return this.an.warn(Hr+" cmd not found "+e),-1;m();var S,x=0;S=(0,R.TE)(i==null?void 0:i.roomID)?(u=this.pn.roomModulesList[0])===null||u===void 0?void 0:u.roomID:i==null?void 0:i.roomID,e!=="LoginRoomReq"&&S&&(x=this.zo[S]);var q=this.getHeader(h,this.seq,{contextKey:x}),V=q.content,_e=t,ke=this.getHead(V.length,_e.length),Pe=new Uint8Array(Array.from(ke).concat(Array.from(V)).concat(Array.from(_e)));return this.an.info(Hr+" seq: "+q.seq+" cmd: "+e),(l=this.Uo)===null||l===void 0||l.sendRequest({payload:Pe,ack:e==="LoginRoomReq"},function(Oe){a.an.info(Hr+" fail")},function(){a.an.info(Hr+" ack")},{}),q.seq},o.prototype.getHead=function(e,t){var n=new Uint8Array(7);return n[0]=49,n[1]=e>>8,n[2]=e-(n[1]<<8),n.set(new Uint8Array(Int32Array.from([t]).buffer).reverse(),3),n},o.prototype.handlePush=function(e,t){if(!(e[0]!==49||e.length<7)){var n=(e[1]<<8)+e[2],r=Di.Header.decode(e.slice(7,7+n)),i=e.slice(7+n),s=i,c=(e[3]<<24)+(e[4]<<16)+(e[5]<<8)+e[6];if(c!=i.length&&this.an.warn(z+" body len ".concat(c," != ").concat(i.length)),!ra[r.cmd])return this.an.info(Xr+" cmd is not rtc"),void this.onSwitchMessage(r,s);var u=this.decodeResponseBody(r,s);if(this.No.includes(r.cmd))this.handleSwitchPush(r,u);else{this.an.info(Xr+" down seq: "+r.seq+" "+(ra[r.cmd]||r.cmd)+" "+JSON.stringify(this.Qo(u)));var l={header:this.transHeader(r),body:this.transRsp(u)},a=this.Ao[r.context_key];(0,R.TE)(a)||(l.header.room_id=a),this.handleSendCommandMsgRsp(l)}}},o.prototype.handleSwitchPush=function(e,t){var n,r,i,s,c=this,u=e.context_key,l=this.Ao[u];if(l||this.xo.includes(e.cmd))if(e.cmd===Xn.PushReq){if((S=this.transRsp(t.head)).room_id=l,!this.pn.roomModulesList.find(function(_e){return _e.roomID==l}))return void this.an.warn(z+" room no found ignore ");var a={header:S,body:this.qo.includes(t.head.sub_cmd)?{signal_msg:Lo(t.msg_body),sub_cmd:t.head.sub_cmd}:t.head.sub_cmd===Xn.PushSignalCustom?{custommsg:Lo(t.msg_body)}:ra[t.head.sub_cmd]?this.transRsp(this.Yo(br[ra[t.head.sub_cmd]],t.msg_body)):{}};switch(t.head.sub_cmd){case Xn.PushUserInfoUpdated:(n=a.body.user_action_list)===null||n===void 0||n.forEach(function(_e){c.Ko(_e,Eu)});break;case Xn.PushUserKickout:this.Ko(a.body,Il);break;case Xn.PushTrans:this.Ko(a.body,As);break;case Xn.PushUserTrans:this.Ko(a.body,Cu),(r=a.body.trans_seq_list)===null||r===void 0||r.forEach(function(_e){c.Ko(_e,Ba)});break;case Xn.PushIm:(i=a.body.msg_list)===null||i===void 0||i.forEach(function(_e){c.Ko(_e,Ic)});break;case Xn.PushChannelMsg:this.Ko(a.body,na),this.keysExist(a.body,["channel_type"]);break;case Xn.PushTransparentMsg:this.Ko(a.body,Vo);break;case Xn.PushStreamAdd:case Xn.PushStreamDelete:case Xn.PushStreamUpdate:(s=a.body.stream_info_list)===null||s===void 0||s.forEach(function(_e){c.Ko(_e,wc)});break;case Xn.PushUserTokenExpire:this.Ko(a.body.stop_stream_info,Cc);break;case Xn.PushUserLogReport:this.pn.getLogWhiteList(!0)}switch(this.an.info(z+" push ".concat(e.seq," ").concat(JSON.stringify(this.Qo(a)))),t.head.sub_cmd){case Xn.PushUserInfoUpdated:this.handlePushUserStateUpdateMsg(a);break;case Xn.PushUserKickout:this.transKeysName(a.body,this.ko),this.handlePushKickout(a,!1);break;case Xn.PushTrans:this.handlePushTransMsg(a);break;case Xn.PushUserTrans:this.handlePushUserTransMsg(a);break;case Xn.PushIm:this.handlePushRoomMsg(a);break;case Xn.PushSignalCustom:this.handlePushCustomMsg(a);break;case Xn.PushStreamAdd:case Xn.PushStreamDelete:case Xn.PushStreamUpdate:this.handlePushStreamMsg(a);break;case Xn.PushJoinliveRequest:case Xn.PushJoinliveResult:case Xn.PushJoinliveInvite:case Xn.PushJoinliveStop:this.handlePushSignalMsg(a);break;case Xn.PushUserTokenExpire:this.handlePushTokenExpire(a);break;case Xn.PushChannelMsg:this.handlePushChannelMsg(a);break;case Xn.PushTransparentMsg:this.handlePushTransparentMsg(a);break;default:this.an.info(z+" white "),this.onSwitchMessage(e,t)}if(t.head.qos_flag==1){var h=Di.PushRsp.create({code:0,message:"",sub_cmd:t.head.sub_cmd,server_send_time:t.head.send_time}),m=Di.PushRsp.encode(h).finish();this.sendMessage("PushRsp",m,void 0,void 0)}}else if(e.cmd===Xn.MergePushReq){var S;if((S=this.transRsp(t.head)).room_id=l,!this.pn.roomModulesList.find(function(_e){return _e.roomID==l}))return void this.an.warn(z+" room no found ignore ");var x=[];t.message_list.forEach(function(_e){var ke,Pe;x.push({sub_cmd:_e.sub_cmd,sub_seq:_e.sub_seq}),_e.sub_cmd===Xn.PushBigIm&&((ke=(Pe=br.PushBigIm.decode(_e.msg_body)).msg_list)===null||ke===void 0||ke.forEach(function(Oe){c.Ko(Oe,Rc)}),_e.msg_body=Pe)});var q={header:S,body:this.transRsp(t)};delete q.body.head,this.handlePushMergeMsg(q),t.head.qos_flag==1&&(h=Di.MergePushRsp.create({messages:x,server_send_time:t.head.send_time}),m=Di.MergePushRsp.encode(h).finish(),this.sendMessage("MergePushRsp",m,void 0,void 0))}else e.cmd===Xn.PushKickout&&this.handlePushKickout({header:e,body:{reason:t.reason>900?t.reason-900:t.reason,msg:t.message,need_relogin:t.is_need_relogin!==void 0?t.is_need_relogin:0}},!0);else{this.an.warn(z+" ctx key ".concat(u," not found"));var V={header:e,body:t};this.Do[u]?this.Do[u].push(V):this.Do[u]=[V]}},o.prototype.handlePushChannelMsg=function(e){},o.prototype.handlePushTransparentMsg=function(e){},o.prototype.handlePushTokenExpire=function(e){var t,n,r=((n=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.stop_stream_info)===null||n===void 0?void 0:n.stream_id_list)||[];r.length>0&&this.pn.actionListener("_stopStream",r,{code:pe.TOKEN_EXPIRED.code,message:pe.TOKEN_EXPIRED.msg})},o.prototype.handlePushKickout=function(e,t){var n,r;if(t)kc([],this.pn.roomModulesList,!0).forEach(function(c){c.roomHandler.handlePushKickout(e,!0,!0)});else{var i=(n=e==null?void 0:e.header)===null||n===void 0?void 0:n.room_id,s=this.pn.roomModulesList.find(function(c){return c.roomID==i});if(this.longToStringNumber(e.body,["session_id"],"toString"),!s)return void this.an.error("zm.lrh.pk room no found ignore "+JSON.stringify((r=e.header)===null||r===void 0?void 0:r.room_id));s.roomHandler.handlePushKickout(e)}},o.prototype.handlePushUserStateUpdateMsg=function(e){var t,n,r,i=(t=e==null?void 0:e.header)===null||t===void 0?void 0:t.room_id,s=this.pn.roomModulesList.find(function(a){return a.roomID==i});if(s){var c=e.body.user_action_list.map(function(a){return{Action:a.action,IdName:a.id_name,NickName:a.nick_name,Role:a.role,LoginTime:a.login_time.toString()}}),u=this.pn.reporter.createSpan(E.t0.H,{key:ur.event,par:i},{key:""},ul),l={body:{user_actions:c,user_list_seq:e.body.server_user_seq.toNumber(),room_id:i}};u.setAttributes({user_list_seq:(n=l==null?void 0:l.body)===null||n===void 0?void 0:n.user_list_seq,update_user:(r=l==null?void 0:l.body)===null||r===void 0?void 0:r.user_actions}),u.end(),s.userHandler.handlePushUserStateUpdateMsg(l)}else this.an.error("zm.lrh.puu room no found ignore "+JSON.stringify(e))},o.prototype.handlePushStreamMsg=function(e){},o.prototype.handlePushSignalMsg=function(e){},o.prototype.handlePushMergeMsg=function(e){},o.prototype.handlePushCustomMsg=function(e){},o.prototype.handlePushRoomMsg=function(e){},o.prototype.handlePushTransMsg=function(e){},o.prototype.handlePushUserTransMsg=function(e){},o.prototype.onSwitchMessage=function(e,t){},o.prototype.decodeResponseBody=function(e,t){var n=this.Po.includes(e.cmd)?"proto_switch_v3":"liveroom_cs_v3";return this.Yo(this.Co[n][ra[e.cmd]],t)},o.prototype.login=function(e,t,n){var r,i,s=this;this.jo==xr.disconnected&&(this.an.info(F+" state disconnect"),this.closeRequest());var c=new Date().getTime()+"",u={user_session_id:(r=e.longSid)!==null&&r!==void 0?r:di.A.fromInt(0),net_type:tr(),room_id:ar(e.roomID),room_name:ar(e.roomName),nick_name:this.nickName,role:this.pn.role,third_token:ar(e.token),room_create_flag:this.pn.roomCreateFlag,user_state_flag:e.userStateUpdate?1:0,user_count_limit:e.maxMemberCount,relate_service:this.pn.relateService.join()||""};if(e.isMulti){var l=Ri(Ri({},u),{conn_type:2});delete(m=Ri(Ri({},l),{room_id:e.roomID,room_name:e.roomName})).third_token,this.an.info(F+" enter "+JSON.stringify(m));var a=br.EnterRoomReq.create(l),h=br.EnterRoomReq.encode(a).finish();this.sendMessage("EnterRoomReq",h,function(x,q){var V;s.Zo(x,e),t&&t(x,q),!((V=x.header)===null||V===void 0)&&V.context_key&&s.processPushMsgCache(x.header.context_key),s.Xo(e.roomID)},function(x,q){s.clearAllPushMsgCache(),n&&n(x,q)},{roomID:e.roomID})}else{var m,S=Ri(Ri({},u),{app_id:this.pn.appid,id_name:ar(this.pn.idName),device_id:this.pn.deviceID,term_type:this.TermType,sdk_version:this.pn.sdkVerNum,client_stamp:ar(c),relogin_token:this.switchSessionID.notEquals(di.A.fromInt(0))?ar(this.Lo):"",switch_session_id:this.switchSessionID,user_session_id:(i=e.longSid)!==null&&i!==void 0?i:di.A.fromInt(0),biz_type:0,biz_version:this.pn.bizVersion||"",login_logic:this.pn.isMultiRoom?3:1,sdk_conn_type:2});e.roomReasonState===ue.Reconnecting&&(S.relogin_type=1),delete(m=Ri(Ri({},S),{id_name:this.pn.idName,nick_name:this.pn.nickName,client_stamp:c,k1_sign:void 0,relogin_token:this.Lo,room_id:e.roomID,room_name:e.roomName,user_session_id:e.longSid})).third_token,this.Eo=e.token,this.an.info(F+" login "+JSON.stringify(m)),this.an.remoteReport(F+" token "+e.token),a=Di.LoginRoomReq.create(S),h=Di.LoginRoomReq.encode(a).finish(),this.sendMessage("LoginRoomReq",h,function(x,q){var V,_e,ke;s.an.info(F+" login rsp"),s.switchSessionID=x.body.switch_session_id,!((V=x==null?void 0:x.header)===null||V===void 0)&&V.controls&&(s.Vo=(_e=x==null?void 0:x.header)===null||_e===void 0?void 0:_e.controls),s.Zo(x,e),s.Lo=x.body.relogin_token,t&&t(x,q),!((ke=x.header)===null||ke===void 0)&&ke.context_key&&s.processPushMsgCache(x.header.context_key),s.Xo(e.roomID)},function(x,q){s.clearAllPushMsgCache(),n&&n(x,q)})}},o.prototype.Zo=function(e,t){var n,r,i,s,c,u,l=this;!((n=e.header)===null||n===void 0)&&n.context_key&&(this.zo[t.roomID]=e.header.context_key,this.Ao[e.header.context_key]=t.roomID,e.header.room_id=t.roomID),this.Ko(e.body,Cl),this.Ko((r=e.body)===null||r===void 0?void 0:r.anchor_info,zo),(s=(i=e.body)===null||i===void 0?void 0:i.trans_channel_list)===null||s===void 0||s.forEach(function(a,h){var m;l.Ko(a,po),(m=a.trans_seq_list)===null||m===void 0||m.forEach(function(S){l.Ko(S,Tc)})}),(u=(c=e.body)===null||c===void 0?void 0:c.stream_info_list)===null||u===void 0||u.forEach(function(a,h){l.Ko(e.body.stream_info_list[h],ho)}),this.longToStringNumber(e.body,["ret_timestamp"],"toString"),this.transKeysName(e.body,this.ko),this.keysExist(e.body,["token_remain_time","stream_seq","hearbeat_interval","hearbeat_timeout"]),e.body.anchor_info={anchor_id_name:e.body.anchor_info.id_name,anchor_id:e.body.anchor_info.user_id,anchor_nick_name:e.body.anchor_info.nick_name}},o.prototype.transKeysName=function(e,t){t.forEach(function(n){(0,R.TE)(e[n[0]])||(e[n[1]]=e[n[0]],delete e[n[0]])})},o.prototype.keysExist=function(e,t){t.forEach(function(n){e[n]===void 0&&(e[n]=0)})},o.prototype.longToStringNumber=function(e,t,n){t.forEach(function(r){di.A.isLong(e[r])&&(e[r]=e[r][n]())})},o.prototype.Ko=function(e,t){var n=this;(0,R.w)(e)&&t.forEach(function(r){if(Object.prototype.toString.call(e[r])==="[object Uint8Array]")try{e[r]=Lo(e[r])}catch(i){n.an.error("zm.lrh.bts "+r+" "+i)}else Object.prototype.toString.call(e[r])==="[object Array]"&&!e[r].some(function(i){return Object.prototype.toString.call(i)!=="[object Uint8Array]"})&&(e[r]=e[r].map(function(i,s){try{return Lo(i)}catch(c){return n.an.error("zm.lrh.bts  "+" ".concat(s," ").concat(r," ").concat(c)),i}}))})},o.prototype.logout=function(e,t,n){var r=this;if(e.isMulti){this.an.info(Ae+" quit "+e.roomID),this.clearPushMsgCacheByRoomID(e.roomID);var i=br.QuitRoomReq.create(c={}),s=br.QuitRoomReq.encode(i).finish();return this.sendMessage("QuitRoomReq",s,function(l,a){r.handleLogoutRsp(e.roomID),t&&t(l,a)},function(l,a){r.handleLogoutRsp(e.roomID),n&&n(l,a)},{roomID:e.roomID})}this.clearAllPushMsgCache();var c={logout_code:0,logout_check:this.Bo.md5Bytes(ar(this.Eo)),user_session_id:e.longSid,logout_logic:this.pn.isMultiRoom?3:1},u=this.Qo(c);return this.an.info(Ae+" logout "+JSON.stringify(u)),i=Di.LogoutRoomReq.create(c),s=Di.LogoutRoomReq.encode(i).finish(),this.sendMessage("LogoutRoomReq",s,function(l,a){r.handleLogoutRsp(e.roomID),t&&t(l,a)},function(l,a){r.handleLogoutRsp(e.roomID),n&&n(l,a)},{roomID:e.roomID})},o.prototype.Wo=function(){var e=this.Ho;this.an.info("zm.lrh.csml "+e.length),e.forEach(function(t){t&&t.error&&setTimeout(function(){t&&t.error&&t.error(pe.TIMEOUT,t.seq)},0)}),this.So={}},o.prototype.$o=function(){var e=this,t=Date.now(),n=0,r=0,i=0;this.Ho.find(function(s){if(s.sendTime+s.timeout>t)return!1;if(delete e.So[s.seq],++r,s.error==null)++i;else{var c=s.error,u=s.seq;setTimeout(function(){c&&c(pe.TIMEOUT,u)},0)}return++n>=e.Oo}),r>0&&this.an.info("zm.lrh.cmlt timeout: ".concat(r," , ").concat(i))},o.prototype.startCheck=function(){var e=this;this.$o(),this.tu=setTimeout(function(){e.startCheck()},this.To)},o.prototype.stopCheck=function(){this.Wo(),clearTimeout(this.tu)},o.prototype.Xo=function(e){var t=this,n=this.Ho;this.an.info("zm.lrh.huscl "+n.length),n.forEach(function(r){if(r&&r.resend){var i=r.seq,s=r.cmdN,c=r.sendTime,u=r.sendBody,l=r.params,a=r.success,h=r.error;if((l==null?void 0:l.roomID)===e){var m=new Date().getTime()-c;t.sendMessage(s,u,a,h,l,{timeout:m,resend:!1},!0),delete t.So[i]}}})},o.prototype.handleSendCommandMsgRsp=function(e){var t=this.So[e.header.seq];if(t!=null){var n=t,r=n==null?void 0:n.params;delete this.So[e.header.seq],e.body.err_code===0?setTimeout(function(){n&&n.success!=null&&n.success(e,e.header.seq)},0):setTimeout(function(){n&&n.error!=null&&n.error(e,e.header.seq,r)},0)}},o.prototype.getReqHead=function(e){return{}},o.prototype.heartBeat=function(e,t,n,r){var i=this,s=br.HbReq.create({}),c=br.HbReq.encode(s).finish();this.sendMessage("HbReq",c,function(u,l){var a,h;(a=u.body.trans_channel_list)===null||a===void 0||a.forEach(function(m,S){var x;i.Ko(m,po),(x=m.trans_seq_list)===null||x===void 0||x.forEach(function(q){i.Ko(q,Tc)})}),(h=u.body.user_trans_channel_list)===null||h===void 0||h.forEach(function(m,S){var x;i.Ko(m,po),(x=m.trans_seq_list)===null||x===void 0||x.forEach(function(q){i.Ko(q,Tc)})}),i.transKeysName(u.body,[["hb_interval","hearbeat_interval"],["hb_timeout","hearbeat_timeout"],["big_im_time_window","bigim_time_window"],["trans_channel_list","trans_seqs"]]),i.keysExist(u.body,["hearbeat_interval","hearbeat_timeout"]),u.body.server_user_seq=u.body.user_seq.toNumber(),i.longToStringNumber(u.body,["ret_timestamp"],"toNumber"),e&&e(u,l)},t,{roomID:n==null?void 0:n.roomID},{timeout:r})},o.prototype.fetchUserList=function(e,t,n,r){var i=this,s=Ri({},e),c=this.Qo(s);this.an.info(ve+" "+JSON.stringify(c));var u=br.GetUserlistReq.create(s),l=br.GetUserlistReq.encode(u).finish();return this.sendMessage("GetUserlistReq",l,function(a,h){var m,S;i.an.info(ve+" suc "+h),(S=(m=a.body)===null||m===void 0?void 0:m.user_base_info_list)===null||S===void 0||S.forEach(function(x,q){i.Ko(a.body.user_base_info_list[q],ks)}),i.transKeysName(a.body,[["user_base_info_list","user_baseinfos"]]),i.longToStringNumber(a.body,["server_user_seq","server_user_index","ret_user_index"],"toNumber"),t&&t(a,h)},n,{roomID:r==null?void 0:r.roomID})},o.prototype.sendRoomMsg=function(e,t,n,r){var i=this,s={msg_category:e.msg_category,msg_type:e.msg_type,msg_content:ar(e.msg_content)},c=this.Qo(s);this.an.info("zm.lrh.srm.1 "+JSON.stringify(c));var u=br.SendImReq.create(s),l=br.SendImReq.encode(u).finish();return this.sendMessage("SendImReq",l,function(a,h){i.longToStringNumber(a.body,["msg_id"],"toNumber"),t&&t(a,h)},n,{roomID:r==null?void 0:r.roomID})},o.prototype.sendReliableMessage=function(e,t,n,r){var i=this,s={trans_type:ar(e.trans_type),trans_data:ar(e.trans_data),trans_local_seq:e.trans_local_seq,trans_channel:ar(e.trans_channel)},c=this.Qo(s);this.an.info("zm.lrh.srm.0 "+JSON.stringify(c));var u=br.SetTransReq.create(s),l=br.SetTransReq.encode(u).finish();return this.sendMessage("SetTransReq",l,function(a,h){i.Ko(a.body,wl),t(a,h)},n,{roomID:r==null?void 0:r.roomID})},o.prototype.fetchReliableMessage=function(e,t,n,r){var i=this,s=e.fetch_array.map(function(h){return{trans_type:ar(h.trans_type),trans_local_seq:h.trans_seq}}),c={trans_channel:ar(e.trans_channel),trans_list:s},u=this.Qo(c);this.an.info("zm.lrh.frm "+JSON.stringify(u));var l=br.GetTransReq.create(c),a=br.GetTransReq.encode(l).finish();return this.sendMessage("GetTransReq",a,function(h,m){var S;i.Ko(h.body,Ii),(S=h.body.trans_list)===null||S===void 0||S.forEach(function(x){i.Ko(x,jr)}),t(h,m)},n,{roomID:r==null?void 0:r.roomID})},o.prototype.fetchUserTransInfo=function(e,t,n,r){var i=this,s=e.fetch_array.map(function(h){return{trans_type:ar(h.trans_type),trans_local_seq:h.trans_seq}}),c={trans_channel:ar(e.trans_channel),user_trans_list:s},u=this.Qo(c);this.an.info("zm.lrh.futi "+JSON.stringify(u));var l=br.GetUserTransReq.create(c),a=br.GetUserTransReq.encode(l).finish();return this.sendMessage("GetUserTransReq",a,function(h,m){var S;i.Ko(h.body,Tu),(S=h.body.user_trans_list)===null||S===void 0||S.forEach(function(x){i.Ko(x,xa)}),t(h,m)},n,{roomID:r==null?void 0:r.roomID})},o.prototype.sendCustomCommand=function(e,t,n,r){var i=this,s=e.dest_id_name.map(function(h){return{id_name:ar(h)}}),c=Ri({to_user_list:s,push_message:ar(e.custom_msg)},e),u=this.Qo(c);this.an.info(Xe+" "+JSON.stringify(u));var l=br.SignalLiveCustomReq.create(c),a=br.SignalLiveCustomReq.encode(l).finish();return this.sendMessage("SignalLiveCustomReq",a,function(h,m){t&&t(i.transRsp(h),m)},function(h,m){n&&n(h,m)},{roomID:r==null?void 0:r.roomID})},o.prototype.sendRoomChannelMessage=function(e,t,n,r){var i=this,s=e.toUserIDList,c={channel_type:e.channelType,msg_type:e.msgType,msg_content:ar(e.msgContent),to_user_list:s.map(function(h){return ar(h)})},u=this.Qo(c);this.an.info(Xe+" "+JSON.stringify(u));var l=br.SendChannelMsgReq.create(c),a=br.SendChannelMsgReq.encode(l).finish();return this.sendMessage("SendChannelMsgReq",a,function(h,m){n&&n(i.transRsp(h),m)},function(h,m){r&&r(h,m)},{roomID:t})},o.prototype.sendTransparentMessage=function(e,t,n,r,i){var s=this,c=this.Qo(e);this.an.info("zm.lrh.stm "+(0,te.iq)(c));var u=br.SignalTransparentMsgReq.create(e),l=br.SignalTransparentMsgReq.encode(u).finish();return this.sendMessage("SignalTransparentMsgReq",l,function(a,h){r&&r(s.transRsp(a),h)},function(a,h){console.error("sendTransparentMessage"),i&&i(a,h)},{roomID:t},{timeout:1e3*n,resend:!0})},o.prototype.sendBigRoomMessage=function(e,t,n,r){var i=this,s={msg_list:e.msgs.map(function(a){return{msg_category:a.msg_category,msg_type:a.msg_type,msg_timestamp:di.A.fromNumber(Date.now()),msg_content:ar(a.msg_content),msg_client_id:ar(a.bigmsg_client_id)}})},c=this.Qo(s);this.an.info("zm.lrh.sbrm "+JSON.stringify(c));var u=br.SendBigImReq.create(s),l=br.SendBigImReq.encode(u).finish();return this.sendMessage("SendBigImReq",l,function(a,h){var m;(m=a.body.msg_list)===null||m===void 0||m.forEach(function(S){i.Ko(S,Ps)}),t(a,h)},n,{roomID:r==null?void 0:r.roomID})},o.prototype.sendSignalCmd=function(e,t,n,r){var i="";switch(e.sub_cmd){case Ru:i="SignalLiveInviteReq";break;case hi:i="SignalLiveRequestReq";break;case Al:i="SignalLiveResultReq";break;case za:i="SignalLiveStopReq"}var s=e.dest_id_name.map(function(h){return{id_name:ar(h)}}),c={push_message:ar(e.signal_msg),to_user_list:s},u=this.Qo(c);this.an.info("zm.lrh.ssc "+JSON.stringify(u));var l=br[i].create(c),a=br[i].encode(l).finish();return this.sendMessage(i,a,t,n,{roomID:r==null?void 0:r.roomID})},o.prototype.sendStreamUpdate=function(e,t,n,r){var i,s=this;try{i=JSON.parse(e.stream_msg)}catch{}var c,u="";this.an.info(We+" "+JSON.stringify(Ri(Ri({},e),{third_token:void 0}))),this.an.remoteReport(We+" token "+e.third_token);var l=this.pn.roomModulesList.find(function(S){return S.roomID==r.roomID});if(!l)return this.an.error(We+" room no found ignore "),-1;switch(e.sub_cmd){case 2001:u="AddStreamReq",c={stream_id:ar(i.stream_id),extra_info:ar(i.extra_info),client_req_seq:this.seq+1,third_token:ar(e.third_token||""),stream_attr_opts:{stream_resource:e.stream_resource,stream_codec:e.stream_codec,censor_flag:i.inspect_flag||0}};break;case 2002:u="DeleteStreamReq",c={stream_id:ar(i.stream_id),stream_sid:i.stream_sid,client_req_seq:this.seq+1};break;case 2003:u="UpdateStreamReq",c={stream_id:ar(i.stream_id),stream_sid:i.stream_sid,client_req_seq:this.seq+1,extra_info:ar(i.extra_info)}}var a=this.Qo(c);this.an.info(We+" "+JSON.stringify(a));var h=br[u].create(c),m=br[u].encode(h).finish();return this.sendMessage(u,m,function(S,x){s.an.info(We+" suc "+u+" "+JSON.stringify(S)),S.header.room_id=l.roomID,t&&t(S,x)},function(S,x){s.an.info(We+" fail "+u+" "+JSON.stringify(S)),n&&n(S,x)},{roomID:r==null?void 0:r.roomID})},o.prototype.getStreamList=function(e,t,n,r){var i=this;if(this.pn.roomModulesList.find(function(a){return a.roomID==r.roomID})){var s={},c=this.Qo(s);this.an.info(T+" "+JSON.stringify(c));var u=br.GetStreamListReq.create(s),l=br.GetStreamListReq.encode(u).finish();this.sendMessage("GetStreamListReq",l,function(a,h){var m,S;(S=(m=a.body)===null||m===void 0?void 0:m.stream_info_list)===null||S===void 0||S.forEach(function(x){i.Ko(x,ho),x.create_time=x.create_time.toNumber()}),i.transKeysName(a.body,[["stream_list_seq","stream_seq"],["stream_info_list","stream_info"]]),t&&t(a,h)},function(a,h){n&&n(a,h)},{roomID:r==null?void 0:r.roomID})}else this.an.error(T+" room no found ignore "+r.roomID)},o.prototype.Qo=function(e){var t=this,n={};return Object.keys(e).forEach(function(r){["logout_check"].includes(r)?n[r]=e[r]:t.iu(n,e,r,!0)}),n},o.prototype.transHeader=function(e){return e.timestamp=di.A.isLong(e.timestamp)?e.timestamp.toString():e.timestamp,e},o.prototype.transRsp=function(e){var t=e&&e.rsp_head?this.transRspHead(e.rsp_head):{},n=Ri(Ri({},e),t);return delete n.rsp_head,n},o.prototype.iu=function(e,t,n,r){var i=this;if(r===void 0&&(r=!1),di.A.isLong(t[n]))e[n]=r?t[n].toString():t[n];else if(Object.prototype.toString.call(t[n])==="[object Object]")e[n]={},Object.keys(t[n]).forEach(function(u){return i.iu(e[n],t[n],u,r)});else if(Object.prototype.toString.call(t[n])==="[object Array]"&&Object.prototype.toString.call(t[n][0])==="[object Object]"){e[n]=[];for(var s=function(u){var l={};Object.keys(t[n][u]).forEach(function(a){i.iu(l,t[n][u],a,r)}),e[n].push(l)},c=0;c<t[n].length;c++)s(c)}else if(r&&Object.prototype.toString.call(t[n])==="[object Uint8Array]")try{e[n]=Lo(t[n])}catch{e[n]=r?"~":t[n]}else e[n]=t[n]},o.prototype.transRspHead=function(e){return e?{err_code:e.code||0,err_message:e.message}:{}},o.prototype.Yo=function(e,t){return t&&Ri({},e.decode(t))},o.prototype.Fo=function(e,t){var n=this;this.an.info(ot+" call"),this.jo=xr.disconnected,this.pn.roomModulesList.forEach(function(r){var i=r.roomTryHandler;i&&n.isUaConnect&&(n.an.info(ot+" ua is connect"),i.retryLoginRoom())})},o.prototype.Jo=function(){this.an.info(lt+" call"),this.jo=xr.broken,this.clearAllPushMsgCache(),this.nu(lt)},o.prototype.nu=function(e){var t=this;this.pn.roomModulesList.forEach(function(n){var r=n.roomTryHandler,i=n.roomHandler;r&&(r.invalid(),r.onactive=function(s,c){t.an.info(e+" onactive"),i.transError(c),i.disconnectedHandle(c)},r.startMaxTime(),i._roomStateHandle("CONNECTING",ue.Reconnecting,pe.NETWORK_BROKEN))})},o.prototype.Go=function(e){this.an.info("zm.lrh.hc call "+e),this.jo=xr.connected,e===Jn.ConnectedType.AUTO&&this.rtm.retryRoom()},o.prototype.renewToken=function(e,t,n,r){var i=this,s={token:e.token},c=br.RenewTokenReq.create(s),u=br.RenewTokenReq.encode(c).finish(),l=this.Qo(s);this.an.info("zm.lrh.rt "+JSON.stringify(l)),this.sendMessage("RenewTokenReq",u,function(a,h){i.Ko(a.body,Ec),i.keysExist(a.body,["token_remain_time"]),t&&t(a,h)},n,{roomID:r==null?void 0:r.roomID})},o.prototype.reset=function(){this.an.info("zm.lrh.r.0 call "),this.jo=xr.disconnected,this.switchSessionID=di.A.fromInt(0),this.tu&&clearTimeout(this.tu)},o.prototype.closeRequest=function(){var e;(e=this.Uo)===null||e===void 0||e.closeRequest()},o.prototype.resetSessionInfo=function(){this.switchSessionID=di.A.fromInt(0)},o.prototype.processPushMsgCache=function(e){var t=this.Do[e];if(t){this.an.info(Xr+" processPushMsgCache ".concat(e,", msg len: ").concat(t.length));for(var n=0;n<t.length;n++){var r=t[n];this.handleSwitchPush(r.header,r.body)}delete this.Do[e]}},o.prototype.clearAllPushMsgCache=function(){var e=this;Object.keys(this.Do).forEach(function(t){var n=parseInt(t);delete e.Do[n]})},o.prototype.clearPushMsgCacheByRoomID=function(e){var t=this.zo[e];t&&this.Do[t]&&delete this.Do[t]},o.prototype.handleLogoutRsp=function(e){var t=this.zo[e];t&&(delete this.Ao[t],delete this.zo[e],this.Do[t]&&delete this.Do[t])},o}(),si=function(){function o(){this.defaultSetting={remote_log_level:"info",detaillog_domain:"",http3:0,api_error_report:1,api_login:3e4,api_logout:3e4,api_start_publish:3e4,api_start_play:3e4,ip_stack_mode:1,publish_video_codec:"H264",camera_video_bitrate:800,screen_video_bitrate:1500,custom_video_bitrate:0,l3_play_buffer_ms:500,AEC:void 0,AGC:void 0,ANS:void 0,resource_mode:0,bitrate_mode:"default",auto_to_tcp:!1,udp_max_fail_num:2,probe_started_num:3,udp_or_tcp:"udp",hardware_encode:!1,camera_hard_encode:!1,custom_hard_encode:!1,bg_fps_stat:0,camera_width:720,camera_height:480,camera_framerate:15,camera_audio_bitrate:48,open_mini_sdp:!1,sound_level_api_type:E.EA.useAnalyzer,sound_sample_interval:200,scenario_configs:[],dtx:0,peer_signal_over_dc:!1,ains:0,ains_mode:0,auto_switch_publish_video_codec:0,vid_clock_rate_est:0,transcode_on_zero_fps:0,report_attr_level:0,log_strategy:-1,connect_media_in_advance:1},this.userChangedKey={},this.arrObjKeys=["scenario"],this.arrObjItemKeys=["scenario_configs"],this.setting=JSON.parse(JSON.stringify(this.defaultSetting))}return o.prototype.setSetting=function(e,t){var n=Array.isArray(t)&&t.length>0;for(var r in e){var i=e[r];if(this.arrObjKeys.includes(r))for(var s in i)this.setting[r+"_"+s]=i[s];else if((0,R.Cs)(i.ctrlmode)&&[1,2].includes(i.ctrlmode))this.setting[r]=i,this.setting[r+"_ctrlmode"]=i.ctrlmode;else for(var s in i)if(!(s.endsWith("_ctrlmode")||n&&t.indexOf(s)==-1))if((0,R.TE)(i[s+"_ctrlmode"]))i[s]===void 0?this.defaultSetting[s]&&(this.setting[s]=this.defaultSetting[s]):this.setting[s]=i[s];else{var c=i[s+"_ctrlmode"];c===1?this.userChangedKey[s]||(this.setting[s]=i[s]):c===2?this.setting[s]=i[s]:this.userChangedKey[s]||this.defaultSetting[s]&&(this.setting[s]=this.defaultSetting[s]),typeof c=="number"&&(this.setting[s+"_ctrlmode"]=i[s+"_ctrlmode"])}}},o.prototype.getSetting=function(e,t){return t===void 0&&(t=!1),this.arrObjItemKeys.includes(e)?this.setting[e]:t?this.setting[e+"_ctrlmode"]==2?this.setting[e]:void 0:this.setting[e]},o.prototype.setUserValue=function(e,t){this.setting[e+"_ctrlmode"]!==2&&(this.userChangedKey[e]=!0,this.setting[e]=t)},o.prototype.getCloudSettingScenario=function(e,t,n){var r=this;t===void 0&&(t=!1),n===void 0&&(n=!1);var i=(this.getSetting("scenario_configs")||[]).find(function(x){return x.scenario===e}),s={};if(i){var c=i.a_chn_count,u=i.a_bitrate,l=i.ctrlmode;[["ANS","ANS",i.ans_status,!0],["AGC","AGC",i.agc_status,!0],["AEC","AEC",i.aec_status,!0],["audioBitrate","camera_audio_bitrate",isNaN(u)?void 0:u/1e3,!1],["channelCount","",c,!1]].forEach(function(x){var q,V,_e,ke,Pe;q=x[0],V=x[1],ke=x[3],Pe=l,typeof(_e=x[2])=="number"?(t&&Pe===2||!t&&[1,2].includes(Pe))&&(ke?(_e===1&&(s[q]=!0),_e===0&&(s[q]=!1)):s[q]=_e):!n&&V&&(s[q]=r.getSetting(V,t))})}else{if(n)return{};var a=this.getSetting("ANS",t);(0,R.dd)(a)&&(s.ANS=a);var h=this.getSetting("AGC",t);(0,R.dd)(h)&&(s.AGC=h);var m=this.getSetting("AEC",t);(0,R.dd)(m)&&(s.AEC=m);var S=this.getSetting("camera_audio_bitrate",t);(0,R.Cs)(S)&&(s.audioBitrate=S)}return s},o.prototype.getSettingList=function(e,t){var n=this;return t===void 0&&(t=!1),e.map(function(r){return n.getSetting(r,t)})},o.prototype.getSettingWithUserParams=function(e,t){if(this.arrObjItemKeys.includes(e))return this.setting[e];var n=this.setting[e],r=this.setting[e+"_ctrlmode"];return r!==void 0?r===2?n:r===1?t??n:t:t??n},o}(),Fo="init",hs="room",Zo="rtc",bo=function(){return bo=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},bo.apply(this,arguments)},On=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},d=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},g=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))},p=function(){function o(e,t,n,r,i,s,c){var u,l,a,h,m,S,x,q=this;this.an=n,this._dataReport=r,this.cr=i,this.eu=c,this.dispatchServers=[],this.dispatchHttp3Servers=[],this.dispatchWssV6Servers=[],this.dispatchHttp3V6Servers=[],this.ru=null,this.su=1e3,this.version=E.qt,this.id="",this.ou={online:function(){q.uu()},offline:function(){q.uu()},unload:function(Qt){return On(q,void 0,void 0,function(){return d(this,function(Wt){switch(Wt.label){case 0:return this.an.info(Fn+" "+Qt.type),this.cr.setUnloadState(E.t0.I),this._onBeforePageUnload?[4,this._onBeforePageUnload()]:[3,2];case 1:Wt.sent(),Wt.label=2;case 2:return this.logoutRoom(void 0,!1,!0),[2]}})})}},this._roomLoginResponseListener=function(){clearTimeout(q.cloudSettingTimer),q.cloudSettingTimer=setTimeout(function(){q.an.info(P+" fetch cloud setting"),q.au()},100)};var V=o.logConfigForPreset;V!=null&&V.logLevel&&this.logger.setLogLevel(V.logLevel),n.onConnected=function(Qt){var Wt=Qt.url,zt="".concat(nr," log connected ").concat(Wt);if(Wt&&Wt.startsWith("wss://")){q.pn.logDomain=Wt.split("/")[2];var Mt="wss://".concat(q.pn.logDomain,"/zglog/tlog");q.logger.info("".concat(nr," event url ").concat(Mt)),q.cr.setConfig({serverUrl:Mt})}q.pn.enableWSLog||(q.an.enableWebSocketLog(!1),zt+=" ; close ws log"),q.an.info(zt)},n.onUploadLog=function(Qt,Wt,zt){var Mt=q.cr.createSpan(E.t0.H,{key:Cn.event},{key:""},Wn);Mt.setAttributes({file_size:Math.round(Qt/8),file_name:Wt}),zt?q.cr.setError(Mt,zt):Mt.end()},this.pn=new fc(this.an,this._dataReport),this.pn.ENV=s,this.pn.product=jn.product,this.pn.advanceConfig=bo(bo({},this.pn.advanceConfig),{customDomain:o.customDomain}),this.cu();var _e=o.engineOptions;this.cloudSetting=new yc(_e==null?void 0:_e.closeCloudSetting),this.getReportSeq=E.wN,this.getSeq=E.Mo,this.hu(),this.pn.deviceID=function(Qt){Qt===void 0&&(Qt=0);var Wt=Nn("z_deviceID");if(Wt)return Wt;new Date().getTime();var zt=Wr(Qt);return Qn("z_deviceID",zt),zt}(s),o.pageID||(o.pageID=Wr(s));var ke=this.pn.id=Wr(s);this.logger.info("".concat(nr," deviceID: ").concat(this.pn.deviceID,", pageID: ").concat(o.pageID,", instID: ").concat(ke)),this.cr.init(e,s,this.pn.deviceID),this.cr.setLogger(this.an),this.pn.reporter=this.cr;var Pe,Oe=Cn,Ge=this.cr.createSpan(E.t0.H,{key:""},{key:Oe.event},Oe.event,!0);t&&this.fu(t);var Je,tt,ut=s===0?"ZegoExpressWebRTC":"ZegoExpressMiniProgram";if(!((u=this.eu)===null||u===void 0)&&u.reportData&&(Pe=(a=(l=this.eu)===null||l===void 0?void 0:l.reportData)===null||a===void 0?void 0:a.version,ut=((m=(h=this.eu)===null||h===void 0?void 0:h.reportData)===null||m===void 0?void 0:m.project)||ut),Ge.setAttributes({biz_type:Oe.biz_type(0),project:Oe.project(ut),liveroom_version:Oe.liveroom_version(Pe),is_from_cache:Oe.is_from_cache(!1),sev_env:Oe.sev_env(this.pn.testEnvironment?"test":"online"),framework:((S=o.engineOptions)===null||S===void 0?void 0:S.framework)||void 0,logger_rev:us.ZegoLogger.logVersion,build_time:E.bD}),tt=this.an,(Je=e)&&(0,R.Cs)(Je)&&(0,te.zQ)(Je)||(tt.error("ccp.0 appid must be positive integer number and not empty"),0)){this.pn.appid=e,this.pn.configOK=!0,this.pn.sdKVersion=this.version,this.pn.testEnvironment&&(this.pn.mode=Jn.Mode.MODE_TEST),this.netAgent=new Jn.ZegoConnectionAgent(o.proxyCtrl),this.an.setSessionInfo(this.pn.appid,"","","","",this.version),this.netAgent.init(),this.netAgent.setLogger(this.an);var vt={appID:this.pn.appid,env:this.pn.ENV,mode:this.pn.mode};_e&&_e.pri&&(vt.model=1),o.geoFenceType&&o.geoFenceAreaList&&(vt.geoFencing={type:o.geoFenceType,list:o.geoFenceAreaList}),this.netAgent.setAppInfo(vt),this.liveRoomHandler=new ia(this.an,this.pn,this.netAgent,this._dataReport,this);var gt="";s===0?gt="rtc":s===1&&(gt="ali"),this.pn.settingConfig=new si,this.cloudSetting.setLog(this.an),this.cloudSetting.init({productNum:zr,appID:e,env:s,pollingNotify:function(Qt,Wt){q.an.info(nr+" setting file changed "+Qt+" "+JSON.stringify(Wt)),q.pn.actionListener("_cloudSettingNotify",Qt,Wt)},reportNotify:this.lu.bind(this),online:!this.pn.testEnvironment,connection:this.netAgent,inflate:this.an.inflate});var Pt="".concat(nr," default setting.");Pt+=this.du(),this.an.setZipLogConfig(1),this.an.enableWebSocketLog(!0),this.an.info(Pt),this.setAPIReports(),this.cloudSetting.setEnvVariable("environment",gt);var wt=this.cloudSetting.getSettingCache(Fo),At=this.cloudSetting.getSettingCache(hs),Vt=!1,qt=setTimeout(function(){q.an.warn("".concat(nr," time out, get cache settings failed!")),Vt=!0,q.vu(),q.getStoreAppConfig(),Ge.setAttributes({use_na:Oe.use_na(1),connection_rev:q.netAgent.getVersion()}),Ge.end()},500);Promise.all([wt,At]).then(function(Qt){var Wt=Qt[0],zt=Qt[1],Mt="".concat(nr," get cloud config ").concat(Vt);qt&&clearTimeout(qt),q.mu(Wt==null?void 0:Wt.setting),Vt||(q.vu(),q.getStoreAppConfig());var jt=q.du(!0);jt&&(Mt+=jt),q.pu(),q.setAPIReports();var Kt=q.gu("report_script");if(Kt){var $t=Kt.url,yt=Kt.key,Pn=Kt.hash;Mt+=" ; report script ".concat($t," ").concat(yt," ").concat(Pn),$t&&q.cr.loadScript(!1,$t,yt,Pn),Pn&&Ge.setAttributes({lua_md5:Oe.lua_md5(Pn)})}else q.cr.loadScript(!1,"","","");q.an.info(Mt),q.mu(zt==null?void 0:zt.setting);var pn=q.cr.createSpan(E.t0.H,{key:Oe.event},{key:""},Xc);pn.setAttributes({files:$c([{name:Fo,content:JSON.stringify(Wt==null?void 0:Wt.setting),versions:JSON.stringify(Wt==null?void 0:Wt.versions),code:0,message:""},{name:hs,content:JSON.stringify(zt==null?void 0:zt.setting),versions:JSON.stringify(zt==null?void 0:zt.versions),code:0,message:""}])}),pn.end(),Ge.setAttributes({use_na:Oe.use_na(1),connection_rev:q.netAgent.getVersion()}),Ge.end()}).catch(function(Qt){if(qt&&clearTimeout(qt),Ge.setAttributes({use_na:Oe.use_na(1),connection_rev:q.netAgent.getVersion()}),Ge.end(),q.an.warn("".concat(nr,"  initConfig ").concat(JSON.stringify(Qt))),(Qt==null?void 0:Qt.code)===pe.GEO_SET_ERROR.code)throw Error("GeoFencing set Error")});var Gt=this.version;E.F1&&(Gt=Gt+"-"+E.F1,Ge.setAttribute("special_version",E.F1)),this.an.info("".concat(nr," ").concat((x=navigator==null?void 0:navigator.userAgent)!==null&&x!==void 0?x:""," ").concat(Gt," log: ").concat(us.ZegoLogger.logVersion)),this._bindWindowListener(),this.pn.networkState=navigator?navigator.onLine?Te.D2.online:Te.D2.offline:Te.D2.online;var Sn=Rr()==="Firefox"?navigator==null?void 0:navigator.userAgent:navigator==null?void 0:navigator.appVersion;Ge.setAttribute("sys_info",Sn||""),this.bu(),this.an.setSessionInfo(this.pn.appid,"","","","",this.version)}else this.an.error("".concat(nr," init sdk error")),this.cr.setError(Ge,Oe.error.kInvalidParamError);V&&this.setLogConfig(V),this.pn.onListener("roomLoginResponse",this._roomLoginResponseListener)}return Object.defineProperty(o.prototype,"logger",{get:function(){return this.an},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"stateCenter",{get:function(){return this.pn},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"modules",{get:function(){return{service:{sendMessage:function(e){},on:function(e,t){},registerRouter:function(e,t){}}}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isUseNetAgent",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isUaConnect",{get:function(){return this.netAgent.isConnect()},enumerable:!1,configurable:!0}),o.prototype.gu=function(e,t){var n;return t===void 0&&(t=!1),(n=this.pn.settingConfig)===null||n===void 0?void 0:n.getSetting(e,t)},o.prototype.mu=function(e,t){var n;return(n=this.pn.settingConfig)===null||n===void 0?void 0:n.setSetting(e,t)},Object.defineProperty(o.prototype,"reporter",{get:function(){return this.cr},enumerable:!1,configurable:!0}),o.prototype.du=function(e,t){var n={},r=this.gu("remote_log_level",e);return r&&(n.remote_log_level=r,this.an.setRemoteLogLevel(r)),Object.keys(n).length>0?(0,te.iq)(n):""},o.prototype.setEngineConfig=function(e){var t=e.roomRetryTime,n=e.isFlutter;t&&(this.pn.roomRetryTime=t),(0,R.dd)(n)&&(this.pn.isFlutter=n)},o.prototype.destroyRTM=function(){this.pn.roomModulesList.some(function(e){return!(e!=null&&e.isLogout()||e.roomState===ws)})&&this.logoutRoom(),this.cr.setUnloadState(E.t0.I),this.cr.destroy(),this.yu(),this.wu()},o.prototype.hu=function(){this.proxyRes=or,this.getServerError=fe},o.prototype.cu=function(){var e=this.version.split(".").map(function(t){return parseInt(t)});this.pn.sdkVerNum=(this.pn.ENV===0?E.Ks.SDKProject_ZegoWebRTC:E.Ks.SDKProject_ZegoMiniProgram)<<28|e[0]<<20|e[1]<<8|e[2]},o.prototype.bu=function(){this.cr.createSpan(E.t0.H,{key:Cn.event},{key:qn},qn,!0).end()},o.prototype.pu=function(){var e=[],t=[],n=this.pn.advanceConfig.customDomain;if(n!=null&&n.detaillog&&(n==null?void 0:n.detaillog)!=="")e.push(i=n.detaillog),this.an.info($e+" set detaillog url by advance config "+JSON.stringify(e)),this.an.setZipLogDomains(e,t);else if(this.pn.geoFencing){var r=this.pn.geoFencing;this.an.info($e+" geo log is  "+(c=r.detaillog)+" "+(u=r.wssV6Detaillog)),c&&c!==""&&(e.push(c),this.an.info($e+" set detaillog url by geoFencing v4 "+JSON.stringify(e))),u&&u!==""&&(t.push(u),this.an.info($e+" set detaillog url by geoFencing v6 "+JSON.stringify(e))),(e.length>0||t.length>0)&&this.an.setZipLogDomains(e,t)}else{if(this.gu("detaillog_domain")){var i=this.gu("detaillog_domain");this.an.info("".concat($e," set detaillog domain by cloudsetting ").concat(i)),i&&i!==""&&e.push(i)}else if(this.pn.svrDomains){var s=this.pn.svrDomains,c=s.detaillog,u=s.wssV6Detaillog;this.an.info("".concat($e," set detaillog domain by svr ").concat(c," ").concat(u)),c&&c!==""&&e.push(c),u&&u!==""&&t.push(u)}(e.length>0||t.length>0)&&this.an.setZipLogDomains(e,t)}},o.prototype.getStoreAppConfig=function(){if(this.an.info(Ke+" call"),localStorage){var e=Nn(Ci+"_"+this.getAppID()+"_"+(this.pn.mode||Yn.modeNo));if(e){var t=Nn(Si+"_"+this.getAppID()+"_"+(this.pn.mode||Yn.modeNo));t||this.an.info(Ke+" no store config etag");try{var n=mn(e,Lr);if(n?(this.pn.appConfig=JSON.parse(n),this.cr.spanSetAttributes({key:Cn.event},{is_from_cache:Cn.is_from_cache(!0)}),this.pn.actionListener("_appConfigRsp")):localStorage.removeItem(Ci+"_"+this.getAppID()+"_"+(this.pn.mode||Yn.modeNo)),t){var r=mn(t,Lr);this.pn.appConfigEtag=parseInt(r)}}catch(i){this.an.warn(Ke+" "+JSON.stringify(i))}}else this.an.info(Ke+" no store config")}else this.an.warn(Ke+" no localstorage")},o.prototype.vu=function(){var e,t,n,r,i,s,c=this;this.an.info(Qe+" call"),this.netAgent.on("disconnected",function(Mt){c.an.info(Qe+" netAgent disconnect "+c.pn.roomModulesList.length),c.pn.roomModulesList.length>0&&c.netAgent.connectUa()}),this.netAgent.on("connected",function(){c.an.info("".concat(Qe," netAgent connect stack ").concat(Y[c.netAgent.connectIPStackType])),c.pn.agentConnectIPStackType=c.netAgent.connectIPStackType,c.cr.setNetStateCheck(),c.fetchAppConfig(),c.retryRoom(!0)}),this.netAgent.on("broken",function(Mt){c.an.info("".concat(Qe," netAgent broken"))}),this.netAgent.on("dispatchEvent",function(Mt,jt,Kt){if(c.an.info("".concat(Qe," dispatch")),jt==="start"){var $t=c.cr.createSpan(E.t0.H,{key:Mr},{key:""},iu);c.pn.requestList[Mt]=$t}else jt==="end"&&($t=c.pn.requestList[Mt])&&($t.setAttributes({domain_list:ou(Kt.domains),http3_domain_list:su(Kt.http3Domains),wss_v6_domain_list:au(Kt.wssV6Domains),http3_v6_domain_list:hc(Kt.http3V6Domains)}),$t.end())}),this.netAgent.on("dispatchResultUpdate",function(Mt){var jt=Mt.servers,Kt=Mt.domains,$t=Mt.http3Servers,yt=Mt.http3Domains,Pn=Mt.wssV6Servers,pn=Mt.http3V6Servers,un=Mt.wssV6Domains,ln=Mt.http3V6Domains;c.an.info("".concat(Qe," dispatchResult ").concat(JSON.stringify(Mt)));var Mn=c.pn.netGeoFencing;if(Mn.id!==1)Kt&&Kt[0]&&(Mn.accesshub=Kt[0]),yt&&yt[0]&&(Mn.http3Accesshub=yt[0]),un&&un[0]&&(Mn.wssV6Accesshub=un[0]),ln&&ln[0]&&(Mn.http3V6Accesshub=ln[0]),c.setLocalGeoFencing();else{var Hn=function(xi,vi){var yr=Ln(JSON.stringify(vi),Lr);Qn(xi+"_"+c.pn.appid+"_"+(c.pn.mode||Yn.modeNo),yr)};Hn(Vr,jt),Hn(Ai,$t),Hn(Yr,Pn),Hn(Qr,pn)}}),this.netAgent.on("svrAddrResultUpdate",function(Mt){var jt=Mt.accesshub_domain,Kt=Mt.logreport_domain,$t=Mt.detaillog_domain,yt=Mt.geofencing_id,Pn=Mt.accesshub_v6_domain,pn=Mt.http3_v6_domain,un=Mt.logreport_v6_domain,ln=Mt.detaillog_v6_domain;if(yt!==1){var Mn=c.pn.netGeoFencing;Kt&&(Mn.logreport=Kt),un&&(Mn.wssV6Logreport=un),$t&&(Mn.detaillog=$t),ln&&(Mn.wssV6Detaillog=ln),Mn.id=yt,c.setLocalGeoFencing()}else{var Hn=Ln(JSON.stringify({accesshub_domain:jt,logreport_domain:Kt,detaillog_domain:$t,accesshub_v6_domain:Pn,http3_v6_domain:pn,logreport_v6_domain:un,detaillog_v6_domain:ln}),Lr);Qn(fr+"_"+c.pn.appid+"_"+(c.pn.mode||Yn.modeNo),Hn)}Kt&&(c.stateCenter.svrDomains.logreport=Kt,un&&(c.stateCenter.svrDomains.wssV6Logreport=un),c.handleLogUpload(),c._onAppConfigUpdate&&c._onAppConfigUpdate({loggerDomains:[Kt]})),$t&&(c.stateCenter.svrDomains.detaillog=$t,ln&&(c.stateCenter.svrDomains.wssV6Detaillog=ln),c.pu())}),this.netAgent.on("ipDetection",function(Mt){var jt,Kt,$t=Mt.linkConnectDetection,yt=Mt.ipList;if($t&&(c.an.info("".concat(Qe," ip detection v4: ").concat(H[$t.IPv4],", v6: ").concat(H[$t.IPv6])),c.pn.agentIpStackDetection=$t),yt){var Pn=c.cr.createSpan(E.t0.H,{key:k.oq.event},{key:""},k._u.event);Pn.setAttributes({ipv4:k._u.ipv4((jt=yt.ipv4)===null||jt===void 0?void 0:jt[0]),ipv6:k._u.ipv4((Kt=yt.ipv6)===null||Kt===void 0?void 0:Kt[0])}),Pn.end()}}),this.netAgent.on("onceConnectEvent",function(Mt,jt,Kt){if(c.an.info("".concat(Qe," once connect")),jt==="start"){var $t=c.cr.createSpan(E.t0.H,{key:Mr},{key:tu},tu,!0);c.pn.requestList[Mt]=$t}else jt==="end"&&($t=c.pn.requestList[Mt])&&($t.setAttributes(bo({},Kt)),$t.end())}),this.netAgent.on("connectedEvent",function(Mt,jt,Kt){if(c.an.info("".concat(Qe," connect")),jt==="start"){var $t=c.cr.createSpan(E.t0.H,{key:Cn.event},{key:Mr},Mr,!0);c.pn.requestList[Mt]=$t}else jt==="end"&&($t=c.pn.requestList[Mt])&&Kt&&($t.setAttributes({request_count:pl(Kt.count),connect_id:hl(Kt.connectid),first_connect_type:Kt.first_connect_type,connect_type:Kt.connect_type,error:Kt.error||0,server:Kt.server,ip_stack:c.netAgent.connectIPStackType}),$t.end())}),this.netAgent.on("requestEvent",function(Mt,jt,Kt){if(c.an.info("".concat(Qe," request")),jt==="start"){var $t=c.cr.createSpan(E.t0.H,{key:Cn.event},{key:Ia},Ia,!0);c.pn.requestList[Mt]=$t}else jt==="end"&&($t=c.pn.requestList[Mt])&&($t.setAttributes({req_location:cu(Kt.na_req_location),http_code:Kt.status_code,error:Kt.err_code}),$t.end())}),this.netAgent.on("disConnectedEvent",function(Mt){var jt=Mt.duration,Kt=Mt.server,$t=Mt.connectid;c.an.info("".concat(Qe," disconnect"));var yt=c.cr.createSpan(E.t0.H,{key:Cn.event},{key:""},nu);yt.setAttributes({url:cs(Kt),connect_duration:ru(jt),connect_id:fl($t)}),yt.end()}),this.netAgent.on("clientInfo",function(Mt){var jt=Mt.timeOffset,Kt=Mt.geofencingID;(0,R.Cs)(jt)&&c.cr.setTimeOffset(jt),c.Su(),(0,R.Cs)(Kt)&&(c.pn.netGeoFencing.id=Kt)}),this.netAgent.on("heartBeatTimeout",function(){c.pn.actionListener("_uaHeartBeatTimeout")});var u=Le[this.pn.selectIPStackMode];this.an.info("".concat(Qe," select ip stack mode ").concat(u)),this.an.setSettingConfig({ipStackMode:this.pn.selectIPStackMode}),this.netAgent.setSettingConfig({enableHttp3:((e=o.engineOptions)===null||e===void 0?void 0:e.http3)!==void 0?!!o.engineOptions.http3:this.gu("http3")===1,ipStackMode:this.pn.selectIPStackMode,accesshubBypassConnectTime:(t=o.engineOptions)===null||t===void 0?void 0:t.accesshubBypassConnectTime,dispatchTag:(n=o.engineOptions)===null||n===void 0?void 0:n.appDispatchTag});var l=[],a=[],h=[],m=[],S=this.Eu(),x=S.detaillog;l=S.accesshub,h=S.wssV6Accesshub,this.stateCenter.svrDomains.logreport=S.logreport[0],this.stateCenter.svrDomains.detaillog=x[0],this.an.info("".concat(Qe," hard domains ").concat(JSON.stringify(l)));var q=this.Ou();if(this.an.info("".concat(Qe," svr domains ").concat(JSON.stringify(l))),q){var V=q.accesshub_domain,_e=q.logreport_domain,ke=q.detaillog_domain,Pe=q.accesshub_v6_domain,Oe=q.logreport_v6_domain,Ge=q.detaillog_v6_domain;V&&(l=[V],this.stateCenter.svrDomains.accesshub=V),Pe&&(h=[Pe],this.pn.svrDomains.wssV6Accesshub=Pe),_e&&(this.stateCenter.svrDomains.logreport=_e),Oe&&(this.pn.svrDomains.wssV6Logreport=Oe),ke&&(this.stateCenter.svrDomains.detaillog=ke),Ge&&(this.pn.svrDomains.wssV6Detaillog=Ge)}var Je=(r=o.engineOptions)===null||r===void 0?void 0:r.accessDomains;Je&&(l=Je);var tt=this.getGeoDomains();l=(tt==null?void 0:tt.domains)||l,a=(tt==null?void 0:tt.http3Domains)||a,h=(tt==null?void 0:tt.wssV6Domains)||h,m=(tt==null?void 0:tt.http3V6Domains)||m;var ut=!1,vt=this.Iu(),gt=vt.accesshub,Pt=vt.logreport,wt=vt.detaillog;gt&&gt!==""&&(ut=!0,l=[gt],this.stateCenter.svrDomains.accesshub=gt),Pt&&Pt!==""&&(this.stateCenter.svrDomains.logreport=Pt),wt&&wt!==""&&(this.stateCenter.svrDomains.detaillog=wt),this.an.info("".concat(Qe," advance config domains: ").concat(JSON.stringify(vt),", set domains ").concat(JSON.stringify(l),", ")),this.an.info("".concat(Qe," domains ").concat(JSON.stringify(l)," v6domains ").concat(JSON.stringify(h)));var At=l.map(function(Mt){return"wss://".concat(Mt,"/accesshub")}),Vt=a.map(function(Mt){return"https://".concat(Mt,"/accesshub")}),qt=h.map(function(Mt){return"wss://".concat(Mt,"/accesshub")}),Gt=m.map(function(Mt){return"https://".concat(Mt,"/accesshub")});if(this.netAgent.setNetAgentDefaultServers(At,qt),this.dispatchServers=[],this.pn.geoFencing||ut||Je)this.dispatchServers=At,this.dispatchHttp3Servers=Vt,this.dispatchWssV6Servers=qt,this.dispatchHttp3V6Servers=Gt;else{var Sn=this.Ru(),Qt=Sn.http3Servers,Wt=Sn.wssV6Servers,zt=Sn.http3V6Servers;this.dispatchServers=Sn.servers,this.dispatchHttp3Servers=Qt,this.dispatchWssV6Servers=Wt,this.dispatchHttp3V6Servers=zt}!((s=(i=this.stateCenter.advanceConfig)===null||i===void 0?void 0:i.customDomain)===null||s===void 0)&&s.logreport?(this.handleLogUpload(),this.pu()):this.handleLogUpload(),this.an.info(Qe+" dispatch access servers ".concat(JSON.stringify(this.dispatchServers)," ").concat(JSON.stringify(this.dispatchHttp3Servers)," ").concat(JSON.stringify(this.dispatchWssV6Servers)," ").concat(JSON.stringify(this.dispatchHttp3V6Servers))),this.netAgent.setDispatchConnectServers(this.dispatchServers,this.dispatchHttp3Servers,this.dispatchWssV6Servers,this.dispatchHttp3V6Servers)},o.prototype.Tu=function(e){var t=e.split(".");return t[t.length-2]+"."+t[t.length-1]},o.prototype.Iu=function(){var e={},t=this.stateCenter.advanceConfig.customDomain;if(!t)return e;var n=t.accesshub,r=t.logreport,i=t.detaillog;return n&&(e.accesshub=n),r&&(e.logreport=r),i&&(e.detaillog=i),e},o.prototype._replaceMainDomain=function(e){var t,n,r,i;if(this.pn.geoFencing){var s=this.Tu((t=this.pn.geoFencing)===null||t===void 0?void 0:t.accesshub);this.pn.geoFencing.accesshub=(n=this.pn.geoFencing)===null||n===void 0?void 0:n.accesshub.replace(s,e),this.pn.geoFencing.logreport=(r=this.pn.geoFencing)===null||r===void 0?void 0:r.logreport.replace(s,e),this.pn.geoFencing.detaillog=(i=this.pn.geoFencing)===null||i===void 0?void 0:i.detaillog.replace(s,e)}},o.prototype.hashMainDomain=function(){var e=Yn.normalPriDomains.length,t=function(n,r){for(var i=0;n>0;)i+=n%10,n=Math.floor(n/10);return Math.floor(i/r)}(this.getAppID(),e);return Yn.normalPriDomains[t%e]},o.prototype.Eu=function(){var e,t={accesshub:[],wssV6Accesshub:[],logreport:[],detaillog:[]},n=((e=this.eu)===null||e===void 0?void 0:e.prefixDomain)||Yn.prefixDomain,r=Yn.wssV6preFixDomain,i=yi,s=dr,c=this.hashMainDomain(),u=Yn.normalPriDomains.filter(function(l){return l!==c});return t.accesshub=g([c],u,!0).map(function(l){return n+"."+l}),t.wssV6Accesshub=g([c],u,!0).map(function(l){return r+"."+l}),t.logreport=[i+"."+c],t.detaillog=[s+"."+c],t},o.prototype.Ru=function(){var e=this,t=function(n){var r=Nn(n+"_"+e.pn.appid+"_"+(e.pn.mode||Yn.modeNo));if(!r)return[];var i=mn(r,Lr);if(i)try{return JSON.parse(i)}catch{return[]}return[]};return{servers:t(Vr),http3Servers:t(Ai),wssV6Servers:t(Yr),http3V6Servers:t(Qr)}},o.prototype.Ou=function(){var e=Nn(fr+"_"+this.pn.appid+"_"+(this.pn.mode||Yn.modeNo));if(!e)return null;var t=mn(e,Lr);if(t)try{return JSON.parse(t)}catch{return null}return null},o.prototype.Cu=function(e){return Yn.scheme+"://"+e+"/"+Yn.location},o.prototype.getUnloadEventName=function(){var e=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i),t=Rr(),n=navigator.userAgent,r=n.toLowerCase().match(/MicroMessenger/i)=="micromessenger",i=n.indexOf("Android")>-1||n.indexOf("Adr")>-1;return e||r&&i?"pagehide":t==="Firefox"?"beforeunload":"unload"},o.prototype._bindWindowListener=function(){var e=this.getUnloadEventName();window.addEventListener(e,this.ou.unload),window.addEventListener("offline",this.ou.offline),window.addEventListener("online",this.ou.online)},o.prototype.wu=function(){var e=this.getUnloadEventName();window.removeEventListener(e,this.ou.unload),window.removeEventListener("offline",this.ou.offline),window.removeEventListener("online",this.ou.online)},o.prototype.retryRoom=function(e,t,n){if(e===void 0&&(e=!1),n===void 0&&(n=!1),this.logger.info("".concat("zm.rr"," retryNow:").concat(e," roomid:").concat(t,", resetSession:").concat(n)),t){var r=this.pn.roomModulesList.find(function(i){return i.roomID==t});r&&r.retryRoom(e,n)}else this.pn.roomModulesList.forEach(function(i){i==null||i.retryRoom(e,n)})},o.prototype.Au=function(){this.an.info(Fn+" network is online"),this.pn.networkState!==Te.D2.online&&(this.pn.networkState=Te.D2.online,this.yu())},o.prototype.yu=function(){this.ru&&(clearInterval(this.ru),this.ru=null)},o.prototype.zu=function(){var e=this;this.yu(),this.an.info(Nt+" start network online detection.."),this.ru=setInterval(function(){e.pn.networkState!==Te.D2.offline&&e.yu(),e.isUaConnect&&(e.an.info(Nt+" detected network online"),e.Au(),e.yu())},this.su)},o.prototype.uu=function(){this.an.info(Fn+" network is broken"),this.pn.networkState!==Te.D2.offline&&(this.pn.networkState=Te.D2.offline,this.zu())},o.prototype.setLogConfig=function(e){var t,n;this.an.info(_r+" call "+(0,te.iq)(e));var r=this.cr.createSpan(E.t0.H,{key:Cn.event},{key:gr.event},gr.event);if(e.logLevel&&["debug","info","warn","error","report","disable"].includes(e.logLevel)&&(this.an.setLogLevel(e.logLevel),r.setAttributes({log_level:gr.log_level(e.logLevel)})),e.remoteLogLevel&&["debug","info","warn","error","report","disable"].includes(e.remoteLogLevel)&&r.setAttributes({remote_log_level:gr.remote_log_level(e.remoteLogLevel)}),(0,R.QP)(e.logURL)&&(e.logURL.startsWith("wss://")||e.logURL.startsWith("https://")))!((t=this.pn.geoFencing)===null||t===void 0)&&t.logreport?this.an.info(_r+" geo exist"):(this.an.setLogServer([e.logURL],[]),this.pn.customSetLogURL=!0,this.pn.ENV===0&&(this.pn.logDomain=(n=this.an.url)===null||n===void 0?void 0:n.split("/")[2],this.cr.setConfig({serverUrl:"wss://"+this.pn.logDomain+"/zglog/tlog"}))),r.setAttributes({log_url:gr.log_url(e.logURL)}),r.end();else if(e.logURL)return this.an.error(_r+"log url must be a wss or https url"),this.cr.setError(r,gr.error.kInvalidParamError),!1;(0,R.Cs)(e.logSize)||(0,R.Cs)(e.logCount);var i={};return(0,R.Cs)(e.logSize)&&(i.size=e.logSize,r.setAttributes({log_size:e.logSize})),(0,R.Cs)(e.logCount)&&(i.count=e.logCount,r.setAttributes({log_count:e.logCount})),Object.keys(i).length>0&&this.an.setStorageConfig(i),this.an.info(_r+" call success"),r.end(),!0},o.prototype.setDebugVerbose=function(e){var t=this.cr.createSpan(E.t0.H,{key:Cn.event},{key:hr},hr);(0,R.dd)(e)&&(this.pn.debug=e,this.pn.debugCustom=!0,t.setAttributes({debug:vr(e?"true":"false")})),t.end(),this.an.info("zm.sdv call success")},o.prototype.fu=function(e){(0,R.QP)(e)&&e.indexOf("wss")>-1?this.pn.debug=pr(e):Array.isArray(e)&&e.length>0&&e.every(function(t){return(0,R.QP)(t)&&t.indexOf("wss")>-1})?this.pn.debug=pr(e[0]):this.an.info(nr+" server wrong"),this.pn.testEnvironment=this.pn.debug},o.prototype.renewToken=function(e,t){var n,r,i=this,s=this.cr.createSpan(E.t0.H,{key:ur.event,par:t},{key:""},Ts.event);if(!((0,R.TE)(t)||(0,R.QP)(t)&&t!=""))return this.an.error(kt+" roomID must be string and no empty"),!1;var c=this.getRoomModules(t)||this.pn.roomModulesList[0];return c?(0,R.QP)(e)&&c.roomTryHandler?(e===c.roomTryHandler.token?(this.an.info(kt+" token has not changed"),s.setAttributes({error:Ts.error.INPUT_PARAM.code,message:"token has not changed"}),s.end()):(s.setAttributes({token:Ts.token(e)}),this.pn.configRoomAuth?(n=this.liveRoomHandler)===null||n===void 0||n.renewToken({token:e},function(u){var l,a,h,m,S;(l=c.roomTryHandler)===null||l===void 0||l.renewLocalToken(e,(a=u==null?void 0:u.body)===null||a===void 0?void 0:a.token_remain_time),i.cloudSetting.setToken(e);var x=((h=u==null?void 0:u.body)===null||h===void 0?void 0:h.stop_stream_id_list)||((S=(m=u==null?void 0:u.body)===null||m===void 0?void 0:m.stop_stream)===null||S===void 0?void 0:S.stream_id_list)||[];x.length>0&&i.pn.actionListener("_stopStream",x,{code:pe.NO_PUBLISH_AUTH.code,message:pe.NO_PUBLISH_AUTH.msg}),i.cr.setReporterInfo(i.pn.idName||"",e),i.pn.configCheckToken=!0,s.end(),i.an.info(kt+" "+JSON.stringify(u))},function(u){var l,a,h=(l=u==null?void 0:u.body)===null||l===void 0?void 0:l.err_code;i.cr.setError(s,u),!h||h!==1000002014&&h!==2014?i.an.error(kt+" "+JSON.stringify(u)):(i.pn.configCheckToken=!1,(a=c.roomTryHandler)===null||a===void 0||a.renewLocalToken(e),i.cloudSetting.setToken(e),i.an.warn(kt+" "+JSON.stringify(u)))},c):((r=c.roomTryHandler)===null||r===void 0||r.renewLocalToken(e),this.cloudSetting.setToken(e),this.cr.setReporterInfo(this.pn.idName||"",e),s.end())),!0):(0,R.QP)(e)&&!c.roomTryHandler?(this.an.error(kt+" calling must after loginRoom"),this.cr.setError(s,Ts.error.NOT_LOGIN),!1):(this.an.error(kt+" token must be string and not empty"),this.cr.setError(s,Ts.error.INPUT_PARAM),!1):(this.an.error(kt+" calling must after loginRoom"),this.cr.setError(s,Ts.error.NOT_LOGIN),!1)},o.prototype.setCloudSettingURLs=function(e){var t=this;this.an.info(ht+" call "),Array.isArray(e)&&e.length>0&&e.every(function(n){return(0,R.QP)(n)&&n.indexOf("http")>-1})&&this.cloudSetting.init({productNum:zr,appID:this.pn.appid,env:this.pn.ENV,pollingNotify:function(n,r){t.an.info(ht+" setting file changed "+n+" "+JSON.stringify(r)),t.pn.actionListener("_cloudSettingNotify",n,r)},reportNotify:this.lu.bind(this),online:!this.pn.testEnvironment,connection:this.netAgent})},o.prototype.loginRoom=function(e,t,n,r){var i=this;return this.an.info(P+" call by user "+(n==null?void 0:n.userID)+" "+e+" "+this.version+" build: "+E.bD),new Promise(function(s,c){return On(i,void 0,void 0,function(){var u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je=this;return d(this,function(tt){switch(tt.label){case 0:return this.pn.ENV!==1?[3,2]:[4,new Promise(function(ut){})];case 1:tt.sent(),tt.label=2;case 2:if(u=function(ut,vt){vt===void 0&&(vt="");var gt=Je.cr.getAPIErrorReport(ur.event);Je.cr.takeAPIErrorReport(ur.event,ut,gt,n!=null&&n.userID?{id_name:n.userID+""}:{}),c(ut.code&&ut.msg&&vt!==""?{code:ut.code,msg:ut.msg+vt}:ut)},!(r=r||{}).maxMemberCount&&(r.maxMemberCount=0),h=(l=this.pn).roomModulesList,m=ur.error,!(a=l.isMultiRoom)&&h.length>0)return u(m.ROOM_COUNT_EXCEED),[2];for(S=0;S<h.length;S++){if((x=h[S]).roomID===e)return q=this.stateCenter.isFlutter?m.LOGIN_BEFORE_LOGOUT_BY_SAME_ROOMID:m.REPEATEDLY_LOGIN,this.stateCenter.isFlutter&&this.pn.actionListener("roomStateChanged",e,ue.LoginFailed,q.code,q.msg),u(this.stateCenter.isFlutter?m.LOGIN_BEFORE_LOGOUT_BY_SAME_ROOMID:m.REPEATEDLY_LOGIN),[2];if(V=x.roomTryHandler,a&&V&&V.user.userID!==n.userID)return u(m.DIFFERENT_USER_ID),[2]}if(_e=new ls(e,this.pn,this.an,this._dataReport,this,this.liveRoomHandler),(ke=_e.roomTryHandler)||(ke=new Ra(this.an,this.pn,_e),_e.roomTryHandler=ke),ke.init(this.pn.roomRetryTime),ke.initRoom(_e.roomHandler,e,t,n,r),ke.loginCompleted=!1,_e.roomHandler._roomStateHandle(Is,ue.Logining,{code:0,msg:""}),(Pe=ka({roomID:{order:0,value:e,rules:[{name:bn.NOT_EMPTY,error:m.ROOM_ID_NULL},{name:bn.TYPE_STRING,error:m.INPUT_PARAM,extMsg:"roomID must be string"},{name:bn.MAX_LENGTH_128,error:m.ROOM_ID_TOO_LONG},{name:bn.ILLEGAL_CHARACTERS,error:m.ROOM_ID_INVALID_CHARACTER}]},token:{order:1,value:t,rules:[{name:bn.NOT_EMPTY,error:m.INPUT_PARAM},{name:bn.TYPE_STRING,error:m.INPUT_PARAM}]},user:{order:2,value:n,rules:[{name:bn.NOT_EMPTY,error:m.INPUT_PARAM,extMsg:" param user error."},{name:bn.TYPE_OBJECT,error:m.INPUT_PARAM,extMsg:" param user error."}]},"user.userID":{order:3,value:n.userID,rules:[{name:bn.NOT_EMPTY,error:m.USER_ID_NULL,extMsg:" param user error."},{name:bn.TYPE_STRING,error:m.INPUT_PARAM,extMsg:" param userID error."},{name:bn.MAX_LENGTH_64,error:m.USER_ID_TOO_LONG},{name:bn.ILLEGAL_CHARACTERS,error:m.USER_ID_INVALID_CHARACTER}]},"user.userName":{order:4,value:n.userName,rules:[{name:bn.TYPE_STRING,error:m.INPUT_PARAM,extMsg:" userName must be string."},{name:bn.MAX_LENGTH_256,error:m.USER_NAME_TOO_LONG}]},config:{order:5,value:r,rules:[]},"config.maxMemberCount":{order:6,value:r.maxMemberCount,rules:[{name:bn.TYPE_INTEGER,error:m.INPUT_PARAM,extMsg:" maxMemberCount must be integer number."}]}},{action:P,logger:this.an}))!==Vi)return _e.roomHandler._roomStateHandle(ws,ue.LoginFailed,Pe.error,Pe.extMsg),u(Pe.error,Pe.extMsg),[2];if(Oe=this.Du(s,c,e,t,r),Ge=Oe.loginSpan,ke.setLoginRoomCallback(Oe.interResolve,Oe.interReject),this.an.setSessionInfo(this.pn.appid,"","",n.userID,"",this.version),this.pn.roomModulesList.length>0&&this.pn.isMultiRoom==1?_e.isMulti=!0:g([],this.pn.roomModulesList,!0).forEach(function(ut){return ut.roomHandler.logout()}),r&&(_e.config=r),this.pn.roomModulesList.push(_e),this.netAgent&&(this.pn.idName=n.userID,this.netAgent.setUserInfo(n.userID),this.pn.actionListener("_roomLogin",e,t),this.isUaConnect&&this.fetchAppConfig(t)),this.cloudSetting.setUserID(n.userID),this.cloudSetting.setToken(t),this.cloudSetting.activePolling(),Ge.setAttributes({id_name:n.userID}),this.cr.setCommonAttributes({id_name:n.userID}),this.cr.setReporterInfo(n.userID,t),this.an.setTokenInfo(t,n.userID),this.cr.setSpanInMap(Ge,{key:ur.event,par:e}),this.pn.setMultiRoom=!0,!this.isUaConnect){this.an.info(P+" us is not connected"),_e.roomHandler.setRunState(Te.UV.trylogin),ke.startMaxTime();try{this.netAgent.connectUa()}catch(ut){((ut==null?void 0:ut.message)+"").includes("execute")||this.an.warn(P+" connect ua fail "+JSON.stringify(ut==null?void 0:ut.message))}return[2]}return this.pn.networkState=Te.D2.online,ke.retryLoginRoom(!0),[2]}})})})},o.prototype.switchRoom=function(e,t,n){return e===void 0&&(e=""),t===void 0&&(t=""),On(this,void 0,void 0,function(){var r,i,s,c=this;return d(this,function(u){return this.an.info("".concat(de," call by user fromRoomID:").concat(e," toRoomID:").concat(t)),(i=ka({fromRoomID:{order:0,value:e,rules:[{name:bn.NOT_EMPTY,error:(r=ur.error).ROOM_ID_NULL},{name:bn.TYPE_STRING,error:r.INPUT_PARAM,extMsg:"roomID must be string"},{name:bn.MAX_LENGTH_128,error:r.ROOM_ID_TOO_LONG},{name:bn.ILLEGAL_CHARACTERS,error:r.ROOM_ID_INVALID_CHARACTER}]},toRoomID:{order:1,value:t,rules:[{name:bn.NOT_EMPTY,error:r.ROOM_ID_NULL},{name:bn.TYPE_STRING,error:r.INPUT_PARAM,extMsg:"roomID must be string"},{name:bn.MAX_LENGTH_128,error:r.ROOM_ID_TOO_LONG},{name:bn.ILLEGAL_CHARACTERS,error:r.ROOM_ID_INVALID_CHARACTER}]},config:{order:2,value:n,rules:[{name:bn.NOT_EMPTY,error:r.INPUT_PARAM,extMsg:"param config error."},{name:bn.TYPE_OBJECT,error:r.INPUT_PARAM,extMsg:"param config must be object."}]},"config.token":{order:3,value:n==null?void 0:n.token,rules:[{name:bn.NOT_EMPTY,error:r.INPUT_PARAM},{name:bn.TYPE_STRING,error:r.INPUT_PARAM}]},"config.maxMemberCount":{order:4,value:n==null?void 0:n.maxMemberCount,rules:[{name:bn.TYPE_INTEGER,error:r.INPUT_PARAM,extMsg:"maxMemberCount must be integer number."}]}},{action:de,logger:this.an}))!==Vi?(this.an.error(de+" params error:"+i.error.code),[2,Promise.reject({code:i.error.code,msg:i.extMsg?i.error.msg+" "+i.extMsg:i.error.msg})]):this.getRoomModules(e)?(s=this.getRoomModules(t),e===t||s?(this.an.error("".concat(de," params error: ").concat(pe.LOGIN_BEFORE_LOGOUT_BY_SAME_ROOMID.code)),[2,Promise.reject(pe.LOGIN_BEFORE_LOGOUT_BY_SAME_ROOMID)]):(this.stateCenter.actionListener("_beforeSwitchRoom",e),this.logoutRoom(e,!0),[2,new Promise(function(l,a){c.loginRoom(t,(n==null?void 0:n.token)||"",{userID:c.getUserID(),userName:c.getUserName()},{userUpdate:n==null?void 0:n.isUserStatusNotify,maxMemberCount:n==null?void 0:n.maxMemberCount}).then(function(h){c.stateCenter.actionListener("_afterSwitchRoom",t,!0),l(h)}).catch(function(h){c.stateCenter.actionListener("_afterSwitchRoom",t,!1),a(h)})})])):(this.an.error("".concat(de," params error: ").concat(pe.ROOM_ROOMID_INCORRECT.code)),[2,Promise.reject(pe.ROOM_ROOMID_INCORRECT)])})})},o.prototype.handleLogUpload=function(){var e,t;if(this.an.info(ye+" call"),this.pn.customSetLogURL)this.an.info(ye+" set custom log");else if(this.an.url&&this.an.logConnected)this.an.info(ye+" log is connected");else{var n=[],r=[],i=this.pn.advanceConfig.customDomain;if(i&&i.logreport)n.push(u=i.logreport),this.pn.logDomain=u;else if(this.pn.geoFencing){var s=this.pn.geoFencing,c=s.wssV6Logreport;(u=s.logreport)&&n.push(u),c&&r.push(c)}else if(this.pn.testEnvironment)this.pn.logDomain="weblogger-hk-test.zegocloud.com",n.push(this.pn.logDomain);else if(this.stateCenter.ENV===0){if(this.pn.svrDomains){var u,l=this.pn.svrDomains;c=l.wssV6Logreport,(u=l.logreport)&&n.push(u),c&&r.push(c)}}else if(this.stateCenter.ENV===1){this.pn.logDomain=Yn.logreportDomain,n.push(this.pn.logDomain);var a=(t=(e=this.pn.appConfig)===null||e===void 0?void 0:e.app_config)===null||t===void 0?void 0:t.domain;if(a){var h="weblogger".concat(this.pn.appid,"-api.").concat(a);n.push(h)}}if(this.pn.ENV===0){var m=n.map(function(x){return"wss://".concat(x,"/").concat(Yn.rtcLogPath)}),S=r.map(function(x){return"wss://".concat(x,"/").concat(Yn.rtcLogPath)});(m.length>0||S.length>0)&&this.an.setLogServer(m,S)}else m=n.map(function(x){return"https://".concat(x,"/httplog")}),this.an.setLogServer(m,[])}},o.prototype.fetchAppConfigByTargetToken=function(e,t){return On(this,void 0,void 0,function(){var n,r,i,s,c,u,l=this;return d(this,function(a){switch(a.label){case 0:if(this.an.info(De+" call"),!t)return this.an.warn(De+" user not exist"),[2];if(n=this.getUserID(),r="",i=null,e)r=e;else{if(!(this.pn.roomModulesList.length>0))return this.an.warn(De+" token not exist"),[2];r=this.getToken()}!this.an.roomid&&this.an.setSessionInfo(this.pn.appid,"player-no-room","",t,"",this.pn.sdKVersion),a.label=1;case 1:return a.trys.push([1,5,6,7]),this.netAgent.isConnect()?[3,3]:[4,new te.l3(function(h){var m=0,S=function(){m&&clearTimeout(m),l.netAgent.off("connected",S),h(!0)};m=setTimeout(function(){l.netAgent.off("connected",S),h(!1)},5e3),l.netAgent.on("connected",S)})];case 2:if(!a.sent())return this.an.error(De+" ua not connected"),[2];this.an.info(De+" ua connected"),a.label=3;case 3:return this.netAgent.setUserInfo(t),[4,this.netAgent.getAppConfigByAgent("init",r,5e3,this.pn.appConfigEtag,{isSpecial:Te.b$==="SPECIAL"})];case 4:return s=a.sent(),c=s.data,s.code===0&&(this.handleLogUpload(),i=c),[3,7];case 5:return u=a.sent(),this.an.error(De+" token not validated"+u),[3,7];case 6:return n&&this.netAgent.setUserInfo(n),this.an.info(De+" call success"),[2,i];case 7:return[2]}})})},o.prototype.fetchAppConfig=function(e){return On(this,void 0,void 0,function(){var t,n,r,i,s,c,u,l,a,h,m,S,x,q,V,_e,ke;return d(this,function(Pe){switch(Pe.label){case 0:if(this.pn.appConfigFetched)return this.an.warn(ne+" config fetched"),[2];if(!this.getUserID())return this.an.info(ne+" user not exist"),[2];if(t="",e)t=e;else{if(!(this.pn.roomModulesList.length>0))return this.an.warn(ne+" token not exist"),[2];t=this.getToken()}n=this.cr.createSpan(E.t0.H,{key:Cn.event},{key:""},No),this.an.info(P+" initConfig etag: "+this.pn.appConfigEtag),this.pn.appConfigEtag!==-1&&(!(r=this.pn.appConfig.SDKVersion)||this.pn.sdkVerNum>r)&&(this.pn.appConfigEtag=-1,this.an.warn(P+" reset etag. "+r)),i=!!this.pn.appConfig,Pe.label=1;case 1:return Pe.trys.push([1,3,,4]),[4,this.netAgent.getAppConfigByAgent("init",t,5e3,this.pn.appConfigEtag,{isSpecial:Te.b$==="SPECIAL"})];case 2:if(s=Pe.sent(),c=s.code,u=s.data,l=s.etag,a=s.retryCount,n.setAttributes({trigger_reason:ml(this.pn.appConfig?"refresh":"normal"),try_count:uu(a||0),request_etag:this.pn.appConfigEtag,response_etag:l,init_conf:(0,te.iq)(u)}),n.end(),this.pn.appConfigFetched=!0,this.an.info(P+" initConfig code:"+c+" data: "+JSON.stringify(u)+" etag: "+l),this.pn.appConfigEtag!==l){if(Object.keys(u).length==0)return this.an.info(P+" initConfig data null"),[2];S=u.log_config,this.pn.appConfig={app_config:u.app_config,media_config:{publish_config:(h=u.media_config).publish_config,play_config:h.play_config},speedlog_config:bo(bo({},m=u.speedlog_config),{charge_info_report_no_playing:m.charge_info_report_no_playing||0}),log_config:S,SDKVersion:this.pn.sdkVerNum},this.pn.appConfigEtag=l,x=JSON.stringify(this.pn.appConfig),q=Ln(x,Lr),Qn(Ci+"_"+this.getAppID()+"_"+(this.pn.mode||Yn.modeNo),q),V=Ln(this.pn.appConfigEtag+"",Lr),Qn(Si+"_"+this.getAppID()+"_"+(this.pn.mode||Yn.modeNo),V)}return!i&&this.pn.appConfig&&this.pn.actionListener("_appConfigRsp"),!this.pn.netAppConfig&&this.pn.appConfig&&(this.pn.netAppConfig=Object.assign(this.pn.appConfig),this.pn.actionListener("_netAppConfigRsp",this.pn.netAppConfig)),[3,4];case 3:return _e=Pe.sent(),this.an.error(P+" fail "+JSON.stringify(_e)),n.setAttributes({error:_e==null?void 0:_e.code}),n.end(),[20012,20008,20019].includes(_e==null?void 0:_e.code)&&(ke=(_e==null?void 0:_e.code)===20019?JSON.parse(JSON.stringify(pe.SDK_NOT_SPECIAL)):JSON.parse(JSON.stringify(pe.APPID_INVALID)),this.pn.roomModulesList.forEach(function(Oe){Oe.roomTryHandler&&Oe.roomTryHandler.loginFail(ke)})),[3,4];case 4:return[2]}})})},o.prototype.au=function(){var e,t=this;(e=this.cloudSetting)===null||e===void 0||e.fetchMultiSetting([Fo,hs,Zo]).then(function(n){var r;if(t.an.info(P+" settingConfig "+JSON.stringify(n)),n){var i=P+" fetche setting.";t.mu((r=n==null?void 0:n[Fo])===null||r===void 0?void 0:r.setting),t.pn.actionListener("_settingCanFetch",n==null?void 0:n[Zo]);var s=t.du(!0,!0);t.an.info(i+=s),t.pu(),t.setAPIReports();var c=t.gu("report_script");if(c){var u=c.url,l=c.key,a=c.hash;t.an.info("".concat(P," report script ").concat(u," ").concat(l," ").concat(a)),u&&t.cr.loadScript(!0,u,l,a)}}}).catch(function(n){t.an.warn(P+" settingConfig "+JSON.stringify(n))}),this.pn.onListener("_cloudSettingNotify",function(n,r){var i=t.cloudSetting.getEnvVariables()||{},s=t.cr.createSpan(E.t0.H,{key:Cn.event},{key:""},dl);if(s.setAttributes({request_kv:eu(i),files:Ca([{name:n,content:r.setting,versions:r.versions,code:r==null?void 0:r.code,message:r==null?void 0:r.message}])}),s.end(),n===Fo){t.mu(r==null?void 0:r.setting);var c=t.du(!0,!0);c&&t.an.info(P+" setting changed "+c)}})},o.prototype.lu=function(e,t,n){(n==null?void 0:n.code)!==0||(n==null?void 0:n.polling)===!1?t==="request_start"?this.cr.createSpan(E.t0.H,{key:Cn.event},{key:Cs,par:e+""},Cs,!0):t==="request_end"&&this.cr.spanEnd({key:Cs,par:e+""},{request_detail:Oo(n==null?void 0:n.reportData),files:wa(n==null?void 0:n.files),code:n==null?void 0:n.code,request_kv:n==null?void 0:n.requestKV}):this.an.info("zm.crn not report")},o.prototype.Du=function(e,t,n,r,i){var s=this,c=ur,u=this.cr.createSpan(E.t0.I,{key:Cn.event},{key:""},c.event);return u.setAttributes({svr_env:c.svr_env(this.pn.testEnvironment?"test":"online"),token:c.token(r)}),i&&((0,R.dd)(i.userUpdate)&&u.setAttribute("user_state_update",c.user_state_update(i.userUpdate?1:0)),(0,R.Cs)(i.maxMemberCount)&&u.setAttributes({max_member_cnt:c.max_member_cnt(i.maxMemberCount)})),{interResolve:function(l){var a,h=s.getRoomSessionID(n),m=s.getRoomModules(n),S=s.getSessionId(n);u.setAttributes({room_id:c.room_id(n),room_sid_string:c.room_sid_string(h),liveroom_sid_string:c.liveroom_sid_string(S),try_cnt:c.try_cnt((a=m==null?void 0:m.roomTryHandler)===null||a===void 0?void 0:a.retryActiveCount),room_mode:c.room_mode(s.pn.isMultiRoom?1:0),role:c.role(s.pn.role),audience_create_room:c.audience_create_room(s.pn.roomCreateFlag?1:0),max_member_cnt:c.max_member_cnt((m==null?void 0:m.maxMemberCount)||0),user_name:s.pn.nickName}),u.end(),e(l)},interReject:function(l,a){var h,m,S;a===void 0&&(a=""),u.setAttributes({room_id:c.room_id(n)}),l.code<2e9&&l.code>1e9||l.code<1e6?(m=Ze(l.code,l.msg),S=st(l.code)):m={code:l.code,message:l.msg},m&&s.cr.setError(u,{code:m.code,msg:m.message+a}),S&&pe[S]&&(l.code=pe[S].code,!((h=l.msg)===null||h===void 0)&&h.includes("unknown")&&(l.msg=pe[S].msg)),t(l.code&&l.msg&&a!==""?{code:l.code,msg:l.msg+a}:l)},loginSpan:u}},o.prototype.logoutRoom=function(e,t,n){var r=this;this.an.info(He+" call by user "+e);var i=[];if(this.pn.roomModulesList.length){var s="normal logout";if(t?s="switch room":n&&(s="page unload"),e===void 0)g([],this.pn.roomModulesList,!0).forEach(function(a){r.Nu(a,void 0,void 0,s),i.push(a.roomID),a.roomHandler.logout(!0)}),this.cloudSetting.uninit();else{if(!(0,R.QP)(e)||e=="")throw this.an.error(He+" roomID must be string and not empty"),this.Nu(void 0,c=ji.error.ROOM_ROOMID_INCORRECT,void 0,s),this.pn.isFlutter&&this.pn.actionListener("roomStateChanged",e,ue.LogoutFailed,c.code,c.msg),c;var c,u=this.getRoomModules(e);if(!u)throw this.an.error(He+" room not exist "+e),this.Nu(void 0,c=ji.error.ROOM_ROOMID_INCORRECT,e,s),this.pn.isFlutter&&this.pn.actionListener("roomStateChanged",e,ue.LogoutFailed,c.code,c.msg),c;this.Nu(u,void 0,void 0,s),i.push(e),u.roomHandler.logout(!1,t),this.pn.roomModulesList.length===0&&this.cloudSetting.uninit()}this.cr.deleteCommonAttributes(["id_name"]),this.cr.clearRoomSpans(i)}else{this.an.warn(He+" no room");var l={code:0,msg:"no room login"};this.pn.actionListener("roomStateChanged",e,ue.Logout,l.code,l.msg)}},o.prototype.uploadLog=function(e){var t=this;return e===void 0&&(e=!1),new Promise(function(n,r){t.an.info("zm.zip.udlg call "+e),t.an.uploadStorageLog(e).then(function(){t.an.info("zm.zip.udlg call success"),n({errorCode:0,extendedData:"upload logs success!"})}).catch(function(i){t.an.error("zm.zip.udlg upload zip log failed, result: "+((i==null?void 0:i.message)||"unknown")),n({errorCode:pe.UPLOAD_LOG_ERROR.code,extendedData:pe.UPLOAD_LOG_ERROR.msg+", result: "+((i==null?void 0:i.message)||"unknown")})})})},o.prototype.sendCustomCommand=function(e,t,n){return new Promise(function(r,i){console.error(Te.AF.MESSAGE),i()})},o.prototype._sendCustomCommand=function(e,t,n){return new Promise(function(r,i){console.error(Te.AF.MESSAGE),i()})},o.prototype.sendRoomChannelMessage=function(e,t,n,r,i){return new Promise(function(s,c){console.error(Te.AF.MESSAGE),c()})},o.prototype.sendTransparentMessage=function(e,t){return new Promise(function(n,r){console.error(Te.AF.MESSAGE),r()})},o.prototype.sendBroadcastMessage=function(e,t){return new Promise(function(n,r){console.error(Te.AF.MESSAGE),r()})},o.prototype._sendBroadcastMessage=function(e,t,n,r){return new Promise(function(i,s){console.error(Te.AF.MESSAGE),s()})},o.prototype.setRoomExtraInfo=function(e,t,n){return new Promise(function(r,i){console.error(Te.AF.MESSAGE),i()})},o.prototype._setRoomExtraInfo=function(e,t,n){return new Promise(function(r,i){console.error(Te.AF.MESSAGE),i()})},o.prototype.sendBarrageMessage=function(e,t){return new Promise(function(n,r){console.error(Te.AF.MESSAGE),r()})},o.prototype._sendBarrageMessage=function(e,t,n,r){return new Promise(function(i,s){console.error(Te.AF.MESSAGE),s()})},o.prototype.sendRelayMessage=function(e,t,n,r,i){console.error("not support")},o.prototype.requestJoinLive=function(e,t,n,r,i){return console.error(Te.AF.MESSAGE),!1},o.prototype.inviteJoinLive=function(e,t,n,r,i){return console.error(Te.AF.MESSAGE),!1},o.prototype.endJoinLive=function(e,t,n,r){return console.error(Te.AF.MESSAGE),!1},o.prototype.respondJoinLive=function(e,t,n,r,i){return console.error(Te.AF.MESSAGE),!1},o.prototype.getVersion=function(){return this.version},o.prototype.setSdkBizVersion=function(e){(0,R.QP)(e)&&e!==""&&(this.pn.bizVersion=e)},o.prototype.on=function(e,t){return this.pn.listenerList[e]?(0,R.JO)(t)?(this.pn.listenerList[e].indexOf(t)==-1&&this.pn.listenerList[e].push(t),!0):(this.an.error(Ct+" listener callBack must be funciton"),!1):(this.an.error(Ct+" event "+e+" no found"),!1)},o.prototype.off=function(e,t){if(!this.pn.listenerList[e])return this.an.error(St+" listener no found"),!1;var n=this.pn.listenerList[e];if(t){var r=n.indexOf(t);r>=0&&n.splice(r,1)}else this.pn.listenerList[e]=[];return!0},o.prototype._on=function(e,t){return this.pn.listenerList[e]?(0,R.JO)(t)?(this.pn.listenerList[e].indexOf(t)==-1&&this.pn.listenerList[e].push(t),!0):(this.an.error(Ct+" listener callBack must be funciton"),!1):(this.an.error(Ct+" event "+e+" no found"),!1)},o.prototype._off=function(e,t){if(!this.pn.listenerList[e])return this.an.error(St+" listener no found"),!1;var n=this.pn.listenerList[e];return t?n.splice(n.indexOf(t),1):this.pn.listenerList[e]=[],!0},o.prototype.isTestEnvironment=function(){return this.pn.testEnvironment},o.prototype.isLogin=function(e){var t=this.getRoomModules(e)||this.pn.roomModulesList[0];return!!t&&t.isLogin()},o.prototype.getMultiRoom=function(){return this.pn.isMultiRoom},o.prototype.getAppID=function(){return this.pn.appid},o.prototype.getUserID=function(){return this.pn.idName},o.prototype.getUserName=function(){return this.pn.nickName},o.prototype.getToken=function(e){return(this.getRoomModules(e)||this.pn.roomModulesList[0]).token},o.prototype.setRoomCreateFlag=function(e){this.pn.roomCreateFlag=e},o.prototype.setRole=function(e){this.pn.role=e},o.prototype.getSessionId=function(e){var t=this.getRoomModules(e)||this.pn.roomModulesList[0];return t?t.userSidString:"0"},o.prototype.getRoomSessionID=function(e){var t=this.getRoomModules(e)||this.pn.roomModulesList[0];return t?t.roomSidString:"0"},o.prototype.getAppConfig=function(){return this.pn.appConfig},o.prototype.setTestPackageSize=function(e){this.stateCenter.configOK&&(this.pn.testNetPackageSize=e)},o.prototype.setAccess=function(e){},o.prototype.enableMultiRoom=function(e){var t=this.cr.createSpan(E.t0.H,{key:Cn.event},{key:""},ro.event);return(0,R.dd)(e)?(t.setAttribute("is_multi",ro.is_multi(e)),this.pn.roomModulesList.length>0||this.pn.setMultiRoom?(this.an.error(Ut+" multi room can only be set once before first login"),this.cr.setError(t,ro.error.kAlreadyLoginError),!1):(t.end(),this.pn.isMultiRoom=e,this.pn.setMultiRoom=!0,!0)):(this.an.error(Ut+" param must be boolean"),this.cr.setError(t,ro.error.kInvalidParamError),!1)},o.prototype.getRoomModules=function(e){return this.pn.roomModulesList.find(function(t){return t.roomID==e})},o.prototype._onAppConfigUpdate=function(e){},o.prototype._onBeforePageUnload=function(){},o.use=function(e){switch(e.type){case"Message":case"Live":e.install(o,ls,ia)}},o.setGeoFence=function(e,t){if(![0,1,2].includes(e))throw new Error("GeoFencing set Error");if(!t.every(function(n){return kn.find(function(r){return r===n})}))throw new Error("GeoFencing set Error");o.geoFenceType=e,o.geoFenceAreaList=t},o.setEngineOptions=function(e){if(e.geoFenceType){if(![0,1,2].includes(e.geoFenceType))throw new Error("GeoFencing set Error");o.geoFenceType=e.geoFenceType}if(e.geoFenceAreaList){if(!e.geoFenceAreaList.every(function(t){return ii.find(function(n){return n.id===t})}))throw new Error("GeoFencing set Error");o.geoFenceAreaList=e.geoFenceAreaList}if(e.dataReportCustomerContext&&(0,te.zQ)(e.dataReportCustomerContext,!0)&&Na.setReportCustomerContext(e.dataReportCustomerContext),e.customDomain&&e.customDomain&&typeof e.customDomain=="object"){if(e.customDomain.accesshub&&typeof e.customDomain.accesshub!="string")throw new Error("config of customDomain.accesshub should be a string.");if(e.customDomain.logreport&&typeof e.customDomain.logreport!="string")throw new Error("config of customDomain.logreport should be a string.");if(e.customDomain.detaillog&&typeof e.customDomain.detaillog!="string")throw new Error("config of customDomain.detaillog should be a string.");o.customDomain=e.customDomain}o.engineOptions=bo(bo({},o.engineOptions||{}),e)},o.presetLogConfig=function(e){var t={};if(e.logLevel&&["debug","info","warn","error","report","disable"].includes(e.logLevel)&&(t.logLevel=e.logLevel),(0,R.QP)(e.logURL)&&(e.logURL.startsWith("wss://")||e.logURL.startsWith("https://")))t.logURL=e.logURL;else if(e.logURL)throw new Error("log url must be a wss or https url");return this.logConfigForPreset=bo({},t),!0},o.prototype.resetRoomTokenTimer=function(e,t){var n=this.getRoomModules(e)||this.pn.roomModulesList[0];n&&t&&t>0&&n.roomHandler.resetTokenTimer(1e3*t)},o.prototype.isDisConnect=function(){return this.liveRoomHandler.isDisConnect()},o.prototype.sendMessage=function(e,t,n,r){this.liveRoomHandler.sendMessage(e,t,n,r)},o.prototype.getNetworkInfo=function(){var e;return((e=this.netAgent)===null||e===void 0?void 0:e.getNetworkTimeInfo())||{timestamp:0,maxDeviation:0}},o.prototype.setProtoFormat=function(e){if(e===void 0&&(e="json"),!["json","pb"].includes(e))throw new Error("Failed to execute 'setProtoFormat': Arguments 'format' must be 'json' or 'pb'.");this.pn.protoFormat=e},o.prototype.setSdkLoginRelateService=function(e){Array.isArray(e)&&e.every(function(t){return(0,R.QP)(t)})&&(this.pn.relateService=e)},o.prototype.getRoomID=function(){return this.pn.roomid},o.prototype.getServerTimeOffset=function(){return this.pn.serverTimeOffset},o.prototype.getReqHead=function(e){var t;return t=(0,R.QP)(e)&&e!==""&&this.getRoomModules(e)||this.pn.roomModulesList[0],this.liveRoomHandler.getReqHead(t)},o.prototype.sendSwitchMessage=function(e,t){throw this.an.error("".concat("zm.ssm"," ").concat(pe.WHITE_BOARD_VERSION_ERROR.msg)),pe.WHITE_BOARD_VERSION_ERROR},o.prototype.onSwitchMessage=function(e){e&&this.liveRoomHandler&&(this.liveRoomHandler.onSwitchMessage=e)},o.prototype.onAppConfigUpdate=function(e){e&&(this._onAppConfigUpdate=e)},o.prototype.onBeforePageUnload=function(e){e&&(this._onBeforePageUnload=e)},o.prototype.getProtoVer=function(){return Te.I2.SWITCH_TWO},o.prototype.sendBusinessMessage=function(e,t,n){return(0,R.Cs)(e)&&t?this.liveRoomHandler.sendMessage(e,t,void 0,void 0,n,void 0,!1):-1},o.prototype.Nu=function(e,t,n,r){var i=this,s=ji.event,c=this.cr.getAPIErrorReport(s);if(t)c&&this.cr.takeAPIErrorReport(s,t,c);else{var u=this.cr.createSpan(E.t0.I,{key:Cn.event},{key:s,par:e==null?void 0:e.roomID},s,!0);if(u.setAttributes({is_multi:ji.is_multi(this.pn.isMultiRoom),is_send_cmd_net:ji.is_send_cmd_net(!0),reason:ji.reason(r)}),e){var l=e.roomHandler;l.updateTimes(),u.setAttributes({room_id:ji.room_id(e==null?void 0:e.roomID),room_sid_string:ji.room_sid_string(e==null?void 0:e.roomSidString),liveroom_sid_string:ji.liveroom_sid_string(e==null?void 0:e.userSidString),valid_d:l.validTime,total_d:l.totalTime,tempbroken_cnt:l.brokenCounts})}else(0,R.QP)(n)&&u.setAttributes({room_id:ji.room_id(n),valid_d:0,total_d:0,tempbroken_cnt:0});t?this.cr.setError(u,t):u.end(),setTimeout(function(){i.cr.flush()},200)}},o.prototype.getMsgSpan=function(e,t,n){return n===void 0&&(n=!1),this.cr.createSpan(E.t0.H,{key:ur.event,par:t},{key:e,par:t},e,n)},o.prototype.Su=function(){var e=this;(0,R.Cs)(this.netAgent.timeOffset)&&this.cr.setTimeOffset(this.netAgent.timeOffset),this.Pu=setTimeout(function(){e.Su()},9e5)},o.prototype.setNetAgentHBMode=function(e){this.netAgent.setHeartBeatMode(e)},o.prototype.setLocalGeoFencing=function(){var e=this.pn.netGeoFencing;if(e!=null&&e.id&&(e!=null&&e.accesshub)){var t=Ln(JSON.stringify(this.pn.netGeoFencing),Lr);Qn(ri+"_"+this.pn.appid+"_"+(this.pn.mode||Yn.modeNo),t),this.pn.netGeoFencing={}}},o.prototype.getLocalGeoFencing=function(){var e=Nn(ri+"_"+this.pn.appid+"_"+(this.pn.mode||Yn.modeNo));if(!e)return this.an.info(at+" no local geo"),null;var t=mn(e,Lr);if(t)try{return JSON.parse(t)}catch{return this.an.warn(at+" local geo descrypt fail"),null}return null},o.prototype.getGeoDomains=function(){var e,t,n,r;if(o.geoFenceType&&o.geoFenceAreaList){this.an.info("".concat(Qe," geo type ").concat(o.geoFenceType," area ").concat(o.geoFenceAreaList.join(",")));var i=void 0,s=[],c=[],u=[],l=[],a=this._getGeoFencingIDAndDomain(o.geoFenceType,o.geoFenceAreaList);if(!a)throw this.an.warn("".concat(Qe," geofencing not exist")),pe.GEO_SET_ERROR;var h=this.getLocalGeoFencing(),m=!1;if(h!=null&&h.id){var S=a.find(function(V){return V.id===(h==null?void 0:h.id)});S&&(m=!0,i={id:h==null?void 0:h.id,accesshub:(h==null?void 0:h.accesshub)||(S==null?void 0:S.accesshub),logreport:(h==null?void 0:h.logreport)||(S==null?void 0:S.logreport),detaillog:(h==null?void 0:h.detaillog)||(S==null?void 0:S.detaillog),http3Accesshub:(h==null?void 0:h.http3Accesshub)||(S==null?void 0:S.http3Accesshub)||"",wssV6Accesshub:(h==null?void 0:h.wssV6Accesshub)||(S==null?void 0:S.wssV6Accesshub),http3V6Accesshub:(h==null?void 0:h.http3V6Accesshub)||(S==null?void 0:S.http3V6Accesshub)||"",wssV6Detaillog:(h==null?void 0:h.wssV6Detaillog)||"",wssV6Logreport:(h==null?void 0:h.wssV6Logreport)||""},h.accesshub&&s.push(h.accesshub),S.accesshub&&s.push(S.accesshub),h.http3Accesshub&&c.push(h.http3Accesshub),h.wssV6Accesshub&&u.push(h.wssV6Accesshub),S.wssV6Accesshub&&u.push(S.wssV6Accesshub),h.http3V6Accesshub&&l.push(h.http3V6Accesshub))}if(!m){var x=a[0],q=x.accesshub;i={id:x.id,accesshub:q,logreport:x.logreport,detaillog:x.detaillog,wssV6Accesshub:x.wssV6Accesshub},s.push(q)}this.pn.geoFencing=i,this.an.info("".concat(Qe," use geo ").concat(JSON.stringify(this.pn.geoFencing))),e=s,t=c,n=u,r=l}return{domains:e,http3Domains:t,wssV6Domains:n,http3V6Domains:r}},o.prototype._getGeoFencingIDAndDomain=function(e,t){var n=this.hashMainDomain(),r=JSON.parse(JSON.stringify(ii));r.forEach(function(s){s.accesshub+="."+n,s.logreport+="."+n,s.detaillog+="."+n,s.wssV6Accesshub+="."+n});var i=[];return e===1?t.forEach(function(s){var c=r.find(function(u){return u.id===s});c&&i.push(c)}):e===2&&(i=JSON.parse(JSON.stringify(r)),t.forEach(function(s){var c=r.find(function(u){return u.id===s});c&&(i=i.filter(function(u){return u.id!==(c==null?void 0:c.id)}),c.relative_geofencings.forEach(function(u){i=i.filter(function(l){return l.id!==u})}))})),i.length>0?i:null},o.setCloudProxyConfig=function(e,t,n){var r;n?this.proxyCtrl||(this.proxyCtrl=new _u(e,t)):((r=this.proxyCtrl)===null||r===void 0||r.destroy(),this.proxyCtrl=null)},o.setLocalProxyConfig=function(e,t){var n;t?this.proxyCtrl||(this.proxyCtrl=new Sc(e)):((n=this.proxyCtrl)===null||n===void 0||n.destroy(),this.proxyCtrl=null)},o.prototype.setAPIReports=function(){var e=this.pn.settingConfig.getSettingList(["api_error_report","api_login","api_logout","api_start_publish","api_start_play"]),t=e[0],n=e[2],r=e[3],i=e[4],s=function(c,u){return c?u:0};this.cr.setAPIErrorReport("/sdk/login",s(t,e[1])),this.cr.setAPIErrorReport("/sdk/logout",s(t,n)),this.cr.setAPIErrorReport("/sdk/start_publish",s(t,r)),this.cr.setAPIErrorReport("/sdk/start_play",s(t,i))},o.customDomain={},o.proxyCtrl=null,o.pageID="",o}(),O=function(){function o(e,t,n,r){var i;n===void 0&&(n=0),(i=p.proxyCtrl)===null||i===void 0||i.init({appID:e}),this.logger=new us.ZegoLogger(n,p.proxyCtrl||void 0),this.dataReport=new us.ZegoDataReport(this.logger),this.reporter=new Na(this.logger),this.zegoWebRTM=new p(e,t,this.logger,this.dataReport,this.reporter,n,r)}return o.prototype.enableMultiRoom=function(e){return this.zegoWebRTM.enableMultiRoom(e)},o.prototype.loginRoom=function(e,t,n,r){return this.zegoWebRTM.loginRoom(e,t,n,r)},o.prototype.switchRoom=function(e,t,n){return this.zegoWebRTM.switchRoom(e,t,n)},o.prototype.logoutRoom=function(e){return this.zegoWebRTM.logoutRoom(e)},o.prototype.renewToken=function(e,t){return this.zegoWebRTM.renewToken(e,t)},o.prototype.sendBarrageMessage=function(e,t){return this.zegoWebRTM.sendBarrageMessage(e,t)},o.prototype.sendBroadcastMessage=function(e,t){return this.zegoWebRTM.sendBroadcastMessage(e,t)},o.prototype.sendCustomCommand=function(e,t,n){return this.zegoWebRTM.sendCustomCommand(e,t,n)},o.prototype.setRoomExtraInfo=function(e,t,n){return this.zegoWebRTM.setRoomExtraInfo(e,t,n)},o.prototype.sendTransparentMessage=function(e,t){return this.zegoWebRTM.sendTransparentMessage(e,t)},o.prototype.setLogConfig=function(e){return this.zegoWebRTM.setLogConfig(e)},o.presetLogConfig=function(e){return p.presetLogConfig(e)},o.prototype.setDebugVerbose=function(e){return this.zegoWebRTM.setDebugVerbose(e)},o.prototype.on=function(e,t){return this.zegoWebRTM.on(e,t)},o.prototype.getVersion=function(){return this.zegoWebRTM.getVersion()},o.prototype.off=function(e,t){return this.zegoWebRTM.off(e,t)},o.use=function(e){p.use(e)},o.setGeoFence=function(e,t){p.setGeoFence(e,t)},o.setEngineOptions=function(e){p.setEngineOptions(e)},o.setCloudProxyConfig=function(e,t,n){p.setCloudProxyConfig(e,t,n)},o.setLocalProxyConfig=function(e,t){p.setLocalProxyConfig(e,t)},o}(),I=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))},j=function(){function o(){}return o.getSDPVideoCodec=function(e){var t={H264:[],H265:[],VP8:[],VP9:[],OTHER:[]};if(!e.includes("m=video"))return t;var n=/m=video.+/.exec(e)[0];return(n=n.match(/[\s|\d]+/g)[1].replace(" ","")).split(" ").forEach(function(r){var i=new RegExp("a=rtpmap:"+r+".+").exec(e)[0];i.includes("H264")?t.H264.push(r):i.includes("H265")?t.H265.push(r):i.includes("VP8")?t.VP8.push(r):i.includes("VP9")?t.VP9.push(r):t.OTHER.push(r)}),t.OTHER.forEach(function(r){var i=new RegExp("a=fmtp:"+r+".+apt=(\\d+)").exec(e),s=i&&i[1];s&&(t.H264.includes(s)?t.H264.push(r):t.H265.includes(s)?t.H265.push(r):t.VP8.includes(s)?t.VP8.push(r):t.VP9.includes(s)&&t.VP9.push(r))}),t},o.getSDPByVideDecodeType=function(e,t,n,r){var i={str:"",arr:[],obj:{H264:[],H265:[],VP8:[],VP9:[],OTHER:[]}};if(!e.includes("m=video"))return e;var s=/m=video.+/.exec(e)[0];s=s.match(/[\s|\d]+/g)[1].replace(" ",""),i.str=s,i.arr=i.str.split(" "),i.obj=o.getSDPVideoCodec(e);var c=[];if(t==="VP9"?c=I(I(I([],i.obj.H265,!0),i.obj.H264,!0),i.obj.VP8,!0):t==="VP8"?c=I(I(I([],i.obj.H265,!0),i.obj.H264,!0),i.obj.VP9,!0):t==="H264"?c=I(I(I([],i.obj.H265,!0),i.obj.VP8,!0),i.obj.VP9,!0):t==="H265"&&(c=I(I(I([],i.obj.VP8,!0),i.obj.H264,!0),i.obj.VP9,!0)),t=="H264"&&(0,R.dd)(n)){var u=function(h){return function(m){return!!m.includes("profile-level-id=")&&(h?!m.includes("profile-level-id=42e01f"):m.includes("profile-level-id=42e01f"))}},l=function(h){return function(m){if(!m.includes("profile-level-id="))return!1;switch(h){case G.BASE_LINE:return!m.includes("profile-level-id=42");case G.MAIN:return!m.includes("profile-level-id=4d");case G.HIGH:return!m.includes("profile-level-id=64");default:return!1}}},a=function(h){return function(){var m=[];return i.obj.H264.forEach(function(S){for(var x=new RegExp("a=fmtp:"+S+".+\\s\\n","g").exec(e)||[],q=0,V=h;q<V.length;q++)x.filter(V[q]).length!==0&&m.push(S);var _e=new RegExp("a=fmtp:"+S+".+apt=(\\d+)").exec(e),ke=_e&&_e[1];ke&&m.includes(ke)&&m.push(S)}),m}};c=c.concat(function(){for(var h=[],m=0,S=(0,R.TE)(r)||r!==E.B8.HARD_SOFT_ENCODEC_FIRST?(0,R.TE)(r)||r!==E.B8.HIGH_PROFILE_FIRST?[a([l(G.BASE_LINE),u(n)]),a([l(G.BASE_LINE),u(!n)]),a([u(n)]),a([u(!n)])]:[a([l(G.HIGH),u(n)]),a([l(G.HIGH),u(!n)]),a([u(n)]),a([u(!n)])]:[a([u(n),l(G.BASE_LINE)]),a([u(n)]),a([u(!n),l(G.BASE_LINE)]),a([u(!n)])];m<S.length&&(h=(0,S[m])(),new Set(h).size===i.obj.H264.length);m++)h=[];return h}())}return c.forEach(function(h){var m=i.arr.indexOf(h);m>=0&&i.arr.splice(m,1);var S=new RegExp("a=rtpmap:"+h+".+\\s\\n","g"),x=new RegExp("a=rtcp-fb:"+h+".+\\s\\n","g"),q=new RegExp("a=fmtp:"+h+".+\\s\\n","g");e=(e=(e=e.replace(S,"")).replace(x,"")).replace(q,"")}),e=e.replace(s,i.arr.join(" "))},o}(),je=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Be=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},rt=function(){function o(){var e=this,t=te.VJ.createElement("canvas"),n=t.getContext("2d");n.fillStyle="rgba(255, 255, 255, 0)";try{this.xu=t.captureStream()}catch(r){console.error("canvas captureStream error",r)}this.qu=setInterval(function(){n.fillText("test",Math.floor(640*Math.random()),Math.floor(480*Math.random()))},33),this.Lu=setTimeout(function(){e.Bu&&e.Bu("Detection timeout"),e.hangup()},5e3)}return o.prototype.checkSupportByType=function(e,t){return je(this,void 0,void 0,function(){var n,r,i=this;return Be(this,function(s){switch(s.label){case 0:return this.checkType=e,n={},this.Uu=new RTCPeerConnection(n),this.Gu=new RTCPeerConnection(n),r=new te.l3(function(c){return i.Bu=c}),this.Uu.addEventListener("icecandidate",function(c){return i.onIceCandidate(i.Uu,c)}),this.Gu.addEventListener("icecandidate",function(c){return i.onIceCandidate(i.Gu,c)}),this.Uu.addEventListener("iceconnectionstatechange",function(c){i.Uu.iceConnectionState==="connected"&&(i.Ju=setTimeout(function(){return je(i,void 0,void 0,function(){var u=this;return Be(this,function(l){switch(l.label){case 0:return[4,this.Uu.getStats()];case 1:return l.sent().forEach(function(a){if(a.type==="outbound-rtp"&&a.kind==="video"){var h=a.framesEncoded!==void 0&&a.framesEncoded>0;u.Fu=!0,u.Vu=h,u.Qu&&u.detectIsSupported(e)}}),[2]}})})},1e3))}),this.Gu.addEventListener("iceconnectionstatechange",function(c){i.Gu.iceConnectionState==="connected"&&(i.Ku=setTimeout(function(){return je(i,void 0,void 0,function(){var u=this;return Be(this,function(l){switch(l.label){case 0:return[4,this.Gu.getStats()];case 1:return l.sent().forEach(function(a){if(a.type==="inbound-rtp"&&a.kind==="video"){var h=a.framesDecoded!==void 0&&a.framesDecoded>0;u.Qu=!0,u.Zu=h,u.Fu&&u.detectIsSupported(e)}}),[2]}})})},1e3))}),this.xu.getTracks().forEach(function(c){return i.Uu.addTrack(c,i.xu)}),[4,this.check(e)];case 1:return s.sent(),[4,r];case 2:return[2,s.sent()]}})})},o.prototype.check=function(e,t){return je(this,void 0,void 0,function(){var n,r;return Be(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t&&(0,R.JO)(this.Uu.addTransceiver)&&(this.Uu.addTransceiver("video",{direction:"sendonly"}),this.Uu.addTransceiver("audio",{direction:"sendonly"})),[4,this.Uu.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})];case 1:return(n=i.sent()).sdp=j.getSDPByVideDecodeType(n.sdp,e),this.onCreateOfferSuccess(n),[3,3];case 2:return r=i.sent(),this.onCreateSessionDescriptionError(r),[3,3];case 3:return[2]}})})},o.prototype.onCreateOfferSuccess=function(e){return je(this,void 0,void 0,function(){var t,n,r,i;return Be(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.Uu.setLocalDescription(e)];case 1:return s.sent(),[3,3];case 2:return t=s.sent(),this.onSetSessionDescriptionError(t),[2];case 3:return s.trys.push([3,5,,6]),[4,this.Gu.setRemoteDescription(e)];case 4:return s.sent(),[3,6];case 5:return n=s.sent(),this.onSetSessionDescriptionError(n),[2];case 6:return s.trys.push([6,9,,10]),[4,this.Gu.createAnswer()];case 7:return r=s.sent(),[4,this.onCreateAnswerSuccess(r)];case 8:return s.sent(),[3,10];case 9:return i=s.sent(),this.onCreateSessionDescriptionError(i),[2];case 10:return[2]}})})},o.prototype.onCreateAnswerSuccess=function(e){return je(this,void 0,void 0,function(){var t,n;return Be(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.Gu.setLocalDescription(e)];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),this.onSetSessionDescriptionError(t),[2];case 3:return r.trys.push([3,5,,6]),[4,this.Uu.setRemoteDescription(e)];case 4:return r.sent(),[3,6];case 5:return n=r.sent(),this.onSetSessionDescriptionError(n),[2];case 6:return[2]}})})},o.prototype.onIceCandidate=function(e,t){return je(this,void 0,void 0,function(){var n;return Be(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getOtherPc(e).addIceCandidate(t.candidate)];case 1:return r.sent(),[3,3];case 2:return n=r.sent(),console.error(this.checkType,"".concat(this.getPcName(e)," addIceCandidate error"),n),this.hangup(),this.Bu(n),[3,3];case 3:return this.getPcName(e)==="_zgp_remotePc"&&t.candidate&&(this.iceCandidate=!0),[2]}})})},o.prototype.getOtherPc=function(e){return e===this.Uu?this.Gu:this.Uu},o.prototype.getPcName=function(e){return e===this.Uu?"_zgp_localPc":"_zgp_remotePc"},o.prototype.onCreateSessionDescriptionError=function(e){console.error("Failed to create session description: ".concat(e.toString())),this.hangup(),this.Bu(e)},o.prototype.onSetSessionDescriptionError=function(e){console.error("Failed to set session description: ".concat(e.toString())),this.hangup(),this.Bu(e)},o.prototype.detectIsSupported=function(e){this.Bu(!(!this.Vu||!this.Zu)||"The browser does not support ".concat(e," format")),this.hangup()},o.prototype.hangup=function(){this.Uu.close(),this.Gu.close(),this.xu.getTracks().forEach(function(e){return e.stop()}),this.Lu&&(clearTimeout(this.Lu),this.Lu=null),this.Ju&&(clearTimeout(this.Ju),this.Ju=null),this.Ku&&(clearTimeout(this.Ku),this.Ku=null),this.Fu=!1,this.Qu=!1,this.qu&&(clearInterval(this.qu),this.qu=null)},o}();const qe="[a-fA-F\\d:]",re=o=>o&&o.includeBoundaries?`(?:(?<=\\s|^)(?=${qe})|(?<=${qe})(?=\\s|$))`:"",Rt="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",Ht="[a-fA-F\\d]{1,4}",xt=`
(?:
(?:${Ht}:){7}(?:${Ht}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${Ht}:){6}(?:${Rt}|:${Ht}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${Ht}:){5}(?::${Rt}|(?::${Ht}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${Ht}:){4}(?:(?::${Ht}){0,1}:${Rt}|(?::${Ht}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${Ht}:){3}(?:(?::${Ht}){0,2}:${Rt}|(?::${Ht}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${Ht}:){2}(?:(?::${Ht}){0,3}:${Rt}|(?::${Ht}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${Ht}:){1}(?:(?::${Ht}){0,4}:${Rt}|(?::${Ht}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${Ht}){0,5}:${Rt}|(?::${Ht}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),En=new RegExp(`(?:^${Rt}$)|(?:^${xt}$)`),Xt=new RegExp(`^${Rt}$`),tn=new RegExp(`^${xt}$`),dn=o=>o&&o.exact?En:new RegExp(`(?:${re(o)}${Rt}${re(o)})|(?:${re(o)}${xt}${re(o)})`,"g");dn.v4=o=>o&&o.exact?Xt:new RegExp(`${re(o)}${Rt}${re(o)}`,"g"),dn.v6=o=>o&&o.exact?tn:new RegExp(`${re(o)}${xt}${re(o)}`,"g");var gn=dn;const{toString:wn}=Object.prototype,Gn={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function Er(o,e={}){if(wn.call(o)!=="[object RegExp]")throw new TypeError("Expected a RegExp instance");const t=Object.keys(Gn).map(r=>(typeof e[r]=="boolean"?e[r]:o[r])?Gn[r]:"").join(""),n=new RegExp(e.source||o.source,t);return n.lastIndex=typeof e.lastIndex=="number"?e.lastIndex:o.lastIndex,n}function $n(o,e,{timeout:t}={}){try{return function(n){const r=(...i)=>n(...i);return Object.defineProperty(r,"name",{value:`functionTimeout(${n.name||"<anonymous>"})`,configurable:!0}),r}(()=>Er(o).test(e))()}catch(n){throw n}}const Un={timeout:400};function Br(o){return!(o.length>45)&&$n(gn.v6({exact:!0}),o,Un)}function Cr(o){return!(o.length>15)&&$n(gn.v4({exact:!0}),o,Un)}function wr(o){return[o>>24&255,o>>16&255,o>>8&255,255&o].join(".")}function ki(o){var e=o.split(".");return(parseInt(e[0])<<24)+(parseInt(e[1])<<16)+(parseInt(e[2])<<8)+parseInt(e[3])}function $r(o){var e=o.split(".");return e?(parseInt(e[1])<<24|parseInt(e[2])<<16|parseInt(e[3])<<8|parseInt(e[4]))>>>0:0}function Yi(o){return Br(o)}function Ar(o){return function(e){return Cr(e)}(o)?Y.IPv4:Yi(o)?Y.IPv6:-1}function Fi(o){var e=o.match(/^[^:]*:(.*?):[^:]*$/);return e?e[1]:""}var pi=function(){return pi=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},pi.apply(this,arguments)},Os=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},so=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Mi=k.eU.error.wn;function oa(o,e){return Os(this,void 0,void 0,function(){return so(this,function(t){return e&&(0,R.JO)(o.addTransceiver)&&(o.addTransceiver("video",{direction:"sendonly"}),o.addTransceiver("audio",{direction:"sendonly"})),[2,o.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})]})})}function sa(o,e,t,n,r){var i;return Os(this,void 0,void 0,function(){var s,c,u,l,a,h,m;return so(this,function(S){switch(S.label){case 0:if(s={webRTC:!1,customCapture:!1,camera:!1,microphone:!1,videoCodec:{H264:!1,H265:!1,VP8:!1,VP9:!1},screenSharing:o,errInfo:{}},n&&n==="screenSharing")return e({result:o,errInfo:s.errInfo}),[2];if((!n||n==="customCapture")&&(((c=te.VJ.createElement("video")).captureStream||c.mozCaptureStream)&&(s.customCapture=!0),n==="customCapture"))return e({result:s.customCapture,errInfo:s.errInfo}),[2];if(u=!!(!((i=navigator==null?void 0:navigator.mediaDevices)===null||i===void 0)&&i.getUserMedia),function(){var x=window.location.protocol!=="https:"&&window.location.protocol!=="file:"&&window.location.hostname.indexOf("127.0.0.1")==-1&&window.location.hostname.indexOf("localhost")==-1;if(x&&(console.error("webrtc requires https or localhost"),!u))throw new Error("webrtc requires https or localhost");return!x}(),n&&n!=="camera"&&n!=="microphone")return[3,10];if(!u)return[3,9];if(n&&n!=="camera")return[3,4];S.label=1;case 1:return S.trys.push([1,3,,4]),[4,Wi({video:!0,audio:!1})];case 2:return(l=S.sent())&&(s.camera=!0)&&l.getTracks().forEach(function(x){x.stop()}),[3,4];case 3:return a=S.sent(),s.errInfo.camera={name:a.name,message:a.message},console.error("camera devices detect error: ",a.name,a.message),[3,4];case 4:if(n&&n!=="microphone")return[3,8];S.label=5;case 5:return S.trys.push([5,7,,8]),[4,navigator.mediaDevices.getUserMedia({audio:!0,video:!1})];case 6:return(h=S.sent())&&(s.microphone=!0)&&h.getTracks().forEach(function(x){return x.stop()}),[3,8];case 7:return m=S.sent(),s.errInfo.microphone={name:m.name,message:m.message},console.error("microphone devices detect error: ",m.name,m.message),[3,8];case 8:return[3,10];case 9:s.camera=!1,s.microphone=!1,S.label=10;case 10:return n==="camera"||n==="microphone"?(e({result:s[n],errInfo:s.errInfo}),[2]):(function(x,q,V,_e){Os(this,void 0,void 0,function(){var ke,Pe,Oe,Ge,Je,tt,ut,vt,gt,Pt;return so(this,function(wt){switch(wt.label){case 0:return ke={webRTC:!1,H264:!1,VP8:!1,VP9:!1,H265:!1},V?q!==1||V!=="VP8"&&V!=="H264"&&V!=="H265"?[3,2]:[4,(Pt=new rt).checkSupportByType(V,_e)]:[3,2];case 1:return Pe=wt.sent(),(0,R.dd)(Pe)?(ke[V]=Pe,[2,x(ke)]):(ke[V]=!1,[2,x(ke,Pe)]);case 2:if(V!=="webRTC"&&q!==1)return[3,7];wt.label=3;case 3:return wt.trys.push([3,5,,6]),[4,oa(new RTCPeerConnection,_e)];case 4:return wt.sent(),ke.webRTC=!0,[3,6];case 5:return Oe=wt.sent(),x&&x(ke,Oe),[3,6];case 6:if(V==="webRTC")return[2,x(ke)];wt.label=7;case 7:if(q===1){for(Ge="",tt=[],ut=0,vt=Je=["VP8","H264","H265"];ut<vt.length;ut++)gt=vt[ut],Pt=new rt,tt.push(Pt.checkSupportByType(gt));return Promise.all(tt).then(function(At){At.forEach(function(Vt,qt){(0,R.dd)(Vt)?ke[Je[qt]]=!0:(ke[Je[qt]]=!1,Ge=Vt)}),Ge?x(ke,Ge):x(ke)}),[2]}try{oa(new RTCPeerConnection,_e).then(function(At){if(ke.webRTC=!0,At&&At.sdp){var Vt=At.sdp.split(`\r
`);if(ke.H264=Vt.some(function(qt){return qt.startsWith("a=rtpmap:")&&qt.indexOf("H264/")>-1}),V==="H264"||(ke.VP8=Vt.some(function(qt){return qt.startsWith("a=rtpmap:")&&qt.indexOf("VP8/")>-1}),V==="VP8"))return x(ke);ke.VP9=Vt.some(function(qt){return qt.startsWith("a=rtpmap:")&&qt.indexOf("VP9/")>-1}),ke.H265=Vt.some(function(qt){return qt.startsWith("a=rtpmap:")&&qt.indexOf("H265/")>-1}),x&&x(ke)}})}catch(At){x&&x(ke,At)}return[2]}})})}(function(x,q){n||(s.videoCodec.H264=x.H264,s.videoCodec.H265=x.H265,s.videoCodec.VP8=x.VP8,s.videoCodec.VP9=x.VP9,s.webRTC=x.webRTC),q&&((0,R.QP)(q)?s.errInfo.extendedDate=q:s.errInfo.webRTC={name:q.name,message:q.message},console.error("videoCodec detect error: "+q)),e&&e(n?{result:x[n],errInfo:s.errInfo}:s)},t,n,r),[2])}})})}var Pc={supportDetection:sa},aa=function(o){return(0,R.w)(o)&&o.videoQuality!==void 0&&[1,2,3].includes(o.videoQuality)&&(delete o.width,delete o.height,delete o.frameRate,delete o.bitRate),o};function mr(o){var e={};for(var t in o){var n=o[t];if(n instanceof Object){var r=n instanceof MediaStream||n instanceof HTMLElement;e[t]=r?n:mr(n)}else n!==void 0&&(e[t]=n)}return e}function _o(o){return Uint8Array.from(Array.from(window.unescape(encodeURIComponent(o))).map(function(e){return e.charCodeAt(0)}))}var Kr=function(o){return o.split(`
m=`).map(function(e,t){return(t>0?"m="+e:e).trim()+`\r
`})};function Ns(o){var e=function(i,s){return function(c){return c.trim().split(`
`).map(function(u){return u.trim()})}(i).filter(function(c){return c.indexOf(s)===0})},t=Kr(o),n=[],r=[];return t.forEach(function(i,s){var c=function(l){var a=e(l,"a=mid:")[0];if(a)return a.substr(6)}(i),u=e(i,"a=candidate:").map(function(l){return r.push(l),pi(pi({},function(a){for(var h,m={foundation:(h=a.indexOf("a=candidate:")===0?a.substring(12).split(" "):a.substring(10).split(" "))[0],component:parseInt(h[1],10),protocol:h[2].toLowerCase(),priority:parseInt(h[3],10),ip:h[4],address:h[4],port:parseInt(h[5],10),type:h[7]},S=8;S<h.length;S+=2)switch(h[S]){case"raddr":m.relatedAddress=h[S+1];break;case"rport":m.relatedPort=parseInt(h[S+1],10);break;case"tcptype":m.tcpType=h[S+1];break;case"ufrag":m.ufrag=h[S+1],m.usernameFragment=h[S+1];break;default:m[h[S]]=h[S+1]}return m}(l)),{mid:c})});n.push.apply(n,u)}),[n,r]}function Ti(o){var e=Ns(o)[0];if(e.length>0){var t=e[0].ip,n=Ar(t)===Y.IPv6?"[".concat(t,"]"):t;return["turn:".concat(n,":3478?transport=udp"),"turn:".concat(n,":443?transport=tcp"),"turn:".concat(n,":3478?transport=tcp")]}return[]}function Ac(o){var e=o.match(/a=ice-ufrag:(\S+)/);return e?e[1]:""}function bi(o){var e=o.match(/a=ice-pwd:(\S+)/);return e?e[1]:""}function Dr(o){var e=o.split(":");return o.replace(":"+e[e.length-1],"")}function cr(o){var e=E.ey.RTC;switch(o){case 1:case 3:e=E.ey.CDN;break;case 2:e=E.ey.L3;break;default:e=E.ey.RTC}return e}function _i(o){return(0,R.QP)(o)&&Number(o.split(".")[0])||0}function Ir(o,e,t,n){var r=o.version,i=o.name.toLowerCase(),s=_i(r);return i===e&&(n===0&&s<t||n===1&&s===t||n===2&&s>t)}function Wi(o){var e=this;return new te.l3(function(t,n){return Os(e,void 0,void 0,function(){var r,i,s,c,u,l;return so(this,function(a){switch(a.label){case 0:r=[pi({},o),pi(pi({},o),{video:{width:360}}),pi(pi({},o),{video:{width:640}}),pi(pi({},o),{video:{width:720}}),pi(pi({},o),{video:{width:854}}),pi(pi({},o),{video:{width:1280}})],i=null,s=null,c=0,a.label=1;case 1:if(!(c<r.length))return[3,6];u=r[c],a.label=2;case 2:return a.trys.push([2,4,,5]),[4,navigator.mediaDevices.getUserMedia(u)];case 3:return i=a.sent(),[3,6];case 4:return l=a.sent(),s=l,[3,5];case 5:return c++,[3,1];case 6:return i?t(i):n(s),[2]}})})})}function er(o,e,t){var n=JSON.parse(JSON.stringify(o));if(e.forEach(function(i){var s=n.indexOf(i);s>=0&&(n.splice(s,1),n.push(i))}),!t){var r=n.findIndex(function(i){return i===o[0]});r>0&&(n.splice(r,1),n.unshift(o[0]))}return n}function ai(o,e,t){var n=JSON.parse(JSON.stringify(o));if(e.forEach(function(i){var s=n.findIndex(function(c){return c.ip===i.ip});s>=0&&(n.splice(s,1),n.push(i))}),!t){var r=n.findIndex(function(i){return i.ip===o[0].ip});r>0&&(n.splice(r,1),n.unshift(o[0]))}return n}function Tr(o){return o.ip+":"+o.port}function Ui(o,e){return o.findIndex(function(t){return e.includes(t.ip)&&e.includes(t.port+"")})}function pd(o,e){var t;if(e==="chrome"||e==="safari")switch(o){case 0:t="tls";break;case 1:t="tcp";break;case 2:t="udp"}else if(e==="firefox")switch(o){case 0:t="tcp";break;case 5:t="udp"}return t}function Dc(o,e){if(e===void 0&&(e="video"),!(o instanceof MediaStream))return null;for(var t=e=="video",n=document.querySelectorAll(e),r=null,i=0;i<n.length;i++){var s=n[i],c=s.srcObject;if(c&&(c===o||(t?c.getVideoTracks()[0]===o.getVideoTracks()[0]:c.getAudioTracks()[0]===o.getAudioTracks()[0]))){if(s.currentTime)return s;r=s}}return r}function ku(o,e){navigator.mediaDevices!==void 0&&navigator.mediaDevices.enumerateDevices!==void 0?navigator.mediaDevices.enumerateDevices().then(function(t){for(var n=[],r=[],i=[],s=0;s<t.length;s++){var c=t[s];c.kind==="audioinput"&&n.push({deviceName:c.label,deviceID:c.deviceId}),c.kind==="audiooutput"&&r.push({deviceName:c.label,deviceID:c.deviceId}),c.kind==="videoinput"&&i.push({deviceName:c.label,deviceID:c.deviceId})}o&&o({microphones:n,speakers:r,cameras:i})}).catch(function(t){console.error("enumerate devices wrong "+t),e&&e(k.gf.error.je)}):e&&e(k.gf.error.yn)}function fd(o,e){if((0,R.TE)(o))return e(Mi," bitrate is required when videoQuality is 4"),!1;if((0,R.Cs)(o)){if(!D(o,0,10240))return e(Mi," bitrate must be integer number"),!1;if(!function(t,n){return!(t>10240&&(n(Mi," bitrate cannot greater than 10 Mbps"),1))}(o,e))return!1}else e(Mi," bitrate must be number");return!0}function Pu(o,e,t,n){if(!(0,R.w)(o))return{result:!1,message:"Invalid constraint. Constraint Extend must be a object"};if(Object.keys(o).length===0)return{result:!1,message:"".concat(e," can not be a empty object")};for(var r=0,i=["exact","ideal","max","min"];r<i.length;r++){var s=i[r],c=o[s];if((0,R.Cs)(c)&&!(0,te.zQ)(c,!1))return{result:!1,message:" ".concat(s," of ").concat(e," must be integer number")};if((0,R.Cs)(t)&&(0,R.Cs)(c)&&c<t)return{result:!1,message:" ".concat(s," of ").concat(e," must greater than ").concat(t)};if((0,R.Cs)(n)&&(0,R.Cs)(c)&&c>n)return{result:!1,message:" ".concat(s," of ").concat(e," cannot greater than ").concat(n)}}return{result:!0,message:"Constraint Extend OK."}}function Dl(o,e,t,n,r){var i=Pu(o,e,n,r);return i.result||t&&t(Mi,i.message),i.result}function md(o,e,t){for(var n=0,r=o;n<r.length;n++){var i=r[n],s=e[i];if((0,R.TE)(s))return t&&t(Mi," ".concat(i," is required when videoQuality is 4")),!1;if((0,R.Cs)(s)&&!(0,te.zQ)(s,!1))return t&&t(Mi," ".concat(i," must be integer number")),!1;if((0,R.Cs)(s)&&(i==="width"||i==="height")&&s<0)return t&&t(Mi," ".concat(i," must greater than 0.")),!1;if((0,R.Cs)(s)&&i==="width"&&s>7680)t&&t(Mi," ".concat(i," cannot greater than 7680."));else if((0,R.Cs)(s)&&i==="height"&&s>4320)t&&t(Mi," ".concat(i," cannot greater than 4320."));else if((0,R.w)(s)){if(i==="width"&&!Dl(s,i,t,0,7680)||i==="height"&&!Dl(s,i,t,0,4320)||i==="frameRate"&&!Dl(s,i,t))return!1}else if(!(0,R.Cs)(s)&&(0,R.w)(s))return t&&t(Mi," ".concat(i," must be number or object")),!1}return!0}function Au(o){return o&&o.readyState==="live"?o.enabled===!0?0:3:2}function Va(o){return((0,R.Cs)(o)?o:o.exact?o.exact:o.ideal?o.ideal:o.min||o.max)||0}function Fa(o){if(!function(t){return!!/^(\d{1,3}\.){3}\d{1,3}$/.test(t)&&t.split(".").map(function(n){return parseInt(n,10)}).every(function(n){return n>=0&&n<=255})}(o))throw new Error("Invalid IPv4 address");var e=o.split(".").map(function(t){return parseInt(t,10)}).map(function(t){return t.toString(16).padStart(2,"0")});return"64:ff9b::".concat(e[0]).concat(e[1],":").concat(e[2]).concat(e[3])}var qa=function(o){Array.isArray(o.ips)&&(o.ips=o.ips.map(function(e){var t=e.priority,n=e.vid;return{ip:e.ip,port:e.port,priority:di.A.isLong(t)?t.toString():t,vid:n}})),Array.isArray(o.ipv6s)&&(o.ipv6s=o.ipv6s.map(function(e){var t=e.priority,n=e.vid;return{ip:e.ip,port:e.port,priority:di.A.isLong(t)?t.toString():t,vid:n}}))},ie=pt(1290),Oh=function(){function o(e,t){this.an=e,this.Xu=t,this.debug=!1,this.testEnvironment=!1,this.pullLimited=!0,this.useNetAgent=!0,this.configOK=!1,this.relateService=[],this.role=2,this.maxMemberCount=0,this.roomCreateFlag=1,this.netMode=E.Am.Default,this.callbackList={},this.experimentalAPIList={onRecvRoomMuteVideoStream:0,onRecvRoomMuteAudioStream:0,onRecvRoomChannelMessage:0,onVolumeDuckingUpdate:0},this.publishStreamList={},this.streamUrlMap={},this.cmdCallback={},this.customUrl=[],this.customPlayUrl=[],this.turnToTcp=!1,this.turnOverTcpOnly=void 0,this.audioEffectBuffer={},this.audioBitRate=48e3,this.cdnSeq=0,this.engineDestroy=!1,this.listenerList={roomStreamUpdate:[],streamExtraInfoUpdate:[],playerStateUpdate:[],publisherStateUpdate:[],screenSharingEnded:[],publishQualityUpdate:[],playQualityUpdate:[],remoteCameraStatusUpdate:[],remoteMicStatusUpdate:[],soundLevelUpdate:[],capturedSoundLevelUpdate:[],videoDeviceStateChanged:[],audioDeviceStateChanged:[],deviceError:[],_deviceError:[],_remoteCameraStatusUpdate:[],_remoteMicStatusUpdate:[],_streamUpdated:[],receiveRealTimeSequentialData:[],playerRecvSEI:[],beautyEffectError:[],_engineConfigUpdate:[],backgroundEffectError:[],exceptionUpdate:[],networkQuality:[],mixerSoundLevelUpdate:[],autoMixerSoundLevelUpdate:[],mixerRelayCDNStateUpdate:[],_engineDestroy:[],recvExperimentalAPI:[],playerVideoTrackUpdate:[],playerAudioTrackUpdate:[],publisherVideoEncoderChanged:[]},this.reportList={},this.reportSeqList={startPublish:{},rePublish:{},startPlay:{},rePlay:{},stopPublish:{},stopPlay:{}},this.streamTrigger={},this.audioStreamList={},this.deviceInfos=null,this.deviceChangeTimer=null,this.deviceStateOut=!1,this.customUa=!1,this.streamRetryTime=300,this.serverRetryTime=90,this.checkList=[],this.anchor_info={anchor_id:"",anchor_id_name:"",anchor_nick_name:""},this.clientIP="",this.accessClientIp="",this.isMultiOuter=!1,this.roomList=[],this.isMultiRoom=!1,this.browser="",this.unregisterSeiFilter="",this.isTestMode=!1,this.debugLog=!1,this.netAppConfigDelay=0,this.seiConfig={emulationPreventionByte:!1},this.playAccelerate=!0,this.autoSwitchDeviceSetting={camera:!1,microphone:!1},this.unSendMessageList=[],this.scenario=E.UP.Default,this.testStreamRetryMode=0,this.testStreamRetryCount=10,this.supportDispatchByPass=!1,this.testStreamStatusSeq=0,this.engineConfig={keepAudioTrack:!0,playClearLastFrame:!0,previewClearLastFrame:!0,mixingAudioDelay:0,baseMixingAudioDelay:0,adaptCustomUA:!1,allowReplaceEmptyTrack:!1,publishQualityInterval:0,playQualityInterval:0,enableMiniSDP:!1,keepRtcWhenSignalDisconnected:!0,autoRecaptureOnShow:!1,datachannelOption:{ordered:!0},switchRoomNotStopPlay:!1,enableReferenceBitrate:!0,speechEnhanceLogLevel:1},this.$u=!0,this.ta=!1,this.player265Validated=!1,this.player265ReceiverList=[],this.miniSdpError=0,this.debugVerboseUpdateList={streamProbeState:[],chargeInfosUpdate:[],startConnectWebRTCServer:[]},this.logReportCallback=B,this.unregisterCallback=Ce,this.decodeServerError=Ze,this.getLiveRoomError=st,this.getServerError=fe,this.mergeStreamList=Ie,this.actionSuccessCallback=X,this.checkValidNumber=D,this.uint8arrayToBase64=Ve,this.getSeq=E.Mo,this.getReportSeq=E.wN,this.cdnSeqV2=new Date().getTime()}return Object.defineProperty(o.prototype,"networkState",{get:function(){var e;return(e=this.rtm)===null||e===void 0?void 0:e.stateCenter.networkState},set:function(e){var t;!((t=this.rtm)===null||t===void 0)&&t.stateCenter&&!(0,R.TE)(e)&&(this.rtm.stateCenter.networkState=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isFlutter",{get:function(){return!!this.engineConfig.isFlutter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"selectIPStackMode",{get:function(){return this.settingConfig.getSettingWithUserParams("ip_stack_mode",Fs.ipStackMode)||N.IPv4Prefer},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isMiniSdp",{get:function(){if(!this.$u&&!this.ta||!window.WebAssembly||!window.Worker||Ir(this.browserInfo,"chrome",78,0))return!1;var e=this.settingConfig.getSetting("open_mini_sdp");return!!(0,R.dd)(e)&&(this.an.info("zc.c.ims setting: "+e),e)},enumerable:!1,configurable:!0}),o.prototype.setIsMiniSdp=function(e){var t;(t=this.settingConfig)===null||t===void 0||t.setUserValue("open_mini_sdp",e)},Object.defineProperty(o.prototype,"streamCenter",{get:function(){return this.gn},set:function(e){this.gn=e},enumerable:!1,configurable:!0}),o.prototype.getRequestId=function(){return this.idName+"-"+(0,E.Mo)()},o.prototype.addListener=function(e,t){return this.listenerList[e]?(0,R.JO)(t)?(this.listenerList[e].indexOf(t)==-1&&this.listenerList[e].push(t),!0):(this.an.error("zc.o.0 listener callBack must be funciton"),!1):(this.an.error("zc.o.0 event "+e+" no found"),!1)},o.prototype.actionListener=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=["roomStreamUpdate","playerStateUpdate","publisherStateUpdate","screenSharingEnded","beautyEffectError","backgroundEffectError","playerVideoTrackUpdate","playerAudioTrackUpdate","publisherVideoEncoderChanged","deviceError"].includes(e);if(i&&this.listenerList[e]){var s=this.reporter.createSpan(Te.t0.H,{key:k.i6.event},{key:""},k.fn.event);s.setAttributes({listener:e,listener_params:JSON.stringify(n)}),s.end()}(i||["streamExtraInfoUpdate"].includes(e))&&this.an.info("zc.al ".concat(e," ").concat(JSON.stringify(n))),this.listenerList[e]&&this.listenerList[e].forEach(function(c){try{setTimeout(function(){c.apply(void 0,n)},0)}catch(u){t.an.error(ie.fkL+" "+e+" "+u)}})},o.prototype.deleteListener=function(e,t){if(!this.listenerList[e])return this.an.error("zc.o.1 listener no found"),!1;this.an.info("zc.o.1 "+"".concat(e," cb:")+typeof t);var n=this.listenerList[e];if(t){var r=n.indexOf(t);r>=0&&n.splice(r,1)}else this.listenerList[e]=[];return!0},o.prototype.getRoomByRoomID=function(e){return this.roomList.find(function(t){return t.roomID==e})},o.prototype.getPlayRoom=function(e){return this.roomList.find(function(t){return!!t.streamList.find(function(n){return n.stream_id==e})})},o.prototype.onExperimentalAPICallback=function(e){this.actionListener("recvExperimentalAPI",e)},o.prototype.au=function(e,t){return this.settingConfig.getSetting(e,t)},o.prototype.destroy=function(){this.gn=null},o.prototype.onDebugVerboseCallBack=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.debugVerboseUpdateList[e]&&this.debugVerboseUpdateList[e].forEach(function(r){r.apply(void 0,t)})},o.prototype.ia=function(e,t){var n=this.settingConfig.getSetting("report_attr_level");(0,te.VU)(n,e,t)},o}(),Ol=function(){return Ol=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},Ol.apply(this,arguments)},Ls=k.k1,Oc="zb.sh.usi",Nc=function(){function o(e,t,n,r,i){this.an=e,this.pn=t,this.rtm=n,this.gn=r,this._s=i,this.na=0,this.ea=0,this.ra=0,this.sa=!1,this.oa=null,this.ua=2e3,this.aa=5e3,this.mixStreamTaskList={},this.mixRequestIdList=[],this.mixStreamHbList={},this.roomID=i,this.logger=e,this.stateCenter=t}return Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"reporter",{get:function(){return this.cr},enumerable:!1,configurable:!0}),o.prototype._setCDNInfo=function(e,t){var n=t.urls_flv,r=t.urls_m3u8,i=t.urls_flv_plus,s=t.urls_m3u8_plus,c=t.urls_https_flv,u=t.urls_https_m3u8,l=t.urls_rtmp;e.urlFlv=(0,R.C9)(n)?n[0]||"":(0,R.QP)(n)?n:"",e.urlHls=(0,R.C9)(r)?r[0]||"":(0,R.QP)(r)?r:"",e.urlFlvPlus=(0,R.C9)(i)?i[0]||"":(0,R.QP)(i)?i:"",e.urlHlsPlus=(0,R.C9)(s)?s[0]||"":(0,R.QP)(s)?s:"",e.urlHttpsFlv=(0,R.C9)(c)?c[0]||"":(0,R.QP)(c)?c:"",e.urlHttpsHls=(0,R.C9)(u)?u[0]||"":(0,R.QP)(u)?u:"",e.urlRtmp=(0,R.C9)(l)?l[0]||"":(0,R.QP)(l)?l:""},o.prototype.onStreamUpdated=function(e,t,n){},o.prototype.onStreamExtraInfoUpdated=function(e,t){},o.prototype.onStreamAttrUpdated=function(e,t){},o.prototype.handleStreamStart=function(e,t){var n="zb.sh.hss";(0,te.rA)(this.an,n,"stream update"),this.room=t,e.body?(this.ua=e.body.stream_list_hb_merge_timeout||2e3,this.aa=e.body.stream_list_push_merge_timeout||5e3,this.sa=!1,this.handleFullUpdateStream(e.body.stream_seq,e.body.stream_info||[],!0),this._handleReconnectStream(e.body.stream_info),(0,te.OY)(this.an,n)):this.an.error(n+" server response wrong")},o.prototype.onFullUpdateStream=function(e){},o.prototype.onPublishStateUpdate=function(e,t,n,r){},o.prototype._updateStreamInfo=function(e,t,n,r,i,s){var c,u,l,a=this;n===void 0&&(n=""),(0,te.rA)(this.an,Oc);var h=n,m=(c=this.room)===null||c===void 0?void 0:c.streamList.find(function(Pe){return Pe.stream_id===e});m||this.an.info(Oc+" stream not in room cmd "+t);var S={stream_id:e,extra_info:h};if(t!==2002&&t!==2003||(S.stream_sid=(m==null?void 0:m.stream_sid)||""),t===2001&&this.gn.publisherList[e]){var x=this.gn.publisherList[e].publisher;S.inspect_flag=((u=x==null?void 0:x.publishOption)===null||u===void 0?void 0:u.inspectFlag)||0}var q=JSON.stringify(S),V=Ol({sub_cmd:t,stream_msg:q,third_token:(l=this.room)===null||l===void 0?void 0:l.token},s||{stream_resource:1,stream_codec:0}),_e=this.room,ke=this.rtm.liveRoomHandler.sendStreamUpdate(V,function(Pe,Oe){a.handleStreamUpdateRsp(Pe,e,t),r&&r(Pe,Oe)},function(Pe,Oe){var Ge=a.room,Je=a.rtm.stateCenter.roomModulesList.find(function(wt){return wt.roomID===(Ge==null?void 0:Ge.roomID)}),tt=function(){return(Je==null?void 0:Je.isTryLogin())||(Je==null?void 0:Je.roomState)==="CONNECTING"},ut=function(){a.an.warn(Oc+" resend stream update "+t),a._updateStreamInfo(e,t,n,r,i,s)};if(Ge&&(Je!=null&&Je.isLogin()||tt())&&Pe.code&&Pe.code==Et.Q9p.code&&Ge.streamInfoList[e].seq==Oe)setTimeout(function(){if(t==2001&&a.pn.publishStreamList[e]&&a.pn.publishStreamList[e].state==E.T_.update_info||t==2002)if(tt()){var wt=function(At,Vt){var qt=function(){a.rtm.stateCenter.offListener("_roomStateUpdate",wt)};At===(Ge==null?void 0:Ge.roomID)&&Vt==="CONNECTED"?(ut(),qt()):At===(Ge==null?void 0:Ge.roomID)&&Vt==="DISCONNECTED"&&qt()};a.rtm.stateCenter.onListener("_roomStateUpdate",wt)}else ut();else i&&i(Et.Q9p)},0);else if(Pe.body&&Pe.body.err_code){var vt=Pe.body.err_code,gt=Et.bVX;[1011,1000002002].includes(vt)?gt=Et.g9p:[5030].includes(vt)?gt=(0,te.QS)((0,te.iq)(pe.FORBID_BLACK_USER)):[2002,2003,2010,2015].includes(vt)&&(gt=Et.HED),i&&i(gt,Oe);var Pt="";gt.code===Et.bVX.code&&(Pt=JSON.stringify({server_code:E.Kk+vt})),t===E.NP.liveBegin&&a.onPublishStateUpdate(E.eZ.error,e,gt,Pt)}},{sessionID:_e==null?void 0:_e.sessionID,roomID:_e==null?void 0:_e.roomID,roomSessionID:_e==null?void 0:_e.roomSessionID});[2001,2002].includes(t)&&(this.room.streamInfoList[e]={seq:ke}),(0,te.EK)(this.an,Oc,"cmd: "+t+", roomid: ".concat(_e==null?void 0:_e.roomID,", stream: ").concat(e))},o.prototype.updateStreamInfo=function(e,t,n,r,i,s){var c=this;if(n===void 0&&(n=""),this.room){var u;(t===2001||t===2002)&&(u=this.cr.createSpan(Te.t0.H,{key:k.B$.event,par:this._s},{key:""},k.ON.event)).setAttributes({stream_update_type:k.ON.stream_update_type(t===2001?"stream added":t===2002?"stream deleted":""),stream_extra_info:k.ON.stream_extra_info(n),stream_id:k.ON.stream_id(e)}),this._updateStreamInfo(e,t,n,function(l,a){[2001,2002].includes(t)&&(u.setAttributes({send_seq:a}),u&&u.end()),r&&r(l,a)},function(l,a){[2001,2002].includes(t)&&(u.setAttributes({send_seq:a}),c.cr.setError(u,l)),i&&i(l,a)},s)}else this.an.warn(Oc+" "+te.fT)},o.prototype.handleStreamUpdateRsp=function(e,t,n){var r,i,s,c;if(this.rtm.isDisConnect())this.an.warn("zb.sh.hsur not login");else if(e.body.err_code==0){this.an.info("zb.sh.hsur stream seq "+this.ea+" server seq "+e.body.stream_seq);var u=this.room;if(u){!((r=e==null?void 0:e.body)===null||r===void 0)&&r.token_remain_time&&(this.pn.getRoomByRoomID((i=e==null?void 0:e.header)===null||i===void 0?void 0:i.room_id)?this.rtm.resetRoomTokenTimer(e.header.room_id,e.body.token_remain_time):this.an.error("zb.sh.hsur room no found ignore "+JSON.stringify((s=e.header)===null||s===void 0?void 0:s.room_id))),this.handleStreamSync(e,t,n);var l=u.streamInfoList[t],a=(c=e.header)===null||c===void 0?void 0:c.seq;l&&l.seq===a?delete u.streamInfoList[t]:this.an.info("zb.sh.hsur ".concat(JSON.stringify(t)," udp stream info; rsp seq: ").concat(a,", cur seq: ").concat(l==null?void 0:l.seq," "))}else this.an.info("hsur.0 room no found")}else this.an.error("zb.sh.hsur stream update error "+e.body.err_code)},o.prototype.handleStreamSync=function(e,t,n){if(this.handleStreamRsp(this.room,t,{stream_id:t,stream_sid:e.body.stream_sid,stream_ver:e.body.stream_ver,stream_nid:e.body.stream_nid,id_name:this.pn.idName,nick_name:this.pn.nickName},n),e.body.stream_seq>this.ea+1)return this.an.info("zb.sh.hss.1 seq diff server: "+e.body.stream_seq+" client "+this.ea),void this.fetchStreamList();this.ea=e.body.stream_seq;var r=this.room.streamList.find(function(i){return i.stream_id==t});r&&e.body.stream_ver>r.stream_ver&&this.fetchStreamList(t)},o.prototype.handleStreamRsp=function(e,t,n,r){var i=this.pn.publishStreamList[t],s=e.streamList.find(function(u){return u.stream_id==t});if(this.an.info("hsur.0 cmd "+r+" "+!!s),s&&r===2002){var c=e.streamList.findIndex(function(u){return u.stream_id==t});this.an.info("hsur.0 stream index "+c),c>-1&&e.streamList.splice(c,1)}i?(i.state==E.T_.update_info&&(i.state=E.T_.publishing,r!==2001||s||e.streamList.push(n),this.onPublishStateUpdate(E.eZ.start,t,{code:0,message:""})),s&&s.stream_sid!==n.stream_sid&&(this.an.info("hsur.0 update sid. "+t+" origin:"+s.stream_sid+", new:"+n.stream_sid),s.stream_sid=n.stream_sid)):this.an.info("hsur.0 stream is not exist")},o.prototype.handleFetchStreamListRsp=function(e,t){var n,r,i,s,c,u,l="zb.sh.hfslr";if((0,te.rA)(this.an,l,t),this.sa=!1,this.cr.spanEnd({key:Ls.event,par:this._s},{stream_seq:Ls.stream_seq((n=e.body)===null||n===void 0?void 0:n.stream_seq),stream_size:Ls.stream_size((i=(r=e.body)===null||r===void 0?void 0:r.stream_info)===null||i===void 0?void 0:i.length),stream_list:Ls.stream_list((s=e.body)===null||s===void 0?void 0:s.stream_info),error:((c=e==null?void 0:e.body)===null||c===void 0?void 0:c.err_code)||(e==null?void 0:e.code),message:((u=e==null?void 0:e.body)===null||u===void 0?void 0:u.err_message)||(e==null?void 0:e.msg)}),e.body.err_code===0)if(this.ea!==e.body.stream_seq){if(this.ea>e.body.stream_seq)return this.an.error(l+" less seq"),void this.fetchStreamList(t);if(this.ra>e.body.stream_seq)this.an.info(l+" less than max fetch stream seq ");else{var a=e.body.stream_info;t&&(a=e.body.stream_info.filter(function(h){return h.stream_id===t})),this.handleFullUpdateStream(e.body.stream_seq,a),(0,te.EK)(this.an,l)}}else this.an.info(l+" same seq");else this.an.info(l+" server error="+e.body.err_code)},o.prototype.syncPublishStreamList=function(){var e,t="zb.sh.spsl";(0,te.rA)(this.an,t);var n=function(s){var c=r.pn.publishStreamList[s];if(c.state===E.T_.publishing){var u=r.room.streamList.findIndex(function(a){return a.stream_id===s});if(c.roomID===r.room.roomID&&u===-1){var l=void 0;!((e=r.gn.publisherList[s])===null||e===void 0)&&e.publisher&&(l=r.gn.publisherList[s].publisher.getStreamAddOptions()),c.state=E.T_.update_info,r.updateStreamInfo(s,E.NP.liveBegin,c.extra_info,function(a){},void 0,l)}}},r=this;for(var i in this.pn.publishStreamList)n(i);(0,te.EK)(this.an,t)},o.prototype.handleFullUpdateStream=function(e,t,n){var r=this;n===void 0&&(n=!1);var i="zb.sh.hfus";(0,te.rA)(this.an,i),this.ea=e,this.ra<e&&(this.ra=e),this.an.debug(i+" server seq "+this.ea),t=t.filter(function(s){return s.stream_type!==1}),this.pn.mergeStreamList(this.pn.idName,this.room.streamList,t,function(s,c,u,l){s.length!==0&&(r.an.debug(i+" callback addstream"),r.onStreamUpdated(r._s,1,r.makeCallbackStreamList(s))),c.length!==0&&(r.an.debug(i+" callback delstream"),r.onStreamUpdated(r._s,0,r.makeCallbackStreamList(c))),u.length!==0&&(r.an.debug(i+" callback updatestream"),r.onStreamExtraInfoUpdated(r._s,r.makeCallbackStreamList(u))),l.length!==0&&(r.an.warn(i+" callback updateAttrstream"),r.onStreamAttrUpdated(r._s,r.makeCallbackStreamList(l)))}),n||this.syncPublishStreamList(),(0,te.EK)(this.an,i)},o.prototype.handlePushStreamUpdateMsg=function(e){var t="zb.sh.hpsum";(0,te.rA)(this.an,t,JSON.stringify(e));var n=e.body.stream_info;if(n&&n.length!==0){if(n=n.filter(function(r){return r.stream_type!==1}),this.ea+1!==e.body.stream_seq)return(0,te.rA)(this.an,t,"updatestream 1"),void this.fetchStreamList();if(e.body.stream_seq<this.ra)return(0,te.rA)(this.an,t,"updatestream 2"),void this.fetchStreamList();switch(this.ea=e.body.stream_seq,e.body.stream_cmd){case E.EN.added:this.ca(n);break;case E.EN.deleted:this.ha(n);break;case E.EN.updated:this._handleUpdatedStreamList(n)}(0,te.EK)(this.an,t)}else this.an.info(t+", emtpy list")},o.prototype.ca=function(e){var t="zb.sh.hasl";(0,te.rA)(this.an,t);for(var n,r=[],i=0;i<e.length;i++)if(e[i].anchor_id_name!=this.pn.idName&&e[i].id_name!=this.pn.idName&&e[i].user_id!==this.pn.idName){n=!1;for(var s=0;s<this.room.streamList.length;s++)if(e[i].stream_id===this.room.streamList[s].stream_id){n=!0;break}n||r.push(e[i])}else this.an.debug("hdsl.0 have self stream added");if(r.length!==0){this.an.debug(t+" callback addstream");for(var c=0;c<r.length;c++){this.room.streamList.push(r[c]);var u=this.gn.playerList[r[c].stream_id];u==null||u.setStreamAdd()}this.onStreamUpdated(this._s,1,this.makeCallbackStreamList(r))}(0,te.EK)(this.an,t)},o.prototype.ha=function(e){var t="zb.sh.hdsl";(0,te.rA)(this.an,t);for(var n=[],r=0;r<e.length;r++)if(e[r].anchor_id_name!=this.pn.idName&&e[r].id_name!=this.pn.idName&&e[r].user_id!==this.pn.idName){for(var i=this.room.streamList.length-1;i>=0;i--)if(e[r].stream_id===this.room.streamList[i].stream_id){this.room.streamList.splice(i--,1),n.push(e[r]);break}}else this.an.debug(t+" have self stream deleted");n.length!==0&&(this.an.debug(t+" callback delstream"),this.onStreamUpdated(this._s,0,this.makeCallbackStreamList(n))),(0,te.OY)(this.an,t)},o.prototype._handleUpdatedStreamList=function(e){var t="zb.sh.husl";(0,te.rA)(this.an,t);for(var n=[],r=[],i=0;i<e.length;i++)if(e[i].anchor_id_name!=this.pn.idName&&e[i].id_name!=this.pn.idName&&e[i].user_id!==this.pn.idName){for(var s=0;s<this.room.streamList.length;s++)if(e[i].stream_id===this.room.streamList[s].stream_id){e[i].extra_info!==this.room.streamList[s].extra_info&&(this.room.streamList[s]=e[i],n.push(e[i])),e[i].stream_attr_opts&&JSON.stringify(e[i].stream_attr_opts)!==JSON.stringify(this.room.streamList[s].stream_attr_opts)&&(this.room.streamList[s]=e[i],r.push(e[i]));break}}else this.an.debug("hsul.0 have self stream updated");n.length!==0&&(this.an.debug(t+" callback updatestream"),this.onStreamExtraInfoUpdated(this._s,this.makeCallbackStreamList(n))),r.length!==0&&(this.an.warn(t+" callback updateAttrStream"),this.onStreamAttrUpdated(this._s,this.makeCallbackStreamList(r))),(0,te.EK)(this.an,t)},o.prototype.fetchStreamList=function(e){var t,n,r,i=this,s="zb.sh.fsl";(0,te.rA)(this.an,s);var c=this.cr.createSpan(Te.t0.H,{key:k.B$.event,par:this._s},{key:Ls.event,par:this._s},Ls.event,!0);return this.rtm.isDisConnect()?(this.an.info(s+" state error"),void this.cr.setError(c,Ls.error.NOT_LOGIN)):this.sa?(this.an.info(s+" already doing"),void this.cr.setError(c,Ls.error.wn," already doing")):(this.sa=!0,this.an.info(s+" send fetch request"),this.rtm.liveRoomHandler.getStreamList({},function(u){i.handleFetchStreamListRsp(u,e)},function(u){},{roomID:(t=this.room)===null||t===void 0?void 0:t.roomID,sessionID:(n=this.room)===null||n===void 0?void 0:n.sessionID,roomSessionID:(r=this.room)===null||r===void 0?void 0:r.roomSessionID}),void(0,te.EK)(this.an,s))},o.prototype._handleReconnectStream=function(e){var t,n,r,i,s,c,u,l="zb.sh.hrs";(0,te.rA)(this.an,l);var a=this.gn.publisherList;this.an.info(l+" publish "+Object.keys(this.gn.publisherList));var h=function(x){if(((n=(t=a[x])===null||t===void 0?void 0:t.room)===null||n===void 0?void 0:n.roomID)!==m._s)return"continue";var q=e.find(function(Oe){return Oe.stream_id==x}),V=q&&!(q.anchor_id_name===m.pn.idName||q.id_name===m.pn.idName||q.user_id===m.pn.idName);if(m.an.info("zb.sh.hrs stream ".concat(x," ").concat(!!q," ").concat(V," ").concat((r=a[x].publisher)===null||r===void 0?void 0:r.state)),((i=a[x].publisher)===null||i===void 0?void 0:i.state)!=6&&a[x].state!==1||q&&!V){if((((s=a[x].publisher)===null||s===void 0?void 0:s.state)==7||a[x].state===2)&&!(!((u=(c=a[x])===null||c===void 0?void 0:c.retryStreamHandler)===null||u===void 0)&&u.maxTimer)&&e.find(function(Oe){return Oe.stream_id==x})){m.updateStreamInfo(x,ke=E.NP.liveEnd);for(var _e=0;_e<m.room.streamList.length;_e++)if(m.room.streamList[_e].stream_id==x){m.room.streamList.splice(_e--,1);break}}}else{var ke=E.NP.liveBegin,Pe=void 0;a[x].publisher&&(Pe=a[x].publisher.getStreamAddOptions()),m.updateStreamInfo(x,ke,m.pn.publishStreamList[x].extra_info,void 0,void 0,Pe)}},m=this;for(var S in a)h(S);(0,te.OY)(this.an,l)},o.prototype.makeCallbackStreamList=function(e){var t,n=[];if(this.pn.appConfig&&(t=this.pn.appConfig.media_config.play_config.resource_info.filter(function(V){return[E.NI.CDN,E.NI.DG].includes(V.resource_type)})),e&&e.length>0)for(var r=0;r<e.length;r++){var i=e[r].stream_id;if(t&&t.length)for(var s=0;s<t.length;s++){for(var c=t[s].resource_type==E.NI.DG?"_plus":"",u=[],l=[],a=[],h=0;h<t[s].service_info.length;h++){var m=t[s].service_info[h],S=m.protocol,x=m.url_template.replace("{STREAM_NAME}",i);switch(S){case E.Hb.FLV:u.push(x);break;case E.Hb.HLS:l.push(x);break;case E.Hb.RTMP:a.push(x)}}e[r]["urls_flv"+c]=u,e[r]["urls_m3u8"+c]=l,e[r]["urls_rtmp"+c]=a}var q={user:{userID:e[r].anchor_id_name||e[r].id_name,userName:e[r].anchor_nick_name||e[r].nick_name},extraInfo:e[r].extra_info,streamID:e[r].stream_id,roomID:"",urlFlv:"",urlFlvPlus:"",urlRtmp:"",urlHls:"",urlHlsPlus:"",urlHttpsFlv:"",urlHttpsHls:"",streamGID:e[r].stream_gid,closeType:e[r].close_type,stream_attr_opts:e[r].stream_attr_opts};this._setCDNInfo(q,e[r]),n.push(q)}return n},o.prototype.sendHttpPBRequest=function(e,t,n,r,i){var s,c;(s=this.rtm.netAgent)===null||s===void 0||s.startHttpRequest2({interfaceID:e.interfaceID,resID:e.resID||"",body:t,ack:!1,idName:this.pn.idName,method:2,token:((c=this.room)===null||c===void 0?void 0:c.token)||"",mode:this.pn.testEnvironment?2:1,reduceRspHeaders:!0},function(u,l){n&&n(u,l)},function(u){r&&r(u)},null,{timeout:(i==null?void 0:i.timeout)||4e3,extras:{protoCmd:e.protoCmd}})},o.prototype.sendMixRequest=function(e,t,n,r,i){var s=this;i===void 0&&(i=2);var c=function(u,l){var a=u.status_code,h=u.body,m=u.code,S=u.message;return(0,R.TE)(m)||m===0?a&&a!==200?(i--,void(a===502&&i>0?s.sendMixRequest(e,t,n,r,i):r&&r(a,h))):void(n&&n(h,l)):m===Et.Q9p.code&&i>0?(i--,void s.sendMixRequest(e,t,n,r,i)):void(r&&r(-1,{},{code:m,message:S}))};this.sendHttpPBRequest(e,t,function(u,l){c(u,l)},function(u){c(u)})},o.prototype.sendRTMPRequest=function(e,t,n,r){var i=this.rtm.netAgent,s=this.pn.appid,c=t.streamID,u="/v1/jsrtmp/dispatch/".concat(e,"/").concat(c,"/").concat(t.actionType,"/").concat(i.clientIP),l=this.room;i.startHttpRequest({service:1,headers:[{name:"Token-Appid",val:s+""},{name:"Token-Str",val:(l==null?void 0:l.token)||""},{name:"Token-Userid",val:this.pn.idName},{name:"Token-Biztype",val:"2"},{name:"Net-Mode",val:this.pn.netMode+""}],body:{},idName:this.pn.idName,method_no:1,ack:!1,location:u},function(a){n(a)},function(a,h,m){r(a)})},o.prototype._publishTarget=function(e,t,n){},o.prototype.updateStreamExtraInfo=function(e,t,n,r){(0,te.rA)(this.an,"zb.sh.usei");var i=E.NP.liveUpdate;this.pn.publishStreamList[e]&&this.pn.publishStreamList[e].state>=E.T_.update_info?(this.pn.publishStreamList[e].extra_info=t,this.updateStreamInfo(e,i,t,n,r)):this.pn.publishStreamList[e]&&this.pn.publishStreamList[e].state===E.T_.tryPublish?(this.pn.publishStreamList[e].extra_info=t,n({errorCode:0})):r(k.Fv.error.Ke)},o.prototype.getMixStreamStatus=function(e){},o.prototype.setStreamExtraInfo=function(e,t,n,r){this.updateStreamExtraInfo(e,t,n,r)},o.prototype._publishTargetWeb=function(e,t,n){},o.prototype.patchStreamList=function(e){var t=this;if((0,R.Cs)(e.body.stream_refresh)&&e.body.stream_refresh!==0)return this.an.info(ie.mMR+" stream refresh "),void this.fetchStreamList();this.an.info(ie.mMR+" stream seq "+this.ea+" "+JSON.stringify(this.oa)),e.body.stream_seq>this.ea&&!this.oa&&(this.oa={},(0,te.rA)(this.an,ie.mMR,"update stream "+this.ea+" server "+e.body.stream_seq),this.fa&&clearTimeout(this.fa),this.fa=setTimeout(function(){t.handleMergeTimeout()},this.ua)),this.na=e.body.stream_seq},o.prototype.getStreamSeq=function(){return this.ea},o.prototype.mergeStreamByStreamSeq=function(e,t,n){var r=this;this.oa||(this.an.warn(ie.wT7+" new merge stream list "+this.ea+" server "+t),this.oa={},this.fa&&clearTimeout(this.fa),this.fa=setTimeout(function(){r.handleMergeTimeout()},this.aa)),this.an.info(ie.wT7+" ".concat(this.oa," ").concat(e," ").concat(t," ").concat(n)),this.oa[t]={cmd:e,streamList:n}},o.prototype.handleMergeTimeout=function(){if(this.oa){var e=Object.keys(this.oa).map(function(t){return+t}).sort(function(t,n){return t-n});e[e.length-1]-e[0]+1===e.length||e[e.length-1]>=this.na?this.mergeStream(e):(this.oa=null,this.fetchStreamList())}},o.prototype.mergeStream=function(e){var t=this;this.an.info(ie.TlX+" merge streamList "+this.ea+" streamSeqList "+e.join(","));var n=e[e.length-1],r=[];e.forEach(function(i){if(t.oa&&t.oa[i])switch(t.oa[i].cmd){case E.EN.added:t.oa[i].streamList.forEach(function(s){var c=r.findIndex(function(u){return u.stream_id==s.stream_id});c!==-1&&r.splice(c),r.push(s)});break;case E.EN.deleted:t.oa[i].streamList.forEach(function(s){var c=r.findIndex(function(u){return u.stream_id==s.stream_id});c!==-1&&r.splice(c)});break;case E.EN.updated:t.oa[i].streamList.forEach(function(s){var c=r.findIndex(function(u){return u.stream_id==s.stream_id});c!==-1&&r.splice(c),r.push(s)})}}),this.oa=null,this.an.info(ie.TlX+" "+r),this.handleFullUpdateStream(n,r)},o.prototype.reset=function(){this.na=0,this.oa=null,this.mixStreamTaskList={},this.mixRequestIdList=[],this.mixStreamHbList={},this.fa&&(clearTimeout(this.fa),this.fa=void 0),this.ua=2e3,this.aa=5e3},o}(),Nh=function(){function o(){this.handlerListMap={}}return o.prototype.addEventHandler=function(e,t){if(this.handlerListMap[e]||(this.handlerListMap[e]=[]),!(0,R.JO)(t))throw new Error("Params callBack is not a Function");return this.handlerListMap[e].indexOf(t)==-1&&this.handlerListMap[e].push(t),!0},o.prototype.removeEventHandler=function(e,t){return!!this.handlerListMap[e]&&(this.handlerListMap[e]=t?this.handlerListMap[e].filter(function(n){return n!==t}):[],!0)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.handlerListMap[e]&&this.handlerListMap[e].forEach(function(r){try{r.apply(void 0,t)}catch(i){console.error('Fail to execute callback of event "'.concat(e,'" : ').concat(i))}})},o}(),Ha=Nh,Du="zg_autoplay_wrapper";function vd(){return navigator.language.includes("zh")}var Lh=function(){function o(){this.content='Media play failed. Click the "Resume"to resume.',this.la=null;var e=document.createElement("style");e.type="text/css";var t=".zg_autoplay_mask{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.5);z-index:1500}.zg_autoplay_mask div:not(.zg_autoplay_action_wrapper){display:block!important}.".concat(Du,"{padding:14px;background:#fff;border-radius:3px;box-shadow:1px 1px 10px#988e8d;border:1px solid#d1cfcf;max-width:500px}.").concat(Du,"a{color:#2473E8}.zg_autoplay_header{overflow:hidden;text-overflow:ellipsis;font-size:16px;font-weight:600}.zg_autoplay_content{margin:8px 0}.zg_autoplay_action_wrapper{width:100%;display:flex!important;align-items:center;justify-content:right;float:right}.zg_autoplay_collapse{margin-right:auto;cursor:pointer}.zg_autoplay_question{height:100%;line-height:16px;cursor:pointer}.zg_autoplay_action_confirm{margin-left:8px;color:#fff;background:#0072ff;padding:4px 12px;outline:none;border:1px solid;border-radius:3px;font-weight:bold}.zg_autoplay_action_confirm:hover{opacity:0.9}.zg_autoplay_collapse,.zg_autoplay_action_confirm,.zg_autoplay_content,.zg_autoplay_question{font-size:14px}@media screen and(max-width:750px){.").concat(Du,"{width:80vw}}");e.appendChild(document.createTextNode(t)),te.VJ.head.appendChild(e),vd()&&(this.content=""),this.da=new Ha}return o.getInstance=function(){return o.instance||(o.instance=new o),o.instance},o.prototype.createDialog=function(){var e=te.VJ.createElement("template"),t=te.VJ.createElement("div");t.className="zg_autoplay_mask";var n=te.VJ.createElement("div");n.className=Du;var r=te.VJ.createElement("div");r.className="zg_autoplay_header",r.textContent=location.host;var i=te.VJ.createElement("div");i.className="zg_autoplay_content",i.textContent=this.content;var s=te.VJ.createElement("div");s.className="zg_autoplay_action_wrapper",n.appendChild(r),n.appendChild(i),n.appendChild(s),t.appendChild(n),e.content.appendChild(t);var c=te.VJ.createElement("button");c.className="zg_autoplay_action_confirm",c.innerText=vd()?"":"Resume",c.onclick=this.onConfirm.bind(this);var u=e.content.firstChild;return s&&s.appendChild(c),u},o.prototype.onConfirm=function(e){e&&e.stopPropagation(),this.da.emit("allowPlay"),this.deleteDiaLog()},o.prototype.deleteDiaLog=function(){this.la&&(te.VJ.body.removeChild(this.la),this.la=null)},o.prototype.addDiaLog=function(){this.la=this.la||this.createDialog(),te.VJ.body.appendChild(this.la),this.la.onclick=this.onConfirm.bind(this)},o.prototype.on=function(e,t){return this.da.addEventHandler(e,t)},o.prototype.off=function(e,t){return this.da.removeEventHandler(e,t)},o.instance=null,o}(),Nl=function(){function o(e,t){this.an=e,this.va=t}return o.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.an.info(e.join(""),{streamid:this.va})},o.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.an.warn(e.join(""),{streamid:this.va})},o.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.an.error(e.join(""),{streamid:this.va})},o.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.an.debug(e.join(""),{streamid:this.va})},o}();function ei(o,e){return new Nl(o,e)}var ps,Mh=pt(5794),fs=function(){return fs=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},fs.apply(this,arguments)},Ms=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},xs=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},gd=(0,Vn.$t)(),yd=/^(?=.*MicroMessenger)(?=.*HONOR).*$/.test(gd||""),Ll=Lh.getInstance(),Ml=function(){function o(e,t,n){var r=this;this.previewer=t,this.ma=null,this.pa=null,this.inited=!1,this.container=null,this.ga=null,this.eu={enableVideoAutoplayDialog:!0,enableAudioAutoplayDialog:!0,clearLastFrame:!0,useAudioElement:!0},this.ba=(0,te.sg)(function(h,m,S){r._a.emit("autoplayFailed",m,S),(h?r.eu.enableVideoAutoplayDialog:r.eu.enableAudioAutoplayDialog)?Ll.addDiaLog():te.VJ.body.addEventListener("mousedown",r.ou.resumePlayByClickBody),r.ya.warn("zc.zsv id:".concat(r.id," autoplay failed"))},600),this.wa=!1,this.Sa=!1,this.Ea=(0,te.sg)(function(){var h=Array.from(te.VJ.getElementsByTagName("video")),m=Array.from(te.VJ.getElementsByTagName("audio")),S=h.some(function(q){return!q.id||!q.id.startsWith("zg-rtc-video_")}),x=m.some(function(q){return!q.id||!q.id.startsWith("zg-rtc-audio_")});(S||x)&&(0,Mh.r)()},300),this.ka=(0,te.sg)(this.Oa,20),this.ou={visibilitychange:function(){var h;te.VJ.hidden||r.Sa||!(0,Vn.Fr)()||(r.ya.info("zc.zsv id: ".concat(r.id," page show, recover audio")),r.eu.useAudioElement&&r.pa?r.pa.srcObject=r.pa.srcObject:(r.ya.info("zc.ac.rs id: ".concat(r.id," page show")),r.ac.resume()),r.ka(r.pa,!0)),te.VJ.hidden||r.wa||!(0,Vn.Fr)()||!((h=r.ma)===null||h===void 0)&&h.paused&&(r.ya.info("zc.zsv id: ".concat(r.id," page show, recover video")),r.Oa(r.ma,!0))},focus:function(h){r.Sa||((0,Vn.aR)()&&(0,Vn.UN)().startsWith("16")||(0,Vn.HR)())&&(r.ya.info("zc.zsv id: ".concat(r.id," page focus, recover audio")),r.ka(r.pa,!0))},canPlayAudio:function(h){r._a.emit("canPlayAudio",h)},canPlayVideo:function(h){r._a.emit("canPlayVideo",h)},resumePlayByClickBody:function(){return Ms(r,void 0,void 0,function(){return xs(this,function(h){switch(h.label){case 0:return this.ya.info("zc.zsv id:".concat(this.id," resume by click dom_body")),[4,this.resume()];case 1:return h.sent(),te.VJ.body.removeEventListener("mousedown",this.ou.resumePlayByClickBody),[2]}})})}},this.inited=!0,this.eu=fs(fs({},this.eu),n);var i=this.id="".concat(e.id);this.ya=ei(this.an,(t==null?void 0:t.streamId)||""||void 0),this.ya.info("zc.sv.c id:".concat(i,"  isLocal: ").concat(this.isLocal));var s=te.VJ.createElement("div");s.id="zg-rtc-player_".concat(i),s.setAttribute("style","width:100%;height:100%;position:relative;background-color:black;overflow:hidden;");var c=e.getVideoTracks()[0],u=e.getAudioTracks()[0],l=(0,te.sb)(void 0,void 0,this.browser!=="safari");l.id="zg-rtc-video_".concat(i),l.setAttribute("style","width:100%;height:100%;object-fit:contain;"),l.srcObject=new MediaStream,l.addEventListener("canplay",this.ou.canPlayVideo),c&&l.srcObject.addTrack(c);var a=te.VJ.createElement("audio");a.id="zg-rtc-audio_".concat(i),a.setAttribute("autoplay",""),a.setAttribute("playsinline",""),a.muted=!0,a.srcObject=this.Ia=new MediaStream,a.addEventListener("canplay",this.ou.canPlayAudio),u&&a.srcObject.addTrack(u),typeof WeixinJSBridge=="object"&&typeof WeixinJSBridge.invoke=="function"&&WeixinJSBridge.invoke("getNetworkType",{},function(){r.ya.info("zc.zsv id:".concat(r.id," weixin load media")),a.load(),l.load()}),this.Ra=s,this.ma=l,this.pa=a,this._a=new Ha,this.Ta=function(){r.resume()},Ll.on("allowPlay",this.Ta),window.addEventListener("focus",this.ou.focus),te.VJ.addEventListener("visibilitychange",this.ou.visibilitychange)}return Object.defineProperty(o.prototype,"video",{get:function(){return this.ma},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"audio",{get:function(){return this.pa},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"ac",{get:function(){return this.previewer.ac},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"browser",{get:function(){return this.previewer.pn.browser},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"an",{get:function(){return this.previewer.logger},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isLocal",{get:function(){return this.previewer instanceof la},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"_isMounted",{get:function(){return!!this.Ra.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"_hasAudio",{get:function(){var e,t;return((t=(e=this.Ia)===null||e===void 0?void 0:e.getTracks()[0])===null||t===void 0?void 0:t.readyState)==="live"&&!this.Sa},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"_hasVideo",{get:function(){var e,t,n;return!!(!((e=this.ma)===null||e===void 0)&&e.parentNode)&&((n=(t=this.ma.srcObject)===null||t===void 0?void 0:t.getTracks()[0])===null||n===void 0?void 0:n.readyState)==="live"},enumerable:!1,configurable:!0}),o.prototype.resume=function(e,t){return t===void 0&&(t=["audio","video"]),Ms(this,void 0,void 0,function(){var n=this;return xs(this,function(r){return this.ya.info("zc.zsv resume call: ".concat(e,", kindList: ").concat(t,", id:").concat(this.id,", isLocal: ").concat(this.isLocal)),t.forEach(function(i){return Ms(n,void 0,void 0,function(){var s,c,u=this;return xs(this,function(l){switch(l.label){case 0:return c=i==="audio"?this.pa:this.ma,((s=i==="audio")?this._hasAudio:this._hasVideo)?!s||this.eu.useAudioElement?[3,1]:(this.ya.info("zc.zsv resume id:".concat(this.id," ac: ")+this.ac.state),this.ac.resume(),[3,4]):[3,4];case 1:return e&&c?(c.srcObject=c.srcObject,[4,new te.l3(function(a){var h=setTimeout(function(){u.ya.info("zc.zsv id:".concat(u.id," resume play ").concat(s?"audio":"video"," timeout")),a(0)},1e3),m=function(){clearTimeout(h),c.removeEventListener("canplay",m),a(0)};c.addEventListener("canplay",m)})]):[3,3];case 2:l.sent(),l.label=3;case 3:c==null||c.play().catch(function(a){u.ya.info("zc.zsv id:".concat(u.id," resume failed. err:")+a.message)}),l.label=4;case 4:return[2]}})})}),[2]})})},o.prototype.checkIfClearLastFrame=function(){return Ms(this,void 0,void 0,function(){return xs(this,function(e){switch(e.label){case 0:return this.eu.clearLastFrame?[4,this.resume(!0,["video"])]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},o.prototype.play=function(e,t){t===void 0&&(t={}),this.ya.info("zc.zsv play: ".concat(typeof e,", ").concat(JSON.stringify(t),", id:").concat(this.id," isLocal:").concat(this.isLocal?"1":"0 streamid:"+this.previewer.streamId,","));var n=(t=fs({},t)).enableAutoplayDialog;(0,R.dd)(n)&&(t.enableVideoAutoplayDialog=n,t.enableAudioAutoplayDialog=n,delete t.enableAutoplayDialog),this.playVideo(e,t),this.playAudio(t,!this.isLocal)},o.prototype.playVideo=function(e,t){t===void 0&&(t={}),this.ya.info("zc.zsv.pv id:".concat(this.id," play: ").concat(typeof e,", ").concat(JSON.stringify(t)," isLocal:").concat(this.isLocal));var n=null;if((0,R.QP)(e)?n=te.VJ.getElementById(e):(0,R.qi)(e)&&(n=e),!n)throw this.ya.error("zc.zsv.pv id:".concat(this.id," no element isLocal:").concat(this.isLocal)),"Execute `play` failed, container not exist";t&&"enableAutoplayDialog"in t&&(t.enableVideoAutoplayDialog=t.enableAutoplayDialog,delete t.enableAutoplayDialog),this.eu=fs(fs({},this.eu),t);var r=this.eu,i=r.objectFit,s=r.mirror;this.ma&&(i!==void 0&&(this.ma.style.objectFit=i),(0,R.dd)(s)&&(this.ma.style.transform=s?"rotateY(180deg)":"")),!n.contains(this.Ra)&&n.appendChild(this.Ra),this.container=n,this.wa=!1,this.Oa(this.ma,!0)},o.prototype.playAudio=function(e,t){t===void 0&&(t=!0),this.ya.info("zc.zsv.pa id:".concat(this.id," play: ").concat(JSON.stringify(e)," isLocal:").concat(this.isLocal)),e&&"enableAutoplayDialog"in e&&(e.enableAudioAutoplayDialog=e.enableAutoplayDialog,delete e.enableAutoplayDialog),this.eu=fs(fs({},this.eu),e);var n=!0;if(this.browser==="safari"){var r=gd.match(/Version\/([\d\.]+)/);r&&(r[1]!=="13.1.2"||this.eu.useAudioElement||(n=!1))}n||(this.ya.warn("zc.zsv.pa id:".concat(this.id," safari 13.1.2 cannot use audio ctx render.")),this.eu.useAudioElement=!0);var i=t,s=this.eu.muted;this.pa&&(0,R.dd)(s)&&(i=!s),this.Sa=!i,this.Oa(this.pa,i)},o.prototype.stop=function(){this.ya.info("zc.zsv stop id:".concat(this.id," isLocal:").concat(this.isLocal)),this.stopAudio(),this.stopVideo()},o.prototype.stopAudio=function(){this.ya.info("zc.zsv.sa stop id:".concat(this.id," isLocal:").concat(this.isLocal)),this.Sa=!0,this.Oa(this.pa,!1)},o.prototype.stopVideo=function(){var e;this.ya.info("zc.zsv.sv stop id:".concat(this.id," isLocal:").concat(this.isLocal)),this.Oa(this.ma,!1);var t=(e=this.Ra)===null||e===void 0?void 0:e.parentNode;t&&t.removeChild(this.Ra)},o.prototype.setVideo=function(e,t){return t===void 0&&(t=!1),Ms(this,void 0,void 0,function(){return xs(this,function(n){switch(n.label){case 0:return[4,this.setTrack(!0,e,t)];case 1:return n.sent(),[2]}})})},o.prototype.setAudio=function(e,t){return t===void 0&&(t=!1),Ms(this,void 0,void 0,function(){return xs(this,function(n){switch(n.label){case 0:return[4,this.setTrack(!1,e,t)];case 1:return n.sent(),[2]}})})},o.prototype.setTrack=function(e,t,n){return n===void 0&&(n=!1),Ms(this,void 0,void 0,function(){var r,i,s;return xs(this,function(c){switch(c.label){case 0:return this.ya.info("zc.zsv set id:".concat(this.id," track: ").concat(e,", ").concat(t==null?void 0:t.id,", ").concat(n,", ").concat(t==null?void 0:t.readyState," isLocal:").concat(this.isLocal)),(r=e?this.ma:this.pa)?(i=r.srcObject)?t?[3,1]:((s=i.getTracks()).forEach(function(u){i==null||i.removeTrack(u),r.srcObject=r.srcObject}),this._a.emit("_trackChange",e?"video":"audio"),[3,5]):[2]:[2];case 1:if(!(t instanceof MediaStreamTrack))return[3,5];if((s=i.getTracks()).includes(t))return[3,5];if(s.forEach(function(u){i==null||i.removeTrack(u)}),i.addTrack(t),this.eu.useAudioElement||this.Ca(!0),this._a.emit("_trackChange",t.kind,t),this.Oa(r,!(e?this.wa:this.Sa)),!n)return[3,5];c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.resume(!0,[e?"video":"audio"])];case 3:return c.sent(),[3,5];case 4:return c.sent(),[3,5];case 5:return[2]}})})},o.prototype.setMirror=function(e){var t=this.eu.mirror=!!e;this.ma&&(this.ma.style.transform=t?"rotateY(180deg)":"")},o.prototype.setVideoMuted=function(e){return this.ya.info("zc.zsv id:".concat(this.id," mute video: ").concat(e," isLocal:").concat(this.isLocal)),this.wa=e,this.Oa(this.ma,!e)},o.prototype.setAudioMuted=function(e){return this.ya.info("zc.zsv id:".concat(this.id," mute audio: ").concat(e," isLocal:").concat(this.isLocal)),this.Sa=e,this.Oa(this.pa,!e)},o.prototype.setVolume=function(e){if(this.ya.info("zc.zsv id:".concat(this.id," volume: ").concat(e," isLocal:").concat(this.isLocal)),this.pa){var t=e>100?1:e/100;return this.pa.volume=t,this.Aa&&(this.Aa.gain.value=t),this.pa.volume==t}return!1},o.prototype.takeStreamSnapshot=function(e){var t=this.ma;if(!t||!t.srcObject)return"";var n=(0,te.FP)(this.ma.videoWidth,this.ma.videoHeight),r=n.getContext("2d");r&&r.drawImage(this.ma,0,0,n.width,n.height);var i=n.toDataURL("image/"+(e==null?void 0:e.imageType)||0,e==null?void 0:e.quality),s="png";return e!=null&&e.imageType&&(s=["png","jpeg"].includes(e==null?void 0:e.imageType)?e==null?void 0:e.imageType:"png"),e!=null&&e.save&&n.toBlob(function(c){var u=window.URL.createObjectURL(c),l=te.VJ.createElement("a");l.style.display="none",l.href=u;var a=(e==null?void 0:e.fileName)||"snapshot"+Date.now();l.download=a+"."+s,te.VJ.body.appendChild(l),l.click(),setTimeout(function(){te.VJ.body.removeChild(l),window.URL.revokeObjectURL(u)},100)}),i},o.prototype.getVideoHeight=function(){return this.ma?this.ma.videoHeight:0},o.prototype.getVideoWidth=function(){return this.ma?this.ma.videoWidth:0},o.prototype.Ca=function(e){if(e===void 0&&(e=!1),this.ga?e&&(this.ga.disconnect(),this.ga=this.ac.createMediaStreamSource(this.Ia)):this.ga=this.ac.createMediaStreamSource(this.Ia),!this.Aa){var t=this.Aa=this.ac.createGain();this.pa&&(t.gain.value=this.pa.volume)}return this.ga.connect(this.Aa),{gainNode:this.Aa,srcNode:this.ga}},o.prototype.Oa=function(e,t,n){var r,i,s=this;if(n===void 0&&(n=0),!e||!this.Ra)return!1;var c=!this.eu.useAudioElement,u=e.tagName==="VIDEO";if(this.ya.info("zc.zsv id:".concat(this.id," mount play ").concat(e.tagName)),t){if(!u&&c){e.muted=!0,e.pause(),e.remove(),this.Ca().gainNode.connect(this.ac.destination);var l="running";this.ya.info("zc.zsv id:".concat(this.id," render use audio context: ")+this.ac.state),this.ac.state!==l&&this.ac.resume().then(function(){s.ac.state!==l&&s.ba(u,e)})}else if(((i=(r=e==null?void 0:e.srcObject)===null||r===void 0?void 0:r.getTracks()[0])===null||i===void 0?void 0:i.readyState)==="live"){var a=null,h=function(){e.oncanplay=null,a&&(clearTimeout(a),a=null),e.play().then(function(){yd&&!u&&(s.ya.info("zc.ac.rs id:".concat(s.id," honor suspend ac")),s.ac.resume()),s.ya.info("zc.zsv id:".concat(s.id," render  ").concat(e.tagName," use element success")),(0,Vn.HR)()&&s.Ea()}).catch(function(S){s.ya.warn("zc.zsv 2: id:".concat(s.id," ").concat(e.tagName," play() error: ").concat(S.message," isLocal:").concat(s.isLocal));var x=s._hasVideo,q=s._hasAudio;!(S.message||"").includes("interrupted")&&(s._isMounted&&u&&x||!u&&q)&&s.ba(u,e,S)})};e.muted=!0,u||(this.Aa&&this.Aa.disconnect(),e.muted=!1,e.srcObject=e.srcObject),yd&&!u&&(this.ya.info("zc.ac.rs id:".concat(this.id," honor resume ac")),this.ac.suspend()),e.play().catch(function(S){s.ya.warn("zc.zsv 1: id:".concat(s.id," ").concat(e.tagName," play() error: ").concat(S.message," isLocal:").concat(s.isLocal))}),a=window.setTimeout(function(){h()},1e3),e.oncanplay=function(){h()},e.onerror=function(){var S,x,q,V,_e=!(u?s.wa:s.Sa);s.ya.error("zc.zsv id:".concat(s.id," ").concat(e.tagName," onerror:  ").concat((S=e.error)===null||S===void 0?void 0:S.code," ").concat((x=e.error)===null||x===void 0?void 0:x.message," ; times: ").concat(n," ; enable: ").concat(_e)),_e&&e.error&&(n===0&&((q=e.error)===null||q===void 0?void 0:q.code)===3?(s.ya.info("zc.zsv decode failed. retry again"),s.Oa(e,_e,n++)):(s.ya.info("zc.zsv not retry on error. ".concat(n," ").concat((V=e.error)===null||V===void 0?void 0:V.code)),s.ba(u,e,e.error)))},!e.parentNode&&u&&this.Ra.appendChild(e)}}else if(e.muted=!0,e.remove(),e.pause(),!u){c&&this.Aa&&this.Aa.disconnect();var m=5*Math.random()+4;setTimeout(function(){!u&&!e.parentNode&&e.readyState>3&&e.load()},1e3*m)}return!0},o.prototype.on=function(e,t){return!!t&&this._a.addEventHandler(e,t)},o.prototype.off=function(e,t){return this._a.removeEventHandler(e,t)},o.prototype.useAudioOut=function(e){var t;return Ms(this,void 0,void 0,function(){var n;return xs(this,function(r){switch(r.label){case 0:return n=(t=this.pa)===null||t===void 0?void 0:t.setSinkId,n?[4,n.call(this.pa,e)]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})},o.prototype.destroy=function(){this.stop();var e=this.ma,t=this.pa;(0,Vn.HR)()&&(e&&(e.muted=!1,e.pause()),t&&(t.muted=!1,t.pause())),e&&(e.removeEventListener("canplay",this.ou.canPlayVideo),e.srcObject=null,this.ma=null),t&&(t.removeEventListener("canplay",this.ou.canPlayAudio),t.srcObject=null,this.pa=null),window.removeEventListener("focus",this.ou.focus),te.VJ.removeEventListener("visibilitychange",this.ou.visibilitychange),te.VJ.body.removeEventListener("mousedown",this.ou.resumePlayByClickBody),Ll.off("allowPlay",this.Ta),this.inited=!1,this.Ta=null},o.prototype.getAudioNodeAndStopRender=function(){var e=this.pa,t=this.eu;e&&(e.muted=!0,e.remove(),e.pause());var n=this.Ca(!0).gainNode;return t.useAudioContext&&n.disconnect(),n},o}(),xh=function(){function o(e,t){this.source=e,this.destination=t,this.audioNodeList=[],this.source.disconnect(),this.source.connect(this.destination)}return Object.defineProperty(o.prototype,"destinationNode",{get:function(){return this.destination},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"lastNode",{get:function(){return this.isEmpty()?null:this.audioNodeList[this.audioNodeList.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"secondToLastNode",{get:function(){return this.audioNodeList.length<2?null:this.audioNodeList[this.audioNodeList.length-2]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"firstNode",{get:function(){return this.isEmpty()?null:this.audioNodeList[0]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"secondNode",{get:function(){return this.audioNodeList.length<2?null:this.audioNodeList[1]},enumerable:!1,configurable:!0}),o.prototype.pushBack=function(e){this.lastNode?(this.lastNode.disconnect(),this.lastNode.connect(e),e.connect(this.destination)):(this.source.disconnect(),this.source.connect(e),e.connect(this.destination)),this.audioNodeList.push(e)},o.prototype.popBack=function(){this.lastNode&&(this.lastNode.disconnect(),this.secondToLastNode?(this.secondToLastNode.disconnect(),this.secondToLastNode.connect(this.destination)):(this.source.disconnect(),this.source.connect(this.destination))),this.audioNodeList.pop()},o.prototype.pushFront=function(e){this.source.disconnect(),this.source.connect(e),e.connect(this.firstNode?this.firstNode:this.destination),this.audioNodeList.unshift(e)},o.prototype.popFront=function(){this.source.disconnect(),this.firstNode&&(this.firstNode.disconnect(),this.source.connect(this.secondNode?this.secondNode:this.destination)),this.audioNodeList.shift()},o.prototype.remove=function(e){var t=this.audioNodeList.indexOf(e);if(t!==-1){if(e.disconnect(),t-1>=0){var n=this.audioNodeList[t-1];n.disconnect(),n.connect(this.lastNode!=e?this.audioNodeList[t+1]:this.destination)}else this.source.disconnect(),this.source.connect(this.lastNode!=e?this.audioNodeList[t+1]:this.destination);this.audioNodeList.splice(t,1)}},o.prototype.isConnected=function(e){return this.audioNodeList.indexOf(e)!==-1},o.prototype.isEmpty=function(){return this.audioNodeList.length===0},o.prototype.replaceSource=function(e){this.source.disconnect(),e.connect(this.firstNode?this.firstNode:this.destination),this.source=e},o.prototype.replaceDestination=function(e){this.lastNode?(this.lastNode.disconnect(),this.lastNode.connect(e)):(this.source.disconnect(),this.source.connect(e)),this.destination=e},o}(),bd=pt(1350),_d=function(){function o(){}return o.createError=function(e,t){return{code:e.code,message:e.message+(t?" "+t:"")}},o}(),Bh=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Uh=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},zh=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Vh=_d.createError,Sd=function(o){function e(t,n){var r=o.call(this)||this;return r.track=t,r.streamCenter=n,r.isFirstNode=!1,r.isLastNode=!1,r}return Bh(e,o),Object.defineProperty(e.prototype,"output",{get:function(){return{track:this.track}},enumerable:!1,configurable:!0}),e.prototype.setInput=function(t){return Uh(this,void 0,void 0,function(){return zh(this,function(n){throw Vh({code:-1,message:"Can not set track input to VideoSourceNode"})})})},e.prototype.process=function(){},e.prototype.destory=function(){this.track&&(this.streamCenter.trackUtils.stopTrack(this.track),this.track=null),this.next=null},e}(bd.E),Bs=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Us=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Fh=function(){function o(e,t,n,r,i){this.za=e,this.Da=t,this.gn=n,this.browser=r,this.preview=i,this.Na=[],this._vcMgr=void 0,this.za.connect(this.Da)}return Object.defineProperty(o.prototype,"vcMgr",{get:function(){return this._vcMgr},set:function(e){this._vcMgr||(this._vcMgr=e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"lastNode",{get:function(){return this.isEmpty()?null:this.Na[this.Na.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"secondToLastNode",{get:function(){return this.Na.length<2?null:this.Na[this.Na.length-2]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"firstNode",{get:function(){return this.isEmpty()?null:this.Na[0]},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"secondNode",{get:function(){return this.Na.length<2?null:this.Na[1]},enumerable:!1,configurable:!0}),o.prototype.pushBack=function(e){return Bs(this,void 0,void 0,function(){return Us(this,function(t){switch(t.label){case 0:return this.lastNode?(this.lastNode.setNodePos(void 0,!1),[4,this.lastNode.connect(e)]):[3,3];case 1:return t.sent(),e.setNodePos(!1),[4,e.connect(this.Da)];case 2:return t.sent(),[3,6];case 3:return[4,this.za.connect(e)];case 4:return t.sent(),e.setNodePos(!0),[4,e.connect(this.Da)];case 5:t.sent(),t.label=6;case 6:return this.Na.push(e),[2]}})})},o.prototype.popBack=function(){return Bs(this,void 0,void 0,function(){return Us(this,function(e){switch(e.label){case 0:return this.lastNode?[4,this.lastNode.disconnect()]:[3,7];case 1:return e.sent(),this.secondToLastNode?[4,this.secondToLastNode.disconnect()]:[3,4];case 2:return e.sent(),this.secondToLastNode.setNodePos(void 0,!0),[4,this.secondToLastNode.connect(this.Da)];case 3:return e.sent(),[3,7];case 4:return[4,this.za.disconnect()];case 5:return e.sent(),[4,this.za.connect(this.Da)];case 6:e.sent(),e.label=7;case 7:return this.Na.pop(),[2]}})})},o.prototype.pushFront=function(e){return Bs(this,void 0,void 0,function(){return Us(this,function(t){switch(t.label){case 0:return[4,this.za.disconnect()];case 1:return t.sent(),this.firstNode&&e.setNodePos(void 0,void 0,!1),[4,this.za.connect(e)];case 2:return t.sent(),this.firstNode?(this.firstNode.setNodePos(!1),e.setNodePos(!0,!1),[4,e.connect(this.firstNode)]):[3,4];case 3:return t.sent(),[3,6];case 4:return e.setNodePos(!0,!0),[4,e.connect(this.Da)];case 5:t.sent(),t.label=6;case 6:return this.Na.unshift(e),[2]}})})},o.prototype.popFront=function(){return Bs(this,void 0,void 0,function(){return Us(this,function(e){switch(e.label){case 0:return[4,this.za.disconnect()];case 1:return e.sent(),this.firstNode?[4,this.firstNode.disconnect()]:[3,6];case 2:return e.sent(),this.secondNode?(this.secondNode.setNodePos(!1),[4,this.za.connect(this.secondNode)]):[3,4];case 3:return e.sent(),[3,6];case 4:return[4,this.za.connect(this.Da)];case 5:e.sent(),e.label=6;case 6:return this.Na.shift(),[2]}})})},o.prototype.remove=function(e){return Bs(this,void 0,void 0,function(){var t,n,r;return Us(this,function(i){switch(i.label){case 0:return(t=this.Na.indexOf(e))===-1?[3,13]:[4,e.disconnect()];case 1:return i.sent(),n=this.Na[t+1],t-1>=0?[4,(r=this.Na[t-1]).disconnect()]:[3,7];case 2:return i.sent(),this.lastNode==e?[3,4]:(r.setNodePos(void 0,!1),[4,r.connect(n)]);case 3:return i.sent(),[3,6];case 4:return r.setNodePos(void 0,!0),[4,r.connect(this.Da)];case 5:i.sent(),i.label=6;case 6:return[3,12];case 7:return[4,this.za.disconnect()];case 8:return i.sent(),this.lastNode==e?[3,10]:(n.setNodePos(!0),[4,this.za.connect(n)]);case 9:return i.sent(),[3,12];case 10:return[4,this.za.connect(this.Da)];case 11:i.sent(),i.label=12;case 12:this.Na.splice(t,1),i.label=13;case 13:return[2]}})})},o.prototype.isConnected=function(e){return this.Na.indexOf(e)!==-1},o.prototype.isEmpty=function(){return this.Na.length===0},o.prototype.getSourceTrack=function(){var e;return(e=this.za.output)===null||e===void 0?void 0:e.track},o.prototype.getDestinationTrack=function(){var e;return(e=this.Da.output)===null||e===void 0?void 0:e.track},o.prototype.replaceNewSourceByTrack=function(e,t,n){var r,i,s,c;return t===void 0&&(t=!0),Bs(this,void 0,void 0,function(){var u;return Us(this,function(l){switch(l.label){case 0:return(((u=this.browser)==="firefox"||u==="safari")&&((r=this.vcMgr)===null||r===void 0?void 0:r.renderTrack)!==null&&e!==null&&((i=this.vcMgr)===null||i===void 0?void 0:i.renderTrack)!==e||u==="safari"&&(n==null?void 0:n.handleTrackType)===we.changeResolution)&&((s=this.preview.backgroundProcessor)===null||s===void 0||s.pauseRender(!0)),[4,(c=this.vcMgr)===null||c===void 0?void 0:c.checkInit(e,n)];case 1:return l.sent(),[4,this.replaceSource(new Sd(e,this.gn),t)];case 2:return l.sent(),[2]}})})},o.prototype.replaceSource=function(e,t){return t===void 0&&(t=!0),Bs(this,void 0,void 0,function(){return Us(this,function(n){switch(n.label){case 0:return this.Da.setReplaceRemote(t),this.firstNode?[4,e.connect(this.firstNode)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.connect(this.Da)];case 3:n.sent(),n.label=4;case 4:return this.za=e,this.Da.setReplaceRemote(),[2]}})})},o.prototype.replaceDestination=function(e){return Bs(this,void 0,void 0,function(){return Us(this,function(t){switch(t.label){case 0:return this.lastNode?[4,this.lastNode.disconnect()]:[3,3];case 1:return t.sent(),[4,this.lastNode.connect(e)];case 2:return t.sent(),[3,6];case 3:return[4,this.za.disconnect()];case 4:return t.sent(),[4,this.za.connect(e)];case 5:t.sent(),t.label=6;case 6:return this.Da=e,[2]}})})},o.prototype.destroy=function(){for(var e,t=0;t<this.Na.length;t++)this.Na[t].disconnect();this.Na=[],this.Da.destroy(),this.za.destory(),(e=this.vcMgr)===null||e===void 0||e.destroy()},o}(),qh=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ou=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Nu=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},xl=_d.createError,Hh=function(o){function e(t,n){var r=o.call(this)||this;return r.Pa=t,r.browser=n,r.isFirstNode=!1,r.isLastNode=!1,r.track=null,r.Ma=!0,r}return qh(e,o),e.prototype.setReplaceRemote=function(t){t===void 0&&(t=!0),this.Ma=t},e.prototype.setInput=function(t){return Ou(this,void 0,void 0,function(){var n,r,i,s,c=this;return Nu(this,function(u){switch(u.label){case 0:if((t==null?void 0:t.track)==null)return[2];if(!this.Pa.localStream)throw xl({code:-1,message:"preview haven't been inited."});return this.track=n=t==null?void 0:t.track,this.Pa.localStream.getVideoTracks()[0]===n?[3,4]:(r=this.Pa.localStream,(i=this.Pa.zegoCaptureStream)!=null&&i.stream&&(r=i.stream),s=this.Pa.gn.getPublishList(r),this.Ma&&s.length!==0?[4,te.l3.all(s.map(function(l){return Ou(c,void 0,void 0,function(){var a;return Nu(this,function(h){return!((a=l.publisher)===null||a===void 0)&&a.previewer?[2,l.publisher.replacePublishedTrack(n,!0)]:[2]})})}))]:[3,2]);case 1:return u.sent(),[3,4];case 2:return[4,this.Pa.replacePreviewTrack(n,!0)];case 3:u.sent(),u.label=4;case 4:return[2]}})})},Object.defineProperty(e.prototype,"output",{get:function(){return{track:this.track}},enumerable:!1,configurable:!0}),e.prototype.connect=function(t){return Ou(this,void 0,void 0,function(){return Nu(this,function(n){throw xl({code:-1,message:"video destination node cann't connect any video node."})})})},e.prototype.disconnect=function(){return Ou(this,void 0,void 0,function(){return Nu(this,function(t){throw xl({code:-1,message:"video destination node cann't disconnect any video node."})})})},e.prototype.destroy=function(){this.track=null},e}(bd.E),ca=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},ua=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Gh=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))};(function(o){o[o.inited=0]="inited",o[o.noInit=1]="noInit",o[o.initing=2]="initing"})(ps||(ps={}));var jh=function(){function o(e,t,n){var r=this;this.an=e,this.ir=t,this.customVC=n,this.canvasTrack=null,this.gl=null,this.xa=0,this.ja=0,this.qa=ps.noInit,this.hasBeautyTask=!1,this.hasBackgroundTask=!1,this.backgroundLoop=null,this.eventHandler={visibilitychange:function(){if(te.VJ.hidden){var i=function(){return ca(r,void 0,void 0,function(){return ua(this,function(s){switch(s.label){case 0:return this.backgroundLoop=window.setTimeout(i,Math.floor(1e3/this.fps)),!te.VJ.hidden&&this.backgroundLoop?(clearTimeout(this.backgroundLoop),this.backgroundLoop=null,[2]):[4,this.renderAFrame()];case 1:return s.sent(),[2]}})})};i()}else r.backgroundLoop&&(clearTimeout(r.backgroundLoop),r.backgroundLoop=null)}},this.fps=15,this.La=new Ha}return Object.defineProperty(o.prototype,"initState",{set:function(e){this.qa=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"inited",{get:function(){return this.qa===ps.inited},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"beautyAndBackgroundProcess",{get:function(){return this.hasBackgroundTask&&this.hasBeautyTask},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"renderTrack",{get:function(){return this.Ba},enumerable:!1,configurable:!0}),o.prototype.init=function(e,t){var n;return ca(this,void 0,void 0,function(){var r;return ua(this,function(i){switch(i.label){case 0:if(this.qa!=ps.noInit)return[3,4];this.qa=ps.initing,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.renderVideo(e,t)];case 2:return i.sent(),this.qa=ps.inited,this.onInited(),[3,4];case 3:return r=i.sent(),this.qa=ps.noInit,this.onRenderFail(r),r.code===Et.zcJ.code&&((n=this.Ba)===null||n===void 0?void 0:n.readyState)==="ended"&&this.resetVideo(),[3,4];case 4:return[2]}})})},o.prototype.checkInit=function(e,t){return ca(this,void 0,void 0,function(){return ua(this,function(n){switch(n.label){case 0:return!e||e.readyState!=="live"||this.Ba===e&&(t==null?void 0:t.handleTrackType)!==we.changeResolution?[3,2]:(this.qa=ps.noInit,[4,this.init(e,t)]);case 1:n.sent(),n.label=2;case 2:return[2]}})})},o.prototype.renderVideo=function(e,t){var n;return ca(this,void 0,void 0,function(){var r,i,s;return ua(this,function(c){switch(c.label){case 0:return this.an.info("".concat(ie.kVV," call")),e===null?(this.Ba=e,[2]):this.Ba==e&&(t==null?void 0:t.handleTrackType)!==we.changeResolution?[2]:(this.Ba=e,this.videoEl||(this.videoEl=(0,te.sb)(),(n=this.videoEl)===null||n===void 0||n.setAttribute("style","display:none")),[4,this.getPlayingVideo(this.videoEl,e,t)]);case 1:if(c.sent(),r=e.getSettings(),i=r.width||this.videoEl.videoWidth,s=r.height||this.videoEl.videoHeight,r.frameRate&&this.fps!==r.frameRate&&(this.fps=r.frameRate,this.an.info(ie.kVV+" set target fps: "+this.fps)),this.an.info(ie.kVV+" video canvas render: width "+r.width+" height "+r.height),!i||!s)throw this.an.error(ie.kVV+" resolution of track is wrong"),Et.zcJ;return this.originWidth=i,this.originHeight=s,this.videoEl.setAttribute("width",i.toString()),this.videoEl.setAttribute("height",s.toString()),this.ir!=="safari"||(t==null?void 0:t.handleTrackType)!==we.replaceNew&&(t==null?void 0:t.handleTrackType)!==we.changeResolution||this.resetCanvas(),this.initWegGl(),[2]}})})},o.prototype.getPlayingVideo=function(e,t,n){return ca(this,void 0,void 0,function(){var r,i,s=this;return ua(this,function(c){switch(c.label){case 0:return e.srcObject?((r=e.srcObject).getTracks().forEach(function(u){return r.removeTrack(u)}),r.addTrack(t),(i=this.ir)!=="safari"&&i!=="firefox"||(e.srcObject=r)):e.srcObject=new MediaStream([t]),[4,new Promise(function(u,l){var a=function(){e.videoWidth==0||e.videoHeight==0?l(Et.zcJ):u(void 0)};if(e!=null&&e.paused){var h=null,m=function(){a(),h&&(clearTimeout(h),h=null),e&&e.removeEventListener("playing",m)};h=window.setTimeout(function(){h&&(clearTimeout(h),h=null),h=window.setTimeout(function(){s.an.warn(ie.kVV+" video track error"),e&&e.removeEventListener("playing",m),l(Et.zcJ)},1e3),e.play().catch(function(S){console.error(S)})},1e3),e&&e.addEventListener("playing",m),e&&e.play()}else e&&e.play(),setTimeout(function(){a()},1e3)})];case 1:return c.sent(),[2]}})})},o.prototype.resetVideo=function(){var e;this.destroyVideo(),this.videoEl=(0,te.sb)(),(e=this.videoEl)===null||e===void 0||e.setAttribute("style","display:none")},o.prototype.initWegGl=function(){var e;if(this.an.info("".concat(ie.kNG," call")),this.canvasEl||(this.an.info("".concat(ie.kNG," no canvas")),this.customVC?(this.canvasEl=document.getElementById("render_canvas"),this.canvasEl.width=this.originWidth,this.canvasEl.height=this.originHeight):this.canvasEl=(0,te.FP)(this.originWidth,this.originHeight)),this.gl||(this.gl=(e=this.canvasEl)===null||e===void 0?void 0:e.getContext("webgl")),!this.gl)return this.an.warn("".concat(ie.kNG," no gl")),void this.handleInitError({code:1001});this.an.info("".concat(ie.kNG," end"))},o.prototype.resetCanvas=function(){this.canvasEl=null,this.gl=null,this.canvasTrack=null},o.prototype.getCanvasTrack=function(e){return this.an.info("".concat(ie.YNv," get track")),this.canvasTrack&&!e||!this.canvasEl||(this.canvasTrack=this.canvasEl.captureStream(this.fps).getVideoTracks()[0]),this.canvasTrack},o.prototype.startRenderTask=function(){var e=this;this.an.info("".concat(ie.YNv," start task"));var t=function(){return ca(e,void 0,void 0,function(){return ua(this,function(n){switch(n.label){case 0:return this.ja=requestAnimationFrame(t),[4,this.renderAFrame()];case 1:return n.sent(),[2]}})})};this.ja=requestAnimationFrame(t),te.VJ.removeEventListener("visibilitychange",this.eventHandler.visibilitychange),te.VJ.addEventListener("visibilitychange",this.eventHandler.visibilitychange,!1)},o.prototype.stopRenderTask=function(){this.an.info("".concat(ie.YNv," stop task")),this.ja&&(cancelAnimationFrame(this.ja),this.ja=0),te.VJ.removeEventListener("visibilitychange",this.eventHandler.visibilitychange)},o.prototype.renderAFrame=function(){return ca(this,void 0,void 0,function(){var e,t,n;return ua(this,function(r){return e=Date.now(),t=1e3/this.fps,(n=this.xa?e-this.xa:t)>=t&&(this.xa=e-(n-t),this.videoEl&&this.videoEl.paused&&this.videoEl.play(),this.videoEl&&this.videoEl.videoWidth>6&&this.videoEl.videoHeight>6&&this.La.emit("renderFrame")),[2]})})},o.prototype.on=function(e,t){return!!t&&this.La.addEventHandler(e,t)},o.prototype.off=function(e,t){return this.La.removeEventHandler(e,t)},o.prototype.actionListener=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];(t=this.La).emit.apply(t,Gh([e],n,!1))},o.prototype.setRenderTask=function(e,t){this.an.info("".concat(ie.YNv," set task ").concat(e," ").concat(t)),t==="beauty"&&(this.hasBeautyTask=e),t==="background"&&(this.hasBackgroundTask=e),this.hasBeautyTask&&!this.hasBackgroundTask?this.startRenderTask():this.stopRenderTask()},o.prototype.resetResolution=function(e,t){this.originWidth=e,this.originHeight=t},o.prototype.handleInitError=function(e){throw e},o.prototype.onInited=function(){},o.prototype.onRenderFail=function(e){},o.prototype.onRenderSuc=function(){},o.prototype.destroyVideo=function(){this.videoEl&&(this.videoEl.pause(),this.videoEl.remove(),this.videoEl.srcObject=null,this.videoEl=null)},o.prototype.destroy=function(){this.an.info("".concat(ie.YNv," dt")),this.destroyVideo(),this.canvasEl&&(this.canvasEl.remove(),this.canvasEl=null),this.canvasTrack=null,this.Ba=null,this.gl=null,this.stopRenderTask(),this.hasBeautyTask=!1,this.hasBackgroundTask=!1,this.backgroundLoop&&clearTimeout(this.backgroundLoop),this.backgroundLoop=null},o}();function Wh(o,e,t,n,r){t===void 0&&(t=1e3),n===void 0&&(n=200);var i=o.createAnalyser();i.fftSize=2048,e.connect(i);var s=null,c=0,u=i.fftSize,l=null,a=null,h=0;function m(){var S=0;if(i.getFloatTimeDomainData){a||(a=new Float32Array(u)),i.getFloatTimeDomainData(a);for(var x=0;x<a.length;x++)S=Math.max(S,Math.abs(a[x]))}else{for(l||(l=new Uint8Array(u)),i.getByteTimeDomainData(l),x=0;x<l.length;x++)S=Math.max(S,Math.abs(l[x]-128));S/=128}var q=.005;n<=100?q=.5:n<=200?q=.3:n<=300?q=.15:n<=500?q=.07:n<=1e3&&(q=.05),S>(c*=q)&&(c=S),c>1&&(c=1);var V=Date.now();return h==0&&(h=V),(V-h>=t||n>=t)&&(h=V,r&&r(c)),n&&(s=window.setTimeout(function(){s&&clearTimeout(s),m()},n))}return t<100&&(t=100),n<100&&(n=100),t<n&&(n=t),n&&(s=window.setTimeout(function(){m()},n)),o.state!=="running"&&o.resume(),{analyzer:i,destroy:function(){i.disconnect(),s!==null&&(clearInterval(s),n=0,s=null),c=0,l=null,a=null},setInterval:function(S){S>30&&(t=S)}}}var Bl=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Ul=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Ga="zc.smw",Qh=new Blob([`
class VolumeMeter extends AudioWorkletProcessor {
  constructor() {
    super();
    this.volume = 0;
    this.intervalTime = 1000;
    this.tick = this.intervalTime;
    this.isStop = false;
    this.port.onmessage = event => {
      const { data } = event;
      switch (data.name) {
        case "setIntervalTime":
          this.intervalTime = data.intervalTime;
          break;
        case "stop":
          this.isStop = true;
          break;
      }
    };
  }
  process(inputs) {
    const input = inputs[0];
    if (this.isStop) {
      return false;
    }
    if (input.length > 0) {
      const buffer = input[0];
      let maxVal = this.volume;
      for (let i = 0; i < buffer.length; i++) {
        if (maxVal < buffer[i]) {
          maxVal = buffer[i];
        }
      }
      this.volume = maxVal;
      this.tick -= buffer.length;
      if (this.tick < 0) {
        this.tick += (this.intervalTime / 1000) * sampleRate;
        this.port.postMessage({ volume: this.volume });
        this.volume = 0;
      }
    }
    return true;
  }
}
try {
  registerProcessor("meter", VolumeMeter);
} catch (error) {
  
}  
`],{type:"application/javascript"}),Td=function(){function o(){}return o.addModuleToContext=function(e,t){return Bl(this,void 0,void 0,function(){var n;return Ul(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t.info(Ga+" worklet addModule call"),[4,e.audioWorklet.addModule(URL.createObjectURL(Qh))];case 1:return r.sent(),t.info(Ga+" worklet addModule success"),this.isSuccess=!0,[2];case 2:return n=r.sent(),t.warn(Ga+" worklet addModule catch error. ".concat(n==null?void 0:n.message)),[3,3];case 3:return[2]}})})},o.isSuccess=!1,o}(),zl=function(){function o(e,t,n,r){n===void 0&&(n=1e3),r===void 0&&(r=200),this.an=e,this.pn=t,this.Ua=n,this.Ga=r,this.Ja=null,this.Fa=null,this.Ha=null,this.volume=0,this.onSoundLevelUpdate=function(i){}}return o.prototype.preload=function(e){return Bl(this,void 0,void 0,function(){return Ul(this,function(t){switch(t.label){case 0:return Td.isSuccess?[3,2]:[4,Td.addModuleToContext(e,this.an)];case 1:t.sent(),t.label=2;case 2:return[2]}})})},o.prototype.initAudioWorklet=function(e,t){return Bl(this,void 0,void 0,function(){var n,r,i=this;return Ul(this,function(s){switch(s.label){case 0:if(this.Ja)return[3,5];s.label=1;case 1:if(s.trys.push([1,3,,4]),function(c){return!!(0,R.JO)(c.createAnalyser)}(e)&&this.pn.settingConfig.getSetting("sound_level_api_type")!==E.EA.useWorklet)throw"use analyzer";return this.an.info(Ga+" use AudioWorklet. "),[4,this.preload(e)];case 2:return s.sent(),(n=this.Ja=new AudioWorkletNode(e,"meter")).port.onmessage=function(c){i.onSoundLevelUpdate&&i.onSoundLevelUpdate(c.data.volume||0)},t.connect(n).connect(e.destination),this.setInterval(this.Ua),[3,4];case 3:return r=s.sent(),this.an.info(Ga+" not use AudioWorklet. "+r),this.Ha=Wh(e,t,this.Ua,this.Ga,function(c){i.onSoundLevelUpdate&&i.onSoundLevelUpdate(c||0)}),[3,4];case 4:return[3,6];case 5:t.connect(this.Ja).connect(e.destination),s.label=6;case 6:return[2]}})})},o.prototype.getSrcSource=function(e,t){var n=t.getAudioTracks()[0],r=t.id,i=o.sourceList[r]||{},s=i.source,c=i._ac,u=i.trackid;return s&&c===e&&u===(n==null?void 0:n.id)||(s&&s.disconnect(),s=e.createMediaStreamSource(t),o.sourceList[r]={source:s,_ac:c=e,trackid:u=n.id}),s},o.prototype.replaceSrcSource=function(e,t){var n;o.sourceDisConnect(t);var r=this.getSrcSource(e,t);return!((n=this.Ha)===null||n===void 0)&&n.analyzer&&r.connect(this.Ha.analyzer),r},o.sourceDisConnect=function(e){var t=e.id,n=(o.sourceList[t]||{}).source;n&&(n.disconnect(),delete o.sourceList[t])},o.prototype.setInterval=function(e){var t=this.Ja;this.Ua=e,t&&t.port.postMessage({name:"setIntervalTime",intervalTime:e}),this.Ha&&this.Ha.setInterval(e)},o.prototype.destroy=function(){this.Fa&&(this.Fa.onaudioprocess=null,this.Fa.disconnect()),this.Ha&&(this.Ha.destroy(),this.Ha=null),this.Ja&&(this.Ja.port.postMessage({name:"stop"}),this.Ja.port.onmessage=null,this.Ja.port.close(),this.Ja.disconnect(),this.an.info(Ga+" close worklet")),this.Ja=null,this.Fa=null},o.sourceList={},o}(),ja=null,Wa=null;function Qa(o){return isNaN(o)?0:Math.max(-32768,Math.min(32767,Math.round(32767*o)))}var Lu=null,Mu=null;function Ed(o,e,t,n,r){n===void 0&&(n=1),r===void 0&&(r=!1);var i=1;if(!e||!t||e===t){if(r){for(var s=new Int16Array(o.length),c=0;c<o.length;c++)s[c]=Qa(o[c]);return s}return o}if((i=e/t)<=0)throw new Error("Invalid sample rate ratio");if(n<=0)throw new Error("Invalid channel count");var u,l=o.length/n,a=Math.round(l/i),h=a*n;r?((!Mu||h>Mu.length)&&(Mu=new Int16Array(h)),u=Mu):((!Lu||h>Lu.length)&&(Lu=new Float32Array(h)),u=Lu);for(var m=function(wt,At,Vt,qt,Gt){var Sn=Gt*Gt,Qt=qt-Vt-wt+At;return Qt*Gt*Sn+(wt-At-Qt)*Sn+(Vt-wt)*Gt+At},S=0;S<n;S++)for(c=0;c<a;c++){var x=c*i,q=Math.floor(x),V=x-q,_e=Math.max(0,q-1)*n+S,ke=q*n+S,Pe=Math.min(l-1,q+1)*n+S,Oe=Math.min(l-1,q+2)*n+S,Ge=o[_e],Je=o[ke],tt=o[Pe],ut=o[Oe],vt=m(Ge,Je,tt,ut,V),gt=Math.min(Ge,Je,tt,ut),Pt=Math.max(Ge,Je,tt,ut);vt=Math.max(gt,Math.min(Pt,vt)),u[c*n+S]=r?Qa(vt):vt}return u.slice(0,h)}function Cd(o,e,t,n,r){r===void 0&&(r=!1),t&&n&&t!==n&&(o=o.map(function(h){return Ed(h,t,n)}));var i=o.length,s=o[0];if(!s)return r?new Int16Array:new Float32Array;var c=s.length*e;r?(!(0,R.Cp)(Wa)||c>Wa.length)&&(Wa=new Int16Array(c)):(!(0,R.j5)(ja)||c>ja.length)&&(ja=new Float32Array(c));var u=r?Wa:ja;if(i===1&&e===1){if(!r)return s;for(var l=0;l<s.length;l++)u[l]=Qa(s[l])}else for(l=0;l<s.length;l++)e===2?r?(u[l*e]=Qa(s[l]),u[l*e+1]=Qa(i===2?o[1][l]:s[l])):(u[l*e]=s[l],u[l*e+1]=i===2?o[1][l]:s[l]):u[l]=r?Qa((s[l]+o[1][l])/2):(s[l]+o[1][l])/2;var a=u.slice(0,s.length*e);return r?Wa==null||Wa.fill(0):ja==null||ja.fill(0),a}function wd(o,e,t,n,r){r===void 0&&(r=!1);var i=o;if((t&&n&&t!==n||r)&&(i=o.map(function(l){return Ed(l,t,n,1,r)})),e===1&&o.length===2){var s=void 0;s=r?new Int16Array(i[0]):new Float32Array(i[0]);var c=i[1];i=[s];for(var u=0;u<s.length;u++)s[u]=(s[u]+c[u])/2}else e===2&&o.length===1&&(c=void 0,c=r?new Int16Array(i[0]):new Float32Array(i[0]),i=[i[0],c]);return i}var Id,Rd,kd,Pd,Ad=function(){function o(e,t){this.ac=e,this.an=t,this.useScript=!1,this.Va=null,this.Qa=null,this.Ya=4096}return o.prototype.setAudioFrameCallback=function(e,t,n,r){var i,s,c,u=this;this.an.info("zc.apdp.safc.0 ".concat(e.id," ").concat(t," ").concat(JSON.stringify(r)));var l=(r==null?void 0:r.frameSize)||this.Ya;if(t)if(this.ga||(this.ga=this.ac.createMediaStreamSource(e)),this.useScript)this.Va||(this.Va=this.ac.createScriptProcessor(l),this.Va.onaudioprocess=function(a){for(var h=0;h<a.outputBuffer.numberOfChannels;h+=1)for(var m=a.outputBuffer.getChannelData(h),S=0;S<m.length;S+=1)m[S]=0;var x=a.inputBuffer.numberOfChannels,q=[];try{if(x>0)for(var V=0;V<x;V++){var _e=a.inputBuffer.getChannelData(V);q.push(_e)}var ke=r||{},Pe=ke.sampleRate,Oe=ke.bitDepth,Ge=ke.channelCount,Je=a.inputBuffer.sampleRate,tt=Ge||x,ut=Pe||Je,vt=Oe===16;if(ke.mergeChannelsIntoPcm){var gt=Cd(q,tt,Je,ut,vt);n({channels:[],channelCount:tt,sampleRate:ut,pcm:gt})}else if([Pe,Ge,Oe].some(function(wt){return!(0,R.TE)(wt)})){var Pt=wd(q,tt,Je,ut,vt);n({channels:Pt,channelCount:tt,sampleRate:ut})}else n({channels:q,channelCount:x,sampleRate:Je})}catch(wt){u.an.info("zc.apdp.safc.0 script fail ".concat(wt.toString()))}},this.an.info("zc.apdp.safc.0 create _zgp_scriptNode")),this.ga.connect(this.Va),this.Va.connect(this.ac.destination);else{if(!this.Qa){try{this.Qa=new AudioWorkletNode(this.ac,"audio-pcm-data-processor",{processorOptions:{bufferSize:l}})}catch(a){this.an.error("zc.apdp.safc.0 create worklet fail ".concat(a.toString()))}this.Qa&&(this.Qa.port.onmessage=function(a){if(a.data.type==="process")try{var h=a.data,m=h.channels,S=h.channelCount,x=r||{},q=x.sampleRate,V=x.bitDepth,_e=x.channelCount,ke=h.sampleRate,Pe=_e||S,Oe=q||ke,Ge=V===16;if(x.mergeChannelsIntoPcm){var Je=Cd(m,Pe,ke,Oe,Ge);n({channels:[],channelCount:Pe,sampleRate:Oe,pcm:Je})}else if([q,_e,V].some(function(ut){return!(0,R.TE)(ut)})){var tt=wd(m,Pe,ke,Oe,Ge);n({channels:tt,channelCount:Pe,sampleRate:Oe})}else n({channels:m,channelCount:S,sampleRate:ke})}catch(ut){throw ut}},this.an.info("zc.apdp.safc.0 init worklet"))}this.Qa&&this.ga.connect(this.Qa),(i=this.Qa)===null||i===void 0||i.connect(this.ac.destination)}else{try{this.Qa&&((s=this.ga)===null||s===void 0||s.disconnect(this.Qa)),this.Va&&((c=this.ga)===null||c===void 0||c.disconnect(this.Va))}catch(a){this.an.info("zc.apdp.safc.0 ".concat(JSON.stringify(a)))}this.ga=null}},o.prototype.replaceSource=function(e){var t,n;if(this.an.info("zc.apdp.rs.0 ".concat(e.id)),this.ga){var r=this.ac.createMediaStreamSource(e);this.Qa&&((t=this.ga)===null||t===void 0||t.disconnect(this.Qa),r.connect(this.Qa)),this.Va&&((n=this.ga)===null||n===void 0||n.disconnect(this.Va),r.connect(this.Va)),this.ga=null,this.ga=r}},o.prototype.destroy=function(){var e,t;this.an.info("zc.apdp.ds.0 call"),this.Qa&&(this.Qa.port.close(),(e=this.ga)===null||e===void 0||e.disconnect(this.Qa),this.Qa.disconnect(),this.an.info("zc.apdp.ds.0 destroy worklet")),this.Va&&(this.Va.onaudioprocess=null,(t=this.ga)===null||t===void 0||t.disconnect(this.Va),this.Va.disconnect(),this.an.info("zc.apdp.ds.0 close script processor")),this.Qa=null,this.Va=null,this.ga=null,this.an.info("zc.apdp.ds.0 end")},o}(),Jh=function(){function o(){this.listenerMap=new WeakMap}return o.prototype.bind=function(e,t){this.listenerMap.has(e)||this.listenerMap.set(e,[]);var n=this.listenerMap.get(e),r={add:function(i,s){return"addEventListener"in t?(n.push(function(){return t.removeEventListener(i,s)}),t.addEventListener(i,s)):"on"in t&&(n.push(function(){return t.off(i,s)}),t.on(i,s)),r}};return r},o.prototype.cleanup=function(e){var t=this.listenerMap.get(e);t&&(t.forEach(function(n){return n()}),this.listenerMap.delete(e))},o}(),qi=function(){return qi=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},qi.apply(this,arguments)},ms=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},vs=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Dd=["videoInput","videoQuality","facingMode","width","height","frameRate","videoOptimizationMode"],Vl=["audioInput","channelCount","ANS","AGC","AEC"],la=function(){function o(e,t,n,r,i){this.an=e,this.pn=t,this.gn=n,this.previewType=r,this.onlyPreview=i,this.Ka={width:0,height:0,frameRate:0,bitRate:0,minBitrate:0,startBitrate:"default",keyFrameInterval:2,channelCount:1,audioBitrate:48e3,contentHint:""},this.rtcViewer=null,this.streamFromCanvas=!1,this.streamFromCanvasTrack=null,this.previewSuc=!1,this.soundLevel=0,this.hasEmptyAudioTrack=!1,this.Za=null,this.voiceProccessor=null,this.lastTrackEndTime={audio:0,video:0},this.script=null,this.mic=null,this.eventListenerManager=new Jh,this.Xa=null,this._videoTrack=null,this.cloneVideoTrack=null,this.originVideoTrack=null,this.originAudioTrack=null,this.activateSEIConfig=null,this.Wa=!0,this.hasStopCaptureVideo=!1,this.$a=!0,this.gainNode=null,this.cameraMaxResolution={},this.enableDualStream=!1,this.lowStreamConfig={width:160,height:120,frameRate:15,bitRate:50},this._c=null,this.syncVideoEnabled=!1,this.syncAudioEnabled=!1,this.hasMicTrack=!0,this.soundMeterWorklet=null,this.audioMixManager=null,this.volume=100,this.volumeFactor=1,this.logger=e,this.stateCenter=t,this.streamCenter=n,r&&(this.videoPreviewType=r,this.audioPreviewType=r)}return Object.defineProperty(o.prototype,"localStream",{get:function(){return this.xu},set:function(e){this.xu=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"videoInfo",{get:function(){return this.Ka},set:function(e){this.Ka=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"mediaStreamConfig",{get:function(){return this.Sc},set:function(e){this.Sc=e},enumerable:!1,configurable:!0}),o.prototype.getEmptyAudioTrack=function(){if(!this.Za){var e=this.gn.ac.createMediaStreamDestination(),t=e?e.stream:null,n=this.Za=t?t.getAudioTracks()[0]:null;this.an.info("zp.geat "+"empty audio id: ".concat(n==null?void 0:n.id))}return this.Za},o.prototype.checkAudioExceptionEnded=function(e){var t;e&&(this.gn.trackUtils.isTrackStopBySDK(e)||this.xu&&this.audioPreviewType==="camera"&&this.gn.getPublishList(this.xu).length>0&&e.id===((t=this.Xa)===null||t===void 0?void 0:t.id)&&(this.pn.actionListener("_deviceError",Et.T1C.code,e.label,"micro"),this.pn.actionListener("deviceError",Et.T1C.code,e.label),this.gn.checkDeviceChange&&this.gn.checkDeviceChange()))},o.prototype.checkVideoExceptionEnded=function(e){var t;e&&(this.gn.trackUtils.isTrackStopBySDK(e)||this.xu&&this.videoPreviewType==="camera"&&this.gn.getPublishList(this.xu).length>0&&e.id===((t=this.videoTrack)===null||t===void 0?void 0:t.id)&&(this.pn.actionListener("_deviceError",Et.zgf.code,e.label,"camera"),this.pn.actionListener("deviceError",Et.zgf.code,e.label),this.gn.checkDeviceChange&&this.gn.checkDeviceChange()))},o.prototype.bindAudioTrackEvent=function(e){var t=this;this.eventListenerManager.bind(e,e).add("ended",function(){t.logger.info("zp.pv.te audio track ended"),t.lastTrackEndTime.audio=performance.now(),t.checkAudioExceptionEnded(e)}).add("mute",function(){t.logger.info("zp.pv.te audio track mute")}).add("unmute",function(){t.logger.info("zp.pv.te audio track unmute")})},o.prototype.bindVideoTrackEvent=function(e){var t=this;this.eventListenerManager.bind(e,e).add("ended",function(){t.logger.info("zp.pv.te video track ended"),t.lastTrackEndTime.video=performance.now(),t.checkVideoExceptionEnded(e)}).add("mute",function(){t.logger.info("zp.pv.te video track mute")}).add("unmute",function(){t.logger.info("zp.pv.te video track unmute")})},o.prototype.removeAudioTrackEvent=function(e){this.eventListenerManager.cleanup(e)},o.prototype.removeVideoTrackEvent=function(e){this.eventListenerManager.cleanup(e)},Object.defineProperty(o.prototype,"audioTrack",{get:function(){var e;return this.Xa||((e=this.xu)===null||e===void 0?void 0:e.getAudioTracks()[0])||null},set:function(e){this.Xa!==e&&(this.Xa&&this.removeAudioTrackEvent(this.Xa),this.Xa=e,e&&!this.onlyPreview&&this.bindAudioTrackEvent(e))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"videoTrack",{get:function(){var e;return this._videoTrack||((e=this.xu)===null||e===void 0?void 0:e.getVideoTracks()[0])||null},set:function(e){this._videoTrack!==e&&(this._videoTrack&&this.removeVideoTrackEvent(this._videoTrack),this._videoTrack=e,e&&!this.onlyPreview&&this.bindVideoTrackEvent(e))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isAudioEnabled",{get:function(){return this.Wa},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isVideoEnabled",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"muteImage",{get:function(){return this._c},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"videoNodeQueue",{get:function(){if(!this.Tc){if(!this._videoTrack)throw new Error("cannot use video node queue, because videoTrack of previewer haven't been inited.");var e=new Sd(this._videoTrack,this.gn),t=new Hh(this,this.pn.browser);this.Tc=new Fh(e,t,this.gn,this.pn.browser,this),this.vcMgr&&(this.Tc.vcMgr=this.vcMgr)}return this.Tc},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isVideoNodeQueueEnabled",{get:function(){return this.Tc&&!this.Tc.isEmpty()},enumerable:!1,configurable:!0}),o.prototype.getDestinationTrack=function(){return!this.Tc||this.Tc.isEmpty()?null:this.videoNodeQueue.getDestinationTrack()},Object.defineProperty(o.prototype,"ac",{get:function(){return this.gn.ac},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"acMgr",{get:function(){return this.gn.acMgr},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"vcMgr",{get:function(){if(!this._vcMgr){if(!this._videoTrack)throw new Error("cannot use video node queue, because videoTrack of previewer haven't been inited.");this._vcMgr=new jh(this.logger,this.pn.browser,this.gn.isCustomVC),this.Tc&&(this.Tc.vcMgr=this.vcMgr)}return this._vcMgr},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"containBackgroundProcess",{get:function(){var e=this;return this.previewType==="compositing"?this.inputStreamOptions.some(function(t){if(t.stream){var n=e.gn.checkPreview(t.stream);return n==null?void 0:n.isBackgroundBlur}}):!!this.isBackgroundBlur},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"micTrack",{get:function(){return this.hasMicTrack&&this.audioPreviewType==="camera"&&this.audioTrack||null},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isVideoEffectStarting",{get:function(){return!!this.videoEffect&&this.videoEffect.isStarting},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isVideoEffectEnabled",{get:function(){return!!this.videoEffect&&this.videoEffect.enabled},enumerable:!1,configurable:!0}),o.prototype.getMediaStreamConstraints=function(e,t){var n={audio:null,video:null},r=(0,Vn.UN)();if(r&&r.includes("11_4")||(e=Uu(this.pn,this.an,e),e=aa(e)),n.audio=!0,n.video={width:this.pn.settingConfig.getSetting("camera_width")||640,height:this.pn.settingConfig.getSetting("camera_height")||480,frameRate:this.pn.settingConfig.getSetting("camera_framerate")||15,bitRate:this.pn.settingConfig.getSetting("camera_video_bitrate")},e.audio){var i=this.pn.settingConfig.getCloudSettingScenario(this.pn.scenario);this.logger.info("zp.gmsc.2 audio cloud config "+JSON.stringify(i));var s=i.ANS,c=i.AGC,u=i.AEC;n.audio={},e.audioInput&&e.audioInput!=="undefined"&&(n.audio.deviceId={exact:e.audioInput}),n.audio.noiseSuppression=s,n.audio.autoGainControl=c,n.audio.echoCancellation=u,(0,R.dd)(e.ANS)&&(n.audio.noiseSuppression=e.ANS),(0,R.dd)(e.AGC)&&(n.audio.autoGainControl=e.AGC),(0,R.dd)(e.AEC)&&(n.audio.echoCancellation=e.AEC),n.audio.channelCount=(0,R.Cs)(e.channelCount)?e.channelCount:1}else e.audio===!1&&(n.audio=!1);if(e.video){var l=640,a=480,h=15,m=this.pn.settingConfig.getSetting("camera_video_bitrate");if(e.videoQuality===1?(l=v.width,a=v.height,h=v.frameRate,m=v.bitRate):e.videoQuality===2?(l=f.width,a=f.height,h=f.frameRate,m=f.bitRate):e.videoQuality===3?(l=_.width,a=_.height,h=_.frameRate,m=_.bitRate):(l=e.width||640,a=e.height||480,h=e.frameRate||15,m=e.bitRate||this.pn.settingConfig.getSetting("camera_video_bitrate"),this.an.info("zp.gmsc.2 quality: ",e.videoQuality)),t&&!e.videoQuality&&(e.width&&(l=e.width),e.height&&(a=e.height),e.frameRate&&(h=e.frameRate),e.bitRate&&(m=e.bitRate)),e.horizontal===!1){var S=a;a=l,l=S}e.isSwitch===!0&&(S=a,a=l,l=S),n.video={width:2*Math.floor(Number(l)/2),height:2*Math.floor(Number(a)/2),frameRate:h,bitRate:m},e.facingMode!=null?n.video.facingMode=e.facingMode:e.videoInput&&e.videoInput!="undefined"&&(n.video.deviceId={exact:e.videoInput}),this.an.info("zp.gmsc.2 width: "+l+" height: "+a+" rate: "+h)}else e.video===!1&&(n.video=!1);return{mediaStreamConstraints:n,mediaStreamConfig:e}},o.prototype.startPreview=function(e,t,n,r){return ms(this,void 0,void 0,function(){var i,s,c;return vs(this,function(u){switch(u.label){case 0:if(this.an.info("zp.sv.2 called "+JSON.stringify(e)),this.Sc=qi({},e),e.video===!1&&this.deleteConstraints(this.Sc,Dd),e.audio===!1&&this.deleteConstraints(this.Sc,Vl),this.an.info("zp.sv.2 store "+JSON.stringify(this.Sc)),i=function(l){t(l)},(0,R.dr)(e.source)||(0,R.Si)(e.source)){try{s=this.Uc(e),i&&i(s)}catch(l){n(l)}return[2]}return navigator.mediaDevices!==void 0&&navigator.mediaDevices.getUserMedia!=null?[3,1]:(n&&n(k.eU.error.yn),[2]);case 1:return u.trys.push([1,3,,4]),[4,this.Vc(e,r)];case 2:return s=u.sent(),i&&i(s),[3,4];case 3:return c=u.sent(),n(c),[3,4];case 4:return[2]}})})},Object.defineProperty(o.prototype,"hasUserSetBitrate",{get:function(){var e,t=this.Sc,n=t.bitRate;return((e=n??t.bitrate)!==null&&e!==void 0?e:t.videoQuality)!==void 0},enumerable:!1,configurable:!0}),o.prototype.Vc=function(e,t){var n,r;return ms(this,void 0,void 0,function(){var i,s,c,u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je,tt,ut,vt,gt,Pt,wt,At,Vt,qt,Gt=this;return vs(this,function(Sn){switch(Sn.label){case 0:i=this.getMediaStreamConstraints(e),c=i.mediaStreamConfig,u={},(s=i.mediaStreamConstraints).video?u=qi({},s.video):(0,R.TE)(c.bitRate)||(u.bitRate=c.bitRate),this.Ka=qi(qi({},this.Ka),u),this.Ka.audioBitrate=1e3*c.audioBitrate||48e3,this.Ka.startBitrate=c.startBitrate||this.pn.settingConfig.getSetting("bitrate_mode"),this.Ka.minBitrate=c.minBitrate,this.Ka.keyFrameInterval=c.keyFrameInterval||this.Ka.keyFrameInterval,(0,R.QP)(e.videoOptimizationMode)&&(this.Ka.contentHint=e.videoOptimizationMode),this.logger.info("zp.sv.2 update video info  ".concat(JSON.stringify(this.Ka),", onlyPreview: ").concat(this.onlyPreview)),s.audio&&(l=this.pn.settingConfig.getCloudSettingScenario(this.pn.scenario,!0),h=l.channelCount,m=l.AEC,S=l.AGC,x=l.ANS,this.logger.info("zp.sv.2 scenario ".concat(a=l.audioBitrate," ").concat(h," ").concat(m," ").concat(S," ").concat(x)),a&&(this.Ka.audioBitrate=1e3*a),h&&(s.audio.channelCount=h,this.Ka.channelCount=h),(0,R.dd)(m)&&(this.logger.info("zp.sv.2 setting AEC "+m),this.Sc.AEC=s.audio.echoCancellation=m),(0,R.dd)(S)&&(this.logger.info("zp.sv.2 setting AGC "+S),this.Sc.AGC=s.audio.autoGainControl=S),(0,R.dd)(x)&&(this.logger.info("zp.sv.2 setting ANS "+x),this.Sc.ANS=s.audio.noiseSuppression=x)),s.video instanceof Object&&(s.video.width=this.pn.settingConfig.getSetting("camera_width",!0)||s.video.width,s.video.height=this.pn.settingConfig.getSetting("camera_height",!0)||s.video.height,s.video.frameRate=this.pn.settingConfig.getSetting("camera_framerate",!0)||s.video.frameRate),this.Sc.video=!!s.video,this.Sc.audio=!!s.audio,c.unlimitedCaptureResolution&&s.video.width&&(s.video.width={ideal:4096},s.video.height={ideal:2160},this.an.info("zp.sv.2 capture max resolution of camera")),this.logger.info("zp.sv.2 constraints "+JSON.stringify(s)),t.setAttribute("preview_conf",k.eU.preview_conf(s)),q=function(Qt){var Wt=k.eU.error.Tn;return Wt.message=Wt.message+" "+Qt.name+" "+Qt.message,Qt.name==="NotAllowedError"||Qt.name==="SecurityError"?(Wt=qi({},k.eU.error.Cn)).message=Qt.name+": "+Wt.message:Qt.name==="NotReadableError"?(Wt=qi({},k.eU.error.An)).message=Qt.name+": "+Wt.message:Qt.name==="OverconstrainedError"&&((Wt=qi({},k.eU.error.zn)).message=Qt.name+": "+Wt.message+(Qt.constraint?". such as "+Qt.constraint:"")),Wt},V=function(Qt,Wt){return new te.l3(function(zt){Gt.an.info("zp.sv.2 recapture call"),ku(function(Mt){var jt=Mt.cameras,Kt=Mt.microphones;if(Gt.an.info("zp.sv.2 recapture devices "+Wt+" "+jt.length+" "+Kt.length),Wt==="video"){if(!(jt.length>0))return void zt(void 0);var $t=jt[0].deviceID;Gt.an.info("zp.sv.2 recapture video "+$t),Qt.video.deviceId={exact:$t}}else if(Wt==="audio"){if(!(Kt.length>0))return void zt(void 0);var yt=Kt[0].deviceID;Gt.an.info("zp.sv.2 recapture audio "+yt),Qt.audio.deviceId={exact:yt}}navigator.mediaDevices.getUserMedia(Qt).then(function(Pn){Gt.an.info("zp.sv.2 recapture success"),zt(Pn)}).catch(function(Pn){zt(void 0)})},function(Mt){Gt.an.warn("zp.sv.2 recapture getDevices err:",Mt.message),zt(void 0)})})},_e=null,Sn.label=1;case 1:return Sn.trys.push([1,3,,6]),[4,navigator.mediaDevices.getUserMedia(s)];case 2:return(_e=Sn.sent()).getTracks().forEach(function(Qt){if(rn(Qt,Gt.an,"zp.sv.2"),Qt.kind==="video"){var Wt=Qt.getSettings(),zt=Wt.height,Mt=Wt.frameRate;Gt.an.info("zp.sv.2 track settings ".concat(Wt.width," ").concat(zt," ").concat(Mt))}}),this.an.info("zp.sv.2 success"),[3,6];case 3:return ke=Sn.sent(),this.an.info("zp.sv.2 failed "+ke.name+" "+ke.message),ke.name!=="NotFoundError"?[3,5]:(Oe=s.video===!1,Ge=!1,Je=!1,(Pe=s.audio===!1)&&(Ge=(0,R.TE)((n=s.video)===null||n===void 0?void 0:n.videoInput)),Oe&&(Je=(0,R.TE)((r=s.audio)===null||r===void 0?void 0:r.audioInput)),this.an.info("zp.sv.2 failed "+(tt=Pe&&Ge||Oe&&Je)+" "+(ut=Pe?"video":"audio")),tt?[4,V(s,ut)]:[3,5]);case 4:(vt=Sn.sent())&&(_e=vt),Sn.label=5;case 5:if(!_e)throw q(ke);return[3,6];case 6:return this.xu=_e,this.previewSuc=!0,this.initMediaTrack(_e),this.Ka&&((gt=_e.getVideoTracks()[0])&&(Pt=gt.getSettings(),wt=Pt.width,At=Pt.height,Vt=Pt.frameRate,(0,R.w)(this.Ka.width)&&wt&&(this.Ka.width=wt),(0,R.w)(this.Ka.height)&&At&&(this.Ka.height=At),(0,R.w)(this.Ka.frameRate)&&Vt&&(this.Ka.frameRate=Vt)),qt=(0,R.w)(s.audio)&&s.audio.channelCount,this.Ka.channelCount=qt||(this.audioTrack&&this.audioTrack.getSettings?this.audioTrack.getSettings().channelCount:1)),[2,_e]}})})},o.prototype.Uc=function(e){if((0,R.dr)(e.source)){var t=e.source.getVideoTracks(),n=t.length>0?t[0].getSettings():{width:0,height:0,frameRate:0};return this.an.debug("zp.sv.2 use external media stream"),this.previewSuc=!0,this.xu=new MediaStream(e.source),this.initMediaTrack(this.xu),this.Ka={width:n.width||0,height:n.height||0,frameRate:n.frameRate||0,bitRate:e.bitRate||this.pn.settingConfig.getSetting("custom_video_bitrate"),startBitrate:e.startBitrate||this.pn.settingConfig.getSetting("bitrate_mode"),minBitrate:e.minBitrate,keyFrameInterval:e.keyFrameInterval,channelCount:e.channelCount||(this.audioTrack&&this.audioTrack.getSettings?this.audioTrack.getSettings().channelCount:1),audioBitrate:1e3*e.audioBitrate||48e3,contentHint:""},(0,R.QP)(e.videoOptimizationMode)&&(this.Ka.contentHint=e.videoOptimizationMode),this.xu}if((0,R.Si)(e.source)){var r=this.captureStream(e.source,e);if(r)return this.Ka.bitRate=e.bitRate||this.pn.settingConfig.getSetting("custom_video_bitrate"),this.previewSuc=!0,this.initMediaTrack(r),r;throw k.eU.error.yn}return new MediaStream},o.prototype.captureStream=function(e,t){var n,r,i,s;if(!e)return this.an.info("zp.cs.2 no local video"),null;var c=this.streamCenter.captureStreamElementMap.get(e);if(c)this.an.info("zp.cs.2 stream has capture"),s=c.clone();else{var u=void 0;if(e.captureStream)u=e.captureStream(),this.an.debug("zp.cs.2 captureStream");else{if(!e.mozCaptureStream)return this.an.info("zp.cs.2 don't support"),null;u=e.mozCaptureStream();var l=(n=this.acMgr)===null||n===void 0?void 0:n.getMediaElementRenderer(e);l==null||l.setVoiceChangeNode(l.effectMode,l.voiceChangerNode,!0),this.an.debug("zp.cs.2 mozCaptureStream")}this.streamCenter.captureStreamElementMap.set(e,u),s=u.clone()}if(s.getTracks().length==0)return this.an.error("zp.cs.2 external capture tracks no found"),null;this.an.info("zp.cs.2 tracks: "+s.getTracks().length),this.xu=s;var a=(i=(r=s.getVideoTracks())===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.getSettings();return this.Ka={width:e.videoWidth,height:e.videoHeight,frameRate:(a==null?void 0:a.frameRate)||0,bitRate:t.bitRate||this.pn.settingConfig.getSetting("custom_video_bitrate"),channelCount:t.channelCount||(this.audioTrack&&this.audioTrack.getSettings?this.audioTrack.getSettings().channelCount:1),audioBitrate:1e3*t.audioBitrate||48e3,startBitrate:t.startBitrate||this.pn.settingConfig.getSetting("bitrate_mode"),minBitrate:t.minBitrate,keyFrameInterval:t.keyFrameInterval,contentHint:""},(0,R.QP)(t.videoOptimizationMode)&&(this.Ka.contentHint=t.videoOptimizationMode),this.an.debug("zp.cs.2 called success"),this.xu},o.prototype.stopPreview=function(){var e,t,n,r=this;if(this.an.info("zp.sv.2.1 called"),this.xu){var i=this.rtcViewer;i&&i.destroy(),this.videoEffect&&(this.videoEffect.setBeautyEffectOptions(!1),this.videoEffect.destroy()),this.Yc&&this.Yc.destroy(),this.voiceProccessor&&this.voiceProccessor.destroy(),(e=this.pn.backgroundBlurManager)===null||e===void 0||e.releaseMap(this.xu),this.backgroundProcessor&&(this.backgroundProcessor.release(),this.backgroundProcessor=null),this.streamCompositor&&(this.streamCompositor=null),this.Tc&&this.videoNodeQueue.destroy(),this.gn.trackUtils.stopTrack(this.cloneVideoTrack),this.cloneVideoTrack=null,this.muteImageAnID&&cancelAnimationFrame(this.muteImageAnID),this.blkImgAnId&&cancelAnimationFrame(this.blkImgAnId),this.stopSoundLevel(),this.gn.trackUtils.stopTrack(this.originVideoTrack),this.originVideoTrack=null,this.gn.trackUtils.stopTrack(this.originAudioTrack),this.originAudioTrack=null,this.gn.trackUtils.stopTrack(this.videoTrack),this.videoTrack=null,this.gn.trackUtils.stopTrack(this.audioTrack),this.audioTrack=null,zl.sourceDisConnect(this.xu),(t=this.audioMixManager)===null||t===void 0||t.stopAudioManager(),this.Zc(),!this.zegoCaptureStream&&this.xu.getTracks().forEach(function(s){r.gn.trackUtils.stopTrack(s)}),this.xu=null,!this.zegoCaptureStream&&((n=this.lowStream)===null||n===void 0||n.getTracks().forEach(function(s){return r.gn.trackUtils.stopTrack(s)})),this.lowStream=void 0,this.Ka={width:0,height:0,frameRate:0,bitRate:0,minBitrate:0,startBitrate:"default",keyFrameInterval:2,channelCount:1,audioBitrate:48e3,contentHint:""}}},o.prototype.enableMicrophone=function(e){var t=this;if(!this.localStream)return this.an.error("zp.em.2 no localStream"),!1;var n=this.localStream.getAudioTracks()[0];n.enabled=e;var r=this.gn,i=r.isMicEnabled&&e;this.audioTrack&&(this.audioTrack.enabled=i);var s=r.getPublishList(this.localStream).map(function(c){return c.publisher});return s.length&&s.forEach(function(c){return ms(t,void 0,void 0,function(){var u,l;return vs(this,function(a){switch(a.label){case 0:return u=!e,(l=c.audioSender)?u?[4,l.replaceTrack(null)]:[3,2]:[2];case 1:return a.sent(),[3,4];case 2:return[4,l.replaceTrack(n)];case 3:a.sent(),a.label=4;case 4:return[2]}})})}),this.Xc(i,3),this.Wa=e,this.an.debug("zp.em.2 call success. "+e),!0},o.prototype.updatePublisherStreamMicStatus=function(e,t){this.Xc(this.Wa&&e,t)},o.prototype.Xc=function(e,t){if(this.xu){var n=this.gn.getPublishList(this.xu).map(function(r){return r.publisher});n.length&&n.forEach(function(r){r.sendStreamStatus(r.camera_status,e?0:t)})}},o.prototype.updatePublisherStreamCameraStatus=function(e,t){if(this.xu){var n=this.gn.getPublishList(this.xu).map(function(r){return r.publisher});n.length&&n.forEach(function(r){r.sendStreamStatus(e?0:t,r.mic_status)})}},o.prototype.enableMicrophoneOnly=function(e){return this.xu?this.micTrack?(this.micTrack.enabled=this.Wa&&e,this.updatePublisherStreamMicStatus(e,3),this.an.debug("zp.emo.2 call success"),!0):(this.an.info("zp.emo.2 no micTrack"),!0):(this.an.error("zp.em.2 no localStream"),!1)},o.prototype.enableCamera=function(e,t,n){var r;return ms(this,void 0,void 0,function(){var i,s,c,u,l,a,h,m,S,x=this;return vs(this,function(q){switch(q.label){case 0:return this.localStream&&this.videoTrack?(i=this.videoTrack,u=this.lowStream,this._c&&(e?e&&(this.isVideoNodeQueueEnabled?setTimeout(function(){var V=x.videoNodeQueue.getDestinationTrack();V&&x.replacePreviewTrack(V,!0)},800):this.videoTrack&&this.replacePreviewTrack(this.videoTrack,!1)):(s=this.Wc(this._c),this.localStream.removeTrack(this.localStream.getVideoTracks()[0]),this.localStream.addTrack(s),this.rtcViewer&&this.rtcViewer.setVideo(s),u&&(c=s.clone()))),n&&!e||!i?n&&!e&&(!((r=this.videoEffect)===null||r===void 0)&&r.enabled||this.isVideoNodeQueueEnabled?this.an.warn("zp.ec.2 Unable to keep the preview screen when beauty is turned on"):(l=this.cloneVideoTrack,this.cloneVideoTrack=this.videoTrack.clone(),this.cloneVideoTrack.enabled=!0,this.replacePreviewTrack(this.cloneVideoTrack,!1,{retainTrack:!0}),t.trackUtils.stopTrack(l))):(i.enabled=e,this.$c(e,i)),i&&(i.enabled=e),this.isVideoNodeQueueEnabled?((a=this.videoNodeQueue.getDestinationTrack())&&(a.enabled=e),e?[3,2]:[4,this.videoNodeQueue.replaceNewSourceByTrack(null,!1)]):[3,5]):(this.an.error("zp.ec.2 video track no found"),[2,!1]);case 1:q.sent(),q.label=2;case 2:return e&&i?[4,this.videoNodeQueue.replaceNewSourceByTrack(i,!1)]:[3,4];case 3:q.sent(),q.label=4;case 4:q.label=5;case 5:return u==null||u.getVideoTracks().forEach(function(V){V.enabled=e}),h=t.checkPreview(this.localStream),(m=t.getPublishList(this.localStream).map(function(V){return V.publisher})).length&&(S=null,m.forEach(function(V){var _e=V.publishOption.videoCodec==="H265",ke=!V.sideMediaConfig.isSEIStart,Pe=V.getVideoSenders();Pe&&Pe.forEach(function(Ge,Je){return ms(x,void 0,void 0,function(){var tt,ut,vt,gt,Pt=this;return vs(this,function(wt){switch(wt.label){case 0:return e?[3,10]:this._c?(V.setSendMuteImage(!0),V.isTcVideoPasued()?[3,4]:Pe.length>1&&Je===0&&c?[4,Ge==null?void 0:Ge.replaceTrack(c)]:[3,2]):[3,5];case 1:return wt.sent(),[3,4];case 2:return s?[4,Ge==null?void 0:Ge.replaceTrack(s)]:[3,4];case 3:wt.sent(),wt.label=4;case 4:return[3,9];case 5:return _e||!ke?[3,8]:V.isTcVideoPasued()?[3,7]:[4,Ge.replaceTrack(null)];case 6:wt.sent(),wt.label=7;case 7:return[3,9];case 8:_e&&(S||(tt=i==null?void 0:i.getSettings(),S=this.th(tt==null?void 0:tt.width,tt==null?void 0:tt.height,ke)),S&&Ge.replaceTrack(S)),wt.label=9;case 9:return[3,22];case 10:return e?(V.setSendMuteImage(!1),ut=0,!this._c&&_e&&((gt=Ge.track)===null||gt===void 0||gt.stop()),this.isVideoNodeQueueEnabled?(ut=800,vt=this.videoNodeQueue.getDestinationTrack(),V.isTcVideoPasued()||!vt||Ge.track===vt?[3,12]:[4,Ge==null?void 0:Ge.replaceTrack(vt)]):[3,13]):[3,22];case 11:wt.sent(),wt.label=12;case 12:return[3,21];case 13:return V.isTcVideoPasued()||Ge.track===this.videoTrack?[3,21]:h!=null&&h.streamFromCanvas?[3,19]:Pe.length>1&&Je===0?u?[4,Ge==null?void 0:Ge.replaceTrack(u.getVideoTracks()[0])]:[3,15]:[3,16];case 14:wt.sent(),wt.label=15;case 15:return[3,18];case 16:return[4,Ge==null?void 0:Ge.replaceTrack(this.videoTrack)];case 17:wt.sent(),wt.label=18;case 18:return[3,21];case 19:return[4,Ge==null?void 0:Ge.replaceTrack(h.streamFromCanvasTrack)];case 20:wt.sent(),wt.label=21;case 21:ut?setTimeout(function(){Pt.muteImageAnID&&clearInterval(Pt.muteImageAnID),Pt.blkImgAnId&&clearInterval(Pt.blkImgAnId)},ut):(this.muteImageAnID&&clearInterval(this.muteImageAnID),this.blkImgAnId&&clearInterval(this.blkImgAnId)),wt.label=22;case 22:return[2]}})})});var Oe=x._c&&!e?0:Au(x.videoTrack);V.sendStreamStatus(Oe,V.mic_status)})),this.$a=e,this.an.info("zp.ec.2 call success"),[2,!0]}})})},o.prototype.$c=function(e,t){var n=this;if(Ir(this.pn.browserInfo,"chrome",86,2)&&Ir(this.pn.browserInfo,"chrome",92,0)&&e&&!(0,R.TE)(t.getSettings().width)&&t.getSettings().width>0){var r=t.getSettings().width-1,i=t.getSettings().height-1,s=t.getSettings().frameRate;t.applyConstraints({width:r,height:i,frameRate:s}).then(function(){t.applyConstraints({width:n.videoInfo.width,height:n.videoInfo.height,frameRate:s})})}},o.prototype.stopCaptureVideo=function(){return ms(this,void 0,void 0,function(){var e,t,n,r,i=this;return vs(this,function(s){switch(s.label){case 0:return e=this.lowStream,this.videoTrack?(t=this.videoTrack.enabled,n=this.pn.browser==="safari",this.hasStopCaptureVideo=!0,r=function(){return ms(i,void 0,void 0,function(){return vs(this,function(c){switch(c.label){case 0:return this.videoTrack&&(this.videoTrack.enabled=!1),e&&(e.getVideoTracks()[0].enabled=!1),[4,new Promise(function(u){setTimeout(function(){u(void 0)},1e3)})];case 1:return c.sent(),[2]}})})},this.pn.engineConfig.previewClearLastFrame?n?[3,2]:(this.videoTrack.enabled=!1,e&&(e.getVideoTracks()[0].enabled=!1),[4,new te.l3(function(c){setTimeout(function(){c(void 0)},200)})]):[3,7]):[2];case 1:s.sent(),s.label=2;case 2:return this.isVideoNodeQueueEnabled?n?[4,r()]:[3,4]:[3,6];case 3:s.sent(),s.label=4;case 4:return[4,this.videoNodeQueue.replaceNewSourceByTrack(null,!1)];case 5:s.sent(),s.label=6;case 6:return this.gn.trackUtils.stopTrack(this.videoTrack),this.gn.trackUtils.stopTrack(e==null?void 0:e.getVideoTracks()[0]),this.stopCanvasStreamTrack(),this.videoTrack.enabled=t,[3,12];case 7:return this.isVideoNodeQueueEnabled?n?[4,r()]:[3,9]:[3,11];case 8:s.sent(),s.label=9;case 9:return[4,this.videoNodeQueue.replaceNewSourceByTrack(null,!1)];case 10:s.sent(),s.label=11;case 11:this.gn.trackUtils.stopTrack(this.videoTrack),this.gn.trackUtils.stopTrack(e==null?void 0:e.getVideoTracks()[0]),this.stopCanvasStreamTrack(),s.label=12;case 12:return[2]}})})},o.prototype.startSoundLevel=function(){var e;if(this.xu&&this.xu.getAudioTracks().length!=0){(e=this.soundMeterWorklet)===null||e===void 0||e.destroy();var t=this.gn.getCloudSoundInterval();try{var n=this,r=this.gn.createSoundLevel(this.ac,this.xu,this.gn.soundLevelInterval,t,function(s){n.soundLevel=100*s}),i=r.mic;this.soundMeterWorklet=r.soundMeter,this.mic=i}catch(s){this.an.error(ie.b9b+" get sound level failed "+s)}}},o.prototype.stopSoundLevel=function(){var e;this.soundLevel=0,(e=this.soundMeterWorklet)===null||e===void 0||e.destroy(),this.soundMeterWorklet=null,this.mic=null},o.prototype.restartSoundLevel=function(){this.gn.soundLevelDelegate?(this.stopSoundLevel(),this.startSoundLevel()):this.stopSoundLevel()},o.prototype.setBeautyEffect=function(e,t){return ms(this,void 0,void 0,function(){return vs(this,function(n){return[2]})})},o.prototype.setMuteImage=function(e){this._c=e},o.prototype.syncTrackState=function(e,t){t.enabled=e.enabled},o.prototype.replacePreviewTrack=function(e,t,n){var r;return t===void 0&&(t=!1),n===void 0&&(n={}),ms(this,void 0,void 0,function(){var i,s,c,u,l,a,h;return vs(this,function(m){return this.an.info("zsc.rpt.0 call "+"".concat(e.kind," ").concat(t," ").concat(JSON.stringify(n))),e&&e.kind&&this.localStream?(i=(n==null?void 0:n.retainTrack)===!0,c=!(s=e.kind==="audio"),u=s?"audioTrack":"videoTrack",this.syncAudioEnabled&&s&&this.audioTrack&&this.syncTrackState(this.audioTrack,e),c&&this.syncVideoEnabled&&this.videoTrack&&this.syncTrackState(this.videoTrack,e),s&&this.insertableaudio&&this.insertableaudio.track.id!==e.id&&(e=this.insertableaudio.getInsertableStreamTrack(e)),!i&&c&&!t&&this.isVideoNodeQueueEnabled?(this.an.info("zsc.rpt.0 videoNodeQueue replaceNewSource"),(r=this.Tc)===null||r===void 0||r.replaceNewSourceByTrack(e,void 0,qi({},n))):s&&this.audioNodeQueue&&!n.isTrackProcessedFromOriginalStream?((l=new MediaStream).addTrack(e),a=this.ac.createMediaStreamSource(l),this.audioNodeQueue.replaceSource(a),this.voiceProccessor&&(0,Vn.nr)()&&e!==this.Za&&this.voiceProccessor.resetWorklet()):s&&!this.audioNodeQueue&&this.destNode&&!n.isTrackProcessedFromOriginalStream?(this.createSrcNode(e,!0).connect(this.destNode),this.an.info("zsc.rpt.0 replace audio track with audio mix.")):(this.an.info("zsc.rpt.0 replace local ".concat(e.kind," track")),(h=this.localStream.getTracks().find(function(S){return S.kind===e.kind}))!==e&&(h&&(this.localStream.removeTrack(h),s?this.removeAudioTrackEvent(h):this.removeVideoTrackEvent(h)),this.localStream.addTrack(e)),this.rtcViewer&&(this.rtcViewer.setTrack(c,e),this.pn.browser==="safari"&&this.rtcViewer.resume(!0)),!i&&c&&this.enableDualStream&&this.createLowStream()),t||i||n.isTrackProcessedFromOriginalStream||(this.an.info("zsc.rpt.0 setTrack ".concat(u)),this[u]=e,n.handleTrack==="REMOVE"&&c&&(this.localStream.removeTrack(e),this.rtcViewer&&this.rtcViewer.setTrack(!0,null),this[u]=null)),this.gn.soundLevelDelegate&&this.soundMeterWorklet&&(this.mic=this.soundMeterWorklet.replaceSrcSource(this.ac,this.localStream)),s&&this.streamCompositor&&this.streamCompositor.replaceSource(this.localStream),n.isCamera&&(s?this.audioPreviewType="camera":this.videoPreviewType="camera"),this.an.info("zsc.rpt.0 end"),[2]):[2]})})},o.prototype.updateZegoStreamCaptureTrack=function(e){var t=this.zegoCaptureStream;if(t){var n=e.kind=="video"?t.originVideoStream:t.originAudioStream;if(n){var r=this.gn.checkPreview(n);this.an.info("zsc.uzsct replace zego preivew"),r==null||r.replacePreviewTrack(e)}}},o.prototype.createLowStream=function(){var e,t,n,r,i,s=(e=this.xu)===null||e===void 0?void 0:e.getVideoTracks()[0];if(s){var c=s.getSettings().height,u=s.getSettings().width,l=(0,Vn.$t)(),a=(0,Vn.hL)(),h=l.indexOf("Android")>-1||l.indexOf("Adr")>-1;this.an.info("zp.cls w: "+u+" h: "+c+" "+h+" "+a);var m=(0,R.Cs)((t=this.Ka)===null||t===void 0?void 0:t.width)&&(0,R.Cs)((n=this.Ka)===null||n===void 0?void 0:n.height)&&c==this.Ka.width&&u==this.Ka.height;if(a&&h&&m){var S=c;c=u,u=S}var x=c&&u?c/u:1;try{var q,V=this.lowStreamConfig,_e=V.width,ke=V.frameRate;if(q=Math.round(x*this.lowStreamConfig.width),this.an.info("zp.cls lw: "+_e+" lh: "+q),this.pn.browser==="firefox")this.lowStream=this.getStreamThroughCanvas(this.xu,{w:_e,h:q,fps:ke});else{this.lowStream=(r=this.xu)===null||r===void 0?void 0:r.clone();var Pe=(i=this.lowStream)===null||i===void 0?void 0:i.getVideoTracks()[0];Pe==null||Pe.applyConstraints({width:_e,height:q,frameRate:ke})}}catch(Oe){this.an.error("zp.cls "+Oe)}}},o.prototype.initAudioNodeQueue=function(e){if(!this.audioTrack||!this.xu)return!1;var t=this.createSrcNode(this.audioTrack),n=this.createDestNode(this.xu);return this.audioNodeQueue=new xh(t,n),!0},o.prototype.createSrcNode=function(e,t,n){var r;t===void 0&&(t=!1),n===void 0&&(n=!1);var i=e||this.audioTrack;if(i===((r=this.destNode)===null||r===void 0?void 0:r.stream.getAudioTracks()[0])&&(this.an.info("zp.pv.csn use empty track"),i=this.getEmptyAudioTrack()),this.srcNode&&!n){if(!t)return this.srcNode;this.srcNode.disconnect(),this.an.info("zp.pv.csn recreate src")}var s=new MediaStream;i&&s.addTrack(i);var c=this.ac.createMediaStreamSource(s);return n||(this.srcNode=c),this.an.info("zp.pv.csn "+"create src audio id: ".concat(i==null?void 0:i.id,", ").concat(i==null?void 0:i.label,",i")),c},o.prototype.isOriginEmptyTrack=function(){return!this.audioTrack||this.Za===this.audioTrack},o.prototype.createDestNode=function(e){if(this.destNode)return this.destNode;var t=this.destNode=this.destNode||this.ac.createMediaStreamDestination(),n=t.stream.getAudioTracks()[0];this.an.info("zp.pv.cdn "+"create dest audio id: ".concat(n==null?void 0:n.id,", ").concat(n==null?void 0:n.label,",i"));var r=this.rtcViewer;for(var i in this.gn.publisherList){var s=this.gn.publisherList[i];if(s.localStream==e){var c=s.publisher.audioSender;c&&(c.replaceTrack(n),this.an.info("zc.pv.cdn change sender audio track"));break}}var u=e.getAudioTracks()[0];return u&&(e.removeTrack(u),!this.isOriginEmptyTrack()&&n&&(n.enabled=this.Wa)),e.addTrack(n),r&&r.setAudio(n),t},o.prototype.initMediaTrack=function(e){e.getVideoTracks().length>0&&(this.videoTrack=e.getVideoTracks()[0],this.originVideoTrack=this.videoTrack),e.getAudioTracks().length>0&&(this.audioTrack=e.getAudioTracks()[0],this.originAudioTrack=this.audioTrack)},o.prototype.onAudioTrackChange=function(e){},o.prototype.getViewer=function(){return!this.xu||this.rtcViewer&&this.rtcViewer.inited||(this.rtcViewer=new Ml(this.xu,this,{clearLastFrame:this.pn.engineConfig.previewClearLastFrame})),this.rtcViewer},o.prototype.getStreamThroughCanvas=function(e,t){var n,r=this;if(e.getVideoTracks().length==0)return e;var i=(n=e.getVideoTracks()[0])===null||n===void 0?void 0:n.getSettings(),s=i.width,c=i.height,u=i.frameRate;if(!s||!c||!u)return e;var l=(0,te.sb)(),a=te.VJ.createElement("canvas"),h=a.getContext("2d");l.setAttribute("style","display:none"),a.setAttribute("style","display:none"),a.width=(t==null?void 0:t.w)||s,a.height=(t==null?void 0:t.h)||c,new te.l3(function(q,V){var _e=null,ke=function(){_e&&clearTimeout(_e),l&&l.removeEventListener("playing",ke),q(void 0)};l&&l.addEventListener("playing",ke),_e=window.setTimeout(function(){r.an.error("zc.gstc play canvas video timeout"),l.play(),_e=window.setTimeout(function(){V()},3e3)},2e3)}).then(function(){var q=(t==null?void 0:t.fps)||u||15;r.ih&&(clearInterval(r.ih),r.ih=null),r.ih=setInterval(function(){var V,_e=(V=e.getVideoTracks()[0])===null||V===void 0?void 0:V.getSettings();a.width=(t==null?void 0:t.w)||_e.width||l.videoWidth,a.height=(t==null?void 0:t.h)||_e.height||l.videoHeight,h==null||h.drawImage(l,0,0,a.width,a.height)},1e3/q)}),l.srcObject=e,l.play().catch(function(q){r.an.error("zc.gstc play canvas video error: "+q.message)});var m=a.captureStream((t==null?void 0:t.fps)||15),S=m.getVideoTracks()[0];if(S.stop=function(){var q;r.an.info("zc.gstc stop canvas track:"+S.id),r.ih&&(clearInterval(r.ih),r.ih=null),l&&((q=l.srcObject)===null||q===void 0||q.getVideoTracks().forEach(function(V){V.stop()}),l.pause(),l.remove(),l=null),a&&(a.remove(),a=null)},(0,R.dr)(e)&&e.getAudioTracks().length){var x=e.getAudioTracks()[0];m.addTrack(x)}return m},o.prototype.stopCanvasStreamTrack=function(){this.streamFromCanvas&&this.streamFromCanvasTrack&&(this.gn.trackUtils.stopTrack(this.streamFromCanvasTrack),this.streamFromCanvasTrack=null),this.ih&&(clearInterval(this.ih),this.ih=null)},o.prototype.updateVideoInfo=function(e){var t={width:e.width,height:e.height,frameRate:e.frameRate,bitRate:e.bitRate,minBitrate:e.minBitrate,keyFrameInterval:e.keyFrameInterval};return this.an.info("zc.pv.uvi input video info: ".concat(JSON.stringify(t))),this.Ka=qi(qi(qi({},this.Ka),t),{bitRate:this.Ka.bitRate||t.bitRate,minBitrate:this.Ka.bitRate||t.bitRate}),qi({},this.Ka)},o.prototype.updateAudioInfo=function(e){var t={};return this.an.info("zc.pv.uai input audio info: ".concat(JSON.stringify(t))),this.Ka=qi(qi({},this.Ka),t),qi({},this.Ka)},o.prototype.setVideoInfo=function(e){if(e){var t=e.width,n=e.height,r=e.frameRate,i=e.bitRate,s=e.startBitrate,c=e.minBitrate,u=e.keyFrameInterval,l=e.channelCount,a=e.audioBitrate,h=e.contentHint;t!==void 0&&(this.Ka.width=t),n!==void 0&&(this.Ka.height=n),r!==void 0&&(this.Ka.frameRate=r),i!==void 0&&(this.Ka.bitRate=i),s!==void 0&&(this.Ka.startBitrate=s),c!==void 0&&(this.Ka.minBitrate=c),u!==void 0&&(this.Ka.keyFrameInterval=u),l!==void 0&&(this.Ka.channelCount=l),a!==void 0&&(this.Ka.audioBitrate=a),h!==void 0&&(this.Ka.contentHint=h)}},o.prototype.updateMediaStreamConstraints=function(e,t){var n=this;this.an.info("zc.pv.umsc ".concat(JSON.stringify(e))),t==="video"?Dd.forEach(function(r){return n.Sc[r]=e[r]}):Vl.forEach(function(r){return n.Sc[r]=e[r]})},o.prototype.deleteConstraints=function(e,t){t.forEach(function(n){return delete e[n]})},o.prototype.setVolumeFactorByUserCount=function(e){var t,n=this.pn.engineConfig.choirRole;if(this.xu){this.an.info("zc.pv.svf ".concat((t=this.xu)===null||t===void 0?void 0:t.id," count: ").concat(e,", mic: ").concat(!!this.micTrack,", choir role: ").concat(n));var r=this.volumeFactor,i=[1,2].includes(n);if(this.micTrack&&i)for(var s=[[0,1],[3,1],[4,.9],[8,.7],[12,.5],[16,.45],[20,.4],[24,.35],[1/0,.3]],c=0;c<s.length;c++){var u=s[c][0],l=s[c+1];if(!l){this.an.error("zc.pv.svf error: no map factor");break}if(e>=u&&e<l[0]){r=l[1];break}}else r=n===1?.6:1;this.audioMixManager&&this.audioMixManager.setVolumeFactor(n===1?.6:1),this.an.info("zc.pv.svf factor: ".concat(r)),this.setVolume(void 0,r)}},o.prototype.setVolume=function(e,t){var n,r,i;this.an.info("zc.pv.scv volume: ".concat(e,", factor: ").concat(t,"; origin: ").concat(this.volume,", ").concat(this.volumeFactor)),e===void 0?e=this.volume:this.volume=e,t===void 0?t=this.volumeFactor:this.volumeFactor=t;var s=this.gainNode;s||(this.audioNodeQueue||this.initAudioNodeQueue(),s=this.ac.createGain(),(n=this.audioNodeQueue)===null||n===void 0||n.pushFront(s),this.gainNode=s);var c=e/100*this.volumeFactor;if((0,R.Cs)(c)){var u=!1;s.gain.value!=c&&(u=!0,s.gain.value=c),this.an.info("zc.pv.scv ".concat(this.audioPreviewType," ").concat((i=this.xu)===null||i===void 0?void 0:i.id,"  volume: ").concat(c,". hasChanged: ").concat(u))}else this.an.error("zc.pv.scv ".concat(this.audioPreviewType," ").concat((r=this.xu)===null||r===void 0?void 0:r.id,"  volume error: ").concat(c))},o.prototype.Wc=function(e){var t=(0,te.FP)(e.width,e.height),n=t.getContext("2d");return this.muteImageAnID=setInterval(function(){e&&(n==null||n.drawImage(e,0,0))},100),t.captureStream().getVideoTracks()[0]},o.prototype.th=function(e,t,n){(e<160||t<160)&&(e=160,t=160);var r=(0,te.FP)(e,t),i=r.getContext("2d");return n?i&&(i.fillStyle="black",i.fillRect(0,0,e,t)):this.blkImgAnId=setInterval(function(){i&&(i.fillStyle="black",i.fillRect(0,0,e,t))},100),r.captureStream().getVideoTracks()[0]},o.prototype.setAudioFrameCallback=function(e,t){if(this.an.info("zc.pv.safc call"),this.xu){this.Yc||(this.Yc=new Ad(this.ac,this.an));var n=e!==null;this.audioNodeQueue||this.initAudioNodeQueue(),this.audioNodeQueue&&this.Yc.setAudioFrameCallback(this.audioNodeQueue.destinationNode.stream,n,function(r){e&&e(r)},t)}else this.an.info("zc.pv.safc no localStream")},o.prototype.Zc=function(){this.Yc&&(this.Yc.destroy(),this.Yc=null)},o}();pt(8899),function(o){o[o.Song=0]="Song",o[o.Accompaniment=1]="Accompaniment",o[o.AccompanimentClip=2]="AccompanimentClip",o[o.AccompanimentSegment=3]="AccompanimentSegment"}(Id||(Id={})),function(o){o[o.Count=0]="Count",o[o.User=1]="User",o[o.Room=2]="Room",o[o.Master=3]="Master"}(Rd||(Rd={})),function(o){o[o.VendorDefault=0]="VendorDefault",o[o.Vendor1=1]="Vendor1",o[o.Vendor2=2]="Vendor2",o[o.Vendor3=4]="Vendor3"}(kd||(kd={})),function(o){o[o.PortraitSegmentation=0]="PortraitSegmentation"}(Pd||(Pd={}));var Od,Nd,Ld,Md,xd,Bd,Ud,So,da=pt(166);pt(9728),function(o){o[o.Off=0]="Off",o[o.On=1]="On"}(Od||(Od={})),function(o){o[o.PortraitSegmentation=0]="PortraitSegmentation"}(Nd||(Nd={})),function(o){o[o.ZegoGeoFenceTypeNone=0]="ZegoGeoFenceTypeNone",o[o.ZegoGeoFenceTypeInclude=1]="ZegoGeoFenceTypeInclude",o[o.ZegoGeoFenceTypeExclude=2]="ZegoGeoFenceTypeExclude"}(Ld||(Ld={})),function(o){o[o.ZegoDefined=0]="ZegoDefined",o[o.UserUnregister=1]="UserUnregister"}(Md||(Md={})),function(o){o[o.TrafficControlFocusOnLocalOnly=0]="TrafficControlFocusOnLocalOnly",o[o.TrafficControlFocusOnRemote=1]="TrafficControlFocusOnRemote"}(xd||(xd={})),function(o){o[o.NoVideo=0]="NoVideo"}(Bd||(Bd={})),function(o){o[o.Allow=0]="Allow",o[o.NotAllow=1]="NotAllow"}(Ud||(Ud={})),function(o){o[o.video=0]="video",o[o.audio=1]="audio",o[o.videoAndAudio=2]="videoAndAudio"}(So||(So={}));var Qi=pt(327),Kh=function(){function o(e){this.zegoStream=e}return Object.defineProperty(o.prototype,"active",{get:function(){return this.zegoStream.active},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"id",{get:function(){return this.zegoStream.id},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"videoCaptureStream",{get:function(){return this.zegoStream.originVideoStream},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"audioCaptureStream",{get:function(){return this.zegoStream.originAudioStream},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"stream",{get:function(){return this.zegoStream.stream},enumerable:!1,configurable:!0}),o.prototype.getAudioTracks=function(){return this.zegoStream.getAudioTracks()},o.prototype.getVideoTracks=function(){return this.zegoStream.getVideoTracks()},o.prototype.getTracks=function(){return this.zegoStream.getTracks()},Object.defineProperty(o.prototype,"videoDeviceId",{get:function(){return this.zegoStream.videoDeviceId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"audioDeviceId",{get:function(){return this.zegoStream.audioDeviceId},enumerable:!1,configurable:!0}),o.prototype.on=function(e,t){return this.zegoStream.on(e,t)},o.prototype.off=function(e,t){return this.zegoStream.off(e,t)},o.prototype.startCaptureMicrophone=function(e){return this.zegoStream.startCaptureMicrophone(e)},o.prototype.startCaptureCamera=function(e){return this.zegoStream.startCaptureCamera(e)},o.prototype.startCaptureCameraAndMicrophone=function(e,t){return this.zegoStream.startCaptureCameraAndMicrophone(e,t)},o.prototype.startCaptureCustomAudio=function(e){return this.zegoStream.startCaptureCustomAudio(e)},o.prototype.startCaptureCustomVideo=function(e){return this.zegoStream.startCaptureCustomVideo(e)},o.prototype.startCaptureCustomVideoAndAudio=function(e,t){return this.zegoStream.startCaptureCustomVideoAndAudio(e,t)},o.prototype.startCaptureScreen=function(e){return this.zegoStream.startCaptureScreen(e)},o.prototype.startCaptureScreenWithAudio=function(e,t){return this.zegoStream.startCaptureScreenWithAudio(e,t)},o.prototype.stopCaptureAudio=function(){return this.zegoStream.stopCaptureAudio()},o.prototype.stopCaptureVideo=function(){return this.zegoStream.stopCaptureVideo()},o.prototype.playAudio=function(e){this.zegoStream.playAudio(e)},o.prototype.playCaptureAudio=function(e){this.zegoStream.playCaptureAudio(e)},o.prototype.playVideo=function(e,t){this.zegoStream.playVideo(e,t)},o.prototype.playCaptureVideo=function(e,t){this.zegoStream.playCaptureVideo(e,t)},o.prototype.takeStreamSnapshot=function(e){return this.zegoStream.takeStreamSnapshot(e)},o.prototype.resumeVideo=function(){return this.zegoStream.resumeVideo()},o.prototype.resumeAudio=function(){return this.zegoStream.resumeAudio()},o.prototype.stopVideo=function(){this.zegoStream.stopVideo()},o.prototype.stopAudio=function(){this.zegoStream.stopAudio()},o.prototype.stopPlayCaptureVideo=function(){this.zegoStream.stopPlayCaptureVideo()},o.prototype.stopPlayCaptureAudio=function(){this.zegoStream.stopPlayCaptureAudio()},o.prototype.setVolume=function(e){return this.zegoStream.setVolume(e)},o.prototype.useAudioOutputDevice=function(e){return this.zegoStream.setAudioOutputDevice(e)},o}(),zd=Kh,hn=function(){return hn=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},hn.apply(this,arguments)},Zi=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Xi=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},xu=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))},Yh=function(){function o(e,t,n,r,i){var s=this;this.eu=e,this.an=t,this.gn=n,this.pn=r,this.nh=i,this.id="zego-stream-"+Date.now().toString(16),this.originVideoStream=null,this.originAudioStream=null,this.audioMuted=!0,this.audioCaptureMuted=!0,this.stream=null,this.eh=[],this.rh=[],this.ou={autoplayFailed:function(c,u){s._a.emit("autoplayFailed",c,u)},autoplayCaptureFailed:function(c,u){s._a.emit("autoplayCaptureFailed",c,u)},canPlayAudio:function(c){s._a.emit("canPlayAudio",c)},canPlayVideo:function(c){s._a.emit("canPlayVideo",c)},canPlayCaptureVideo:function(c){s._a.emit("canPlayCaptureVideo",c)},canPlayCaptureAudio:function(c){s._a.emit("canPlayCaptureAudio",c)},videoTrackChanged:function(c){s._a.emit("videoTrackChanged",c)},audioTrackChanged:function(c){s._a.emit("audioTrackChanged",c)},captureVideoTrackChanged:function(c){s._a.emit("captureVideoTrackChanged",c)},captureAudioTrackChanged:function(c){s._a.emit("captureAudioTrackChanged",c)}},this.sh=!1,this.oh=!1,this.uh=null,this.ah=[],this.hh=null,this.mn=null,this.fh="",this.dh="",this.mh=null,this.ph=null,this._a=new Ha,this.autoPlay&&!e.view&&this.an.error("zcs.c if you want to play the stream automatically, the view parameter is required."),this.cr=this.pn.reporter}return Object.defineProperty(o.prototype,"active",{get:function(){var e,t;return((e=this.originAudioStream)===null||e===void 0?void 0:e.active)||((t=this.originVideoStream)===null||t===void 0?void 0:t.active)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"view",{get:function(){return this.eu.view||null},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"autoPlay",{get:function(){return!!(0,R.dd)(this.eu.autoPlay)&&this.eu.autoPlay},enumerable:!1,configurable:!0}),o.prototype.getAudioTracks=function(){var e;return this.an.info("zcs.gats call"),((e=this.originAudioStream)===null||e===void 0?void 0:e.getAudioTracks())||[]},o.prototype.getVideoTracks=function(){var e;return this.an.info("zcs.gvts call"),((e=this.originVideoStream)===null||e===void 0?void 0:e.getVideoTracks())||[]},o.prototype.getTracks=function(){return xu(xu([],this.getAudioTracks(),!0),this.getVideoTracks(),!0)},Object.defineProperty(o.prototype,"aCaptureViewer",{get:function(){return this.uh},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"viewer",{get:function(){return this.hh},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"videoDeviceId",{get:function(){var e=this.originVideoStream&&this.originVideoStream.getVideoTracks()[0];return e&&this._getDeviceIdByTrack(e)||""},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"audioDeviceId",{get:function(){var e=this.originAudioStream&&this.originAudioStream.getAudioTracks()[0];return e&&this._getDeviceIdByTrack(e)||""},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"gh",{get:function(){return this.nh.publishStreamHandler},enumerable:!1,configurable:!0}),o.prototype.on=function(e,t){return!!t&&this._a.addEventHandler(e,t)},o.prototype.off=function(e,t){return this._a.removeEventHandler(e,t)},o.prototype.startPublish=function(){},o.prototype.resetPublish=function(){this.bh()},o.prototype._getDeviceIdByTrack=function(e){return e&&e.getSettings().deviceId||""},o.prototype._h=function(e,t){var n=(0,R.w)(e)?e:{};return t.call(this,n)},o.prototype.yh=function(e,t){var n=this;if(this.an.info("zcs.uos call type:"+t),t==0){if(this.originVideoStream=e,this.autoPlay||this.oh){var r=this.ah.map(function(i){return{container:i.container,option:i.eu}});this.stopPlayCaptureVideo(),r!=null&&r.length||(r=[{container:this.eu.captureView||null,option:{}}]),r.forEach(function(i){return i.container&&n.playCaptureVideo(i.container,i.option)})}this.ou.captureVideoTrackChanged(this.originVideoStream.getVideoTracks()[0])}else this.originAudioStream=e,this.audioCaptureMuted||(this.stopPlayCaptureAudio(),this.playCaptureAudio()),this.ou.captureAudioTrackChanged(this.originAudioStream.getAudioTracks()[0])},Object.defineProperty(o.prototype,"isPublish",{get:function(){for(var e in this.gn.publisherList)if(this.gn.publisherList[e].localStream==this.stream)return!0;return!1},enumerable:!1,configurable:!0}),o.prototype.updateStreamAudioTrack=function(e,t,n){return e===void 0&&(e=function(){}),t===void 0&&(t=function(){}),n===void 0&&(n=0),Zi(this,void 0,void 0,function(){var r,i,s,c,u,l,a=this;return Xi(this,function(h){switch(h.label){case 0:if(this.an.info("zcs.uat call"),!this.originAudioStream||this.isPublish&&n==0||!this.stream)return[2];if(!(r=this.checkPreview(this.originAudioStream))||!r.audioTrack)return this.an.info("zcs.uat not preview"),[2];i=this.ph,s=r.audioTrack,c=function(m){if(r&&m){var S=r.mediaStreamConfig;m.audio={input:S.audioInput,ANS:S.ANS,AEC:S.AEC,AGC:S.AGC,bps:r.videoInfo.audioBitrate,channelCount:S.channelCount}}a.ph=r.audioTrack,a.ou.audioTrackChanged(r.audioTrack),e(m)},h.label=1;case 1:return h.trys.push([1,3,,4]),this.stream&&this.wh(this.stream,this.stream,this.originAudioStream,!0),[4,this._updateStreamTrack(i,s,c,t)];case 2:return u=h.sent(),this.an.info("zcs.uat success"),[2,u];case 3:return l=h.sent(),this.an.info("zcs.uat fail"),[2,l];case 4:return[2]}})})},o.prototype.updateStreamVideoTrack=function(e,t,n){return e===void 0&&(e=function(){}),t===void 0&&(t=function(){}),n===void 0&&(n=0),Zi(this,void 0,void 0,function(){var r,i,s,c,u,l=this;return Xi(this,function(a){switch(a.label){case 0:if(this.an.info("zcs.uvt call"),!this.originVideoStream||this.isPublish&&n==0||!this.stream)return this.an.info("zcs.uvt not capture"),[2];if(r=this.mh,!(i=this.checkPreview(this.originVideoStream))||!i.videoTrack)return this.an.info("zcs.uvt not preview"),[2];s=i.videoTrack,c=function(h){if(i&&h){var m=i.mediaStreamConfig,S=i.videoInfo,x=S.contentHint;h.video={input:m.videoInput,w:S.width,h:S.height,fps:S.frameRate,bps:1e3*S.bitRate,keyFrameInterval:S.keyFrameInterval,optimizationMode:x||void 0,facingMode:m.facingMode}}l.mh=i.videoTrack,l.ou.videoTrackChanged(i.videoTrack),e(h)},a.label=1;case 1:return a.trys.push([1,3,,4]),this.stream&&this.wh(this.stream,this.originVideoStream,this.stream,!0),[4,this._updateStreamTrack(r,s,c,t)];case 2:return a.sent(),this.dh=this.fh,this.an.info("zcs.uvt success"),[3,4];case 3:return u=a.sent(),this.an.info("zcs.uvt fail"),[2,u];case 4:return[2]}})})},o.prototype.updateStreamVideoAndAudio=function(e,t,n){return e===void 0&&(e=function(){}),t===void 0&&(t=function(){}),n===void 0&&(n=0),Zi(this,void 0,void 0,function(){var r,i,s,c,u,l;return Xi(this,function(a){switch(a.label){case 0:this.an.info("zcs.uva call"),r=!this.originVideoStream,i=!this.originAudioStream,s={},c=function(h){r=!0,h&&(s.video=h==null?void 0:h.video),i&&e(hn(hn({},h),s))},u=function(h){i=!0,h&&(s.audio=h==null?void 0:h.audio),r&&e(hn(hn({},h),s))},a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this.updateStreamVideoTrack(c,t,n)];case 2:return a.sent(),[4,this.updateStreamAudioTrack(u,t,n)];case 3:return a.sent(),[3,5];case 4:return l=a.sent(),t(l),this.an.info("zcs.uva error:".concat(JSON.stringify(l))),[3,5];case 5:return[2]}})})},o.prototype._updateStreamTrack=function(e,t,n,r){return Zi(this,void 0,void 0,function(){var i,s,c,u,l,a;return Xi(this,function(h){switch(h.label){case 0:return h.trys.push([0,6,,7]),this.an.info("zcs.ut call"),i=this.stream&&this.checkPreview(this.stream),this.stream&&i?(s={errorCode:0,extendedData:""},e?[3,2]:(this.an.info("zcs.ut add"),[4,this.gh.handleTrack("ADD",this.stream,t,n,r)])):(this.an.info("zcs.ut stream:".concat(!this.stream,", previewer:").concat(!i)),[2]);case 1:return s=h.sent(),[3,5];case 2:return e.id==t.id?[3,5]:(this.an.info("zcs.ut replace"),c=!1,this.fh&&this.dh&&this.fh!==this.dh&&(c=!0),[4,this.nh.replaceTrack(this.stream,t,void 0,{isReplaceNew:c,isCaptureStream:!0})]);case 3:return s=h.sent(),this.gn.trackUtils.stopTrack(e),u=this.gn.getPublisher(this.stream),(l=u==null?void 0:u.previewer.videoInfo.bitRate)?[4,u==null?void 0:u.setBitrate(l)]:[3,5];case 4:h.sent(),h.label=5;case 5:return n(s),[3,7];case 6:return a=h.sent(),r(a),[3,7];case 7:return[2]}})})},o.prototype.Sh=function(e,t){var n;if(!this.stream){var r=[];if(this.originAudioStream){var i=this.checkPreview(this.originAudioStream);i&&i.audioTrack&&(r.push(i.audioTrack),this.ph=i.audioTrack)}if(this.originVideoStream){var s=this.checkPreview(this.originVideoStream);s&&s.videoTrack&&(r.push(s.videoTrack),this.mh=s.videoTrack)}this.stream=new MediaStream(r)}var c=this.checkPreview(this.stream);if(!c){var u={},l=Uu(this.pn,this.an);if((0,R.TE)(e.bitrate)||(u.bitRate=e.bitrate),(0,R.TE)(e.minBitrate)||(u.minBitrate=e.minBitrate),(0,R.TE)(e.startBitrate)||(u.startBitrate=e.startBitrate),u.audioBitrate=(0,R.Cs)(e.audioBitrate)?1e3*e.audioBitrate:1e3*(l.audioBitrate||48),t==="camera"){var a=this.pn.settingConfig.getSetting("camera_audio_bitrate",!0),h=this.pn.settingConfig.getSetting("camera_video_bitrate",!0);(0,R.Cs)(u.audioBitrate)&&(0,R.Cs)(a)&&(u.audioBitrate=1e3*a),(0,R.Cs)(u.bitRate)&&(0,R.Cs)(h)&&(u.bitRate=h)}u.channelCount=(0,R.TE)(e.channelCount)?l.channelCount||1:e.channelCount,c=this.createZegoStreamPreview(this.stream,!1,void 0,u),this.stream=this.nh.getStreamByCanvas(this.stream)}this.stream&&this.wh(this.stream,this.originVideoStream,this.originAudioStream,!0),c&&((n=this.stream)===null||n===void 0?void 0:n.getAudioTracks().length)===0&&this.nh.setEmptyAudioTrack(this.stream,c),this.nh.initCopyMusic(this.stream),c.zegoCaptureStream=this,this.dh=this.fh,this.mn=c},o.prototype.createZegoStreamPreview=function(e,t,n,r){var i=new la(this.an,this.pn,this.gn,n,t);return this.gn.previewStreamList.push(i),i.localStream=e,i.mediaStreamConfig={},r&&(i.videoInfo=hn(hn({},i.videoInfo),r),i.mediaStreamConfig.bitRate=r.bitRate),i.initMediaTrack(e),n=="screen"&&this.nh.addShareScreenEnd(e),i},o.prototype.checkPreview=function(e){return this.gn.checkPreview(e)},o.prototype.wh=function(e,t,n,r){if(r===void 0&&(r=!1),e){var i=this.checkPreview(e);if(i){var s=t&&this.checkPreview(t),c=n&&this.checkPreview(n),u={},l={},a=!1;if(i.previewType=(s==null?void 0:s.previewType)||(c==null?void 0:c.previewType),s){var h=s.videoInfo,m=s.mediaStreamConfig;i.previewType=s.previewType,i.videoPreviewType=s.videoPreviewType,i.previewSuc=!0,u=hn({videoQuality:i.mediaStreamConfig.videoQuality,bitRate:i.mediaStreamConfig.bitRate},m),a=m.video;var S=hn({},h);if(xu(xu([],Vl,!0),["audioBitrate"],!1).forEach(function(gt){delete S[gt]}),r){["bitRate","startBitrate","minBitRate"].forEach(function(gt){delete S[gt]});var x=i.videoInfo.bitRate,q=i.hasUserSetBitrate;if(this.an.info("zcs.up ".concat(i.previewType," hasUserSetBitrate: ").concat(q,", bitrate: ")+x),s.mediaStreamConfig.videoQuality&&[1,2,3].includes(s.mediaStreamConfig.videoQuality)||!x||!q){var V=h.bitRate,_e=this.pn.settingConfig.getSetting("camera_video_bitrate",!0);(0,R.Cs)(V)&&(0,R.Cs)(_e)&&(this.an.info("zcs.up ".concat(i.previewType," cloud videoBitrate ").concat(_e)),V=_e),this.an.info("zcs.up ".concat(i.previewType," videoBitrate changed ").concat(x," to ").concat(V)),S.bitRate=V}this.isPublish&&delete S.keyFrameInterval}l=hn({},S)}if(c){h=c.videoInfo;var ke=(m=c.mediaStreamConfig).audio,Pe=m.AEC,Oe=m.AGC,Ge=m.ANS,Je=m.audioBitrate,tt=m.channelCount,ut=m.audioInput;i.audioPreviewType=c.audioPreviewType,i.previewSuc=!0,this.isPublish||(l.channelCount=h.channelCount);var vt=i.videoInfo.audioBitrate;r&&vt||(this.an.info("zcs.up ".concat(r," audioBitrate changed ").concat(vt," to ").concat(h.audioBitrate)),l.audioBitrate=h.audioBitrate),u=hn(hn({},u),{audio:ke,AEC:Pe,AGC:Oe,ANS:Ge,audioBitrate:Je,channelCount:tt,audioInput:ut})}u.video=a,i.mediaStreamConfig=u,i.videoInfo=hn(r?hn({},i.videoInfo):{},l)}}},o.prototype._getVideoBitrate=function(e){return(0,R.Cs)(this.eu.videoBitrate)?hn(hn({},e),{bitrate:this.eu.videoBitrate}):hn(hn({},e),this.eu.videoBitrate)},o.prototype._getAudioBitrate=function(e){return e.audioBitrate=this.eu.audioBitrate,e},o.prototype._createStream=function(e,t,n,r,i){return Zi(this,void 0,void 0,function(){var s,c,u,l,a,h,m,S,x,q,V;return Xi(this,function(_e){switch(_e.label){case 0:return _e.trys.push([0,2,,3]),s=n==So.video||n==So.videoAndAudio,c=n==So.audio||n==So.videoAndAudio,e=this._getVideoBitrate(e),e=this._getAudioBitrate(e),this.an.info("zcs.cs config:"+JSON.stringify(((q={})[t]=e,q))),[4,this.nh.createStream((V={},V[t]=e,V))];case 1:return u=_e.sent(),this.fh=t,l=this.checkPreview(u),a=(l==null?void 0:l.originVideoTrack)||u.getVideoTracks()[0],h=(l==null?void 0:l.originAudioTrack)||u.getAudioTracks()[0],c&&s?(m=new MediaStream([a]),S=new MediaStream([h]),this.createZegoStreamPreview(m,!0,t),this.createZegoStreamPreview(S,!0,t),this.wh(m,u,null),this.wh(S,null,u),this.rh.push(m),this.eh.push(S),this.yh(m,0),this.yh(S,1),!this.stream&&l?(this.stream=u,this.ph=h,this.mh=a,l.zegoCaptureStream=this,this.mn=l):this.updateStreamVideoAndAudio(r,i,0)):s?(this.yh(u,0),this.rh.push(u),this.stream?this.updateStreamVideoTrack(r,i,0):this.Sh(e,t)):c&&(S=new MediaStream([h]),this.createZegoStreamPreview(S,!0,t),this.wh(S,null,u),this.yh(S,1),this.eh.push(S),this.eh.push(u),this.stream?this.updateStreamAudioTrack(r,i,0):this.Sh(e,t)),this.isPublish||(this.autoPlay||this.sh)&&this.autoPlay&&this.playVideo(),this.bh(),r({errorCode:0,extendedData:""}),[3,3];case 2:return x=_e.sent(),i({errorCode:x.errorCode||x.code,extendedData:x.extendedData||x.msg}),[3,3];case 3:return[2]}})})},o.prototype.startCaptureMicrophone=function(e){var t=this;return e===void 0&&(e={}),new te.l3(function(n){return Zi(t,void 0,void 0,function(){var r,i,s,c,u,l,a,h,m,S,x=this;return Xi(this,function(q){switch(q.label){case 0:this.an.info("".concat(r="zcs.scm"," call ").concat(JSON.stringify(e))),i=this.Eh(k.e7.event),s=function(V){var _e,ke,Pe;if(x.mn&&!x.isPublish){var Oe=(_e=x.mn)===null||_e===void 0?void 0:_e.mediaStreamConfig,Ge=Oe.channelCount;Pe={audio:{input:Oe.audioInput,ANS:Oe.ANS,AEC:Oe.AEC,AGC:Oe.AGC,bps:((ke=x.mn)===null||ke===void 0?void 0:ke.videoInfo).audioBitrate,channelCount:Ge}}}(0,te.lA)(i,{preview_conf:Pe,stream_options:{audio:e},error:V.errorCode||0,message:V.extendedData||V.message}),n(V)},q.label=1;case 1:return q.trys.push([1,3,,4]),c={},!((h=this.eu.camera)===null||h===void 0)&&h.audio&&(0,R.w)((m=this.eu.camera)===null||m===void 0?void 0:m.audio)&&(c=hn({},mr((S=this.eu.camera)===null||S===void 0?void 0:S.audio))),u=this.kh("microphone",r),c=hn(hn(hn({},c),u),mr(e)),l=hn({audio:!0,video:!1,audioInput:c.input},c),[4,this._createStream(l,"camera",1,s,s)];case 2:return q.sent(),this.an.info("zcs.scm success"),[3,4];case 3:return a=q.sent(),s(a),this.an.info("zcs.scm fail"),[3,4];case 4:return[2]}})})})},o.prototype.startCaptureCamera=function(e){var t=this;return e===void 0&&(e={}),new te.l3(function(n){return Zi(t,void 0,void 0,function(){var r,i,s,c,u,l,a,h,m,S,x=this;return Xi(this,function(q){switch(q.label){case 0:this.an.info("".concat(r="zcs.scc"," call ").concat(JSON.stringify(e))),i=this.Eh(k.Oq.event),s=function(V){var _e,ke,Pe;if(x.mn&&!x.isPublish){var Oe=(_e=x.mn)===null||_e===void 0?void 0:_e.mediaStreamConfig,Ge=(ke=x.mn)===null||ke===void 0?void 0:ke.videoInfo,Je=Ge.contentHint;Pe={video:{input:Oe.videoInput,w:Ge.width,h:Ge.height,fps:Ge.frameRate,bps:1e3*Ge.bitRate,keyFrameInterval:Ge.keyFrameInterval,optimizationMode:Je||void 0,facingMode:Oe.facingMode}}}(0,te.lA)(i,{preview_conf:Pe,stream_options:{video:e},error:V.errorCode||0,message:V.extendedData||V.message}),n(V)},q.label=1;case 1:return q.trys.push([1,3,,4]),c={},!((h=this.eu.camera)===null||h===void 0)&&h.video&&(0,R.w)((m=this.eu.camera)===null||m===void 0?void 0:m.video)&&(c=hn({},mr((S=this.eu.camera)===null||S===void 0?void 0:S.video))),u=this.kh("camera",r),c=hn(hn(hn({},c),u),mr(e)),l=hn({audio:!1,video:!0,videoInput:c.input,videoQuality:c.quality,videoOptimizationMode:c.optimizationMode},c),[4,this._createStream(l,"camera",0,s,s)];case 2:return q.sent(),this.an.info("zcs.scc success"),[3,4];case 3:return a=q.sent(),s(a),this.an.info("zcs.scc fail"),[3,4];case 4:return[2]}})})})},o.prototype.startCaptureCameraAndMicrophone=function(e,t){var n=this;return e===void 0&&(e={}),t===void 0&&(t={}),new te.l3(function(r){return Zi(n,void 0,void 0,function(){var i,s,c,u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe=this;return Xi(this,function(Ge){switch(Ge.label){case 0:this.an.info("".concat(i="zcs.sccm"," call c:").concat(JSON.stringify(e),", m:").concat(JSON.stringify(t))),s=this.Eh(k.N7.event),c=function(Je){var tt,ut,vt;if(Oe.mn&&!Oe.isPublish){var gt=(tt=Oe.mn)===null||tt===void 0?void 0:tt.mediaStreamConfig,Pt=(ut=Oe.mn)===null||ut===void 0?void 0:ut.videoInfo,wt=Pt.contentHint;vt={video:{input:gt.videoInput,w:Pt.width,h:Pt.height,fps:Pt.frameRate,bps:1e3*Pt.bitRate,keyFrameInterval:Pt.keyFrameInterval,optimizationMode:wt||void 0,facingMode:gt.facingMode},audio:{input:gt.audioInput,ANS:gt.ANS,AEC:gt.AEC,AGC:gt.AGC,bps:Pt.audioBitrate,channelCount:gt.channelCount}}}(0,te.lA)(s,{preview_conf:vt,stream_options:{video:e,audio:t},error:Je.errorCode||0,message:Je.extendedData||Je.message}),r(Je)},Ge.label=1;case 1:return Ge.trys.push([1,3,,4]),u={},!((x=this.eu.camera)===null||x===void 0)&&x.video&&(0,R.w)((q=this.eu.camera)===null||q===void 0?void 0:q.video)&&(u=hn({},mr((V=this.eu.camera)===null||V===void 0?void 0:V.video))),l=this.kh("camera",i),u=hn(hn(hn({},u),l),mr(e)),a={},!((_e=this.eu.camera)===null||_e===void 0)&&_e.audio&&(0,R.w)((ke=this.eu.camera)===null||ke===void 0?void 0:ke.audio)&&(a=hn({},mr((Pe=this.eu.camera)===null||Pe===void 0?void 0:Pe.audio))),h=this.kh("microphone",i),a=hn(hn(hn({},a),h),mr(t)),m=hn(hn(hn({audio:!0,video:!0,videoInput:u==null?void 0:u.input,videoQuality:u==null?void 0:u.quality,videoOptimizationMode:u==null?void 0:u.optimizationMode},u),{audioInput:a==null?void 0:a.input}),a),[4,this._createStream(m,"camera",2,c,c)];case 2:return Ge.sent(),this.an.info("zcs.sccm success"),[3,4];case 3:return S=Ge.sent(),c(S),this.an.info("zcs.sccm fail"),[3,4];case 4:return[2]}})})})},o.prototype.autoCapture=function(){var e=this;return new te.l3(function(t,n){return Zi(e,void 0,void 0,function(){var r,i,s,c,u,l,a,h,m,S,x,q;return Xi(this,function(V){switch(V.label){case 0:this.an.info("zcs.ac call"),V.label=1;case 1:return V.trys.push([1,23,,24]),c=(i=this.eu).custom,u=i.screen,(s=i.camera)?(this.an.info("zcs.ac camera:".concat(JSON.stringify(s))),x=s.video,(S=s.audio)&&x?(l=(0,R.w)(x)?x:void 0,a=(0,R.w)(S)?S:void 0,[4,this.startCaptureCameraAndMicrophone(l,a)]):[3,3]):[3,8];case 2:return r=V.sent(),[3,7];case 3:return S?[4,this._h(S,this.startCaptureMicrophone)]:[3,5];case 4:return r=V.sent(),[3,7];case 5:return x?[4,this._h(x,this.startCaptureCamera)]:[3,7];case 6:r=V.sent(),V.label=7;case 7:return[3,22];case 8:return u?(this.an.info("zcs.ac screen:".concat(JSON.stringify(u))),x=u.video,(S=u.audio)?(h=x,m=S,(0,R.dd)(x)&&(h={}),(0,R.dd)(S)&&(m={}),[4,this.startCaptureScreenWithAudio(h,m)]):[3,10]):[3,13];case 9:return r=V.sent(),[3,12];case 10:return[4,this._h(x,this.startCaptureScreen)];case 11:r=V.sent(),V.label=12;case 12:return[3,22];case 13:return c?(this.an.info("zcs.ac custom:".concat(JSON.stringify(c))),x=c.video,(S=c.audio)&&x&&S.source===x.source?[4,this.startCaptureCustomVideoAndAudio(x,S)]:[3,15]):[3,20];case 14:return r=V.sent(),[3,19];case 15:return S?[4,this._h(S,this.startCaptureCustomAudio)]:[3,17];case 16:r=V.sent(),V.label=17;case 17:return x?[4,this._h(x,this.startCaptureCustomVideo)]:[3,19];case 18:r=V.sent(),V.label=19;case 19:return[3,22];case 20:return[4,this.startCaptureCameraAndMicrophone({},{})];case 21:r=V.sent(),V.label=22;case 22:return r||n({errorCode:Et.mrK.code,extendedData:Et.mrK.message}),(r==null?void 0:r.errorCode)!==0?n(r):t(r),[3,24];case 23:return q=V.sent(),n(q),[3,24];case 24:return[2]}})})})},o.prototype.startCaptureCustomAudio=function(e){var t=this;return new te.l3(function(n){return Zi(t,void 0,void 0,function(){var r,i,s,c,u,l,a,h=this;return Xi(this,function(m){switch(m.label){case 0:if(this.an.info("".concat(r="zcs.scca"," call ").concat(JSON.stringify(e))),i=this.Eh(k.eH.event),s=function(S){var x,q,V;h.mn&&!h.isPublish&&(V={audio:{bps:((x=h.mn)===null||x===void 0?void 0:x.videoInfo).audioBitrate,channelCount:(q=h.mn)===null||q===void 0?void 0:q.mediaStreamConfig.channelCount}}),(0,te.lA)(i,{preview_conf:V,stream_options:{audio:h.Oh(e)},error:S.errorCode||0,message:S.extendedData||S.message}),n(S)},(c=this.Ih(e)).errorCode)return s(c),[2];m.label=1;case 1:return m.trys.push([1,3,,4]),u=this.kh("customAudio",r),[4,this._createStream(hn(hn(hn(hn({},mr((a=this.eu.custom)===null||a===void 0?void 0:a.audio)),u),mr(e)),{audio:!0}),"custom",1,s,s)];case 2:return m.sent(),this.an.info("".concat(r," success")),[3,4];case 3:return l=m.sent(),s(l),this.an.info("".concat(r," fail")),[3,4];case 4:return[2]}})})})},o.prototype.startCaptureCustomVideo=function(e){var t=this;return new te.l3(function(n){return Zi(t,void 0,void 0,function(){var r,i,s,c,u,l,a,h,m=this;return Xi(this,function(S){switch(S.label){case 0:if(this.an.info("".concat(r="zcs.sccv"," call ").concat(JSON.stringify(e))),i=this.Eh(k.pT.event),s=function(x){var q,V;if(m.mn&&!m.isPublish){var _e=(q=m.mn)===null||q===void 0?void 0:q.videoInfo,ke=_e.contentHint;V={video:{bps:1e3*_e.bitRate,keyFrameInterval:_e.keyFrameInterval,optimizationMode:ke||void 0}}}(0,te.lA)(i,{preview_conf:V,stream_options:{video:m.Oh(e)},error:x.errorCode||0,message:x.extendedData||x.message}),n(x)},(c=this.Ih(e)).errorCode)return s(c),[2];S.label=1;case 1:return S.trys.push([1,3,,4]),u=this.kh("customVideo",r),l=Object.assign({},mr((h=this.eu.custom)===null||h===void 0?void 0:h.video),u,mr(e)),[4,this._createStream(hn({videoOptimizationMode:l.optimizationMode},l),"custom",0,s,s)];case 2:return S.sent(),this.an.info("".concat(r," success")),[3,4];case 3:return a=S.sent(),s(a),this.an.info("".concat(r," fail")),[3,4];case 4:return[2]}})})})},o.prototype.startCaptureCustomVideoAndAudio=function(e,t){var n=this;return new te.l3(function(r){return Zi(n,void 0,void 0,function(){var i,s,c,u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je=this;return Xi(this,function(tt){switch(tt.label){case 0:if(this.an.info("".concat(i="zcs.sccva"," call v:").concat(JSON.stringify(e)," a:").concat(JSON.stringify(t))),s=this.Eh(k.Z1.event),c=function(ut){var vt,gt,Pt;if(Je.mn&&!Je.isPublish){var wt=((vt=Je.mn)===null||vt===void 0?void 0:vt.mediaStreamConfig).channelCount,At=(gt=Je.mn)===null||gt===void 0?void 0:gt.videoInfo,Vt=At.contentHint;Pt={video:{bps:1e3*At.bitRate,keyFrameInterval:At.keyFrameInterval,optimizationMode:Vt||void 0},audio:{bps:At.audioBitrate,channelCount:wt}}}(0,te.lA)(s,{preview_conf:Pt,stream_options:{video:Je.Oh(e),audio:Je.Oh(t)},error:ut.errorCode||0,message:ut.extendedData||ut.message}),r(ut)},(u=this.Ih(e)).errorCode)return c(u),[2];if((l=this.Ih(t)).errorCode)return c(l),[2];tt.label=1;case 1:return tt.trys.push([1,7,,8]),a=this.kh("customAudio",i),h=this.kh("customVideo",i),e.source!=t.source?[3,3]:[4,this._createStream(hn(hn(hn(hn(hn(hn(hn({videoOptimizationMode:e.optimizationMode||h.optimizationMode||((q=(x=this.eu.custom)===null||x===void 0?void 0:x.video)===null||q===void 0?void 0:q.optimizationMode)},mr((V=this.eu.custom)===null||V===void 0?void 0:V.video)),mr((_e=this.eu.custom)===null||_e===void 0?void 0:_e.audio)),h),a),mr(e)),mr(t)),{audio:!0}),"custom",2,c,c)];case 2:return tt.sent(),[3,6];case 3:return m={video:!1,audio:!1},[4,this._createStream(hn(hn(hn(hn({videoOptimizationMode:e.optimizationMode||h.optimizationMode||((Pe=(ke=this.eu.custom)===null||ke===void 0?void 0:ke.video)===null||Pe===void 0?void 0:Pe.optimizationMode)},(Oe=this.eu.custom)===null||Oe===void 0?void 0:Oe.video),h),e),{video:!0}),"custom",0,function(ut){m.video=!0,m.audio&&c(ut)},c)];case 4:return tt.sent(),[4,this._createStream(hn(hn(hn(hn({},(Ge=this.eu.custom)===null||Ge===void 0?void 0:Ge.audio),a),t),{audio:!0}),"custom",1,function(ut){m.audio=!0,m.video&&c(ut)},c)];case 5:tt.sent(),tt.label=6;case 6:return this.an.info("zcs.sccva success"),[3,8];case 7:return S=tt.sent(),c(S),this.an.info("zcs.sccva fail"),[3,8];case 8:return[2]}})})})},o.prototype.startCaptureScreen=function(e){var t=this;return e===void 0&&(e={}),new te.l3(function(n,r){return Zi(t,void 0,void 0,function(){var i,s,c,u,l,a,h,m,S,x,q=this;return Xi(this,function(V){switch(V.label){case 0:this.an.info("".concat(i="zcs.scs"," call ").concat(JSON.stringify(e))),s=this.Eh(k.xp.event),c=function(_e){var ke,Pe;if(q.mn&&!q.isPublish){var Oe=(ke=q.mn)===null||ke===void 0?void 0:ke.videoInfo,Ge=Oe.contentHint;Pe={video:{w:Oe.width,h:Oe.height,fps:Oe.frameRate,bps:1e3*Oe.bitRate,keyFrameInterval:Oe.keyFrameInterval,optimizationMode:Ge||void 0}}}(0,te.lA)(s,{preview_conf:Pe,stream_options:{video:an(e||{},["captureElement"])},error:_e.errorCode||0,message:_e.extendedData||_e.message}),n(_e)},V.label=1;case 1:return V.trys.push([1,3,,4]),u={},!((m=this.eu.screen)===null||m===void 0)&&m.video&&(0,R.w)((S=this.eu.screen)===null||S===void 0?void 0:S.video)&&(u=hn({},mr((x=this.eu.screen)===null||x===void 0?void 0:x.video))),l=this.kh("screenVideo",i),u=hn(hn(hn({},u),l),mr(e)),a=hn(hn({videoOptimizationMode:u.optimizationMode,videoQuality:u.quality},u),{audio:!1}),[4,this._createStream(a,"screen",0,c,c)];case 2:return V.sent(),this.an.info("".concat(i," success")),[3,4];case 3:return h=V.sent(),c(h),this.an.info("".concat(i," fail")),[3,4];case 4:return[2]}})})})},o.prototype.startCaptureScreenWithAudio=function(e,t){var n=this;return e===void 0&&(e={}),t===void 0&&(t={}),new te.l3(function(r,i){return Zi(n,void 0,void 0,function(){var s,c,u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge=this;return Xi(this,function(Je){switch(Je.label){case 0:this.an.info("".concat(s="zcs.scs"," call v:").concat(JSON.stringify(e)," a:").concat(JSON.stringify(t))),c=this.Eh(k.tp.event),u=function(tt){var ut,vt,gt;if(Ge.mn&&!Ge.isPublish){var Pt=(ut=Ge.mn)===null||ut===void 0?void 0:ut.mediaStreamConfig,wt=(vt=Ge.mn)===null||vt===void 0?void 0:vt.videoInfo,At=wt.contentHint;gt={video:{w:wt.width,h:wt.height,fps:wt.frameRate,bps:1e3*wt.bitRate,keyFrameInterval:wt.keyFrameInterval,optimizationMode:At||void 0},audio:{ANS:Pt.ANS,AEC:Pt.AEC,AGC:Pt.AGC,bps:wt.audioBitrate,channelCount:Pt.channelCount}}}(0,te.lA)(c,{preview_conf:gt,stream_options:{video:an(e||{},["captureElement"]),audio:t},error:tt.errorCode||0,message:tt.extendedData||tt.message}),r(tt)},Je.label=1;case 1:return Je.trys.push([1,3,,4]),l={},!((q=this.eu.screen)===null||q===void 0)&&q.video&&(0,R.w)((V=this.eu.screen)===null||V===void 0?void 0:V.video)&&(l=hn({},mr((_e=this.eu.screen)===null||_e===void 0?void 0:_e.video))),a=this.kh("screenVideo",s),l=hn(hn(hn({},l),a),mr(e)),h={},!((ke=this.eu.screen)===null||ke===void 0)&&ke.audio&&(0,R.w)((Pe=this.eu.screen)===null||Pe===void 0?void 0:Pe.audio)&&(h=hn({},mr((Oe=this.eu.screen)===null||Oe===void 0?void 0:Oe.audio))),m=this.kh("screenAudio",s),h=hn(hn(hn({},h),m),mr(t)),S=hn(hn(hn({videoOptimizationMode:l.optimizationMode,videoQuality:l.quality},l),h),{audio:!0}),[4,this._createStream(S,"screen",2,u,u)];case 2:return Je.sent(),this.an.info("zcs.scs success"),[3,4];case 3:return x=Je.sent(),u(x),this.an.info("zcs.scs fail"),[3,4];case 4:return[2]}})})})},o.prototype.stopCaptureAudio=function(){var e=this;return new te.l3(function(t){var n,r,i=!0;if(e.originAudioStream){e.an.info("zcs.sca call stop capture");var s=e.originAudioStream.getAudioTracks()[0];!((n=e.stream)===null||n===void 0)&&n.getAudioTracks()[0]&&e.isPublish&&e.stream&&(e.an.info("zcs.sca stop audio"),i=((r=e.mn)===null||r===void 0?void 0:r.audioPreviewType)==="camera"?e.mn.enableMicrophoneOnly(!1):e.gh.enableMicrophone(e.stream,!0),e.mn&&(e.mn.syncAudioEnabled=!1)),e.an.info("zcs.sca stop result:"+i),i&&(s.stop(),e.originAudioStream=null,e.stopPlayCaptureAudio(),e.bh())}t(i)})},o.prototype.stopCaptureVideo=function(){var e;return Zi(this,void 0,void 0,function(){var t,n,r,i,s=this;return Xi(this,function(c){switch(c.label){case 0:if(t=!0,this.an.info("zcs.scv call stop capture"),!this.originVideoStream)return[3,7];n=this.originVideoStream.getVideoTracks()[0],r=(e=this.stream)===null||e===void 0?void 0:e.getVideoTracks()[0],c.label=1;case 1:return c.trys.push([1,6,,7]),r?this.mn?(this.an.info("zcs.scv stop stream video"),this.mn.videoPreviewType!="camera"?[3,3]:[4,this.gh.enableCameraCapturing(this.mn,!1)]):[3,5]:[3,5];case 2:return t=c.sent(),[3,5];case 3:return[4,this.mn.stopCaptureVideo()];case 4:c.sent(),t=!0,c.label=5;case 5:return this.an.info("zcs.scv stop result:"+t),t&&(this.gn.trackUtils.stopTrack(n),this.originVideoStream=null,this.stopPlayCaptureVideo(),this.rh.forEach(function(u){return s.nh.destroyStream(u)}),this.rh=[],this.bh()),[3,7];case 6:return i=c.sent(),this.an.error("zcs.scv "+JSON.stringify(i)),t=!1,[3,7];case 7:return[2,t]}})})},o.prototype.Rh=function(e,t){t===void 0&&(t=!1);var n=e&&this.checkPreview(e);if(!n)throw new Error("The stream does not exist, you must first capture the stream");return t&&n?new Ml(e,n,{clearLastFrame:this.pn.engineConfig.previewClearLastFrame}):(n==null?void 0:n.getViewer())||null},o.prototype.Th=function(){var e,t,n;this.hh=this.Rh(this.stream),(e=this.hh)===null||e===void 0||e.on("canPlayAudio",this.ou.canPlayAudio),(t=this.hh)===null||t===void 0||t.on("canPlayVideo",this.ou.canPlayVideo),(n=this.hh)===null||n===void 0||n.on("autoplayFailed",this.ou.autoplayFailed)},o.prototype.playAudio=function(e){var t;if(this.an.info("zcs.pa call"),!this.stream)return this.an.warn("zcs.pa You need to capture the audio stream first");this.hh||this.Th(),(t=this.hh)===null||t===void 0||t.playAudio(e,!0),this.audioMuted=!1},o.prototype.playCaptureAudio=function(e){var t,n,r;if(this.an.info("zcs.pca call"),!this.originAudioStream)return this.an.warn("zcs.pca You need to capture the audio stream first");this.uh||(this.uh=this.Rh(this.originAudioStream),(t=this.uh)===null||t===void 0||t.on("canPlayAudio",this.ou.canPlayCaptureAudio),(n=this.uh)===null||n===void 0||n.on("autoplayFailed",this.ou.autoplayCaptureFailed)),this.audioCaptureMuted=!1,(r=this.uh)===null||r===void 0||r.playAudio(e,!0)},o.prototype.playVideo=function(e,t){var n;if(this.an.info("zcs.pv call"),this.stream){if(this.hh&&this.hh.inited||(this.Th(),(n=this.hh)===null||n===void 0||n.setAudioMuted(this.audioMuted)),this.hh){var r=e||this.view;r&&(0,R.qi)(r)?(this.hh.playVideo(r,t),this.sh=!0):this.an.error("zcs.pv Execute `playVideo` failed, container not exist")}}else this.an.warn("zcs.pv You need to capture the video stream first")},o.prototype.playCaptureVideo=function(e,t){this.an.info("zcs.pcv call");var n=this.ah[0]||null;if(this.originVideoStream){if(!n||this.eu.multiplacePreview){if(!(n=this.Rh(this.originVideoStream,n&&this.eu.multiplacePreview)))return;n.on("canPlayVideo",this.ou.canPlayCaptureVideo),n.on("autoplayFailed",this.ou.autoplayCaptureFailed),this.ah.push(n)}var r=e||this.eu.captureView;r&&(0,R.qi)(r)?(n.playVideo(r,t),this.oh=!0):this.an.error("zcs.pcv Execute `playVideo` failed, container not exist")}else this.an.warn("zcs.pv You need to capture the video stream first")},o.prototype.updatePlayVideo=function(){this.hh&&this.stream?this.hh.setVideo(this.stream.getVideoTracks()[0]):this.autoPlay&&this.playVideo()},o.prototype.updatePlayAudio=function(){this.hh&&this.stream&&this.hh.setAudio(this.stream.getAudioTracks()[0])},o.prototype.takeStreamSnapshot=function(e){var t;return((t=this.hh)===null||t===void 0?void 0:t.takeStreamSnapshot(e))||""},o.prototype.resumeVideo=function(){var e;return(e=this.hh)===null||e===void 0?void 0:e.resume(!0,["video"])},o.prototype.resumeAudio=function(){var e;return(e=this.hh)===null||e===void 0?void 0:e.resume(!0,["audio"])},o.prototype.stopVideo=function(){var e;(e=this.hh)===null||e===void 0||e.stopVideo(),this.sh=!1},o.prototype.stopAudio=function(){this.hh&&(this.hh.stopAudio(),this.audioMuted=!0)},o.prototype.stopPlayCaptureVideo=function(){this.ah.forEach(function(e){e.stopVideo(),e.destroy()}),this.ah=[],this.oh=!1},o.prototype.stopPlayCaptureAudio=function(){this.uh&&(this.uh.destroy(),this.uh=null,this.audioCaptureMuted=!0)},o.prototype.setVolume=function(e){return!!this.hh&&this.hh.setVolume(e)},o.prototype.setAudioOutputDevice=function(e){if(this.hh)return this.hh.useAudioOut(e)},o.prototype._destroyCacheStream=function(e){var t=this;return e.filter(function(n){return!!n.active||(t.nh.destroyStream(n),!1)})},o.prototype.bh=function(){this.eh=this._destroyCacheStream(this.eh),this.rh=this._destroyCacheStream(this.rh)},o.prototype.kh=function(e,t){var n=this.stream&&this.checkPreview(this.stream);if(!this.stream||!n)return this.an.info("".concat(t," stream:").concat(!this.stream,", previewer:").concat(!n)),{};var r={},i=n.mediaStreamConfig,s=n.videoPreviewType,c=n.audioPreviewType;if(i){switch(e){case"camera":if(s==="camera"){var u=i.quality;r={input:i.videoInput,quality:i.videoQuality||u,facingMode:i.facingMode,width:i.width,height:i.height,frameRate:i.frameRate,optimizationMode:i.optimizationMode,keyFrameInterval:i.keyFrameInterval}}break;case"microphone":c==="camera"&&(r={ANS:i.ANS,AGC:i.AGC,AEC:i.AEC,channelCount:i.channelCount});break;case"customVideo":s==="custom"&&(r={optimizationMode:i.optimizationMode,keyFrameInterval:i.keyFrameInterval});break;case"customAudio":c==="custom"&&(r={channelCount:i.channelCount});break;case"screenVideo":if(s==="screen"){var l=n==null?void 0:n.mediaStreamConfig;u=l.quality,r={quality:l.videoQuality||u,width:l.width,height:l.height,frameRate:l.frameRate,sourceID:l.sourceID,optimizationMode:l.optimizationMode,keyFrameInterval:l.keyFrameInterval,captureElement:l.captureElement}}break;case"screenAudio":if(c==="screen"){var a=n==null?void 0:n.mediaStreamConfig;r={ANS:a.ANS,AGC:a.AGC,AEC:a.AEC}}}r=r&&mr(r)}return r},o.prototype.Ih=function(e){return e!=null&&e.source&&((0,R.Si)(e==null?void 0:e.source)||(0,R.dr)(e==null?void 0:e.source))?{errorCode:0,extendedData:""}:{errorCode:Et.LLz.code,extendedData:Et.LLz.message+" source not exist or error"}},o.prototype.Eh=function(e){var t=(0,te.fU)(this.cr,E.t0.H,"",e,k.nO.event);return t.setAttributes({local_stream_id:this.id}),t},o.prototype.Oh=function(e){return hn(hn({},e),{source:void 0,source_type:e!=null&&e.source?(0,R.Si)(e==null?void 0:e.source)?"Element":"MediaStream":void 0})},o.prototype.destroy=function(){var e,t=this;this.originAudioStream&&(this.originAudioStream=null),this.originVideoStream&&(this.originVideoStream=null),this.stream&&(this.nh.destroyStream(this.stream),this.stream=null),this.eh.forEach(function(n){return t.nh.destroyStream(n)}),this.rh.forEach(function(n){return t.nh.destroyStream(n)}),this.eh=[],this.rh=[],this.stopPlayCaptureVideo(),this.stopPlayCaptureAudio(),this.stopVideo(),this.stopAudio(),(e=this.hh)===null||e===void 0||e.destroy(),this.hh=null,this._a=new Ha},o}(),ha="zsc.rd.qd",Zh=function(){function o(e,t,n){this.an=e,this.pn=t,this.gn=n,this.Ch=2e3,this.lastRecordDeviceTime=0}return o.prototype.getDetectionStreams=function(){var e=[];return this.gn.previewStreamList.forEach(function(t){t.localStream&&e.push(t.localStream)}),e},o.prototype.Ah=function(e){this.an.warn(ha+" DeviceError: ".concat(Et.f5Z.code," ").concat(Et.f5Z.message)),this.pn.actionListener("_deviceError",Et.f5Z.code,e,"micro"),this.pn.actionListener("deviceError",Et.f5Z.code,e)},o.prototype.zh=function(e){if(this.an.info(ha+" get name of device id: ".concat(JSON.stringify(e))),!e.deviceID&&!this.Dh&&e.trackLabel=="")return"unknown";if(!e.deviceID||e.deviceID==="default")return e.trackLabel;for(var t in this.Dh){var n=this.Dh[t];if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s.deviceID===e.deviceID)return s.deviceName}}return e.trackLabel},o.prototype.Nh=function(e){this.an.warn(ha+" DeviceError: ".concat(Et.tlN.code," ").concat(Et.tlN.message)),this.pn.actionListener("_deviceError",Et.tlN.code,e,"camera"),this.pn.actionListener("deviceError",Et.tlN.code,e)},o.prototype.Ph=function(e){this.Dh=e},o.prototype.Mh=function(e){return{trackID:e.id,trackLabel:e.label,readyState:e.readyState,deviceID:e.getSettings().deviceId}},o.prototype.xh=function(e,t){return e.findIndex(function(n){return n.deviceName==t.deviceName&&n.preview==n.preview})!==-1},o.prototype.jh=function(e,t){if(e.audioTrack){var n=this.Mh(e.audioTrack),r=performance.now()-e.lastTrackEndTime.audio;if(n.readyState=="ended"&&r<this.Ch){this.an.warn(ha+" mic device may loose.");var i={deviceName:this.zh(n),preview:e};this.xh(t,i)||t.push(i)}}},o.prototype.qh=function(e,t){if(e.videoTrack){var n=this.Mh(e.videoTrack),r=performance.now()-e.lastTrackEndTime.video;if(n.readyState=="ended"&&r<this.Ch){this.an.warn(ha+" camera device may loose.");var i={deviceName:this.zh(n),preview:e};this.xh(t,i)||t.push(i)}}},o.prototype.Lh=function(e,t,n){var r=this.gn.getPreviewer(e);r&&(this.jh(r,t),this.qh(r,n))},o.prototype.isRecordQuickly=function(){return performance.now()-this.lastRecordDeviceTime<this.Ch},o.prototype.onDeviceNoChangeQuickly=function(e){var t=this;if(this.isRecordQuickly())this.an.info(ha+" device no change because record device quickly");else{this.an.info(ha+" device no change quickly"),this.Ph(e);var n=[],r=[];this.getDetectionStreams().forEach(function(i){t.Lh(i,n,r)}),n.forEach(function(i){t.Ah(i.deviceName),i.preview.updatePublisherStreamMicStatus(!1,2)}),r.forEach(function(i){t.Nh(i.deviceName),i.preview.updatePublisherStreamCameraStatus(!1,2)})}},o}(),To=function(){return To=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},To.apply(this,arguments)},pa=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},fa=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Xh=function(){function o(e,t,n){this.an=e,this.gn=t,this.pn=n}return Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),o.prototype.Bh=function(e,t,n,r,i){return pa(this,void 0,void 0,function(){var s,c,u,l,a,h,m,S,x,q,V,_e,ke=this;return fa(this,function(Pe){switch(Pe.label){case 0:return s=this.gn.checkPreview(t),c=e==="audio",s?s.zegoCaptureStream&&e==="video"&&s.previewType!=="camera"?(this.an.error("zsc.sd.0 stream type cannot set device"),r&&r({errorCode:Et.jut.code,extendedData:Et.jut.message}),[2]):e==="video"&&s.mediaStreamConfig.video==0?(this.an.error("zsc.sd.0 camera can not be changed when video is false"),r&&r({errorCode:Et.R54.code,extendedData:Et.R54.message}),[2]):c&&s.mediaStreamConfig.audio==0?(this.an.error("zsc.sd.0 microphone can not be changed when audio is false"),r&&r({errorCode:Et.O2H.code,extendedData:Et.O2H.message}),[2]):(n==="recapture"&&(s.mediaStreamConfig.facingMode?((i=i||{}).facingMode=(i==null?void 0:i.facingMode)||s.mediaStreamConfig.facingMode,n=""):n=(c?s.mediaStreamConfig.audioInput:s.mediaStreamConfig.videoInput)||""),n&&delete s.mediaStreamConfig.facingMode,u={},e==="video"?(i!=null&&i.facingMode?u.facingMode=i.facingMode:n&&(u.videoInput=n),l=s.videoTrack):(u.audio=!0,u.audioInput=n,l=s.audioTrack),a=(0,Vn.m0)(),h=(0,Vn.HR)()&&(0,Vn.$t)().indexOf("HuaweiBrowser")>-1,this.pn.engineConfig.stopTrackWhenSwitchDevice||i!=null&&i.stopTrack||(0,Vn.gm)()||(0,Vn.hL)()&&a&&(0,Vn.$t)().indexOf("Oriole 64-bit")>-1||h||(0,Vn.Wu)()?(this.an.info("zsc.sd.0 stop "),this.gn.trackUtils.stopTrack(l),a&&(0,Vn.gm)()?[4,new Promise(function(Oe){setTimeout(function(){Oe(void 0)},100)})]:[3,2]):[3,2]):(this.an.error("zsc.sd.0 preview no found"),r&&r({errorCode:Et.fzq.code,extendedData:Et.fzq.message}),[2]);case 1:Pe.sent(),Pe.label=2;case 2:return m=To(To({},s.mediaStreamConfig),u),c&&n==="default"&&(this.an.warn("zsc.sd.0 stop preview audio track"),s.audioTrack&&s.audioTrack.stop()),S=s.getMediaStreamConstraints(m).mediaStreamConstraints,x=function(Oe,Ge){Ge.getTracks().forEach(function(Je){if(Je.kind===e){var tt=e==="video",ut=tt?"videoTrack":"audioTrack",vt=s[ut];tt&&s.streamFromCanvas&&s.stopCanvasStreamTrack(),vt&&(Je.enabled=vt.enabled),tt&&s.lowStream&&s.lowStream.getTracks().forEach(function(Pt){ke.gn.trackUtils.stopTrack(Pt)});var gt=ke.gn.getPublishList(t);gt.length>0&&(!s.muteImage||Je.enabled||!tt)?gt.map(function(Pt){return Pt.publisher}).forEach(function(Pt){Pt.replacePublishedTrack(Je,!1,{isCamera:!0})}):s&&s.muteImage&&!Je.enabled&&tt?s[ut]=Je:s&&s.replacePreviewTrack(Je,!1,{isCamera:!0}),ke.gn.trackUtils.stopTrack(vt),s.updateZegoStreamCaptureTrack(Je)}}),s.restartSoundLevel()},c?S.video=!1:S.audio=!1,this.an.info("zsc.sd.0 mediaStreamConstraints "+JSON.stringify(S)),q=Et.R54,e==="audio"&&(q=Et.O2H),V=function(Oe){for(var Ge=0,Je=Oe.getTracks();Ge<Je.length;Ge++)if(Je[Ge].readyState=="ended")return!0;return!1},_e=function(Oe){ke.gn.trackUtils.stopTrack(e=="video"?s.videoTrack:s.audioTrack),ke.an.warn("zsc.sd.0 switch "+e+" device failed, stop last device and retry. "+Oe.toString()),navigator.mediaDevices.getUserMedia(S).then(function(Ge){Object.assign(s.mediaStreamConfig,u),x(0,Ge),ke.an.info("zsc.sd.0 swtich "+e+" device success"),r&&r({errorCode:0,extendedData:""})},function(Ge){ke.an.warn("zsc.sd.0 swtich "+e+" device failed and recover last device. "+Ge.toString());var Je=s.getMediaStreamConstraints(s.mediaStreamConfig).mediaStreamConstraints;c?Je.video=!1:Je.audio=!1,navigator.mediaDevices.getUserMedia(Je).then(function(tt){x(0,tt),ke.an.info("zsc.sd.0 recover last "+e+" device success"),r&&r({errorCode:q.code,extendedData:q.message+" "+JSON.stringify(Ge)})},function(tt){ke.an.error("zsc.sd.0 swtich "+e+" device and recover failed, please recreate stream. "+tt.toString()),r&&r({errorCode:q.code,extendedData:q.message+" "+JSON.stringify(tt)})})})},navigator.mediaDevices.getUserMedia(S).then(function(Oe){V(Oe)&&ke.an.error("zsc.sd.0 switch"+e+" device fail, has track ended."),Object.assign(s.mediaStreamConfig,u),x(0,Oe),ke.an.info("zsc.sd.0 switch "+e+" device success"),r&&r({errorCode:0,extendedData:""})},_e),[2]}})})},o.prototype.setPublishStreamVideoConstraints=function(e,t,n,r){var i,s,c,u,l,a,h,m,S,x,q,V,_e;return pa(this,void 0,void 0,function(){var ke,Pe,Oe,Ge,Je,tt,ut,vt,gt,Pt,wt,At,Vt,qt,Gt,Sn,Qt,Wt,zt,Mt,jt,Kt,$t,yt,Pn=this;return fa(this,function(pn){switch(pn.label){case 0:if(this.an.info((ke="zsc.spsc.0 video")+" constraints "+JSON.stringify(t)),!(Pe=this.gn.checkPreview(e)))return this.an.error(ke+" preview no found"),r&&r({errorCode:Et.fzq.code,extendedData:Et.fzq.message}),[2];if(!(Oe=Pe.videoTrack))return this.an.error(ke+" video track not found"),r&&r({errorCode:Et.fFX.code,extendedData:Et.fFX.message}),[2];if(Ge=Pe.videoPreviewType||Pe.previewType,t.video=Pe.mediaStreamConfig.video,t.videoQuality||(t.videoQuality=4,t.quality=4),t=mr(t),Je=Oe==null?void 0:Oe.getSettings(),tt=JSON.parse(JSON.stringify(Pe.mediaStreamConfig)),ut={},[1,2,3].includes(tt.videoQuality)&&(Ge==="screen"?((vt=this.gn.getScreenConstrains(tt))!=null&&vt.video&&(ut.frameRate=(i=vt.video)===null||i===void 0?void 0:i.frameRate),vt!=null&&vt.bitRate&&(ut.bitRate=vt==null?void 0:vt.bitRate)):(vt=Pe.getMediaStreamConstraints(tt,!0).mediaStreamConstraints)!=null&&vt.video&&(ut={width:(gt=vt==null?void 0:vt.video).width,height:gt.height,frameRate:gt.frameRate,bitRate:gt.bitRate})),Pt=Object.assign(Pe.mediaStreamConfig,ut,t),t.maxBitrate&&(Pt.bitRate=t.maxBitrate),At=!1,Ge=="screen"?(wt=this.gn.getScreenConstrains(Pt)).bitRate!==tt.bitRate&&(t.maxBitrate=wt.bitRate):(Vt=Pe.getMediaStreamConstraints(Pt,!0).mediaStreamConstraints,Pe.videoInfo.width===((s=(wt=Vt).video)===null||s===void 0?void 0:s.width)&&Pe.videoInfo.height===((c=wt.video)===null||c===void 0?void 0:c.height)||(this.an.info(ke+" resolution change "),At=!0),Je.width===((u=wt.video)===null||u===void 0?void 0:u.width)&&Je.height===((l=wt.video)===null||l===void 0?void 0:l.height)||(this.an.info(ke+" resolution diff with track settings"),At=!0)),this.an.info(ke+" applyConstraints "+JSON.stringify(wt.video)),qt={},Object.keys(wt.video).forEach(function(un){qt[un]=JSON.stringify(wt.video[un])}),n.setAttributes({video_conf:k.wd.video_conf(qt)}),Gt=this.gn.getPublishList(e),Sn=Pe.videoInfo.frameRate!==((a=wt.video)===null||a===void 0?void 0:a.frameRate)||Je.frameRate!==((h=wt.video)===null||h===void 0?void 0:h.frameRate),Qt=At||Sn,!(Ge&&["camera","screen"].includes(Ge)&&Qt))return[3,5];pn.label=1;case 1:return pn.trys.push([1,3,,4]),this.an.info(ke+" track change "),[4,Oe.applyConstraints(To(To({},wt.video),{deviceId:void 0}))];case 2:return pn.sent(),[3,4];case 3:return Wt=pn.sent(),r&&r({errorCode:Et.ton.code,extendedData:"".concat(Wt.name," ").concat(Wt.constraint?"constraint:"+Wt.constraint:"")}),[2];case 4:(zt=this.gn.getPreviewer(e))&&wt.video instanceof Object&&zt.setVideoInfo({width:(Mt=wt.video).width,height:Mt.height,frameRate:Mt.frameRate}),At&&this.pn.browser==="safari"&&((m=Pe.videoNodeQueue)===null||m===void 0||m.replaceNewSourceByTrack(Oe,void 0,{handleTrackType:we.changeResolution})),Gt.forEach(function(un){var ln,Mn,Hn=(Mn=(ln=un.localStream)===null||ln===void 0?void 0:ln.getVideoTracks()[0])===null||Mn===void 0?void 0:Mn.getSettings();(Je==null?void 0:Je.width)===(Hn==null?void 0:Hn.width)&&(Je==null?void 0:Je.height)===(Hn==null?void 0:Hn.height)||Pn.enVideoSpan(un.streamID,k.Sb.event,{w:k.Sb.w(Hn==null?void 0:Hn.width),h:k.Sb.h(Hn==null?void 0:Hn.height)}),(Je==null?void 0:Je.frameRate)!==(Hn==null?void 0:Hn.frameRate)&&Pn.enVideoSpan(un.streamID,k.Mc.event,{fps:k.Mc.fps(Hn==null?void 0:Hn.frameRate)})}),pn.label=5;case 5:if(jt=[1,2,3].includes(t.videoQuality)?((S=wt.video)===null||S===void 0?void 0:S.maxBitrate)||((x=wt.video)===null||x===void 0?void 0:x.bitRate):t.maxBitrate||((q=wt.video)===null||q===void 0?void 0:q.maxBitrate)||((V=wt.video)===null||V===void 0?void 0:V.bitRate),!((0,R.Cs)(jt)&&jt>0))return[3,9];if(Kt=Pe.videoInfo.bitRate!==jt,Pe.setVideoInfo({bitRate:jt}),!Kt)return[3,9];$t=0,pn.label=6;case 6:return $t<Gt.length?(yt=(_e=Gt[$t])===null||_e===void 0?void 0:_e.publisher)?[4,yt.setBitrate(jt)]:[3,8]:[3,9];case 7:pn.sent(),this.enVideoSpan(yt.streamId,k.Io.event,{bitrate:k.Io.bitrate(1e3*jt)}),pn.label=8;case 8:return $t++,[3,6];case 9:return this.an.info(ke+" set constraints success "),r&&r({errorCode:0,extendedData:""}),[2]}})})},o.prototype.setPublishStreamAudioConstraints=function(e,t,n,r){return pa(this,void 0,void 0,function(){var i,s,c,u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je,tt=this;return fa(this,function(ut){switch(ut.label){case 0:if(this.an.info((i="zsc.spsc.0 audio")+" constraints "+JSON.stringify(t)),!(s=this.gn.checkPreview(e)))return this.an.error(i+" preview no found"),r&&r({errorCode:Et.fzq.code,extendedData:Et.fzq.message}),[2];if(!(c=s.audioTrack)||s.hasEmptyAudioTrack)return this.an.error(i+" audio track not found"),r&&r({errorCode:Et.fFX.code,extendedData:Et.fFX.message}),[2];t.audio=s.mediaStreamConfig.audio,t=mr(t),u=s.audioPreviewType||s.previewType,l=JSON.parse(JSON.stringify(s.mediaStreamConfig)),a=Object.assign(s.mediaStreamConfig,t),u=="screen"?h=this.gn.getScreenConstrains(a):(m=s.getMediaStreamConstraints(a,!0).mediaStreamConstraints,h=m),this.an.info(i+" applyConstraints "+JSON.stringify(h)),S=!0,S=(c==null?void 0:c.enabled)||!1,n.setAttributes({audio_conf:k.$7.audio_conf(h.audio)}),this.gn.trackUtils.stopTrack(c),ut.label=1;case 1:return ut.trys.push([1,3,,5]),[4,navigator.mediaDevices.getUserMedia({video:!1,audio:h.audio})];case 2:return x=ut.sent(),Ge=x.getVideoTracks()[0],this.gn.trackUtils.stopTrack(Ge),(q=x.getAudioTracks()[0]).enabled=S,V=JSON.stringify(q.getSettings()),s.replacePreviewTrack(q),s.updateZegoStreamCaptureTrack(q),_e=q,s.insertableaudio&&s.localStream&&(_e=s.localStream.getAudioTracks()[0]),s.destNode||s.onAudioTrackChange(_e),this.an.info(i+" set constraints success "+V),r&&r({errorCode:0,extendedData:""}),[3,5];case 3:return ke=ut.sent(),Pe=s.getMediaStreamConstraints(l).mediaStreamConstraints,this.an.info(i+" oldMediaStreamConstraints "+JSON.stringify(Pe)),[4,navigator.mediaDevices.getUserMedia({video:!1,audio:Pe.audio}).catch(function(vt){tt.an.error(i+".1 setbackup fail "+vt.name)})];case 4:return(Oe=ut.sent())&&(Oe.getTracks().forEach(function(vt){rn(vt,tt.an,i+".1")}),Ge=e.getVideoTracks()[0],this.gn.trackUtils.stopTrack(Ge),Je=Oe.getAudioTracks()[0],s.replacePreviewTrack(Je),s.updateZegoStreamCaptureTrack(Je),s.destNode||s.onAudioTrackChange(Je)),this.an.info(i+".1 setbackup suc "),r&&r({errorCode:Et.ton.code,extendedData:"".concat(ke.name," ").concat(ke.constraint?"constraint:"+ke.constraint:"")}),[3,5];case 5:return[2]}})})},o.prototype.handleTrack=function(e,t,n,r,i){var s,c,u,l;return pa(this,void 0,void 0,function(){var a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je,tt,ut,vt,gt,Pt,wt,At,Vt,qt,Gt,Sn,Qt=this;return fa(this,function(Wt){switch(Wt.label){case 0:if((0,te.rA)(this.an,ie.N$A,". ms id: ".concat(t==null?void 0:t.id,", kind: ").concat(n==null?void 0:n.kind,", track id: ").concat(n==null?void 0:n.id)),a=e==="ADD",h={errorCode:0,extendedData:""},!(0,R.dr)(t))return this.an.error(ie.N$A+" stream wrong"),i({errorCode:Et.ZEp.code,extendedData:Et.ZEp.message}),[2];if(!(n instanceof MediaStreamTrack))return this.an.error(ie.N$A+" parameter 2 type error"),i({errorCode:Et.ZEp.code,extendedData:Et.ZEp.message}),[2];if(!(m=this.gn.checkPreview(t)))return this.an.error(ie.N$A+" stream no found"),i&&i({errorCode:Et.fzq.code,extendedData:Et.fzq.message}),[2];if(n.kind==="video"){if(!((s=m.videoEffect)===null||s===void 0)&&s.enabled)return this.an.error(ie.N$A+" need to disable video beauty effect first"),i&&i({errorCode:Et.lwJ.code,extendedData:"need to disable video beauty effect before add or remove track"}),[2];if(m.enableDualStream)return this.an.error(ie.N$A+" "+(S=" can not add/remove track while dual stream enabled.")),i&&i({errorCode:Et.lwJ.code,extendedData:S}),[2];if(m.isBackgroundBlur)return this.an.error(ie.N$A+" need to disable background process first"),i&&i({errorCode:Et.A1v.code,extendedData:"need to disable video background process before add or remove track"}),[2]}return m.streamFromCanvas&&n.kind==="video"?(this.an.error(ie.N$A+" browser not support"),i&&i({errorCode:Et.WgV.code,extendedData:Et.WgV.message}),[2]):(x=n.kind==="audio"&&this.pn.engineConfig.keepAudioTrack&&m.hasEmptyAudioTrack,q=t.getTracks().length>=2||t.getTracks().find(function(zt){return zt.kind==n.kind}),a&&q&&!x?(this.an.error(ie.N$A+" only stream which have one track and kind no exist can add track"),i&&i({errorCode:Et.ph7.code,extendedData:Et.ph7.message}),[2]):e=="REMOVE"&&(t.getTracks().length<=1||n.kind==="video"&&m.hasEmptyAudioTrack||!t.getTracks().find(function(zt){return zt.kind===n.kind}))?(this.an.error(ie.N$A+" can not remove track"),i({errorCode:Et.WgV.code,extendedData:Et.WgV.message}),[2]):!(V=this.gn.checkPublish(t))||V.publisher.supportTransceiver||V.publisher.stateNego===5&&V.publisher.isUpdateSDP!=1?(_e=function(zt){var Mt=Qt.gn.previewStreamList.find(function(jt){return jt.originVideoTrack===zt||jt.originAudioTrack===zt});if(Mt=Mt||Qt.gn.previewStreamList.find(function(jt){return jt.localStream.getTracks().find(function(Kt){return Kt==zt})}),Mt)return Qt.an.info(ie.N$A+" video info: ".concat(JSON.stringify(Mt.videoInfo))),Mt;Qt.an.warn(ie.N$A+" ".concat(zt.kind," track is not created by sdk"))},this.pn.engineConfig.keepAudioTrack&&n.kind==="audio"?(a?((Sn=(c=_e(n))===null||c===void 0?void 0:c.videoInfo)&&m.updateAudioInfo(Sn),this._replaceTrack(t,n,!1,!0),m.hasEmptyAudioTrack=!1):((ke=m.getEmptyAudioTrack())&&this._replaceTrack(t,ke,!1,!0),m.hasEmptyAudioTrack=!0),this.an.info(ie.N$A+" end"),r(h),[2]):(Pe=m.rtcViewer,Oe=m,Ge=n.kind=="video"?"videoTrack":"audioTrack",a&&(Je=_e(n))&&(n.kind==="video"?(Oe.updateMediaStreamConstraints(Je.mediaStreamConfig,"video"),m.mediaStreamConfig.video=!0):(Oe.updateMediaStreamConstraints(Je.mediaStreamConfig,"audio"),m.mediaStreamConfig.audio=!0)),V?(tt=V.publisher,(ut=V.publisher.peerConnection)?(tt.supportTransceiver?this.an.info(ie.N$A+" support transceiver"):tt.isUpdateSDP=!0,tt.sideMediaConfig.isSEIStart&&n.kind==="video"?(this.an.info(ie.N$A+" replace sei blank track."),vt=void 0,a?[4,tt.replacePublishedTrack(n,!1,{handleTrack:e})]:[3,2]):[3,5]):(this.an.error(ie.N$A+" pc has not created."),[2])):[3,15])):(this.an.error(ie.N$A+" publish state wrong. "+"".concat(V.publisher.stateNego)),i&&i({errorCode:Et.NJN.code,extendedData:Et.NJN.message}),[2]));case 1:return vt=Wt.sent(),tt.handleSEIVideoTrack("add"),[3,4];case 2:return tt.handleSEIVideoTrack("remove"),[4,tt.replacePublishedTrack(tt.sideMediaConfig.track,!1,{handleTrack:e})];case 3:vt=Wt.sent(),Wt.label=4;case 4:return(vt==null?void 0:vt.errorCode)===0||this.an.warn(ie.N$A+" enable sei but not found video sender. error: ".concat(JSON.stringify(vt))),[3,11];case 5:return n.kind!=="audio"?[3,6]:(tt.isUpdateSDP=!1,a?(Oe.replacePreviewTrack(n),gt=Oe.audioNodeQueue?(l=(u=Oe.audioNodeQueue)===null||u===void 0?void 0:u.destinationNode)===null||l===void 0?void 0:l.stream.getAudioTracks()[0]:n,(Pt=tt.audioSender)?Pt.replaceTrack(gt):ut.addTrack(gt,t),this.an.info(ie.N$A+" add audio track. ")):(t.removeTrack(n),Oe[Ge]=null,Pe&&Pe.setTrack(!1,null),(Pt=tt.audioSender)&&Pt.replaceTrack(null),this.an.info(ie.N$A+" remove audio track. ")),this.an.info(ie.N$A+" end"),r(h),[2]);case 6:return Pt=tt.videoSender,wt=n,Oe.zegoCaptureStream&&(At=Oe.getStreamThroughCanvas(new MediaStream([n])),wt=At.getVideoTracks()[0]),a?Pt?[4,Pt.replaceTrack(n)]:[3,8]:[3,10];case 7:return Wt.sent(),this.an.info(ie.N$A+" sender replace track "+wt.kind),[3,9];case 8:ut.addTrack(wt,t),this.an.info(ie.N$A+" pc add track "+wt.kind),Wt.label=9;case 9:return[3,11];case 10:if(!Pt)return this.an.error(ie.N$A+" sender no found"),i&&i({errorCode:Et.fFX.code,extendedData:Et.fFX.message}),[2];try{Pt.replaceTrack(null),this.an.info(ie.N$A+" sender replace null.")}catch(zt){this.an.error(ie.N$A+" "+zt),i&&i({errorCode:Et.aq0.code,extendedData:Et.aq0.message+" "+zt})}Wt.label=11;case 11:return Vt=Oe.updateVideoInfo(Sn=a?Je==null?void 0:Je.videoInfo:{}),qt=function(){e=="ADD"?(t.addTrack(n),Oe[Ge]=n,Pe&&Pe.setTrack(n.kind=="video",n,Qt.pn.browser==="safari"),n.kind=="video"&&n.enabled==1?tt.sendStreamStatus(0,tt.mic_status,!0):n.enabled==1&&tt.sendStreamStatus(tt.camera_status,0,!0),Qt.an.info(ie.N$A+" add track completely")):(n.kind=="video"?tt.sendStreamStatus(2,tt.mic_status,!0):tt.sendStreamStatus(tt.camera_status,2,!0),t.removeTrack(n),Oe[Ge]=null,Pe&&Pe.setTrack(n.kind=="video",null),Qt.an.info(ie.N$A+" remove track completely")),m.mediaStreamConfig.video=e=="ADD"},Gt=function(){return pa(Qt,void 0,void 0,function(){var zt,Mt,jt,Kt=this;return fa(this,function($t){switch($t.label){case 0:zt={},$t.label=1;case 1:return $t.trys.push([1,3,,4]),[4,ut.createOffer(zt)];case 2:return Mt=$t.sent(),tt.onCreateOfferSuccess(Mt,!0,To(To({},Vt),{bitRate:a?Vt.bitRate:50}),function(yt){return pa(Kt,void 0,void 0,function(){return fa(this,function(Pn){return yt!==0?i&&i({errorCode:Et.Q3v.code,extendedData:Et.Q3v.message}):(qt(),r(h),this.an.info(ie.N$A+" end")),[2]})})}),[3,4];case 3:return jt=$t.sent(),this.an.error(ie.N$A+" "+jt),i&&i({errorCode:Et.SmZ.code,extendedData:Et.SmZ.message+" "+jt}),[3,4];case 4:return[2]}})})},tt.isUpdateSDP?(this.an.info(ie.N$A+" need to update sdp"),[4,Gt()]):[3,13];case 12:return Wt.sent(),[3,14];case 13:this.an.info(ie.N$A+" only update track"),qt(),a&&n.kind==="video"&&Vt.bitRate&&tt.setBitrate(Vt.bitRate),r(h),Wt.label=14;case 14:return[3,16];case 15:a?((Sn=Je==null?void 0:Je.videoInfo)&&(n.kind==="video"?(Oe.updateVideoInfo(Sn),m.mediaStreamConfig.video=!0):Oe.updateAudioInfo(Sn)),t.addTrack(n),Oe[Ge]=n,Pe&&Pe.setTrack(n.kind=="video",n)):(t.removeTrack(n),Oe[Ge]=null,n.kind==="video"&&(m.mediaStreamConfig.video=!1),Pe&&Pe.setTrack(n.kind=="video",null)),this.an.info(ie.N$A+" end"),r(h),Wt.label=16;case 16:return[2]}})})},o.prototype.enVideoSpan=function(e,t,n){var r=this.cr.createSpan(E.t0.H,{key:k.Og.event,par:e},{key:""},t);r.setAttributes(n),r.end()},o.prototype._replaceTrack=function(e,t,n,r,i,s){r===void 0&&(r=!1),i===void 0&&(i=!1),s===void 0&&(s=!1);var c=this.gn.checkPreview(e),u=this.gn.getPublishList(e,!1);if(!c)return this.an.error("zc.rt.0 preview no found"),{errorCode:Et.fzq.code,extendedData:Et.fzq.message};if(c.streamFromCanvas&&t.kind==="video"&&!s)return this.an.error("zc.rt.0 browser not support"),{errorCode:Et.WgV.code,extendedData:Et.WgV.message};var l=e.getTracks().find(function(tt){return tt.kind===t.kind}),a=t.kind==="audio",h={errorCode:Et.fFX.code,extendedData:Et.fFX.message};if(!r&&!l)return this.an.error("zc.rt.0 track no found"),h;if(!r&&a&&c.hasEmptyAudioTrack&&(this.an.warn("zc.rt.0 replace empty audio track"),!this.pn.engineConfig.allowReplaceEmptyTrack))return h;if(r&&a&&!c.mediaStreamConfig.audio){var m=c.mediaStreamConfig;c.mediaStreamConfig.audio=!0;var S=t.getSettings(),x=S||{},q=x.deviceId,V=x.echoCancellation,_e=x.noiseSuppression,ke=x.autoGainControl,Pe=x.channelCount;this.an.info("zc.rt.0 add audio: "+JSON.stringify(S)),q&&(m.audioInput=q),Pe&&(m.channelCount=Pe),V&&(m.AEC=V),_e&&(m.ANS=_e),ke&&(m.AGC=ke)}var Oe=this.gn.soundLevelDelegate&&a,Ge=i?{handleTrackType:we.replaceNew}:{};if(u.length){var Je=null;return Oe&&c.stopSoundLevel(),u.forEach(function(tt){var ut;Je=(ut=tt.publisher)===null||ut===void 0?void 0:ut.replacePublishedTrack(t,!1,To({isTrackProcessedFromOriginalStream:n},Ge))}),Oe&&c.startSoundLevel(),Je}return Oe&&c.stopSoundLevel(),c.replacePreviewTrack(t,!1,To({isTrackProcessedFromOriginalStream:n},Ge)),Oe&&c.startSoundLevel(),{errorCode:0,extendedData:""}},o.prototype.enableCamera=function(e,t,n){var r=this.gn.checkPreview(e);return r?(r.enableCamera(t,this.gn,n),!0):(this.an.error("zsc.ec.0 "+te.h2),!1)},o.prototype.enableMicrophone=function(e,t){var n=this.gn.checkPreview(e);return n?n.enableMicrophone(t):(this.an.error("zsc.em.0 "+te.h2),!1)},o.prototype.enableMicrophoneOnly=function(e){(0,te.rA)(this.an,ie.LBe);for(var t=0;t<this.gn.previewStreamList.length;t++)if(!this.gn.previewStreamList[t].enableMicrophoneOnly(e))return this.an.error("".concat(ie.LBe,".0 previewer ").concat(t," change mic mute state failed")),!1;return this.gn.isMicEnabled=e,!0},o.prototype.getBlackTrack=function(e,t){(e<120||t<90)&&(e=128,t=90);var n=(0,te.FP)(e,t),r=n.getContext("2d");return r&&(r.fillStyle="black"),r==null||r.fillRect(0,0,e,t),n.captureStream().getVideoTracks()[0]},o.prototype.enableCameraCapturing=function(e,t){var n;return pa(this,void 0,void 0,function(){var r,i,s,c,u,l,a,h,m,S,x=this;return fa(this,function(q){switch(q.label){case 0:return e.localStream?(r=this.gn.getPublishList(e.localStream).map(function(V){return V.publisher}),t?((n=e.videoTrack)===null||n===void 0?void 0:n.readyState)!=="live"?[3,1]:(this.an.warn("zp.ecc camera is already capturing"),[3,12]):[3,13]):[2,!1];case 1:i=e.getMediaStreamConstraints(To(To({},e.mediaStreamConfig),{audio:!1})).mediaStreamConstraints,q.label=2;case 2:return q.trys.push([2,11,,12]),[4,navigator.mediaDevices.getUserMedia(i)];case 3:return(s=q.sent()).getTracks().forEach(function(V){return rn(V,x.an,"zsc.ecc")}),(c=s.getVideoTracks()[0]).enabled=e.isVideoEnabled,c.enabled===!1&&this.an.warn("zp.ecc video is not enabled"),!e.muteImage||e.isVideoEnabled?[3,4]:(e.videoTrack=c,c.enabled=!e.isVideoEnabled,[3,10]);case 4:if(!r.length)return[3,9];u=0,q.label=5;case 5:return u<r.length?((l=r[u]).publishOption.videoCodec==="H265"&&l.getVideoSenders().forEach(function(V){var _e;(_e=V.track)===null||_e===void 0||_e.stop()}),[4,l.replacePublishedTrack(c)]):[3,8];case 6:if(((a=q.sent())==null?void 0:a.errorCode)!==0)throw a;q.label=7;case 7:return u++,[3,5];case 8:return[3,10];case 9:e.replacePreviewTrack(c),q.label=10;case 10:return e.hasStopCaptureVideo=!1,e.updateZegoStreamCaptureTrack(c),[3,12];case 11:return h=q.sent(),this.an.error("zsc.ecc resume camera capturing failed. "+JSON.stringify(h)),[2,!1];case 12:return[3,15];case 13:return r.length&&(m=null,r.forEach(function(V){var _e;if(V.publishOption.videoCodec==="H265"){if(!m){var ke=(_e=e.videoTrack)===null||_e===void 0?void 0:_e.getSettings();m=x.getBlackTrack(ke==null?void 0:ke.width,ke==null?void 0:ke.height)}m&&V.getVideoSenders().forEach(function(Pe){Pe.replaceTrack(m)})}})),[4,e.stopCaptureVideo()];case 14:q.sent(),r.length&&(S=e.muteImage&&!e.isVideoEnabled?0:Au(e.videoTrack),r.forEach(function(V){V.sendStreamStatus(S,V.mic_status)})),q.label=15;case 15:return[2,!0]}})})},o.prototype.activateSEIInsert=function(e,t,n){n===void 0&&(n=0);var r=this.gn.checkPreview(e);return r?t!==0&&t!==1?(this.an.error(ie.gPJ+" value of action should be 0 or 1"),!1):(r.activateSEIConfig={action:t,infoType:n},this.gn.getPublishList(e).map(function(i){return i.publisher}).forEach(function(i){i.activateSEIInsert(t,n)}),!0):(this.an.error(ie.gPJ+" stream is not created"),!1)},o}(),Ei=function(){return Ei=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},Ei.apply(this,arguments)},fo=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},mo=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Fl=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))},Ja=k.Og,Bu=k.Og.event,Vd=k.Og.error,ql=k.ch,Fd=k.Jv,ma=k.eU.error,ci=ma.wn,ao=ma.En,$h=ma.Sn,qd=me();if(navigator.mediaDevices&&"setCaptureHandleConfig"in navigator.mediaDevices)try{navigator.mediaDevices.setCaptureHandleConfig({handle:qd,exposeOrigin:!0,permittedOrigins:["*"]})}catch{}function Uu(o,e,t){var n={width:640,height:360},r={width:640,height:480},i={width:960,height:540},s=Ei(Ei({video:!0,videoQuality:4,frameRate:15,bitRate:500},n),{audioBitrate:48,channelCount:1});switch(o.scenario){case E.UP.UNKNOWN:s={};break;case E.UP.StandardVideoCall:break;case E.UP.HighVideoCall:s.frameRate=25,s.bitRate=1500,s=Ei(Ei({},s),i);break;case E.UP.StandardChatroom:s.video=!1,s.audioBitrate=24;break;case E.UP.HighQualityChatroom:s.video=!1;break;case E.UP.Karaoke:s.video=!1,s.audioBitrate=128,s.channelCount=2;break;case E.UP.Broadcast:s.frameRate=20,s.bitRate=1200,(s=Ei(Ei({},s),i)).audioBitrate=64,s.channelCount=2;break;default:o.isFlutter?(s.bitRate=600,s=Ei(Ei({},s),n)):(s.bitRate=800,s=Ei(Ei({},s),r))}e.info("".concat(ie.Szn," scenario ").concat(o.scenario," ").concat(JSON.stringify(s)));var c=o.settingConfig.getCloudSettingScenario(o.scenario,!1,!0);return Object.assign(s,c||{},t||{})}var gs,va,lr,Hd=function(){function o(e,t,n,r,i,s){var c=this;this.an=e,this.dataReport=t,this.pn=n,this.gn=r,this.rtm=i,this.zegoWebRtc=s,this.Uh=new Zh(this.an,this.pn,this.gn),this.Gh=[],this.eventHandler={visibilitychange:function(){var u=!te.VJ.hidden;c.pn.engineConfig.autoRecaptureOnShow&&u&&(c.an.info("".concat(ie.HHW," call ").concat(u)),c.Gh.forEach(function(l){var a,h=(0,Qi.L)(l,c.an);(a=c.zegoWebRtc.rtcModules.publishModule.gh)===null||a===void 0||a.Bh("video",h,"recapture",function(){})}))}},this.Jh=0,this.Fh=0,this.Hh=0,this.Vh=(0,te.sg)(function(u){var l=c.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.tI.event);l.setAttributes({old_cap_volume:c.Fh,cap_volume:u,change_duration:c.Hh}),l.end(),c.Jh=0},3e3),this.Qh=void 0,this.gh=new Xh(e,r,n),this.recordDevices(),this.gn.checkDeviceChange=function(){c.Yh(500)},this.handleVisibilityChange()}return Object.defineProperty(o.prototype,"publishStreamHandler",{get:function(){return this.gh},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),o.prototype.handleVisibilityChange=function(){var e=(0,Vn.$t)();e.indexOf("OpenHarmony")>-1&&e.indexOf("HuaweiBrowser")>-1&&te.VJ.addEventListener("visibilitychange",this.eventHandler.visibilitychange)},o.prototype.createStream=function(e,t){var n=this;t===void 0&&(t=!1),this.an.info(ie.Szn+" call. "+t);var r=void 0,i=void 0,s=void 0;if(e){var c=e.camera,u=e.screen,l=e.custom;c&&(r=Ei({},c)),u&&(i=(0,R.dd)(u)?u:Ei({},u)),l&&(s=Ei({},l))}var a=0;if(r&&(a++,r.audioBitRate&&(r.audioBitrate=r.audioBitRate,delete r.audioBitRate),r.bitrate&&(r.bitRate=r.bitrate,delete r.bitrate),r=aa(r)),i&&(a++,(0,R.w)(i)&&i.bitrate&&(i.bitRate=i.bitrate),i=aa(i)),s&&(a++,s.bitrate&&(s.bitRate=s.bitrate)),s=s&&mr(s),r=r&&mr(r),i=i&&mr(i),a>1){var h="cannot set more than one type of source";throw this.an.error(ie.Szn+" ".concat(h,". ").concat(JSON.stringify(e))),{code:Et.ZEp.code,msg:h}}return new te.l3(function(m,S){var x,q=n.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.eU.event),V={is_zego_stream:t?0:1};e!=null&&e.camera&&(V.scenario=n.pn.scenario),q.setAttributes(V);var _e=function(Ge){var Je=n.gn.checkPreview(Ge),tt=n.getStreamByCanvas(Ge);Je&&n.setEmptyAudioTrack(tt,Je),n.initCopyMusic(Ge),q.setAttributes({media_stream_id:k.eU.media_stream_id(Ge==null?void 0:Ge.id)}),q.end(),!n.pn.deviceInfos&&n.recordDevices(),(r||r==null)&&n.Gh.push(tt),m(tt),n.gn.activeSoundLevel()},ke=function(Ge,Je){Je===void 0&&(Je=""),n.cr.setError(q,Ge,Je),S({code:Ge.code,msg:Ge.message+Je})};if(!(!((x=navigator==null?void 0:navigator.mediaDevices)===null||x===void 0)&&x.getUserMedia)&&window.location.protocol!=="https:"&&window.location.protocol!=="file:"&&window.location.hostname.indexOf("127.0.0.1")==-1&&window.location.hostname.indexOf("localhost")==-1){var Pe=" https or localhost required ";return n.an.error(ie.Szn+Pe),void ke({code:ma.yn.code,message:ma.yn.message+Pe})}var Oe=function(Ge){(0,R.C9)(Ge)?ke(Ge[0],Ge[1]):ke(Ge)};s?n.Uc(s,q).then(_e).catch(Oe):i?n.Kh(i,q,t).then(_e).catch(Oe):(r||r==null)&&n.Vc(r||{},q,t).then(_e).catch(Oe)})},o.prototype.Vc=function(e,t,n){return fo(this,void 0,void 0,function(){var r,i,s=this;return mo(this,function(c){if(!(0,R.TE)(e.videoQuality)&&!(0,te.zQ)(e.videoQuality))throw this.an.error(ie.Szn+(r=" videoQuality must be integer number")),[ci,r];if(!(0,R.TE)(e.keyFrameInterval)&&!(0,te.zQ)(e.keyFrameInterval))throw this.an.error(ie.Szn+(r=" keyFrameInterval must be integer number")),[ci,r];if(!(0,R.TE)(e.videoOptimizationMode)&&!["default","motion","detail"].includes(e.videoOptimizationMode))throw this.an.error(ie.Szn+(r=" video optimizationMode must be 'default', 'motion', 'detail'")),[ci,r];if(!(0,R.TE)(e.videoInput)&&!(0,R.uy)(e.videoInput)&&!(0,R.QP)(e.videoInput))throw this.an.error(ie.Szn+(r=" video input must be string'")),[ci,r];if(!(0,R.TE)(e.audioInput)&&!(0,R.uy)(e.audioInput)&&!(0,R.QP)(e.audioInput))throw this.an.error(ie.Szn+(r=" audio input must be string'")),[ci,r];if(!(0,R.TE)(e.facingMode)&&!(0,R.QP)(e.facingMode))throw this.an.error(ie.Szn+(r=" facingMode must be string'")),[ci,r];if(e.audioBitrate){if(!(0,te.zQ)(e.audioBitrate))throw this.an.error(ie.Szn+(r=" audioBitrate must be integer number")),[ci,r];if(e.audioBitrate<6||e.audioBitrate>510)throw r=" audio bitrate cannot exceed the range [6,510]. current value: ".concat(e.audioBitrate,"."),this.an.error(ie.Szn+r),[ci,r];this.pn.audioBitRate=1e3*e.audioBitrate}if(e.bitRate){if(!(0,R.Cs)(e.bitRate))throw this.an.error(ie.Szn+(r=" bitrate must be integer number")),[ci,r];if(e.bitRate>10240)throw this.an.error(ie.Szn+(r=" bitrate cannot more than 10 Mbps")),[ci,r]}if(!(0,R.TE)(e.minBitrate)&&!(0,R.Cs)(e.minBitrate))throw this.an.error(ie.Szn+(r=" minBitrate must be integer number")),[ci,r];if(!(0,R.TE)(e.startBitrate)&&!["default","target"].includes(e.startBitrate))throw this.an.error(ie.Szn+(r=" startBitrate must be integer 'default' or 'target'")),[ci,r];if(e.channelCount!==void 0&&!(0,te.zQ)(e.channelCount))throw this.an.error(ie.Szn+(r=" channelCount must be integer number")),[ci,r];if(!(0,R.TE)(e.AEC)&&!(0,R.dd)(e.AEC))throw this.an.error(ie.Szn+(r=" AEC must be boolean'")),[ci,r];if(!(0,R.TE)(e.ANS)&&!(0,R.dd)(e.ANS))throw this.an.error(ie.Szn+(r=" ANS must be boolean'")),[ci,r];if(!(0,R.TE)(e.AGC)&&!(0,R.dd)(e.AGC))throw this.an.error(ie.Szn+(r=" AGC must be boolean'")),[ci,r];var u,l;return n&&e.videoQuality===4&&(!md(["frameRate","width","height"],u=e,l=function(a,h){throw[a,h]})||fd(u.bitRate,l)),i={},this.an.info(ie.Szn+" camera "+JSON.stringify(e)),i=e,t.setAttributes({stream_type:k.eU.stream_type("camera"),camera:k.eU.camera(e)}),(0,R.dd)(i.video)||(i.video=!0),(0,R.dd)(i.audio)||(i.audio=!0),[2,new te.l3(function(a,h){s.Zh(i,"camera",a,h,t)})]})})},o.prototype.Kh=function(e,t,n){return fo(this,void 0,void 0,function(){var r,i,s,c=this;return mo(this,function(u){return function(l,a,h){var m=(0,R.w)(l),S=k.eU.error.wn;if(m&&!(0,R.TE)(l.videoQuality)&&!(0,te.zQ)(l.videoQuality))return h(S," videoQuality must be integer number"),!1;if(m&&!(0,R.TE)(l.sourceID)&&!(0,R.QP)(l.sourceID))return h(S," sourceID must be string"),!1;if(m&&!(0,R.TE)(l.videoOptimizationMode)&&!["default","motion","detail"].includes(l.videoOptimizationMode))return h(S," video optimizationMode must be 'default', 'motion', 'detail'"),!1;if(m&&!(0,R.TE)(l.keyFrameInterval)&&!(0,te.zQ)(l.keyFrameInterval))return h(S," keyFrameInterval must be integer number"),!1;if(m&&a&&l.videoQuality===4&&(!fd(l.bitRate,h)||!md(["frameRate"],l,h)))return!1}(e,n,function(l,a){throw[l,a]}),r=this.pn.browser,i=this.gn.getScreenConstrains(e),t.setAttributes({stream_type:k.eU.stream_type("screen"),screen:k.eU.screen(i)}),s=e&&e.captureElement,[2,new te.l3(function(l,a){var h=function(S){a([S])},m=function(S){c.gn.createScreenPreviewer(S,i,e)&&l(S),c.addShareScreenEnd(S)};(0,Vn.gm)()||(0,R.w)(e)&&e.type=="firefox"?c.startScreenShotFirFox("screen",i,function(S,x,q){S?x&&m(x):q&&h(q)}):!s&&(0,Vn.H8)()&&Fs.screenShotReady||(0,R.w)(e)&&e.type=="shot"?c.startScreenShotChrome(function(S,x,q){S?(c.an.info(ie.Szn+" using extension"),x&&m(x)):(q&&c.an.error(ie.Szn+" extension "+q),q==="SS_DIALOG_CANCEL"||(0,R.w)(e)&&e.type=="shot"?q&&h(ma.Sn):c.startScreenSharing(i,function(V,_e,ke){V?_e&&m(_e):(c.an.error(ie.Szn+" "+ke),ke&&h(ke))}))}):r=="Electron"||(0,R.w)(e)&&e.type=="Electron"?c.startScreenShotElectron(i,function(S,x,q){S?x&&m(x):q&&h(q)}):c.startScreenSharing(i,function(S,x,q){S?x&&m(x):q&&h(q)})})]})})},o.prototype.Uc=function(e,t){return fo(this,void 0,void 0,function(){var n,r,i=this;return mo(this,function(s){if(!e.source||!(0,R.Si)(e.source)&&!(0,R.dr)(e.source))throw this.an.error(ie.Szn+" source must be HTMLMediaElement or MediaStream"),[ci," source must be HTMLMediaElement or MediaStream"];if(e.bitRate){if(!(0,te.zQ)(e.bitRate))throw this.an.error(ie.Szn+" bitrate must be integer number"),[ci," bitrate must be integer number"];if(e.bitRate>10240)throw this.an.error(ie.Szn+" bitrate cannot greater than 10 Mbps"),[ci," bitrate cannot greater than 10 Mbps"]}if(e.audioBitrate){if(!(0,te.zQ)(e.audioBitrate))throw this.an.error("ze.cs.0 audioBitrate must be integer number"),[ci," audioBitrate must be integer number"];if(e.audioBitrate<6)throw this.an.error("ze.cs.0 audioBitrate cannot less 6 kbps"),[ci," audioBitrate cannot less 6 kbps"];if(e.audioBitrate>510)throw this.an.error("ze.cs.0 audioBitrate cannot greater than 510 kbps"),[ci," audioBitrate cannot greater than 510 kbps"]}if(!(0,R.TE)(e.keyFrameInterval)&&!(0,te.zQ)(e.keyFrameInterval))throw this.an.error(ie.Szn+(n=" keyFrameInterval must be integer number")),[ci,n];if(!(0,R.TE)(e.videoOptimizationMode)&&!["default","motion","detail"].includes(e.videoOptimizationMode))throw this.an.error(ie.Szn+(n=" video optimizationMode must be 'default', 'motion', 'detail'")),[ci,n];if(e.channelCount!==void 0&&e.channelCount!==1&&e.channelCount!==2)throw this.an.error("ze.cs.0 channelCount must number 1 or 2"),[ci," channelCount must number 1 or 2"];return r=(0,R.dr)(e.source)?"MediaStream":"HTMLElement",t.setAttributes({stream_type:k.eU.stream_type("custom"),custom:k.eU.custom(Ei(Ei({},e),{source_type:r}))}),[2,new te.l3(function(c,u){i.Zh(e,"custom",c,u,t)})]})})},o.prototype.getStreamByCanvas=function(e){var t=this.gn.checkPreview(e);if(t){var n=(0,Vn.UN)();if(n&&n.includes("15_1")&&!this.pn.engineConfig.disableCanvasIOS15_1){var r=t.getStreamThroughCanvas(e);return t.localStream=r,t.streamFromCanvas=!0,t.streamFromCanvasTrack=r.getVideoTracks()[0],r}}return e},o.prototype.createZegoStream=function(e){var t=this;return e===void 0&&(e={}),new te.l3(function(n,r){return fo(t,void 0,void 0,function(){var i,s,c,u,l,a,h,m,S,x,q=this;return mo(this,function(V){switch(V.label){case 0:if(this.an.info("ze.czs.0 call"),i=this.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.nO.event),s=function(_e){(0,te.lA)(i,{local_stream_id:_e.id,stream_options:an(e||{},["captureView","view"])}),n(_e)},c=function(_e){q.cr.setError(i,_e),r(_e)},u=!1,e&&!(0,R.w)(e))return[2,c(Et.ZEp)];if((a=[l=e.camera,e.screen,e.custom].reduce(function(_e,ke){return _e+(ke?1:0)},0))>1)return this.an.error(ie.Szn+" ".concat(h="cannot set more than one type of source",". ").concat(JSON.stringify(e))),[2,c({code:Et.ZEp.code,message:h})];if(u=!!l||a===0,m=new Yh(e,this.an,this.gn,this.pn,this),S=new zd(m),!e.autoCapture&&e.autoCapture!=null)return[3,4];V.label=1;case 1:return V.trys.push([1,3,,4]),[4,S.zegoStream.autoCapture()];case 2:return V.sent(),[3,4];case 3:return x=V.sent(),[2,c(x)];case 4:return this.an.info("ze.czs.0 success"),u&&this.Gh.push(S),s(S),[2]}})})})},o.prototype.destroyStream=function(e){this.an.info(ie.mLk+" call");var t=this.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.ny.event);if(!((0,R.dr)(e)||(0,R.w)(e)&&e.getTracks))return this.an.error(ie.mLk+" localStream is not mediaStream or tracks is null"),void this.cr.setError(t,k.ny.error.qe);(0,R.dr)(e)?((0,R.dr)(e)&&e.getTracks().length==0&&this.an.info(ie.mLk+" tracks is null"),this.Gh=this.Gh.filter(function(n){return n!==e}),this.stopPreview(e)):e.zegoStream&&e.zegoStream.destroy(),(0,te.lA)(t,{stop_reason:k.ny.stop_reason("destroyStream"),local_stream_id:e.id})},o.prototype.startPublishingStream=function(e,t,n,r){var i,s,c,u=this,l=(0,Qi.L)(t,this.an),a=ei(this.an,e);a.info(ie.gkP+" call publishOption: "+JSON.stringify(n)+" isDataChannel: "+JSON.stringify(!!r)+" ms_id: "+(l==null?void 0:l.id));var h,m=!0,S="",x=Vd,q=x.Dn;m&&e===void 0&&(a.error(ie.gkP+(S="stream id required")),m=!1,h=Et.d49),!m||e&&(0,R.QP)(e)||(a.error(ie.gkP+" "+(S="stream id type wrong")),m=!1,h=Et.d49),m&&e.length===0&&(this.an.error(ie.gkP+" "+(S=Et.d49.message)),m=!1,h=Et.d49),m&&e.length>E.LO&&(a.error(ie.gkP+" "+(S="stream id length limit")),m=!1,h=Et.clM),m&&!(0,te.kP)(e)&&(this.an.warn(ie.gkP+" #invald streamID:".concat(e)),this.pn.isFlutter&&(m=!1,h=Et.J79)),m&&!(0,te.jy)(e)&&(a.error(ie.gkP+" "+(S="stream ID contains illegal characters")),m=!1,h=Et.J79),m&&(!l||(0,R.dr)(l)&&l.getTracks().length==0)?(a.error(ie.gkP+" "+(S="localStream wrong")),m=!1,h=q):l&&l.getTracks().forEach(function(vt){rn(vt,u.an,ie.gkP)});var V=this.gn.checkPreview(l);m&&!V&&(a.error(ie.gkP+" "+(S=te.aw)),m=!1,h=x.jn);var _e=V==null?void 0:V.zegoCaptureStream;if(_e&&(_e.originAudioStream||_e.originVideoStream||(a.error(ie.gkP+" "+(S="stream is not capturing")),m=!1,h=x.qn)),V!=null&&V.isVideoEffectStarting&&(a.error(ie.gkP+" "+(S=(h=x.Ln).message)),m=!1),m&&n&&!(0,R.w)(n)&&(m=!1,h=q,S="publishOption must be object"),m&&n&&!(0,R.TE)(n.streamParams)&&!(0,R.QP)(n.streamParams)&&(a.error(ie.gkP+" publishOption streamParams must be string"),m=!1,h=q,S=" publishOption streamParams must be string"),m&&n&&!(0,R.TE)(n.extraInfo)&&!(0,R.QP)(n.extraInfo)&&(a.error(ie.gkP+" publishOption extraInfo must be string"),m=!1,h=q,S=" publishOption extraInfo must be string"),m&&n&&!(0,R.TE)(n.videoCodec)&&!(0,R.QP)(n.videoCodec)&&(a.error(ie.gkP+" publishOption videoCodec must be string"),m=!1,h=q,S=" publishOption videoCodec must be string"),m&&n&&!(0,R.TE)(n.inspectFlag)&&((0,R.Cs)(n.inspectFlag)?[0,1].includes(n.inspectFlag)||(a.error(ie.gkP+" publishOption inspectFlag is not in range"),m=!1,h=q,S=" publishOption inspectFlag is not in range"):(a.error(ie.gkP+" publishOption inspectFlag must be number"),m=!1,h=q,S=" publishOption inspectFlag must be number")),!m||!this.pn.isMultiRoom||n&&(0,R.QP)(n.roomID)&&n.roomID!=""||(m=!1,h=q,S=" roomID is need if set multi room"),n&&n.videoCodec&&(n.videoCodec=n.videoCodec.toUpperCase()),m&&n&&!(0,R.TE)(n.trafficControlFocusOnMode)&&((0,R.Cs)(n.trafficControlFocusOnMode)&&[0,1].includes(n.trafficControlFocusOnMode)||(this.an.error(ie.gkP+" publishOption trafficControlFocusOnMode: ".concat(n.trafficControlFocusOnMode," is invalid")),delete n.trafficControlFocusOnMode)),m&&n&&!(0,R.TE)(n.trafficControlMinVideoBitrate)&&((0,R.Cs)(n.trafficControlMinVideoBitrate)||(this.an.error(ie.gkP+" publishOption trafficControlMinVideoBitrate: ".concat(n.trafficControlMinVideoBitrate," is invalid")),n.trafficControlMinVideoBitrate=0)),m&&n&&!(0,R.TE)(n.enableTrafficControl)&&((0,R.dd)(n.enableTrafficControl)||(this.an.error(ie.gkP+" publishOption enableTrafficControl: ".concat(n.enableTrafficControl," is invalid")),n.enableTrafficControl=!0)),this.pn.useNetAgent&&this.pn.roomList.length>0?a.info(ie.gkP+" publish accelerate"):this.rtm.isDisConnect()&&(a.error(ie.gkP+" not login"),m=!1,h=x.Bn),!m){a.error(ie.gkP+" "+S);var ke=this.cr.getAPIErrorReport(Bu);throw ke&&h&&this.cr.takeAPIErrorReport(Bu,h,ke),{errorCode:h==null?void 0:h.code,extendedData:S}}var Pe=this.cr.createSpan(E.t0.I,{key:k.vW.event},{key:Bu,par:e},Bu,!0);n||(n={});var Oe=(V==null?void 0:V.videoPreviewType)||(V==null?void 0:V.previewType);!n.videoCodec&&(0,Vn.e8)()&&Oe=="custom"&&(!((s=V==null?void 0:V.mediaStreamConfig)===null||s===void 0)&&s.source)&&(0,R.Si)((c=V.mediaStreamConfig)===null||c===void 0?void 0:c.source)&&(a.info(ie.gkP+" Redmi note 8 uesed custom stream. change to VP8"),n.videoCodec="VP8");var Ge=Tn(this.pn.appid,this.pn.idName,e),Je=((i={})["_publish_"+e]={stream_sid:Ge},i);this.cr.setPublicPros(Je),Pe.setAttributes({stream_id:Ja.stream_id(e),stream_sid:Ja.stream_sid(Ge),publish_option:Ja.publish_option(n),enable_camera:Ja.enable_camera(!!(V!=null&&V.videoTrack)),enable_mic:Ja.enable_mic(!!(V!=null&&V.audioTrack))}),n.audioBitRate=this.pn.audioBitRate;var tt=n.roomID?n.roomID:this.pn.roomList[0]?this.pn.roomList[0].roomID:"",ut=this.pn.getRoomByRoomID(tt);return ut?(Pe.setAttributes({room_id:Ja.room_id(tt)}),this.gn.setPublishStateStart(ut,e,l,n,Ge,r)?(this.pn.publishStreamList[e]={state:E.T_.tryPublish,extra_info:n.extraInfo,roomID:ut.roomID},a.info("zc.p.sps.1 start publish"),ut.streamHandler.onPublishStateUpdate(E.eZ.retry,e,{code:0,message:""}),this.cr.createSpan(E.t0.H,{key:k.Og.event,par:e},{key:ql.event,par:e},ql.event,!0).setAttributes({reason:ql.reason("StartPublish")}),this.cr.createSpan(E.t0.I,{key:k.Og.event,par:e},{key:k.Jv.event,par:e},k.Jv.event,!0).setAttributes({room_id:Fd.room_id(ut==null?void 0:ut.roomID),room_sid_string:Fd.room_sid_string(ut==null?void 0:ut.roomSessionID)}),this.pn.appConfig?V!=null&&V.containBackgroundProcess&&this.pn.supportBg===!1?(a.info("zc.p.sps.1 check not support background porcess"),ut.streamHandler.onPublishStateUpdate(E.eZ.error,e,x.ae),!1):(this.gn.startPublishingStream(e),!0):(this.gn.waitPublishList.push(e),!0)):(a.error("zc.p.sps.1 cannot start publish"),!1)):(a.error("zc.p.sps.1 room no found"),!1)},o.prototype.updatePublishingStream=function(e,t){var n=this;return new te.l3(function(r){var i=n.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.r_.event),s=function(a){var h=a.errorCode,m=a.extendedData,S=a.video,x=a.audio,q={};S&&(q.video=S),x&&(q.audio=x),(0,te.lA)(i,{local_stream_id:e.id,update_type:t,preview_conf:q}),r({errorCode:h,extendedData:m})},c=function(a,h){var m=(0,R.Cs)(a)?{errorCode:a,extendedData:JSON.stringify({fail_reason:h})}:a;n.an.error(ie.xcY+" "+m.extendedData),(0,te.lA)(i,{local_stream_id:e.id,update_type:t,error:m.errorCode,message:m.extendedData}),r(m)};n.an.info(ie.xcY+" call");var u=n.gn.checkPreview(e);if(u)if(u.zegoCaptureStream){var l=u.zegoCaptureStream;t!=So.audio&&t!=So.videoAndAudio||l.getAudioTracks().length?t!=So.video&&t!=So.videoAndAudio||l.getVideoTracks().length?t==So.audio?l.updateStreamAudioTrack(s,c,1):t==So.video?l.updateStreamVideoTrack(s,c,1):l.updateStreamVideoAndAudio(s,c,1):c(Et.dU8.code,Et.dU8.message):c(Et.SQb.code,Et.SQb.message)}else c(Et.ZEp.code,Et.ZEp.message+", stream type wrong");else c(Et.VEp.code,Et.VEp.message)})},o.prototype.activateSEIInsert=function(e){var t=e.stream,n=e.action,r=e.infoType,i=this._getSpan(e.stream,k.$H.event);i.setAttributes({action:k.$H.action(e.action),info_type:k.$H.info_type(e.infoType)});var s=this.gh.activateSEIInsert(t,n,r);return i.end(),s},o.prototype.sendSEI=function(e,t){if(!_t())return this.an.warn(ie.dnG+" browser not support "),!1;if(!(0,R.G0)(t))return this.an.error(ie.dnG+" inData required Uint8Array"),!1;if(t.byteLength>4096)return this.an.error(ie.dnG+" inData length limit"),!1;var n=this.gn.publisherList[e];return n&&n.publisher?n.publisher.sendSEI(t):(this.an.warn(ie.dnG+" publish not exist"),!1)},o.prototype.stopPublishingStream=function(e,t,n){var r,i,s,c;this.an.info(ie.K4A+" call "+(t?t.toString():""),{streamid:e});var u=t||{code:0,message:""},l=this.cr.createSpan(E.t0.I,{key:k.vW.event},{key:""},k.Vz.event);if(!(0,R.QP)(e)||e=="")return this.an.error(ie.K4A+" streamID must be string and not empty"),this.cr.setError(l,k.Vz.error.wn,"stream id type error"),!1;var a=this.gn.publisherList[e];n&&!(!((r=a==null?void 0:a.publisher)===null||r===void 0)&&r.Xh)&&(u=Vd.ce),l.setAttributes({stream_id:k.Vz.stream_id(e),stream_sid:k.Vz.stream_sid(a==null?void 0:a.streamSid),room_id:k.Vz.room_id((s=(i=this.gn.publisherList[e])===null||i===void 0?void 0:i.room)===null||s===void 0?void 0:s.roomID),error:u.code,message:u.message});var h=this.gn.getRoomByStreamID(e),m=a&&a.publisher&&a.publisher.state!==7||((c=a==null?void 0:a.retryStreamHandler)===null||c===void 0?void 0:c.isRetrying());if(this.gn.stopPublishingStream(e,u),this.pn.publishStreamList[e]){if(this.pn.publishStreamList[e].state>=E.T_.update_info&&h){(!t||t.code!==1102018)&&h.streamHandler.updateStreamInfo(e,E.NP.liveEnd);for(var S=0;S<h.streamList.length;S++)if(h.streamList[S].stream_id==e){h.streamList.splice(S--,1);break}}delete this.pn.publishStreamList[e]}return l.end(),h&&m&&h.streamHandler.onPublishStateUpdate(E.eZ.error,e,u),!0},o.prototype.stopPublishingStreamInRoom=function(e){for(var t in this.an.info(ie.s1U+" call "+e),this.pn.publishStreamList)this.pn.publishStreamList[t].roomID===e&&this.stopPublishingStream(t)},o.prototype.setCaptureVolume=function(e,t){var n=this;return new te.l3(function(r){n.an.info(ie.t6w+" call");var i=(0,Qi.L)(e,n.an),s=k.tI.error.wn,c=function(l){n.an.error(ie.t6w+" "+l),r({errorCode:s.code,extendedData:JSON.stringify({fail_reason:s.message+" "+l})})},u=n.gn.checkPreview(i);(0,R.dr)(i)&&u?i.getAudioTracks().length!=0?!(0,R.Cs)(t)||t<0||t>200?c(" volume must be number between 0 to 200"):(n.Jh?n.Hh=Math.round(performance.now()-n.Jh):(n.Jh=performance.now(),n.Fh=u.volume),n.Vh(t),u.setVolume(t),r({errorCode:0,extendedData:""}),n.an.info(ie.t6w+" call success")):c(" stream audioTrack no found"):c(" stream must be created by zego")})},o.prototype.getElectronScreenSources=function(){var e=this;return new te.l3(function(t,n){var r=window.require("electron");r||(e.an.error("zc.gess.0 Electron is not exist"),n({message:"Electron is not exist"})),r.desktopCapturer.getSources({types:["window","screen"]}).then(function(i){var s=i.map(function(c){return{id:c.id,name:c.name,thumbnail:c.thumbnail}});t(s)}).catch(function(i){e.an.error("zc.gess.0 "+i),n(i)})})},o.prototype.startScreenShotChrome=function(e){if(Fs.screenShotReady)window.postMessage({type:"SS_UI_REQUEST",text:"start"},"*"),K("screenShare",{success:e},this.pn.callbackList);else{var t='zc.b.ss Please install the extension:1. Go to chrome://extensions  2. Check: "Enable Developer mode   3. Click: "Load the unpacked extension... 4. Choose "extension" folder from the repository 5. Reload this page';this.an.error(t),e(!1,null,{code:ao.code,message:ao.message+" "+t})}},o.prototype.startScreenSharing=function(e,t){var n=this;if("getDisplayMedia"in navigator.mediaDevices){var r=navigator.mediaDevices,i=e.audio||!1,s=e.video,c="zc.b.sss";if((0,Vn.nr)()&&(0,R.w)(s)){var u=s.width,l=s.height;(0,R.w)(u)?s.width={max:u.max||u.ideal}:u&&(s.width={max:u}),(0,R.w)(l)?s.height={max:l.max||l.ideal}:l&&(s.height={max:l})}var a={audio:i,video:s,preferCurrentTab:!!e.captureElement,systemAudio:"include",selfBrowserSurface:"include",surfaceSwitching:"include"};e.video=s,this.an.info("zc.b.sss config: "+JSON.stringify(a)),r.getDisplayMedia(a).then(function(h){return fo(n,void 0,void 0,function(){var m,S,x,q,V;return mo(this,function(_e){switch(_e.label){case 0:if(!(m=e.captureElement))return[3,5];if(S=h.getVideoTracks()[0],!("CropTarget"in window&&"fromElement"in CropTarget&&S.cropTo))return[3,5];_e.label=1;case 1:return _e.trys.push([1,4,,5]),(x=S==null?void 0:S.getCaptureHandle())&&x.handle===qd?[4,CropTarget.fromElement(m)]:(this.an.info("".concat(c," no current tap")),h.getVideoTracks().forEach(function(ke){return ke.stop()}),t(!1,null,{code:ao.code,message:ao.message+" captureElement must on current tab."}),[2]);case 2:return q=_e.sent(),[4,S.cropTo(q)];case 3:return _e.sent(),[3,5];case 4:return V=_e.sent(),this.an.error("".concat(c," crop error:").concat(V)),h.getVideoTracks().forEach(function(ke){return ke.stop()}),t(!1,null,{code:ao.code,message:ao.message+" "+V}),[3,5];case 5:return this.an.info("zc.b.sss capture suc"),t(!0,h),[2]}})})}).catch(function(h){n.an.error(c+" "+h),h.message&&h.message.toLowerCase()=="permission denied"?t(!1,null,$h):t(!1,null,{code:ao.code,message:ao.message+" "+h})})}else this.an.error("zc.b.sss brower does not support getDisplayMedia"),t(!1,null,ma.yn)},o.prototype.startScreenShotFirFox=function(e,t,n){var r=this,i={video:Ei(Ei({},t.video),{mediaSource:e}),audio:t.audio};navigator.mediaDevices.getUserMedia(i).then(function(s){s.getTracks().forEach(function(c){return rn(c,r.an,"ze.ssf.1")}),n(!0,s)}).catch(function(s){r.an.error("ze.ssf.1 "+s),n(!1,null,{code:ao.code,message:ao.message+" "+s})})},o.prototype.startScreenShotElectron=function(e,t){var n=this;if(!window.require("electron"))return this.an.error("ze.sse.1 Electron is not exist"),void t(!1,null,{code:ao.code,message:ao.message+" Electron is not exist"});var r={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e.sourceID,maxWidth:window.screen.width,maxHeight:window.screen.height}},audio:!1};navigator.mediaDevices.getUserMedia(r).then(function(i){i.getTracks().forEach(function(s){return rn(s,n.an,"ze.sse.1")}),t(!0,i)}).catch(function(i){n.an.error("ze.sse.1 "+i),t(!1,null,{code:ao.code,message:ao.message+" "+i})})},o.prototype.Zh=function(e,t,n,r,i){var s=this,c=null;return c=new la(this.an,this.pn,this.gn,t),this.gn.previewStreamList.push(c),c.startPreview(e,function(u){s.gn.soundLevelDelegate&&(c==null||c.startSoundLevel()),t==="camera"&&((e==null?void 0:e.audio)===!1&&c&&(c.hasMicTrack=!1),c!=null&&c.micTrack&&(c.micTrack.enabled=s.gn.isMicEnabled)),e!=null&&e.videoOptimizationMode&&s.gn.setVideoTrackContentHint(u,e==null?void 0:e.videoOptimizationMode),s.an.debug("zsc.sp.0 call success"),!s.pn.deviceInfos&&s.recordDevices(),n&&n(u)},function(u){s.gn.previewStreamList=s.gn.previewStreamList.filter(function(l){return l!==c}),r&&r(u)},i),!0},o.prototype.stopPreview=function(e){if(!e)return this.an.warn("zsc.sp.0 localStream null"),!1;for(var t in this.gn.publisherList)this.gn.publisherList[t].localStream===e&&(this.gn.publisherList[t].localStream=null);var n=this.gn.checkPreview(e);return n?(n.previewSuc&&(n.stopPreview(),this.gn.removePreview(n)),!0):(this.an.info("zsc.sp.0 "+te.h2),!1)},o.prototype.recordDevices=function(e,t){var n,r=this,i=this.Qh;this.an.info("zsc.rd.0 call "+!!i),i||(i=this.Yh(0),this.Qh=i),i.then(function(s){r.Uh.lastRecordDeviceTime=performance.now(),e&&e(s)}).catch(function(s){r.an.warn("zsc.rd.0 getDevices err:"+s),t&&t(s)}).finally(function(){r.Qh=void 0}),((n=navigator.mediaDevices)===null||n===void 0?void 0:n.ondevicechange)!==void 0&&(navigator.mediaDevices.ondevicechange=null,navigator.mediaDevices.ondevicechange=function(s){return fo(r,void 0,void 0,function(){return mo(this,function(c){return this.an.info("zsc.rd.0 devicechange"),this.Yh(500),[2]})})})},o.prototype.Yh=function(e,t){return e===void 0&&(e=0),fo(this,void 0,void 0,function(){var n,r,i,s=this;return mo(this,function(c){switch(c.label){case 0:return this.an.info("zsc.rd.0 get and compare devices: "+e),n=!0,(r=this.pn.deviceChangeTimer)?(clearTimeout(r),this.pn.deviceChangeTimer=null):e===0&&(n=!1),i=function(){return fo(s,void 0,void 0,function(){var u=this;return mo(this,function(l){return this.an.info("zsc.rd.0 start get and compare devices"),[2,new Promise(function(a,h){ku(function(m){var S,x,q,V,_e,ke;u.an.info("zsc.rd.0 get devices success. ".concat(JSON.stringify(m),"; need compare: ").concat(n));var Pe=m.microphones,Oe=m.speakers,Ge=m.cameras,Je=u.pn.deviceInfos;if(!Je){var tt=(0,te.fU)(u.cr,E.t0.H,"",k.gf.event,k.vW.event),ut=function(zt,Mt){return zt.map(function(jt){return{device:jt.deviceID,device_name:jt.deviceName,type:Mt}})};(0,te.lA)(tt,{dev_list:Fl(Fl(Fl([],ut(Ge,0),!0),ut(Pe,1),!0),ut(Oe,2),!0),dev_kind:"init"})}if(!Je||!n)return u.pn.deviceInfos={microphones:Pe,speakers:Oe,cameras:Ge},void a(JSON.parse(JSON.stringify(u.pn.deviceInfos)));var vt=!0,gt=[],Pt=[];if((0,Vn.nr)()&&((x=(S=u.pn.deviceInfos)===null||S===void 0?void 0:S.cameras)===null||x===void 0?void 0:x.length)===1&&((q=u.pn.deviceInfos)===null||q===void 0?void 0:q.cameras[0].deviceID)==="")u.an.info("zsc.rd.0 cameras not accurate");else{for(var wt=function(zt){var Mt=u.pn.deviceInfos.cameras[zt];m.cameras.find(function(jt){return jt.deviceID===Mt.deviceID})||gt.push(Mt)},At=0;At<u.pn.deviceInfos.cameras.length;At++)wt(At);u.pn.deviceStateOut=!1;var Vt=!1;gt.length>0&&(Vt=!0),gt.forEach(function(zt){for(var Mt in u.gn.publisherList){var jt=u.gn.publisherList[Mt],Kt=jt.publisher;jt.localStream&&jt.cameraLabel!==""&&jt.cameraLabel===zt.deviceName&&(Vt=!1,!Kt.isVideoTrackAlive()&&Kt.sendStreamStatus(-6,Kt.mic_status),vt=!1,u.pn.actionListener("_deviceError",Et.pGN.code,zt.deviceName,"camera"),u.pn.actionListener("deviceError",Et.pGN.code,zt.deviceName)),jt.localStream&&jt.localStream.getAudioTracks().length===0&&(Vt=!1)}Vt&&(u.pn.deviceStateOut=!0),u.deviceInterruptReport(0,zt,"camera"),vt=!1,u.pn.actionListener("videoDeviceStateChanged","DELETE",zt)}),m.cameras.filter(function(zt){return!u.pn.deviceInfos.cameras.find(function(Mt){return Mt.deviceID===zt.deviceID})}).forEach(function(zt){u.deviceInterruptReport(1,zt,"camera"),vt=!1,u.pn.actionListener("videoDeviceStateChanged","ADD",zt)})}(0,Vn.nr)()&&((_e=(V=u.pn.deviceInfos)===null||V===void 0?void 0:V.microphones)===null||_e===void 0?void 0:_e.length)===1&&((ke=u.pn.deviceInfos)===null||ke===void 0?void 0:ke.microphones[0].deviceID)===""?u.an.info("zsc.rd.0 microphones not accurate"):((Pt=u.pn.deviceInfos.microphones.filter(function(zt){return!m.microphones.find(function(Mt){return Mt.deviceID===zt.deviceID})})).forEach(function(zt){for(var Mt in u.gn.publisherList){var jt=u.gn.publisherList[Mt],Kt=jt.publisher;jt.localStream&&jt.microLabel!==""&&(jt.microLabel===zt.deviceName||jt.microLabel!==""&&jt.microLabel.includes(zt.deviceName))&&(!Kt.isAudioTrackAlive()&&Kt.sendStreamStatus(Kt.camera_status,-6),vt=!1,u.pn.actionListener("_deviceError",Et.pGN.code,u.gn.publisherList[Mt].microLabel,"micro"),u.pn.actionListener("deviceError",Et.pGN.code,u.gn.publisherList[Mt].microLabel))}u.deviceInterruptReport(0,zt,"micro"),vt=!1,u.pn.actionListener("audioDeviceStateChanged","DELETE","Input",zt)}),m.microphones.filter(function(zt){return!u.pn.deviceInfos.microphones.find(function(Mt){return Mt.deviceID===zt.deviceID})}).forEach(function(zt){u.deviceInterruptReport(1,zt,"micro"),vt=!1,u.pn.actionListener("audioDeviceStateChanged","ADD","Input",zt)}));var qt=u.pn.deviceInfos.speakers.filter(function(zt){return!m.speakers.find(function(Mt){return Mt.deviceID===zt.deviceID})}),Gt=m.speakers.filter(function(zt){return!u.pn.deviceInfos.speakers.find(function(Mt){return Mt.deviceID===zt.deviceID})});qt.forEach(function(zt){var Mt=u.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.rP.event);Mt.setAttributes({reason_type:k.rP.reason_type("delete"),device:k.rP.device(zt.deviceID),device_name:k.rP.device(zt.deviceName)}),Mt.end(),vt=!1,u.pn.actionListener("audioDeviceStateChanged","DELETE","Output",zt)}),Gt.forEach(function(zt){var Mt=u.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.rP.event);Mt.setAttributes({reason_type:k.rP.reason_type("add"),device:k.rP.device(zt.deviceID),device_name:k.rP.device(zt.deviceName)}),Mt.end(),vt=!1,u.pn.actionListener("audioDeviceStateChanged","ADD","Output",zt)}),vt&&u.Uh.onDeviceNoChangeQuickly(m);var Sn=Ei({},u.pn.deviceInfos);if(u.pn.deviceInfos={microphones:m.microphones,speakers:m.speakers,cameras:m.cameras},u.pn.autoSwitchDeviceSetting.microphone){var Qt=u.pn.deviceInfos.microphones;Pt&&Pt.length!==0&&Qt.length!=0&&u.gn.previewStreamList.forEach(function(zt){return fo(u,void 0,void 0,function(){var Mt,jt,Kt,$t,yt,Pn,pn;return mo(this,function(un){switch(un.label){case 0:return Mt=zt.localStream,jt=Qt[0].deviceID,$t=(Kt=zt.audioTrack)==null?void 0:Kt.getSettings().deviceId,yt=!1,$t&&$t==="default"?(Pn=Sn.microphones.find(function(ln){return ln.deviceID==="default"}).deviceName,pn=Qt.find(function(ln){return ln.deviceID==="default"}).deviceName,yt=pn!==Pn):$t!==""&&(yt=Pt.some(function(ln){return ln.deviceID===$t})),Mt&&yt&&jt!==""?(this.an.info("zsc.rd.0 auto switch audio device. "+jt),[4,this.zegoWebRtc.useAudioDevice(Mt,jt)]):[3,2];case 1:un.sent(),un.label=2;case 2:return[2]}})})})}if(u.pn.autoSwitchDeviceSetting.camera){var Wt=u.pn.deviceInfos.cameras;gt&&gt.length!==0&&Wt.length!=0&&u.gn.previewStreamList.forEach(function(zt){return fo(u,void 0,void 0,function(){var Mt,jt,Kt,$t,yt,Pn,pn;return mo(this,function(un){switch(un.label){case 0:return Mt=zt.localStream,jt=Wt[0].deviceID,$t=(Kt=zt.videoTrack)==null?void 0:Kt.getSettings().deviceId,yt=!1,$t&&$t==="default"?(Pn=Sn.cameras.find(function(ln){return ln.deviceID==="default"}).deviceName,pn=Wt.find(function(ln){return ln.deviceID==="default"}).deviceName,yt=pn!==Pn):$t!==""&&(yt=gt.some(function(ln){return ln.deviceID===$t})),Mt&&yt&&jt!==""?(this.an.info("zsc.rd.0 auto switch video device. "+jt),[4,this.zegoWebRtc.useVideoDevice(Mt,jt)]):[3,2];case 1:un.sent(),un.label=2;case 2:return[2]}})})})}a(JSON.parse(JSON.stringify(u.pn.deviceInfos)))},function(m){h(m)})})]})})},e!==0?[3,2]:[4,i()];case 1:case 3:return[2,c.sent()];case 2:return[4,new Promise(function(u,l){s.pn.deviceChangeTimer=setTimeout(function(){return fo(s,void 0,void 0,function(){var a,h;return mo(this,function(m){switch(m.label){case 0:return m.trys.push([0,2,,3]),[4,i()];case 1:return a=m.sent(),u(a),[3,3];case 2:return h=m.sent(),l(h),[3,3];case 3:return[2]}})})},e)})]}})})},o.prototype.setVideoConfig=function(e,t){var n=this;return(0,te.rA)(this.an,ie.I8R),new te.l3(function(r,i){var s=(0,Qi.L)(e,n.an),c=k.wd.error,u=c.qe,l=c.wn,a=n._getSpan(s,k.wd.event),h=Ei({},t);for(var m in h)h[m]instanceof Object&&(h[m]=JSON.stringify(h[m]));a.setAttributes({video_params:h});var S=function(Oe){n.cr.setError(a,u,Oe)};if(!(0,R.dr)(s))return n.an.error(ie.I8R+" localStream not found"),S("localStream not found"),void i({errorCode:l.code,extendedData:l.message+" localStream no found"});if(!t||!(0,R.w)(t)||Object.keys(t).length==0)return n.an.error(ie.I8R+" constraints wrong"),S("constraints wrong"),void i({errorCode:l.code,extendedData:l.message+" constraints wrong"});var x,q,V=t.width,_e=t.height,ke=t.maxBitrate,Pe=t.frameRate;if(V&&(0,R.Cs)(V)&&!n.pn.checkValidNumber(V,0,7680))return n.an.error(ie.I8R+" constraints width integer number, range[0, 7680]"),S("constraints width integer number, range[1, 7680]"),void i({errorCode:l.code,extendedData:l.message+" constraints wrong"});if(V&&(0,R.w)(V)){if(!(q=Pu(V,"width",0,7680)).result)return n.an.error(ie.I8R+" constraints width: "+q.message),S("constraints width: "+q.message),void i({errorCode:l.code,extendedData:l.message+" constraints wrong"})}else if(V&&!(0,R.Cs)(V)&&!(0,R.w)(V))return n.an.error(ie.I8R+" constraints width must be a number or an object. "),S("constraints width must be a number or an object."),void i({errorCode:l.code,extendedData:l.message+" constraints wrong"});if(_e&&(0,R.Cs)(_e)&&!n.pn.checkValidNumber(_e,0,4320))return n.an.error(ie.I8R+" constraints height integer number, range[0, 4320]"),S(" constraints height integer number, range[0, 4320]"),void i({errorCode:l.code,extendedData:l.message+" constraints wrong"});if(_e&&(0,R.w)(_e)){if(!(q=Pu(t.height,"height",0,4320)).result)return n.an.error(ie.I8R+" constraints height: "+q.message),S("constraints height: "+q.message),void i({errorCode:l.code,extendedData:l.message+" constraints wrong"})}else if(_e&&!(0,R.Cs)(_e)&&!(0,R.w)(_e))return n.an.error(ie.I8R+" constraints height must be a number or an object. "),S(" constraints height must be a number or an object."),void i({errorCode:l.code,extendedData:l.message+" constraints wrong"});if(ke&&!(0,R.Cs)(ke))return n.an.error(ie.I8R+(x=" constraints maxBitrate is not a number")),S(x),void i({errorCode:l.code,extendedData:l.message+x});if(!(0,R.TE)(Pe)&&!(0,R.Cs)(Pe)&&!(0,R.w)(Pe))return n.an.error(ie.I8R+(x=" constraints frameRate is not a number or an object")),S(x),void i({errorCode:l.code,extendedData:l.message+x});if((0,R.Cs)(Pe)&&!(Pe>0&&Pe%1==0))return n.an.error(ie.I8R+" constraints frameRate must be positive integer number"),S("constraints frameRate must be positive integer number"),void i({errorCode:l.code,extendedData:l.message+" constraints wrong"});if(Pe&&(0,R.w)(Pe)&&!(q=Pu(Pe,"frameRate")).result)return n.an.error(ie.I8R+" constraints frameRate: "+q.message),S("constraints frameRate: "+q.message),void i({errorCode:l.code,extendedData:l.message+" constraints wrong"});n.gh.setPublishStreamVideoConstraints(s,t,a,function(Oe){a.setAttributes({error:Oe.errorCode,message:Oe.extendedData}),a.end(),r(Oe)})})},o.prototype.setAudioConfig=function(e,t){var n=this;return(0,te.rA)(this.an,ie.xcT),new te.l3(function(r){var i=(0,Qi.L)(e,n.an),s=n._getSpan(i,k.$7.event);if(s.setAttributes({audio_params:k.$7.audio_params(t)}),!(0,R.dr)(i))return n.an.error(ie.xcT+" localStream not found"),n.cr.setError(s,k.$7.error.qe),void r({errorCode:k.$7.error.wn.code,extendedData:k.$7.error.wn.message+" localStream no found"});if(!t||!(0,R.w)(t)||Object.keys(t).length==0||!(0,R.TE)(t.AEC)&&!(0,R.dd)(t.AEC)||!(0,R.TE)(t.AGC)&&!(0,R.dd)(t.AGC)||!(0,R.TE)(t.ANS)&&!(0,R.dd)(t.ANS))return n.an.error(ie.xcT+" constraints wrong"),n.cr.setError(s,k.$7.error.wn," constraints wrong"),void r({errorCode:k.$7.error.wn.code,extendedData:k.$7.error.wn.message+" constraints wrong"});n.gh.setPublishStreamAudioConstraints(i,t,s,function(c){s.end(),r(c)})})},o.prototype.mutePublishStreamVideo=function(e,t,n){var r=(0,Qi.L)(e,this.an);(0,te.rA)(this.an,ie.NYT,". "+(r==null?void 0:r.id)+" mute: ".concat(t,", retain: ").concat(n));var i=this._getSpan(r,k.$Q.event),s=this.gn.checkPreview(r);if(!s)return this.an.error(ie.NYT+" localStream error"),!1;if(!(0,R.dd)(t)||!(0,R.TE)(n)&&!(0,R.dd)(n))return this.an.error(ie.NYT+" option error"),!1;var c=this.gh.enableCamera(r,!t,n);return s.syncVideoEnabled=c&&t,i.setAttributes({mute_type:k.$Q.mute_type(t?1:0),retain:k.$Q.retain(n||!1)}),i.end(),(0,te.OY)(this.an,ie.NYT),c},o.prototype.mutePublishStreamAudio=function(e,t){var n=(0,Qi.L)(e,this.an);(0,te.rA)(this.an,ie.iMZ,(n==null?void 0:n.id)+" mute: ".concat(t));var r=this.gn.checkPreview(n);if(!r)return this.an.error(ie.iMZ+" localStream error"),!1;var i=this._getSpan(n,k.Kt.event);if(!(0,R.dd)(t))return this.an.error(ie.iMZ+" option error"),!1;var s=this.gh.enableMicrophone(n,!t);return r.syncAudioEnabled=s&&t,i.setAttributes({mute_type:k.Kt.mute_type(t?1:0)}),i.end(),(0,te.OY)(this.an,ie.iMZ),s},o.prototype.muteMicrophone=function(e){this.an.info(ie.QpU+" call");var t=(0,te.fU)(this.cr,E.t0.H,"",k.HF.event,k.oq.event);if(!(0,R.dd)(e))return this.an.error(ie.QpU+" option error"),this.cr.setError(t,Et.ZEp),!1;var n=this.gh.enableMicrophoneOnly(!e),r=Object.keys(this.gn.publisherList).map(function(i){return{stream_id:i}});return(0,te.lA)(t,{enable:k.HF.enable(!e),stream_list:k.HF.stream_list(r)}),this.an.info(ie.QpU+" end"),n},o.prototype.handleTrack=function(e,t,n,r,i){this.gh.handleTrack(e,t,n,r,i)},o.prototype._getSpan=function(e,t){var n=this.gn.checkPublish(e);return this.cr.createSpan(E.t0.H,n?{key:k.Og.event,par:n.streamID}:{key:k.vW.event},{key:""},t)},o.prototype.enVideoSpan=function(e,t,n){this.gh.enVideoSpan(e,t,n)},o.prototype.replaceTrack=function(e,t,n,r){return fo(this,void 0,void 0,function(){var i,s,c,u,l,a;return mo(this,function(h){return i=this._getSpan(e,k.oe.event),s=k.oe.error.wn,(0,R.dr)(e)?t&&t instanceof MediaStreamTrack?(c={id:t.id,muted:t.muted,enabled:t.enabled,kind:t.kind,readyState:t.readyState,label:t.label},(0,te.rA)(this.an,ie.d9R,". ".concat(e.id," track: ")+JSON.stringify(c)),u=!0,this.pn.browser==="safari"&&(r==null?void 0:r.isReplaceNew)!==void 0&&(u=r.isReplaceNew),l=(0,R.TE)(r==null?void 0:r.isCaptureStream)||r==null?void 0:r.isCaptureStream,a=this.gh._replaceTrack(e,t,n,void 0,u,l),i.setAttributes({track_kind:k.oe.track_kind(t.kind)}),i.end(),[2,a]):(this.an.error(ie.d9R+" mediastream track no found"),this.cr.setError(i,s,"mediastream track no found"),[2,{errorCode:s.code,extendedData:s.message+" mediastream track no found"}]):(this.an.error(ie.d9R+" localStream not found"),this.cr.setError(i,s,"localStream not found"),[2,{errorCode:s.code,extendedData:s.message+" localStream no found"}])})})},o.prototype.useVideoDevice=function(e,t){var n=this,r="zc.uvd.0";return(0,te.rA)(this.an,r),new te.l3(function(i){var s=(0,Qi.L)(e,n.an),c=n._getSpan(s,k.RI.event);if(c.setAttributes({device:k.RI.device(t)}),!(0,R.dr)(s))return n.an.error(r+" localStream not found"),n.cr.setError(c,k.RI.error.qe),void i({errorCode:k.RI.error.wn.code,extendedData:k.RI.error.wn.message});if(!(0,R.QP)(t))return n.an.error(r+" deviceID must be string"),n.cr.setError(c,k.RI.error.wn," deviceID must be string"),void i({errorCode:k.RI.error.wn.code,extendedData:k.RI.error.wn.message});var u=function(l){(0,te.lA)(c,{error:l.errorCode,message:l.extendedData}),n.gn.getPublishList(s).forEach(function(a){var h,m;a.cameraLabel=((m=(h=a.publisher.previewer)===null||h===void 0?void 0:h.videoTrack)===null||m===void 0?void 0:m.label)||a.cameraLabel}),i(l)};ku(function(l){var a=l.cameras.find(function(h){return h.deviceID==t});if(!a)return n.an.error(r+" "+te.pt),void u({errorCode:k.RI.error.Ve.code,extendedData:k.RI.error.Ve.message});c.setAttributes({device_name:k.RI.device_name(a==null?void 0:a.deviceName)}),n.gh.Bh("video",s,t,u)},function(l){n.an.warn(r+" getDevices err:"+l),n.gh.Bh("video",s,t,u)})})},o.prototype.useFrontCamera=function(e,t){var n=this,r="zc.ufc.0";return(0,te.rA)(this.an,r,""+t),new te.l3(function(i,s){var c=(0,Qi.L)(e,n.an),u=n._getSpan(c,k.RI.event);if(!(0,R.dr)(c))return n.an.error(r+" localStream not found"),n.cr.setError(u,k.RI.error.qe),void s({errorCode:k.RI.error.wn.code,extendedData:k.RI.error.wn.message});if(!(0,R.dd)(t))return n.an.error(r+" enable must be boolean"),n.cr.setError(u,k.RI.error.wn," enable must be boolean"),void s({errorCode:k.RI.error.wn.code,extendedData:k.RI.error.wn.message});var l=(0,Vn.m0)(),a=(0,Vn.aR)(),h=(0,Vn.HR)();if(!(l||a||h))return n.an.error(r+" must use in mobile"),n.cr.setError(u,k.RI.error.Qe," must use in mobile"),void s({errorCode:k.RI.error.Qe.code,extendedData:k.RI.error.Qe.message});var m=t?"user":"environment";u.setAttributes({facing_mode:k.RI.facing_mode(m)}),n.gh.Bh("video",c,"",function(S){u.setAttributes({error:S.errorCode,message:S.extendedData}),u.end(),n.gn.getPublishList(c).forEach(function(x){var q,V;x.cameraLabel=((V=(q=x.publisher.previewer)===null||q===void 0?void 0:q.videoTrack)===null||V===void 0?void 0:V.label)||x.cameraLabel}),(S==null?void 0:S.errorCode)===0?i(S):s(S)},{facingMode:m})})},o.prototype.useAudioDevice=function(e,t){var n=this,r="zc.uad.1";return(0,te.rA)(this.an,r),new te.l3(function(i){var s=(0,Qi.L)(e,n.an),c=n._getSpan(s,k.li.event);c.setAttributes({device:k.li.device(t)});var u=function(a,h){n.an.error(r+" "+h);var m=a;m.message=m.message+(h?" "+h:""),n.cr.setError(c,a,h),i({errorCode:m.code,extendedData:m.message})},l=function(a){(0,te.lA)(c,{error:a.errorCode,message:a.extendedData}),n.gn.getPublishList(s).forEach(function(m){var S;m.microLabel=((S=s.getAudioTracks()[0])===null||S===void 0?void 0:S.label)||m.microLabel});var h=n.gn.checkPreview(s);a.errorCode===0&&h&&(h.hasMicTrack=!0),i(a)};(0,R.dr)(s)?(0,R.QP)(t)?ku(function(a){var h=a.microphones.find(function(m){return m.deviceID==t});if(!h)return n.an.error(r+" "+te.pt),void l({errorCode:k.li.error.Ve.code,extendedData:k.li.error.Ve.message});c.setAttributes({device_name:k.li.device_name(h==null?void 0:h.deviceName)}),n.gh.Bh("audio",s,t,l)},function(a){n.an.warn(r+" getDevices err:"+a),n.gh.Bh("audio",s,t,l)}):u(k.li.error.wn,"deviceID must be string"):u(k.li.error.qe,"localStream not found")})},o.prototype.enableDualStream=function(e){var t="zsc.eds";(0,te.rA)(this.an,t);var n=(0,Qi.L)(e,this.an),r=this.gn.checkPreview(n);if(r)if(r!=null&&r.lowStream)this.an.error(t+" low stream already exists");else{var i=r.videoPreviewType||r.previewType;(0,Vn.gm)()&&i=="custom"?this.an.error(t+" can not support firefox"):this.gn.checkPublish(n)?this.an.error(t+" is publishing"):(r.enableDualStream=!0,r.createLowStream())}else this.an.error(t+" preview no found")},o.prototype.setLowStreamParameter=function(e,t){var n=(0,Qi.L)(e,this.an),r=this.gn.checkPreview(n);if(r){var i=r.videoInfo,s=[];for(var c in t)isNaN(+t[c])&&s.push(c);if(s.length)throw new Error('param "'.concat(s.join(","),' type error"'));t.width&&i.width&&Va(i.width)&&t.width>Va(i.width)?this.an.error("zsc.slsp.0 low stream width can not larger than high stream"):t.height&&i.height&&Va(i.height)&&t.height>Va(i.height)?this.an.error("zsc.slsp.0 low stream height can not larger than high stream"):t.frameRate&&i.frameRate&&Va(i.frameRate)&&t.frameRate>Va(i.frameRate)||t.height&&i.bitRate&&t.bitRate>i.bitRate||(r.lowStreamConfig=Object.assign(r.lowStreamConfig,t))}else this.an.error("zsc.slsp.0 preview no found")},o.prototype.setDummyCaptureImagePath=function(e,t){var n=this;return new te.l3(function(r,i){var s=(0,Qi.L)(t,n.an),c=n.gn.checkPreview(s);if(!c)return n.an.error("zc.sdcp.0 preview no found"),void r(!1);if(!(0,R.QP)(e))return n.an.error("zc.sdcp.0 filePath type error"),void r(!1);var u=new Image;u.src=e,u.crossOrigin="anonymous",u.onload=function(){c.loadImgTimer&&clearTimeout(c.loadImgTimer),c.loadImgTimer=void 0,n.an.info("zc.sdcp.0 load file path success"),c.setMuteImage(u),r(!0)},c.loadImgTimer=setTimeout(function(){n.an.error("zc.sdcp.0 load img timeout"),r(!1)},5e3)})},o.prototype.enableAutoSwitchDevice=function(e){this.an.info("zc.easw call. "+JSON.stringify(e)),this.pn.autoSwitchDeviceSetting=Ei({},e)},o.prototype.enableCameraCapturing=function(e,t){return t===void 0&&(t=!0),fo(this,void 0,void 0,function(){var n,r,i,s,c,u;return mo(this,function(l){return this.an.info("zsc.ecc call by user "+t),n=(0,te.fU)(this.cr,E.t0.H,"",k.BY.event,k.oq.event),r=(0,Qi.L)(e,this.an),(i=this.gn.checkPreview(r))?(s=i.videoPreviewType||i.previewType,i.localStream&&i.videoTrack&&s==="camera"?(c=this.gn.getPublishList(r),u=c.map(function(a){return{stream_id:a.streamID}}),(0,te.lA)(n,{enable:k.BY.enable(t),stream_list:k.BY.stream_list(u)}),[2,this.gh.enableCameraCapturing(i,t)]):(this.an.error("zsc.ecc not camera stream"),[2,!1])):(this.an.error("zsc.ecc "+te.h2),this.cr.setError(n,Et.fzq),[2,!1])})})},o.prototype.getStreamStats=function(e){var t,n,r;return this.an.info(ie.Ywv+" call"),(0,R.dr)(e)&&e.getTracks().length>0?r=(t=this.gn.checkPublish(e))===null||t===void 0?void 0:t.publisher:(0,R.QP)(e)&&(r=(n=this.gn.publisherList[e])===null||n===void 0?void 0:n.publisher),r?(r==null?void 0:r.qualityHandler.Wh)||null:(this.an.error("zsc.sp.0 stream is not publishing"),null)},o.prototype.startWaitPublish=function(){var e=this;this.gn.waitPublishList.forEach(function(t){e.gn.startPublishingStream(t)}),this.gn.waitPublishList=[]},o.prototype.deviceInterruptReport=function(e,t,n){var r,i=n==="camera"?k.KZ:k.fF;n==="micro"?r=1:n==="speaker"&&(r=0);var s=(0,te.fU)(this.cr,E.t0.H,"",i.event,k.vW.event),c={changed_type:i.interrupt(e),device:i.device(t.deviceID),device_name:i.device_name(t.deviceName)};(0,R.Cs)(r)&&(c.device_type=r),(0,te.lA)(s,c)},o.prototype.initCopyMusic=function(e){if(this.gn.useCopyMusic&&!isNaN(this.pn.engineConfig.choirRole)){var t=this.gn.checkPreview(e),n=this.pn.roomList[0];if(n){var r=Array.from(new Set(n.streamList.map(function(s){return s.id_name}))),i=r.length+(r.includes(this.gn.userid)?0:1);t&&!t.onlyPreview&&t.setVolumeFactorByUserCount(i)}}},o.prototype.setEmptyAudioTrack=function(e,t){if(this.pn.engineConfig.keepAudioTrack&&e.getAudioTracks().length==0){var n=t.getEmptyAudioTrack();n&&(n.enabled=!1,e.addTrack(n),t&&(t.hasEmptyAudioTrack=!0))}},o.prototype.addShareScreenEnd=function(e){var t=this,n=e.getVideoTracks()[0];n&&(n.onended=function(){var r=t.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.ny.event);r.setAttributes({stop_reason:k.ny.stop_reason("screenSharingEnded")}),e&&t.stopPreview(e),r.end(),t.pn.actionListener("screenSharingEnded",e)})},o.prototype.destroy=function(){te.VJ.removeEventListener("visibilitychange",this.eventHandler.visibilitychange)},o}(),zu=function(){return zu=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},zu.apply(this,arguments)},ep=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},tp=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Gd=k.Nr.event,jd=k.Nr,Wd=function(){function o(e,t,n,r,i){this.an=e,this.dataReport=t,this.pn=n,this.gn=r,this.rtm=i}return Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),o.prototype.startPlayingStream=function(e,t,n){var r=this;return this.an.info(ie.rGc+" playOption: "+JSON.stringify(an(t||{},["CDNVideo","CDNPlayer"]))+" isDataChannel: "+JSON.stringify(!!n),{streamid:e}),new te.l3(function(i,s){return r._handlePlayStream(e,t,i,s,n)})},o.prototype._handlePlayStream=function(e,t,n,r,i){var s,c=this,u=jd,l=function(V,_e){c.an.error(ie.rGc+" "+(_e||V.message));var ke=c.cr.getAPIErrorReport(Gd);ke&&c.cr.takeAPIErrorReport(Gd,V,ke),r&&r(zu(zu({},V),{errorCode:V.code,extendedData:V.message+(_e?" "+_e:"")}))};if(!e)return l(u.error.de),!1;if(!(0,R.QP)(e))return l(u.error.de,"stream id type error"),!1;if(e.length>E.LO)return l(u.error.me,"stream id length limit "+E.LO),!1;if(!(0,te.kP)(e)&&(this.an.warn(ie.rGc+" #invald streamID:".concat(e)),this.pn.isFlutter)||!(0,te.jy)(e))return l(u.error.pe),!1;if(!(0,R.TE)(t)&&!(0,R.w)(t))return l(u.error.ve,"playOption must be object"),!1;if(!(0,R.TE)(t==null?void 0:t.codecTemplateID)&&!Number.isInteger(t==null?void 0:t.codecTemplateID))return l(u.error.ve,"codecTemplateID must be integer "),!1;if((0,R.dd)(t==null?void 0:t.adaptiveSwitch)&&(t!=null&&t.adaptiveSwitch)){if((t==null?void 0:t.resourceMode)!==E.qP.L3)return l(u.error.ve,"adaptiveSwitch only support resourceMode as L3"),!1;if(!(0,R.C9)(t==null?void 0:t.adaptiveTemplateIDList)||(t==null?void 0:t.adaptiveTemplateIDList.length)===0)return l(u.error.ve,"adaptiveTemplateIDList must be array and length > 0"),!1}var a=this.gn.maxChannels;if((0,R.Cs)(a)&&Object.keys(this.gn.playerList).length>=a){var h=Object.values(this.gn.playerList).filter(function(V){return(V==null?void 0:V.isProbe)===!1}).length;if(h>=a)return this.an.error("zsc.pss.1 play streams is out limit "+h+" "+a),l(u.error.Ne),!1}var m=Tn(this.pn.appid,this.pn.idName,e),S=((s={})["_play_"+e]={stream_sid:m},s);if(this.cr.setPublicPros(S),this.pn.playAccelerate&&this.pn.roomList.length>0)this.an.info(ie.rGc+" play accelerate");else if(this.rtm.isDisConnect())return l(u.error.ge),!1;this.pn.pullLimited||(e=NaN+e),t&&t.videoCodec&&(t.videoCodec=t.videoCodec.toUpperCase());var x=this.pn.settingConfig.getSetting("resource_mode",!0);x!==void 0&&(this.an.info(ie.rGc+" setting resource_mode "+x),!t&&(t={}),t.resourceMode=x);var q=this.gn.setPlayStateStart(e,t,m,i);return q!==!0?(l(JSON.parse(JSON.stringify(q)),"cannot start play"),!1):(this.gn.onPlayStateUpdate(E.h7.retry,e,{code:0,message:""}),this.gn.playSuccessCallBackList[e]=function(V){n&&n(V)},r&&(this.gn.playErrorCallBackList[e]=r),this.pn.appConfig?(this.gn.startPlayingStream(e),!0):(this.gn.waitPlayList.push(e),!0))},o.prototype.setPlayStreamVideoType=function(e,t){var n=this;return new Promise(function(r,i){return ep(n,void 0,void 0,function(){var s,c;return tp(this,function(u){switch(u.label){case 0:if(s=ei(this.an,e),!(0,R.QP)(e)||e==="")return s.error(ie.dk2+" streamid must be string and not empty"),i(!1),[2];if(!(c=this.gn.playerList[e]))return s.error(ie.dk2+" player not exist"),i(!1),[2];if(![0,1,2].includes(t))return s.error(ie.dk2+" streamType must be number 0 or 1 or 2"),i(!1),[2];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,c.setPlayStreamVideoType(t)];case 2:return u.sent().result===0?r(!0):i(!1),[3,4];case 3:return u.sent(),i(!1),[3,4];case 4:return[2]}})})})},o.prototype.stopPlayingStream=function(e,t,n){var r,i,s=ei(this.an,e);s.info(ie.dk2+" call");var c=this.cr.createSpan(E.t0.I,{key:k.vW.event},{key:""},k.oI.event);if(!(0,R.QP)(e)||e==="")return s.error(ie.dk2+" streamid must be string and not empty"),this.cr.setError(c,k.oI.error.wn,"stream id type error"),void delete this.pn.reportSeqList.stopPlay[e];var u=this.gn.playerList[e];c.setAttributes({stream_id:k.oI.stream_id(e),room_id:k.oI.room_id((r=this.gn.playerList[e])===null||r===void 0?void 0:r.room.roomID),webrtc_sid:k.oI.webrtc_sid(u==null?void 0:u.sessionId),stream_sid:k.oI.stream_sid(u==null?void 0:u.streamSid),biz_product:u&&((i=u.playOption)===null||i===void 0?void 0:i.resourceMode)==E.qP.DG?1:0});var l=u&&(u==null?void 0:u.curCBState.state)!=="NO_PLAY";n&&!t&&(u==null?void 0:u.state)!==6&&(t=jd.error.De);var a=[1,3].includes(u==null?void 0:u.resourceMode)&&(u==null?void 0:u.playMode)===E.ey.CDN;for(var h in this.gn.stopPlayingStream(e,t),this.pn.streamUrlMap)if(this.pn.streamUrlMap[h]===e){delete this.pn.streamUrlMap[h];break}t?this.cr.setError(c,t):c.end(),l&&this.gn.onPlayStateUpdate(E.h7.error,e,t||{code:0,message:""},{isCDN:a}),s.debug(ie.dk2+" call success")},o.prototype.stopPlayingStreamInRoom=function(e){for(var t in this.an.info(ie.V9q+" call "+e),this.gn.playerList)this.gn.playerList[t].room.roomID===e&&this.stopPlayingStream(t)},o.prototype.setStreamAudioOutput=function(e,t){var n=this;return!(t==null||t.length==0||!e)&&(this.an.debug("zsc.ssao.0 device "+t),e?e.sinkId!=="undefined"?(e.setSinkId(t).then(function(){n.an.info("zsc.ssao.0 success device: "+t)}).catch(function(r){n.an.info("zsc.ssao.0 "+r.name)}),!0):(this.an.error("zsc.ssao.0 browser does not suppport"),!1):(this.an.error("zsc.ssao.0 no localVideo"),!1))},o.prototype.startWaitPlay=function(){var e=this;this.gn.waitPlayList.forEach(function(t){e.gn.startPlayingStream(t)}),this.gn.waitPlayList=[]},o.prototype.setPlayerListForbid=function(e){var t=this;e.forEach(function(n){var r=n.stream_attr_opts,i=t.gn.playerList[n.streamID];r&&(i==null||i.setMuteStreamByPlayMode(r))})},o.prototype.getStreamStats=function(e){var t,n;return this.an.info(ie.bp1+" call"),(0,R.QP)(e)&&(n=this.gn.playerList[e]),n&&(!((t=n==null?void 0:n.qualityHandler)===null||t===void 0)&&t.Wh)?n.qualityHandler.Wh||null:(this.an.error("zsc.sp.0 stream is not playing"),null)},o.prototype.mutePlayStreamVideo=function(e,t){(0,te.rA)(this.an,ie.OYv,e+" "+t);var n=this.cr.createSpan(E.t0.H,{key:k.Nr.event,par:e},{key:""},k.w_.event);n.setAttributes({mute_type:k.w_.mute_type(t?1:0)});var r=this.mutePlayStream(e,"video",t);return n.end(),this.an.info(ie.OYv+" end"),r},o.prototype.mutePlayStreamAudio=function(e,t){(0,te.rA)(this.an,ie.x_Q,e+" "+t);var n=this.cr.createSpan(E.t0.H,{key:k.Nr.event,par:e},{key:""},k.lZ.event);n.setAttributes({mute_type:k.lZ.mute_type(t?1:0)});var r=this.mutePlayStream(e,"audio",t);return n.end(),this.an.info(ie.x_Q+" end"),r},o.prototype.muteAllPlayAudioStreams=function(e){var t=this;return(0,te.rA)(this.an,ie.fcT," "+e),new Promise(function(n,r){if(typeof e!="boolean")return t.an.error(ie.fcT+" mute should be a boolean type"),void r(!1);var i=Object.keys(t.gn.playerList),s=[];if(!t.gn.playModule)return t.an.info(ie.fcT+" cannot find play module."),void r(!1);t.gn.defaultAudioMuted=e,t.an.info(ie.fcT+" "+"mute ".concat(e," streamid ").concat(JSON.stringify(i)));for(var c=0,u=i;c<u.length;c++)s.push(t.mutePlayStreamAudio(u[c],e));Promise.all(s).then(function(l){t.an.info(ie.fcT+" "+"mute ".concat(e," all audio success")),n(!0)}).catch(function(l){t.an.error(ie.fcT+" mute: "+e+" error catch: "+l),r(!1)})})},o.prototype.muteAllPlayVideoStreams=function(e){var t=this;return(0,te.rA)(this.an,ie.Y9k," "+e),new Promise(function(n,r){if(typeof e!="boolean")return t.an.error(ie.Y9k+" mute should be a boolean type"),void r(!1);var i=Object.keys(t.gn.playerList),s=[];if(!t.gn.playModule)return t.an.info(ie.Y9k+" cannot find play module."),void r(!1);t.gn.defaultVideoMuted=e,t.an.info(ie.Y9k+" "+"mute ".concat(e," streamid ").concat(JSON.stringify(i)));for(var c=0,u=i;c<u.length;c++)s.push(t.mutePlayStreamVideo(u[c],e));Promise.all(s).then(function(l){t.an.info(ie.Y9k+" "+"mute ".concat(e," all audio success")),n(!0)}).catch(function(l){t.an.error(ie.Y9k+" mute: "+e+" error catch: "+l),r(!1)})})},o.prototype.mutePlayStream=function(e,t,n,r){var i=this;return r===void 0&&(r=!0),this.an.info("zsc.mps.0 call "+t+" "+n),new te.l3(function(s,c){if(!(0,R.QP)(e)||e=="")return i.an.error("zsc.mps.0 streamID must be string and not empty"),void c(!1);if(!(0,R.dd)(n))return i.an.error("zsc.mps.0 mute must be boolean"),void c(!1);var u=i.gn.playerList[e];if(!u)return i.an.error("zsc.mps.0 player not found"),void c(!1);if(t==="video"){if(u.playOption&&u.playOption.video===!1)return i.an.error("zsc.mps.0 stream no contain video"),void c(!1);if(r&&(u!=null&&u.isServerMuteVideo))return i.an.error("zsc.mps.0 stream ".concat(e," has forbid video")),void c(!1);if(u.playMode===E.ey.CDN)return i.an.info("zsc.mps.0 stream ".concat(e," cdn mute video ").concat(n)),void(u.playMediaStatus.video=!n);u.ActivatePlayVideoStream(n,function(){var l,a;i.an.info("zsc.mps.0 suc"),u.playMediaStatus.video=!n;var h=k.es,m=i.cr.createSpan(E.t0.H,{key:k.Nr.event,par:e},{key:""},h.event);m.setAttributes({webrtc_sid:h.webrtc_sid(u.sessionId),video_activate:h.video_activate(!!u.playMediaStatus.video),audio_activate:h.audio_activate(!!u.playMediaStatus.audio),video_layer:h.video_layer(((l=u==null?void 0:u.playOption)===null||l===void 0?void 0:l.streamType)===2?-1:(a=u==null?void 0:u.playOption)===null||a===void 0?void 0:a.streamType)}),m.end(),u.handleVideoTrackForPlaying(),s(!0)},function(){i.an.error("zsc.mps.0 fail"),c(!1)})}else if(t==="audio"){if(u.playOption&&u.playOption.audio===!1)return i.an.error("zsc.mps.0 stream no contain audio"),void c(!1);if(r&&(u!=null&&u.isServerMuteAudio))return i.an.error("zsc.mps.0 stream ".concat(e," has forbid audio")),void c(!1);if(u.playMode===E.ey.CDN)return i.an.info("zsc.mps.0 stream ".concat(e," cdn mute audio ").concat(n)),void(u.playMediaStatus.audio=!n);u.ActivatePlayAudioStream(n,function(){i.an.info("zsc.mps.0 suc"),u.playMediaStatus.audio=!n;var l=k.es,a=i.cr.createSpan(E.t0.H,{key:k.Nr.event,par:e},{key:""},l.event);a.setAttributes({webrtc_sid:l.webrtc_sid(u.sessionId),video_activate:l.video_activate(!!u.playMediaStatus.video),audio_activate:l.audio_activate(!!u.playMediaStatus.audio)}),a.end(),s(!0)},function(){i.an.error("zsc.mps.0 fail"),c(!1)})}else c(!1)})},o}(),np=function(){function o(e,t,n,r){this.gn=e,this.pn=t,this.an=n,this.rtm=r}return Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),o.prototype.setStreamExtraInfo=function(e,t){var n=this;return new te.l3(function(r,i){var s=n.gn.getRoomByStreamID(e),c=k.Fv,u=n.cr.createSpan(Te.t0.H,s?{key:k.B$.event,par:s==null?void 0:s.roomID}:{key:k.oq.event},{key:""},c.event);u.setAttributes({stream_id:c.stream_id(e),stream_extra_info:c.stream_extra_info(t)});var l=function(a,h){h===void 0&&(h=""),n.an.error("zb.ssei "+h),n.cr.setError(u,a,h),i({errorCode:a.code,extendedData:a.message+" "+h})};(0,R.QP)(e)&&e!=""?(0,R.QP)(t)?t.length!==0?t.length>E.uv?l(c.error._zpg_kExtraInfoTooLong):n.rtm.isDisConnect()?l(c.error.Ue):n.pn.publishStreamList[e]?s?s.streamHandler.setStreamExtraInfo(e,t,function(a,h){var m,S,x,q;if(((m=a==null?void 0:a.body)===null||m===void 0?void 0:m.err_code)===0||(a==null?void 0:a.errorCode)===0)u.setAttributes({send_seq:c.send_seq(h)}),u.end(),r({errorCode:((S=a==null?void 0:a.body)===null||S===void 0?void 0:S.err_code)===0?(x=a==null?void 0:a.body)===null||x===void 0?void 0:x.err_code:a==null?void 0:a.errorCode,extendedData:""});else{var V={errorCode:((q=a==null?void 0:a.body)===null||q===void 0?void 0:q.err_code)||(a==null?void 0:a.code)};n.cr.setError(u,V),i(V)}},l):l(c.error.Ue):l(c.error.Be):l(c.error._zpg_kExtraInfoNull):l(c.error.wn," extraInfo must be string"):l(c.error.wn," streamID must be string and not empty")})},o}(),Vu=function(){return Vu=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},Vu.apply(this,arguments)},Qd=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Jd=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},ga=k.zF,Kd=k.Nr.event,Fu=k.Nr.error,qu=k.Og.error,Lc=function(){function o(e,t,n,r,i,s,c){var u=this;this.an=e,this.dataReport=t,this.pn=n,this.gn=r,this.rtm=i,this.ac=s,this.zegoWebRtc=c,this.beforeunloadListener=function(){u.logger.stopStorageLog();for(var l=0;l<u.gn.previewStreamList.length;l++)u.gn.previewStreamList[l].stopPreview();u.gn.previewStreamList=[]},this.pagehideListener=function(){for(var l in window.event&&(window.event.cancelBubble=!0),u.gn.publisherList)u.publishModule.stopPublishingStream(l);for(var l in u.gn.playerList)u.playModule.stopPlayingStream(l)},this.messageListener=function(l){var a=l.data,h=a.type;h==="SS_DIALOG_SUCCESS"&&u.screenStreamFrom(a.streamId,a.canRequestAudioTrack,X("screenShare",u.pn.callbackList)),h==="SS_DIALOG_CANCEL"&&X("screenShare",u.pn.callbackList)(!1,null,h)},this.offlineListener=function(){for(var l in u.an.info("zc.off.0 "+te.Rl),u.pn.networkState=E.D2.offline,u.gn.publisherList)u.gn.stopNetProbe(u.gn.publisherList[l].publisher);for(var l in u.gn.playerList){var a=u.gn.playerList[l];a.playMode==E.ey.CDN&&a.zegoCdnPlayer&&(a.zegoCdnPlayer.canRetry=!1),u.gn.stopNetProbe(a)}},this.onlineListener=function(l){for(var a in u.an.info("zc.on.0 network is online"),u.pn.networkState=E.D2.online,u.gn.publisherList){var h=u.gn.publisherList[a].publisher,m=u.gn.publisherList[a].retryStreamHandler;h.state==7||h.stateNego==se.stop||h.iceStateDisConnect?!m.isOverTime&&m.publishStateHandle(E.eZ.error,a,qu.xn):h.state==6&&m.stopMaxTime()}for(var a in u.gn.playerList){var S=u.gn.playerList[a],x=S.playMode,q=(m=S.retryStreamHandler,S.zegoCdnPlayer);x==E.ey.CDN&&q&&(q.canRetry=!1),S.state==7||x!==E.ey.CDN&&(S.stateNego==0||S.iceStateDisConnect)?!m.isOverTime&&m.playStateHandle(E.h7.error,a,Fu.Se):S.state==6&&m.stopMaxTime()}},this.visibilitychangeListener=function(l){var a="";a=te.VJ.visibilityState==="visible"?"foreground":"background";var h=u.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.E$.event);h.setAttribute("state",k.E$.state(a)),h.end()},this.safariPagehideListener=function(l){var a=u.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.E$.event);a.setAttribute("state",k.E$.state("background")),a.end()},this.safariPageshowListener=function(l){var a=u.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.E$.event);a.setAttribute("state",k.E$.state("foreground")),a.end()},this.publishModule=new Hd(this.an,this.dataReport,this.pn,this.gn,this.rtm,this.zegoWebRtc),this.playModule=new Wd(this.an,this.dataReport,this.pn,this.gn,this.rtm),this.gn.playModule=this.playModule,this.initAdvance(),this.streamCommon=new np(r,n,e,i),this.initStreamCDN(),this.initAudioMix(),this.pn.appConfig=this.rtm.getAppConfig(),this.init()}return Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"logger",{get:function(){return this.an},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"stateCenter",{get:function(){return this.pn},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"streamCenter",{get:function(){return this.gn},enumerable:!1,configurable:!0}),o.prototype.init=function(){var e=this;this.bindWindowListener(),this.bindRTMListener(),this.bindStreamCenterHandler(),this.bindEngineDestroyListener(),this.bindListener("_engineConfigUpdate",function(t){isNaN(t.choirRole)||e.updatePreviewerVolumeFactor()})},o.prototype.initAudioMix=function(){},o.prototype.initAdvance=function(){},o.prototype.initStreamCDN=function(){},o.prototype.bindWindowListener=function(){var e=(0,Vn.$t)(),t=e.match(/iPad/i)||e.match(/iPhone/i)?"pagehide":this.pn.browser==="firefox"?"beforeunload":"unload";window.addEventListener("beforeunload",this.beforeunloadListener),window.addEventListener(t,this.pagehideListener),window.addEventListener("message",this.messageListener),window.addEventListener("offline",this.offlineListener),window.addEventListener("online",this.onlineListener),te.VJ.addEventListener("visibilitychange",this.visibilitychangeListener),(0,Vn.nr)()&&(window.addEventListener("pagehide",this.safariPagehideListener),window.addEventListener("pageshow",this.safariPageshowListener))},o.prototype.offWindowListner=function(){var e=(0,Vn.$t)(),t=e.match(/iPad/i)||e.match(/iPhone/i)?"pagehide":this.pn.browser==="firefox"?"beforeunload":"unload";window.removeEventListener("beforeunload",this.beforeunloadListener),window.removeEventListener(t,this.pagehideListener),window.removeEventListener("message",this.messageListener),window.removeEventListener("offline",this.offlineListener),window.removeEventListener("online",this.onlineListener),te.VJ.removeEventListener("visibilitychange",this.visibilitychangeListener),(0,Vn.nr)()&&(window.removeEventListener("pagehide",this.safariPagehideListener),window.removeEventListener("pageshow",this.safariPageshowListener))},o.prototype.bindEngineDestroyListener=function(){var e=this;this.pn.listenerList._engineDestroy.push(function(){e.offWindowListner()})},o.prototype.bindRTMListener=function(){var e=this;this.rtm._on("_settingCanFetch",function(t){return Qd(e,void 0,void 0,function(){var n,r,i;return Jd(this,function(s){return this.an.info("zc.scf stream config "+JSON.stringify(t).length),t&&(this.pn.settingConfig.setSetting(t.setting),!((r=t.setting)===null||r===void 0)&&r.open_mini_sdp&&(n=this.pn.settingConfig.getSetting("open_mini_sdp"),(i=this.gn)===null||i===void 0||i.initMiniSdpWorker(n))),[2]})})}),this.rtm._on("_appConfigRsp",function(){e.an.info("zc.acr call ");var t=!e.pn.appConfig;e.pn.appConfig=e.rtm.getAppConfig(),e.an.info("zc.acr appConfig ".concat(JSON.stringify(e.pn.appConfig))),t&&(e.gn.reConnectSignals(),e.publishModule.startWaitPublish(),e.playModule.startWaitPlay())}),this.rtm._on("_netAppConfigRsp",function(t){e.pn.netAppConfig=t,e.pn.supportBg=e.checkBackgroundCapacity()}),this.rtm._on("_roomLogin",function(t,n){var r;e.pn.appid=e.rtm.getAppID(),e.pn.idName=e.rtm.getUserID(),e.pn.nickName=e.rtm.getUserName(),e.pn.testEnvironment=e.rtm.isTestEnvironment(),e.pn.isMultiRoom=e.rtm.getMultiRoom(),e.gn.setSessionInfo(e.pn.appid,e.pn.idName,e.pn.testEnvironment);var i=e.pn.getRoomByRoomID(t);if(!i){var s=new Nc(e.an,e.pn,e.rtm,e.gn,t);e.bindStreamHandler(s),e.pn.roomList.push(i={roomID:t,streamHandler:s,sessionID:"",roomSessionID:"",token:n,isResetRoom:!1,streamList:[],streamInfoList:[],dataChannelManager:null});var c=e.pn.au("connect_media_in_advance",!0),u=e.pn.au("connect_media_in_advance");((r=c??e.pn.engineConfig.connectMediaServerInAdvance)!==null&&r!==void 0?r:u)&&e.gn.connectWebRTCCenterServer(!0,!0,t,n)}}),this.rtm._on("roomLoginResponse",function(t){return Qd(e,void 0,void 0,function(){var n,r,i,s,c,u;return Jd(this,function(l){return this.an.info("zc.rlr call "+JSON.stringify(t)),n=t.header.room_id||t.body.room_id,this.pn.appConfig=this.rtm.getAppConfig(),r=this.rtm.getToken(n),i=this.rtm.getSessionId(n),s=this.rtm.getRoomSessionID(n),(c=this.pn.getRoomByRoomID(n))||(u=new Nc(this.an,this.pn,this.rtm,this.gn,n),this.bindStreamHandler(u),this.pn.roomList.push(c={roomID:n,streamHandler:u,sessionID:i,roomSessionID:s,token:r,isResetRoom:!1,streamList:[],streamInfoList:[],dataChannelManager:null})),c.sessionID=i,c.roomSessionID=s,t.body.stream_fetch_flag===1?(this.an.info("zc.rlr stream fetch "+n),c.streamHandler.room=c,c.streamHandler.fetchStreamList(),[2]):(c.streamHandler.handleStreamStart(t,c),this.gn.checkStreamReport(),this.an.info("zc.rlr end "+n),[2])})})}),this.rtm._on("HBResponse",function(t,n){var r,i=(r=t==null?void 0:t.header)===null||r===void 0?void 0:r.room_id,s=e.pn.getRoomByRoomID(i||n);s==null||s.streamHandler.patchStreamList(t)}),this.rtm._on("_roomStateUpdate",function(t,n,r,i,s,c){if(n==="CONNECTED"&&e.gn.billingTimer.startChargeInfosUpload(),n=="DISCONNECTED"){e.an.info("zc.rsu "+t+" disconnected "+(r?r+" ":"")+(i||"")),e.gn.billingTimer.stopChargeInfosUpload();var u=e.pn.getRoomByRoomID(t);if(u){var l=e.pn.roomList.findIndex(function(a){return a.roomID==t});u.isResetRoom=!0,u.streamHandler.reset(),u.dataChannelManager&&e.zegoWebRtc.destroyRealTimeSequentialDataManager(u.dataChannelManager),c||e.gn.reset(t,r),e.pn.roomList.splice(l,1)}if(c&&Object.keys(e.streamCenter.playerList).length>0)return;e.gn.disconnectAllSignal()}else e.an.info("zc.rsu "+t+" state: "+n)}),this.rtm._on("_tokenRenewed",function(t,n){e.an.info("zc.tr roomID:"+n),e.an.remoteReport("zc.tr token:"+t);var r=e.pn.getRoomByRoomID(n);r&&(r.token=t)}),this.rtm._on("_stopStream",function(t,n){t.forEach(function(r){e.publishModule.stopPublishingStream(r,n)})}),this.rtm._on("_userTransUpdate",function(t,n,r){var i=e.pn.getRoomByRoomID(t);i?n==="pushstatus"||n==="mixpushstatus"&&i.streamHandler.getMixStreamStatus(r):e.an.error(ie.KY4+" room no found")}),this.rtm._on("_uaHeartBeatTimeout",function(){var t;e.an.info("zc.ohbto rtc in use: "+e.streamCenter.useingUdp),e.streamCenter.useingUdp||(t=e.rtm.netAgent)===null||t===void 0||t.reconnectUA()}),this.rtm.liveRoomHandler&&(this.rtm.liveRoomHandler.handlePushStreamMsg=function(t){t.body.stream_cmd=t.header.sub_cmd,t.body.stream_info=t.body.stream_info_list,delete t.body.stream_info_list,e.handlePushStreamMsg(t)})},o.prototype.handlePushStreamMsg=function(e){var t,n=((t=e==null?void 0:e.header)===null||t===void 0?void 0:t.room_id)||"",r=this.pn.getRoomByRoomID(n),i=this.rtm.getMsgSpan(k.MJ.event,n);if(!r)return this.cr.setError(i,k.MJ.error.Le),void this.an.error(ie.kc8+" room no found");var s="";switch(e.body.stream_cmd){case E.EN.added:s="add";break;case E.EN.deleted:s="delete";break;case E.EN.updated:s="update"}var c=e.body.stream_info.map(function(u){return{stream_id:u.stream_id,stream_extra_info:u.extra_info,id_name:u.id_name||u.anchor_id_name}});i.setAttributes({stream_update_type:k.MJ.stream_update_type(s),stream_seq:e.body.stream_seq,stream_list:k.MJ.stream_list(c)}),i.end(),r.streamHandler.handlePushStreamUpdateMsg(e)},o.prototype.bindStreamCenterHandler=function(){var e=this;this.gn.onPlayStateUpdate=function(t,n,r){var i,s=ei(e.an,n);s.info("zc.opsu.1 ".concat(t));var c=e.gn.playerList[n];c&&(t!=0&&t!=1||(c.retryStreamHandler.streamRetryStartTime=0,c.uploadPlayEvent(r)),[0,Fu.De.code].includes(r==null?void 0:r.code)||(c.latestPlayErrCode=r.code),!c.isProbe&&c.$h&&(t==1&&r&&c.$h.setAttributes({error:r.code,message:r.message}),(t===0||t===2&&r.code!==0)&&c.reportMiniSdpInfos(),t!==0&&((0,te.lA)(c.$h,{url:ga.url((i=c.signal)===null||i===void 0?void 0:i.server),ip:ga.ip(c.ip),peer_id:ga.peer_id(c.peerID),source_type:ga.source_type(c.playMode),net_protocol:ga.net_protocol(c.netProtocol),signal_consume:ga.signal_consume(c.signalTime),tryidx:ga.tryidx(c.tryidx)}),c.$h=void 0)));var u=Date.now();if(t==0?(c.pulledTimeStamp=u,c.updateCDNValidTime()):t==1&&c&&(c.endPlayingSpan({stop_reason:c.stopReason}),c.stopReason=""),t===1&&e.gn.playErrorCallBackList[n]){s.info("zc.opsu.1 connect changed");var l=r&&(r.code==Fu.De.code?0:r.code);e.gn.playErrorCallBackList[n]({errorCode:l||0,extendedData:l?r.message:""}),delete e.gn.playErrorCallBackList[n],s.info("zc.opsu.1 stop play called by sdk"),e.playModule.stopPlayingStream(n,r)}else{t===0?c.firstPulledTimeStamp==0&&(c.firstPulledTimeStamp=u):c&&c.pulledTimeStamp&&c.updateValidTime(r);var a=function(m){return m==0||m==1?m==0?"PLAYING":"NO_PLAY":"PLAY_REQUESTING"}(t),h=t===1||(c==null?void 0:c.updateCBState({state:a,code:r.code}));r.code===Fu.De.code&&(r={code:0,message:""}),h&&e.pn.actionListener("playerStateUpdate",{state:a,streamID:n,errorCode:r&&r.code,extendedData:r&&r.message})}},this.gn.onPublishStateUpdate=function(t,n,r){e.onPublishStateUpdateHandle(t,n,r)},this.gn.onPublishQualityUpdate=function(t,n){e.pn.actionListener("publishQualityUpdate",t,n)},this.gn.onPlayQualityUpdate=function(t,n){e.pn.actionListener("playQualityUpdate",t,n)},this.gn.onRemoteCameraStatusUpdate=function(t,n,r){var i=e.cr.createSpan(E.t0.H,{key:Kd,par:t},{key:""},k.We.event);i.setAttributes({stream_id:k.We.stream_id(t),camera_status:k.We.camera_status(n),status_code:k.We.status_code(r)}),i.end(),e.pn.actionListener("remoteCameraStatusUpdate",t,n),e.pn.actionListener("_remoteCameraStatusUpdate",t,r)},this.gn.onRemoteMicStatusUpdate=function(t,n,r){var i=e.cr.createSpan(E.t0.H,{key:Kd,par:t},{key:""},k.ov.event);i.setAttributes({stream_id:k.ov.stream_id(t),mic_status:k.ov.mic_status(n),status_code:k.ov.status_code(r)}),i.end(),e.pn.actionListener("remoteMicStatusUpdate",t,n),e.pn.actionListener("_remoteMicStatusUpdate",t,r)},this.gn.onSoundLevelUpdate=function(t){e.pn.actionListener("soundLevelUpdate",t)},this.gn.onMicSoundLevelUpdate=function(t){e.pn.actionListener("capturedSoundLevelUpdate",t)}},o.prototype.bindStreamHandler=function(e){var t=this;e.onStreamUpdated=function(n,r,i){var s=i.map(function(a){return{streamID:a.streamID,user:a.user,extraInfo:a.extraInfo,urlsFLV:a.urlFlv,urlsRTMP:a.urlRtmp,urlsHLS:a.urlHls,urlsHttpsFLV:a.urlHttpsFlv,urlsHttpsHLS:a.urlHttpsHls}}),c={};if(r===0){var u=i.map(function(a){return{stream_id:a.streamID,code:Me[a.closeType]&&Me[a.closeType].code||0,description:Me[a.closeType]&&Me[a.closeType].description||"unknown"}});c.stream_delete_reason=u}if(r===0?s=s.filter(function(a){var h,m=!t.pn.publishStreamList[a.streamID];return m&&((h=t.streamCenter.playerList[a.streamID])===null||h===void 0||h.setStreamUpdate(0)),m}):r===1&&s.forEach(function(a){var h;(h=t.streamCenter.playerList[a.streamID])===null||h===void 0||h.setStreamUpdate(1)}),t.updatePreviewerVolumeFactor(n),s.length>0&&t.pn.actionListener("roomStreamUpdate",n,function(a){return a==0?"DELETE":"ADD"}(r),s,Object.keys(c).length>0?JSON.stringify(c):""),i.length>0&&t.pn.actionListener("_streamUpdated",r,i),r===1){var l=[];s.forEach(function(a){a.extraInfo&&l.push({streamID:a.streamID,user:a.user,extraInfo:a.extraInfo})}),l.length>0&&t.pn.actionListener("streamExtraInfoUpdate",n,l)}},e.onPublishStateUpdate=function(n,r,i,s){var c,u,l,a,h,m,S,x,q;t.an.info("zb.opsu ".concat(n," ").concat(JSON.stringify(i)," ").concat(JSON.stringify(s),"}"),{streamid:r});var V=t.gn.publisherList[r],_e=V&&V.publisher;if(_e){var ke=V.publisher.isRePublish?k.fo:k.ch,Pe=k.ch;n!=0&&n!=1||(V.retryStreamHandler.streamRetryStartTime=0,_e.uploadPublishEvent(i)),[0,qu.ce.code].includes(i==null?void 0:i.code)||(_e.latestPublishErrCode=i.code),n===2&&i.code!==0&&_e.reportMiniSdpInfos(),n!==0&&t.cr.spanEnd({key:ke.event,par:r},{error:i.code,message:i.message,url:Pe.url((u=(c=V==null?void 0:V.publisher)===null||c===void 0?void 0:c.signal)===null||u===void 0?void 0:u.server),ip:Pe.ip((l=V==null?void 0:V.publisher)===null||l===void 0?void 0:l.ip),peer_id:Pe.peer_id((a=V==null?void 0:V.publisher)===null||a===void 0?void 0:a.peerID),source_type:Pe.source_type("rtc"),net_protocol:Pe.net_protocol((h=V==null?void 0:V.publisher)===null||h===void 0?void 0:h.netProtocol)})}var Oe=k.Jv,Ge=Date.now();if(_e){var Je=_e.publishedTimeStamp;n!=0&&Je&&(i&&i.code&&i.code!==qu.ce.code&&_e.errorTimes++,_e.validPublishedTime=Ge-Je,_e.publishedTimeStamp=0),n==0?(_e.firstPublishedTimeStamp==0&&(_e.firstPublishedTimeStamp=Ge),_e.publishedTimeStamp=Ge):n==1&&(i.code===1012?(t.gn.stopPublishingStream(r,i),i=Vu(Vu({},i),{code:Et.pn5.code})):i.code===2002&&(t.gn.stopPublishingStream(r,i),i.code=Et.HED.code),_e.uploadRTCPublishStats(),t.cr.spanEnd({key:Oe.event,par:r},{tryidx:Oe.tryidx(_e.rtcPublishCount),url:Oe.url((m=_e==null?void 0:_e.signal)===null||m===void 0?void 0:m.server),ip:Oe.ip(_e==null?void 0:_e.ip),dispatch_external_ip:Oe.dispatch_external_ip(t.pn.clientIP),room_id:Oe.room_id((S=V==null?void 0:V.room)===null||S===void 0?void 0:S.roomID),room_sid_string:Oe.room_sid_string((x=V==null?void 0:V.room)===null||x===void 0?void 0:x.roomSessionID),resource_type:Oe.resource_type("rtc"),protocol:Oe.protocol("webrtc"),net_protocol:Oe.net_protocol(_e.netProtocol),stop_reason:Oe.stop_reason(_e.stopReason),error:i.code,message:i.message}),V&&(_e.stopReason=""))}i.code===qu.ce.code&&(i={code:0,message:""});var tt=function(ut){return ut==0||ut==1?ut==0?"PUBLISHING":"NO_PUBLISH":"PUBLISH_REQUESTING"}(n);(n===1||!((q=V==null?void 0:V.publisher)===null||q===void 0)&&q.updateCBState({state:tt,code:i.code}))&&t.pn.actionListener("publisherStateUpdate",{state:tt,streamID:r,errorCode:i.code,extendedData:s||i.message})},e.onStreamExtraInfoUpdated=function(n,r){var i=r.map(function(s){return{streamID:s.streamID,user:s.user,extraInfo:s.extraInfo}});t.pn.actionListener("streamExtraInfoUpdate",n,i)},e.onStreamAttrUpdated=function(n,r){t.playModule&&t.playModule.setPlayerListForbid(r)}},o.prototype.updatePreviewerVolumeFactor=function(e){var t=this;if(this.gn.useCopyMusic&&!isNaN(this.pn.engineConfig.choirRole)){this.an.info("zc.rtc.upvf "+e);var n=[];if(e){var r=this.pn.getRoomByRoomID(e);r&&n.push(r)}else n.push.apply(n,this.pn.roomList);n.forEach(function(i){var s=Array.from(new Set(i.streamList.map(function(c){return c.id_name})));t.gn.previewStreamList.forEach(function(c){c&&!c.onlyPreview&&c.setVolumeFactorByUserCount(s.length)})})}},o.prototype.screenStreamFrom=function(e,t,n){var r=this,i={};i.audio={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e}},i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxWidth:window.screen.width,maxHeight:window.screen.height}},!t&&(i.audio=!1),navigator.mediaDevices.getUserMedia(i).then(function(s){s.getTracks().forEach(function(c){return rn(c,r.an,"zc.st.ssf")}),n(!0,s)}).catch(function(s){n(!1,null,s)})},o.prototype.onPublishStateUpdateHandle=function(e,t,n){var r=this,i=ei(this.an,t);i.info("zc.opsuh.0 call");var s=this.gn.publisherList[t],c=s.room;if(c)if(e==0){var u=this.pn.publishStreamList[t];if(u){var l=!c.streamList.find(function(a){return a.stream_id==t&&(a.anchor_id_name==r.pn.idName||a.id_name==r.pn.idName||a.user_id===r.pn.idName)});i.info("zc.opsuh.0 room stream "+l),[E.T_.tryPublish,E.T_.retryPublish].includes(u.state)&&l?(u.state=E.T_.update_info,c.streamHandler.updateStreamInfo(t,E.NP.liveBegin,u.extra_info,function(a){},void 0,s.publisher.getStreamAddOptions())):(i.info("zc.opsuh.0 stream update"),u.state=E.T_.publishing,this.WebrtcOnPublishStateUpdateHandle(e,t,n))}}else c.streamHandler.onPublishStateUpdate(e,t,n),e==1&&(i.info("zc.opsuh.0 stop publish called by sdk"),this.publishModule.stopPublishingStream(t,n));else i.error("zc.opsuh.0 "+te.fT)},o.prototype.WebrtcOnPublishStateUpdateHandle=function(e,t,n){if(this.pn.publishStreamList[t].state==E.T_.publishing){var r=this.gn.getRoomByStreamID(t);r&&r.streamHandler.onPublishStateUpdate(e,t,n)}},o.prototype.bindListener=function(e,t){return this.pn.addListener(e,t)},o.prototype.deleteListener=function(e,t){return this.pn.deleteListener(e,t)},o.prototype.checkBackgroundCapacity=function(){if(this.pn.netAppConfig){var e=this.pn.netAppConfig.media_config.publish_config.object_segmentation_platform;return!!e&&!!fn(e,0)}return!0},o}(),Yd=function(){function o(e,t){t===void 0&&(t=!1),this.view=e,this.isH265=t,this.offset=0,this.current_start_code_size=0,this.current_nalu_start=0,this.current_nalu_size=0,this.start_code_size=0,this.nalu_start=0,this.left_size=0,this.nalu_size=0,this.left_size=e.byteLength}return o.prototype.FindStartCode=function(){var e=this.view.byteLength-this.offset;for(this.current_start_code_size=0,this.current_nalu_start=-1;e>=3;){if(this.view.getUint8(this.offset)==0&&this.view.getUint8(this.offset+1)==0&&this.view.getUint8(this.offset+2)==1)return this.current_start_code_size=3,this.current_nalu_start=this.offset,this.offset-1>=0&&this.view.getUint8(this.offset-1)==0&&(++this.current_start_code_size,--this.current_nalu_start),this.offset+=3,!0;--e,++this.offset}return!1},o.prototype.FindNalu=function(){return this.start_code_size=0,this.nalu_start=0,this.nalu_size=0,!(this.offset>=this.view.byteLength)&&!!this.FindStartCode()&&(this.start_code_size=this.current_start_code_size,this.nalu_start=this.current_nalu_start,!0)},o.prototype.NextNalu=function(e){if(this.start_code_size=0,this.nalu_start=0,this.nalu_size=0,this.offset>=this.view.byteLength||!this.FindStartCode())return!1;if(this.start_code_size=this.current_start_code_size,this.nalu_start=this.current_nalu_start,e){if(this.isH265){if((126&this.view.getUint8(this.nalu_start+this.start_code_size))>>1!==39)return!0}else if((31&this.view.getUint8(this.nalu_start+this.start_code_size))!=6)return!0}return this.FindStartCode()?(this.offset=this.current_nalu_start,this.nalu_size=this.current_nalu_start-this.nalu_start,!0):(this.nalu_size=this.view.byteLength-this.nalu_start,!0)},o}();function Zd(o,e,t){if(o===0)return"";var n=1,r="  Here are some explanations about the error code: ".concat(n++,". reason=").concat(o,": ").concat(function(i){switch(i){case gs.PEER_CLOSE_REASON_NORMAL:return"Client voluntarily exits.";case gs.PEER_CLOSE_REASON_STATE_ERROR:return"Status error; Reason: Repeatedly received offer/answer, etc.";case gs.PEER_CLOSE_REASON_VRS_PUBLISH_DENIED:return"Refuse to push the stream; Reason: The client retweeted the stream and was kicked or the agent's pubstart timed out, etc.";case gs.PEER_CLOSE_REASON_VRS_PLAY_DENIED:return"Refuse to pull stream; Reason: may pull empty stream, etc., refer to 'err' error code for details.";case gs.PEER_CLOSE_REASON_AUDIO_CODEC_NOT_MATCH:return"No matching audio codec; Reason: Client (Web) does not support OPUS, etc.";case gs.PEER_CLOSE_REASON_VIDEO_CODEC_NOT_MATCH:return"No matching video codec; Reason: Client (Web) does not support h264, h265 and vp8 etc.";case gs.PEER_CLOSE_REASON_SDP_INVALID:return"SDP parsing error; Reason: SDP format error.";default:return"unknown"}}(o));return e&&(r+=" ".concat(n++,". action=").concat(e,": ").concat(function(i){switch(i){case va.DENIED_ACTION_STOP:return"cancel pushing stream.";case va.DENIED_ACTION_RETRY_NEXT_IP:return"Try the next ip, if there is no next ip, re-request the route.";case va.DENIED_ACTION_REDIRECT:return"Redirect to the ip address specified by data.";case va.DENIED_ACTION_REDISPATCH:return"re-request route.";case va.DENIED_ACTION_RETRY:return"retry current gateway node.";default:return"unknown"}}(e))),t&&(r+=" ".concat(n++,". err=").concat(t,": ").concat(function(i){switch(i){case lr.DENIED_ERROR_DISPATCH_FAILED:return"media scheduling failed.";case lr.DENIED_ERROR_EMPTY_PUBLISH_IPS:return"empty publish ips error.";case lr.DENIED_ERROR_EMPTY_PLAY_IPS:return"empty play ips error.";case lr.DENIED_ERROR_STREAM_NOT_EXSIT:return"stream does not exist.";case lr.DENIED_ERROR_APP_NOT_ONLINE:return"APP has been removed.";case lr.DENIED_ERROR_INVALID_PARAMETERS:return"invalid parameter.";case lr.DENIED_ERROR_NO_CLIENTIP_SET:return"client ip is not set.";case lr.DENIED_ERROR_PERMISSION_DENIED:return"No permission, access denied.";case lr.DENIED_ERROR_SET_STREAM_INFO_FAILED:return"Failed to set stream information.";case lr.DENIED_ERROR_INTERNAL_ERROR:return"internal error / server busy.";case lr.DENIED_ERROR_PUBLISH_FORBIDDEN:return"Streaming is banned.";case lr.DENIED_ERROR_NEW_PUBLISH:return"new publish error.";case lr.DENIED_ERROR_INNER_ERROR:return"inner error.";case lr.DENIED_ERROR_MANAGER_STOP:return"manager stop error.";case lr.DENIED_ERROR_PUBLISH_AUTH_FAILED:return"Stream push authentication failed.";case lr.DENIED_ERROR_PLAY_AUTH_FAILED:return"Stream pull authentication failed.";case lr.DENIED_ERROR_SERVER_STOP:return"server stoped error.";case lr.DENIED_ERROR_SESSION_ID:return"session id error.";case lr.DENIED_ERROR_MANAGER_TIMEOUT:return"manager timeout.";case lr.DENIED_ERROR_NEW_PUBLISH_SRC:return"new publish src.";case lr.DENIED_ERROR_PLAY_SESSION_LIMIT:return"Pull session limit.";case lr.DENIED_ERROR_DISABLE_IP_PORT_FLEXIBLE:return"disable ip port flexible.";case lr.DENIED_ERROR_PACKET_ILLEGAL_TS:return"packet illegal ts.";case lr.DENIED_ERROR_PACKET_ILLEGAL_ADDR:return"packet illegal address.";case lr.DENIED_ERROR_PACKET_ILLEGAL_FORMAT:return"packet illegal format.";case lr.DENIED_ERROR_CHECK_ADDR_TIMEOUT:return"Check address timed out.";case lr.DENIED_ERROR_CHECK_ADDR_ILLEGAL_SIGNATURE:return"Check Address Illegal Signature.";case lr.DENIED_ERROR_CHECK_ADDR_INCONSTANT:return"Check for address changes.";case lr.DENIED_ERROR_WEBRTC_NEGOTIATE_TIMEOUT:return"SDP negotiation timed out, check whether the SDP is sent successfully.";case lr.DENIED_ERROR_WEBRTC_CANDIDATE_TIMEOUT:return"Address negotiation timed out, check whether the Candidate is sent successfully.";case lr.DENIED_ERROR_WEBRTC_CONNECTIVITY_CHECK_FAILED:return"The connectivity check failed, probably due to firewall restrictions (protocol or port) that caused the network between the browser and the gateway to fail.";case lr.DENIED_ERROR_WEBRTC_DTLS_HS_FAILED:return"The DTLS handshake fails, the verification of the certificate may fail, and the background checks whether the certificate has expired.";case lr.DENIED_ERROR_WEBRTC_DTLS_HS_TIMEOUT:return"The DTLS handshake timed out, this mainly due to network link packet loss and other situations that caused the timeout. Please check your network status and try again.";case lr.DENIED_ERROR_WEBRTC_SRTP_PROTECT_FAILED:return"Streaming encryption failed";case lr.DENIED_ERROR_WEBRTC_HB_TIMEOUT:return"The heartbeat timed out, this mainly due to network link packet loss and other conditions that caused the timeout. Please check your network status and try again.";case lr.DENIED_ERROR_WEBRTC_CONNECTION_LOST:return"The link is disconnected. In turn mode, if the turn link times out or has been released, the gateway will fail to send, and the gateway will think that the link has been lost.";case lr.DENIED_ERROR_WEBRTC_NEW_SRC:return"After the stream pushing end pushes the stream again, the stream pulling end will receive this message.";case lr.DENIED_ERROR_WEBRTC_CODEC_NOT_MATCH:return"The client does not support the codec used by the stream source";case lr.DENIED_ERROR_WEBRTC_CODEC_SWITCH:return"The streaming source switched the encoding format while clients were still pulling the stream";default:return"unknown"}}(t))),r}(function(o){o[o.PEER_CLOSE_REASON_NORMAL=0]="PEER_CLOSE_REASON_NORMAL",o[o.PEER_CLOSE_REASON_STATE_ERROR=5]="PEER_CLOSE_REASON_STATE_ERROR",o[o.PEER_CLOSE_REASON_VRS_PUBLISH_DENIED=15]="PEER_CLOSE_REASON_VRS_PUBLISH_DENIED",o[o.PEER_CLOSE_REASON_VRS_PLAY_DENIED=18]="PEER_CLOSE_REASON_VRS_PLAY_DENIED",o[o.PEER_CLOSE_REASON_AUDIO_CODEC_NOT_MATCH=21]="PEER_CLOSE_REASON_AUDIO_CODEC_NOT_MATCH",o[o.PEER_CLOSE_REASON_VIDEO_CODEC_NOT_MATCH=22]="PEER_CLOSE_REASON_VIDEO_CODEC_NOT_MATCH",o[o.PEER_CLOSE_REASON_SDP_INVALID=23]="PEER_CLOSE_REASON_SDP_INVALID"})(gs||(gs={})),function(o){o[o.DENIED_ACTION_STOP=1]="DENIED_ACTION_STOP",o[o.DENIED_ACTION_RETRY_NEXT_IP=2]="DENIED_ACTION_RETRY_NEXT_IP",o[o.DENIED_ACTION_REDIRECT=3]="DENIED_ACTION_REDIRECT",o[o.DENIED_ACTION_REDISPATCH=4]="DENIED_ACTION_REDISPATCH",o[o.DENIED_ACTION_RETRY=5]="DENIED_ACTION_RETRY"}(va||(va={})),function(o){o[o.DENIED_ERROR_DISPATCH_FAILED=1001]="DENIED_ERROR_DISPATCH_FAILED",o[o.DENIED_ERROR_EMPTY_PUBLISH_IPS=1002]="DENIED_ERROR_EMPTY_PUBLISH_IPS",o[o.DENIED_ERROR_EMPTY_PLAY_IPS=1003]="DENIED_ERROR_EMPTY_PLAY_IPS",o[o.DENIED_ERROR_STREAM_NOT_EXSIT=1004]="DENIED_ERROR_STREAM_NOT_EXSIT",o[o.DENIED_ERROR_APP_NOT_ONLINE=1005]="DENIED_ERROR_APP_NOT_ONLINE",o[o.DENIED_ERROR_INVALID_PARAMETERS=1006]="DENIED_ERROR_INVALID_PARAMETERS",o[o.DENIED_ERROR_NO_CLIENTIP_SET=1007]="DENIED_ERROR_NO_CLIENTIP_SET",o[o.DENIED_ERROR_PERMISSION_DENIED=1008]="DENIED_ERROR_PERMISSION_DENIED",o[o.DENIED_ERROR_SET_STREAM_INFO_FAILED=1009]="DENIED_ERROR_SET_STREAM_INFO_FAILED",o[o.DENIED_ERROR_INTERNAL_ERROR=1010]="DENIED_ERROR_INTERNAL_ERROR",o[o.DENIED_ERROR_PUBLISH_FORBIDDEN=1011]="DENIED_ERROR_PUBLISH_FORBIDDEN",o[o.DENIED_ERROR_NEW_PUBLISH=1012]="DENIED_ERROR_NEW_PUBLISH",o[o.DENIED_ERROR_INNER_ERROR=1013]="DENIED_ERROR_INNER_ERROR",o[o.DENIED_ERROR_MANAGER_STOP=1014]="DENIED_ERROR_MANAGER_STOP",o[o.DENIED_ERROR_PUBLISH_AUTH_FAILED=1015]="DENIED_ERROR_PUBLISH_AUTH_FAILED",o[o.DENIED_ERROR_PLAY_AUTH_FAILED=1016]="DENIED_ERROR_PLAY_AUTH_FAILED",o[o.DENIED_ERROR_SERVER_STOP=2001]="DENIED_ERROR_SERVER_STOP",o[o.DENIED_ERROR_SESSION_ID=2002]="DENIED_ERROR_SESSION_ID",o[o.DENIED_ERROR_MANAGER_TIMEOUT=2003]="DENIED_ERROR_MANAGER_TIMEOUT",o[o.DENIED_ERROR_NEW_PUBLISH_SRC=2004]="DENIED_ERROR_NEW_PUBLISH_SRC",o[o.DENIED_ERROR_PLAY_SESSION_LIMIT=2005]="DENIED_ERROR_PLAY_SESSION_LIMIT",o[o.DENIED_ERROR_DISABLE_IP_PORT_FLEXIBLE=2006]="DENIED_ERROR_DISABLE_IP_PORT_FLEXIBLE",o[o.DENIED_ERROR_PACKET_ILLEGAL_TS=2007]="DENIED_ERROR_PACKET_ILLEGAL_TS",o[o.DENIED_ERROR_PACKET_ILLEGAL_ADDR=2008]="DENIED_ERROR_PACKET_ILLEGAL_ADDR",o[o.DENIED_ERROR_PACKET_ILLEGAL_FORMAT=2009]="DENIED_ERROR_PACKET_ILLEGAL_FORMAT",o[o.DENIED_ERROR_CHECK_ADDR_TIMEOUT=2010]="DENIED_ERROR_CHECK_ADDR_TIMEOUT",o[o.DENIED_ERROR_CHECK_ADDR_ILLEGAL_SIGNATURE=2011]="DENIED_ERROR_CHECK_ADDR_ILLEGAL_SIGNATURE",o[o.DENIED_ERROR_CHECK_ADDR_INCONSTANT=2012]="DENIED_ERROR_CHECK_ADDR_INCONSTANT",o[o.DENIED_ERROR_WEBRTC_NEGOTIATE_TIMEOUT=3e3]="DENIED_ERROR_WEBRTC_NEGOTIATE_TIMEOUT",o[o.DENIED_ERROR_WEBRTC_CANDIDATE_TIMEOUT=3001]="DENIED_ERROR_WEBRTC_CANDIDATE_TIMEOUT",o[o.DENIED_ERROR_WEBRTC_CONNECTIVITY_CHECK_FAILED=3002]="DENIED_ERROR_WEBRTC_CONNECTIVITY_CHECK_FAILED",o[o.DENIED_ERROR_WEBRTC_DTLS_HS_FAILED=3003]="DENIED_ERROR_WEBRTC_DTLS_HS_FAILED",o[o.DENIED_ERROR_WEBRTC_DTLS_HS_TIMEOUT=3004]="DENIED_ERROR_WEBRTC_DTLS_HS_TIMEOUT",o[o.DENIED_ERROR_WEBRTC_SRTP_PROTECT_FAILED=3005]="DENIED_ERROR_WEBRTC_SRTP_PROTECT_FAILED",o[o.DENIED_ERROR_WEBRTC_HB_TIMEOUT=3006]="DENIED_ERROR_WEBRTC_HB_TIMEOUT",o[o.DENIED_ERROR_WEBRTC_CONNECTION_LOST=3007]="DENIED_ERROR_WEBRTC_CONNECTION_LOST",o[o.DENIED_ERROR_WEBRTC_NEW_SRC=3008]="DENIED_ERROR_WEBRTC_NEW_SRC",o[o.DENIED_ERROR_WEBRTC_CODEC_NOT_MATCH=3009]="DENIED_ERROR_WEBRTC_CODEC_NOT_MATCH",o[o.DENIED_ERROR_WEBRTC_CODEC_SWITCH=3010]="DENIED_ERROR_WEBRTC_CODEC_SWITCH"}(lr||(lr={}));var ya,Hl={FPS:{code:Q.captureFpsToLow,message:"The video capture frame rate is too low."},VOLUME:{code:Q.captureVolumeToLow,message:"The capture volume is too low."}},Hu={V_BITRATE:{code:Q.sendVideoBitrateToLow,message:"The video bit rate sent is too low."},FPS:{code:Q.sendFpsToLow,message:"The video frame rate sent is too low."},A_BITRATE:{code:Q.sendAudioBitrateToLow,message:"The audio bit rate sent is too low."}},Ka={A_VOLUME:{code:Q.receiveVolumeToLow,message:"The volume of audio received is too low."},A_DECODE:{code:Q.receiveAudioDecodedFail,message:"The received audio failed to be decoded."},V_DECODE:{code:Q.receiveVideoDecodedFail,message:"The received video failed to be decoded."},V_DECODED_FPS:{code:Q.receiveVideoFpsDecodedToLow,message:"Received video decode frame rate is too low."},RENDER_VIDEO_FPS:{code:Q.renderVideoFpsToLow,message:"The rendered video frame rate is too low."}},Xd={FPS:{code:Q.captureFpsNormal,message:"The video capture frame rate is normal."},VOLUME:{code:Q.captureVolumeNormal,message:"The capture volume is normal."}},Gl={V_BITRATE:{code:Q.sendVideoBitrateNormal,message:"The video bit rate sent is normal."},FPS:{code:Q.sendFpsNormal,message:"The video frame rate sent is normal."},A_BITRATE:{code:Q.sendAudioBitrateNormal,message:"The audio bit rate sent is normal."}},Mc={A_VOLUME:{code:Q.receiveVolumeNormal,message:"The volume of audio received is normal."},A_DECODE:{code:Q.receiveAudioDecodedNormal,message:"The received audio successed to be decoded."},V_DECODE:{code:Q.receiveVideoDecodedNormal,message:"The received video successed to be decoded."},V_DECODED_FPS:{code:Q.receiveVideoFpsDecodedNormal,message:"Received video decode frame rate is normal."},RENDER_VIDEO_FPS:{code:Q.renderVideoFpsNormal,message:"The rendered video frame rate is normal."}},$d=function(){function o(e,t,n,r){this.pn=e,this.parentEvent=r,this.results={},this.preTime=Date.now(),this.preTotalFps=0,this.preIsNormal={},this.an=t,this.streamId=n,this.initPreIsNormal(Hl),this.initPreIsNormal(Hu),this.initPreIsNormal(Ka)}return o.prototype.initPreIsNormal=function(e){for(var t in e)this.preIsNormal[e[t].code]=!0},o.prototype.recordData=function(e,t,n){var r=e.code,i=this.results[r]||[];if(i.push(n),i.length>=5){var s=i.includes(!1);this.preIsNormal[r]&&!s&&(this.uploadEventData(e),this.pn.actionListener("exceptionUpdate",this.streamId,e)),!this.preIsNormal[r]&&s&&(this.uploadEventData(t),this.pn.actionListener("exceptionUpdate",this.streamId,t)),this.preIsNormal[r]=s,i=[]}this.results[r]=i},o.prototype.uploadEventData=function(e){var t=this.pn.reporter.createSpan(Te.t0.I,{key:this.parentEvent,par:this.streamId},{key:""},k.bs.event);t.setAttributes({code:k.bs.code(e.code),message:k.bs.message(e.message)}),t.end()},o.prototype.checkRemoteStats=function(e,t){this.recordData(Ka.A_VOLUME,Mc.A_VOLUME,this.recvAudioVolume(e)),this.recordData(Ka.A_DECODE,Mc.A_DECODE,this.recvAudioDecode(e)),this.recordData(Ka.V_DECODE,Mc.V_DECODE,this.recvVideoDecode(e)),this.recordData(Ka.V_DECODED_FPS,Mc.V_DECODED_FPS,this.recvVideoDecodedFrameRate(e)),this.recordData(Ka.RENDER_VIDEO_FPS,Mc.RENDER_VIDEO_FPS,this.renderVideoFrameRate(e,t))},o.prototype.checkLocalStats=function(e){this.recordData(Hl.FPS,Xd.FPS,this.captureVideoFrameRate(e)),this.recordData(Hu.FPS,Gl.FPS,this.sendVideoFrameRate(e)),this.recordData(Hl.VOLUME,Xd.VOLUME,this.sendAudioVolume(e)),this.recordData(Hu.V_BITRATE,Gl.V_BITRATE,this.sendVideoBitrate(e)),this.recordData(Hu.A_BITRATE,Gl.A_BITRATE,this.sendAudioBitrate(e))},o.prototype.sendVideoBitrate=function(e){return!(e.videoMuteState==="1"||e.videoQuality>2)&&e.videoBitrate===0},o.prototype.sendVideoFrameRate=function(e){var t=e.videoTransferFPS,n=e.videoFPS;return e.videoMuteState!=="1"&&(n>=10&&t<5||n<10&&n>=5&&t<=1)},o.prototype.captureVideoFrameRate=function(e){var t=e.videoTargetFPS,n=e.videoFPS;return e.videoMuteState!=="1"&&(t>=10&&n<5||t<10&&t>=5&&n<=1)},o.prototype.sendAudioVolume=function(e){return e.audioMuteState!=="1"&&Math.floor(32767*e.audioLevel)<Math.floor(327.67)},o.prototype.sendAudioBitrate=function(e){var t=e.audioBitrate;return!(e.audioMuteState==="1"||e.audioQuality>2)&&(t===0||e.audioTargetBitrate>=48&&t<22)},o.prototype.recvAudioVolume=function(e){return!(e.audioMuteState==="1"||e.audioQuality>2)&&e.audioBitrate>0&&Math.floor(32767*e.audioLevel)<Math.floor(327.67)},o.prototype.recvAudioDecode=function(e){return!(e.audioMuteState==="1"||e.audioQuality>2)&&e.audioBitrate>0&&e.audioFPS===0},o.prototype.recvVideoDecode=function(e){return!(e.videoMuteState==="1"||e.videoQuality>2)&&e.videoBitrate>0&&e.videoTransferFPS===0},o.prototype.recvVideoDecodedFrameRate=function(e){var t=e.videoFPS,n=e.videoTransferFPS;return e.videoMuteState!=="1"&&(t>=10&&n<5||t<10&&t>=5&&n<=1)},o.prototype.renderVideoFrameRate=function(e,t){var n=e.videoTransferFPS,r=e.videoRenderFPS;return e.videoMuteState!=="1"&&r!=-1&&(n>10&&r<5||n<=10&&n>=5&&r<=1)},o}(),Ya=function(){return Ya=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},Ya.apply(this,arguments)},rp=function(){function o(e,t,n,r,i,s,c){this.tf=e,this.if=t,this.nf=n,this.Xu=i,this.pn=s,this.gn=c,this.ef=null,this.rf=1e3,this.sf=null,this.uf=null,this.af=0,this.eo=0,this.cf={},this.hf=0,this.ff=0,this.probeState=Re.probed,this.publishStat={},this.Wh={video:{videoBitrate:0,videoFPS:0,videoTransferFPS:0,frameHeight:0,frameWidth:0,muteState:"1",videoQuality:-1,videoPacketsLost:0,videoPacketsLostRate:0,googCodecName:""},audio:{audioBitrate:0,audioCodec:"",muteState:"1",audioQuality:-1,audioFPS:0,audioPacketsLost:0,audioPacketsLostRate:0,googCodecName:""}},this.lf=0,this.df="udp",this.vf={},this.mf="",this.pf="",this.bf=0,this._f=0,this.yf=void 0,this.connectIPStack=-1,this.wf=new $d(this.pn,r,this.streamId,k.Og.event)}return Object.defineProperty(o.prototype,"streamId",{get:function(){return this.nf.streamId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sessionId",{get:function(){return this.nf.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"peerID",{get:function(){return this.nf.peerID},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"xu",{get:function(){return this.nf.localStream},enumerable:!1,configurable:!0}),o.prototype.setPublishQualityTimer=function(){var e=this;this.ef==null&&(this.nf.info(ie.Ifp+" called ".concat(this.rf," ").concat(this.tf," ").concat(this.if)),(this.ef||this.sf||this.uf)&&this.clearPublishQualityTimer(),this.ef=setInterval(function(){e.Sf()},this.rf),this.af=this.eo=Date.now(),this.rf!==1e3&&(this.tf!=this.rf&&(this.sf=setInterval(function(){e.notifyPublishQuality()},this.tf)),this.if!=this.rf&&(this.uf=setInterval(function(){e.reportPublishQuality()},this.if))),this.cf={audioPacketsLost:0,videoPacketsLost:0,videoPacketsSent:0,audioPacketsSent:0,audioRetransmittedPacketsSent:0,audioRetransmittedBytesSent:0,videoTime:Date.now(),audioTime:Date.now(),time:Date.now(),audioBytesSent:0,videoBytesSent:0,framesEncoded:0,framesSent:0,videoRetransmittedPacketsSent:0,videoRetransmittedBytesSent:0,videoActualBytesSent:0,qpSum:0})},o.prototype.clearPublishQualityTimer=function(){this.nf.info("zc.p.0.spqt.1 called ".concat(!!this.ef," ").concat(!!this.sf," ").concat(!!this.uf)),this.ef!=null&&(clearInterval(this.ef),this.ef=null),this.sf!=null&&(clearInterval(this.sf),this.sf=null),this.uf!=null&&(clearInterval(this.uf),this.uf=null),this.cf={},this.ff=0,this.lf=0},o.prototype.Ef=function(){var e=this,t=[],n=!1;if(!this.nf.peerConnection)return{result:t,hasVideo:n};var r=[],i=this.nf,s=i.videoSender,c=i.audioSender;return s&&r.push(s),c&&r.push(c),r.forEach(function(u){u.track&&(u.track.kind==="video"&&(n=!0),e.nf.peerConnection&&t.push(e.nf.peerConnection.getStats(u.track)))}),{result:t,hasVideo:n}},o.prototype.Sf=function(){var e=this;if(this.nf.peerConnection){var t=this.Ef(),n=t.hasVideo;Promise.all(t.result).then(function(r){r.length!==0&&e.ef&&e.If(r.filter(function(i){return i instanceof RTCStatsReport}),r[r.length-1]instanceof RTCStatsReport?null:r[r.length-1],n)}).catch(function(r){e.nf.info(ie.Ifp+" getStats error "+r.toString())})}},o.prototype.If=function(e,t,n){var r,i,s,c=this;if(e){var u,l,a=this.gn.checkPreview(this.xu),h=a&&a.rtcViewer;h&&(u=h.ma,l=h.pa),u&&u.currentTime||(u=Dc(this.xu,"video")||u),l&&l.currentTime||(l=Dc(this.xu,"audio")||l||u);var m=[],S="",x={scenario:this.pn.scenario,sampleTimeWindow:this.if,audioCodec:"",audioTargetBitrate:this.nf.videoInfo.audioBitrate/1e3||0,audioBitrate:0,audioRtxBitrate:0,videoTargetBitrate:this.nf.videoInfo.bitRate||0,videoTargetFPS:this.nf.videoInfo.frameRate||0,videoBitrate:0,audioFPS:0,audioLevel:0,audioPacketsLost:0,totalAudioEnergy:0,totalSamplesDuration:0,echoReturnLossEnhancement:void 0,audioPacketsLostRate:0,videoFPS:0,nackCount:0,pliCount:0,audioQuality:0,videoQuality:0,frameHeight:0,frameWidth:0,videoTransferFPS:0,videoPacketsLost:0,videoPacketsLostRate:0,totalRoundTripTime:0,currentRoundTripTime:0,availableOutgoingBitrate:void 0,inputWidth:void 0,inputHeight:void 0,inputFPS:void 0,qualityLimitationReason:"",targetBitrate:void 0,retransmitBitrate:void 0,actualEncBitrate:void 0,frameQp:void 0,videoCodecName:void 0,videoMuteState:!((r=a==null?void 0:a.videoTrack)===null||r===void 0)&&r.enabled?"0":"1",audioMuteState:this.xu.getAudioTracks().length>0&&this.xu.getAudioTracks()[0].enabled?"0":"1",soundLevel:a==null?void 0:a.soundLevel,muted:l?l.muted:void 0,audioPaused:l?l.paused:void 0,videoPaused:u?u.paused:void 0,volume:l?l.volume:void 0,sinkId:l?l.sinkId:void 0};this.nf.ip&&(Yi(this.nf.ip)?x.ipv6=this.nf.ip:x.ipv4=$r(this.nf.ip));var q=this.cf.time,V=0,_e=0,ke=0,Pe=0,Oe=0,Ge=0;if(e.forEach(function(Kt){var $t=!1;Kt.forEach(function(yt){yt.type=="track"&&($t=!0)}),Kt.forEach(function(yt){var Pn=yt.kind||yt.mediaType;if((yt.type=="outbound-rtp"||yt.type=="ssrc"&&yt.bytesSent!=null)&&Pn=="audio"){var pn="";(un=Kt.get(yt.codecId))&&un.mimeType&&(pn=un.mimeType.split("/")[1]),c.pf!==pn&&(c.pf=pn),x.audioCodec=c.pf,q!=0&&(x.audioBitrate=8*(yt.bytesSent-c.cf.audioBytesSent)/(yt.timestamp-q),yt.retransmittedPacketsSent=yt.retransmittedPacketsSent||0,yt.packetsSent=yt.packetsSent||0,x.audioFPS=(yt.packetsSent-(yt.retransmittedPacketsSent-c.cf.audioRetransmittedPacketsSent)-c.cf.audioPacketsSent)/(yt.timestamp-q)*1e3||0,ke=(yt.retransmittedPacketsSent-c.cf.audioRetransmittedPacketsSent)/(yt.packetsSent-c.cf.audioPacketsSent)),x.audioBitrate<0&&(x.audioBitrate=0),yt.retransmittedBytesSent!==void 0&&(q!=0&&(x.audioRtxBitrate=8*(yt.retransmittedBytesSent-c.cf.audioRetransmittedBytesSent)/(Mn=yt.timestamp-q)),c.cf.audioRetransmittedBytesSent=yt.retransmittedBytesSent),c.cf.audioBytesSent=yt.bytesSent,c.cf.time=yt.timestamp,c.cf.audioPacketsSentTimeStamp=yt.packetsSent-c.cf.audioPacketsSent,c.cf.audioPacketsSent=yt.packetsSent,c.cf.audioRetransmittedPacketsSent=yt.retransmittedPacketsSent}else if((yt.type=="outbound-rtp"||yt.type=="ssrc"&&yt.bytesSent!=null)&&Pn=="video"){var un,ln="";(un=Kt.get(yt.codecId))&&un.mimeType&&(ln=un.mimeType.split("/")[1]),c.mf!==ln&&(c.mf=ln),x.videoCodecName=c.mf,x.isHardwareEncode=function(Nr){if(Nr){var ni=Nr==null?void 0:Nr.toLocaleLowerCase();if(ni!=="unknown")return ni!=="openh264"&&ni!=="libvpx"}}(yt.encoderImplementation),x.codecImplementationName=yt.encoderImplementation;var Mn,Hn=0;yt.retransmittedBytesSent!==void 0&&(Hn=yt.bytesSent-yt.retransmittedBytesSent),q!=0&&(x.videoBitrate=8*(yt.bytesSent-c.cf.videoBytesSent)/(Mn=yt.timestamp-q),x.videoFPS=1e3*(yt.framesEncoded-c.cf.framesEncoded)/Mn,Pe=(yt.retransmittedPacketsSent-c.cf.videoRetransmittedPacketsSent)/(yt.packetsSent-c.cf.videoPacketsSent),yt.retransmittedBytesSent!==void 0&&(x.retransmitBitrate=8*(yt.retransmittedBytesSent-c.cf.videoRetransmittedBytesSent)/Mn,x.actualEncBitrate=8*(Hn-c.cf.videoActualBytesSent)/Mn),yt.qpSum!==void 0&&(x.frameQp=(yt.qpSum-c.cf.qpSum)/(yt.framesEncoded-c.cf.framesEncoded))),x.videoBitrate<0&&(x.videoBitrate=0),x.videoFPS<0&&(x.videoFPS=0),x.nackCount=yt.nackCount,x.pliCount=yt.pliCount,x.qualityLimitationReason=yt.qualityLimitationReason,x.targetBitrate=yt.targetBitrate,c.cf.videoBytesSent=yt.bytesSent,c.cf.framesEncoded=yt.framesEncoded,c.cf.time=yt.timestamp,c.cf.videoPacketsSentTimeStamp=yt.packetsSent-c.cf.videoPacketsSent,c.cf.videoPacketsSent=yt.packetsSent,c.cf.videoRetransmittedPacketsSent=yt.retransmittedPacketsSent,c.cf.videoRetransmittedBytesSent=yt.retransmittedBytesSent,c.cf.videoActualBytesSent=Hn,c.cf.qpSum=yt.qpSum,$t||c.Rf(q,x,yt)}else if(yt.type=="remote-inbound-rtp"&&Pn=="video"){yt.packetsLost>0&&(x.videoPacketsLost=yt.packetsLost);var xi=yt.packetsLost-c.cf.videoPacketsLost;x.videoPacketsLostRate=xi>0?xi/c.cf.videoPacketsSentTimeStamp:0,yt.packetsLost>0&&(c.cf.videoPacketsLost=yt.packetsLost),c.cf.videoTime=yt.timestamp,_e=1e3*yt.roundTripTime,Ge=yt.jitter}else if(yt.type=="remote-inbound-rtp"&&Pn=="audio"){yt.packetsLost>0&&(x.audioPacketsLost=yt.packetsLost);var vi=yt.packetsLost-c.cf.audioPacketsLost;x.audioPacketsLostRate=vi>0?vi/c.cf.audioPacketsSentTimeStamp:0,yt.packetsLost>0&&(c.cf.audioPacketsLost=yt.packetsLost),c.cf.audioTime=yt.timestamp,V=1e3*yt.roundTripTime,Oe=yt.jitter}else if(yt.type=="media-source"&&(Pn=="audio"||yt.id.toLowerCase().indexOf("audio")>=0))x.audioLevel=yt.audioLevel||0,x.totalAudioEnergy=yt.totalAudioEnergy,x.totalSamplesDuration=yt.totalSamplesDuration,x.echoReturnLossEnhancement=yt.echoReturnLossEnhancement;else if(yt.type=="media-source"&&(Pn=="video"||yt.id.toLowerCase().indexOf("video")>=0))x.inputWidth=yt.width,x.inputHeight=yt.height,x.inputFPS=yt.framesPerSecond;else if(yt.type=="track"&&(Pn=="video"||yt.id.indexOf("video")>=0||yt.frameWidth))c.Rf(q,x,yt);else if(yt.type!="candidate-pair"||!yt.nominated||(0,Vn.gm)()&&!yt.selected)yt.type==="local-candidate"&&m.push(yt);else{yt.totalRoundTripTime!=null&&(x.totalRoundTripTime=yt.totalRoundTripTime),yt.currentRoundTripTime!=null&&(x.currentRoundTripTime=yt.currentRoundTripTime),yt.availableOutgoingBitrate!==void 0&&(x.availableOutgoingBitrate=yt.availableOutgoingBitrate),yt.state==="succeeded"&&(S=yt.localCandidateId);var yr=c.gn.lastChangeIpTime;if(yr&&c._f<yr&&Date.now()-yr<=15e3){var Ur=yt.bytesReceived,Gr=c.cf.condidateBytesReceived;Gr&&(Ur>Gr?c.bf=0:c.bf++),c.bf>=5&&(c.bf=0,c._f=yr,c.onPublishingError(Et.kOd)),c.cf.condidateBytesReceived=Ur}else c.bf>0&&(c.bf=0)}})}),S){var Je=m.find(function(Kt){return Kt.id==S});if(Je){var tt=void 0;if(Je.relayProtocol!==void 0)tt=Je.relayProtocol;else if(Je.protocol)tt=Je.protocol;else if(Je.priority){var ut=Je.priority>>24;ut!==void 0&&(tt=pd(ut,this.pn.browser))}tt!==void 0&&this.df!==tt&&(this.nf.info(ie.Ifp+" protocol "+tt),this.df=tt);var vt=!1,gt=Je.candidateType,Pt=Je.networkType,wt=Je.relayProtocol,At=Je.relatedAddress,Vt=Je.url,qt=Je.ip;if(qt){var Gt=Ar(qt);Gt>=0&&Gt!==this.connectIPStack&&(this.nf.info(ie.Jli+" "+this.streamId+" ipStack "+Y[Gt]),this.connectIPStack=Gt,this.onConnectIPUpdate(qt))}vt=this.Tf([{key:"candidateType",value:gt},{key:"networkType",value:Pt}]),gt==="relay"&&(vt=this.Tf([{key:"relayProtocol",value:wt},{key:"relatedAddress",value:At},{key:"url",value:Vt}])),vt&&this.nf.info(ie.Jli+" upload candidate change "+JSON.stringify(this.vf))}}if(this.pn.browser==="chrome"){var Sn=(i=(0,Vn.$t)())===null||i===void 0?void 0:i.match(/Chrome\/(\d+)/);parseInt(Sn&&Sn[1]||"100")<=91&&x.isHardwareEncode&&this.nf.handleEncBitrate(Number.parseInt(x.targetBitrate),Number.parseInt(x.actualEncBitrate),Number.parseInt(x.retransmitBitrate))}_e=isNaN(_e)||_e<0?0:_e,Pe=isNaN(Pe)||Pe<0?0:Pe,Ge=isNaN(Ge)||Ge<0?0:Ge,V=isNaN(V)||V<0?0:V,ke=isNaN(ke)||ke<0?0:ke,Oe=isNaN(Oe)||Oe<0?0:Oe;var Qt=ze(_e,Pe,Ge),Wt=ze(V,ke,Oe);if(x.videoQuality=q>0?ft(Qt):0,x.audioQuality=q>0?ft(Wt):0,this.pn.networkState!==E.D2.offline&&((s=this.nf.peerConnection)===null||s===void 0?void 0:s.connectionState)!=="disconnected"||(x.videoQuality=E.b3.Die,x.audioQuality=E.b3.Die),n&&(!x.frameHeight||!x.frameWidth)){var zt=this.xu.getVideoTracks()[0];zt&&(x.frameHeight=zt.getSettings().height||0,x.frameWidth=zt.getSettings().width||0)}var Mt=Math.min(Qt,Wt);this.hf=Mt,this.Cf(x),this.publishStat=x,this.nf.onStatsUpdated(this.publishStat);var jt=Date.now();this.rf===this.tf?this.notifyPublishQuality():this.sf||jt-this.af+50>=this.tf&&this.notifyPublishQuality(),this.if===this.rf?this.reportPublishQuality():this.uf||jt-this.eo+50>=this.if&&this.reportPublishQuality()}},o.prototype.onConnectIPUpdate=function(e){},o.prototype.notifyPublishQuality=function(){this.af=Date.now(),this.nf.onPublishQualityUpdate(this.streamId,this.Wh)},o.prototype.reportPublishQuality=function(){var e=Date.now();this.eo=e,this.checkProbe(),this.Af(this.publishStat),this.wf.checkLocalStats(this.publishStat),this.gn.changeTxQuality(ft(this.hf)),this.nf.sendNetQualityGrade(this.gn.rxQuality,this.gn.txQuality)},o.prototype.checkProbe=function(){var e=this.hf,t=this.cf.time;this.nf.debug(ie.Ifp+" netQuality "+e+" "+t),e<=this.gn.targetQuality?this.ff++:this.ff=0,t>0&&this.ff>=this.gn.probeStartedNum&&Date.now()>this.nf.probeTime+this.gn.probeInterval&&(this.nf.info(ie.Ifp+" netQuality "+e+" start net probe"),this.probeState=Re.tryProbe,this.nf.poorQualityRetryCnt++,this.gn.startNetProbe(!0,this.nf))},o.prototype.Rf=function(e,t,n){var r=n.frameHeight,i=n.frameWidth,s=n.framesSent,c=n.timestamp;if(t.frameHeight=r,t.frameWidth=i,e===0||this.cf.frameHeight===r&&this.cf.frameWidth===i)e===0&&(this.cf.frameHeight=r,this.cf.frameWidth=i);else{var u=this.pn.reporter.createSpan(E.t0.H,{key:k.Og.event,par:this.streamId},{key:""},k.YO.event);u.setAttributes({webrtc_sid:k.YO.webrtc_sid(this.sessionId),w:k.YO.w(i),h:k.YO.h(r)}),u.end(),this.cf.frameHeight=r,this.cf.frameWidth=i}e!=0&&(t.videoTransferFPS=1e3*(s-this.cf.framesSent)/(c-e)),t.videoTransferFPS<0&&(t.videoTransferFPS=0),this.cf.framesSent=s},o.prototype.Cf=function(e){var t=e.videoBitrate,n=e.videoFPS,r=e.videoTransferFPS,i=e.frameHeight,s=e.frameWidth,c=e.videoMuteState,u=e.videoQuality,l=e.isHardwareEncode,a=e.audioBitrate,h=e.audioCodec,m=e.audioMuteState,S=e.audioQuality,x=e.audioFPS,q={video:Ya(Ya({},this.Wh.video),{videoBitrate:t,videoFPS:n,videoTransferFPS:r,frameHeight:i,frameWidth:s,muteState:c,videoQuality:u,isHardwareEncode:l}),audio:Ya(Ya({},this.Wh.audio),{audioBitrate:a,audioCodec:h,muteState:m,audioQuality:S,audioFPS:x}),nackCount:e.nackCount,pliCount:e.pliCount,totalRoundTripTime:e.totalRoundTripTime,currentRoundTripTime:e.currentRoundTripTime};if(e.qualityLimitationReason!==void 0&&(q.qualityLimitationReason=e.qualityLimitationReason),e.videoPacketsLost!==void 0){var V=e.videoPacketsLostRate;q.video.videoPacketsLost=e.videoPacketsLost,q.video.videoPacketsLostRate=V}if(e.audioPacketsLost!==void 0){var _e=e.audioPacketsLostRate;q.audio.audioPacketsLost=e.audioPacketsLost,q.audio.audioPacketsLostRate=_e}e.codecImplementationName!==void 0&&(q.codecImplementationName=e.codecImplementationName),e.videoCodecName!==void 0&&(q.video.googCodecName=e.videoCodecName),e.audioCodec!==""&&(q.audio.googCodecName=e.audioCodec),this.Wh=q},o.prototype.simplifyPublishDataKey=function(e){var t={};return t.scenario=e.scenario,t.aRtxRate=e.audioRtxBitrate,t.aTargetRate=e.audioTargetBitrate,t.aBitrate=Math.trunc(e.audioBitrate),t.vUsrTargetRate=e.videoTargetBitrate,t.vBitrate=Math.trunc(e.videoBitrate),t.aFps=Math.trunc(e.audioFPS),t.aLevel=Math.trunc(1e5*e.audioLevel)/1e5,t.aPktLost=e.audioPacketsLost,t.aTotalEnergy=Math.trunc(1e5*e.totalAudioEnergy)/1e5,t.echoRetLossEnh=Math.trunc(1e5*e.echoReturnLossEnhancement)/1e5,t.aPlr=e.audioPacketsLostRate,t.vFps=Math.trunc(e.videoFPS),t.nackCnt=e.nackCount,t.vPliCnt=e.pliCount,t.aQuality=e.audioQuality,t.vQuality=e.videoQuality,t.vHeight=e.frameHeight,t.vWidth=e.frameWidth,t.vTransFPS=Math.trunc(e.videoTransferFPS),t.vPktLost=e.videoPacketsLost,t.vPlr=e.videoPacketsLostRate,t.rtt=e.currentRoundTripTime,t.bw=e.availableOutgoingBitrate,t.vInputW=e.inputWidth,t.vInputH=e.inputHeight,t.inFps=e.inputFPS,t.qualityLimit=e.qualityLimitationReason,t.vTargetRate=e.targetBitrate,t.vRtxRate=e.retransmitBitrate,t.VEncBitrate=e.actualEncBitrate,t.sinkId=e.sinkId,t.vQP=e.frameQp,t.vCodec=e.videoCodecName,t.vMuteStat=e.videoMuteState,t.aMuteStat=e.audioMuteState,t.aPaused=e.audioPaused,t.vPaused=e.videoPaused,t.muted=e.muted,t.volume=e.volume,t.aSoundLv=e.soundLevel,t.vIsHW=e.isHardwareEncode,t.vCodecImpl=e.codecImplementationName,t},o.prototype.Af=function(e){var t=Date.now();if(this.lf==0||t-this.lf>=2e3){e.stream_type="publish",e.stream_id=this.streamId,e.timeStamp=t;var n=this.simplifyPublishDataKey(e);this.yf!==void 0&&(n.gw_vRecvKbps=this.yf.videoRecvBitrate,n.gw_TCStat=this.yf.trafficControlStat,n.gw_vPlr=this.yf.videoLostRate,n.gw_aRecvKbps=this.yf.audioRecvBitrate,n.gw_aPlr=this.yf.audioLostRate),this.nf.info(ie.Jli+" upload"+JSON.stringify(n)),this.xu&&this.nf.info(ie.Jli+" "+Ot(this.xu)),this.gn.updateQuality(nt.publish_quality,e),this.lf=t}},o.prototype.Tf=function(e){for(var t=!1,n=0;n<e.length;n++){var r=e[n],i=r.key,s=r.value;this.vf[i]!==s&&(this.vf[i]=s,t=!0)}return t},o.prototype.onPublishingError=function(e){},o.prototype.updateGwPublishNetState=function(e){this.yf=e},o}(),xc=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Bc=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Ji=oo.webrtc_cmd,Xo=67109120,eh=function(){function o(e,t,n){this.zf=0,this.Df=0,this.Nf=0,this.Pf=null,this.Mf=!1,this.xf=0,this.jf=0,this.qf=0,this.Lf=0,this.Bf=0,this.Uf=0,this.Gf=null,this.Jf=0,this.Ff=0,this.Hf=0,this.Vf={},this.Qf=new E.wl,this.Yf=3e3,this.To=1e3,this.tu=null,this.Kf={},this.Zf=["p2p_net_stats_get"],this.Xf=["getP2PNetStats"],this.Wf={first:!0,seq:0},this.$f={first:!0,seq:0},this.tl={first:!0,seq:0},this.useCmd=!0,this.LOG_TAG=t?"zc.p.prs.0":"zc.p.prs",this.an=ei(e,n),this.va=n,this.an.info("".concat(this.LOG_TAG,".c 1"))}return Object.defineProperty(o.prototype,"dataChannel",{set:function(e){this.Pf=e,e&&this.Nf>=Xo&&(this.Mf=!0,this.an.info("".concat(this.LOG_TAG,"  enable dc")))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isCenterServerConnected",{get:function(){var e;return((e=this.Gf)===null||e===void 0?void 0:e.mediaState)===Ee.LOGIN},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"webrtcCenterServerSignal",{set:function(e){this.Gf=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"streamId",{get:function(){return this.va},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"peerId",{get:function(){return this.zf},set:function(e){this.zf!==e&&this.an.info("".concat(this.LOG_TAG,"  setPeerId: ").concat(this.zf," ").concat(e,", sid: ").concat(this.sessionId)),this.zf=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sessionId",{get:function(){return this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"gwVersion",{get:function(){return this.Nf},set:function(e){this.Nf=e,e>=Xo&&this.Pf&&(this.Mf=!0,this.an.info("".concat(this.LOG_TAG,"  enable dc, sid: ").concat(this.sessionId)))},enumerable:!1,configurable:!0}),o.prototype.reset=function(){var e,t=this,n=this.Pf?1:0;this.an.info("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId," reset, rtt:(").concat(this.Uf,",").concat(this.Bf,",").concat(this.Lf,"), dc: ").concat(n,", rtt(").concat(this.qf,",").concat(this.jf,",").concat(this.xf,"), (tx: ").concat(this.Jf," ").concat(this.Ff,", rx:").concat(this.Hf,"), sid: ").concat(this.sessionId)),this.tu&&clearTimeout(this.tu),this.Qf.each(function(r){r._data&&delete t.Vf[r._data.seq]}),this.Qf.removeAll(),(e=this.Gf)===null||e===void 0||e.unregisterPeerCallback(this.Df),this.Nf=0,this.Df=0,this.zf=0,this.Pf=null,this.Mf=!1,this.qf=0,this.jf=0,this.xf=0,this.Uf=0,this.Bf=0,this.Lf=0,this.Jf=0,this.Ff=0,this.Hf=0,this.Wf.first=!0,this.$f.first=!0,this.tl.first=!0},o.prototype.isDCReady=function(){return!(!this.Pf||this.Pf.readyState!="open")},Object.defineProperty(o.prototype,"DCState",{get:function(){return this.Pf?this.Pf.readyState:"invalid"},enumerable:!1,configurable:!0}),o.prototype.isUseDC=function(){return!!this.Mf&&!(this.Nf<Xo)&&this.DCState==="open"},o.prototype.addReqTask=function(e,t,n,r,i){var s={seq:e,deleted:!1,cmd:t,sendTime:new Date().getTime(),success:function(){for(var u=[],l=0;l<arguments.length;l++)u[l]=arguments[l];r&&r.apply(void 0,u)},error:i,timeout:this.Yf,isOverDC:n},c=this.Qf.push(s);this.Vf[s.seq]=c,this.checkTimer()},o.prototype.removeReqTask=function(e){e._data&&delete this.Vf[e._data.seq],this.Qf.remove(e)},o.prototype.checkTimer=function(){var e=this;this.Qf.size()>0?this.tu||(this.tu=setTimeout(function(){e.tu=null,e.onTimeout()},this.To)):this.tu&&(clearTimeout(this.tu),this.tu=null)},o.prototype.onTimeout=function(){for(var e,t=this.Qf.getFirst(),n=new Date().getTime();t!=null&&t._data&&!(t._data.sendTime+this.Yf>n);)t._data.isOverDC&&(this.Mf&&(this.an.error("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", rollback DC, sid: ").concat(this.sessionId)),this.Mf=!1),this.Ff++),this.removeReqTask(t),this.Zf.includes(t._data.cmd)||this.an.warn("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", timeout, cmd: ").concat(t._data.cmd,", seq: ").concat((e=t._data)===null||e===void 0?void 0:e.seq,", dc: ").concat(t._data.isOverDC)),t._data.error&&t._data.error(E.Xb,t._data.seq),t=this.Qf.getFirst();this.checkTimer()},o.prototype.onDataChannelMessage=function(e){var t=new Uint8Array(e),n=t[0];if(n!=11||t.length<4)this.an.error("".concat(this.LOG_TAG,".dc  pid: ").concat(this.peerId,", header type(").concat(n," != 0xb)"));else{var r=15&t[1],i=t[2]<<8|t[3],s=t.slice(4);i>t.length-4?this.an.error("".concat(this.LOG_TAG,".dc  pid: ").concat(this.peerId,", invalid data, len: ").concat(t.length," ").concat(i)):r==2?this.handleCmdPush(s,!0):r==1?this.handleCmdRsp(s,0,!0):this.an.error("".concat(this.LOG_TAG,".dc  pid: ").concat(this.peerId,", unknown cmd type: ").concat(r,", sid: ").concat(this.sessionId))}},o.prototype.emitCallback=function(e,t){var n=this.Kf[e];n&&n.callback(t.seq,this.Df,t)},o.prototype.updateRtt=function(e){if(this.Uf=e,this.Lf===0)return this.Lf=e,void(this.Bf=e);e>this.Lf&&(this.Lf=e),e<this.Bf&&(this.Bf=e)},o.prototype.updateDcRtt=function(e){if(this.qf=e,this.xf===0)return this.xf=e,void(this.jf=e);e>this.xf&&(this.xf=e),e<this.jf&&(this.jf=e)},o.prototype.handleCmdHeartbeatMsg=function(e,t){var n=this,r=[{key:"p2p_net_stat_rsp",type:"rsp",field:"p2p_net_stat_rsp"},{key:"play_net_stat",type:"req",field:"play_net_stat_notify"},{key:"net_quality_push",type:"req",field:"net_quality_grade_push"},{key:"pub_net_stat",type:"req",field:"PublishNetStatNotify"},{key:"pub_quality_grade_rsp",type:"rsp",field:"pub_quality_grade_rsp"},{key:"stream_status_push",type:"req",field:"StreamStatusNotifyPush"},{key:"code_err_push",type:"req",field:"codec_error_notify"},{key:"play_event_push",type:"req",field:"PlayEventPush"},{key:"pub_event_push",type:"req",field:"PublishEventPush"}];e.payloads.forEach(function(i){var s,c="cmd_hb_msg",u=r.find(function(l){return i.hasOwnProperty(l.key)});u&&(c=u.field,s=i[u.key],u.type==="rsp"?n.internalCheckCmdRsp(s,0,t,c):n.emitCallback(c,s))})},o.prototype.handleCmdPush=function(e,t,n){t&&this.Hf++;var r=Ji.WebrtcCmdReqMsg.decode(e);if(r){var i,s=Object.keys(r)[0];this.an.debug("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", handleCmdPush fromDC: ").concat(t,", cmd: ").concat(s)),(0,te.M$)(r[s]);var c,u,l=0;switch(s){case"net_quality_grade_push":c=r.net_quality_grade_push,i="net_quality_grade_ack",l=7,(this.$f.first||c.seq>this.$f.seq)&&(this.$f.first=!1,this.$f.seq=c.seq,u="net_quality_grade_push");break;case"codec_error_notify":c=r.codec_error_notify,i="codec_error_notify_ack",l=9,u="codec_error_notify";break;case"candidate_push":c=r.candidate_push,i="candidate_push_ack",l=12,u="CandidateInfoPush";break;case"close_peer_push":c=r.close_peer_push,i="close_peer_ack",l=13,u="CloseSessionPush";break;case"stream_status":c=r.stream_status,i="stream_status_ack",l=14,(this.Wf.first||c.seq>this.Wf.seq)&&(this.Wf.first=!1,this.Wf.seq=c.seq,u="StreamStatusNotifyPush");break;case"client_info":c=r.client_info,i="client_info_ack",l=18,u="ClientInfoPush",r.client_info.peer_id&&(this.zf=r.client_info.peer_id);break;case"net_quality_push":i="net_quality_ack",l=20,(c=r.net_quality_push).peer_id===void 0&&(c.peer_id=this.peerId),(this.tl.first||c.seq>this.tl.seq)&&(this.tl.first=!1,this.tl.seq=c.seq,u="NetQualityInfoPush");break;case"publish_event":c=r.publish_event,i="publish_event_ack",l=23,u="PublishEventPush";break;case"play_event":c=r.play_event,i="play_event_ack",l=26,u="PlayEventPush";break;case"heartbeat_msg_push":i="heartbeat_msg_ack",l=27,this.handleCmdHeartbeatMsg(c=r.heartbeat_msg_push,t);break;default:return void this.an.error("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", handleCmdPush fromDC:").concat(t,", unknown cmd: ").concat(s,", sid: ").concat(this.sessionId))}c&&(i&&this.sendCmdAck(i,l,0,c!=null&&c.seq?c.seq:0,t,n),u&&this.emitCallback(u,c))}else this.an.error("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", handleCmdPush, decode failed"))},o.prototype.internalCheckCmdRsp=function(e,t,n,r){e.seq=e!=null&&e.seq?e.seq:t;var i=this.Vf[e.seq];if(i){if(this.removeReqTask(i),i._data){var s=new Date().getTime()-i._data.sendTime;n?this.updateDcRtt(s):this.updateRtt(s),i._data.success&&i._data.success(e.seq,e)}}else this.an.warn("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId," handleCmdRsp, unknown seq: ").concat(e.seq,", cmd: ").concat(r,", sid: ").concat(this.sessionId))},o.prototype.handleCmdRsp=function(e,t,n){var r=Ji.WebrtcCmdRspMsg.decode(e);if(r){var i,s=Object.keys(r)[0];switch((0,te.M$)(r[s]),s){case"p2p_net_stats_get":i=r.p2p_net_stats_get;break;case"net_quality_grade":i=r.net_quality_grade;break;case"stream_status_ack":i=r.stream_status_ack;break;case"stream_property_update_ack":i=r.stream_property_update_ack;break;case"usr_sei_filter":i=r.usr_sei_filter;break;case"video_stream_sub":i=r.video_stream_sub;break;case"broadcaster_status_ack":i=r.broadcaster_status_ack;break;case"active_audio_play":i=r.active_audio_play;break;case"active_video_play":i=r.active_video_play;break;case"net_quality_probe":i=r.net_quality_probe;break;case"active_sei_insert":i=r.active_sei_insert;break;case"close_peer":i=r.close_peer;break;case"play_stats":return;case"restart_ice":i=r.restart_ice;break;default:return void this.an.error("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", handleCmdRsp, unknown cmd: ").concat(s,", sid: ").concat(this.sessionId))}i&&this.internalCheckCmdRsp(i,t,n,s),this.checkTimer()}else this.an.error("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", handleCmdRsp, decode failed"))},o.prototype.sendCmdAck=function(e,t,n,r,i,s){var c,u=Ji.WebrtcCmdRspMsg.encode((c={},c[e]={result:n,seq:r},c)).finish();i&&this.isDCReady()?this.sendAckByDC(u):this.Gf&&this.Gf.sendGWCmdAck(this.Df,{peer_id:this.zf,cmd_id:t},u,s)},o.prototype.sendReqByDC=function(e){this.sendByDC(e,0),this.Jf++},o.prototype.sendAckByDC=function(e){this.sendByDC(e,3)},o.prototype.sendByDC=function(e,t){var n,r=new Uint8Array(4+e.length),i=0;r[i]=11,r[++i]=t,r[++i]=e.length>>8,r[i+1]=e.length-(r[i]<<8),r.set(e,i+=2),i+=e.length,(n=this.Pf)===null||n===void 0||n.send(r)},o.prototype.registerPeerCallback=function(){var e=this;this.Gf&&this.Gf.registerPeerCallback(this.Df,function(t,n){e.handleMsgWithSession(t,n)})},o.prototype.handleMsgWithSession=function(e,t){var n,r,i;if(e){var s=e.header,c=s.seq,u=s.cmd,l=s.session_id;if(t===Se.RSP){if(u==="CmdRsp")return void this.handleCmdRsp((n=e.body)===null||n===void 0?void 0:n.body,c,!1);var a=this.Vf[c];if(!a)return void this.an.warn("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId," handleMsgWithSession, unknown seq: ").concat(c,", cmd: ").concat(u,", sid: ").concat(l));if(this.removeReqTask(a),a._data){var h=new Date().getTime();this.updateRtt(h-a._data.sendTime),a._data.success&&a._data.success(c,e.body)}this.checkTimer()}else if(u==="CmdPush")this.handleCmdPush((r=e.body)===null||r===void 0?void 0:r.body,!1,{seq:c,sessionId:l});else{var m=this.Kf[u];m&&m.callback((i=e==null?void 0:e.header)===null||i===void 0?void 0:i.seq,this.Df,e==null?void 0:e.body)}}},o.prototype.registerPushCallback=function(e,t){this.Kf[e]={callback:t},this.Gf&&["SessionResetPush"].includes(e)&&this.Gf.registerPushCallback(e,this.Df,t)},o.prototype.unregisterPushCallback=function(e){delete this.Kf[e],this.Gf&&this.Gf.unregisterPushCallback(e,this.Df)},o.prototype.dispatchGwNodes=function(e,t,n){if(this.Gf){var r=(0,E.Mo)();this.Gf.dispatchGwNodes(r,e,t,n)}},o.prototype.getGwVersString=function(e){var t=e>>8&65535,n=255&e;return"".concat(e>>24,".").concat(t,".").concat(n)},o.prototype.createSession=function(e,t,n,r){var i=this;if(this.Gf){var s=t.serverHost,c=performance.now();this.Gf.createSession(e,t,function(u,l,a){return xc(i,void 0,void 0,function(){var h,m;return Bc(this,function(S){return c&&(h=(performance.now()-c).toFixed(0)),m=s.length>0?s:a==null?void 0:a.gw_nodes[0],this.an.info("".concat(this.LOG_TAG,"  CreateSessionRsp, node: ").concat(m,", gw ver: ").concat(this.getGwVersString(a.gw_version),", rtt: ").concat(h,", sid: ").concat(l)),this.Df=a.session_id,this.gwVersion=a.gw_version,this.registerPeerCallback(),n&&n(u,a.session_id,a),[2]})})},function(u,l){r&&r(u,l)})}},o.prototype.createSessionWithSdp=function(e,t,n){var r=this;if(this.Gf){var i=performance.now();this.Gf.createSessionWithSdp(e,function(s,c,u){return xc(r,void 0,void 0,function(){var l,a;return Bc(this,function(h){return i&&(l=(performance.now()-i).toFixed(0)),a=e.serverHost.length>0?e.serverHost:u==null?void 0:u.gw_nodes[0],this.an.info("".concat(this.LOG_TAG,"  CreateSessionWithSdpRsp, node: ").concat(a,", gw ver: ").concat(this.getGwVersString(u.gw_version),", rtt: ").concat(l,", sid: ").concat(c)),this.Df=c,this.gwVersion=u.gw_version,u.params_ext&&u.params_ext.peer_id&&(this.peerId=u.params_ext.peer_id),this.registerPeerCallback(),t&&t(s,c,u),[2]})})},function(s,c){n&&n(s,c)})}},o.prototype.sendMediaDesc=function(e,t,n,r,i,s){var c=this;this.addReqTask(e,"MediaDesc",!1,function(u,l){i&&i(u,c.Df,l)},function(u){s&&s(u)}),this.Gf&&this.Gf.sendMediaDesc(e,t,n,r)},o.prototype.sendMediaDescUpdateReq=function(e,t,n,r,i){var s=this;this.addReqTask(e,"MediaDescUpdate",!1,function(c,u){r&&r(c,s.Df,u)},function(c){i&&i(c)}),this.Gf&&this.Gf.sendMediaDescUpdateReq(e,t,n)},o.prototype.sendCandidateInfo=function(e,t,n){var r=this,i=(0,E.Mo)();this.addReqTask(i,"CandidateInfo",!1,function(s,c){t&&t(s,r.Df,c)},function(s){n&&n(s)}),this.Gf&&this.Gf.sendCandidateInfo(i,this.Df,e)},o.prototype.sendCloseSession=function(e,t,n){var r=this;if(this.Df>0){var i=(0,E.Mo)();this.addReqTask(i,"CloseSession",!1,function(s,c){t&&t(s,r.Df,c)},function(s){n&&n(s)}),this.Gf&&this.Gf.sendCloseSession(i,this.Df,e)}},o.prototype.sendStreamStatus=function(e,t,n,r){var i,s=(0,E.Mo)(),c=this.isUseDC();if(this.addReqTask(s,"StreamStatus",c,function(l,a){n(l,a)},function(l){r&&r()}),this.useCmd&&this.Nf>=Xo&&this.peerId>0){this.an.info("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", seq: ").concat(s,", sendStreamStatus(").concat(e,", ").concat(t,"), dc:").concat(c));var u=Ji.WebrtcCmdReqMsg.encode({stream_status:{mic_status:t,camera_status:e,seq:s}}).finish();c&&this.isDCReady()?this.sendReqByDC(u):this.isCenterServerConnected&&((i=this.Gf)===null||i===void 0||i.sendGWCmdReq(this.Df,s,{peer_id:this.peerId,cmd_id:16,body:u}))}else this.Gf&&this.isCenterServerConnected&&this.Gf.sendStreamStatus(s,this.Df,e,t,this.streamId);return s},o.prototype.sendStreamAlignmentProperty=function(e){var t=this;return new te.l3(function(n){var r=(0,E.Mo)(),i=Ji.WebrtcCmdReqMsg.encode({stream_property_update:{enable_stream_alignment_when_mix:e,seq:r}}).finish(),s=t.isUseDC();t.addReqTask(r,"StreamPropertyUpdate",s,function(c){n(!0)},function(c){t.an.error("".concat(t.LOG_TAG,"  pid: ").concat(t.peerId,", seq: ").concat(r,", sendStreamPropertyUpdate error: ").concat(c)),n(!1)}),t.an.info("".concat(t.LOG_TAG,"  pid: ").concat(t.peerId,", seq: ").concat(r,", sendStreamAlignmentProperty(").concat(e,"), dc: ").concat(s)),s?t.sendReqByDC(i):t.Gf?t.Gf.sendGWCmdReq(t.Df,r,{peer_id:t.peerId,cmd_id:9,body:i}):n(!1)})},o.prototype.sendSEIUUID=function(e){return xc(this,void 0,void 0,function(){var t=this;return Bc(this,function(n){return[2,new te.l3(function(r,i){var s=(0,E.Mo)(),c=Ji.WebrtcCmdReqMsg.encode({usr_sei_filter:{sei_filter:e,seq:s}}).finish(),u=t.isUseDC();t.addReqTask(s,"usr_sei_filter",u,function(l){r(l)},function(l){i(l)}),t.an.info("".concat(t.LOG_TAG,"  pid: ").concat(t.peerId,", seq: ").concat(s,", sendSEIUUID:").concat(e,", dc: ").concat(u)),u?t.sendReqByDC(c):t.Gf?t.Gf.sendGWCmdReq(t.Df,s,{peer_id:t.zf,cmd_id:5,body:c}):i(E.Dg)})]})})},o.prototype.subscribeVideoStream=function(e){return xc(this,void 0,void 0,function(){var t=this;return Bc(this,function(n){return[2,new te.l3(function(r,i){var s=(0,E.Mo)(),c=Ji.WebrtcCmdReqMsg.encode({video_stream_sub:{type:e,seq:s}}).finish(),u=t.isUseDC();t.addReqTask(s,"video_stream_sub",u,function(l){r(l)},function(l){i(l)}),t.an.info("".concat(t.LOG_TAG,".dc  pid: ").concat(t.peerId,", seq: ").concat(s,", subscribeVideoStream:").concat(e,", dc: ").concat(u)),u?t.sendReqByDC(c):t.Gf?t.Gf.sendGWCmdReq(t.Df,s,{peer_id:t.zf,cmd_id:2,body:c}):i(E.Dg)})]})})},o.prototype.sendRestartIce=function(e,t){return xc(this,void 0,void 0,function(){var n=this;return Bc(this,function(r){return[2,new te.l3(function(i,s){var c=(0,E.Mo)(),u=Ji.WebrtcCmdReqMsg.encode({restart_ice:{ice_ufrag:e,ice_pwd:t,seq:c}}).finish(),l=n.isUseDC();n.addReqTask(c,"restart_ice",l,function(a){var h=Object.keys(a)[0];(0,te.M$)(a[h]),i(a)},function(a){s(a)}),n.an.info("".concat(n.LOG_TAG,".dc  pid: ").concat(n.peerId,", seq: ").concat(c,", iceUfrag:").concat(e,", icePwd:").concat(t,", dc: ").concat(l)),l?n.sendReqByDC(u):n.Gf?n.Gf.sendGWCmdReq(n.Df,c,{peer_id:n.zf,cmd_id:28,body:u}):s(E.Dg)})]})})},o.prototype.sendNetQualityGrade=function(e,t){var n=(0,E.Mo)(),r=Ji.WebrtcCmdReqMsg.encode({net_quality_grade:{rx_quality:e,tx_quality:t,seq:n}}).finish(),i=this.isUseDC();this.addReqTask(n,"net_quality_grade",i,function(s){},function(s){}),i?this.sendReqByDC(r):this.Gf&&this.Gf.sendGWCmdReq(this.Df,n,{peer_id:this.peerId,cmd_id:6,body:r})},o.prototype.sendBroadcasterStatus=function(e){var t,n=this,r=(0,E.Mo)(),i=this.isUseDC();if(this.addReqTask(r,"broadcaster_status",i,function(c,u){n.an.debug("".concat(n.LOG_TAG,"  pid: ").concat(n.peerId,", seq: ").concat(c,", BroadcasterStatusRsp: ").concat(JSON.stringify(u)))},function(c){n.an.error("".concat(n.LOG_TAG,"  pid: ").concat(n.peerId,", seq: ").concat(r,", sendBroadcasterStatus error: ").concat(c))}),this.useCmd&&this.Nf>=Xo&&this.peerId>0){this.an.info("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", seq: ").concat(r,", sendBroadcasterStatus(").concat(e,"), dc:").concat(i));var s=Ji.WebrtcCmdReqMsg.encode({broadcaster_status:{status:e,seq:r}}).finish();i?this.sendReqByDC(s):(t=this.Gf)===null||t===void 0||t.sendGWCmdReq(this.Df,r,{peer_id:this.peerId,cmd_id:17,body:s})}else this.Gf&&this.Gf.sendBroadcasterStatus(r,this.Df,e)},o.prototype.sendNetProbeReq=function(e,t){var n,r=this,i=(0,E.Mo)(),s=this.isUseDC();if(this.addReqTask(i,"net_quality_probe",s,function(u,l){r.an.debug("".concat(r.LOG_TAG,"  pid: ").concat(r.peerId,", seq: ").concat(u,", NetProbeRsp: ").concat(JSON.stringify(l))),e&&e(u,l)},function(u){r.an.error("".concat(r.LOG_TAG,"  pid: ").concat(r.peerId,", seq: ").concat(i,", sendNetProbeReq error: ").concat(u)),t&&t(u)}),this.useCmd&&this.Nf>=Xo&&this.peerId>0){this.an.info("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", seq: ").concat(i,", sendNetProbeReq, dc: ").concat(s));var c=Ji.WebrtcCmdReqMsg.encode({net_quality_probe:{seq:i,action:1}}).finish();s?this.sendReqByDC(c):(n=this.Gf)===null||n===void 0||n.sendGWCmdReq(this.Df,i,{peer_id:this.peerId,cmd_id:23,body:c})}else this.Gf&&this.Gf.sendNetProbe(i,this.Df,this.peerId)},o.prototype.getP2PNetStats=function(e,t){var n,r=this;if(this.peerId){var i=(0,E.Mo)(),s=this.isUseDC();if(this.addReqTask(i,"p2p_net_stats_get",s,function(u,l){r.an.debug("".concat(r.LOG_TAG,"  pid: ").concat(r.peerId,", seq: ").concat(u,", getP2PNetStatsRsp: ").concat(JSON.stringify(l))),e&&e(u,l)},function(u){r.an.error("".concat(r.LOG_TAG,"  pid: ").concat(r.peerId,", seq: ").concat(i,", getP2PNetStats error: ").concat(u)),t&&t(u)}),this.useCmd&&this.Nf>=Xo&&this.peerId>0){var c=Ji.WebrtcCmdReqMsg.encode({p2p_net_stats_get:{seq:i}}).finish();s?this.sendReqByDC(c):(n=this.Gf)===null||n===void 0||n.sendGWCmdReq(this.Df,i,{peer_id:this.peerId,cmd_id:26,body:c})}else this.Gf&&this.Gf.getP2PNetStats(i,this.Df,this.peerId)}else this.an.warn("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId," invalid, getP2PNetStats)"))},o.prototype.ActivatePlayAudioStream=function(e,t,n){var r,i=this,s=(0,E.Mo)(),c=this.isUseDC();if(this.addReqTask(s,"active_audio_play",c,function(l,a){i.an.info("".concat(i.LOG_TAG,"  pid: ").concat(i.peerId,", seq: ").concat(l,", ActivatePlayAudioStreamRsp: ").concat(JSON.stringify(a))),t&&t(l,a)},function(l){i.an.error("".concat(i.LOG_TAG,".dc  pid: ").concat(i.peerId,", seq: ").concat(s,", ActivatePlayAudioStream error: ").concat(l)),n&&n(l)}),this.useCmd&&this.Nf>=Xo&&this.peerId>0){this.an.info("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", seq: ").concat(s,", ActivatePlayAudioStream(").concat(e,"), dc: ").concat(c));var u=Ji.WebrtcCmdReqMsg.encode({active_audio_play:{active:e?0:1,seq:s}}).finish();c?this.sendReqByDC(u):(r=this.Gf)===null||r===void 0||r.sendGWCmdReq(this.Df,s,{peer_id:this.peerId,cmd_id:20,body:u})}else this.Gf&&this.Gf.ActivatePlayAudioStream(s,this.Df,e)},o.prototype.ActivatePlayVideoStream=function(e,t,n){var r,i=this,s=(0,E.Mo)(),c=this.isUseDC();if(this.addReqTask(s,"active_video_play",c,function(l,a){i.an.debug("".concat(i.LOG_TAG,"  pid: ").concat(i.peerId,", seq: ").concat(l,", ActivatePlayVideoStreamRsp: ").concat(JSON.stringify(a))),t&&t(l,a)},function(l){i.an.error("".concat(i.LOG_TAG,"  pid: ").concat(i.peerId,", seq: ").concat(s,", ActivatePlayVideoStream error: ").concat(l)),n&&n(l)}),this.useCmd&&this.Nf>=Xo&&this.peerId>0){this.an.info("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", seq: ").concat(s,", ActivatePlayVideoStream(").concat(e,"), dc: ").concat(c));var u=Ji.WebrtcCmdReqMsg.encode({active_video_play:{active:e?0:1,layer:0,seq:s}}).finish();c?this.sendReqByDC(u):(r=this.Gf)===null||r===void 0||r.sendGWCmdReq(this.Df,s,{peer_id:this.peerId,cmd_id:21,body:u})}else this.Gf&&this.Gf.ActivatePlayVideoStream(s,this.Df,e)},o.prototype.activateSEIInsert=function(e,t,n,r){var i,s=this,c=(0,E.Mo)(),u=this.isUseDC();if(this.addReqTask(c,"active_sei_insert",u,function(a,h){s.an.debug("".concat(s.LOG_TAG,"  pid: ").concat(s.peerId,", seq: ").concat(a,", activateSEIInsertRsp: ").concat(JSON.stringify(h))),n&&n(a,h)},function(a){s.an.error("".concat(s.LOG_TAG,"  pid: ").concat(s.peerId,", seq: ").concat(c,", activateSEIInsert error: ").concat(a)),r&&r(a)}),this.useCmd&&this.Nf>=Xo&&this.peerId>0){this.an.info("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", seq: ").concat(c,", activateSEIInsert(").concat(e,", ").concat(t,"), dc: ").concat(u));var l=Ji.WebrtcCmdReqMsg.encode({active_sei_insert:{seq:c,action:e,info_type:t}}).finish();u?this.sendReqByDC(l):(i=this.Gf)===null||i===void 0||i.sendGWCmdReq(this.Df,c,{peer_id:this.peerId,cmd_id:25,body:l})}else this.Gf&&this.Gf.activateSEIInsert(c,this.Df,this.peerId,e,t)},o.prototype.sendPlayStats=function(e){var t,n=(0,E.Mo)(),r=this.isUseDC();if(this.Nf>=83886081&&this.peerId>0){this.an.debug("".concat(this.LOG_TAG,"  pid: ").concat(this.peerId,", seq: ").concat(n,", sendPlayStats(").concat(e,"}), dc: ").concat(r));var i=Ji.WebrtcCmdReqMsg.encode({play_stats:{seq:n,audio_jitter_ms:e}}).finish();return r?this.sendReqByDC(i):(t=this.Gf)===null||t===void 0||t.sendGWCmdReq(this.Df,n,{peer_id:this.peerId,cmd_id:27,body:i}),!0}return!1},o}();(function(o){o[o.UserData=1]="UserData",o[o.Cmd=2]="Cmd",o[o.Signal=11]="Signal",o[o.TcPadding=12]="TcPadding",o[o.TcFeedback=13]="TcFeedback"})(ya||(ya={}));var Za,Gu,Uc,ip=function(){function o(){this.il=0,this.nl=0,this.el=0}return o.prototype.reset=function(){this.il=0,this.nl=0,this.el=0},o.prototype.setGenDataInKbps=function(e){e>5e3&&(e=5e3),this.il=Math.floor(e/8)},Object.defineProperty(o.prototype,"sendBytesOnems",{get:function(){return this.il},enumerable:!1,configurable:!0}),o.prototype.generatePadding=function(){if(this.il<1)return 0;var e=Math.floor(performance.now());if(this.el===0)return this.el=e,this.nl=0,0;var t=e-this.el;if(t<3)return 0;if(this.el=e,t>500)return this.nl=0,0;var n=t*this.il+this.nl;return n<600?(this.nl=n,0):(this.nl=0,n)},o}();(function(o){o[o.Normal=0]="Normal",o[o.Control=1]="Control"})(Za||(Za={})),function(o){o[o.UNDERUSE=-1]="UNDERUSE",o[o.NORMAL=0]="NORMAL",o[o.OVERUSE=1]="OVERUSE",o[o.OVERUSE_DUE_PKT_LOST=2]="OVERUSE_DUE_PKT_LOST"}(Gu||(Gu={})),function(o){o[o.Default=-1]="Default",o[o.NoVideo=0]="NoVideo"}(Uc||(Uc={}));var op=function(){function o(e,t){this.an=e,this.enable=!0,this.isStart=!1,this.maxAudioBitrate=48,this.maxVideoBitrate=0,this.startVideoBitrate=0,this.minVideoBitrate=0,this.targetVideoBitrate=0,this.referenceVideoBitrate=-1,this.firstStatsUpdateTs=0,this.lastStatsUpdateTs=0,this.lastAvailableOutgoingBitrate=0,this.lastVideoActualEncBitrate=0,this.videoActualEncBitrateList=[],this.nackCountList=[],this.lastNackCount=0,this.tcState=Za.Normal,this.continueUpCount=0,this.lastUpdateTargetVideoBitrateTime=0,this.updateTargetVideoBitrateCount=0,this.enable_debug_log=!1,this.rl=!0,this.sl=Uc.Default,this.ol=new ip,this.Pf=null,this.ul=0,this.al=0,this.cl={first:!0,seq:0,status:Gu.UNDERUSE,bandwide:0,targetBitrate:0,rtt:0},this.hl=0,this.fl=0,this.ll=0,this.dl=0,this.vl=0,this.ml=!1,this.bl=!1,this._l=null,this.test_padding=0,this.pn=t}return o.prototype.updateVideoTargetBitrate=function(e){},o.prototype.pauseVideo=function(){},o.prototype.resumeVideo=function(){},o.prototype.reset=function(){this.test_padding=0,this.enable=!0,this.maxAudioBitrate=48,this.maxVideoBitrate=0,this.startVideoBitrate=0,this.minVideoBitrate=0,this.targetVideoBitrate=0,this.referenceVideoBitrate=-1,this.firstStatsUpdateTs=0,this.lastStatsUpdateTs=0,this.lastAvailableOutgoingBitrate=0,this.lastVideoActualEncBitrate=0,this.videoActualEncBitrateList.length=0,this.nackCountList.length=0,this.lastNackCount=0,this.tcState=Za.Normal,this.continueUpCount=0,this.lastUpdateTargetVideoBitrateTime=0,this.updateTargetVideoBitrateCount=0,this.rl=!0,this.sl=Uc.Default,this.ol.reset(),this.Pf=null,this.ul=0,this.al=0,this.cl.first=!0,this.cl.seq=0,this.cl.status=Gu.UNDERUSE,this.cl.bandwide=0,this.cl.targetBitrate=0,this.hl=0,this.fl=0,this.ll=0,this.dl=0,this.vl=0,this.ml=!1,this.bl=!1,this.clearProeTimer()},o.prototype.enableVideo=function(e){this.rl=e},o.prototype.setDatachannel=function(e){this.Pf=e},o.prototype.setMinVideoBitrateMode=function(e){e===0&&(this.sl=e)},o.prototype.getMinVideoBitrateMode=function(){return this.sl},o.prototype.getBandwide=function(){return this.cl.bandwide},o.prototype.getFeedback=function(){return this.cl},o.prototype.start=function(){this.isStart||(this.targetVideoBitrate=this.maxVideoBitrate,this.enable&&this.referenceVideoBitrate>0&&(this.startVideoBitrate&&this.startVideoBitrate<this.maxVideoBitrate?this.targetVideoBitrate=this.startVideoBitrate:this.referenceVideoBitrate<=this.minVideoBitrate?this.targetVideoBitrate=this.minVideoBitrate:this.referenceVideoBitrate<this.maxVideoBitrate&&(this.targetVideoBitrate=Math.max(this.referenceVideoBitrate,50))),this.an.info("".concat(ie.BsE," start ").concat(this.enable,", v[").concat(this.startVideoBitrate,"|").concat(this.maxVideoBitrate,"|").concat(this.minVideoBitrate,"], ref:").concat(this.referenceVideoBitrate,", tg:").concat(this.targetVideoBitrate,", vmode:").concat(this.sl,", a[").concat(this.maxAudioBitrate,"]")),this.isStart=!0)},o.prototype.stop=function(){this.isStart&&this.an.info("".concat(ie.BsE," stop")),this.isStart=!1,this.reset()},o.prototype.setEnable=function(e){this.enable=e},o.prototype.isEnable=function(){return this.enable},o.prototype.setMinVideoBitrate=function(e){e>0&&(this.minVideoBitrate=e)},o.prototype.getMinVideoBitrate=function(){return this.minVideoBitrate},o.prototype.setStartVideoBitrate=function(e){e>0&&(this.startVideoBitrate=e)},o.prototype.getStartVideoBitrate=function(){return this.startVideoBitrate},o.prototype.setVideoBitrate=function(e){e&&(this.maxVideoBitrate>0&&this.an.info("".concat(ie.BsE," setVideoBitrate ").concat(this.maxVideoBitrate," => ").concat(e)),this.maxVideoBitrate=e,this.targetVideoBitrate=e)},o.prototype.setAudioBitrate=function(e){this.maxAudioBitrate=e},o.prototype.setReferenceVideoBitrate=function(e){this.referenceVideoBitrate=e},o.prototype.getTargetVideoBitrate=function(){return this.targetVideoBitrate},o.prototype.onStatsUpdated=function(e){if(this.enable){var t=1e3*e.audioRtxBitrate;this.ul=Math.floor(1e3*e.audioBitrate),this.al=Math.floor(t);var n=e.availableOutgoingBitrate?e.availableOutgoingBitrate:0,r=e.actualEncBitrate?e.actualEncBitrate:0;if(this.firstStatsUpdateTs!=0||e.videoBitrate!=0){var i=Date.now();if(this.targetVideoBitrate<this.maxVideoBitrate){var s=0;n>this.lastAvailableOutgoingBitrate?this.continueUpCount++:n<this.lastAvailableOutgoingBitrate&&(this.tcState=Za.Control,this.continueUpCount=0);var c=this.targetVideoBitrate;this.tcState==Za.Normal?n==0||n<=3e5?(s=1,c*=this.updateTargetVideoBitrateCount<3?1.05:this.updateTargetVideoBitrateCount<6?1.1:1.15):(s=2,c*=n&&n>=this.lastAvailableOutgoingBitrate?1.3:1.15,(this.continueUpCount>5||this.lastUpdateTargetVideoBitrateTime>0&&i-this.lastUpdateTargetVideoBitrateTime>5e3)&&(c=this.maxVideoBitrate)):this.continueUpCount>0?(n&&n>1e3*this.targetVideoBitrate*.8||this.continueUpCount>=2)&&(s=3,c*=this.continueUpCount<3?1.05:this.continueUpCount<6?1.1:1.2):this.lastUpdateTargetVideoBitrateTime>0?i-this.lastUpdateTargetVideoBitrateTime+50>=2e3&&(s=4,c*=1.1):this.firstStatsUpdateTs&&i-this.firstStatsUpdateTs+50>=4e3&&(s=5,c*=1.1),c=Math.min(c,this.maxVideoBitrate),(c=Math.max(c,50))!=this.targetVideoBitrate&&((!this.updateTargetVideoBitrateCount||c>=this.maxVideoBitrate)&&this.an.info("".concat(ie.BsE," update video maxbitrate: ").concat(this.targetVideoBitrate," => ").concat(c,", ").concat(s)),this.targetVideoBitrate=c,this.updateTargetVideoBitrateCount++,this.lastUpdateTargetVideoBitrateTime=i,this.updateVideoTargetBitrate(c))}this.lastAvailableOutgoingBitrate=n,this.lastVideoActualEncBitrate=r,this.lastStatsUpdateTs=i,this.firstStatsUpdateTs||(this.firstStatsUpdateTs=i),this.videoActualEncBitrateList.push(r),this.videoActualEncBitrateList.length>5&&this.videoActualEncBitrateList.shift();var u=e.nackCount-this.lastNackCount;this.lastNackCount=e.nackCount,this.nackCountList.push(u),this.nackCountList.length>5&&this.nackCountList.shift()}}},o.prototype.getLastVideoBitrate=function(){if(!this.firstStatsUpdateTs||this.lastStatsUpdateTs-this.firstStatsUpdateTs<1e4||Date.now()-this.lastStatsUpdateTs>1e4)return 0;var e=Math.max.apply(null,this.nackCountList),t=50;if(this.lastAvailableOutgoingBitrate>0){if(this.lastAvailableOutgoingBitrate>=1.2*this.maxVideoBitrate*1e3||e==0&&this.lastAvailableOutgoingBitrate==3e5)return-1;t=Math.max(this.lastAvailableOutgoingBitrate/1e3,this.lastVideoActualEncBitrate)}else if(t=Math.max.apply(null,this.videoActualEncBitrateList),e==0&&t>.8*this.targetVideoBitrate||t>.8*this.maxVideoBitrate)return-1;return t=Math.max(t,50)},o.prototype.compare16BitsSeq=function(e,t){var n=e-t;return n<-32767?n=e+65535-t+1:n>32767&&(n=e-(t+65535)-1),n},o.prototype.handleFeedback=function(e){var t=e.byteLength-1;if(!(t<9)){var n=new Uint8Array(e,1,t),r=n[0]<<8|n[1],i=new DataView(e).getInt8(3),s=n[3]<<8|n[4],c=n[5]<<8|n[6],u=n[7]<<8|n[8];this.cl.first||this.compare16BitsSeq(r,this.cl.seq)>0?(this.cl.first=!1,this.cl.seq=r,this.cl.status=i,this.cl.bandwide=1e3*s,this.cl.targetBitrate=1e3*c,this.cl.rtt=u,this.processBandwide()):this.an.debug("".concat(ie.BsE," handleFeedback, seq reorder: ").concat(this.cl.seq,", ").concat(r))}},o.prototype.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},o.prototype.sendPaddingData=function(){if(this.Pf&&this.Pf.readyState=="open"){var e=this.getRandomInt(500,1e3);if(e>this.fl&&(e=this.fl),this.Pf.bufferedAmount>32e3)return this.fl-=e,void(this.fl<0&&(this.fl=0));var t=Math.floor(performance.now());if(e>0&&e<1144){var n=new Uint8Array(e+7);n[0]=ya.TcPadding,n[1]=this.hl>>8&255,n[2]=255&this.hl,n[3]=t>>24&255,n[4]=t>>16&255,n[5]=t>>8&255,n[6]=255&t,this.hl++,this.hl>=65536&&(this.hl=0),this.Pf.send(n),this.fl-=n.byteLength,this.fl<0&&(this.fl=0)}}},o.prototype.processBandwide=function(){if(!(!this.enable||!this.rl||!this.Pf||this.cl.bandwide<=0||this.cl.targetBitrate<=0||this.ul<=0||this.sl!=Uc.NoVideo)){var e,t=this.ul,n=this.minVideoBitrate<=0?5e4:this.minVideoBitrate,r=this.cl.status,i=this.cl.targetBitrate,s=this.cl.bandwide;e=this.cl.rtt>=300?this.cl.bandwide:i;var c=n+t+4e4;if(r>0?((s<=n+4e4||s<=1e5)&&(this.dl++,this.ml===!1&&(this.pauseVideo(),this.ml=!0)),this.vl=0):r<=0&&(e>c||i>1.5*c)&&(this.dl=0,this.vl++,(e>1.2*c&&e>15e4||this.vl>25||i>1.8*c&&i>25e4)&&this.ml&&(this.bl=!1,this.ml=!1,this.stopBandWideProbe(),this.resumeVideo())),this.ml){var u=i-t;u>0&&r<=0?(this.ll=u,this.ol.setGenDataInKbps(u/1e3),this.bl||(this.bl=!0),this._l||this.startBandWideProbe()):this.stopBandWideProbe()}}},o.prototype.startBandWideProbe=function(){var e=this;this.clearProeTimer(),this.bl&&(this._l=setTimeout(function(){var t=e.ol.generatePadding();if(e.fl+=t,e.ll>0)for(var n=e.ll/16e4+1,r=0;r<n;r++)e.fl>0&&e.sendPaddingData();e.startBandWideProbe()},40))},o.prototype.stopBandWideProbe=function(){this.ll=0,this.fl=0,this.ol.reset(),this.clearProeTimer()},o.prototype.clearProeTimer=function(){this._l&&(clearTimeout(this._l),this._l=null)},o}(),sp=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},ap=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},th=function(){function o(e,t,n){this.gn=e,this.yl=100,this.an=ei(t,n)}return o.prototype.getMiniSdp=function(e){var t=this,n="zc.s.gmsdp";return this.an.info("".concat(n," lSDP:").concat(e.length," isMini")),new te.l3(function(r,i){return sp(t,void 0,void 0,function(){var s,c,u,l,a=this;return ap(this,function(h){return s=this.gn.miniSdpWorker,c=function(m){a.an.error("".concat(n," error:").concat(JSON.stringify(m))),i(m)},l=function(){u&&(clearTimeout(u),u=null)},e?s?(s.parseToMiniSdp(e).then(function(m){if(a.an.info("".concat(n," parse sdp success buffer:").concat(m==null?void 0:m.byteLength)),l(),!m||!m.byteLength)return c(Et.KbN);r(m)}).catch(function(m){return l(),c(m)}),u=setTimeout(function(){a.an.info("".concat(n," get minisdp timeout")),c(Et.dNl)},this.yl),[2]):[2,c(Et.BMv)]:[2,c({code:Et.KbN.code,message:"sdp error"})]})})})},o.prototype.parseMiniSdp=function(e){var t=this,n="zc.s.prsdp";return this.an.info("".concat(n," rSDP:").concat(e.length," isMini")),new te.l3(function(r,i){var s,c=e,u=t.gn.miniSdpWorker,l=function(h){t.an.error("".concat(n," error:").concat(JSON.stringify(h))),i(h)},a=function(){s&&(clearTimeout(s),s=null)};if(!c||!c.byteLength)return l({code:Et.TgN.code,message:"buffer error"});u?(u.loadMiniSdpToOriginSdp(c).then(function(h){t.an.info("".concat(n," parse minisdp success sdp:").concat(h.length)),a(),h?r(h):l(Et.TgN)}).catch(function(h){a(),l(h)}),s=setTimeout(function(){t.an.info("".concat(n," parse minisdp timeout")),l(Et.dNl)},t.yl)):l(Et.BMv)})},o}(),cp=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))};function up(o){var e,t=o,n=function(i){var s={m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"}]};function c(m,S,x){var q=function(ke){return String(Number(ke))===ke?Number(ke):ke},V=m.name&&m.names;m.push&&!S[m.push]?S[m.push]=[]:V&&!S[m.name]&&(S[m.name]={});var _e=m.push?{}:V?S[m.name]:S;(function(ke,Pe,Oe,Ge){if(Ge&&!Oe)Pe[Ge]=q(ke[1]);else for(var Je=0;Je<Oe.length;Je+=1)ke[Je+1]!=null&&(Pe[Oe[Je]]=q(ke[Je+1]))})(x.match(m.reg),_e,m.names,m.name),m.push&&S[m.push].push(_e)}var u=RegExp.prototype.test.bind(/^([a-z])=(.*)/),l=[],a={},h=a;return i.split(/(\r\n|\r|\n)/).filter(u).forEach(function(m){var S=m[0],x=m.slice(2);S==="m"&&(l.push({rtp:[],fmtp:[]}),h=l[l.length-1]);for(var q=0;q<(s[S]||[]).length;q+=1){var V=s[S][q];if(V.reg&&V.reg.test(x))return c(V,h,x)}}),a.media=l,a}(o),r=[];return n.media.forEach(function(i){i.type==="video"&&i.fmtp.forEach(function(s){e="a=fmtp:"+s.payload+" "+s.config,s.config.indexOf("sps-pps-idr-in-keyframe")===-1&&r.indexOf(e)===-1&&r.push(e)})}),r.forEach(function(i){t=t.replace(new RegExp(i,"g"),i+";sps-pps-idr-in-keyframe=1")}),t}function nh(o){for(var e=o.split(`\r
`).filter(function(c){return!c.trim().startsWith("a=extmap-allow-mixed")}),t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.push(i),i.trim().startsWith("a=group:BUNDLE")&&t.push("a=extmap-allow-mixed")}var s=t.map(function(c){return c.trim().startsWith("a=extmap")&&c.includes("/recvonly")?c.replace("/recvonly",""):c});return s.join(`\r
`)}var lp=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ni=function(){return Ni=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},Ni.apply(this,arguments)},$i=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},eo=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},to,jl=new Uint8Array([0,0,0,1,101,184,0,4,0,0,9,255,254,222,35,192,166,30,73,128]),Wl=new Uint8Array([0,0,0,1,103,77,64,51,140,141,78,64,60,34,17,168,0,0,0,1,104,238,60,128]),Ql=new Uint8Array([0,0,0,1,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,30,186,2,64,0,0,0,1,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,30,160,136,69,150,233,111,11,128,64,0,0,3,0,64,0,0,3,3,194,0,0,0,1,68,1,192,115,192,137]),Jl=new Uint8Array([0,0,0,1,40,1,172,26,224,244,133,49,47,246,227,105,128]),Li=k.Og,fi=k.v2,Eo=k.ch,Or=Li.error,zs=k.Jv,Kl=function(o){function e(t,n,r,i,s,c,u,l){var a,h=o.call(this,n,t)||this;return h.ipV6Prefer=0,h.ipStackNode=Y.IPv4,h.Sl=!1,h.El=[],h.kl=[],h.Ol=[],h.Il="",h.Tl="",h.Cl=500,h.startTime=0,h.Al=!0,h.port=0,h.zl=null,h.Dl=null,h.Nl=3e3,h.Pl=3e3,h.Ml=16,h.xl=16,h.jl={state:"NO_PUBLISH",code:0},h.ql=!1,h.supportTransceiver=!0,h.$u=!1,h.Ll=0,h.Ul=0,h.Gl=0,h.Jl=0,h.Fl=0,h.publishedTimeStamp=0,h.firstPublishedTimeStamp=0,h.validPublishedTime=0,h.errorTimes=0,h.hasSucceed=!1,h.lastFailTimeLen=0,h._state=7,h.lastState=7,h.Df=0,h.Hl=[],h.Vl=null,h.Ql=null,h.Yl=null,h.Kl=null,h.parentSpanKey="",h.Zl=0,h.Xl=null,h.Wl=!1,h.$l=[],h.td=[],h.nd="H264",h.ed=se.stop,h.isExternal=!1,h.rd=25e3,h.sd=!1,h.od="",h.ud=[],h.ipNode=null,h.ipV4NodeList=[],h.ipV6NodeList=[],h.ad=0,h.retryFailGwNodes=[],h.retryFailIpV4Nodes=[],h.retryFailIpV6Nodes=[],h.hd=!1,h.fd=0,h.ld=!1,h.vd=0,h.md=0,h.pd=[],h.gd=[],h.bd=[],h._d=!1,h.yd="",h.Sd=!1,h.Ed="",h.kd="",h.Od=!0,h.Id=0,h.probeQuality=0,h.probeTime=0,h.probeNodeList=[],h.probedList=[],h.probeTimer=null,h.Rd=0,h.Td=0,h.poorQualityRetryCnt=0,h.Cd=[],h.continuousFailCnt=0,h.isUpdateSDP=!1,h.toBeReplacedTracks={},h.send_seq=0,h.dataChannelState=0,h.Ad=0,h.zd=0,h.Dd="",h.Nd=[],h.Pd=[],h.Md={forceSynchronousNetworkTime:0,alignment:0},h.xd={isSEIStart:!1,SEIType:Ye.ZegoDefined,unregisterSeiFilter:"",uuidSend:!1,track:null},h.jd=0,h.reportPublishStateTime=0,h.isRePublish=!1,h.rtcPublishCount=0,h.stopReason="",h.signalTime=0,h.qd=((a={}).PublishEventPush={seq:-1,time:0},a.ClientInfoPush={seq:-1,time:0},a),h.Ld=!0,h.Bd=!1,h.ip="",h.Ud={lanIP:"",wanIP:"",intranet:!1},h.encodeLowVideoFrame=function(m,S){h.encodeFrame(m,S,!0)},h.encodeVideoFrame=function(m,S){h.xd.track?h.encodeFrameAudioOnly(m,S,!1):h.encodeFrame(m,S,!1)},h.recvLastKeyFrameTime=0,h.camera_status=2,h.mic_status=2,h.Gd=!1,h.Fd=0,h.Hd=void 0,h.ou={onUaSocketConnected:function(){var m;h.info("zc.p.0.eh.0 ".concat((m=h.Hd)===null||m===void 0?void 0:m.length," gwNode: ").concat(h.od)),h.Hd&&(h.od="",h.getDispatchIPNodeMode(),h.Vd.apply(h,h.Hd),h.Hd=void 0)}},h.id=In("".concat(c.appid,"_").concat(u.idName,"_").concat(t,"_").concat(Date.now(),"_").concat((0,E.Mo)())),h.va=t,h.dataReport=r,h.qualityTimeInterval=i,h.gn=c,h.pn=u,h.nd=h.au("publish_video_codec"),h.mn=l,h.xu=l.localStream,h.Qd=l.zegoCaptureStream,h.$u=h.pn.isMiniSdp,h.$u&&(h.Yd=new th(c,n,t)),h.Kd=new eh(n,!0,t),h.Zd=new op(h,u),h.Qd&&h.Qd.startPublish(),l.onAudioTrackChange=function(m){var S=h.audioSender;h.previewer.isAudioEnabled&&(S?(S.replaceTrack(m),h.info("zc.oatc remote audio track change success")):h.warn("zc.oatc stream has not sender"))},h.initStreamReport(),h.qualityHandler=new rp(h.qualityTimeInterval,s,h,n,h.dataReport,h.pn,h.gn),h.qualityHandler.onPublishingError=function(m){h.publishStateUpdateError(m)},h}return lp(e,o),Object.defineProperty(e.prototype,"Xd",{get:function(){return this.gn.agentIpStackDetection.IPv4===H.reachable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"signal",{get:function(){return this.Wd},enumerable:!1,configurable:!0}),e.prototype.updateCBState=function(t){var n=this,r=Object.keys(t).some(function(i){return t[i]!==n.jl[i]});return r&&(this.jl=t),r},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(t){this.lastState=this._state,this._state=t},enumerable:!1,configurable:!0}),e.prototype.createSEIWorker=function(){return this.gn.createSEIWorker()},Object.defineProperty(e.prototype,"seiWorker",{get:function(){return this.gn.seiWorker},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"videoInfo",{get:function(){return this.Ka},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Ka",{get:function(){return this.previewer.videoInfo},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"targetVBitrate",{get:function(){return this.camera_status===0?this.Ka.bitRate:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lowStreamVBitrate",{get:function(){return this.mn.lowStreamConfig.bitRate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Sc",{get:function(){return this.previewer.mediaStreamConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"streamId",{get:function(){return this.va},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localStream",{get:function(){return this.xu},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"peerConnection",{get:function(){return this.Xl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stateNego",{get:function(){return this.ed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"publishOption",{get:function(){return this.$d},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gwNode",{get:function(){return this.od},set:function(t){this.od=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gwNodeList",{get:function(){return this.ud},set:function(t){this.ud=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gwNodesTTL",{get:function(){return this.ad},set:function(t){this.ad=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isNodesEmpty",{get:function(){return this.ipNodeType===A.ZV4Only?this.ud.length===0:this.ipNodeType===A.ZV4Priority?this.ipV4NodeList.length===0:(this.ipNodeType===A.ZV6Priority||this.ipV4NodeList.length===0)&&this.ipV6NodeList.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPeer",{get:function(){return this.Od},set:function(t){this.Od=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"peerID",{get:function(){return this.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataChannel",{get:function(){return this.Pf},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sideMediaConfig",{get:function(){return this.xd},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"publishStat",{get:function(){return this.qualityHandler.publishStat},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previewer",{get:function(){return this.mn},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"probeState",{get:function(){return this.qualityHandler.probeState},set:function(t){this.qualityHandler.probeState=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"netQuality",{get:function(){return this.qualityHandler.hf},set:function(t){this.qualityHandler.hf=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"qualityGrade",{get:function(){var t=this.qualityHandler.Wh;return Math.max(t.video.videoQuality,t.audio.audioQuality)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLowVideoQuality",{get:function(){var t,n,r,i,s,c;if(this.camera_status!==0)return!1;var u=this.videoInfo.width||((n=(t=this.videoSender)===null||t===void 0?void 0:t.track)===null||n===void 0?void 0:n.getSettings().width),l=this.videoInfo.height||((i=(r=this.videoSender)===null||r===void 0?void 0:r.track)===null||i===void 0?void 0:i.getSettings().height),a=this.qualityHandler.Wh.video;if(u&&l&&u>a.frameWidth&&u>a.frameHeight)return!0;var h=this.videoInfo.frameRate||((c=(s=this.videoSender)===null||s===void 0?void 0:s.track)===null||c===void 0?void 0:c.getSettings().frameRate);return!!(h&&h-a.videoFPS>5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastPublishStats",{get:function(){return this.qualityHandler.cf},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webrtcProtocol",{get:function(){return this.qualityHandler.df},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lowStream",{get:function(){var t;return(t=this.mn)===null||t===void 0?void 0:t.lowStream},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStateRetry",{get:function(){return[se.stop,se.iceClosed,se.iceFailed].includes(this.ed)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iceStateDisConnect",{get:function(){return[se.iceClosed,se.iceDisconnected,se.iceFailed].includes(this.ed)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLastConnected",{get:function(){return this.lastState===6},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"netProtocol",{get:function(){return this.Bd?"tcp":this.Ld?this.webrtcProtocol:"udp"},enumerable:!1,configurable:!0}),e.prototype.au=function(t,n){return n===void 0&&(n=!1),this.pn.settingConfig.getSetting(t,n)},Object.defineProperty(e.prototype,"Xh",{get:function(){return this.state===6},enumerable:!1,configurable:!0}),e.prototype.isTcVideoPasued=function(){return this._d},e.prototype.setSendMuteImage=function(t){this.Sd=t},e.prototype.setSignal=function(t){this.Wd!==t&&(this.Wd=t,this.Kd.webrtcCenterServerSignal=t)},e.prototype.initStreamReport=function(){this.tv=this.cr.createSpan(E.t0.I,{key:k.Og.event,par:this.va},{key:fi.event,par:this.va},fi.event,!0),this.jd=new Date().getTime()},e.prototype.checkAutoTcp=function(){var t=mt();this.info("zc.p.0.cat  ".concat(t," ").concat(this.Od)),this.Ld=!(!t||!this.Od)},e.prototype.publishStateUpdateError=function(t,n,r,i){this.error(ie.CcO+"  call "+JSON.stringify(t));var s=this.cr.createSpan(E.t0.H,{key:k.Og.event,par:this.va},{key:""},k._T.event);s.setAttributes({error:t==null?void 0:t.code,message:t==null?void 0:t.message}),s.end(),this.va&&this.onPublishStateUpdate(E.eZ.error,this.va,t,n,r,i),this.info(ie.CcO+"  ended")},e.prototype.netProbeToReDispatch=function(t,n){var r;t===void 0&&(t=function(){}),n===void 0&&(n=function(){}),this.ql=!0;var i=(r=this.gn.publisherList[this.va])===null||r===void 0?void 0:r.retryStreamHandler;i&&i.dispatchGwNodesBypass(this,t,n)},e.prototype.resetPublish=function(t){this.info(ie.zC0+" call");var n=this.Zd.getLastVideoBitrate();if(n){var r=this.Zd.getBandwide();this.info("".concat(ie.BsE," update ref bitrate: ").concat(n,", bw: ").concat(r)),this.gn.updateReferenceBitrate(n)}this.closeSession(t),this.state=7,this.sd=!1,this.Xl==null&&this.Xl==null||(this.Xl.close(),this.Xl=null,this.videoSender=void 0,this.lowVideoSender=void 0,this.audioSender=void 0),this.nv&&(this.nv=null),this.ev&&(this.ev=null),this.resetIceInfos(),this.resetNat64Infos(),this.Dd="",this.ip="",this.Dl&&(this.Dl=null),this.rv!==null&&(clearTimeout(this.rv),this.rv=null),this.sv!==null&&(clearTimeout(this.sv),this.sv=null),this.av!=null&&(clearTimeout(this.av),this.av=null),this.cv!=null&&(clearTimeout(this.cv),this.cv=null),this.hv&&(clearTimeout(this.hv),this.hv=null),this.fv&&(clearTimeout(this.fv),this.fv=null),this.qualityHandler.clearPublishQualityTimer(),this._clearCanvasTimer(),this.unregisterMsgCallback(),this.Kd.reset(),this.lv=0,this.Zl=0,this.Hl=[],this.Hd=void 0,this.resetEncBitrate(),this.isUpdateSDP=!1,this._d=!1,this.yd="",this.Sd=!1,this.Ed="",this.kd="",this.Ml=16,this.xl=16},e.prototype._clearCanvasTimer=function(){var t;this.Vl!=null&&(clearInterval(this.Vl),(t=this.xd.track)===null||t===void 0||t.stop(),this.xd.track=null,this.Vl=null,this.Ql=null,this.Yl=null,this.Kl=null)},e.prototype.resetPushCmdSeqMap=function(){var t;this.qd=((t={}).PublishEventPush={seq:-1,time:0},t.ClientInfoPush={seq:-1,time:0},t)},e.prototype.dv=function(){var t=this;this.Kd.registerPushCallback("CloseSessionPush",function(n,r,i){i.reason===32&&(t.$u=!1,t.pn.$u=!1,t.Jl=performance.now()-t.Fl),t.vv(n,r,i)}),this.Kd.registerPushCallback("SessionResetPush",function(n,r,i){t.mv(n,r,i)}),this.Kd.registerPushCallback("PublishEventPush",function(n,r,i){t.pv(n,r,i)}),this.Kd.registerPushCallback("ClientInfoPush",function(n,r,i){t.gv(n,i.peer_id,i.clientip||i.client_ip)}),this.Kd.registerPushCallback("PublishNetStatNotify",function(n,r,i){t.qualityHandler.updateGwPublishNetState({videoRecvBitrate:i.video_recv_bitrate,trafficControlStat:i.traffic_control_stat,videoLostRate:i.video_lost_rate,audioRecvBitrate:i.audio_recv_bitrate,audioLostRate:i.audio_lost_rate})})},e.prototype.unregisterMsgCallback=function(){this.Kd.unregisterPushCallback("CloseSessionPush"),this.Kd.unregisterPushCallback("SessionResetPush"),this.Kd.unregisterPushCallback("PublishEventPush"),this.Kd.unregisterPushCallback("ClientInfoPush")},e.prototype.startPublish=function(t,n,r,i){var s,c,u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je,tt,ut,vt,gt=this;if(this.info(ie.QRg+" called"),t){if(this.checkAutoTcp(),this.$u&&!this.Fl&&(this.Fl=performance.now()),this.state=0,this.Wl=!1,this.xu=n,this.$d=r||{},this.Zd.stop(),this._d=!1,this.yd="",(0,R.dd)(this.$d.enableDTX)){var Pt=this.au("dtx",!0);this.$d.enableDTX=Pt!==void 0?!!Pt:this.$d.enableDTX}else this.$d.enableDTX=!!this.au("dtx");var wt;!((s=this.$d)===null||s===void 0)&&s.SEIType&&(this.xd.SEIType=this.$d.SEIType),this.qualityHandler.Wh.video.muteState=!((u=(c=this.mn)===null||c===void 0?void 0:c.videoTrack)===null||u===void 0)&&u.enabled?"0":"1",this.qualityHandler.Wh.audio.muteState=this.xu.getAudioTracks().length>0&&this.xu.getAudioTracks()[0].enabled?"0":"1",!((l=this.$d)===null||l===void 0)&&l.videoCodec&&(this.nd=this.$d.videoCodec);var At=(a=this.mn)===null||a===void 0?void 0:a.videoPreviewType;switch(At){case"camera":wt=this.au("camera_video_bitrate",!0);break;case"screen":wt=this.au("screen_video_bitrate",!0);break;case"custom":wt=this.au("custom_video_bitrate",!0)}wt!==void 0&&(this.info(ie.QRg+" setting "+At+" "+wt),this.Ka.bitRate=wt);var Vt=this.au("bitrate_mode",!0);Vt&&(this.info(ie.QRg+" setting bitrate_mode "+Vt),this.Ka.startBitrate=Vt);var qt=this.au("publish_video_codec",!0);if(qt&&(this.info(ie.QRg+" setting publish_video_codec "+qt),this.nd=qt),(0,R.dd)((h=this.$d)===null||h===void 0?void 0:h.isSEIStart)&&(this.xd.isSEIStart=this.$d.isSEIStart),this.xd.isSEIStart){var Gt=_t();(this.nd!=="H264"&&this.nd!=="H265"||!Gt)&&(this.warn(ie.QRg+" not use sei; support: ".concat(Gt,", codec: ").concat(this.nd," ")),this.xd.isSEIStart=!1)}!((m=this.pn.seiConfig)===null||m===void 0)&&m.unregisterSEIFilter&&(this.xd.unregisterSeiFilter=(S=this.pn.seiConfig)===null||S===void 0?void 0:S.unregisterSEIFilter),this.pn.scenario===9&&(this.Md.forceSynchronousNetworkTime=1),[0,1].includes((x=this.$d)===null||x===void 0?void 0:x.forceSynchronousNetworkTime)&&(this.Md.forceSynchronousNetworkTime=(q=this.$d)===null||q===void 0?void 0:q.forceSynchronousNetworkTime);var Sn=0,Qt=0;!((V=this.$d)===null||V===void 0)&&V.trafficControlMinVideoBitrate&&(Sn=this.$d.trafficControlMinVideoBitrate),(0,R.TE)(this.$d.trafficControlFocusOnMode)||(Qt=this.$d.trafficControlFocusOnMode),(0,R.dd)(this.$d.enableTrafficControl)&&this.Zd.setEnable(this.$d.enableTrafficControl);var Wt=0,zt=0;if(this.Ka.bitRate&&this.Ka.startBitrate==="target"&&(Wt=this.Ka.bitRate),Sn>0)zt=Sn;else if(this.Ka.minBitrate)zt=this.Ka.minBitrate;else if(this.mn.previewType==="screen"){var Mt=function(Kt){var $t=0,yt=Kt.frameRate,Pn=Kt.width*Kt.height*(yt<=30?yt:30);return(0,R.Cs)(Pn)?($t=Pn<=3888e3?200:Pn<=6912e3?400:Pn<=15552e3?700:Pn<=27648e3?1e3:2e3)>Kt.bitRate&&($t=Kt.bitRate):$t=parseInt(.6*Kt.bitRate+""),{minBitrate:$t,resolution:Pn}}(this.Ka);zt=Mt.minBitrate,this.info(ie.QRg+" resolution: ".concat(Mt.resolution,", min bitrate: ").concat(zt))}if(this.Zd.setVideoBitrate(this.Ka.bitRate),this.Zd.setMinVideoBitrate(zt),this.Zd.setStartVideoBitrate(Wt),isNaN(this.Ka.audioBitrate)||this.Zd.setAudioBitrate(this.Ka.audioBitrate),this.Zd.enableVideo(!!(!((_e=this.mn)===null||_e===void 0)&&_e.videoTrack)),(0,R.Cs)(this.$d.trafficControlMinVideoMode)&&this.Zd.setMinVideoBitrateMode(this.$d.trafficControlMinVideoMode),this.canSetBandWidthBySender()&&i!=null&&i>0){var jt=this.au("ref_bitrate_on");(jt??this.pn.engineConfig.enableReferenceBitrate)&&!this.mn.enableDualStream&&this.Zd.setReferenceVideoBitrate(i)}this.Zd.updateVideoTargetBitrate=function(Kt){gt.applyVideoBitrate(Kt)},this.Zd.pauseVideo=function(){gt.onTcPauseVideo()},this.Zd.resumeVideo=function(){gt.onTcResumeVideo()},this.Zd.start(),this.cr.spanSetAttributes({key:Li.event,par:this.va},{video_en_codec_id:Li.video_en_codec_id(this.getCodecId(this.nd)),audio_c_channel_count:Li.audio_c_channel_count(this.Ka.channelCount==2?2:1),audio_en_bps:Li.audio_en_bps(this.Ka.audioBitrate),aec_level:Li.aec_level(this.Sc.AEC==1?2:this.Sc.AEC==0?0:2),ans_level:Li.ans_level(this.Sc.ANS==1?2:this.Sc.ANS==0?0:2),agc:Li.agc(this.Sc.AGC==1||this.Sc.AGC!=0),video_activate:Li.video_activate(!!(!((Pe=(ke=this.mn)===null||ke===void 0?void 0:ke.videoTrack)===null||Pe===void 0)&&Pe.enabled)),audio_activate:Li.audio_activate(!!(!((Ge=(Oe=this.mn)===null||Oe===void 0?void 0:Oe.audioTrack)===null||Ge===void 0)&&Ge.enabled)),scenario:this.pn.scenario,traffic_control_min_video_bitrate:{bitrate:Li.traffic_control_min_video_bitrate.bitrate(Sn),mode:Li.traffic_control_min_video_bitrate.mode(Qt)},cap_volume:this.previewer.volume,is_peer:Li.is_peer(this.Od)}),this.tv.setAttributes({room_id:fi.room_id((tt=(Je=this.gn.publisherList[this.va])===null||Je===void 0?void 0:Je.room)===null||tt===void 0?void 0:tt.roomID),room_sid_string:fi.room_sid_string((vt=(ut=this.gn.publisherList[this.va])===null||ut===void 0?void 0:ut.room)===null||vt===void 0?void 0:vt.roomSessionID),max_retry_interval:fi.max_retry_interval(this.pn.streamRetryTime),scenario:this.pn.scenario,use_resource_type:fi.use_resource_type(["rtc"])}),this.Od?this.bv({encodedInsertableStreams:this.xd.isSEIStart}):this.Vd(),this.av!=null&&(clearTimeout(this.av),this.av=null),this.av=setTimeout(function(){gt.error(ie.QRg+" waiting timeout"),gt.publishStateUpdateError(Or.Hn)},this.rd)}else this.error(ie.QRg+" "+t+" streamId is null")},e.prototype.Vd=function(t){var n,r,i,s,c,u=this;if(!(!((n=this.Wd)===null||n===void 0)&&n.isUaConnected))return this.info(ie.QRg+" wait to create session"),this.Hd=[t],void this.Wd.on("uaConnected",this.ou.onUaSocketConnected);this.lv=(0,E.Mo)();var l=this.va;this.gn.testEnvironment==1&&(l="zegotest-"+this.gn.appid+"-"+this.va),this.gn.gwNode&&(this.od=this.gn.gwNode);var a=this.au("gw_nodes");a&&(0,R.C9)(a)&&a.length>0&&(this.info(ie.QRg+" setting "+JSON.stringify(a)),this.ud=a,this.od=this.ud[0]||this.od),this.setTurnTcp();var h=this.au("udp_or_tcp",!0);h&&(this.info(ie.QRg+" setting udp_or_tcp "+h),this.Bd=h==="tcp"),this.Bd&&(this.Od=!1,this.Ld=!1);var m=((i=(r=this.gn.publisherList[this.va])===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.roomID)||((s=this.pn.roomList[0])===null||s===void 0?void 0:s.roomID);this.getIPStackNode(),this.info("".concat(ie.QRg," session req, seq: ").concat(this.lv," gwNode: ").concat(this.od,", ipNodeType: ").concat(this.ipNodeType,", ").concat(this.Od?"peer":"turn",", ipv6_prefer: ").concat(this.ipV6Prefer));var S=this._v(m),x=S.params,q=S.paramsExt;this.yv=q;var V=k._g,_e=function(){u.state=1,u.info(ie.QRg+" called success"),u.ed=se.start};if(this.Od)this.getLocalMiniSdp(t.sdp,function(Oe){var Ge=new Date().getTime(),Je=u.getSpan(k._g.event,u.parentSpanKey),tt={};Oe?(u.info(ie.QRg+" isMini"),tt.miniSdp=Oe):tt.sdp=t.sdp,Je.setAttributes({server_host:u.od,ip_mode:u.ipV6Prefer,req_params_ext:q}),u.Kd.createSessionWithSdp(Ni(Ni({seq:u.lv,type:0,mode:0,streamId:l,videoInfo:u.Ka,strAuthParam:u.$d&&u.$d.streamParams||""},tt),{serverHost:u.od,params:x,paramsExt:q,roomID:m,geo:{type:u.gn.geo.type,areaList:u.gn.geo.areaList},ipV6Prefer:u.ipV6Prefer}),function(ut,vt,gt){return $i(u,void 0,void 0,function(){var Pt;return eo(this,function(wt){return Pt=new Date().getTime(),this.info(ie.QRg+" create session time "+(Pt-Ge)),qa(gt),this.pn.ia(Je,{sdp:gt.sdp}),Je.setAttributes({webrtc_sid:vt,is_mini:V.is_mini(this.$u),gw_nodes:V.gw_nodes(gt.gw_nodes),ip_infos:gt.ips,ip_v6_infos:gt.ipv6s,gw_nodes_ttl:V.gw_nodes(gt.gw_nodes_ttl),gw_version:V.gw_version(gt.gw_version),rsp_params_ext:gt.params_ext}),Je.end(),this.cr.spanSetAttributes({key:Li.event,par:this.va},{gw_version:Li.gw_version(gt.gw_version)}),this.ed!==se.iceConnected&&this.getSpan(k.Ov.event,this.parentSpanKey,"",!0),this.wv(ut,vt,gt,this.ipV6Prefer),[2]})})},function(ut,vt){if(u.lv==vt){var gt=ut==E.Xb?Or.Yn:Or.Kn;u.info(ie.QRg+" create session fail. signal: ".concat(u.Wd.state,"; ws: ").concat(u.Wd.mediaState)),u.cr.setError(Je,gt),u.publishStateUpdateError(gt)}else u.warn(ie.QRg+" seq is not match.")}),_e()});else{var ke=this.getSpan(k._g.event,this.parentSpanKey);ke.setAttributes({server_host:this.od,ip_mode:this.ipV6Prefer});var Pe={type:0,mode:0,streamID:l,strAuthParam:((c=this.$d)===null||c===void 0?void 0:c.streamParams)||"",serverHost:this.od,params:x,roomID:m,geo:{type:this.gn.geo.type,areaList:this.gn.geo.areaList},ipV6Prefer:this.ipV6Prefer};this.Kd.createSession(this.lv,Pe,function(Oe,Ge,Je){return $i(u,void 0,void 0,function(){return eo(this,function(tt){return qa(Je),ke.setAttributes({webrtc_sid:V.webrtc_sid(Ge),gw_nodes:V.gw_nodes(Je.gw_nodes),ip_infos:Je.ips,ip_v6_infos:Je.ipv6s,gw_nodes_ttl:V.gw_nodes(Je.gw_nodes_ttl),gw_version:V.gw_version(Je.gw_version)}),ke.end(),this.cr.spanSetAttributes({key:Li.event,par:this.va},{gw_version:Li.gw_version(Je.gw_version)}),this.Sv(Oe,Ge,Je,this.ipV6Prefer),[2]})})},function(Oe,Ge){if(u.lv==Ge){var Je=Oe==E.Xb?Or.Yn:Or.Kn;u.cr.setError(ke,Je),u.publishStateUpdateError(Je)}else u.warn(ie.QRg+" seq is not match.")}),_e()}},e.prototype.Sv=function(t,n,r,i){var s,c,u,l=r.turn_server,a=l.split("?")[0]&&l.split("?")[0].slice(5),h=this.signal.Ev,m="webrtc://".concat(a,"/").concat(h,"/").concat(this.va);if(this.cr.spanSetAttributes({key:this.parentSpanKey,par:this.va},{webrtc_sid:r.session_id,url:m}),this.info(ie.QRg+" sessionId:"+r.session_id),this.lv==t){this.resetPushCmdSeqMap();var S=r.client_ip||r.clientip;S&&(this.pn.clientIP=S),this.Id=r.peer_id;var x=0,q=new Date().getTime();if(this.jd&&(this.info(ie.QRg+" create signal time "+(x=q-this.jd)),this.signalTime=x),this.zd=q,r.result!==0){if(this.error(ie.QRg+" create session failed "+r.result),(r==null?void 0:r.result)===1021)return void this.publishStateUpdateError(Et.mHY,!0);if((r==null?void 0:r.result)===2012)return void this.publishStateUpdateError(Or.fe,!0);(r==null?void 0:r.result)===2016&&i===L.kV6AndV4&&(this.Al=!1),this.publishStateUpdateError(Or.Kn)}else this.Df=r.session_id,this.Wl=!0,this.info(ie.QRg+" create session success "+this.Df),this.setGwNodes(r,!1,i,t),i===L.kV6AndV4&&((s=r==null?void 0:r.ipv6s)===null||s===void 0?void 0:s.length)>0&&(this.Al=!0),((c=r==null?void 0:r.ipv4s)===null||c===void 0?void 0:c.length)>0&&((u=r==null?void 0:r.ipv6s)===null||u===void 0?void 0:u.length)>0&&this.checkIfToRestart(i),this.info(ie.QRg+" isRestartIce "+this.Sl),this.kv(r)}else this.error(ie.QRg+" seq is not match.")},e.prototype.wv=function(t,n,r,i){var s,c,u,l=this;if(this.info(ie.QRg+" sessionId:"+n),this.lv==t){this.resetPushCmdSeqMap();var a=r.client_ip||r.clientip;a&&(this.pn.clientIP=a),this.Id=r.peer_id;var h=0,m=new Date().getTime();if(this.jd&&(this.info(ie.QRg+" create signal time "+(h=m-this.jd)),this.signalTime=h),this.zd=m,r.result!==0){if(r.result===108){if(this.nd==="H265"){if(!this.publishOption.enableAutoSwitchVideoCodec)return void this.publishStateUpdateError(Or.le,!0,"not support H265 codec");this.$d.videoCodec="H264",this.info("".concat(ie.QRg," switch video codec to ").concat(this.$d.videoCodec))}}else r.result===110&&(this.$u=!1,this.pn.$u=!1,this.Jl=performance.now()-this.Fl,this.Ll=2);if(this.error(ie.QRg+" create session failed "+r.result),(r==null?void 0:r.result)===1021)return void this.publishStateUpdateError(Et.mHY,!0);if((r==null?void 0:r.result)===2012)return void this.publishStateUpdateError(Or.fe,!0);(r==null?void 0:r.result)===2016&&i===L.kV6AndV4&&(this.Al=!1),this.publishStateUpdateError({code:Or.Kn.code,message:Or.Kn.message+" result:"+r.result})}else this.Df=n,this.Wl=!0,this.setGwNodes(r,!1,i,t),this.info(ie.QRg+" get remote session success "),i===L.kV6AndV4&&((s=r==null?void 0:r.ipv6s)===null||s===void 0?void 0:s.length)>0&&(this.Al=!0),((c=r==null?void 0:r.ipv4s)===null||c===void 0?void 0:c.length)>0&&((u=r==null?void 0:r.ipv6s)===null||u===void 0?void 0:u.length)>0&&this.checkIfToRestart(i),this.info(ie.QRg+" isRestartIce "+this.Sl),this.dv(),this.parseRemoteSdp(r,function(S){if(l.Ld){if(l.info(ie.QRg+" fully auto tcp"),!l.setConfiguration(S,r.params_ext))return void l.publishStateUpdateError(Et.akb,!1);l.setLocalSdp(l.ev)}l.Iv(S,void 0,r.params_ext,r==null?void 0:r.mini_sdp)},function(S){l.publishStateUpdateError(S)})}else this.error(ie.QRg+" seq is not match.")},e.prototype.Rv=function(t){var n,r=this;if(this.info(ie.qPT+" 1"),t){var i=t.candidate,s=t.sdpMid,c=t.sdpMLineIndex;i&&(this.info(ie.qPT+" addIceCandidate"),(n=this.Xl)===null||n===void 0||n.addIceCandidate(new RTCIceCandidate({sdpMid:s,sdpMLineIndex:c,candidate:i})).then(function(){r.info(ie.qPT+" add can suc")}).catch(function(u){r.info(ie.qPT+" add can fail, ".concat(u.message))}))}},e.prototype._v=function(t){var n="",r=[],i={},s=this.pn.seiConfig.SEIPass;(0,R.dd)(s)&&(i.sei_filter_pass=s?1:0),i.auto_switch_turn_type=this.pn.browser==="firefox"?2:1,this.pn.idName&&r.push("zguid="+this.pn.idName),t&&r.push("zgrid="+t),this.gn.isProxy&&(i.zg_proxy=1),this.Md.forceSynchronousNetworkTime===1&&(i.sync_ntp=1);var c=this.$d,u=c.setDeviceDelayByUser,l=c.trafficControlFocusOnMode,a=c.enableTrafficControl;isNaN(u)||(i.ktv_device_delay=u),(0,R.dd)(a)&&(i.tc_type=a?0:2),isNaN(l)||(i.tc_focuson_mode=l==0?1:0);var h=(0,Vn.UN)(),m=this.au("vid_clock_rate_est");(h&&(h.includes("18_4")||h.includes("18_5"))||m)&&(i.enable_vid_clock_rate_est=1);var S=this.Zd.getMinVideoBitrate();return S>0&&(i.tc_min_video_kbps=S<.7*this.Ka.bitRate?S:.7*this.Ka.bitRate),i.proto_flags=2,this.au("peer_signal_over_dc")&&(i.proto_flags|=256),r.length>0&&(n=r.join("&")),{params:n,paramsExt:i}},e.prototype.getDispatchIPNodeMode=function(){if(!this.od){this.info("zc.p.0.gdinm call");var t=this.gn.getStreamIPNodesMode(),n=t.ipNodeType;this.ipV6Prefer=t.ipV6Prefer,this.ipNodeType=n,this.ipV6Prefer===L.kV6AndV4&&!this.Al&&this.Xd&&(this.ipV6Prefer=L.kV4AndV6,this.ipNodeType=A.ZV4Priority),this.info("zc.p.0.gdinm ".concat(this.ipV6Prefer," ").concat(this.ipNodeType))}},e.prototype.getRetryIPNodeMode=function(){if(this.info("zc.p.0.grinm call"),this.ipV6Prefer===L.kV4Only)this.ipNodeType=A.ZV4Only;else{var t=this.gn.getRetryIPPreferNodeType().ipNodeType;this.ipNodeType=t}this.info("zc.p.0.grinm ".concat(this.ipV6Prefer," ").concat(this.ipNodeType))},e.prototype.getRetryIPv6Prefer=function(){this.ipV6Prefer=this.gn.getIPv6PreferByGwNode(this.gwNode)},e.prototype.checkIfToRestart=function(t){this.Sl=t!==L.kV4Only&&(this.ipNodeType===A.ZV6AndV4Priority||this.pn.selectIPStackMode===N.IPv4Prefer&&this.gn.agentIpStackDetection.IPv4===H.reachable&&this.ipNodeType===A.ZV6Priority)},e.prototype.getIPStackNode=function(){if(this.gwNode){var t=Dr(this.gwNode);this.ipStackNode=Ar(t)}else this.ipStackNode=[A.ZV4Only,A.ZV4Priority].includes(this.ipNodeType)?Y.IPv4:Y.IPv6},e.prototype.setGwNodes=function(t,n,r,i){var s,c,u;if(this.info("".concat(ie.JGn," seq: ").concat(i,", gw_nodes: ").concat(JSON.stringify(t==null?void 0:t.gw_nodes),", ips: ").concat(JSON.stringify(t.ips),", ipv6s: ").concat(JSON.stringify(t.ipv6s),", ").concat(r)),this.info("".concat(ie.JGn," seq: ").concat(i,", retry: ").concat(JSON.stringify(this.retryFailGwNodes),", ips: ").concat(JSON.stringify(this.retryFailIpV4Nodes),", ipv6s: ").concat(JSON.stringify(this.retryFailIpV6Nodes))),r===0){if(((s=t.gw_nodes)===null||s===void 0?void 0:s.length)>0){var l=er(t.gw_nodes,this.retryFailGwNodes,n);this.retryFailGwNodes=[],this.handleDispatchedGwNodes(l,t.gw_nodes_ttl,r)}}else{var a=void 0,h=void 0;((c=t.ips)===null||c===void 0?void 0:c.length)>0&&(a=ai(t.ips,this.retryFailIpV4Nodes,n),this.retryFailIpV4Nodes=[]),((u=t==null?void 0:t.ipv6s)===null||u===void 0?void 0:u.length)>0&&(h=ai(t.ipv6s,this.retryFailIpV6Nodes,n),this.retryFailIpV6Nodes=[]),this.handleDispatchedGwNodes(t.gw_nodes||[],t.gw_nodes_ttl,r,a,h)}},e.prototype.resetGwNodes=function(){this.info(ie.Ehk+" call"),this.od="",this.ud=[],this.ipV4NodeList=[],this.ipV6NodeList=[],this.ad=0},e.prototype.handleDispatchedGwNodes=function(t,n,r,i,s){var c=this;if(i===void 0&&(i=[]),s===void 0&&(s=[]),this.info(ie.d0o+" "+JSON.stringify(t)+" "+JSON.stringify(i)+" "+JSON.stringify(s)+" ipv6Prefer "+r),Array.isArray(t)&&t.length!==0||i.length!==0||s.length!==0){var u=n===0?60:n,l=function(){c.ad=u?new Date().getTime()+1e3*u:c.ad};this.ud=t.length>0?t:this.ud,this.ipV4NodeList=i.length>0?i:this.ipV4NodeList,this.ipV6NodeList=s.length>0?s:this.ipV6NodeList,r===L.kV4Only?(this.od=t.length>0?this.ud[0]:this.od,t.length>0&&l()):r==L.kV4AndV6&&i.length>0?(this.od=Tr(i[0]),this.ipNode=i[0],l()):r===L.kV6AndV4&&s.length>0?(this.od=Tr(s[0]),this.ipNode=s[0],l()):(this.ud.length>0&&(this.od=this.ud[0]),this.info("".concat(ie.d0o," no gwNode ").concat(r," ").concat(i.length," ").concat(s.length)),this.ipNodeType=A.ZV4Only,this.ipStackNode=Y.IPv4),this.gn.updateCachedGwNodesList(this.streamId,!0,t||[],u,i,s)}},e.prototype.dispatchGwNodes=function(t,n,r){var i=this,s=this.va;this.gn.testEnvironment==1&&(s="zegotest-"+this.gn.appid+"-"+this.va);var c=t;c===N.IPv6Prefer&&!this.Al&&this.Xd&&(c=N.IPv4Prefer);var u=this.getSpan(k.Mu.event,this.parentSpanKey);u.setAttributes({ip_mode:t}),this.Kd.dispatchGwNodes({type:0,streamID:s,geo:{type:this.gn.geo.type,areaList:this.gn.geo.areaList},ipV6Prefer:c},function(l,a,h){qa(h),(0,te.lA)(u,{gw_nodes:h.gw_nodes,ip_infos:h.ips,ip_v6_infos:h.ipv6s}),n&&n(h)},function(l,a){i.cr.setError(u,l),r&&r(l)})},e.prototype.kv=function(t){var n;return $i(this,void 0,void 0,function(){var r,i,s,c,u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je,tt,ut,vt,gt,Pt,wt,At,Vt,qt,Gt,Sn=this;return eo(this,function(Qt){switch(Qt.label){case 0:return this.info((r=ie.XLj)+" called"),i=[],this.gn.autoSwitchProtocol=this.au("auto_to_tcp")||!1,s=this.au("udp_max_fail_num"),!isNaN(s)&&(this.gn.maxUdpFailNum=s),l=(c=this.gn).maxUdpFailNum,a=c.udpFailNum,this.info(r+"  autoToTcp: ".concat(u=c.autoSwitchProtocol,", udpFailNum: ").concat(a,", maxUdpFailNum: ").concat(l,".")),u&&!this.Bd&&a>=l&&(this.info(r+" switch to tcp. "),this.Bd=!0,this.Ld=!1),(h=this.au("udp_or_tcp",!0))&&(this.info(r+" setting udp_or_tcp "+h),this.Bd=h==="tcp"),m=void 0,S=this.Ud.wanIP=(t.gw_nodes[0]||this.od).split(":")[0],!this.gn.isProxy||this.gn.isLocalProxy?[3,2]:(x=p==null?void 0:p.proxyCtrl,[4,Promise.all([x.getTurnInfo(),x.intranetCheck(ki(S),void 0)])]);case 1:return q=Qt.sent(),_e=q[1],(V=q[0]).code?this.warn(r+" use proxy failed."+JSON.stringify(V)):(Pe=(ke=V.data).password,Oe=ke.turn_ipv4,Ge=ke.turn_port,Je=ke.username,(tt=ke.turn_internal_ipv4)&&(this.yv.coturn_internal=tt),ut=wr(Oe),vt="turn:".concat(ut,":").concat(Ge,"?transport=").concat(this.Bd?"tcp":"udp"),this.info(r+" turn server: ".concat(vt," ; intranet: ").concat(JSON.stringify((n=_e==null?void 0:_e.data)===null||n===void 0?void 0:n.intranet),"; turn internal ip: ").concat(wr(tt))),m=[{credential:Pe,urls:[vt],username:Je}]),_e.code?this.warn(r+" use intranetCheck failed."+JSON.stringify(_e)):this.Ud.intranet=_e.data.intranet||!1,[3,3];case 2:this.gn.isLocalProxy&&this.gn.turnServers?(m=(Pt=this.gn.turnServers).map(function(Wt){return{credential:Wt.credential,urls:[Wt.url],username:Wt.username}}),this.info(r+" use local proxy: "+JSON.stringify(Pt)),this.Ud.intranet=!1):t.turn_server&&(gt=[],t.turn_server.split(";").forEach(function(Wt){var zt=Fi(Wt).replace("[","").replace("]",""),Mt=Ar(zt);if(Sn.ipStackNode===Mt?gt.push(Wt):Sn.El.push(Wt),Mt==Y.IPv4){var jt=Fa(zt),Kt=Wt.replace(zt,"[".concat(jt,"]"));Sn.gn.isCandidateHasIPv6&&gt.push(Kt)}}),(Gt=this.El).push.apply(Gt,gt),this.setTurnTcp(),Pt=void 0,wt=gt.filter(function(Wt){return Wt.indexOf("udp")>-1}),At=gt.filter(function(Wt){return Wt.indexOf("tcp")>-1}),Pt=this.Bd?At.length>0?At:wt.map(function(Wt){return Wt.replace("udp","tcp")}):wt,this.info(r+" over tcp "+JSON.stringify(Pt)),i.push.apply(i,Pt)),Qt.label=3;case 3:return t.stun_server&&i.push(t.stun_server),Vt={iceTransportPolicy:"all",iceServers:[{urls:i,username:t.turn_username,credential:t.turn_auth_key}],encodedInsertableStreams:this.xd.isSEIStart},this.Il=t.turn_username,this.Tl=t.turn_auth_key,m&&(Vt.iceServers=m,Vt.iceTransportPolicy="relay",Vt.rtcpMuxPolicy="require"),this.info(r+" turn username: "+(qt=Vt.iceServers[0]).username+", credential: "+qt.credential+", url: "+JSON.stringify(qt.urls)),this.bv(Vt),this.dv(),this.info(r+" call success"),[2]}})})},e.prototype.Tv=function(t,n){var r=this.qd[t],i=r.seq,s=r.time,c=performance.now();return i!==-1&&i>=n&&c-s<6e3?(this.warn(ie.z3d+" push ".concat(t,", seq ").concat(n," local ").concat(JSON.stringify(this.qd[t]))),!1):(this.qd[t]={seq:n,time:c},!0)},e.prototype.onReceivedDataChannel=function(t){var n=new Uint8Array(t.data,0,1);n[0]==ya.Signal?this.Kd.onDataChannelMessage(t.data):n[0]==ya.TcFeedback&&this.Zd.handleFeedback(t.data)},e.prototype.bv=function(t){var n,r,i,s,c,u,l,a=this,h=ie.XLj;this.Xl=new RTCPeerConnection(t),this.Xl.onicecandidate=function(At){a.onIceCandidate(At)},this.Xl.onsignalingstatechange=function(At){a.onSignalStateChange(At)},this.Xl.connectionState?this.Xl.onconnectionstatechange=function(At){a.Cv(At)}:this.info("".concat(h," not support connectionState")),this.Xl.oniceconnectionstatechange=function(At){a.onIceConnectionStateChange(At)};var m=this.au("peer_signal_over_dc"),S=!(!this.Zd.isEnable()||this.Zd.getMinVideoBitrateMode()!=0);if(this.gn.isDataChannelEnabled||m||S){var x={ordered:!1};this.info("zc.p.dc.0.n  option:"+JSON.stringify(x)+" enable:"+m+" "+S),this.Ad=0,this.Pf=this.Xl.createDataChannel(this.va,x),this.Pf.binaryType="arraybuffer",m&&(this.Kd.dataChannel=this.Pf),S&&this.Zd.setDatachannel(this.Pf),this.Pf.onopen=function(At){a.info("zc.p.dc.0.o data channel open"),a.dataChannelState=1},this.Pf.onclose=function(At){a.error("zc.p.dc.0.c onclose"),a.dataChannelState=0},this.Pf.onmessage=function(At){if(a.Ad++<3&&a.info("zc.p.dc.0.m onmessage"),At.data instanceof Blob){var Vt=new FileReader,qt={};Vt.readAsArrayBuffer(At.data),Vt.onload=function(){qt.data=Vt.result,a.onReceivedDataChannel(qt)}}else a.onReceivedDataChannel(At)}}var q=[],V=[],_e=_t(),ke=this.isRePublish?k.fo:k.ch,Pe=0;if(this.lowStream&&(Pe=1,this.lowStream.getVideoTracks().forEach(function(At){var Vt;if(At.kind==="video"){a.info(ie.QRg+" lt-id: "+At.id);var qt=(Vt=a.Xl)===null||Vt===void 0?void 0:Vt.addTrack(At,a.lowStream);a.lowVideoSender=qt,a.xd.isSEIStart&&qt&&_e&&a.Av(qt,!0)}}),this.cr.spanSetAttributes({key:Li.event,par:this.va},{low_stream_params:(n=this.mn)===null||n===void 0?void 0:n.lowStreamConfig})),this.cr.spanSetAttributes({key:ke.event,par:this.va},{is_dual_stream:k.ch.is_dual_stream(Pe),is_mini:k.ch.is_mini(this.$u)}),this.cr.spanSetAttributes({key:Li.event,par:this.va},{is_dual_stream:Li.is_dual_stream(Pe)}),this.xu){if(this.xu.getTracks().forEach(function(At){var Vt,qt,Gt=a.xd.isSEIStart&&_e;a.info("".concat(h," pc addTrack enable ").concat(At.kind," ").concat(At.enabled," ").concat(a.mn.isVideoEnabled)),(At.kind==="audio"&&a.previewer.isAudioEnabled||At.kind==="video"&&(At.enabled||Gt))&&(qt=(Vt=a.Xl)===null||Vt===void 0?void 0:Vt.addTrack(At,a.xu))&&At.kind==="video"&&a.Zd.getStartVideoBitrate()>0&&(a.mn.videoInfo.contentHint&&a.mn.videoInfo.contentHint==="detail"||qt.track&&"contentHint"in qt.track&&(a.info("".concat(ie.BsE," setContentHint: ").concat(qt.track.contentHint," => detail, tid :").concat(qt.track.id)),qt.track.contentHint="detail",a.yd="motion")),Gt&&qt&&(a.info(ie.QRg+" sei transform: "+At.kind),At.kind==="video"?a.Av(qt):At.kind==="audio"&&a.zv(qt)),rn(At,a.an,h,{streamID:a.va})}),!(!((r=this.mn)===null||r===void 0)&&r.videoTrack)&&this.xd.isSEIStart){this.Ka.bitRate||(this.Ka.bitRate=50);var Oe=this.xd.track=this._addCanvasStreamVideoTrack(),Ge=this.Xl.addTrack(Oe,this.xu);Ge&&Oe.kind=="video"&&_e&&this.Av(Ge)}!((i=this.mn)===null||i===void 0)&&i.videoTrack&&!this.mn.hasStopCaptureVideo&&this.mn.isVideoEnabled&&(q=[(s=this.mn)===null||s===void 0?void 0:s.videoTrack]),this.mn.isAudioEnabled&&(V=this.xu.getAudioTracks());var Je,tt=!1,ut=!1;q.length>0&&(this.info(h+" video device: "+(Je=q[0]).label+" ; set: "+JSON.stringify(Je.getSettings())),tt=!0),V.length>0&&(this.info(h+" audio device: "+(Je=V[0]).label+" ; set: "+JSON.stringify(Je.getSettings())),ut=!0);var vt=(c=this.Xl)===null||c===void 0?void 0:c.getSenders().find(function(At){var Vt;return((Vt=At.track)===null||Vt===void 0?void 0:Vt.kind)==="video"&&At!==a.lowVideoSender}),gt=(u=this.Xl)===null||u===void 0?void 0:u.getSenders().find(function(At){var Vt;return((Vt=At.track)===null||Vt===void 0?void 0:Vt.kind)==="audio"});typeof RTCPeerConnection.prototype.addTransceiver=="function"?(this.supportTransceiver=!0,this.info(h+" ts sender ".concat(!!vt," ").concat(!!gt)),!tt&&vt&&this.warn(h+" vt diff ".concat(!!this.previewer.videoTrack," ").concat(this.localStream===((l=this.previewer)===null||l===void 0?void 0:l.localStream))),tt||this.xd.isSEIStart||vt||(this.info(h+" add vt"),vt=this.Xl.addTransceiver("video",{direction:"sendrecv"}).sender),ut||gt||(this.info(h+" add at"),gt=this.Xl.addTransceiver("audio",{direction:"sendrecv"}).sender)):this.supportTransceiver=!1,this.videoSender=vt,this.audioSender=gt}var Pt={offerToReceiveAudio:V.length>0?1:0,offerToReceiveVideo:q.length>0?1:0};this.$d.enableDTX===!0&&(Pt.voiceActivityDetection=!0),this.Dl=Pt,this.info(h+" createOffer: "+JSON.stringify(Pt));var wt=this.getSpan(k._F.event,this.parentSpanKey);wt.setAttributes({is_dual_stream:k._F.is_dual_stream(this.lowStream?1:0)}),this.Xl.createOffer(Pt).then(function(At){a.pn.ia(wt,{sdp:At.sdp}),(0,te.lA)(wt,{is_mini:k._F.is_mini(a.$u)}),a.onCreateOfferSuccess(At)},function(At){a.error(h+" create offer error "+At.toString()),a.cr.setError(wt,{code:Or.Vn.code,message:At.toString()}),a.publishStateUpdateError(Or.Vn,!0)})},e.prototype.restartIce=function(){var t,n=this,r=ie.Loj;this.info("".concat(r," call")),(t=this.Xl)===null||t===void 0||t.createOffer(Ni(Ni({},this.Dl),{iceRestart:!0})).then(function(i){var s,c,u;if(n.info("".concat(r," createOffer suc")),i.sdp){n.Dv(i);var l=Ac(i.sdp),a=bi(i.sdp);n.info("".concat(r," ice ").concat(l," ").concat(a));var h={iceTransportPolicy:"all",rtcpMuxPolicy:"require",iceServers:[{urls:n.El,username:n.Il,credential:n.Tl}],encodedInsertableStreams:n.xd.isSEIStart};n.info("".concat(r," set config ").concat(JSON.stringify(h))),(s=n.Xl)===null||s===void 0||s.setConfiguration(h),n.sendRestartIce(l,a),n.info("".concat(r," localSdp1 ").concat(i.sdp.substr(0,i.sdp.length/2))),n.info("".concat(r," localSdp2 ").concat(i.sdp.substr(i.sdp.length/2))),(c=n.Xl)===null||c===void 0||c.setLocalDescription(i).then(function(m){n.info("".concat(r," set local sdp suc"))}).catch(function(m){n.info("".concat(r," set local sdp fail ").concat(m.message?JSON.stringify(m.message):JSON.stringify(m)))}),(u=n.Xl)===null||u===void 0||u.setRemoteDescription(new RTCSessionDescription({type:"answer",sdp:n.nv})).then(function(m){n.info("".concat(r," set remote sdp suc"))}).catch(function(m){n.info("".concat(r," set remote sdp fail ").concat(m.message?JSON.stringify(m.message):JSON.stringify(m)))}),n.kl.forEach(function(m){var S;(S=n.Xl)===null||S===void 0||S.addIceCandidate(new RTCIceCandidate(m)).then(function(){n.info("".concat(r," add can suc"))}).catch(function(x){n.info("".concat(r," add can fail, ").concat(x.message))})})}}).catch(function(i){n.warn("zc.p.0.rsi err ".concat(i.message?JSON.stringify(i.message):JSON.stringify(i)))})},e.prototype.resetIceInfos=function(){this.info("zc.p.0.rii.0 call"),this.El=[],this.Il="",this.Tl="",this.kl=[]},e.prototype.resetNat64Infos=function(){this.info("zc.p.0.rni.0 call"),this.Ol=[]},e.prototype.switchVideoCodec=function(t,n){var r=this,i="zc.p.0.sc.0";return new Promise(function(s,c){var u;r.Dl?(u=r.Xl)===null||u===void 0||u.createOffer(r.Dl).then(function(l){if(!l.sdp)return r.warn("".concat(i," create offer sdp none")),void c(!1);var a=j.getSDPVideoCodec(l.sdp);if(a&&a[n].length===0)return r.warn("".concat(i," code not support")),void c(!1);r.nd=n,r.onCreateOfferSuccess(l,!0,void 0,function(h){return $i(r,void 0,void 0,function(){return eo(this,function(m){return h!==0?(this.nd=t,this.warn("".concat(i," result ").concat(h)),c(!1)):(this.info("".concat(i," suc")),s(!0)),[2]})})})}).catch(function(l){r.warn("".concat(i," create offer fail ").concat(l==null?void 0:l.toString())),c(!1)}):c(!1)})},e.prototype.checkCodecSupport=function(t){var n;t===void 0&&(t=!1);var r=(n=this.previewer.videoTrack)===null||n===void 0?void 0:n.getSettings(),i=this.lastPublishStats.framesEncoded===0&&(this.publishStat.inputWidth||(r==null?void 0:r.width))!==0&&(this.publishStat.inputHeight||(r==null?void 0:r.height))!==0&&(this.publishStat.inputFPS||(r==null?void 0:r.frameRate))!==0;return!(t&&i||this.camera_status===0&&this.publishStat.videoMuteState==="0"&&this.lastPublishStats.videoBytesSent===0&&i)},e.prototype.getCodecId=function(t){switch(t){case"H264":default:return 0;case"VP8":return 2;case"H265":return 4}},e.prototype.sendSEI=function(t){var n=this;if(this.nd!=="H264"&&this.nd!=="H265")return this.error(ie.I2V+" code not support"),!1;if(!this.xd.isSEIStart)return console.error("Send SEI Failed. The publishing stream has not enabled sei."),!1;if(this.xd.SEIType==Ye.UserUnregister&&t.byteLength<=16)return this.error(ie.I2V+" inData size should greater than 16"),!1;if(this.Nd.length>=10)return this.error(ie.I2V+" side info count limit"),!1;this.Nd.push(t.buffer);var r=this.seiWorker;return r&&(this.Nd.forEach(function(i){r.postMessage({cmd:"pushSideInfo",buffer:i,hasLowStream:!!n.lowStream,streamID:n.va,maxLength:10},[i])}),this.Nd=[]),!0},e.prototype.zv=function(t){var n={cmd:"encode",streamID:this.va,kind:"audio"},r=this.createSEIWorker();if(window.RTCRtpScriptTransform)t.transform=new RTCRtpScriptTransform(r,n);else{var i=t.createEncodedStreams(),s=i.readable,c=i.writable,u=!r;try{r&&r.postMessage(Ni({readable:s,writable:c},n),[s,c])}catch{u=!0}if(u){this.warn("zc.p.cart The current browser version is too low.");var l=new TransformStream({transform:this.Nv});s.pipeThrough(l).pipeTo(c),this.gn.handleSeiRollBack()}}},e.prototype.Av=function(t,n){n===void 0&&(n=!1);var r=this.createSEIWorker(),i={cmd:"encode",streamID:this.va,type:this.xd.SEIType,isLowStream:n,emulationPreventionByte:this.pn.seiConfig.emulationPreventionByte,onlyAudio:!!this.xd.track,vCodec:this.nd};if(window.RTCRtpScriptTransform)t.transform=new RTCRtpScriptTransform(r,i);else{var s=t.createEncodedStreams(),c=s.readable,u=s.writable,l=!r;try{r&&r.postMessage(Ni({readable:c,writable:u},i),[c,u])}catch{l=!0}if(l){this.warn("zc.p.cvrt The current browser version is too low.");var a=new TransformStream({transform:this.encodeVideoFrame});c.pipeThrough(a).pipeTo(u),this.gn.handleSeiRollBack()}}},e.prototype.Nv=function(t,n){n.enqueue(t)},e.prototype.encodeSEINalu=function(t){var n=t.byteLength,r=parseInt(n/255),i=n%255,s=new ArrayBuffer(1+(r+1)+n+1),c=new DataView(s),u=0;c.setUint8(u++,this.xd.SEIType===Ye.UserUnregister?5:243);for(var l=0;l<r;l++)c.setUint8(u++,255);c.setUint8(u++,i);var a=new DataView(t);for(l=0;l<(t==null?void 0:t.byteLength);l++)c.setInt8(u++,a.getInt8(l));c.setInt8(u++,128);var h=new Uint8Array(s),m=h;if(this.pn.seiConfig.emulationPreventionByte){var S=function(x){for(var q=[],V=x.length,_e=0,ke=0;ke<V;++ke){var Pe=x[ke];Pe<=3&&_e>=2&&(q.push(3),_e=0),q.push(x[ke]),Pe==0?++_e:_e=0}var Oe=new Uint8Array(q);return{output:Oe,outLength:Oe.length}}(h).output;m=S}return{rbspView:m,ebspLength:m.length}},e.prototype.encodeFrame=function(t,n,r){var i,s,c,u=r?this.Pd:this.Nd;if(u.length>0){var l=!1,a=(s=(i=t.getMetadata)===null||i===void 0?void 0:i.call(t))===null||s===void 0?void 0:s.mimeType;l=a?(c=a==null?void 0:a.includes("H265"))!==null&&c!==void 0&&c:this.nd==="H265";for(var h=new DataView(t.data),m=[],S=0,x=0;x<u.length;x++){var q=this.encodeSEINalu(u[x]);S+=5+(qt=q.ebspLength),m.push(q)}r?this.Pd=[]:this.Nd=[];for(var V=new ArrayBuffer(S+t.data.byteLength),_e=new DataView(V),ke=0,Pe=new Yd(h,l),Oe=0,Ge=!1,Je=!1,tt=!1,ut=0;Pe.NextNalu();)if(ut++,l){if((vt=(126&h.getUint8(Pe.nalu_start+Pe.start_code_size))>>1)==32)Ge=!0,Oe+=Pe.nalu_size;else if(vt==33)Je=!0,Oe+=Pe.nalu_size;else if(vt==34)tt=!0,Oe+=Pe.nalu_size;else if(vt==35)continue;if(Ge&&Je&&tt)break}else{var vt;if((vt=31&h.getUint8(Pe.nalu_start+Pe.start_code_size))==7)Je=!0,Oe+=Pe.nalu_size;else if(vt==8)tt=!0,Oe+=Pe.nalu_size;else if(vt==9)continue;if(Je&&tt)break}for(var gt=0;gt<Oe;gt++)_e.setInt8(ke++,h.getInt8(gt));var Pt=10-ut,wt=m.length>=(Pt=Pt>0?Pt:0)?Pt:m.length;for(x=0;x<wt;x++){var At=m[x],Vt=At.rbspView,qt=At.ebspLength;_e.setUint8(ke++,0),_e.setUint8(ke++,0),_e.setUint8(ke++,0),_e.setUint8(ke++,1),l?(_e.setUint8(ke++,78),_e.setUint8(ke++,1)):_e.setUint8(ke++,6);for(var Gt=0;Gt<qt;Gt++)_e.setInt8(ke++,Vt[Gt-0])}for(gt=Oe;gt<t.data.byteLength;gt++)_e.setInt8(ke++,h.getInt8(gt));t.data=V}n.enqueue(t)},e.prototype.encodeFrameAudioOnly=function(t,n,r){var i,s,c,u=r?this.Pd:this.Nd,l=0,a=t.type==="key",h=!1,m=(s=(i=t.getMetadata)===null||i===void 0?void 0:i.call(t))===null||s===void 0?void 0:s.mimeType;h=m?(c=m==null?void 0:m.includes("H265"))!==null&&c!==void 0&&c:this.nd==="H265";var S=performance.now(),x=0,q=[];if(u.length>0){for(var V=u.length>=9?9:u.length,_e=0;_e<V;_e++){var ke=this.encodeSEINalu(u[_e]);x+=4+(h?2:1)+(Pt=ke.ebspLength),q.push(ke)}r?this.Pd=[]:this.Nd=[],S-this.recvLastKeyFrameTime>2e3&&(a=!0)}a&&(l=h?Ql.length+Jl.length:Wl.length+jl.length);var Pe=new ArrayBuffer(x+l),Oe=new DataView(Pe),Ge=0;if(a)if(h){var Je=new DataView(Ql.buffer);for(ut=0;ut<Ql.length;ut++)Oe.setInt8(Ge++,Je.getInt8(ut))}else for(var tt=new DataView(Wl.buffer),ut=0;ut<Wl.length;ut++)Oe.setInt8(Ge++,tt.getInt8(ut));for(_e=0;_e<q.length;_e++){var vt=q[_e],gt=vt.rbspView,Pt=vt.ebspLength;Oe.setUint8(Ge++,0),Oe.setUint8(Ge++,0),Oe.setUint8(Ge++,0),Oe.setUint8(Ge++,1),h?(Oe.setUint8(Ge++,78),Oe.setUint8(Ge++,1)):Oe.setUint8(Ge++,6);for(var wt=0;wt<Pt;wt++)Oe.setInt8(Ge++,gt[wt-0])}if(a)if(h){var At=new DataView(Jl.buffer);for(ut=0;ut<Jl.length;ut++)Oe.setInt8(Ge++,At.getInt8(ut))}else for(var Vt=new DataView(jl.buffer),ut=0;ut<jl.length;ut++)Oe.setInt8(Ge++,Vt.getInt8(ut));t.data=Pe,a&&(this.recvLastKeyFrameTime=S),n.enqueue(t)},e.prototype.onCreateOfferSuccess=function(t,n,r,i){var s=this;if(n&&(this.isUpdateSDP=!0,i&&(this.Pv=i)),this.xu&&this.xu.getTracks().forEach(function(c){rn(c,s.an,ie.fgh)}),this.info(ie.fgh+" local sdp revert "+this.$l.join("")),this.Dv(t),this.info(ie.fgh+" localSdp1 "+t.sdp.substr(0,t.sdp.length/2)),this.info(ie.fgh+" localSdp2 "+t.sdp.substr(t.sdp.length/2)),this.Ld&&!n)return this.ev=t,void this.Vd(t);this.setLocalSdp(t,r)},e.prototype.Dv=function(t){var n;this.Ka.bitRate>0&&(t.sdp=this.Mv(t.sdp,this.Ka.bitRate)),t.sdp=t.sdp.replace(/sendrecv/g,"sendonly");var r=t.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/)?(n=t.sdp.match(/m=application[\s\S]+datachannel[\s\S]+/))===null||n===void 0?void 0:n[0]:null;if(r){var i=r.replace(/sendonly/,"sendrecv");t.sdp=t.sdp.replace(r,i)}var s=[];isNaN(this.Ka.audioBitrate)||s.push("maxaveragebitrate="+this.Ka.audioBitrate);var c=/stereo=\d+/,u=t.sdp.match(c),l="stereo="+(this.Ka.channelCount===2?1:0);if(u&&u[0]?t.sdp=t.sdp.replace(c,l):s.push(l),this.$d.enableDTX===!0){var a=/usedtx=\d+/,h=t.sdp.match(a),m="usedtx="+(this.$d.enableDTX?1:0);h&&h[0]?t.sdp=t.sdp.replace(a,m):s.push(m)}var S=/useinbandfec=\d+/,x=t.sdp.match(S);x&&x[0]&&s.push(x[0]),t.sdp=t.sdp.replace(S,s.join(";")),this.$l=t.sdp.match(/m=(.\w*)\s/g)||[],this.info(ie.fgh+" local sdp revert "+this.$l.join(""));var q=j.getSDPVideoCodec(t.sdp);if(t!=null&&t.sdp.includes("m=video")&&q[this.nd].length===0){if(!this.publishOption.enableAutoSwitchVideoCodec)return void this.publishStateUpdateError(Or.le,!0,"not support ".concat(this.nd," codec"));var V=this.nd;if(this.nd=this.nd==="H264"?"VP8":"H264",q[this.nd].length===0&&V==="H265"&&(this.nd="VP8"),this.info("".concat(ie.fgh," switch video codec to ").concat(this.nd)),this.pn.actionListener("publisherVideoEncoderChanged",this.getCodecId(V),this.getCodecId(this.nd),this.streamId),q[this.nd].length===0)return void this.publishStateUpdateError(Or.le,!0,"not support H264 and VP8 codec")}t.sdp=j.getSDPByVideDecodeType(t.sdp,this.nd),this.setSdpHardCode(t),this.pn.browser==="firefox"&&Ir(this.pn.browserInfo,"firefox",139,2)&&(t.sdp=nh(t.sdp))},e.prototype.setLocalSdp=function(t,n){var r,i=this;this.info(ie.fgh+" set local sdp");var s=this.getSpan(k.wH.event,this.parentSpanKey);this.pn.ia(s,{sdp:t.sdp}),s.setAttributes({is_mini:k.wH.is_mini(this.$u),is_dual_stream:k._F.is_dual_stream(this.lowStream?1:0)}),(r=this.Xl)===null||r===void 0||r.setLocalDescription(t).then(function(){return $i(i,void 0,void 0,function(){return eo(this,function(c){switch(c.label){case 0:return s.end(),[4,this.onSetLocalDescriptionSuccess(t,n)];case 1:return c.sent(),[2]}})})},function(c){i.error(ie.fgh+" error "+c.toString()),i.cr.setError(s,{code:Or.Qn.code,message:c.toString()}),i.publishStateUpdateError(Or.Qn,!0)})},e.prototype.Mv=function(t,n){var r="AS";return this.pn.browser==="firefox"&&(n=1e3*(n>>>0),r="TIAS"),t=t.indexOf("b="+r+":")===-1?t.replace(/(m=video.*\r\nc=IN.*\r\n)/g,"$1b="+r+":"+n+`\r
`):(t=t.replace(new RegExp("b="+r+`:.*\r
`,"g"),"b="+r+":"+n+`\r
`)).replace("b="+r+":"+n+`\r
`,"")},e.prototype.setSdpHardCode=function(t){var n,r,i=!1,s=(n=this.mn)===null||n===void 0?void 0:n.previewType,c=this.pn.settingConfig;s==="camera"?i=c.getSetting("camera_hard_encode"):s==="screen"?i=c.getSetting("hardware_encode"):s==="custom"&&(i=c.getSetting("custom_hard_encode"));var u=!i;this.info(ie.rS5+" ".concat((r=this.mn)===null||r===void 0?void 0:r.previewType," software encode: ").concat(u,", "));var l=j.getSDPByVideDecodeType(t.sdp,this.nd,u,this.pn.engineConfig.encodecSelectionMode);t.sdp=l},e.prototype.onSetLocalDescriptionSuccess=function(t,n){return $i(this,void 0,void 0,function(){var r,i=this;return eo(this,function(s){return this.info(ie.rS5+" success"),this.xu&&this.xu.getTracks().forEach(function(c){rn(c,i.an,ie.rS5)}),!this.isUpdateSDP&&(this.state=2),n&&(this.previewer.videoInfo=Ni(Ni({},this.Ka),n)),this.setSdpHardCode(t),this.Od&&!this.isUpdateSDP?this.Ld?(this.info(ie.rS5+" fully auto tcp"),[2]):(this.Vd(t),[2]):(r=function(c){var u,l={};c?l.miniSdp=c:l.sdp=t.sdp;var a=Ni(Ni({},l),{keyframe_intv:Math.floor(((u=i.Ka)===null||u===void 0?void 0:u.keyFrameInterval)||2),paramsExt:i.yv});if(i.Zl=(0,E.Mo)(),i.isUpdateSDP){i.info(ie.rS5+" update sdp");var h=Ni(Ni({},a),{type:0});i.Kd.sendMediaDescUpdateReq(i.Zl,i.Df,h,function(S,x,q){(q==null?void 0:q.result)==0&&i.parseRemoteSdp(q,function(V){i.xv(V)||i.Iv(V)},function(V){i.publishStateUpdateError(V)})},function(S,x){i.error(ie.rS5+" update sdp failed"),i.Pv&&i.Pv(-1),i.publishStateUpdateError(S==E.Xb?Or.re:Or.se)})}else{var m=i.getSpan(k.r2.event,i.parentSpanKey);m.setAttributes({req_params_ext:i.yv}),i.Kd.sendMediaDesc(i.Zl,i.Df,0,a,function(S,x,q){i.pn.ia(m,{sdp:a.sdp}),m.setAttributes({webrtc_sid:k.r2.webrtc_sid(x),mediaDescription:{keyframe_intv:a.keyframe_intv}}),i.Zl==S&&i.Df==x?(i.info(ie.rS5+" send success stateNego:waiterAnswer"),i.ed=se.waiterAnswer,i.state=3,i.parseRemoteSdp(q,function(V){i.pn.ia(m,{remote_sdp:V}),m.end(),i.xv(V)||i.Iv(V,!0,void 0,q==null?void 0:q.mini_sdp)},function(V){i.publishStateUpdateError(V)})):i.error(ie.rS5+" seq or sessionId is not equal")},function(S,x){i.error(ie.rS5+" mediaDesc error "+JSON.stringify(S)),i.cr.setError(m,{code:Or.$n.code,message:Or.$n.message}),i.publishStateUpdateError(Or.$n)}),i.info(ie.rS5+" call success")}},this.getLocalMiniSdp(t.sdp,r),[2])})})},e.prototype.getVideoSenders=function(t){if(t===void 0&&(t=!1),t&&!this.previewer.isVideoEnabled)return[];var n=[];return this.videoSender&&(n.push(this.videoSender),this.lowVideoSender&&n.unshift(this.lowVideoSender)),n},e.prototype.canSetBandWidthBySender=function(){var t=this.pn.browserInfo.name.toLowerCase(),n=_i(this.pn.browserInfo.version);return(t==="chrome"||t==="safari"||t==="firefox"&&n>=64)&&"RTCRtpSender"in window&&"setParameters"in window.RTCRtpSender.prototype},e.prototype.applyVideoBitrate=function(t){return $i(this,void 0,void 0,function(){var n=this;return eo(this,function(r){return[2,new te.l3(function(i){var s=n.videoSender;if(s){var c=s.getParameters();c.encodings||(c.encodings=[{}]);var u=1e3*t,l=c.encodings[0].maxBitrate,a=JSON.stringify(c.encodings[0]);c.encodings[0].maxBitrate=u,s.setParameters(c).then(function(){n.info("zc.p.sbw set maxBitrate success. ".concat(l,"=>").concat(u,", ").concat(a,",").concat(s.getParameters().encodings[0]," ")),i(!0)}).catch(function(h){n.warn("zc.p.sbw set maxBitrate fail"+h),i(!1)})}else i(!0)})]})})},e.prototype.xv=function(t){return Ti(t).length===0&&(this.publishStateUpdateError(Et.akb,!1),!0)},e.prototype.setBandWidthBySdp=function(t,n){this.info("zc.p.sbwbs bandwidth: ".concat(n));var r="AS";return this.pn.browser==="firefox"&&(n=1e3*(n>>>0),r="TIAS"),t=/b=AS.*(\r\n|\n)/.test(t)?t.replace(/AS:(\d+)/,r+":"+n):t.replace(/m=video.*(\r\n|\n)c=.*(\r\n|\n)/,"$&b=".concat(r,":").concat(n,`
`))},e.prototype.Iv=function(t,n,r,i){var s,c;return n===void 0&&(n=!1),$i(this,void 0,void 0,function(){var u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je,tt,ut,vt,gt,Pt,wt,At,Vt,qt,Gt,Sn,Qt,Wt,zt,Mt,jt,Kt,$t,yt=this;return eo(this,function(Pn){switch(Pn.label){case 0:if(this.info(ie.O2K+" call"),this.Ka.audioBitrate&&this.Ka.audioBitrate!==48e3&&(t=t.replace(/maxaveragebitrate=(\d+)/,"maxaveragebitrate="+this.Ka.audioBitrate)),this.td=t.match(/m=(.\w*)\s/g)||[],this.info(ie.O2K+" sdp revert "+this.td.join("")),this.setTurnTcp(),this.gn.autoSwitchProtocol=this.au("auto_to_tcp")||!1,u=this.au("udp_max_fail_num"),!isNaN(u)&&(this.gn.maxUdpFailNum=u),h=(l=this.gn).maxUdpFailNum,m=l.udpFailNum,this.info("zp.oro.0  autoToTcp: ".concat(a=l.autoSwitchProtocol,", udpFailNum: ").concat(m,", maxUdpFailNum: ").concat(h,".")),a&&!this.Bd&&m>=h&&(this.info("zp.oro.0 switch to tcp."),this.Bd=!0,this.Ld=!1),(S=this.au("udp_or_tcp",!0))&&(this.info("zp.oro.0 setting udp_or_tcp "+S),this.Bd=S==="tcp"),this.Bd&&!this.gn.isProxy&&this.pn.browser!=="firefox"&&((s=t.match(/candidate.*/g))===null||s===void 0||s.forEach(function(pn){var un=pn.replace(/udp/,"tcp");un.includes(" tcptype ")||(un=un.replace(" typ host "," typ host tcptype passive ")),t=t.replace(pn,un)})),this.gn.isProxy)if(x=Ns(t),q=x[0],V=x[1],_e=t.match(/a=mid:[^(\n|\r)]+/g),V&&_e)if(this.Ud.intranet)setTimeout(function(){V.forEach(function(pn,un){var ln,Mn={sdpMLineIndex:un,candidate:pn.replace(q[un].ip,yt.Ud.wanIP).replace("a=",""),sdpMid:_e[un].replace("a=mid:","")};yt.info("zp.oro.0  add wan candidate:"+JSON.stringify(Mn)),(ln=yt.Xl)===null||ln===void 0||ln.addIceCandidate(new RTCIceCandidate(Mn))})},1e3);else for(this.info("zp.oro.0  change candidate ip from lan to wan: "+(ke=this.Ud.wanIP)),Pe=0;Pe<V.length;Pe++)Ge=(Oe=V[Pe]).replace(q[Pe].ip,ke),t=t.replace(Oe,Ge);else this.warn("zp.oro.0  candidate not found");else t=this.extractCandidate(t);if(this.info("zp.oro.0 sdp revert "+this.$l.join("")+" "+this.td.join("")),this.$l.join()!==this.td.join()&&this.$l.length==this.td.length&&(Je=new RegExp("[\\s\\S]*"+this.td[0]).exec(t)[0].replace(this.td[0],""),tt=[],ut="",this.$l.forEach(function(pn){var un=yt.td.findIndex(function(Hn){return Hn==pn}),ln=new RegExp(pn+"[\\s\\S]*"+(yt.td[un+1]||"")).exec(t)[0].replace(yt.td[un+1],""),Mn=/a=mid:(\w)/.exec(ln)[1];tt.push(Mn),ut+=ln||""}),t=Je.replace(/a=group:BUNDLE.*/,"a=group:BUNDLE "+tt.join(" "))+ut,this.$l=[],this.td=[]),(vt=Kr(t).filter(function(pn){return pn.startsWith("m=video")})).length>0&&(Pt=(gt=this.lowStream?vt[1]:vt[0]).match(/m=video(.|\r|\n)*a=rtpmap(.|\r|\n)*(a=fmtp:(\d+).*)/),(0,Vn.H8)()&&(wt=this.Zd.getStartVideoBitrate(),At=this.Zd.getMinVideoBitrate(),Vt=[],At&&Vt.push("x-google-min-bitrate=".concat(At)),wt&&Vt.push("x-google-start-bitrate=".concat(wt)),Pt!==null&&Vt.length&&(qt=Pt[3],Gt="".concat(qt,";").concat(Vt.join(";")),Sn=gt.replace(qt,Gt),t=t.replace(gt,Sn)))),!(this.Ka.bitRate>0))return[3,5];if(Qt=this.Ka.bitRate,Wt=this.Ka.bitRate,zt=!1,!this.canSetBandWidthBySender())return[3,4];Pn.label=1;case 1:return Pn.trys.push([1,3,,4]),Wt=this.Zd.getTargetVideoBitrate(),[4,this.applyVideoBitrate(Wt)];case 2:return zt=Pn.sent(),[3,4];case 3:return Mt=Pn.sent(),this.error(ie.O2K+JSON.stringify(Mt)),[3,4];case 4:zt||(t=this.setBandWidthBySdp(t,Qt)),(jt=this.getVideoSenders())==null||jt.forEach(function(pn){if(pn&&pn.getParameters&&pn.setParameters){var un=pn===yt.lowVideoSender,ln=pn.getParameters();if(ln.encodings&&ln.encodings.length!=0||(ln.encodings=[{}]),un){var Mn=yt.lowStreamVBitrate;Mn&&(ln.encodings[0].maxBitrate=1e3*Mn)}else{var Hn=yt.getScaleResolutionDownBy();Hn!=1&&(ln.encodings[0].scaleResolutionDownBy=Hn)}yt.videoInfo.frameRate>0&&(ln.encodings[0].maxFramerate=yt.videoInfo.frameRate),pn.setParameters(ln)}}),Pn.label=5;case 5:return this.info(ie.O2K+" remoteSdp:"+t),Kt={type:"answer",sdp:t},$t=this.getSpan(k.Pe.event,this.parentSpanKey),this.pn.ia($t,{sdp:Kt.sdp}),$t.setAttributes({is_mini:k.Pe.is_mini(this.$u),is_dual_stream:k._F.is_dual_stream(this.lowStream?1:0),webrtc_sid:k.Pe.webrtc_sid(this.Df)}),this.nv=Kt.sdp,(c=this.Xl)===null||c===void 0||c.setRemoteDescription(new RTCSessionDescription(Kt)).then(function(){yt.info(ie.O2K+" set success"),yt.xu&&yt.xu.getTracks().forEach(function(pn){rn(pn,yt.an,ie.O2K)}),$t.end(),yt.ed==se.iceConnected&&yt.Pv&&(yt.info(ie.O2K+" update sdp success"),yt.Pv(0),yt.Pv=void 0,yt.isUpdateSDP=!1)},function(pn){yt.error(ie.O2K+" failed: "+pn.toString()),yt.$u&&(0,R.G0)(i)&&yt.warn(ie.O2K+" remote mini  "+i.toString()),$t.setAttributes({error:Or.Zn.code,message:pn.toString()}),$t.end();var un=!0;yt.$u&&(un=!1,yt.$u=!1,yt.Jl=performance.now()-yt.Fl,yt.Ll=4),yt.publishStateUpdateError(Or.Zn,un)}),this.state=4,n&&(this.jv(this.Hl),this.Hl=[],this.state=5),this.Ld&&this.Rv(r),this.startTime=Date.now(),this.checkRetryOtherIPCandidate(),this.info(ie.O2K+" call success"),[2]}})})},e.prototype.checkRetryOtherIPCandidate=function(){var t=this;this.hv=setTimeout(function(){t.info("".concat(ie.K15," check ").concat(t.state," ").concat(t.ipNodeType," ").concat(t.kl.length)),t.state!==6&&t.Sl&&t.kl.length>0&&(t.ipStackNode=t.ipStackNode===Y.IPv4?Y.IPv6:Y.IPv4,t.restartIce())},this.Cl)},e.prototype.extractCandidate=function(t){var n=this,r=Ns(t),i=r[0];return r[1].forEach(function(s,c){var u=i[c].ip,l=Ar(u);if(n.ipStackNode!==l){var a={sdpMLineIndex:parseInt(i[c].mid),candidate:s.replace("a=",""),sdpMid:i[c].mid};n.kl.push(a),t=t.replace(s+`
`,"")}if(l===Y.IPv4){var h=Fa(u),m=s.replace(new RegExp(u,"g"),h).replace("a=",""),S={sdpMLineIndex:parseInt(i[c].mid),candidate:m,sdpMid:i[c].mid};n.Ol.find(function(x){return x.candidate===S.candidate&&x.sdpMLineIndex===S.sdpMLineIndex&&x.sdpMid===S.sdpMid})||n.Ol.push(S)}}),t},e.prototype.getScaleResolutionDownBy=function(){var t,n,r,i=this.lastPublishStats.frameWidth,s=((n=(t=this.mn)===null||t===void 0?void 0:t.cameraMaxResolution)===null||n===void 0?void 0:n.maxWidth)||0,c=(r=this.mn.videoTrack)===null||r===void 0?void 0:r.getSettings().width,u=i?Math.min(s,i):s;return s&&c?Math.max(u/c,1):1},e.prototype.setBitrate=function(t){var n;return $i(this,void 0,void 0,function(){var r,i,s=this;return eo(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,this.applyVideoBitrate(t)];case 1:if(c.sent(),!(0,Vn.aR)()||!(0,Vn.hL)())return[3,5];c.label=2;case 2:return c.trys.push([2,4,,5]),[4,(n=this.peerConnection)===null||n===void 0?void 0:n.createOffer({})];case 3:return r=c.sent(),this.onCreateOfferSuccess(r,!0,Ni(Ni({},this.videoInfo),{bitRate:t}),function(u){return $i(s,void 0,void 0,function(){return eo(this,function(l){return this.info("zc.p.sbw set bitrate by update sdp"),[2]})})}),[3,5];case 4:return c.sent(),[3,5];case 5:return this.Zd.setVideoBitrate(t),this.Ka.bitRate=t,[3,7];case 6:return i=c.sent(),this.error(ie.ny0+JSON.stringify(i)),[3,7];case 7:return[2]}})})},e.prototype.setVideoBitrateForTC=function(t){this.Zd.setVideoBitrate(t)},e.prototype.setConfiguration=function(t,n){var r,i,s=this;if(this.info(ie.XR3+" 1"),n){var c=n.turn_username,u=n.turn_auth_key,l=n.turn_urls;this.Il=c,this.Tl=u;var a=void 0;if(l){var h=l.split(";"),m=[];h.forEach(function(x){var q=Fi(x).replace("[","").replace("]",""),V=Ar(q);if(s.ipStackNode===V?m.push(x):s.El.push(x),V==Y.IPv4){var _e=Fa(q),ke=x.replace(q,"[".concat(_e,"]"));s.gn.isCandidateHasIPv6&&m.push(ke)}}),(r=this.El).push.apply(r,m),(a=m).length===0&&a.push.apply(a,this.El)}else{var S=Ti(t);if(S.length===0)return this.info(ie.XR3+" no candidate"),!1;a=S}(i=this.Xl)===null||i===void 0||i.setConfiguration({iceTransportPolicy:"all",rtcpMuxPolicy:"require",iceServers:[{urls:a,username:c,credential:u}],encodedInsertableStreams:this.xd.isSEIStart})}return!0},e.prototype.onIceConnectionStateChange=function(t){var n,r=this;if(this.state!=7&&this.Xl!=null){this.info(ie.lWs+" ice state: "+this.Xl.iceConnectionState);var i=this.getSpan(k.CK.event,this.parentSpanKey,k.Jv.event);if(i.setAttributes({ice_state:k.CK.ice_state(this.Xl.iceConnectionState)}),this.Xl.iceConnectionState==="connected"){if(this.info(ie.lWs+" connected state "+this.state+" ?"+((n=this.Xl)===null||n===void 0?void 0:n.connectionState)),this.jd){var s=new Date().getTime()-this.jd;this.tv.setAttributes({publish_begin_time:fi.publish_begin_time(s)}),this.jd=0}if(this.cr.spanEnd({key:k.Ov.event,par:this.va},{webrtc_sid:this.Df}),this.ed=se.iceConnected,this.zd){var c=new Date().getTime()-this.zd;this.info(ie.lWs+" ice time "+c)}this.ql=!1,this.info(ie.lWs+" stateNego:iceConnected"),this.av&&(clearTimeout(this.av),this.av=null),this.cv!=null&&(clearTimeout(this.cv),this.cv=null),this.Xl.connectionState||(this.sd?this.publishSuccess():(this.qv&&clearTimeout(this.qv),this.qv=null,this.qv=setTimeout(function(){var l;r.info(ie.lWs+" get first stats state "+r.state),r.state!==6&&((l=r.Xl)===null||l===void 0||l.getStats().then(function(a){r.info(ie.lWs+" get first stats suc"),a.size>0&&r.publishSuccess()}))},1e3)))}else if(this.Xl.iceConnectionState==="closed")i.end(),this.ed=se.iceClosed,this.Lv(this.Xl.iceConnectionState);else if(this.Xl.iceConnectionState==="failed")i.end(),this.ed=se.iceFailed,this.Lv(this.Xl.iceConnectionState);else if(this.Xl.iceConnectionState==="disconnected"){i.end(),this.warn(ie.lWs+" ice disconnected "),this.ed=se.iceDisconnected;var u=this.gn.lastChangeIpTime;u&&Date.now()-u<15e3?this.publishStateUpdateError(Or.Xn):this.cv||(this.cv=setTimeout(function(){r.Lv("disconnected")},15e3))}}},e.prototype.onIceCandidate=function(t){var n,r,i=this;if(this.info(ie.Bnp+" candidate "+JSON.stringify(t.candidate)),t.candidate)if(t.candidate.candidate&&Ar((n=t.candidate.candidate.split(" "))===null||n===void 0?void 0:n[4])===Y.IPv6&&(this.Ld&&(this.info("".concat(ie.Bnp," can len ").concat(this.Ol.length)),this.Ol.forEach(function(c){var u;(u=i.Xl)===null||u===void 0||u.addIceCandidate(new RTCIceCandidate(c)).then(function(){i.info("".concat(ie.Bnp," add can suc"))}).catch(function(l){i.info("".concat(ie.Bnp," add can fail, ").concat(l.message))})})),this.gn.isCandidateHasIPv6=!0),((r=t.candidate.candidate)===null||r===void 0?void 0:r.indexOf("relay"))!=-1){this.info(ie.Bnp+" candidate "+t.candidate.candidate+" state "+this.state+" autotcp "+this.Ld);var s=function(c){i.jv([{candidate:c.candidate.candidate,sdpMid:c.candidate.sdpMid,sdpMLineIndex:c.candidate.sdpMLineIndex}])};this.Ld?s(t):this.state<5||this.state==7?this.Hl.push({candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex}):s(t)}else this.info(ie.Bnp+" candidate not relay")},e.prototype.jv=function(t){var n=this;if(this.info(ie.n9u+" called"),!(t=t.filter(function(i){return i.candidate.indexOf("relay")>0}))||t.length<1)this.info(ie.n9u+" cancelled");else{var r=this.getSpan(k.aH.event,this.parentSpanKey);r.setAttributes({candidate_info:k.aH.candidate_info(t)}),this.ed!==se.iceConnected&&(this.ed=se.sendCandidate),this.info(ie.n9u+" stateNego:sendCandidate"),this.Kd.sendCandidateInfo(t,function(i,s,c){n.info(ie.n9u+" send success"),r.end()},function(i,s){n.error(ie.n9u+" failed to send: "+i.toString()),n.cr.setError(r,{code:Or.te.code,message:i.toString()}),n.publishStateUpdateError(Or.te)})}},e.prototype.Cv=function(t){var n,r,i=(n=this.Xl)===null||n===void 0?void 0:n.connectionState;if(this.info(ie.n9B+" conn state: "+i),i==="connected"){if(this.yd==="motion"){var s=this.videoSender;s&&((r=s.track)===null||r===void 0?void 0:r.kind)==="video"&&"contentHint"in s.track&&(this.info("".concat(ie.BsE," recover contentHint: ").concat(s.track.contentHint," => ").concat(this.yd,", tid :").concat(s.track.id)),s.track.contentHint=this.yd),this.yd=""}this.state!==6&&this.publishSuccess()}},e.prototype.onSignalStateChange=function(t){this.info(ie.n9B+" signal state: "+t.target.signalingState),this.state!=7&&this.Xl!=null&&t.target.signalingState==="closed"&&(this.ed=se.iceClosed,this.Lv(this.Xl.iceConnectionState))},e.prototype.vv=function(t,n,r){this.info(ie.Q4K+" "+JSON.stringify(r));var i=this.getSpan(k.Ux.event,k.Jv.event);i.setAttributes({err_info:k.Ux.err_info(r.err_info||""),reason_info:r==null?void 0:r.reason}),i.end(),this.cr.spanSetAttributes({key:k.Jv.event,par:this.va},{denied_info:k.Jv.denied_info(r.err_info),stop_reason:k.Jv.stop_reason("DenyStop")});var s=r.err_info?JSON.parse(r.err_info.toLowerCase()):{},c=s.action?s.action:null,u=1*r.reason,l=JSON.parse(JSON.stringify(Or.Fn));l.message+=" reason:".concat(u," ").concat(c?" action:"+c:""," ").concat(s!=null&&s.err?" err:"+(s==null?void 0:s.err):""),l.message+=";".concat(Zd(u,c,s==null?void 0:s.err)),s.err===1011&&(l=Or.Gn),s.err===1014&&(l=Or.Jn),s.err===1012&&(l=Et.pn5),this.av&&clearTimeout(this.av);var a=!([4,8,10,11,12,14,18,24,26,27,28,32].includes(u)||[2,3,4,5,6].includes(c)),h=!1;if(!this.Bd){if([8,10].includes(u)||[18,15].includes(u)&&c===2&&[3001,3002].includes(s.err)){this.gn.udpFailNum++;var m=this.gn;m.autoSwitchProtocol&&m.udpFailNum>=m.maxUdpFailNum&&(this.Od=!1,this.gn.setIsPeer(!1),h=!0)}else this.gn.udpFailNum=0;var S=this.gn.isNodeLast(this).lastTryNext,x=[3001,3002,3003,3004,3005,3006,3007,3008].includes(s.err);S&&x&&(this.info(ie.Q4K+" switch tcp by all fail"),this.pn.turnToTcp=!0,this.Ld=!1,this.Od=!1,this.gn.setIsPeer(!1))}this.publishStateUpdateError(l,a,s,h)},e.prototype.mv=function(t,n,r){if(this.info(ie.de8+" received "),this.getSpan(k.$9.event,k.Jv.event).end(),n==this.Df){var i={code:Or.Fn.code,message:"server session reset "+r.reason};this.av&&clearTimeout(this.av),this.publishStateUpdateError(i)}else this.error(ie.de8+" cannot find session")},e.prototype.pv=function(t,n,r){var i;if(this.info("".concat(ie.vBC," received, ").concat(t)),this.Tv("PublishEventPush",t)){var s=this.getSpan(k.fj.event,this.parentSpanKey,k.Jv.event);s.setAttributes({event_state:k.fj.event_state(r.event),webrtc_sid:n}),s.end(),this.qv&&(clearTimeout(this.qv),this.qv=null);var c=(i=this.Xl)===null||i===void 0?void 0:i.connectionState;this.sd=!0,(c?c==="connected":this.ed===se.iceConnected)&&this.state!=6?r.event==0&&this.publishSuccess():this.resendStreamStatus(0)}},e.prototype.gv=function(t,n,r){if(this.Tv("ClientInfoPush",t)){this.pn.clientIP!==r&&this.info(ie.VMq+" client ip changed "+this.pn.clientIP+" "+r),this.pn.clientIP=r,this.Id=n,this.Kd.peerId=this.Id,this.Dd=r,this.pn.isMultiOuter=this.isMultiOuter(),this.state===6&&this.getConnectIP(),this.xd.isSEIStart&&this.xd.SEIType==Ye.UserUnregister&&this.xd.unregisterSeiFilter&&this.sendSEIUUID();var i=this.mn;if(i&&i.activateSEIConfig!==null){var s=i==null?void 0:i.activateSEIConfig;this.activateSEIInsert(s.action,s.infoType)}}},e.prototype.sendSEIUUID=function(){var t=this;this.info("zc.ssuid call: "+this.xd.unregisterSeiFilter),this.Kd.sendSEIUUID(this.xd.unregisterSeiFilter).then(function(n){t.info("zc.ssuid success"),(n==null?void 0:n.result)==0&&(t.xd.uuidSend=!0)}).catch(function(n){t.error("zc.ssuid failed")})},e.prototype.sendRestartIce=function(t,n){var r=this;this.info("zc.p.0.srsi call: "+t+" "+n),this.Kd.sendRestartIce(t,n).then(function(i){r.info("zc.p.0.srsi result "+JSON.stringify(i))}).catch(function(i){r.warn("zc.p.0.srsi fail: "+JSON.stringify(i))})},e.prototype.Lv=function(t){this.info(ie.lWs+" state "+this.state+" connectionState "+t),this.publishStateUpdateError(Or.Xn)},e.prototype.getStopReason=function(t){var n="StopPublish";if(t&&t.code)switch(t.code){case 1103051:n="ReachMaxAVRetryTime";break;case 1012:n="DuplicateStreamID";break;default:n="StopPublish"}return n},e.prototype.stopPublish=function(t){var n,r,i;this.info(ie.aSL+" called "+this.state+" "+JSON.stringify(t));var s=this.getStopReason(t);if(this.gn.publishersLength==1){var c=this.gn.playerList;for(var u in c){var l=c[u];l.state==6&&l.broadcasterStatus==E.ku.start&&(l.sendBroadcasterStatus(0),l.broadcasterStatus=E.ku.stop)}}this.closeSession(0),this.resetPushCmdSeqMap();var a=Date.now();this.tv.setAttributes({publish_state_time:fi.publish_state_time(a-this.reportPublishStateTime)}),this.uploadRTCPublishStats();var h=this.Xh?0:this.lastFailTimeLen;this.cr.spanEnd({key:k.Jv.event,par:this.va},{tryidx:zs.tryidx(this.rtcPublishCount),url:zs.url((n=this.Wd)===null||n===void 0?void 0:n.server),ip:zs.ip(this.ip),dispatch_external_ip:zs.dispatch_external_ip(this.pn.clientIP),resource_type:zs.resource_type("rtc"),protocol:zs.protocol("webrtc"),net_protocol:Eo.net_protocol(this.netProtocol),stop_reason:k.Jv.stop_reason(s),try_time:zs.try_time(h),error:(t==null?void 0:t.code)||0,message:(t==null?void 0:t.message)||""}),this.Xh||this.cr.spanEnd({key:(this.isRePublish?k.fo:k.ch).event,par:this.va},{error:(t==null?void 0:t.code)||0,message:(t==null?void 0:t.message)||"",url:Eo.url((r=this.Wd)===null||r===void 0?void 0:r.server),ip:Eo.ip(this.ip),peer_id:Eo.peer_id(this.Id),source_type:Eo.source_type("rtc"),net_protocol:Eo.net_protocol(this.netProtocol)});var m=0;t&&t.code!==0&&(m=t.code===Et.xbZ.code?this.latestPublishErrCode:t.code);var S=this.publishedTimeStamp;this.tv.setAttributes({stream_id:fi.stream_id(this.va),webrtc_sid:fi.webrtc_sid(this.Df),probe_ip_cnt:fi.probe_ip_cnt(this.Rd),valid_probe_ip_cnt:fi.valid_probe_ip_cnt(this.Td),poor_quality_retry_cnt:fi.poor_quality_retry_cnt(this.poorQualityRetryCnt),probe_not_trigger_retry_info:fi.probe_not_trigger_retry_info(this.Cd.length>0?this.Cd:void 0),bitrate:fi.bitrate(1e3*this.Ka.bitRate),h:fi.h(this.Ka.height),w:fi.w(this.Ka.width),cap_w:fi.w(this.Ka.width),cap_h:fi.h(this.Ka.height),fps:fi.h(this.Ka.frameRate),env:fi.env(this.pn.testEnvironment?3:1),fail_cnt:fi.fail_cnt(Math.max(this.rtcPublishCount-1,0)),continuous_fail_cnt:fi.continuous_fail_cnt(Math.max(this.continuousFailCnt-1,0)),stop_reason:fi.stop_reason(s),error:(t==null?void 0:t.code)||0,message:(t==null?void 0:t.message)||"",last_error:m,try_time:zs.try_time(h),valid_d:this.validPublishedTime+(S?a-S:0),total_d:a-this.firstPublishedTimeStamp,tempbroken_cnt:this.errorTimes,is_mini:this.$u}),(t==null?void 0:t.code)===Or.ce.code&&this.uploadPublishEvent(t),this.tv.end(),this.gn.stopToReport(0),this.gn.stopNetProbe(this),this.retryFailGwNodes=[],this.resetPublish(0),this.hasSucceed=!1,this.isRePublish=!1,this.rtcPublishCount=0,this.ql=!1,this.Rd=0,this.Td=0,this.poorQualityRetryCnt=0,this.Cd=[],this.continuousFailCnt=0,(i=this.Qd)===null||i===void 0||i.resetPublish(),this.Zd.stop(),this._d=!1,this.seiWorker&&this.seiWorker.postMessage({cmd:"clear",type:"push",streamID:this.va})},e.prototype.uploadRTCPublishStats=function(){var t,n,r,i,s,c,u,l,a,h,m,S,x,q;this.lastPublishStats.time&&this.cr.spanSetAttributes({key:k.Jv.event,par:this.va},{lsttime:k.Jv.lsttime(parseInt(this.lastPublishStats.time)),total_stat:k.Jv.total_stat({afc:(t=this.lastPublishStats)===null||t===void 0?void 0:t.audioPacketsSent,vfc:(n=this.lastPublishStats)===null||n===void 0?void 0:n.framesSent,tfc:((r=this.lastPublishStats)===null||r===void 0?void 0:r.audioPacketsSent)+((i=this.lastPublishStats)===null||i===void 0?void 0:i.framesSent),vb:(s=this.lastPublishStats)===null||s===void 0?void 0:s.videoBytesSent,ab:(c=this.lastPublishStats)===null||c===void 0?void 0:c.audioBytesSent,tb:((u=this.lastPublishStats)===null||u===void 0?void 0:u.videoBytesSent)+((l=this.lastPublishStats)===null||l===void 0?void 0:l.audioBytesSent),rtp_rtt:Math.round(1e3*((a=this.publishStat)===null||a===void 0?void 0:a.currentRoundTripTime))||0,w:(h=this.publishStat)===null||h===void 0?void 0:h.frameWidth,rtp_plr:(m=this.publishStat)===null||m===void 0?void 0:m.videoPacketsLostRate,h:(S=this.publishStat)===null||S===void 0?void 0:S.frameHeight,rtp_bw:!((x=this.publishStat)===null||x===void 0)&&x.availableOutgoingBitrate?(q=this.publishStat)===null||q===void 0?void 0:q.availableOutgoingBitrate:void 0})})},e.prototype.onPublishStateUpdate=function(t,n,r,i,s,c){},e.prototype.onPublishQualityUpdate=function(t,n){},e.prototype.onDisconnect=function(t){this.info(ie.Qld+" call"),this.info(ie.Qld+" websocket disconnect"),this.publishStateUpdateError(t||k.Nr.error.Wn,!!t)},e.prototype.publishSuccess=function(){var t,n,r,i,s,c=this;if(this.info(ie.La0+" call"),this.Bd||(this.gn.udpFailNum=0),this.isUpdateSDP&&this.Pv)return this.info(ie.La0+" update sdp success"),this.Pv(0),this.Pv=void 0,void(this.isUpdateSDP=!1);var u=this.isRePublish?k.fo:k.ch,l=(t=this.gn.publisherList[this.va])===null||t===void 0?void 0:t.retryStreamHandler;for(var a in l==null||l.getTryTime(this,!0),this.reportMiniSdpInfos(),this.cr.spanEnd({key:u.event,par:this.va},{url:Eo.url((n=this.Wd)===null||n===void 0?void 0:n.server),source_type:Eo.source_type("rtc"),signal_consume:Eo.signal_consume(this.signalTime),is_peer:Eo.is_peer(this.Od)},!0,!1),this.state!=6&&this.onPublishStateUpdate(E.eZ.start,this.va,{code:0,message:""},!0),this.state=6,this.hasSucceed=!0,this.continuousFailCnt=0,this.resetIceInfos(),this.resetNat64Infos(),this.getConnectIP(),this.fv=setTimeout(function(){c.reportPublishStartEvent()},1e3),this.reportPublishStateTime=Date.now(),this.gn.playerList){var h=this.gn.playerList[a];h.state==6&&h.broadcasterStatus==E.ku.stop&&(h.sendBroadcasterStatus(1),h.broadcasterStatus=E.ku.start)}var m=this.au("probe_started_num");!isNaN(m)&&(this.gn.probeStartedNum=m),this.qualityHandler.setPublishQualityTimer();var S=this.au("auto_switch_publish_video_codec",!0);this.publishOption.enableAutoSwitchVideoCodec&&S&&(!((r=this.Dl)===null||r===void 0)&&r.offerToReceiveVideo)&&!this.sideMediaConfig.isSEIStart&&(this.rv=setTimeout(function(){return $i(c,void 0,void 0,function(){var ke,Pe;return eo(this,function(Oe){switch(Oe.label){case 0:if(this.checkCodecSupport(!1))return[3,4];ke=this.nd,Pe=this.nd==="H264"?"VP8":"H264",this.info("".concat(ie.La0," switch video codec to ").concat(Pe)),Oe.label=1;case 1:return Oe.trys.push([1,3,,4]),[4,this.switchVideoCodec(ke,Pe)];case 2:return Oe.sent()&&this.pn.actionListener("publisherVideoEncoderChanged",this.getCodecId(ke),this.getCodecId(this.nd),this.streamId),[3,4];case 3:return Oe.sent(),this.warn("".concat(ie.La0," switch video codec fail")),[3,4];case 4:return[2]}})})},this.Nl)),this.xd.track&&this.xd.isSEIStart&&this.nd==="H265"&&(this.sv=setTimeout(function(){return $i(c,void 0,void 0,function(){var ke,Pe=this;return eo(this,function(Oe){switch(Oe.label){case 0:if(this.checkCodecSupport(!0))return[3,4];this._clearCanvasTimer(),this.Ml=320,this.xl=240,this.info("".concat(ie.La0," fb sei trk res to ").concat(this.Ml," * ").concat(this.xl)),Oe.label=1;case 1:return Oe.trys.push([1,3,,4]),ke=this.xd,[4,this._addCanvasStreamVideoTrack()];case 2:return ke.track=Oe.sent(),this.getVideoSenders().forEach(function(Ge){Ge&&Ge.replaceTrack(Pe.xd.track)}),[3,4];case 3:return Oe.sent(),this.warn("".concat(ie.La0," fb sei trk fail")),[3,4];case 4:return[2]}})})},this.Pl));var x=2,q=2,V=(i=this.mn)===null||i===void 0?void 0:i.videoTrack,_e=this.xu.getAudioTracks().length!==0&&this.xu.getAudioTracks()[0];this.xu&&this.xu.getTracks().forEach(function(ke){rn(ke,c.an,ie.La0)}),V&&V.readyState==="live"&&V.enabled||!((s=this.mn)===null||s===void 0)&&s.muteImage?x=0:V&&!V.enabled&&(x=3),_e&&_e.readyState==="live"&&(q=_e.enabled?0:3),this.sendStreamStatus(x,q,!0),this.gn.soundLevelDelegate&&this.mn&&this.mn.startSoundLevel(),this.pn.scenario===9&&this.setStreamAlignmentProperty(1).then(function(ke){c.an.info("zc.ssap ktv. "+ke)}),this.info(ie.La0+" call success")},e.prototype.startSoundLevel=function(){var t;if(this.info(ie.b9b+" call"),this.xu&&this.xu.getAudioTracks().length!=0)try{(t=this.mn)===null||t===void 0||t.startSoundLevel()}catch(n){this.error(ie.b9b+" get sound level failed "+n)}else this.info(ie.b9b+" local stream no found")},e.prototype.stopSoundLevel=function(){var t;this.info(ie.d8C+" call"),(t=this.mn)===null||t===void 0||t.stopSoundLevel()},e.prototype.handleEncBitrate=function(t,n,r){var i=this,s=1e3*this.Ka.bitRate,c=0;if(n>0){this.hd||this.ld||(this.fd++,n>=.75*t?(this.fd>=10&&this.vd>=.6*this.fd&&(this.ld=!0,this.md=s),this.vd++):this.fd>=10&&this.vd/this.fd<.3&&(this.hd=!0));var u=ce(this.pd,n,10);this.hd&&(u>=1.05*s?this.md>s&&(this.md-=u>t?u-t:u-s,this.md=Math.max(this.md,s),this.md=Math.min(this.md,2*s),c=this.md):u<.8*s&&(this.md===0&&(this.md=t),this.md=this.md>=s?this.md+.08*s:1.05*this.md,this.md=Math.min(this.md,2*s),c=this.md))}if(r>0&&r<s){var l=ce(this.bd,r,5);this.hd?l+n>1.05*s&&(this.md-=l+n-s,this.md=Math.max(this.md,s-l),c=this.md):c=this.md-l}else this.md<s&&(this.md=s,c=this.md);if(c>0){c=ce(this.gd,c,5);var a=this.getVideoSenders();if(!a)return;var h=a.length>1?a[1]:a[0]?a[0]:null;if(!h)return;var m=h.getParameters();m.encodings||(m.encodings=[{}]),m.encodings[0].maxBitrate=c,h.setParameters(m).then(function(){i.info(ie.Rfl+" success "+c)}).catch(function(S){i.error(ie.Rfl+" "+S)})}},e.prototype.resetEncBitrate=function(){this.hd=!1,this.fd=0,this.ld=!1,this.vd=0,this.md=0,this.pd=[],this.gd=[],this.bd=[]},e.prototype.replacePublishedTrack=function(t,n,r){var i,s;return n===void 0&&(n=!1),r===void 0&&(r={}),$i(this,void 0,void 0,function(){var c,u,l,a,h,m,S,x,q,V,_e,ke,Pe;return eo(this,function(Oe){switch(Oe.label){case 0:return this.info("zc.rt.1 call ".concat(t.kind," ").concat(n," ").concat(JSON.stringify(r))),c=this.previewer,(a=(l=(u=t.kind)==="video")?c.videoTrack:c.audioTrack)||r.handleTrack?(h=0,m=0,l?(h=Au(n?a:t),m=this.mic_status):u==="audio"&&(m=Au(t),h=this.camera_status),[4,c.replacePreviewTrack(t,n,r)]):[3,13];case 1:return Oe.sent(),S=t,t.kind=="audio"&&c.insertableaudio&&(!((i=c.localStream)===null||i===void 0)&&i.getAudioTracks()[0])&&(S=(s=c.localStream)===null||s===void 0?void 0:s.getAudioTracks()[0]),x=u==="audio"&&c.destNode,q=!1,(!l||!n&&c.isVideoNodeQueueEnabled)&&(u!=="audio"||x)||(q=!0),_e=l?this.lowVideoSender:void 0,(V=l?this.videoSender:this.audioSender)?q?(ke=!this.isTcVideoPasued()&&c.isVideoEnabled,l&&ke?_e&&c.lowStream?[4,_e.replaceTrack(c.lowStream.getVideoTracks()[0])]:[3,3]:[3,8]):[3,10]:[3,11];case 2:Oe.sent(),Oe.label=3;case 3:return c.streamFromCanvas?(c.streamFromCanvasTrack&&!c.zegoCaptureStream||(Pe=c.getStreamThroughCanvas(c.localStream),c.streamFromCanvasTrack=Pe.getVideoTracks()[0]),[4,V.replaceTrack(c.streamFromCanvas?c.streamFromCanvasTrack:S)]):[3,5];case 4:return Oe.sent(),[3,7];case 5:return[4,V.replaceTrack(S)];case 6:Oe.sent(),Oe.label=7;case 7:return[3,10];case 8:return l?[3,10]:c.isAudioEnabled?[4,V.replaceTrack(S)]:[3,10];case 9:Oe.sent(),Oe.label=10;case 10:return this.sendStreamStatus(h,m),[3,12];case 11:this.info("zc.rt.1 replace remote track will work after stream published"),Oe.label=12;case 12:return this.info("zc.rt.1 replace remote track success"),[2,{errorCode:0,extendedData:""}];case 13:return this.error("zc.rt.1 publisher track no found"),[2,{errorCode:Et.fFX.code,extendedData:Et.fFX.message}]}})})},e.prototype.sendStreamStatus=function(t,n,r,i){var s=this;r===void 0&&(r=!1),i===void 0&&(i=0),(r||this.camera_status!==t||this.mic_status!==n)&&this.Wd&&(this.camera_status=t,this.mic_status=n,this.Gd=!1,this.sd||this.zl?(this.zl&&(clearTimeout(this.zl),this.zl=null),i++,this.info(ie.msE+" start send ".concat(i," camera:").concat(t," mic:").concat(n,".")),this.Fd=this.Kd.sendStreamStatus(t,n,function(c){s.Fd===c&&(s.Gd=!0)},function(){s.camera_status===t&&s.mic_status===n&&(s.warn(ie.msE+" time out. ".concat(i)),i<=1&&s.sendStreamStatus(t,n,!0,i))})):this.zl=setTimeout(function(){s.resendStreamStatus(1)},3e3))},e.prototype.resendStreamStatus=function(t){var n,r,i;if(t===void 0&&(t=0),!this.Gd)if(this.info(ie.msE+" resend ".concat(t)),t==0){var s=2,c=2,u=(n=this.mn)===null||n===void 0?void 0:n.videoTrack,l=this.xu.getAudioTracks().length!==0&&this.xu.getAudioTracks()[0];u&&(u.readyState==="live"||!((r=this.mn)===null||r===void 0)&&r.muteImage)&&(s=!((i=this.mn)===null||i===void 0)&&i.muteImage||u.enabled===!0?0:3),l&&l.readyState==="live"&&(c=l.enabled===!0?0:3),this.sendStreamStatus(s,c,!0)}else this.sendStreamStatus(this.camera_status,this.mic_status,!0)},e.prototype.handleSEIVideoTrack=function(t){t=="add"&&this.xd.track?this._clearCanvasTimer():t!="remove"||this.xd.track||(this.xd.track=this._addCanvasStreamVideoTrack()),this.seiWorker&&this.seiWorker.postMessage({cmd:"publishStreamType",streamID:this.va,onlyAudio:!!this.xd.track})},e.prototype._addCanvasStreamVideoTrack=function(){var t=this;this.Ml===16&&this.xl===16&&this.nd==="H265"&&(this.Ml=160,this.xl=160),this.Ql=(0,te.FP)(this.Ml,this.xl),this.Yl=this.Ql.getContext("2d"),this.Kl=new Image,this.Kl.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAFFJREFUOE9jZGBgaGBgYLBnYGBwYCANHGBgYDjIyMDAcIWBgUGbNL1w1VdBBvwnUzNY26gBo2EwjNLBfjJyIiz7HADlBVB2DiEjR15lYGBYAwAypRSY53SYoAAAAABJRU5ErkJggg==";var n=this.pn.engineConfig.blankVideoTrackFrameInterval||100;return this.info("zc.acsvt frame interval: "+n),this.Vl=setInterval(function(){var r;(r=t.Yl)===null||r===void 0||r.drawImage(t.Kl,0,0,t.Ml,t.xl)},n),this.Ql.captureStream().getVideoTracks()[0]},e.prototype.getSpan=function(t,n,r,i){i===void 0&&(i=!1);var s=(0,te.fU)(this.cr,E.t0.H,this.va,t,n,r,i);return s.setAttribute("is_mini",this.$u),s},e.prototype.isMultiOuter=function(){return!(!this.pn.accessClientIp||!this.Dd||this.pn.accessClientIp===this.Dd)},e.prototype.isCustomCdn=function(){var t,n;return((t=this.$d)===null||t===void 0?void 0:t.cdnUrl)!==void 0&&((n=this.$d)===null||n===void 0?void 0:n.cdnUrl)!==""},e.prototype.setTurnTcp=function(){this.Bd=this.pn.turnToTcp,this.pn.turnOverTcpOnly!==void 0&&(this.Bd=this.pn.turnOverTcpOnly)},e.prototype.setStreamAlignmentProperty=function(t){return this.Md.alignment=t,this.Kd.sendStreamAlignmentProperty(t)},e.prototype.uploadPublishEvent=function(t){var n=this.va,r=t.code,i={};this.Jl&&(i.mini_retry_consume=+this.Jl.toFixed(0),this.Jl=0,this.Fl=0),this.cr.spanEnd({key:k.Og.event,par:n},Ni(Ni(Ni({},i),{error:r}),t),!0)},e.prototype.getConnectIP=function(){if(this.Dd&&!this.ip){var t=Ar(this.Dd),n=this.getIPByGwNode(t),r=n.ip,i=n.port;this.ip=r,this.port=i,this.info("zc.p.0.gci.0 ip: ".concat(r," ").concat(i)),this.reportPublishStartEvent()}},e.prototype.reportPublishStartEvent=function(){var t=this.isRePublish?k.fo:k.ch;this.cr.spanSetAttributes({key:t.event,par:this.va},{ip:Eo.ip(this.ip),port:Eo.port(this.port)}),this.cr.spanReport({key:t.event,par:this.va})},e.prototype.getIPByGwNode=function(t){var n;if(this.ipNode){var r=this.ipNode.vid.split("|"),i="";return r.forEach(function(u){var l=Ar(u);t===l&&(i=u)}),{ip:i,port:this.ipNode.port}}if(this.gwNode){var s=(n=this.gwNode)===null||n===void 0?void 0:n.split(":"),c=s[s.length-1];return{ip:this.gwNode.replace(":"+c,""),port:parseInt(c)}}return{ip:"",port:0}},e.prototype.sendNetQualityGrade=function(t,n){this.Kd.sendNetQualityGrade(t,n)},e.prototype.closeSession=function(t){var n,r;(n=this.Wd)===null||n===void 0||n.off("uaConnected",this.ou.onUaSocketConnected),this.Wl&&(this.Kd.sendCloseSession(t,function(){}),(r=this.Wd)===null||r===void 0||r.removeSession(this.Df),this.Wl=!1)},e.prototype.activateSEIInsert=function(t,n){var r=this;return new te.l3(function(i,s){return r.Kd?(r.Kd.activateSEIInsert(t,n,function(c,u){var l=!1;u.result===0?(r.info(ie.gPJ+" called success"),l=!0):u.result===1?(r.error(ie.gPJ+" "+u.peer_id+" invalid param."),l=!1):u.result===2&&(r.error(ie.gPJ+" peer not exist"),l=!1),i(l)},function(c){E.Xb===c&&r.error(ie.gPJ+" request timeout")}),!1):i(!1)})},e.prototype.getStreamAddOptions=function(){return{stream_resource:1,stream_codec:this.nd==="VP8"?2:this.lowStream?4:0}},e.prototype.onStatsUpdated=function(t){this.Zd.onStatsUpdated(t)},e.prototype.getLocalMiniSdp=function(t,n){var r,i=this;if(this.$u){var s=performance.now();(r=this.Yd)===null||r===void 0||r.getMiniSdp(t).then(function(c){i.Ul=performance.now()-s,n(c)}).catch(function(c){i.$u=!1,i.pn.$u=!1,i.Ul=performance.now()-s,i.Jl=performance.now()-i.Fl,i.Ll=1,n()})}else n()},e.prototype.parseRemoteSdp=function(t,n,r){var i,s=this;if(this.$u&&(0,R.G0)(t.mini_sdp)&&t.mini_sdp.byteLength>0){var c=performance.now();(i=this.Yd)===null||i===void 0||i.parseMiniSdp(t.mini_sdp).then(function(u){s.Gl=performance.now()-c,n(u)}).catch(function(u){s.$u=!1,s.pn.$u=!1,s.Gl=performance.now()-c,s.Jl=performance.now()-s.Fl,s.Ll=3,r(u)})}else n(t.sdp)},e.prototype.reportMiniSdpInfos=function(){var t=this.isRePublish?k.fo:k.ch,n={};(this.$u||this.Ll)&&(n.mini_error=this.Ll,n.code_sdp_consume=+this.Ul.toFixed(0),n.decode_sdp_consume=+this.Gl.toFixed(0),this.Ll=0,this.Ul=0,this.Gl=0),this.cr.spanSetAttributes({key:t.event,par:this.va},Ni({},n))},e.prototype.onTcPauseVideo=function(){var t=this;if(this._d=!0,this.peerConnection&&this.camera_status===0){var n="",r=this.getVideoSenders();r==null||r.forEach(function(s){return $i(t,void 0,void 0,function(){var c,u,l;return eo(this,function(a){return c=s===this.lowVideoSender,s.track&&(c?c&&(n+=" low:",n+=s.track.id,(u=(l=this.lowStream)===null||l===void 0?void 0:l.getVideoTracks()[0].clone())&&(u.stop(),s.replaceTrack(u),this.kd=u.id)):(n+=" big:",n+=s.track.id,(u=this.localStream.getVideoTracks()[0].clone()).stop(),s.replaceTrack(u),this.Ed=u.id)),[2]})})});var i=this.Zd.getFeedback();this.info("".concat(ie.BsE," pause video, tid: ").concat(n,", tc:{").concat(i.status,"|").concat(i.bandwide,"|").concat(i.targetBitrate,"|").concat(i.rtt,"}"))}else this.warn("".concat(ie.BsE," pause video, camera: ").concat(this.camera_status,", bw: ").concat(this.Zd.getBandwide()))},e.prototype.onTcResumeVideo=function(){var t=this;if(this._d=!1,this.peerConnection&&this.camera_status===0){var n="",r=this.getVideoSenders();r==null||r.forEach(function(s){return $i(t,void 0,void 0,function(){var c,u,l,a;return eo(this,function(h){return c=s===this.lowVideoSender,u=this.mn.isVideoEnabled&&!this.mn.hasStopCaptureVideo,s.track&&u&&(c?c&&(l=void 0,(l=this.Sd?this.xu.getVideoTracks()[0].clone():this.mn.streamFromCanvasTrack?this.mn.streamFromCanvasTrack:(a=this.lowStream)===null||a===void 0?void 0:a.getVideoTracks()[0])&&(s.replaceTrack(l),n+=" low:",n+=l==null?void 0:l.id)):(l=void 0,this.Sd?l=this.xu.getVideoTracks()[0]:(l=this.mn.getDestinationTrack())||(l=this.mn.streamFromCanvasTrack?this.mn.streamFromCanvasTrack:this.xu.getVideoTracks()[0]),l&&(s.replaceTrack(l),n+=" big:",n+=l.id))),[2]})})}),this.kd="",this.Ed="";var i=this.Zd.getFeedback();this.info("".concat(ie.BsE," resume video, tid: ").concat(n,", tc:{").concat(i.status,"|").concat(i.bandwide,"|").concat(i.targetBitrate,"|").concat(i.rtt,"}"))}else this.warn("".concat(ie.BsE," resume video, bw: ").concat(this.Zd.getBandwide()))},e.prototype.isVideoTrackAlive=function(){var t=this.mn._videoTrack,n=!(!t||t.readyState!=="live"||!t.enabled);return this.info("zc.p.0.ivta ".concat(n)),n},e.prototype.isAudioTrackAlive=function(){var t=this.xu.getAudioTracks().length!==0&&this.xu.getAudioTracks()[0],n=!(!t||t.readyState!=="live"||!t.enabled);return this.info("zc.p.0.iata ".concat(n)),n},e.prototype.getAvailableBitrate=function(){var t,n,r;return!((t=this.publishStat)===null||t===void 0)&&t.availableOutgoingBitrate&&(r=((n=this.publishStat)===null||n===void 0?void 0:n.availableOutgoingBitrate)/1e3),r},e}(Nl),dp=function(){this.publisherList={},this.playerList={}},zc=function(o,e,t,n,r){if(e.breakStartTime){var i=o-e.breakStartTime;i>=n&&(e.cumulativeBreakDuration+=i,r?e.cumulativeBreakDurationL3+=i:e.cumulativeBreakDurationRtc+=i,t.breakDuration+=i),e.breakStartTime=void 0}},rh=function(o,e,t,n,r,i,s,c,u,l){u===void 0&&(u=c);var a=1e3;if(r>a&&(r=a),n.breakStartTime)if(t)e===0?(o-n.breakStartTime>=22e3&&zc(o,n,s,r,l),i.breakDuration+=a):c>=r?c<500?c+u<a?(zc(o-(a-u),n,s,r,l),n.breakStartTime=o-c,i.breakDuration+=u+c,i.decodeTime+=a-(u+c)):(zc(o-a+u,n,s,r,l),n.breakStartTime=o-a+u,i.breakDuration+=a):c>=500&&(zc(o-c,n,s,r,l),n.breakStartTime=o-c,i.breakDuration+=a):u<=r?(zc(o-a+u,n,s,r,l),n.breakStartTime=void 0,i.breakDuration+=u,i.decodeTime+=a-u,s.decodeDuration+=a-u):i.breakDuration+=a;else{n.resumeRecv=!1;var h=o-a-n.breakStartTime;h<=0&&(h=0),n.breakStartTime=void 0,n.noBreakNoDecodeDuration+=h,l?n.noBreakNoDecodeDurationL3+=h:n.noBreakNoDecodeDurationRtc+=h,i.breakCancelDuration+=h,s.blankDuration+=h}else t?e===0?n.resumeRecv?(n.breakStartTime=o-a,i.breakDuration+=a):(n.noBreakNoDecodeDuration+=a,l?n.noBreakNoDecodeDurationL3+=a:n.noBreakNoDecodeDurationRtc+=a,s.blankDuration+=a):u>r?n.resumeRecv?(n.breakStartTime=o-u,n.cumulativeBreakDuration+=u,l?n.cumulativeBreakDurationL3+=u:n.cumulativeBreakDurationRtc+=u,i.breakDuration+=u,i.decodeTime+=a-u,s.breakDuration+=u,s.decodeDuration+=a-u):(n.noBreakNoDecodeDuration+=a,l?n.noBreakNoDecodeDurationL3+=a:n.noBreakNoDecodeDurationRtc+=a,s.blankDuration+=a):(i.decodeTime+=a,s.decodeDuration+=a):n.decodeStartTime&&(e===0?(n.resumeRecv=!1,n.noBreakNoDecodeDuration+=a,l?n.noBreakNoDecodeDurationL3+=a:n.noBreakNoDecodeDurationRtc+=a,s.blankDuration+=a):(i.decodeTime+=a,s.decodeDuration+=a));t&&e&&(n.resumeRecv=!0)},ih=function(o,e,t,n,r,i,s){if(n=n>1e3?1e3:n,e.breakDuration=0,e.breakCancelDuration=0,e.decodeTime=0,t.decodeDuration=0,t.breakDuration=0,t.blankDuration=0,o.decodeStartTime){var c=i,u=c-o.decodeStartTime;if(o.decodeStartTime=void 0,o.totalDuration+=u,s?o.totalDurationL3+=u:o.totalDurationRtc+=u,o.breakStartTime){var l=c-o.breakStartTime;o.breakStartTime=void 0,r?l>n&&(o.cumulativeBreakDuration+=l,s?o.cumulativeBreakDurationL3+=l:o.cumulativeBreakDurationRtc+=l):(o.noBreakNoDecodeDuration+=l,s?o.noBreakNoDecodeDurationL3+=l:o.noBreakNoDecodeDurationRtc+=l)}var a=o.cumulativeBreakDuration,h=o.totalDurationL3,m=o.cumulativeBreakDurationL3,S=o.noBreakNoDecodeDurationL3,x=o.totalDurationRtc,q=o.cumulativeBreakDurationRtc,V=o.noBreakNoDecodeDurationRtc,_e=o.totalDuration-o.cumulativeBreakDuration-o.noBreakNoDecodeDuration;return o.cumulativeDecodeDuration=_e,o.cumulativeDecodeDurationL3=h-m-S,o.cumulativeDecodeDurationRtc=x-q-V,{cumulativeBreakDuration:a,cumulativeDecodeDuration:_e}}return{cumulativeBreakDuration:0,cumulativeDecodeDuration:0}},Xa=function(){return Xa=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},Xa.apply(this,arguments)},hp=function(){function o(e,t,n,r,i,s){this.tf=e,this.if=t,this.Bv=n,this.an=r,this.dataReport=i,this.pn=s,this.playQualityList=[],this.ef=null,this.sf=null,this.uf=null,this.Uv={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,audioPacketsReceived:0,videoPacketsReceived:0,framesDecoded:0,framesReceived:0,framesDropped:0,audioBitrate:0,totalRenderFrames:0,renderTime:0,paintedFrames:0,lastTimestamp:0,videoElem:null,audioJitterBufferDelay:0,audioJitterBufferEmittedCount:0,videoJitterBufferDelay:0,videoJitterBufferEmittedCount:0,jitterBufferDelayMs:0},this.Wh={video:{videoBitrate:0,videoFPS:0,videoRenderFPS:-1,videoTransferFPS:0,frameHeight:0,frameWidth:0,muteState:"1",videoQuality:-1,googCodecName:"",videoPacketsLost:0,videoPacketsLostRate:0,videoFramesDecoded:0,videoFramesDropped:0,videoCumulativeDecodeTime:0,videoCumulativeBreakTime:0,videoCumulativeBreakRate:0},audio:{audioBitrate:0,audioCodec:"",muteState:"1",audioQuality:-1,audioFPS:0,audioJitter:0,audioLevel:0,audioPacketsLost:0,audioPacketsLostRate:0,audioSamplingRate:0,audioSendLevel:0,googCodecName:"",audioCumulativeDecodeTime:0,audioCumulativeBreakTime:0,audioCumulativeBreakRate:0},peerToPeerDelay:0,peerToPeerPacketLostRate:0},this.decodeStartTime=0,this.hf=0,this.probeState=Re.probed,this._l=null,this.Gv=1e4,this.lf=0,this.playStat={},this.Hv=200,this.Vv=500,this.Qv={breakStartTime:void 0,cumulativeBreakDuration:0,cumulativeDecodeDuration:0,decodeStartTime:void 0,decodeEndTime:void 0,totalDuration:0,noBreakNoDecodeDuration:0,resumeRecv:!0,cumulativeBreakDurationL3:0,cumulativeDecodeDurationL3:0,noBreakNoDecodeDurationL3:0,totalDurationL3:0,cumulativeBreakDurationRtc:0,cumulativeDecodeDurationRtc:0,noBreakNoDecodeDurationRtc:0,totalDurationRtc:0},this.Yv={breakStartTime:void 0,cumulativeBreakDuration:0,cumulativeDecodeDuration:0,decodeStartTime:void 0,decodeEndTime:void 0,totalDuration:0,noBreakNoDecodeDuration:0,resumeRecv:!0,cumulativeBreakDurationL3:0,cumulativeDecodeDurationL3:0,noBreakNoDecodeDurationL3:0,totalDurationL3:0,cumulativeBreakDurationRtc:0,cumulativeDecodeDurationRtc:0,noBreakNoDecodeDurationRtc:0,totalDurationRtc:0},this.Kv=0,this.Zv={breakDuration:0,breakCancelDuration:0,decodeTime:0},this.Xv={breakDuration:0,breakCancelDuration:0,decodeTime:0},this.Wv={decodeDuration:0,breakDuration:0,blankDuration:0},this.$v={decodeDuration:0,breakDuration:0,blankDuration:0},this.tm={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0,audioBytesReceived:0},this.im=void 0,this.nm="",this.ff=0,this.rm=0,this.rf=1e3,this.df="udp",this.vf={},this.mf="",this.pf="",this.sm=!1,this.om=!1,this.um=!1,this.bf=0,this._f=0,this.connectIPStack=-1,this.am=0,this.af=0,this.eo=0,this.hm=!0,this.onFindDecodeException=function(c){},this.fm=void 0,this.lm=!1,this.onRecvMediaData=function(){},this.p2pNetStats={p2pLostRate:0,p2pRTT:0},this.Wh.video.muteState=this.Bv.videoMuteState,this.Wh.audio.muteState=this.Bv.audioMuteState,this.wf=new $d(this.pn,this.an,this.va,k.Nr.event)}return Object.defineProperty(o.prototype,"_playStream",{get:function(){return this.Bv.playStream},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"gn",{get:function(){return this.pn.streamCenter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"va",{get:function(){return this.Bv.streamId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sessionId",{get:function(){return this.Bv.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"peerID",{get:function(){return this.Bv.peerID},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"audioMuted",{get:function(){if(!this.Bv.remoteStream||this.Bv.remoteStream.getAudioTracks().length<=0)return!0;var e=this.Bv.remoteStream.getAudioTracks()[0];return!(!e||!e.muted&&e.readyState!=="ended"&&e.enabled)||this.Bv.audioMuteState=="1"||!this.Bv.playMediaStatus.audio},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"videoMuted",{get:function(){if(!this.Bv.remoteStream||this.Bv.remoteStream.getVideoTracks().length<=0)return!0;var e=this.Bv.remoteStream.getVideoTracks()[0];return!(!e||!e.muted&&e.readyState!=="ended"&&e.enabled)||this.Bv.videoMuteState=="1"||!this.Bv.playMediaStatus.video},enumerable:!1,configurable:!0}),o.prototype.getPlayStats=function(e,t){var n,r=this;if(e!=null){var i,s,c=new Date().getTime();c-this.am+50>=3e3&&this.getP2PNetStats();var u=this.Bv.rtcViewer;u&&(i=u.ma,s=u.pa),i&&i.currentTime||(i=Dc(this._playStream,"video")||i),s&&s.currentTime||(s=Dc(this._playStream,"audio")||s||i);var l={sampleTimeWindow:this.if,audioPacketsLost:0,audioPacketsLostRate:0,audioBitrate:0,audioLevel:0,audioSendLevel:0,audioSamplingRate:0,audioCodec:"",audioQuality:0,audioFPS:0,videoQuality:0,videoPacketsLost:0,videoPacketsLostRate:0,videoBitrate:0,videoFPS:0,videoRenderFPS:-1,nackCount:0,pliCount:0,audioJitter:0,videoJitter:0,videoFramesDecoded:0,keyFramesDecoded:0,totalFreezesDuration:0,frameHeight:0,frameWidth:0,videoTransferFPS:0,videoFramesDropped:0,totalRoundTripTime:0,currentRoundTripTime:0,availableOutgoingBitrate:void 0,videoCodecName:void 0,audioCodecName:void 0,audioJitterBufferDelayMs:0,videoJitterBufferDelayMs:0,jitterBufferDelayMs:0,googBandwidthLimitedResolution:void 0,googCpuLimitedResolution:void 0,googAvailableSendBandwidth:void 0,codecImplementationName:void 0,qualityLimitationReason:void 0,audioMuteState:this.audioMuted?"1":"0",videoMuteState:this.videoMuted?"1":"0",soundLevel:this.Bv.soundLevel,muted:s?s.muted:void 0,videoPaused:i?i.paused:void 0,audioPaused:s?s.paused:void 0,videoReadyState:i?i.readyState:void 0,audioReadyState:s?s.readyState:void 0,videoEnded:i?i.ended:void 0,audioEnded:s?s.ended:void 0,volume:s?s.volume:void 0,sinkId:s?s.sinkId:void 0};this.Bv.ip&&(Yi(this.Bv.ip)?l.ipv6=this.Bv.ip:l.ipv4=$r(this.Bv.ip));var a=this.Uv.time,h=0,m=0,S=0,x=0,q=0,V=0,_e=0,ke=null,Pe=null;e.forEach(function(Jt){var Bi=Jt.kind||Jt.mediaType;["ssrc","inbound-rtp"].includes(Jt.type)&&(Bi=="video"||Jt.id.indexOf("VideoStream")>=0)&&(ke=Jt),(Jt.type=="inbound-rtp"||Jt.type=="ssrc"&&Jt.bytesReceived!=null)&&(Bi=="audio"||Jt.id.indexOf("AudioStream")>=0)&&(Pe=Jt)});var Oe=function(Jt,Bi){return Jt>Bi?Jt-Bi:0};this.Kv||(this.Kv=c-1e3);var Ge=this.Bv.playMode===E.ey.L3;if(ke){var Je=ke.totalInterFrameDelay,tt=ke.framesDecoded,ut=ke.totalSquaredInterFrameDelay,vt=Oe(tt,this.tm.framesDecode);this.tm.framesDecode=tt;var gt=Oe(Je,this.tm.totalInterFrameDelay);this.tm.totalInterFrameDelay=Je;var Pt=Oe(ut,this.tm.totalSquaredInterFrameDelay);this.tm.totalSquaredInterFrameDelay=ut;var wt=(Pt-Math.pow(gt,2)/(vt||1))/(vt||1);wt=wt>0?wt:-wt;var At=parseInt((1e3/(vt+1)).toString()),Vt=1e3*Math.sqrt(wt),qt=gt/(vt||1)*1e3||At,Gt=(qt=parseInt((qt>1e3?1e3:qt).toString()))+Vt;Gt=parseInt((Gt>1e3?1e3:Gt).toString()),vt>0&&this.Bv.cameraStatus===0&&!this.Qv.decodeStartTime&&(this.Qv.decodeStartTime=c-1e3),this.Qv.decodeStartTime&&!this.om&&rh(c,vt,this.Bv.cameraStatus===0&&this.Bv.playMediaStatus.video&&!this.sm&&!this.um,this.Qv,this.Vv,this.Zv,this.Wv,qt,Gt,Ge)}if(Pe){var Sn=Pe.totalSamplesReceived,Qt=Pe.concealedSamples,Wt=Pe.bytesReceived,zt=Oe(Sn,this.tm.totalSamplesReceived);this.tm.totalSamplesReceived=Sn;var Mt=Oe(Qt,this.tm.concealedSamples);this.tm.concealedSamples=Qt;var jt=Oe(Wt,this.tm.audioBytesReceived);this.tm.audioBytesReceived=Wt;var Kt=parseInt((1e3*(Mt/(zt||1))).toString());jt>0&&this.Bv.micStatus===0&&!this.Yv.decodeStartTime&&(this.Yv.decodeStartTime=c-1e3),this.Yv.decodeStartTime&&rh(c,jt,this.Bv.micStatus===0&&this.Bv.playMediaStatus.audio&&!this.sm&&!this.um,this.Yv,this.Hv,this.Xv,this.$v,Kt,Kt,Ge)}var $t=[],yt="",Pn=!1;if(e.forEach(function(Jt){Jt.type=="track"&&(Pn=!0)}),e.forEach(function(Jt){var Bi=Jt.kind||Jt.mediaType;if((Jt.type=="inbound-rtp"||Jt.type=="ssrc"&&Jt.bytesReceived!=null)&&(Bi=="audio"||Jt.id.indexOf("AudioStream")>=0)){var Go="";if((as=e.get(Jt.codecId))&&as.mimeType&&(Go=as.mimeType.split("/")[1]),r.pf!==Go&&(r.pf=Go),l.audioCodec=r.pf,a!=0&&(l.audioBitrate=8*(Jt.bytesReceived-r.Uv.audioBytesReceived)/(Jt.timestamp-a),(Ws=Jt.packetsLost-r.Uv.audioPacketsLost)>0&&(m=Ws/(Ws+Jt.packetsReceived-r.Uv.audioPacketsReceived))),l.audioBitrate<0&&(l.audioBitrate=0),Jt.jitterBufferDelay){var Ki=Jt.jitterBufferDelay,Ao=Jt.jitterBufferEmittedCount;V=Math.floor((Ki-r.Uv.audioJitterBufferDelay)/(Ao-r.Uv.audioJitterBufferEmittedCount)*1e3),(V=isNaN(V)||V<0?0:V)>1e4&&r.Bv.info("".concat(ie.bzn," audio jitterDelay ").concat(Ki," ").concat(r.Uv.audioJitterBufferDelay," ").concat(Ao," ").concat(r.Uv.audioJitterBufferEmittedCount)),r.Uv.audioJitterBufferDelay=Ki,r.Uv.audioJitterBufferEmittedCount=Ao,l.audioJitterBufferDelayMs=V}l.audioJitter=Jt.jitter,Jt.packetsLost>0&&(l.audioPacketsLost=Jt.packetsLost);var Do=Jt.packetsLost-r.Uv.audioPacketsLost;l.audioFPS=(Jt.packetsReceived-r.Uv.audioPacketsReceived)/(Jt.timestamp-a)*1e3,l.audioPacketsLostRate=Do>0?Do/(Jt.packetsReceived-r.Uv.audioPacketsReceived+Do):0,r.Uv.audioBytesReceived=Jt.bytesReceived,Jt.packetsLost>0&&(r.Uv.audioPacketsLost=Jt.packetsLost),r.Uv.audioPacketsReceived=Jt.packetsReceived,r.Uv.audioTime=Jt.timestamp,r.Uv.time=Jt.timestamp,r.Uv.audioBitrate=l.audioBitrate,x=Jt.jitter,Pn||r.aTrackStats(l,Jt)}else if((Jt.type=="inbound-rtp"||Jt.type=="ssrc"&&Jt.bytesReceived!=null)&&(Bi=="video"||Jt.id.indexOf("VideoStream")>=0)){var Ws;a!=0?(l.videoBitrate=8*(Jt.bytesReceived-r.Uv.videoBytesReceived)/(Jt.timestamp-a),l.videoFPS=1e3*(Jt.framesDecoded-r.Uv.framesDecoded)/(Jt.timestamp-a),(Ws=Jt.packetsLost-r.Uv.videoPacketsLost)>0&&(S=Ws/(Ws+Jt.packetsReceived-r.Uv.videoPacketsReceived))):(0,R.Cs)(Jt.framesPerSecond)&&(l.videoFPS=Jt.framesPerSecond),l.videoBitrate<0&&(l.videoBitrate=0),l.videoFPS<0&&(l.videoFPS=0);var as,_a="";if((as=e.get(Jt.codecId))&&as.mimeType&&(_a=as.mimeType.split("/")[1]),r.mf!==_a){var Sa=r.gn.seiWorker;Sa&&Sa.postMessage({cmd:"updatePlayer",codec:_a,streamID:r.va}),r.mf=_a}l.videoCodecName=r.mf,Jt.jitterBufferDelay&&(Ki=Jt.jitterBufferDelay,Ao=Jt.jitterBufferEmittedCount,_e=Math.floor((Ki-r.Uv.videoJitterBufferDelay)/(Ao-r.Uv.videoJitterBufferEmittedCount)*1e3),(_e=isNaN(_e)||_e<0?0:_e)>1e4&&r.Bv.info("".concat(ie.bzn," video jitterDelay ").concat(Ki," ").concat(r.Uv.videoJitterBufferDelay," ").concat(Ao," ").concat(r.Uv.videoJitterBufferEmittedCount)),r.Uv.videoJitterBufferDelay=Ki,r.Uv.videoJitterBufferEmittedCount=Ao,l.videoJitterBufferDelayMs=_e),l.videoRenderFPS=r.getVideoRenderFps(i),l.codecImplementationName=Jt.decoderImplementation,l.videoJitter=Jt.jitter,l.nackCount=Jt.nackCount,l.pliCount=Jt.pliCount,l.videoFramesDecoded=Jt.framesDecoded,l.keyFramesDecoded=Jt.keyFramesDecoded,l.totalFreezesDuration=Jt.totalFreezesDuration,Jt.packetsLost>0&&(l.videoPacketsLost=Jt.packetsLost),l.videoPacketsLostRate=(Do=Jt.packetsLost-r.Uv.videoPacketsLost)>0?Do/(Jt.packetsReceived-r.Uv.videoPacketsReceived+Do):0,r.Uv.videoBytesReceived=Jt.bytesReceived,r.Uv.framesDecoded=Jt.framesDecoded,Jt.packetsLost>0&&(r.Uv.videoPacketsLost=Jt.packetsLost),r.Uv.videoPacketsReceived=Jt.packetsReceived,r.Uv.videoTime=Jt.timestamp,r.Uv.time=Jt.timestamp,q=Jt.jitter,Pn||r.vTrackStats(l,Jt,a)}else if(Jt.type=="track"&&(Bi=="video"||Jt.id.indexOf("video")>=0)||Jt.frameWidth)r.vTrackStats(l,Jt,a);else if(Jt.type=="track"&&(Bi=="audio"||Jt.id.indexOf("audio")>=0))r.aTrackStats(l,Jt);else if(Jt.type!="candidate-pair"||!Jt.nominated||(0,Vn.gm)()&&!Jt.selected)Jt.type==="local-candidate"&&$t.push(Jt);else{Jt.totalRoundTripTime!=null&&(l.totalRoundTripTime=Jt.totalRoundTripTime),Jt.currentRoundTripTime!=null&&(l.currentRoundTripTime=Jt.currentRoundTripTime,h=1e3*l.currentRoundTripTime),Jt.availableOutgoingBitrate!==void 0&&(l.availableOutgoingBitrate=Jt.availableOutgoingBitrate),Jt.state==="succeeded"&&(yt=Jt.localCandidateId);var tl=r.gn.lastChangeIpTime;if(tl&&r._f<tl&&Date.now()-tl<=15e3){var Ah=Jt.bytesReceived,Dh=r.Uv.condidateBytesReceived;Dh&&(Ah>Dh?r.bf=0:r.bf++),r.bf>=5&&(r.bf=0,r._f=tl,r.onPlayingError(Et.lgu)),r.Uv.condidateBytesReceived=Ah}else r.bf>0&&(r.bf=0)}}),yt){var pn=$t.find(function(Jt){return Jt.id==yt});if(pn){var un=void 0;if(pn.relayProtocol!==void 0)un=pn.relayProtocol;else if(pn.protocol)un=pn.protocol;else if(pn.priority){var ln=pn.priority>>24;ln!==void 0&&(un=pd(ln,this.pn.browser))}un!==void 0&&this.df!==un&&(this.Bv.info(ie.R46+" protocol "+un),this.df=un);var Mn=!1,Hn=pn.candidateType,xi=pn.networkType,vi=pn.relayProtocol,yr=pn.relatedAddress,Ur=pn.url,Gr=pn.ip;if(Gr){var Nr=Ar(Gr);Nr>=0&&Nr!==this.connectIPStack&&(this.an.info(ie.kEs+" "+this.va+" ipStack "+Y[Nr]),this.connectIPStack=Nr)}Mn=this.Tf([{key:"candidateType",value:Hn},{key:"networkType",value:xi}]),Hn==="relay"&&(Mn=this.Tf([{key:"relayProtocol",value:vi},{key:"relatedAddress",value:yr},{key:"url",value:Ur}])),Mn&&this.Bv.info(ie.kEs+" upload candidate change "+JSON.stringify(this.vf))}}var ni=0;ni=V>0&&_e>0?Math.max(V,_e):V>0?V:_e>0?_e:0,l.jitterBufferDelayMs=this.Uv.jitterBufferDelayMs=ni,S=isNaN(S)||S<0?0:S,q=isNaN(q)||q<0?0:q,m=isNaN(m)||m<0?0:m,x=isNaN(x)||x<0?0:x;var co=ze(h,S,q),Ho=ze(h,m,x);l.audioQuality=a>0?ft(Ho):0,l.videoQuality=a>0?ft(co):0,this.pn.networkState!==E.D2.offline&&((n=this.Bv.peerConnection)===null||n===void 0?void 0:n.connectionState)!=="disconnected"||(l.videoQuality=E.b3.Die,l.audioQuality=E.b3.Die);var gi=Math.min(co,Ho);if(this.hf=gi,l.peerToPeerDelay=isNaN(this.p2pNetStats.p2pRTT)?0:parseInt((this.p2pNetStats.p2pRTT/2+this.Uv.jitterBufferDelayMs).toString()),l.peerToPeerPacketLostRate=this.p2pNetStats.p2pLostRate,this.playStat=l,this.updateCurrentQualityStats(l),!this.lm&&(l.videoBitrate>0||l.audioBitrate>0)&&(this.lm=!0,this.onRecvMediaData&&this.onRecvMediaData()),this.hm){var Hi=l.videoFramesDropped,Pi=l.videoTransferFPS;l.videoBitrate>0&&l.videoFPS===0&&Hi>0&&Pi>0&&Math.abs(Hi-Pi)<=3?this.fm?performance.now()-this.fm>3e3&&(this.fm=void 0,this.hm=!1,this.onFindDecodeException&&this.onFindDecodeException(!0)):this.fm=performance.now():l.videoFPS>0&&(this.fm=void 0,this.hm=!1)}this.rf==this.tf?this.notifyPlayQuality():this.sf||c-this.af+50>=this.tf&&this.notifyPlayQuality(),this.rf==this.if?this.reportPlayQuality():this.uf||c-this.eo+50>=this.if&&this.reportPlayQuality(),this.Bv.onStatsUpdated(this.playStat)}},o.prototype.notifyPlayQuality=function(){this.af=Date.now(),this.Bv.onPlayQualityUpdate(this.va,this.Wh)},o.prototype.reportPlayQuality=function(){var e=Date.now();this.eo=e,this.checkProbe(e),this.uploadPlayQuality(this.playStat,e),this.wf.checkRemoteStats(this.playStat,this._playStream),this.gn.changeRxQuality(ft(this.hf))},o.prototype.getVideoRenderFps=function(e){var t=-1;if(!e||!(e&&(e.getVideoPlaybackQuality||e.requestVideoFrameCallback||e.mozPaintedFrames!==void 0)))return-1;var n=this.Uv.videoElem,r=e.currentTime,i=e.getVideoPlaybackQuality();e.requestVideoFrameCallback&&!i.totalVideoFrames?n&&n==e||(this.Uv.videoElem=e,this.Uv.lastTimestamp=r,!n&&e.requestVideoFrameCallback(this.videoFramesRender.bind(this))):this.Uv.videoElem=null,n=this.Uv.videoElem;var s,c=Date.now(),u=this.Uv,l=u.renderTime;return s=this.pn.browser!="firefox"||i.totalVideoFrames||n||e.mozPaintedFrames===void 0?n?u.paintedFrames:i.totalVideoFrames-i.droppedVideoFrames:e.mozPaintedFrames,t=l!=0?1e3*(s-u.totalRenderFrames)/(c-l):s/i.creationTime,this.Uv.renderTime=c,this.Uv.totalRenderFrames=s,t},o.prototype.videoFramesRender=function(e,t){var n=this.Uv,r=n.videoElem;if(r&&r.requestVideoFrameCallback){var i=r.currentTime;n.lastTimestamp!=i&&(this.Uv.paintedFrames++,this.Uv.lastTimestamp=i),r.requestVideoFrameCallback(this.videoFramesRender.bind(this))}},o.prototype.vTrackStats=function(e,t,n){var r=t.frameWidth,i=t.framesReceived,s=t.framesDropped,c=t.timestamp;if(e.frameHeight=t.frameHeight,e.frameWidth=r,!e.frameHeight||!e.frameWidth){var u=this.Uv.videoElem||Dc(this.Bv.playStream);u&&(e.frameHeight=u.videoHeight||0,e.frameWidth=u.videoWidth||0)}this.Bv.cameraStatus!==0&&e.videoBitrate===0&&e.videoFPS===0&&(e.frameHeight=0,e.frameWidth=0);var l=e.frameWidth,a=e.frameHeight;if(n===0||this.Uv.frameHeight===a&&this.Uv.frameWidth===l)n===0&&(this.Uv.frameHeight=a,this.Uv.frameWidth=l,this.Bv.isProbe||(this.cr.spanAppendAttribute({key:this.Bv.playingEvent,par:this.va},"vinfo",{h:a,fft:Date.now(),w:l}),this.cr.spanAppendAttribute({key:k.oW.event,par:this.va},"vinfo",{h:a,fft:Date.now(),w:l})));else{if(!this.Bv.isProbe){var h=this.cr.createSpan(E.t0.H,{key:k.Nr.event,par:this.va},{key:""},k.Wg.event);h.setAttributes({webrtc_sid:k.Wg.webrtc_sid(this.sessionId),w:k.Wg.w(l),h:k.Wg.h(a)}),h.end(),this.cr.spanAppendAttribute({key:this.Bv.playingEvent,par:this.va},"vinfo",{h:a,fft:Date.now(),w:l}),this.cr.spanAppendAttribute({key:k.oW.event,par:this.va},"vinfo",{h:a,fft:Date.now(),w:l})}this.Uv.frameHeight=a,this.Uv.frameWidth=l}n!=0&&(isNaN(i)||isNaN(s)||(e.videoTransferFPS=1e3*(i-this.Uv.framesReceived)/(c-n),e.videoFramesDropped=s-this.Uv.framesDropped)),e.videoTransferFPS<0&&(e.videoTransferFPS=0),e.videoFramesDropped<0&&(e.videoFramesDropped=0),i&&(this.Uv.framesReceived=i),s&&(this.Uv.framesDropped=s)},o.prototype.aTrackStats=function(e,t){e.audioLevel=t.audioLevel||0,e.audioSendLevel=t.totalAudioEnergy,e.audioSamplingRate=t.totalSamplesDuration},o.prototype.updateCurrentQualityStats=function(e){var t=e.videoBitrate,n=e.videoFPS,r=e.videoTransferFPS,i=e.frameHeight,s=e.frameWidth,c=e.videoMuteState,u=e.videoQuality,l=e.videoFramesDecoded,a=e.videoFramesDropped,h=e.videoPacketsLost,m=e.videoPacketsLostRate,S=e.audioBitrate,x=e.audioCodec,q=e.audioMuteState,V=e.audioQuality,_e=e.audioFPS,ke=e.audioJitter,Pe=e.audioLevel,Oe=e.audioPacketsLost,Ge=e.audioPacketsLostRate,Je=e.audioSamplingRate,tt=e.audioSendLevel,ut=e.nackCount,vt=e.pliCount,gt=e.totalRoundTripTime,Pt=e.currentRoundTripTime,wt=e.peerToPeerDelay,At=e.peerToPeerPacketLostRate,Vt=e.sampleTimeWindow,qt=e.videoRenderFPS,Gt={video:Xa(Xa({},this.Wh.video),{videoBitrate:t,videoFPS:n,videoTransferFPS:r,frameHeight:i,frameWidth:s,videoQuality:u,videoFramesDecoded:l,videoFramesDropped:a,videoPacketsLost:h,videoPacketsLostRate:m,muteState:c,videoCumulativeDecodeTime:this.Wv.decodeDuration,videoCumulativeBreakTime:this.Wv.breakDuration,videoCumulativeBreakRate:this.Wv.breakDuration/(this.Wv.decodeDuration+this.Wv.breakDuration||1),videoRenderFPS:qt}),audio:Xa(Xa({},this.Wh.audio),{audioBitrate:S,audioCodec:x,audioQuality:V,audioFPS:_e,audioJitter:ke,audioLevel:Pe,audioPacketsLost:Oe,audioPacketsLostRate:Ge,audioSamplingRate:Je,audioSendLevel:tt,muteState:q,audioCumulativeDecodeTime:this.$v.decodeDuration,audioCumulativeBreakTime:this.$v.breakDuration,audioCumulativeBreakRate:this.$v.breakDuration/(this.$v.decodeDuration+this.$v.breakDuration||1)}),nackCount:ut,pliCount:vt,totalRoundTripTime:gt,currentRoundTripTime:Pt,peerToPeerDelay:wt,peerToPeerPacketLostRate:(At||0)/255,sampleTimeWindow:Vt};e.codecImplementationName!==void 0&&(Gt.codecImplementationName=e.codecImplementationName),e.videoCodecName!==void 0&&(Gt.video.googCodecName=e.videoCodecName),e.audioCodec!==""&&(Gt.audio.googCodecName=e.audioCodec),this.Wh=Gt},o.prototype.simplifyPlayDataKey=function(e){var t={};t.aPktLost=e.audioPacketsLost,t.aPlr=e.audioPacketsLostRate,t.aBitrate=Math.trunc(e.audioBitrate),t.aLevel=Math.trunc(1e5*e.audioLevel)/1e5,t.aTotalEnergy=Math.trunc(1e5*e.audioSendLevel)/1e5,t.aSampleRate=Math.trunc(e.audioSamplingRate),t.aQuality=e.audioQuality,t.aFPS=Math.trunc(e.audioFPS),t.vQuality=e.videoQuality,t.vPktLost=e.videoPacketsLost,t.vPlr=e.videoPacketsLostRate,t.vBitrate=Math.trunc(e.videoBitrate),t.vFPS=Math.trunc(e.videoFPS),t.nackCnt=e.nackCount,t.vPliCnt=e.pliCount,t.vFramesDec=e.videoFramesDecoded,t.vHeight=e.frameHeight,t.vWidth=e.frameWidth,t.vRcvFPS=Math.trunc(e.videoTransferFPS),t.vFrameDrop=e.videoFramesDropped,t.keyFrameDec=e.keyFramesDecoded,t.vTotalFreezeDur=e.totalFreezesDuration,t.rtt=e.currentRoundTripTime,t.vCodec=e.videoCodecName,t.aMuteStat=e.audioMuteState,t.vMuteStat=e.videoMuteState,t.soundLV=e.soundLevel,t.muted=e.muted,t.aPaused=e.audioPaused,t.vPaused=e.videoPaused,t.vRdyState=e.videoReadyState,t.aRdyState=e.audioReadyState,t.volume=e.volume,t.sinkId=e.sinkId,t.p2pDelay=e.peerToPeerDelay,t.p2pPlr=e.peerToPeerPacketLostRate,t.vBrkDur=e.video_break_duration,t.vBrkCancelDur=e.video_break_cancel_duration,t.vDecTime=e.video_decode_time,t.aBrkDur=e.audio_break_duration,t.aBrkCancelDur=e.audio_break_cancel_duration,t.aDecTime=e.audio_decode_time,t.aJtrBufDlyMs=e.audioJitterBufferDelayMs,t.vJtrBufDlyMs=e.videoJitterBufferDelayMs,t.aEnd=e.audioEnded,t.vEnd=e.videoEnded,t.vRenderFps=e.videoRenderFPS;var n=this._playStream?Ot(this._playStream):void 0;return n!==void 0&&this.nm!==n&&(this.nm=n,t.stmTracks=n),t},o.prototype.uploadPlayQuality=function(e,t){var n=t;if(this.lf==0||n-this.lf>=2e3){e.stream_type="play",e.stream_id=this.va,e.timeStamp=n,e.video_break_duration=this.Zv.breakDuration,e.video_break_cancel_duration=this.Zv.breakCancelDuration,e.video_decode_time=this.Zv.decodeTime,this.Zv.breakCancelDuration=0,this.Zv.breakDuration=0,this.Zv.decodeTime=0,e.audio_break_duration=this.Xv.breakDuration,e.audio_break_cancel_duration=this.Xv.breakCancelDuration,e.audio_decode_time=this.Xv.decodeTime,this.Xv.breakCancelDuration=0,this.Xv.breakDuration=0,this.Xv.decodeTime=0,e.real_sampling_interval=n-this.Kv;var r=this.simplifyPlayDataKey(e);this.im!==void 0&&(r.gw_aTxKbps=this.im.audioTXBitrate,r.gw_vTxkbps=this.im.videoTXBitrate,r.gw_vRedRate=this.im.videoRedRate,r.gw_TCStat=this.im.trafficControlStat,r.gw_TCBW=this.im.trafficControlStat),this.Kv=n,this.Bv.info(ie.kEs+" upload"+JSON.stringify(r)),this.gn.updateQuality(nt.play_quality,e),this.lf=n}},o.prototype.getP2PNetStats=function(){var e=this;this.am=Date.now(),this.Bv.getP2PNetStats(function(t,n){var r=n.p2p_rtt;e.p2pNetStats.p2pLostRate=n.p2p_lost_rate||0,e.p2pNetStats.p2pRTT=r||0},function(t){})},o.prototype.setPlayQualityTimer=function(){var e=this;this.ef==null&&(this.Bv.info(ie.R46+" called ".concat(this.rf," ").concat(this.tf," ").concat(this.if)),(this.ef||this.sf||this.uf)&&this.clearPlayQualityTimer(),this.getP2PNetStats(),this.ef=setInterval(function(){e.rm++;var t=e.Bv.peerConnection;if(t){var n=[t.getStats(null)];Promise.all(n).then(function(r){e.ef&&e.getPlayStats(r[0],r[1])}).catch(function(r){e.Bv.error(ie.R46+" getStats error "+r.toString())})}},this.rf),this.af=this.eo=Date.now(),this.rf!==1e3&&(this.rf!=this.tf&&(this.sf=setInterval(function(){e.notifyPlayQuality()},this.tf)),this.rf!=this.if&&(this.uf=setInterval(function(){e.reportPlayQuality()},this.if))),this.Uv={audioPacketsLost:0,videoPacketsLost:0,time:Date.now(),audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,videoPacketsReceived:0,audioPacketsReceived:0,framesDecoded:0,framesReceived:0,framesDropped:0,audioBitrate:0,totalRenderFrames:0,renderTime:0,paintedFrames:this.Uv.paintedFrames,lastTimestamp:0,videoElem:this.Uv.videoElem,audioJitterBufferDelay:0,audioJitterBufferEmittedCount:0,videoJitterBufferDelay:0,videoJitterBufferEmittedCount:0,jitterBufferDelayMs:0})},o.prototype.clearPlayQualityTimer=function(){if(this.Bv.info("zc.p.spqt.1.1 called ".concat(!!this.ef," ").concat(!!this.sf," ").concat(!!this.uf)),this.sf!=null&&(clearInterval(this.sf),this.sf=null),this.uf!=null&&(clearInterval(this.uf),this.uf=null),this.ef!=null){clearInterval(this.ef),this.ef=null;var e=new Date().getTime();this.Kv=0,this.rm=0,this.tm={totalSquaredInterFrameDelay:0,totalInterFrameDelay:0,framesDecode:0,totalSamplesReceived:0,concealedSamples:0,audioBytesReceived:0};var t=this.Bv.playMode===E.ey.L3;ih(this.Qv,this.Zv,this.Wv,this.Vv,!this.um&&this.Bv.cameraStatus===0&&this.Bv.playMediaStatus.video,e,t),ih(this.Yv,this.Xv,this.$v,this.Hv,!this.um&&this.Bv.micStatus===0&&this.Bv.playMediaStatus.audio,e,t)}this.ff=0,this.Uv={audioPacketsLost:0,videoPacketsLost:0,time:0,audioTime:0,videoTime:0,audioBytesReceived:0,videoBytesReceived:0,videoPacketsReceived:0,audioPacketsReceived:0,framesDecoded:0,framesDropped:0,framesReceived:0,audioBitrate:0,totalRenderFrames:0,renderTime:0,paintedFrames:0,lastTimestamp:0,videoElem:null,audioJitterBufferDelay:0,audioJitterBufferEmittedCount:0,videoJitterBufferDelay:0,videoJitterBufferEmittedCount:0,jitterBufferDelayMs:0},this.om=!1,this.um=!1},o.prototype.checkProbe=function(e){var t=this.hf,n=this.Uv.time;this.Bv.debug(ie.R46+" netQuality "+t+" "+n),t<=this.gn.targetQuality?this.ff++:this.ff=0,n>0&&this.ff>=this.gn.probeStartedNum&&e>this.Bv.probeTime+this.gn.probeInterval&&(this.an.info(ie.R46+" netQuality "+t+" start net probe"),this.probeState=Re.tryProbe,this.Bv.poorQualityRetryCnt++,this.gn.startNetProbe(!1,this.Bv))},o.prototype.startProbeTimeout=function(){var e=this;this._l=setTimeout(function(){e.Bv.error(ie.QU$+" probe timeout"),e.Bv.playStateUpdateError(k.Nr.error.Ae)},this.Gv)},o.prototype.stopProbeTimeout=function(){this._l&&(clearTimeout(this._l),this._l=null)},o.prototype.setStreamUpdate=function(e){e===0?this.sm=!0:e===1&&(this.sm=!1)},o.prototype.setPlayStreamEnd=function(e){this.um=e},o.prototype.setHasBFrames=function(e){this.om=e},o.prototype.updateGwPlayNetState=function(e){this.im=e},o.prototype.resetCallbackState=function(){this.lm=!1,this.hm=!0,this.hf=0},o.prototype.Tf=function(e){for(var t=!1,n=0;n<e.length;n++){var r=e[n],i=r.key,s=r.value;this.vf[i]!==s&&(this.vf[i]=s,t=!0)}return t},o.prototype.onPlayingError=function(e){},o}(),pp=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),fp=k.Nr.event,oh=k.v2,sh=k.oW,ah=k.Nr.error,ju=k.Og.error,ys=k.Jv,mp=k.er;(function(o){o[o.disconnected=0]="disconnected",o[o.connecting=1]="connecting",o[o.connected=2]="connected"})(to||(to={}));var ch=function(o){function e(t,n,r,i,s){var c=o.call(this)||this;return c.streamID=t,c.an=n,c.pn=r,c.gn=i,c.isPublish=s,c.streamRetryStartTime=0,c.ya=ei(c.an,c.streamID),c}return pp(e,o),Object.defineProperty(e.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),e.prototype.startMaxTime=function(){var t=this;this.ya.info("zc.tsh.smt call"),this.maxTimer?this.ya.warn("zc.tsh.smt max timer"):(this.streamRetryStartTime===0&&(this.streamRetryStartTime=new Date().getTime()),this.maxTimer=setTimeout(function(){if(t.ya.warn("zc.tsh.smt over max time ".concat(t.RETRY_MAX_TIME,"s, stop retry")),t.isOverTime=!0,t.invalid(),t.isPublish){if(!t.gn.publisherList[t.streamID])return void t.ya.info("zc.tsh.smt publish no found");t.publishStateHandle(E.eZ.error,t.streamID,ju.Un,!0)}else{var n=t.gn.playerList[t.streamID];if(!n)return void t.ya.info("zc.tsh.smt play no found");var r=ah.Oe;t.pn.isFlutter&&n.isStreamNotFound&&(r=n.hasSucceed?Et.LBO:Et.T_8),t.playStateHandle(E.h7.error,t.streamID,r,!0)}},1e3*this.RETRY_MAX_TIME),this.ya.info("zc.tsh.smt maxTimer=".concat(this.maxTimer)))},e.prototype.active=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},e.prototype.stopMaxTime=function(){this.ya.info("zc.tsh.stmt streamID maxTimer="+this.maxTimer),this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},e.prototype.onactive=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},e.prototype.retryNextSignal=function(){return this.pn.networkState==E.D2.offline?(this.ya.info("zc.tsh.rns offline"),to.disconnected):this.isPublish?(this.ya.info("zc.tsh.rns  publish ws state "+((t=this.gn.publisherList[this.streamID].publisher.signal)==null?void 0:t.state)+" "+t.mediaState),(t==null?void 0:t.state)==E.xb.connected&&(t==null?void 0:t.mediaState)===Ee.LOGIN?to.connected:(t==null?void 0:t.state)===E.xb.disconnected&&(t==null?void 0:t.mediaState)===Ee.LOGOUT?to.disconnected:to.connecting):(this.ya.info("zc.tsh.rns  play ws state "+((t=this.gn.playerList[this.streamID].signal)==null?void 0:t.state)+" "+(t==null?void 0:t.mediaState)),(t==null?void 0:t.state)==E.xb.connected&&(t==null?void 0:t.mediaState)===Ee.LOGIN?to.connected:(t==null?void 0:t.state)===E.xb.disconnected&&(t==null?void 0:t.mediaState)===Ee.LOGOUT?to.disconnected:to.connecting);var t},e.prototype.publishStateHandle=function(t,n,r,i,s,c){var u,l,a=this,h=i||this.RETRY_MAX_TIME<3;this.ya.info(ie.FSV+" call "+(r?r.code+"":"")+" "+i+" "+JSON.stringify(s)+" "+c+" "+h);var m=this.gn.publisherList[n],S=m.publisher;if(h)return this.stopMaxTime(),this.invalid(),t===1&&S.resetPublish(1),r!=null&&r.code&&this.cr.spanSetAttributes({key:S.parentSpanKey,par:n},r),void this.gn.onPublishStateUpdate(t,n,r);if(r&&r.code!==0){this.maxTimer||h||this.startMaxTime(),this.pn.publishStreamList[n].state=E.T_.retryPublish;var x=S.localStream,q=S.publishOption;S.resetPublish(1);var V=this.retryNextSignal();if(this.ya.info(ie.FSV+" server connect state "+to[V]),V===to.connected){this.ya.info(ie.FSV+" retry current signal "),this.rtcPublishSpan(n,r,S),((u=m.publisher.signal)===null||u===void 0?void 0:u.state)===E.xb.connected&&(this.ya.info(ie.FSV+" current node "+S.gwNode+" failed "+JSON.stringify(S.retryFailGwNodes)+" "+JSON.stringify(S.retryFailIpV4Nodes)+" "+JSON.stringify(S.retryFailIpV4Nodes)),this.setRetryFailNodes(S),S.getRetryIPNodeMode(),this.retryNewGwNode(S,r,s,c),S.gwNode?S.getRetryIPv6Prefer():S.getDispatchIPNodeMode()),this.startRetryTimer&&clearTimeout(this.startRetryTimer),this.startRetryTimer=null;var _e=[ju.xn.code,ju.Xn.code,Et.akb.code].includes(r.code)?0:1e3;return this.ya.info(ie.FSV+" delay "+_e),this.startRetryTimer=setTimeout(function(){a.ya.info(ie.FSV+" retry publish "+S.state),S.state==7&&S.startPublish(n,x,q)},_e),r&&r.code!==0&&this.gn.onPublishStateUpdate(2,n,r),void this.publishStartSpan(n,r,m,s)}if(V===to.disconnected){var ke=(l=m.room)===null||l===void 0?void 0:l.roomID;this.retryServer(!0,ke,m==null?void 0:m.room.token),S&&(S.isExternal=!1),this.rtcPublishSpan(n,r,S),this.gn.onPublishStateUpdate(2,n,r),this.publishStartSpan(n,r,m,s)}else this.ya.info(ie.FSV+" server connecting")}this.ya.info(ie.FSV+" end")},e.prototype.needReDispatchError=function(t){return[ju.ue.code,ah.ze.code].includes(t.code)},e.prototype.isSwitchIPStackError=function(t){return[Et.akb.code,Et.drM].includes(t.code)},e.prototype.playStateHandle=function(t,n,r,i,s,c){var u,l,a,h,m,S,x=this,q=i||this.RETRY_MAX_TIME<3;this.ya.info(ie.M9m+" call "+(r?r.code+"":"")+" "+i+" "+JSON.stringify(s)+" "+c+" "+q);var V=this.gn.playerList[n];if(q)return this.stopMaxTime(),this.invalid(),r!=null&&r.code&&((u=V.$h)===null||u===void 0||u.setAttributes({error:r==null?void 0:r.code})),void this.gn.onPlayStateUpdate(t,n,r);if(r&&r.code!==0){!this.maxTimer&&this.startMaxTime(),V.resetPlay(!0,1);var _e=this.endRtcPlaySpan(n,r,V),ke=this.retryNextSignal();if(this.ya.info(ie.M9m+" server connect state "+to[ke]),ke===to.connected){this.ya.info(ie.M9m+" retry current signal "),V.isCenterNode&&((l=V.signal)===null||l===void 0?void 0:l.state)===E.xb.connected&&(this.ya.info(ie.M9m+" current node "+V.gwNode+" "+JSON.stringify(V.retryFailGwNodes)+" "+JSON.stringify(V.retryFailIpV4Nodes)+" "+JSON.stringify(V.retryFailIpV6Nodes)),this.setRetryFailNodes(V.zegoPeer),(a=V.zegoPeer)===null||a===void 0||a.getRetryIPNodeMode(),this.retryNewGwNode(V,r,s,c),V.gwNode?(h=V.zegoPeer)===null||h===void 0||h.getRetryIPv6Prefer():(m=V.zegoPeer)===null||m===void 0||m.getDispatchIPNodeMode()),this.startRetryTimer&&clearTimeout(this.startRetryTimer),this.startRetryTimer=null;var Pe=k.Nr.error,Oe=[Pe.Se.code,Pe.Xn.code,Et.drM.code].includes(r.code)?0:1e3;return this.ya.info(ie.M9m+" delay "+Oe),this.startRetryTimer=setTimeout(function(){x.ya.info(ie.M9m+" retry state "+V.state),V.state===7&&V.startPlay(n,V.getRemoteStreamSuc)},Oe),r&&r.code!==0&&this.gn.onPlayStateUpdate(2,n,r),_e||V.dm||(V.dm=(0,te.fU)(this.cr,E.t0.I,n,V.playingEvent,k.Nr.event),this.endRtcPlaySpan(n,r,V)),void this.playStartSpan(n,V,void 0,r,s)}if(ke===to.disconnected){var Ge=(S=V.room)===null||S===void 0?void 0:S.roomID;this.retryServer(V.playMode===E.ey.RTC,Ge,V==null?void 0:V.room.token),V&&(V.isExternal=!1),this.gn.onPlayStateUpdate(2,n,r),_e||V.dm||(V.dm=(0,te.fU)(this.cr,E.t0.I,n,V.playingEvent,k.Nr.event),this.endRtcPlaySpan(n,r,V)),this.endRtcPlaySpan(n,r,V),this.playStartSpan(n,V,void 0,r,s)}else this.ya.info(ie.M9m+" server connecting")}this.ya.info(ie.M9m+" end")},e.prototype.retryServer=function(t,n,r){var i=t?bs:_s;this.gn.signalList[i]?this.gn.openConnectServerTask(i):this.gn.connectWebRTCCenterServer(!1,t,n,r)},e.prototype.setRetryFailNodes=function(t){if(t)if(t.ipNodeType===A.ZV4Only){var n=t.retryFailGwNodes.findIndex(function(m){return m===t.gwNode});n>=0&&t.retryFailGwNodes.splice(n,1),t.retryFailGwNodes.push(t.gwNode)}else{var r=t.ipV4NodeList,i=t.ipV6NodeList,s=t.retryFailIpV4Nodes,c=t.retryFailIpV6Nodes,u=t.gwNode,l=Ui(r,u),a=Ui(i,u);if(l>-1)(h=Ui(s,u))>=0&&s.splice(h,1),s.push(r[l]);else if(a>-1){var h;(h=Ui(c,u))>=0&&c.splice(h,1),c.push(i[a])}}},e.prototype.retryNewGwNode=function(t,n,r,i){var s,c,u,l,a,h,m=ie.XO3;if(n&&n.code&&this.needReDispatchError(n))this.retryNextGwNode(t,!0,i);else if(n&&n.code&&this.isSwitchIPStackError(n))this.retryNextGwNode(t,!1,i);else if(n&&n.code&&[Et.H6b.code].includes(n.code))m+=" try curr node ; ";else if(r!=null&&r.action)switch(r==null?void 0:r.action){case 1:case 5:break;case 2:default:this.retryNextGwNode(t,!1,i);break;case 3:this.ya.info(ie.XO3+" redirect");var S=r==null?void 0:r.ins;if(S&&S.length>0){var x=(((s=S[0])===null||s===void 0?void 0:s.IP)||((c=S[0])===null||c===void 0?void 0:c.ip))+":"+(((u=S[0])===null||u===void 0?void 0:u.Port)||((l=S[0])===null||l===void 0?void 0:l.port)),q=((a=S[0])===null||a===void 0?void 0:a.ipv6)+":"+((h=S[0])===null||h===void 0?void 0:h.port);t.gwNode=x&&q?[A.ZV4Only,A.ZV4Priority].includes(t.ipNodeType)?x:q:x||q}break;case 4:t.resetGwNodes(),this.gn.clearCachedGwNodesList(t,this.isPublish)}else this.retryNextGwNode(t,!1,i);this.ya.info(m+=" new node "+t.gwNode)},e.prototype.retryNextGwNode=function(t,n,r){if(this.ya.info(ie.SPm+" call "+t.gwNode),t.gwNode||!t.isNodesEmpty){var i=new Date().getTime(),s=t.gwNodesTTL<i,c=t.iceStateDisConnect&&this.pn.isMultiOuter,u=this.gn.isNodeLast(this.isPublish?t:t.zegoPeer),l=u.lastTryNext,a=u.currentIdx,h=t.hasSucceed;this.ya.info(ie.SPm+" ttl: "+s+" ice: "+c+" last: "+l+" hasSucc: "+h),n||h&&s||t.isLastConnected&&c||l?(t.gwNode=this.gn.getGwNode(t,t.ipNodeType,a),this.dispatchGwNodesBypass(t)):t.gwNode=this.gn.getGwNode(t,t.ipNodeType,r?-1:a)}else this.ya.info(ie.SPm+" call gwNodeList is empty")},e.prototype.dispatchGwNodesBypass=function(t,n,r){var i=this;n===void 0&&(n=function(){}),r===void 0&&(r=function(){});var s=this.gn.getStreamIPNodesMode().ipV6Prefer;t.dispatchGwNodes(s,function(c){i.ya.info(ie.oLS+" suc "+JSON.stringify(c)),t.setGwNodes(c,!0,s),n()},function(c){i.ya.info(ie.oLS+" fail "+JSON.stringify(c)),r()})},e.prototype.rtcPublishSpan=function(t,n,r){var i;r==null||r.uploadRTCPublishStats();var s=r!=null&&r.isLastConnected?0:this.getTryTime(r);this.cr.spanEnd({key:k.Jv.event,par:t},{tryidx:ys.tryidx(r==null?void 0:r.rtcPublishCount),url:ys.url((i=r==null?void 0:r.signal)===null||i===void 0?void 0:i.server),ip:ys.ip(r==null?void 0:r.ip),dispatch_external_ip:ys.dispatch_external_ip(this.pn.clientIP),resource_type:ys.resource_type("rtc"),protocol:ys.protocol("webrtc"),try_time:ys.try_time(s),error:n==null?void 0:n.code,message:n==null?void 0:n.message})},e.prototype.publishStartSpan=function(t,n,r,i){var s,c,u,l=r==null?void 0:r.publisher,a=l!=null&&l.hasSucceed?k.fo:k.ch,h=this.cr.createSpan(E.t0.H,{key:k.Og.event,par:t},{key:a.event,par:t},a.event,!0);(n==null?void 0:n.code)===Et.jZ$.code?u={reason:"DenyInfoError",deny_code:i.err,deny_action:i==null?void 0:i.action}:(n==null?void 0:n.code)===Et.PA0.code&&(u={reason:"NetworkBroken"}),u&&h.setAttributes(u),(l==null?void 0:l.isRePublish)===!1&&this.cr.spanSetAttributes({key:oh.event,par:t},{retry_btime:oh.retry_btime(new Date().getTime())}),l!=null&&l.hasSucceed&&(l.isRePublish=!0,l.parentSpanKey=k.fo.event),this.cr.createSpan(E.t0.I,{key:k.Og.event,par:t},{key:k.Jv.event,par:t},k.Jv.event,!0).setAttributes({room_id:ys.room_id((s=r==null?void 0:r.room)===null||s===void 0?void 0:s.roomID),room_sid_string:ys.room_sid_string((c=r==null?void 0:r.room)===null||c===void 0?void 0:c.roomSessionID)}),l&&(l.rtcPublishCount++,l.continuousFailCnt++)},e.prototype.endRtcPlaySpan=function(t,n,r){var i=r!=null&&r.isLastConnected?0:this.getTryTime(r);return!!(r!=null&&r.endPlayingSpan({stop_reason:JSON.stringify(n),try_time:mp.try_time(i),error:n==null?void 0:n.code,message:n==null?void 0:n.message}))},e.prototype.playStartSpan=function(t,n,r,i,s){if(r===void 0&&(r=!1),!n.$h&&!n.isProbe){n.$h=(0,te.fU)(this.cr,E.t0.H,t,n.playStartEvent,fp,void 0,!0);var c=void 0;r?c={reason:"StartPlay"}:(i==null?void 0:i.code)===Et.PA0.code?c={reason:"NetworkBroken"}:s&&(c={reason:"DenyInfoError",deny_code:s==null?void 0:s.err,deny_action:s==null?void 0:s.action}),c&&n.$h.setAttributes(c)}n.hasSucceed===!0&&this.cr.spanSetAttributes({key:sh.event,par:t},{retry_btime:sh.retry_btime(Date.now())}),r||n&&(n.tryidx++,n.continuousFailCnt++)},e.prototype.getTryTime=function(t,n){var r=void 0;return t&&this.streamRetryStartTime>0&&(r=new Date().getTime()-this.streamRetryStartTime,t.lastFailTimeLen=r=r>0?r:void 0,n&&(this.streamRetryStartTime=0)),r},e}(Ks),vo=function(){return vo=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},vo.apply(this,arguments)},Co=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},wo=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},vp=k.Nr.event,ti=k.Nr.error,gp=k.oW;function yp(o){var e=0,t=0;return e=o[t++]<<24,e|=o[t++]<<16,e|=o[t++]<<8,e|=o[t++]}function bp(o,e){e===void 0&&(e=0);for(var t=o.length,n=[],r=0;r<t;)r>=e&&t-r>=3&&!o[r]&&!o[r+1]&&o[r+2]==3?(n.push(o[r++]),n.push(o[r++]),r++):n.push(o[r++]);var i=new Uint8Array(n);return{output:i,outLength:i.length}}var $o,_p=function(){function o(e,t,n,r,i,s,c,u,l,a){var h,m=this;this.Bv=e,this.vm=t,this.tv=s,this.gn=c,this.pn=u,this.room=l,this.pm=a,this.Ld=!0,this._state=7,this.lastState=7,this.ed=0,this.Hl=[],this.jd=0,this.Df=0,this.remoteStream=null,this.Xl=void 0,this.closeSessionSignal=!1,this.bm=!1,this._m=!1,this.mic=null,this.firstFrameTime=0,this.ipV6Prefer=0,this.ipNodeType=A.ZV4Priority,this.ipStackNode=Y.IPv4,this.Al=!0,this.Sl=!1,this.El=[],this.kl=[],this.Ol=[],this.Il="",this.Tl="",this.Cl=500,this.startTime=0,this.od="",this.ud=[],this.ad=0,this.ipNode=null,this.ipV4NodeList=[],this.ipV6NodeList=[],this.probeType="audio",this.Id=0,this.ym=0,this.wm=!1,this.Sm="",this.Em=0,this.zd=0,this.Dd="",this.retryFailGwNodes=[],this.retryFailIpV4Nodes=[],this.retryFailIpV6Nodes=[],this.signalTime=0,this.stopReason="",this.km=0,this.Om=0,this.qd=((h={}).StreamStatusNotifyPush={seq:-1,time:0},h.PlayEventPush={seq:-1,time:0},h.ClientInfoPush={seq:-1,time:0},h.NetQualityInfoPush={seq:-1,time:0},h),this.Ad=0,this.Im={Rm:!0,Tm:[],Cm:[]},this.onDataChannelList=[],this.xd={isSEIStart:!1,unregisterSeiFilter:"",filterSize:0},this.$u=!1,this.Ll=0,this.Ul=0,this.Gl=0,this.Jl=0,this.Fl=0,this.Ud={lanIP:"",wanIP:"",intranet:!1},this.Wl=!1,this.zm={first:!0,seq:0},this.Bd=!1,this.decodeVideoFrame=function(S,x){var q,V,_e=m.Sm!=="VP8",ke=m.Sm==="H265";if(_e){var Pe=m.Dm;if(Pe){if(Pe.buffer)if(S.timestamp-Pe.time<20){var Oe=function(un,ln){if(un.byteLength!==ln.byteLength)return!1;for(var Mn=0;Mn<un.byteLength;Mn++)if(un[Mn]!==ln[Mn])return!1;return!0}(new Uint8Array(S.data),Pe.buffer);Oe&&(_e=!1)}else Pe.buffer=void 0}else m.Dm={buffer:new Uint8Array(S.data).slice(0),time:S.timestamp}}if(_e){for(var Ge=new DataView(S.data),Je=0,tt=new Yd(Ge,ke),ut=0,vt=!1;tt.NextNalu(vt);){if(ke){if((ut=(126&Ge.getUint8(tt.nalu_start+tt.start_code_size))>>1)==32||ut==33||ut==34||ut==35)continue;if(ut!=39)break}else{if((ut=31&Ge.getUint8(tt.nalu_start+tt.start_code_size))==7||ut==8||ut==9)continue;if(ut!=6)break}var gt=new Uint8Array(S.data).slice(tt.nalu_start+tt.start_code_size,tt.nalu_start+tt.start_code_size+tt.nalu_size);m.pn.seiConfig.emulationPreventionByte&&(gt=bp(gt).output),Je=ke?2:1,vt=!0;for(var Pt=0;gt[Je]===255;)Pt+=255,Je++;if((Pt+=gt[Je++])===243||Pt===5||Pt===100){for(var wt=0;gt[Je]===255;)wt+=255,Je++;if(wt+=gt[Je++],S.data.byteLength-Je<wt)break;var At=new Uint8Array(4+wt);switch(At[0]=0,At[1]=0,Pt){case 100:At[2]=3,At[3]=235;break;case 5:At[2]=3,At[3]=236;break;case 243:At[2]=3,At[3]=237}for(var Vt=0;Vt<wt;Vt++)At[4+Vt-0]=gt[Je++];var qt=!1;if(Pt===243)qt=!0;else if(Pt===5){var Gt=m.xd.unregisterSeiFilter;if(Gt){var Sn=At.slice(4,4+m.xd.filterSize),Qt=void 0,Wt=!0;if((Qt=typeof Gt=="string"?_o(Gt):Gt).length===0)Wt=!1;else for(var zt=0;zt<Qt.length;zt++)if(Qt[zt]!==Sn[zt]){Wt=!1;break}qt=Wt}else qt=!0}qt&&m.pn.actionListener("playerRecvSEI",m.va,At)}else if(Pt===244){for(wt=0;gt[Je]===255;)wt+=255,Je++;if(wt+=gt[Je++],S.data.byteLength-Je<wt)break;var Mt=parseInt(wt/5+""),jt=gt.slice(Je,Je+=wt),Kt=[],$t=function(un){var ln=5*un,Mn=jt.slice(ln,ln+4),Hn=jt.slice(ln+4,ln+5),xi=yp(Mn),vi=Hn[0],yr=((V=(q=m.room.streamList)===null||q===void 0?void 0:q.find(function(Ur){return Ur.stream_nid===xi}))===null||V===void 0?void 0:V.stream_id)||"";Kt.push({soundLevelID:xi,value:vi,streamID:yr})};for(zt=0;zt<Mt;zt++)$t(zt);var yt=new Map(Kt.map(function(un){return[un.soundLevelID,un.value]})),Pn=Kt.filter(function(un){return un.streamID}).map(function(un){return[un.streamID,un.value]}),pn=new Map(Pn);m.pn.actionListener("mixerSoundLevelUpdate",yt,m.va),pn.size&&m.pn.actionListener("autoMixerSoundLevelUpdate",pn,m.va)}}x.enqueue(S)}else x.enqueue(S)},this.decodeAudioFrame=function(S,x){x.enqueue(S)},this.ou={seiMessage:function(S){var x=S.data,q=x.streamID;if(q===m.va)switch(x.cmd){case"recvSEI":m.pn.actionListener("playerRecvSEI",q,new Uint8Array(x.buffer));break;case"mixSoundLevel":m.onRecvMixSoundLevels&&m.onRecvMixSoundLevels(x.soundLevelList)}},onUaSocketConnected:function(){var S;m.an.info("zc.ply.ousc call. "+((S=m.Hd)===null||S===void 0?void 0:S.length)+" gwNode: "+m.od),m.Hd&&(m.od="",m.getDispatchIPNodeMode(),m.Vd.apply(m,m.Hd))}},this.onCanStopNegaTimer=function(){},this.onPlayStateUpdateError=function(){},this.onPlayBFrameEvent=function(S){},this.onPlayStreamEnd=function(S){},this.onGwPlayNetState=function(S){},this.Hd=void 0,this.an=ei(r,this.va),this.Kd=new eh(r,!1,e.streamId),n&&this.setSignal(n),this.dataReport=i,this.$u=this.pn.isMiniSdp,this.$u&&(this.Yd=new th(c,r,this.va)),this.checkAutoTcp(),this.Nm(),this.jd=e.playStartTime}return Object.defineProperty(o.prototype,"signal",{get:function(){return this.Wd},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"autoTcp",{get:function(){return this.Ld},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"state",{get:function(){return this._state},set:function(e){this.lastState=this._state,this._state=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"stateNego",{get:function(){return this.ed},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Pm",{get:function(){return this.Bv.playStartEvent},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isProbeByDG",{get:function(){return this.Bv.isProbeByDG},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"streamId",{get:function(){return this.va},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sessionId",{get:function(){return this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"playStream",{get:function(){return this.Bv.playStream},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"peerConnection",{get:function(){return this.Xl},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"resourceMode",{get:function(){return this.Mm},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Xd",{get:function(){return this.gn.agentIpStackDetection.IPv4===H.reachable},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"gwNode",{get:function(){return this.od},set:function(e){this.od=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"gwNodeList",{get:function(){return this.ud},set:function(e){this.ud=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"gwNodesTTL",{get:function(){return this.ad},set:function(e){this.ad=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isNodesEmpty",{get:function(){return this.ipNodeType===A.ZV4Only?this.ud.length===0:this.ipNodeType===A.ZV4Priority?this.ipV4NodeList.length===0:(this.ipNodeType===A.ZV6Priority||this.ipV4NodeList.length===0)&&this.ipV6NodeList.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Od",{get:function(){return this.Bv.isPeer},set:function(e){this.Bv.isPeer=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isProbe",{get:function(){return this.Bv.isProbe},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"peerID",{get:function(){return this.Id},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"needTranscode",{set:function(e){this.ym=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"streamConnectIP",{get:function(){return this.Dd},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"playingEvent",{get:function(){return this.Bv.playingEvent},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"streamNotFoundTime",{get:function(){return this.km},set:function(e){this.km=e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dataChannel",{get:function(){return this.Pf},enumerable:!1,configurable:!0}),o.prototype.createSEIWorker=function(){return this.gn.createSEIWorker()},Object.defineProperty(o.prototype,"seiWorker",{get:function(){return this.gn.seiWorker},enumerable:!1,configurable:!0}),o.prototype.au=function(e,t){return t===void 0&&(t=!1),this.pn.settingConfig.getSetting(e,t)},Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"va",{get:function(){return this.Bv.streamId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"xm",{get:function(){var e;return(e=this.pm)===null||e===void 0?void 0:e.streamParams},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"playMode",{get:function(){return this.vm},enumerable:!1,configurable:!0}),o.prototype.Nm=function(){var e,t,n,r,i=(e=this.pm)===null||e===void 0?void 0:e.isSEIStart;if((0,R.dd)(i)&&(this.xd.isSEIStart=i),i){var s=_t(),c=(t=this.pm)===null||t===void 0?void 0:t.videoCodec;(c&&c!=="H264"&&c!=="H265"||!s)&&(this.an.warn(ie.QU$+" not use sei; support: ".concat(s,", codec: ").concat(c," ")),this.xd.isSEIStart=!1)}if(!((n=this.pn.seiConfig)===null||n===void 0)&&n.unregisterSEIFilter){var u=this.xd.unregisterSeiFilter=(r=this.pn.seiConfig)===null||r===void 0?void 0:r.unregisterSEIFilter;this.xd.filterSize=_o(u).byteLength}},o.prototype.setSignal=function(e){this.Wd!==e?(this.Wd=e,this.Kd.webrtcCenterServerSignal=e,this.Hd&&(this.an.info("zc.prc.ss signal register"),this.Wd.on("uaConnected",this.ou.onUaSocketConnected))):this.an.info("zc.prc.ss signal no changed")},o.prototype.connectGW=function(){return Co(this,void 0,void 0,function(){var e,t=this;return wo(this,function(n){return this.state=0,this.bm=!1,this.setTurnTcp(),this.$u&&!this.Fl&&(this.Fl=performance.now()),(e=this.au("udp_or_tcp",!0))&&(this.an.info(ie.wQ8+" setting udp_or_tcp "+e),this.Bd=e==="tcp"),this.Bd&&(this.Od=!1,this.Ld=!1),[2,new te.l3(function(r,i){(t.Od?t.jm():t.qm()).catch(function(s){i(s)}),t.getRemoteStreamSuc=r})]})})},o.prototype.jm=function(){return Co(this,void 0,void 0,function(){var e,t,n,r,i,s;return wo(this,function(c){switch(c.label){case 0:return c.trys.push([0,5,,6]),[4,this.bv({encodedInsertableStreams:this.xd.isSEIStart})];case 1:return(e=c.sent())?(e=this.Dv(e),[4,this.Lm(e)]):[2];case 2:return(t=c.sent())?(this.wv(t.seq,t.sessionID,n=t.msg,t.ipv6Prefer),[4,this.parseRemoteMiniSdp(n)]):[2];case 3:if(r=c.sent(),this.Ld&&!this.Bm(r,n.params_ext))throw this.Um(Et.drM,!1);return[4,te.l3.all([this.Gm(e),this.Jm(r,void 0,n==null?void 0:n.mini_sdp)])];case 4:return c.sent(),this.Ld&&this.Rv(n.params_ext),[3,6];case 5:if(!(i=c.sent()).playError)throw i;return this.onPlayStateUpdateError((s=i).error,s.stopRetry,s.detail,s.startFromFirst),[3,6];case 6:return[2]}})})},o.prototype.qm=function(){return Co(this,void 0,void 0,function(){var e,t,n,r,i,s,c,u,l;return wo(this,function(a){switch(a.label){case 0:return a.trys.push([0,7,,8]),[4,this.Lm(void 0)];case 1:return(e=a.sent())?(this.Sv(e.seq,e.sessionID,t=e.msg,e.ipv6Prefer),[4,this.Fm(t)]):[2];case 2:return n=a.sent(),[4,this.bv(n)];case 3:return(r=a.sent())?(r=this.Dv(r),[4,this.Gm(r)]):[2];case 4:return a.sent(),[4,this.Hm(r)];case 5:return i=a.sent(),c=i.miniSdp,(s=i.remoteSdp)?[4,this.Jm(s,!0,c)]:[2];case 6:return a.sent(),[3,8];case 7:if(!(u=a.sent()).playError)throw u;return this.onPlayStateUpdateError((l=u).error,l.stopRetry,l.detail,l.startFromFirst),[3,8];case 8:return[2]}})})},o.prototype.Fm=function(e){var t;return Co(this,void 0,void 0,function(){var n,r,i,s,c,u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je,tt,ut,vt,gt,Pt,wt,At,Vt,qt,Gt=this;return wo(this,function(Sn){switch(Sn.label){case 0:return this.an.info((n=ie.HGP)+" success"),this.setTurnTcp(),this.gn.autoSwitchProtocol=this.au("auto_to_tcp")||!1,r=this.au("udp_max_fail_num"),!isNaN(r)&&(this.gn.maxUdpFailNum=r),c=(i=this.gn).maxUdpFailNum,u=i.udpFailNum,this.an.info(n+"  autoToTcp: ".concat(s=i.autoSwitchProtocol,", udpFailNum: ").concat(u,", maxUdpFailNum: ").concat(c,".")),s&&!this.Bd&&u>=c&&(this.an.info(n+" switch to tcp."),this.Bd=!0,this.Ld=!1),(l=this.au("udp_or_tcp",!0))&&(this.an.info(n+" setting udp_or_tcp "+l),this.Bd=l==="tcp"),a=[],h=void 0,m=this.Ud.wanIP=(e.gw_nodes[0]||this.od).split(":")[0],!this.gn.isProxy||this.gn.isLocalProxy?[3,2]:(S=p==null?void 0:p.proxyCtrl,[4,Promise.all([S.getTurnInfo(),S.intranetCheck(ki(m),void 0)])]);case 1:return x=Sn.sent(),V=x[1],(q=x[0]).code?this.an.warn(n+" use proxy failed."+JSON.stringify(q)):(ke=(_e=q.data).password,Pe=_e.turn_ipv4,Oe=_e.turn_port,Ge=_e.username,(Je=_e.turn_internal_ipv4)&&(this.yv.coturn_internal=Je),tt=wr(Pe),ut="turn:".concat(tt,":").concat(Oe,"?transport=").concat(this.Bd?"tcp":"udp"),this.an.info(n+" turn server: ".concat(ut," ; intranet: ").concat(JSON.stringify((t=V==null?void 0:V.data)===null||t===void 0?void 0:t.intranet),"; turn internal ip: ").concat(wr(Je))),h=[{credential:ke,urls:[ut],username:Ge}]),V.code?this.an.warn(n+" use intranetCheck failed."+JSON.stringify(V)):this.Ud.intranet=V.data.intranet||!1,[3,3];case 2:this.gn.isLocalProxy&&this.gn.turnServers?(h=(gt=this.gn.turnServers).map(function(Qt){return{credential:Qt.credential,urls:[Qt.url],username:Qt.username}}),this.an.info(n+" use local proxy: "+JSON.stringify(gt)),this.Ud.intranet=!1):e.turn_server&&(vt=[],e.turn_server.split(";").forEach(function(Qt){var Wt=Fi(Qt).replace("[","").replace("]",""),zt=Ar(Wt);if(Gt.ipStackNode===zt?vt.push(Qt):Gt.El.push(Qt),zt==Y.IPv4){var Mt=Fa(Wt),jt=Qt.replace(Wt,"[".concat(Mt,"]"));Gt.gn.isCandidateHasIPv6&&vt.push(jt)}}),(qt=this.El).push.apply(qt,vt),gt=void 0,Pt=vt.filter(function(Qt){return Qt.indexOf("udp")>-1}),wt=vt.filter(function(Qt){return Qt.indexOf("tcp")>-1}),gt=this.Bd?wt.length>0?wt:Pt.map(function(Qt){return Qt.replace("udp","tcp")}):Pt,this.an.info(n+" over tcp "+JSON.stringify(gt)),a.push.apply(a,gt)),Sn.label=3;case 3:return e.stun_server&&a.push(e.stun_server),At={iceTransportPolicy:"all",iceServers:[{urls:a,username:e.turn_username,credential:e.turn_auth_key}],encodedInsertableStreams:this.xd.isSEIStart},this.Il=e.turn_username,this.Tl=e.turn_auth_key,h&&(At.iceServers=h,At.iceTransportPolicy="relay",At.rtcpMuxPolicy="require"),this.an.info(n+" username: "+(Vt=At.iceServers[0]).username+", credential: "+Vt.credential),this.dv(),this.an.info(n+" call success"),[2,At]}})})},o.prototype.Tv=function(e,t){var n=this.qd[e],r=n.seq,i=n.time,s=performance.now();return r!==-1&&r>=t&&s-i<6e3?(this.an.warn(ie.CLV+" push ".concat(e,", seq ").concat(t," local ").concat(JSON.stringify(this.qd[e]))),!1):(this.qd[e]={seq:t,time:s},!0)},o.prototype.bv=function(e){return Co(this,void 0,void 0,function(){var t,n,r,i,s,c,u,l,a=this;return wo(this,function(h){switch(h.label){case 0:t=ie.HGP,this.Xl=new RTCPeerConnection(e),this.Xl.onicecandidate=function(m){a.Vm(m)},this.Xl.onsignalingstatechange=function(m){a.Qm(m)},this.Xl.oniceconnectionstatechange=function(m){a.Ym(m)},this.Xl.onconnectionstatechange=function(m){a.Km(m)},this.Xl.ontrack=function(m){a.Zm(m.streams[0],m.receiver)},n=this.au("peer_signal_over_dc"),(this.gn.isDataChannelEnabled||n)&&(r={ordered:!1},this.an.info("zc.p.dc.n  option:"+JSON.stringify(r)+" enable: "+n),this.Ad=0,this.Pf=this.Xl.createDataChannel(this.va,r),this.Pf.binaryType="arraybuffer",n&&(this.Kd.dataChannel=this.Pf),this.Pf.onopen=function(m){a.an.info("zc.p.dc.o onopen")},this.Pf.onclose=function(m){a.an.warn("zc.p.dc.c onclose")},this.Pf.onmessage=function(m){if(a.Ad++<3&&a.an.info("zc.p.dc.m onmessage"),m.data instanceof Blob){var S=new FileReader,x={};S.readAsArrayBuffer(m.data),S.onload=function(){x.data=S.result,a.onReceivedDataChannel(x)}}else a.onReceivedDataChannel(m)}),this.pn.customUa&&(i=(0,R.JO)(this.Xl.addTransceiver),this.an.info(t+" custom ua ios "+i),i&&(this.Xl.addTransceiver("video",{direction:"recvonly"}),this.Xl.addTransceiver("audio",{direction:"recvonly"}))),this.Dl=s={offerToReceiveAudio:!0,offerToReceiveVideo:!0},this.isProbe?this.probeType==="audio"&&(s.offerToReceiveVideo=!1):(this.pm&&this.pm.video===!1&&(s.offerToReceiveVideo=!1),this.pm&&this.pm.audio===!1&&(s.offerToReceiveAudio=!1)),this.an.info(t+" createOffer: "+JSON.stringify(s)),c=this.getSpan(k.Jd.event,this.Pm),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,this.Xl.createOffer(s)];case 2:return u=h.sent(),c&&(this.pn.ia(c,{sdp:u.sdp}),c.setAttributes({is_mini:k.Jd.is_mini(this.$u)}),c.end()),this.Xm(u.sdp||"")?[2,u]:(this.onNeedReplay&&this.onNeedReplay(),[2,void 0]);case 3:throw l=h.sent(),this.an.error(t+" create offer error "+l.toString()),c&&this.cr.setError(c,{code:ti.Vn.code,message:l.toString()}),this.Um(ti.Vn,!0);case 4:return[2]}})})},o.prototype.xv=function(e){return Ti(e).length===0},o.prototype.restartIce=function(){var e,t=this,n=ie.IRO;this.an.info("".concat(n," call")),(e=this.Xl)===null||e===void 0||e.createOffer(vo(vo({},this.Dl),{iceRestart:!0})).then(function(r){var i,s,c;if(t.an.info("".concat(n," createOffer suc")),r.sdp){t.Dv(r);var u=Ac(r.sdp),l=bi(r.sdp);t.an.info("".concat(n," ice ").concat(u," ").concat(l));var a={iceTransportPolicy:"all",rtcpMuxPolicy:"require",iceServers:[{urls:t.El,username:t.Il,credential:t.Tl}],encodedInsertableStreams:t.xd.isSEIStart};t.an.info("".concat(n," set config ").concat(JSON.stringify(a))),(i=t.Xl)===null||i===void 0||i.setConfiguration(a),t.sendRestartIce(u,l),t.an.info("".concat(n," localSdp1 ").concat(r.sdp.substr(0,r.sdp.length/2))),t.an.info("".concat(n," localSdp2 ").concat(r.sdp.substr(r.sdp.length/2))),(s=t.Xl)===null||s===void 0||s.setLocalDescription(r).then(function(h){t.an.info("".concat(n," set local sdp suc"))}).catch(function(h){t.an.info("".concat(n," set local sdp fail ").concat(h.message?JSON.stringify(h.message):JSON.stringify(h)))}),(c=t.Xl)===null||c===void 0||c.setRemoteDescription(new RTCSessionDescription({type:"answer",sdp:t.nv})).then(function(h){t.an.info("".concat(n," set remote sdp suc"))}).catch(function(h){t.an.info("".concat(n," set remote sdp fail ").concat(h.message?JSON.stringify(h.message):JSON.stringify(h)))}),t.kl.forEach(function(h){var m;(m=t.Xl)===null||m===void 0||m.addIceCandidate(new RTCIceCandidate(h)).then(function(){t.an.info("".concat(n," ").concat(t.va,", add can suc"))}).catch(function(S){t.an.info("".concat(n," ").concat(t.va,", add can fail, ").concat(S.message))})})}}).catch(function(r){t.an.warn("zc.p.0.rsi err ".concat(r.message?JSON.stringify(r.message):JSON.stringify(r)))})},o.prototype.resetIceInfos=function(){this.an.info("zc.p.1.rii.0 call"),this.El=[],this.Il="",this.Tl="",this.kl=[]},o.prototype.resetNat64Infos=function(){this.an.info("zc.p.0.rni.0 call"),this.Ol=[]},o.prototype.Xm=function(e){return this.an.info(ie.HGP+" is probe "+this.isProbe),!this.isProbe||!(this.probeType==="audio"&&!e.includes("m=audio"))||(this.an.warn(ie.HGP+" no audio"),this.probeType="all",!1)},o.prototype.Lm=function(e){var t=this;return new te.l3(function(n,r){try{t.Vd(e,n,r)}catch(i){r(i)}})},o.prototype.Vd=function(e,t,n){var r,i,s,c,u=this,l=!!e;if(!this.Wd.isUaConnected)return this.an.info(ie.QU$+" wait to create session"),this.Hd=[e,t,n],void this.Wd.on("uaConnected",this.ou.onUaSocketConnected);this.Hd&&(this.Hd=void 0),this.lv=(0,E.Mo)();var a=this.va;this.gn.testEnvironment==1&&(a="zegotest-"+this.gn.appid+"-"+this.va);var h="".concat(ie.QU$," session req : "),m=this.getTransCodec(a),S=m.transCodecID,x=m.transCodecSuffix,q=m.transCodecStreamID;x&&(h+=" transcode: ".concat(S," , ").concat(a," , ").concat(x," ; "),this.pn.onExperimentalAPICallback({method:"playerStartTranscoding",content:{streamID:this.va,codecTemplateID:S,reason:this.ym}})),a=q,this.gn.gwNode&&(this.od=this.gn.gwNode);var V=this.au("gw_nodes");V&&(0,R.C9)(V)&&V.length>0&&(this.an.info(ie.QU$+" setting "+JSON.stringify(V)),this.ud=V,this.od=this.ud[0]||this.od);var _e=((i=(r=this.gn.publisherList[this.va])===null||r===void 0?void 0:r.room)===null||i===void 0?void 0:i.roomID)||((s=this.pn.roomList[0])===null||s===void 0?void 0:s.roomID);this.getIPStackNode(),this.an.info(h+" gwNode: ".concat(this.od,", ipNodeType: ").concat(this.ipNodeType,", ").concat(this.Od?"peer":"turn",", ipv6_prefer: ").concat(this.ipV6Prefer));var ke=this._v(_e),Pe=ke.params,Oe=ke.paramsExt;this.yv=Oe;var Ge=k.Bc;if(l){var Je=function(vt){var gt=u.getSpan(k.Bc.event,u.Pm);gt==null||gt.setAttributes({server_host:u.od,ip_mode:u.ipV6Prefer,req_params_ext:Oe});var Pt=u.au("l3_play_buffer_ms"),wt=new Date().getTime();u.Wl=!1;var At={};vt?At.miniSdp=vt:At.sdp=e.sdp,u.Kd.createSessionWithSdp(vo(vo({seq:u.lv,type:u.isProbe?2:1,mode:0,streamId:a,strAuthParam:u.xm||""},At),{serverHost:u.od,playBufLevel:u.vm===E.ey.L3?Pt:void 0,params:Pe,paramsExt:Oe,roomID:_e,geo:{type:u.gn.geo.type,areaList:u.gn.geo.areaList},transCodecID:S,transCodecSuffix:x,ipV6Prefer:u.ipV6Prefer}),function(Vt,qt,Gt){return Co(u,void 0,void 0,function(){var Sn;return wo(this,function(Qt){return Sn=new Date().getTime(),this.an.info(ie.QU$+" create session time "+(Sn-wt)),qa(Gt),gt&&(this.pn.ia(gt,{sdp:Gt.sdp}),gt.setAttributes({webrtc_sid:qt,gw_nodes:Ge.gw_nodes(Gt.gw_nodes),ip_infos:Gt.ips,ip_v6_infos:Gt.ipv6s,gw_nodes_ttl:Ge.gw_nodes(Gt.gw_nodes_ttl),gw_version:Ge.gw_version(Gt.gw_version),ip_mode:this.ipV6Prefer,rsp_params_ext:Gt.params_ext}),gt.end()),this.ed!==5&&this.getSpan(k.F.event,this.Pm,"",!0),this.lv!=Vt?(this.an.error(ie.GV2+" seq is not match."),t(void 0)):t({seq:Vt,sessionID:qt,msg:Gt,ipv6Prefer:this.ipV6Prefer}),[2]})})},function(Vt,qt){if(u.lv==qt){Vt===Et.OdW&&(u.$u=!1);var Gt=Vt==E.Xb?ti.Yn:ti.Kn;gt&&u.cr.setError(gt,Gt),u.an.warn(ie.GV2+" create session fail. ".concat(Vt.code)),n(u.Um(Gt))}else u.an.warn(ie.GV2+" seq is not match.")})};if(this.$u){var tt=performance.now();(c=this.Yd)===null||c===void 0||c.getMiniSdp(e.sdp).then(function(vt){u.Ul=performance.now()-tt,Je(vt)}).catch(function(vt){u.$u=!1,u.pn.$u=!1,u.Ul=performance.now()-tt,u.Jl=performance.now()-u.Fl,u.Ll=1,Je()})}else Je()}else{var ut=this.getSpan(k.Bc.event,this.Pm);ut==null||ut.setAttributes({server_host:this.od,ip_mode:this.ipV6Prefer}),this.Wl=!1,this.Kd.createSession(this.lv,{type:1,mode:0,streamID:a,strAuthParam:this.xm||"",serverHost:this.od,params:Pe,roomID:_e,geo:{type:this.gn.geo.type,areaList:this.gn.geo.areaList},transCodecID:S,transCodecSuffix:x,ipV6Prefer:this.ipV6Prefer},function(vt,gt,Pt){return Co(u,void 0,void 0,function(){return wo(this,function(wt){return qa(Pt),ut&&(ut.setAttributes({webrtc_sid:k.Bc.webrtc_sid(gt),is_mini:Ge.is_mini(this.$u),gw_nodes:Ge.gw_nodes(Pt.gw_nodes),ip_infos:Pt.ips,ip_v6_infos:Pt.ipv6s,gw_nodes_ttl:Ge.gw_nodes(Pt.gw_nodes_ttl),gw_version:Ge.gw_version(Pt.gw_version),ip_mode:this.ipV6Prefer}),ut.end()),this.lv!=vt?(this.an.error(ie.QU$+" seq is not match."),t(void 0)):t({seq:vt,sessionID:gt,msg:Pt,ipv6Prefer:this.ipV6Prefer}),[2]})})},function(vt,gt){if(u.lv==gt){var Pt=vt==E.Xb?ti.Yn:ti.Kn;ut&&u.cr.setError(ut,Pt),n&&n(u.Um(Pt))}else u.an.warn(ie.QU$+" seq is not match.")})}this.state=1,this.an.info(ie.QU$+" called success"),this.ed=1},o.prototype._v=function(e){var t="",n=[],r={},i=this.pn.seiConfig.SEIPass;(0,R.dd)(i)&&(r.sei_filter_pass=i?1:0),r.auto_switch_turn_type=this.pn.browser==="firefox"?2:1,this.vm===E.ey.L3&&(r.client_class_type=1,this.pm.adaptiveSwitch===!0&&this.pm.adaptiveTemplateIDList&&(r.adaptive_switch=1,r.adaptive_template_id_list=this.pm.adaptiveTemplateIDList.join(","))),(0,R.Cs)(this.pm.streamType)&&(r.video_stream_type=this.pm.streamType),(0,R.Cs)(this.pm.posterType)&&(r.req_poster_type=this.pm.posterType);var s=0,c=this.pm.jitterBufferTarget,u=this.pm.playoutDelayHint;return(0,R.Cs)(c)&&c>0&&c<=4e3?s=c:(0,R.Cs)(u)&&u>0&&u<=4&&(s=1e3*u),(0,R.dd)(this.pm.enableLowLatency)&&this.pm.enableLowLatency&&(s=2147483647),s>0&&(r.play_jitter_level=s),this.pn.idName&&n.push("zguid="+this.pn.idName),e&&n.push("zgrid="+e),this.gn.isProxy&&(r.zg_proxy=1),r.proto_flags=2,this.au("peer_signal_over_dc")&&(r.proto_flags|=256),n.length>0&&(t=n.join("&")),{params:t,paramsExt:r}},o.prototype.getDispatchIPNodeMode=function(){if(!this.od){this.an.info("zc.p.1.gdinm call");var e=this.gn.getStreamIPNodesMode(),t=e.ipNodeType;this.ipV6Prefer=e.ipV6Prefer,this.ipNodeType=t,this.ipV6Prefer===L.kV6AndV4&&!this.Al&&this.Xd&&(this.ipV6Prefer=L.kV4AndV6,this.ipNodeType=A.ZV4Priority),this.an.info("zc.p.1.gdinm ".concat(this.ipV6Prefer," ").concat(this.ipNodeType))}},o.prototype.getRetryIPNodeMode=function(){if(this.an.info("zc.p.1.grinm call"),this.ipV6Prefer===L.kV4Only)this.ipNodeType=A.ZV4Only;else{var e=this.gn.getRetryIPPreferNodeType(),t=e.ipV6Prefer;this.ipNodeType=e.ipNodeType,this.ipV6Prefer=t}this.an.info("zc.p.1.grinm ".concat(this.ipV6Prefer," ").concat(this.ipNodeType))},o.prototype.getRetryIPv6Prefer=function(){this.ipV6Prefer=this.gn.getIPv6PreferByGwNode(this.gwNode)},o.prototype.checkIfToRestart=function(e){this.Sl=!this.isProbe&&e!==L.kV4Only&&(this.ipNodeType===A.ZV6AndV4Priority||this.pn.selectIPStackMode===N.IPv4Prefer&&this.gn.agentIpStackDetection.IPv4===H.reachable&&this.ipNodeType===A.ZV6Priority)},o.prototype.getIPStackNode=function(){if(this.gwNode){var e=Dr(this.gwNode);this.ipStackNode=Ar(e)}else this.ipStackNode=[A.ZV4Only,A.ZV4Priority].includes(this.ipNodeType)?Y.IPv4:Y.IPv6},o.prototype.setGwNodes=function(e,t,n,r){var i,s,c;if(this.an.info("".concat(ie.Eb9," seq: ").concat(r,", gw_nodes: ").concat(JSON.stringify(e==null?void 0:e.gw_nodes),", ips: ").concat(JSON.stringify(e.ips),", ipv6s: ").concat(JSON.stringify(e.ipv6s),", ").concat(n)),this.an.info("".concat(ie.Eb9," seq: ").concat(r,", retry: ").concat(JSON.stringify(this.retryFailGwNodes),", ips: ").concat(JSON.stringify(this.retryFailIpV4Nodes),", ipv6s: ").concat(JSON.stringify(this.retryFailIpV6Nodes))),n===0){if(((i=e.gw_nodes)===null||i===void 0?void 0:i.length)>0){var u=er(e.gw_nodes,this.retryFailGwNodes,t);this.retryFailGwNodes=[],this.handleDispatchedGwNodes(u,e.gw_nodes_ttl,n)}}else{var l=void 0,a=void 0;((s=e.ips)===null||s===void 0?void 0:s.length)>0&&(l=ai(e.ips,this.retryFailIpV4Nodes,t),this.retryFailIpV4Nodes=[]),((c=e==null?void 0:e.ipv6s)===null||c===void 0?void 0:c.length)>0&&(a=ai(e.ipv6s,this.retryFailIpV6Nodes,t),this.retryFailIpV6Nodes=[]),this.handleDispatchedGwNodes(e.gw_nodes||[],e.gw_nodes_ttl,n,l,a)}},o.prototype.resetGwNodes=function(){this.an.info(ie.Lji+" call"),this.od="",this.ud=[],this.ipV4NodeList=[],this.ipV6NodeList=[],this.ad=0},o.prototype.handleDispatchedGwNodes=function(e,t,n,r,i){var s=this;if(r===void 0&&(r=[]),i===void 0&&(i=[]),this.an.info(ie._2$+" "+JSON.stringify(e)+" "+JSON.stringify(e)+" "+JSON.stringify(r)+" "+JSON.stringify(i)+" ipv6Prefer "+n),Array.isArray(e)&&e.length!==0||r.length!==0||i.length!==0){var c=t===0?60:t,u=function(){s.ad=c?new Date().getTime()+1e3*c:s.ad};this.ud=e.length>0?e:this.ud,this.ipV4NodeList=r.length>0?r:this.ipV4NodeList,this.ipV6NodeList=i.length>0?i:this.ipV6NodeList,n===L.kV4Only?(this.od=e.length>0?this.ud[0]:this.od,e.length>0&&u()):n==L.kV4AndV6&&r.length>0?(this.od=Tr(r[0]),this.ipNode=r[0],u()):n===L.kV6AndV4&&i.length>0?(this.od=Tr(i[0]),this.ipNode=i[0],u()):(this.ud.length>0&&(this.od=this.ud[0]),this.an.info("".concat(ie._2$," ").concat(this.va," no gwNode ").concat(n," ").concat(r.length," ").concat(i.length)),this.ipNodeType=A.ZV4Only,this.ipStackNode=Y.IPv4),this.gn.updateCachedGwNodesList(this.streamId,!1,e||[],c,r,i)}},o.prototype.Sv=function(e,t,n,r){var i,s,c,u=n.turn_server,l=u.split("?")[0]&&u.split("?")[0].slice(5),a=this.signal.Ev,h="webrtc://".concat(l,"/").concat(a,"/").concat(this.va);this.cr.spanSetAttributes({key:this.Pm,par:this.va},{webrtc_sid:n.session_id,url:h}),this.an.info(ie.QU$+" sessionId:"+n.session_id),this.resetPushCmdSeqMap();var m=n.client_ip||n.clientip;m&&(this.pn.clientIP=m),this.Id=n.peer_id;var S=0,x=new Date().getTime();if(this.jd&&(this.an.info(ie.GV2+" create signal time "+(S=x-this.jd)),this.signalTime=S),this.zd=x,n.result!==0){this.an.error(ie.QU$+" create error "+n.result);var q=this.Um(ti.Kn);throw(n==null?void 0:n.result)===1021&&(q=this.Um(Et.mHY,!0)),(n==null?void 0:n.result)===2013&&(q=this.Um(ti.Me,!0)),(n==null?void 0:n.result)===2016&&r===L.kV6AndV4&&(this.Al=!1),(n==null?void 0:n.result)===1006&&(q=this.Um(ti.xe,!0)),q}this.Df=n.session_id,this.Wl=!0,this.setGwNodes(n,!1,r,e),r===L.kV6AndV4&&((i=n==null?void 0:n.ipv6s)===null||i===void 0?void 0:i.length)>0&&(this.Al=!0),((s=n==null?void 0:n.ipv4s)===null||s===void 0?void 0:s.length)>0&&((c=n==null?void 0:n.ipv6s)===null||c===void 0?void 0:c.length)>0&&this.checkIfToRestart(r),this.an.info(ie.QU$+" "+this.va+" isRestartIce "+this.Sl)},o.prototype.wv=function(e,t,n,r){var i,s,c;this.an.info(ie.GV2+" sessionId:"+t),this.resetPushCmdSeqMap();var u=n.client_ip||n.clientip;u&&(this.pn.clientIP=u),this.Id=n.peer_id;var l=0,a=new Date().getTime();if(this.jd&&(this.an.info(ie.GV2+" create signal time "+(l=a-this.jd)),this.signalTime=l),this.zd=a,n.result!==0){if(n.result===110&&(this.$u=!1,this.pn.$u=!1,this.Jl=performance.now()-this.Fl,this.Ll=2),this.an.error(ie.GV2+" create session failed "+n.result),(n==null?void 0:n.result)===1021)throw this.Um(Et.mHY,!0);var h=ti.Kn;throw(n==null?void 0:n.result)===1004&&(h=vo(vo({},this.pn.isFlutter?Et.T_8:ti.ke),{message:"Stream not found."}),this.Wm())?this.Um(h,!0):(n==null?void 0:n.result)===2013?this.Um(h=ti.Me,!0):((n==null?void 0:n.result)===2016&&r===L.kV6AndV4&&(this.Al=!1),(n==null?void 0:n.result)===1006?this.Um(ti.xe,!0):this.Um(h))}this.Df=t,this.Wl=!0,this.an.info(ie.GV2+" create session success "),this.setGwNodes(n,!1,r,e),r===L.kV6AndV4&&((i=n==null?void 0:n.ipv6s)===null||i===void 0?void 0:i.length)>0&&(this.Al=!0),((s=n==null?void 0:n.ipv4s)===null||s===void 0?void 0:s.length)>0&&((c=n==null?void 0:n.ipv6s)===null||c===void 0?void 0:c.length)>0&&this.checkIfToRestart(r),this.an.info(ie.GV2+" "+this.va+" isRestartIce "+this.Sl),this.dv()},o.prototype.Rv=function(e){var t,n=this;if(this.an.info(ie.rp8+" set candidate ".concat(!!e)),e){var r=e.candidate,i=e.sdpMid,s=e.sdpMLineIndex;r&&(this.an.info(ie.rp8+" addIceCandidate"),(t=this.Xl)===null||t===void 0||t.addIceCandidate(new RTCIceCandidate({sdpMid:i,sdpMLineIndex:s,candidate:r})).then(function(){n.an.info(ie.rp8+" add can suc")}).catch(function(c){n.an.info(ie.rp8+" add can fail, ".concat(c.message))}))}},o.prototype.Dv=function(e){if(!(e!=null&&e.sdp))throw this.an.warn(ie.amU+" no content"),this.Um(Et.dqB,!0);var t=e.sdp;this.an.info(ie.amU+" localSdp1 "+t.substr(0,t.length/2)),this.an.info(ie.amU+" localSdp2 "+t.substr(t.length/2));var n=(t=(t=t.replace(/sendrecv/g,"recvonly")).replace(/useinbandfec=/,"stereo=1;useinbandfec=")).match(/m=application[\s\S]+datachannel[\s\S]+/),r=n?n[0]:null;if(r){var i=r.replace(/recvonly/,"sendrecv");t=t.replace(r,i)}return t=function(s){var c=s.split(`\r
`),u=new Map;c.forEach(function(m,S){if(/^a=rtcp-fb:/.test(m)&&c[S+1]&&!/^a=rtcp-fb:/.test(c[S+1])){var x=m.match(/^a=rtcp-fb:\d+/);x&&u.set(S+1,x[0]+" rrtr")}});for(var l=Array.from(u),a=0;a<l.length;a++){var h=cp([],l[a],!0);c.splice(h[0]+a,0,h[1])}return c.join(`\r
`)}(t=up(t)),this.pm.videoCodec&&(t=j.getSDPByVideDecodeType(t,this.pm.videoCodec)),this.pn.browser==="firefox"&&Ir(this.pn.browserInfo,"firefox",139,2)&&(t=nh(t)),e.sdp=t,e},o.prototype.Gm=function(e){var t;return Co(this,void 0,void 0,function(){var n,r;return wo(this,function(i){switch(i.label){case 0:this.an.info(ie.amU+" set local sdp"),(n=this.getSpan(k.FQ.event,this.Pm))&&(this.pn.ia(n,{sdp:e.sdp}),n.setAttributes({is_mini:k.FQ.is_mini(this.$u)})),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(t=this.Xl)===null||t===void 0?void 0:t.setLocalDescription(e)];case 2:return i.sent(),n&&n.end(),[3,4];case 3:throw r=i.sent(),this.an.error(ie.amU+" set error "+r.toString()),n&&this.cr.setError(n,{code:ti.Qn.code,message:r.toString()}),this.Um(ti.Qn,!0);case 4:return[2]}})})},o.prototype.Hm=function(e){return Co(this,void 0,void 0,function(){var t,n,r,i,s,c,u,l,a,h=this;return wo(this,function(m){switch(m.label){case 0:if(this.an.info(ie.c2i+" success"),t={paramsExt:this.yv},!this.$u)return[3,5];n=performance.now(),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,this.Yd.getMiniSdp(e.sdp)];case 2:return r=m.sent(),this.Ul=performance.now()-n,t.miniSdp=r,[3,4];case 3:return m.sent(),this.$u=!1,this.pn.$u=!1,this.Ul=performance.now()-n,this.Jl=performance.now()-this.Fl,this.Ll=1,t.sdp=e.sdp,[3,4];case 4:return[3,6];case 5:t.sdp=e.sdp,m.label=6;case 6:return this.vm===E.ey.L3&&(t.min_play_buf_level_ms=500),this.np=(0,E.Mo)(),(i=this.getSpan(k.GV.event,this.Pm))==null||i.setAttributes({req_params_ext:this.yv}),this.state=2,[4,new te.l3(function(S,x){h.Kd.sendMediaDesc(h.np,h.Df,0,t,function(q,V,_e){S({seq:q,sessionId:V,data:_e})},function(q,V){h.an.error(ie.c2i+" failed to send "+q),i&&h.cr.setError(i,{code:ti.$n.code,message:q.toString()}),h.np==V&&x(h.Um(ti.$n))})})];case 7:return s=m.sent(),c=s.seq,u=s.sessionId,l=s.data,this.an.info(ie.c2i+" sendMediaDesc resp"),i&&(this.pn.ia(i,{sdp:t.sdp}),i.setAttributes({webrtc_sid:k.GV.webrtc_sid(u)})),this.np!=c?(this.an.error(ie.c2i+" seq or sessionId is not equal "+this.np+" "+c),[2,{remoteSdp:""}]):(this.an.info(ie.c2i+" send success stateNego:waiterAnswer"),this.ed=2,this.state=3,[4,this.parseRemoteMiniSdp(l)]);case 8:if(a=m.sent(),i&&this.pn.ia(i,{remote_sdp:a}),i==null||i.end(),a)return[2,{remoteSdp:a,miniSdp:l==null?void 0:l.mini_sdp}];throw this.Um(ti.$n)}})})},Object.defineProperty(o.prototype,"turnToTcp",{get:function(){return this.Bd},enumerable:!1,configurable:!0}),o.prototype.checkAutoTcp=function(){var e=mt();this.an.info("zc.p.1.cat ".concat(e," ").concat(this.Od)),this.Ld=!(!e||!this.Od)},o.prototype.Jm=function(e,t,n){var r,i;return t===void 0&&(t=!1),Co(this,void 0,void 0,function(){var s,c,u,l,a,h,m,S,x,q,V,_e,ke,Pe,Oe,Ge,Je,tt,ut,vt,gt=this;return wo(this,function(Pt){switch(Pt.label){case 0:if(s={type:"answer",sdp:e,toJSON:function(){}},c=this.getSpan(k.EV.event,this.Pm),this.setTurnTcp(),this.gn.autoSwitchProtocol=this.au("auto_to_tcp")||!1,u=this.au("udp_max_fail_num"),!isNaN(u)&&(this.gn.maxUdpFailNum=u),h=(l=this.gn).maxUdpFailNum,m=l.udpFailNum,this.an.info(ie.wQ8+"  autoToTcp: ".concat(a=l.autoSwitchProtocol,", udpFailNum: ").concat(m,", maxUdpFailNum: ").concat(h,".")),a&&!this.Bd&&m>=h&&(this.an.info(ie.wQ8+" switch to tcp."),this.Bd=!0,this.Ld=!1),(S=this.au("udp_or_tcp",!0))&&(this.an.info(ie.wQ8+" setting udp_or_tcp "+S),this.Bd=S==="tcp"),this.Bd&&!this.gn.isProxy&&this.pn.browser!=="firefox"&&((r=s.sdp.match(/candidate.*/g))===null||r===void 0||r.forEach(function(wt){var At=wt.replace(/udp/,"tcp");At.includes(" tcptype ")||(At=At.replace(" typ host "," typ host tcptype passive ")),s.sdp=s.sdp.replace(wt,At)})),this.gn.isProxy)if(x=ie.wQ8,V=Ns(q=s.sdp),_e=V[0],ke=V[1],Pe=q.match(/a=mid:[^(\n|\r)]+/g),ke&&Pe)if(this.Ud.intranet)setTimeout(function(){ke.forEach(function(wt,At){var Vt,qt={sdpMLineIndex:At,candidate:wt.replace(_e[At].ip,gt.Ud.wanIP).replace("a=",""),sdpMid:Pe[At].replace("a=mid:","")};gt.an.info(x+"  add wan candidate:"+JSON.stringify(qt)),(Vt=gt.Xl)===null||Vt===void 0||Vt.addIceCandidate(new RTCIceCandidate(qt))})},1e3);else for(this.an.info(x+"  change candidate ip from lan to wan: "+(Oe=this.Ud.wanIP)),Ge=0;Ge<ke.length;Ge++)tt=(Je=ke[Ge]).replace(_e[Ge].ip,Oe),s.sdp=q.replace(Je,tt);else this.an.warn(x+" candidate not found");else s.sdp=this.extractCandidate(s.sdp);this.an.info(ie.wQ8+" remoteSdp "+s.sdp),c&&(this.pn.ia(c,{sdp:s.sdp}),c.setAttributes({webrtc_sid:k.EV.webrtc_sid(this.Df),is_mini:k.EV.is_mini(this.$u)})),this.state=4,t&&(this.jv(this.Hl),this.Hl=[],this.state=5),this.startTime=Date.now(),this.checkRetryOtherIPCandidate(),this.an.info(ie.wQ8+" call success"),this.nv=s.sdp,Pt.label=1;case 1:return Pt.trys.push([1,3,,4]),[4,(i=this.Xl)===null||i===void 0?void 0:i.setRemoteDescription(new RTCSessionDescription(s))];case 2:return Pt.sent(),c&&c.end(),this.an.info(ie.wQ8+" set success"),[3,4];case 3:throw ut=Pt.sent(),this.an.error(ie.wQ8+" set remote error "+ut.toString()),this.$u&&(0,R.G0)(n)&&this.an.warn(ie.wQ8+" mini "+n.toString()),c&&(c.setAttributes({error:ti.Zn.code,message:ut.toString()}),c.end()),vt=!0,this.$u&&(vt=!1,this.$u=!1,this.Jl=performance.now()-this.Fl,this.Ll=4),this.Um(ti.Zn,vt);case 4:return[2]}})})},o.prototype.checkRetryOtherIPCandidate=function(){var e=this;this.hv=setTimeout(function(){e.an.info("".concat(ie.p1K," ").concat(e.va," check ").concat(e.state," ").concat(e.ipNodeType," ").concat(e.kl.length)),e.state!==6&&e.Sl&&e.kl.length>0&&(e.ipStackNode=e.ipStackNode===Y.IPv4?Y.IPv6:Y.IPv4,e.restartIce())},this.Cl)},o.prototype.extractCandidate=function(e){var t=this,n=Ns(e),r=n[0];return n[1].forEach(function(i,s){var c=r[s].ip,u=Ar(c);if(t.ipStackNode!==u){var l={sdpMLineIndex:parseInt(r[s].mid),candidate:i.replace("a=",""),sdpMid:r[s].mid};t.kl.push(l),e=e.replace(i+`
`,"")}if(u===Y.IPv4){var a=Fa(c),h=i.replace(new RegExp(c,"g"),a).replace("a=",""),m={sdpMLineIndex:parseInt(r[s].mid),candidate:h,sdpMid:r[s].mid};t.Ol.find(function(S){return S.candidate===m.candidate&&S.sdpMLineIndex===m.sdpMLineIndex&&S.sdpMid===m.sdpMid})||t.Ol.push(m)}}),e},o.prototype.Bm=function(e,t){var n,r,i=this;if(this.an.info(ie.YOg+" preset turn "+"".concat(JSON.stringify(t))),t){var s=t.turn_username,c=t.turn_auth_key,u=t.turn_urls;this.Il=s,this.Tl=c;var l=void 0;if(u){var a=u.split(";"),h=[];a.forEach(function(x){var q=Fi(x).replace("[","").replace("]",""),V=Ar(q);if(i.ipStackNode===V?h.push(x):i.El.push(x),V==Y.IPv4){var _e=Fa(q),ke=x.replace(q,"[".concat(_e,"]"));i.gn.isCandidateHasIPv6&&h.push(ke)}}),(n=this.El).push.apply(n,h),(l=h).length===0&&l.push.apply(l,this.El)}else{var m=Ti(e);if(m.length===0)return this.an.info(ie.YOg+" "+this.va+" no candidate"),!1;l=m}var S={iceTransportPolicy:"all",rtcpMuxPolicy:"require",iceServers:[{urls:l,username:s,credential:c}],encodedInsertableStreams:this.xd.isSEIStart};try{(r=this.Xl)===null||r===void 0||r.setConfiguration(S)}catch(x){this.an.info(ie.YOg+" preset turn "+x)}}return!0},o.prototype.sendRestartIce=function(e,t){var n=this;this.an.info("zc.p.1.srsi call: "+e+" "+t),this.Kd.sendRestartIce(e,t).then(function(r){n.an.info("zc.p.1.srsi result "+JSON.stringify(r))}).catch(function(r){n.an.warn("zc.p.1.srsi fail: "+JSON.stringify(r))})},o.prototype.ep=function(e,t,n){if(this.an.info(ie.z_2+" received "+n.event),!this.isProbe){var r=this.cr.createSpan(E.t0.H,{key:vp,par:this.va},{key:""},k.Mw.event);r.setAttributes({event_state:k.Mw.event_state(n.event),webrtc_sid:t}),r.end()}(this.zm.first||e>this.zm.seq)&&this.onPlayBFrameEvent(!1),n.event===0?this.onPlayStreamEnd(!1):n.event===1&&this.onPlayStreamEnd(!0)},o.prototype.gv=function(e,t,n){var r=n.clientip||n.client_ip;this.pn.clientIP!==r&&this.an.info(ie.Q4y+" client ip changed "+this.pn.clientIP+" "+r),this.pn.clientIP=r,this.Id=n.peer_id,this.Kd.peerId=n.peer_id,this.Dd=r,this.pn.isMultiOuter=this.isMultiOuter(),this.onGetIP(),this.isProbe&&this.ed==5&&this.Kd.sendNetProbeReq(function(){},function(){}),this.wm=!0},o.prototype.onGetIP=function(){},o.prototype.rp=function(e,t,n){var r=0,i=n.lossrate,s=n.rtt;(this.Id!==n.peer_id&&!this.isProbeByDG||(0,R.TE)(i)||(0,R.TE)(s))&&(this.an.info(ie.aww+" local peerID:"+this.Id+" remote peerID:"+n.peer_id+" lossrate:"+i+" rtt:"+s),r=1),this.onRecvNetQuality&&this.onRecvNetQuality(r,i,s)},o.prototype.sp=function(e,t,n){this.an.info(ie.JFd+" call: "+t),this.onRecvNetQualityGrade&&this.onRecvNetQualityGrade(n)},o.prototype.Vm=function(e){var t,n=this;if(this.an.info(ie.u7D+" called"),e.candidate!=null){this.an.info(ie.u7D+" candidate "+e.candidate.candidate+" state "+this.state+" autotcp "+this.Ld),e.candidate.candidate&&Ar((t=e.candidate.candidate.split(" "))===null||t===void 0?void 0:t[4])===Y.IPv6&&(this.Ld&&(this.an.info("".concat(ie.u7D," can len ").concat(this.Ol.length)),this.Ol.forEach(function(i){var s;(s=n.Xl)===null||s===void 0||s.addIceCandidate(new RTCIceCandidate(i)).then(function(){n.an.info("".concat(ie.u7D," add can suc"))}).catch(function(c){n.an.info("".concat(ie.u7D," add can fail, ").concat(c.message))})})),this.gn.isCandidateHasIPv6=!0);var r=function(i){n.jv([{candidate:i.candidate.candidate,sdpMid:i.candidate.sdpMid,sdpMLineIndex:i.candidate.sdpMLineIndex}])};this.Ld?r(e):this.state<5||this.state==7?(this.an.info(ie.u7D+" cached"),this.Hl.push({candidate:e.candidate.candidate,sdpMid:e.candidate.sdpMid,sdpMLineIndex:e.candidate.sdpMLineIndex})):(this.an.info(ie.u7D+" send"),r(e))}},o.prototype.Qm=function(e){this.an.info(ie.cDv+" called "+e.target.signalingState),this.state!=7&&this.Xl!=null&&e.target.signalingState==="closed"&&(this.ed=7,this.op(this.Xl.iceConnectionState))},o.prototype.Ym=function(e){var t=this;if(this.state!=7&&this.Xl!=null){this.an.info(ie.W0Q+" stateChanged "+this.Xl.iceConnectionState);var n=this.getSpan(k.CK.event,this.Pm,this.playingEvent);if(n&&n.setAttributes({ice_state:k.CK.ice_state(this.Xl.iceConnectionState)}),this.Xl.iceConnectionState==="connected"){if(this.ed=5,this.isProbe&&this.Od&&(this.wm||this.isProbeByDG))return this.Kd.sendNetProbeReq(function(){},function(){}),void this.onCanStopNegaTimer();if(this.onCanStopNegaTimer(),this.cv!=null&&(clearTimeout(this.cv),this.cv=null),!this.isProbe&&this.jd){var r=new Date().getTime()-this.jd;this.tv.setAttributes({play_begin_time:gp.play_begin_time(r)}),this.jd=0}if(this.cr.spanEnd({key:k.F.event,par:this.va},{webrtc_sid:this.Df}),this.zd){var i=new Date().getTime()-this.zd;this.an.info(ie.W0Q+" ice time "+i)}this.isProbe||this.state==6||(this.onPlayStateUpdate&&this.onPlayStateUpdate(E.h7.start,this.va,{code:0,message:""},!0),this.getRemoteStreamSuc&&(this.getRemoteStreamSuc(this.pm.resourceMode==E.qP.DG?null:this.playStream),this.getRemoteStreamSuc=null)),this.state=6,this.resetIceInfos(),this.resetNat64Infos();var s=new Date().getTime()-this.zd;this.onIceConnected&&this.onIceConnected(this.sessionId,s),this.an.info(ie.W0Q+" stateNego:iceConnected"),this.Bd||(this.gn.udpFailNum=0)}else if(this.Xl.iceConnectionState==="closed")n==null||n.end(),this.ed=7,this.op(this.Xl.iceConnectionState);else if(this.Xl.iceConnectionState==="failed")n==null||n.end(),this.ed=8,this.op(this.Xl.iceConnectionState);else if(this.Xl.iceConnectionState==="disconnected"){n==null||n.end(),this.ed=6,this.an.warn(ie.W0Q+" ice disconnected");var c=this.gn.lastChangeIpTime;c&&Date.now()-c<15e3?this.onPlayStateUpdateError(ti.Xn):this.cv||(this.cv=setTimeout(function(){t.op("disconnected")},15e3))}}},o.prototype.Km=function(e){var t,n;this.an.info(ie.fjj+" connectionChanged "+((t=this.Xl)===null||t===void 0?void 0:t.connectionState)),((n=this.Xl)===null||n===void 0?void 0:n.connectionState)==="connected"&&this.onPeerConnected&&this.onPeerConnected(this.sessionId,new Date().getTime()-this.zd)},o.prototype.op=function(e){this.an.info(ie.W0Q+"  state "+this.state+" connectionState "+e),this.onPlayStateUpdateError(ti.Xn)},o.prototype.close=function(e){this.an.info(ie.ruA+" close peer, reason: "+e),this.state=7,this.bm=!1,this.wm=!1,this.closeSession(e),this.Xl!=null&&(this.Xl.close(),this.Xl=null),this.nv&&(this.nv=null),this.ev&&(this.ev=null),this.resetIceInfos(),this.resetNat64Infos(),this.Dd="",this.Hd=void 0;var t=this.seiWorker;t&&t.removeEventListener("message",this.ou.seiMessage),this.onCanStopNegaTimer(),this.cv!=null&&(clearTimeout(this.cv),this.cv=null),this.hv&&(clearTimeout(this.hv),this.hv=null),this.stopVideocTimer(),this.up(),this.Kd.reset(),this.lv=0,this.np=0,this.zm.first=!0},o.prototype.stopPlay=function(){this.retryFailGwNodes=[],this.retryFailIpV4Nodes=[],this.retryFailIpV6Nodes=[]},o.prototype.mv=function(e,t,n){this.an.info(ie.E_I+" received ");var r=this.getSpan(k.$9.event,this.playingEvent);if(r&&r.end(),t==this.Df){var i={code:ti.Ie.code,message:"server session reset "+n.reason};this.onCanStopNegaTimer(),this.onPlayStateUpdateError(i)}else this.an.info(ie.E_I+" cannot find session")},o.prototype.vv=function(e,t,n){this.an.info(ie.hkn+" "+JSON.stringify(n)),this.cr.spanSetAttributes({key:this.playingEvent,par:this.va},{denied_info:k.er.denied_info(n.err_info),stop_reason:k.er.stop_reason("DenyStop")});var r=n.err_info?JSON.parse(n.err_info.toLowerCase()):{},i=r.action?r.action:null,s=1*n.reason,c=!([4,8,10,11,12,14,24,26,27,28,32].includes(s)||[2,3,4,5,6].includes(i));(r==null?void 0:r.err)===1004&&this.Wm()&&(c=!0);var u=vo({},c&&(r==null?void 0:r.err)===1004?this.pn.isFlutter?Et.LBO:ti.ke:c?Et.YDn:ti.Ie);(r==null?void 0:r.err)===1011&&(u=vo({},Et._5H)),u.message+=" reason:".concat(s," ").concat(i?" action:"+i:""," ").concat(r!=null&&r.err?" err:"+(r==null?void 0:r.err):""),u.message+=";".concat(Zd(s,i,r==null?void 0:r.err)),this.onCanStopNegaTimer();var l=!1;if(!this.Bd){if([8,10].includes(s)||[18,15].includes(s)&&i===2&&[3001,3002].includes(r.err)){this.gn.udpFailNum++;var a=this.gn;a.autoSwitchProtocol&&a.udpFailNum>=a.maxUdpFailNum&&(this.Od=!1,this.gn.setIsPeer(!1),l=!0)}else this.gn.udpFailNum=0;var h=this.gn.isNodeLast(this).lastTryNext,m=[3001,3002,3003,3004,3005,3006,3007,3008].includes(r.err);h&&m&&(this.an.info(ie.hkn+" switch tcp by all fail"),this.pn.turnToTcp=!0,this.Ld=!1,this.Od=!1,this.gn.setIsPeer(!1))}this.onPlayStateUpdateError(u,c,r,l)},o.prototype.Wm=function(){var e=Date.now(),t=this.pn.streamRetryTime,n=this.km;if(n){if(e-n>1e3*t)return this.km=0,this.an.info("zc.p.ctest.1 "+" stream not found. retry over time: ".concat(t,"s")),!0}else this.km=e;return!1},o.prototype.ap=function(e,t,n){n===void 0&&(n=!1),this.onRecvStreamStatus&&this.onRecvStreamStatus(t.camera_status,t.mic_status,n),this.an.info(ie.dw7+" call success")},o.prototype.Zm=function(e,t){var n,r,i=this;if(this.an.info(ie.Nw2+" called "+e),e){this.cp(t),this.xd.isSEIStart&&_t()&&(t.track.kind==="video"?this.hp(t):t.track.kind==="audio"&&this.fp(t)),this.onRecvRemoteStream&&this.onRecvRemoteStream(e),this.remoteStream=e;var s=(n=this.room.streamList)===null||n===void 0?void 0:n.find(function(u){return u.stream_id===i.va}),c=((r=s==null?void 0:s.stream_attr_opts)===null||r===void 0?void 0:r.stream_codec)===3;this.getVideoCodec(c),this._m&&this.ap(this.lp,this.dp,!0)}else this.an.warn(ie.Nw2+" remote stream is empty")},o.prototype.cp=function(e){var t,n=0,r=0,i=this.pm.jitterBufferTarget,s=this.pm.playoutDelayHint;if((0,R.Cs)(i)&&i>0&&i<=4e3?(r=i,n=i/1e3):(0,R.Cs)(s)&&s>0&&s<=4&&(r=1e3*n,n=s),(0,R.dd)(this.pm.enableLowLatency)&&this.pm.enableLowLatency&&(n=0,r=0),r>0&&e)try{var c=(t=e==null?void 0:e.track)===null||t===void 0?void 0:t.kind;this.an.info(ie.Nw2+" ".concat(c," playoutDelayHint: ").concat(r,", origin delay: ").concat(e.playoutDelayHint," | ").concat(e.jitterBufferTarget)),e.playoutDelayHint=n,e.jitterBufferTarget=r,this.an.info(ie.Nw2+" ".concat(c," playoutDelayHint result: ").concat(e.playoutDelayHint," | ").concat(e.jitterBufferTarget))}catch(u){this.an.warn(ie.Nw2+" set playoutDelayHint failed. ".concat(u))}},o.prototype.hp=function(e){var t=this.createSEIWorker();t&&t.addEventListener("message",this.ou.seiMessage);var n=this.xd,r={cmd:"decode",streamID:this.va,emulationPreventionByte:this.pn.seiConfig.emulationPreventionByte,codec:this.Sm,unregisterSeiFilter:n.unregisterSeiFilter,filterSize:n.filterSize};if(window.RTCRtpScriptTransform)e.transform=new RTCRtpScriptTransform(t,r);else{var i=e.createEncodedStreams(),s=i.readable,c=i.writable,u=!t;try{t&&t.postMessage(vo({readable:s,writable:c},r),[s,c])}catch{u=!0}if(u){this.an.warn("zc.cvrt The current browser version is too low.");var l=new TransformStream({transform:this.decodeVideoFrame});this.receiverStreams=i,s.pipeThrough(l).pipeTo(c),this.gn.handleSeiRollBack()}}},o.prototype.fp=function(e){var t={cmd:"decode",streamID:this.va,kind:"audio"},n=this.createSEIWorker();if(window.RTCRtpScriptTransform)e.transform=new RTCRtpScriptTransform(n,t);else{var r=e.createEncodedStreams(),i=r.readable,s=r.writable,c=!n;try{n&&n.postMessage(vo({readable:i,writable:s},t),[i,s])}catch{c=!0}if(c){this.an.warn("zc.cart The current browser version is too low.");var u=new TransformStream({transform:this.decodeAudioFrame});i.pipeThrough(u).pipeTo(s),this.gn.handleSeiRollBack()}}},o.prototype.jv=function(e){var t=this;if(this.an.info(ie.UY3+" called"),!(e=e.filter(function(r){return!!(r&&r.candidate.indexOf("relay")>0)}))||e.length<1)this.an.info(ie.UY3+" cancelled");else{var n=this.getSpan(k.vB.event,this.Pm);n&&n.setAttributes({candidate_info:k.vB.candidate_info(e)}),this.ed!==5&&(this.ed=4),this.an.info(ie.UY3+" stateNego:sendCandidate"),this.Kd.sendCandidateInfo(e,function(r,i,s){t.an.debug(ie.UY3+" send success"),n&&n.end()},function(r,i){t.an.error(ie.UY3+" failed to send: "+r.toString()),n&&t.cr.setError(n,{code:ti.te.code,message:r.toString()}),t.onPlayStateUpdateError(ti.te)})}},o.prototype.resetPushCmdSeqMap=function(){var e;this.qd=((e={}).StreamStatusNotifyPush={seq:-1,time:0},e.PlayEventPush={seq:-1,time:0},e.ClientInfoPush={seq:-1,time:0},e.NetQualityInfoPush={seq:-1,time:0},e)},o.prototype.Um=function(e,t,n,r){return{playError:1,error:e,stopRetry:t,detail:n,startFromFirst:r}},o.prototype.onPlayQualityUpdate=function(e,t){},o.prototype.getCameraMicStatus=function(e){return e==0?"OPEN":"MUTE"},o.prototype.onReceivedDataChannel=function(e){switch(new Uint8Array(e.data,0,1)[0]){case ya.Signal:this.Kd.onDataChannelMessage(e.data);break;case ya.UserData:this.onUserData(e.data)}},o.prototype.onUserData=function(e){var t,n,r=this,i=new Uint8Array(e,0,10),s=e.byteLength-10,c=new Uint8Array(e,10,s),u=i[1],l=i[2]<<8|i[3],a=i[4]<<8|i[5],h=new Date().getTime();if(this.Im.Rm&&(this.Im.Tm[0]=l==a?l:a,this.Im.Rm=!1),this.Im.Cm.push({sn:l,sn0:a,recv_ts:h,flags:u,payload_len:s,payloadArray:c}),this.Im.Cm.sort(this.compareShort),l==this.Im.Tm[0]){var m=this.Im.Cm.filter(function(ke){return ke.sn0==a});if(m.sort(this.compareShort),m.find(function(ke){return 1&ke.flags})!=null&&m.length==this.compareShort(l,a)+1){for(var S=0,x=new ArrayBuffer(65536),q=0;q<m.length;q++)new Uint8Array(x).set(m[q].payloadArray,S),S+=m[q].payload_len;(t=this.onDataChannelList)===null||t===void 0||t.forEach(function(ke){ke(x,S,r.va)}),this.Im.Cm=[],this.Im.Rm=!0}this.Im.Tm[0]++}else for(var V=function(){var ke=_e.Im.Cm.filter(function(tt){return tt.sn0==r.Im.Cm[0].sn0});if(ke.sort(_e.compareShort),ke.find(function(tt){return 1&tt.flags})!=null&&ke.length==_e.compareShort(ke[ke.length-1].sn,ke[0].sn0)+1){for(var Pe=0,Oe=new ArrayBuffer(65536),Ge=0;Ge<ke.length;Ge++)new Uint8Array(Oe).set(ke[Ge].payloadArray,Pe),Pe+=ke[Ge].payload_len;_e.Im.Tm[0]=ke[0].sn0+ke.length,(n=_e.onDataChannelList)===null||n===void 0||n.forEach(function(tt){tt(Oe,Pe,r.va)}),_e.Im.Cm=[],_e.Im.Rm=!0}else if(h-ke[0].ts<4e3){var Je=ke[0].sn0;for(Ge=0;Ge<ke.length&&Je==ke[Ge].sn;Ge++)Je++;return _e.Im.Tm[0]=Je,"break"}for(Ge=0;Ge<ke.length;Ge++)_e.Im.Cm.shift()},_e=this;this.Im.Cm.length>0&&V()!=="break";);},o.prototype.compareShort=function(e,t){var n=new Uint16Array(1);n[0]=e-t;var r=new Int16Array(1);return r[0]=n[0],r[0]},o.prototype.updVidCodec=function(){var e=this.seiWorker;e&&e.postMessage({cmd:"updatePlayer",codec:this.Sm,streamID:this.va})},o.prototype.getVideoCodec=function(e){var t=this;if(e===void 0&&(e=!1),this.Xl&&(this.Xl.getStats().then(function(n){n.forEach(function(r){if(r.type==="inbound-rtp"&&r.kind==="video"&&r.codecId){var i=n.get(r.codecId).mimeType.toLowerCase();i.indexOf("h264")>-1?t.Sm="H264":i.indexOf("vp8")>-1?(t.Sm="VP8",t.xd.isSEIStart&&t.an.error(ie.MDS+" video code VP8 is not support SEI"),t.updVidCodec()):i.indexOf("h265")>-1&&(t.Sm="H265",t.updVidCodec())}})}),this.Em++,this.Sm||this.Em>=20))return e&&this.Sm===""&&(this.Sm="H265",this.updVidCodec()),void this.stopVideocTimer();this.stopVideocTimer(),this.vp=setTimeout(function(){t.getVideoCodec(e)},100)},o.prototype.stopVideocTimer=function(){this.vp&&(clearTimeout(this.vp),this.vp=null)},o.prototype.isMultiOuter=function(){return!(!this.pn.accessClientIp||!this.Dd||this.pn.accessClientIp===this.Dd)},o.prototype.getSpan=function(e,t,n,r){if(r===void 0&&(r=!1),this.isProbe)return null;var i=(0,te.fU)(this.cr,E.t0.H,this.va,e,t,n,r);return i.setAttribute("is_mini",this.$u),i},o.prototype.setTurnTcp=function(){this.Bd=this.pn.turnToTcp,this.pn.turnOverTcpOnly!==void 0&&(this.Bd=this.pn.turnOverTcpOnly)},o.prototype.dv=function(){var e=this,t=performance.now();this.Kd.registerPushCallback("CloseSessionPush",function(n,r,i){if(t){var s=(performance.now()-t).toFixed(0);t=void 0,e.an.info(ie.hkn+" ".concat(e.va,", cmd: CloseSessionPush, cost_time: ").concat(s))}i.reason===32&&(e.$u=!1,e.pn.$u=!1,e.Jl=performance.now()-e.Fl),e.vv(n,r,i)}),this.Kd.registerPushCallback("SessionResetPush",function(n,r,i){e.mv(n,r,i)}),this.Kd.registerPushCallback("StreamStatusNotifyPush",function(n,r,i){e.ap(n,i)}),this.Kd.registerPushCallback("PlayEventPush",function(n,r,i){e.ep(n,r,i)}),this.Kd.registerPushCallback("ClientInfoPush",function(n,r,i){e.gv(n,r,i)}),this.Kd.registerPushCallback("NetQualityInfoPush",function(n,r,i){e.rp(n,r,i)}),this.Kd.registerPushCallback("net_quality_grade_push",function(n,r,i){e.sp(n,r,i)}),this.Kd.registerPushCallback("codec_error_notify",function(n,r,i){e.mp(n,i.media_type,i.error_type)}),this.Kd.registerPushCallback("play_net_stat_notify",function(n,r,i){e.onGwPlayNetState({audioTXBitrate:i.audio_tx_bitrate,videoTXBitrate:i.video_tx_bitrate,videoRedRate:i.video_red_rate,trafficControlStat:i.traffic_control_stat,trafficControlBW:i.traffic_control_bandwidth})})},o.prototype.up=function(){this.Kd.unregisterPushCallback("CloseSessionPush"),this.Kd.unregisterPushCallback("SessionResetPush"),this.Kd.unregisterPushCallback("PlayEventPush"),this.Kd.unregisterPushCallback("ClientInfoPush"),this.Kd.unregisterPushCallback("NetQualityInfoPush"),this.Kd.unregisterPushCallback("StreamStatusNotifyPush")},o.prototype.mp=function(e,t,n){if(n!==0){var r=t?"video":"audio",i=ie.Kw2+" ".concat(r," codec error: ").concat(n,",  codec: ").concat(this.Sm," ; ");if(n===1){if(i+="remove ".concat(r," track."),!this.isProbe&&this.state===6){var s=E.h7.start;this.pm.transcodeOnDecodeFail&&t===1&&!this.ym?(s=E.h7.error,this.ym=Et.H6b.code,this.onPlayStateUpdateError(Et.H6b,!1,void 0,!0)):this.onPlayStateUpdate&&this.onPlayStateUpdate(s,this.va,{code:Et.H6b.code,message:"browser dose not support current ".concat(r," codec")},!0)}}else n===3&&((this.zm.first||e>this.zm.seq)&&(this.zm.first=!1,this.zm.seq=e),this.onPlayBFrameEvent&&this.onPlayBFrameEvent(!0),this.onPlayStateUpdate&&this.onPlayStateUpdate(E.h7.start,this.va,{code:Et.rV9.code,message:"B-frame is detected in the bitstream"},!0));this.an.warn(i)}},o.prototype.sendBroadcasterStatus=function(e){this.Kd.sendBroadcasterStatus(e)},o.prototype.ActivatePlayAudioStream=function(e,t,n){this.Kd.ActivatePlayAudioStream(e,t,n)},o.prototype.ActivatePlayVideoStream=function(e,t,n){this.Kd.ActivatePlayVideoStream(e,t,n)},o.prototype.sendPlayStats=function(e){return this.Kd.sendPlayStats(e)},Object.defineProperty(o.prototype,"gwVersion",{get:function(){return this.Kd.gwVersion},enumerable:!1,configurable:!0}),o.prototype.getP2PNetStats=function(e,t){this.Kd.getP2PNetStats(e,t)},o.prototype.closeSession=function(e){var t,n;(t=this.Wd)===null||t===void 0||t.off("uaConnected",this.ou.onUaSocketConnected),this.resetPushCmdSeqMap(),this.Wl&&(this.Kd.sendCloseSession(e),(n=this.Wd)===null||n===void 0||n.removeSession(this.Df),this.Wl=!1)},o.prototype.dispatchGwNodes=function(e,t,n){var r=this,i=this.va;this.gn.testEnvironment==1&&(i="zegotest-"+this.gn.appid+"-"+this.va);var s=e;s===N.IPv6Prefer&&!this.Al&&this.Xd&&(s=N.IPv4Prefer);var c=this.getTransCodec(i),u=c.transCodecID,l=c.transCodecSuffix;i=c.transCodecStreamID;var a=this.vm===E.ey.RTC?k.KG.event:k.AJ.event,h=this.getSpan(a,a);h==null||h.setAttributes({ip_mode:e}),this.Kd.dispatchGwNodes({type:1,streamID:i,transCodecID:u,transCodecSuffix:l,geo:{type:this.gn.geo.type,areaList:this.gn.geo.areaList},ipV6Prefer:s},function(m,S,x){qa(x),h&&(0,te.lA)(h,{gw_nodes:x.gw_nodes,ip_infos:x.ips,ip_v6_infos:x.ipv6s}),t&&t(x)},function(m,S){h&&r.cr.setError(h,m),n&&n(m)})},o.prototype.getTransCodec=function(e){var t,n,r,i,s,c=(this.pn.appConfig||{}).media_config,u=e,l=!1,a=((t=this.pm)===null||t===void 0?void 0:t.codecTemplateID)!==void 0&&((n=c==null?void 0:c.play_config)===null||n===void 0?void 0:n.enable_codec_template)===1;return this.pm.transcodeOnDecodeFail?(l=!!this.ym)&&(i=a?this.pm.codecTemplateID:0):(l=a)&&(i=this.pm.codecTemplateID),l&&(u=e+(s=(0,te.yo)(i,(r=c.play_config)===null||r===void 0?void 0:r.codec_template_postfix_pattern))),{transCodecStreamID:u,enableTransCodec:l,transCodecID:i,transCodecSuffix:s}},o.prototype.parseRemoteMiniSdp=function(e){return Co(this,void 0,void 0,function(){var t,n,r;return wo(this,function(i){switch(i.label){case 0:if(!(this.$u&&(0,R.G0)(e.mini_sdp)&&e.mini_sdp.byteLength>0))return[3,5];n=performance.now(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.Yd.parseMiniSdp(e.mini_sdp)];case 2:return t=i.sent(),this.Gl=performance.now()-n,[3,4];case 3:throw r=i.sent(),this.$u=!1,this.pn.$u=!1,this.Gl=performance.now()-n,this.Jl=performance.now()-this.Fl,this.Ll=3,this.Um(r);case 4:return[3,6];case 5:(0,R.QP)(e==null?void 0:e.sdp)&&(e!=null&&e.sdp)&&(t=e.sdp),i.label=6;case 6:return[2,t]}})})},o.prototype.reportMiniSdpInfos=function(e){var t={};(this.$u||this.Ll)&&(t.mini_error=this.Ll,t.code_sdp_consume=+this.Ul.toFixed(0),t.decode_sdp_consume=+this.Gl.toFixed(0),this.Ll=0,this.Ul=0,this.Gl=0),this.cr.spanSetAttributes({key:e,par:this.va},vo({},t))},o.prototype.resetMiniReportInfos=function(){this.Jl=0,this.Fl=0},o.prototype.setPlayStreamVideoType=function(e){return Co(this,void 0,void 0,function(){return wo(this,function(t){return[2,this.Kd.subscribeVideoStream(e)]})})},o}(),es=k.zF,Sp=k.Nr.event,Tp=function(){function o(e,t,n,r,i){var s=this;this.Bv=e,this.cr=n,this.gn=r,this.pn=i,this.pp=0,this.cdnPlayTime=0,this.state=7,this.sendTransCodecCmd=function(c,u){if(c===void 0&&(c=0),u=u||s.gp){var l=u.streamID,a=u.playAddr,h=u.codecTemplateID,m=u.codecSuffix;s.gp=u;var S=s.Bv.room.streamHandler.notifySdkNeedStream(l,{playAddr:a,transCodecID:h,transCodecSuffix:m,retry:c},function(x,q){s.an.info("zsc.pc.1 notify trans codec success"),s.bp=Date.now()},function(x,q){if(s.an.error("zsc.pc.1 notify trans codec err:"+x.code+" "+x.message),(q==null?void 0:q.action)===2)return s._p||(s._p=setTimeout(function(){s._p=void 0,s.sendTransCodecCmd(c+1,u)},q.action_delay)),void s.gn.onPlayStateUpdate(E.h7.retry,l,{code:x.code,message:x.message},{isCDN:!0});s.gn.onPlayStateUpdate(E.h7.error,l,Et.T_8,{isCDN:!0})});s.wp=S}},this.an=ei(t,this.streamID)}return Object.defineProperty(o.prototype,"zegoExpressPlayer",{get:function(){return this.Sp(this.cdnPlayer)?this.cdnPlayer:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"zegoCdnPlayer",{get:function(){return this.Sp(this.cdnPlayer)?void 0:this.cdnPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"streamID",{get:function(){return this.Bv.streamId},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Ep",{get:function(){return this.Bv.playMode==E.ey.CDN},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"dm",{get:function(){return this.Bv.dm},enumerable:!1,configurable:!0}),o.prototype.playCDN=function(e,t){var n,r,i,s,c,u,l=this;this.setCdnState(0);var a=this.streamID,h=this.Bv,m=h.playOption;h.$h&&((n=h.$h)===null||n===void 0||n.end()),h.$h=(0,te.fU)(this.cr,Te.t0.H,a,h.playStartEvent,Sp,void 0,!0);var S=function(Sn,Qt){var Wt;h.$h&&((0,te.lA)(h.$h,{url:es.url(l.cdnUrl),ip:es.ip(h.ip),source_type:es.source_type(h.playMode),net_protocol:es.net_protocol("tcp"),tryidx:es.tryidx(h.tryidx)}),h.$h=void 0),(Wt=l.dm)===null||Wt===void 0||Wt.setAttributes({stop_reason:k.V0.stop_reason(Sn)}),t&&t(Qt)},x=this.cdnPlayer,q=this.Sp(x);if(!q&&!m.CDNVideo)return this.an.error("zsc.pc.1 cdn video no found"),S("cdn video no found",Et.ann),!1;var V=(r=this.gn.getPlayRoom(a))===null||r===void 0?void 0:r.streamList.find(function(Sn){return Sn.stream_id==a}),_e=h.playOption.resourceMode;h.tryidx++,(i=this.dm)===null||i===void 0||i.setAttributes({tryidx:k.TW.tryidx(h.tryidx),biz_product:k.TW.biz_product(_e==E.qP.DG?1:0)});var ke=(this.pn.appConfig||{}).media_config,Pe=((s=ke==null?void 0:ke.play_config)===null||s===void 0?void 0:s.enable_codec_template)===1&&(m==null?void 0:m.codecTemplateID)!==void 0&&!m.transcodeOnDecodeFail,Oe=a,Ge="";Pe&&(Oe+=Ge=(0,te.yo)(m.codecTemplateID,(c=ke.play_config)===null||c===void 0?void 0:c.codec_template_postfix_pattern));var Je=V||{},tt=Je.urls_flv,ut=Je.urls_m3u8;if(!V||!tt||!ut){if(!this.pn.appConfig)return this.an.error("zsc.pss.1 stream info no found"),S("stream info no found",Et.cGQ),!1;var vt=this.kp(a),gt=vt.flv,Pt=vt.hls;tt=gt?[gt]:[],ut=Pt?[Pt]:[]}if(!h||!x)return S("no cdn player",Et.ann),!1;h.useResourceTypes.push(E.ey.CDN),h.useResourceTypes=Array.from(new Set(h.useResourceTypes));var wt=tt,At=ut,Vt=this.selectCDNSource(x,wt,At);if(!Vt&&!this.cdnUrl)return this.an.error("zsc.pc.1 can not find cdn urls"),S("cdn protocol not support.",Et.cGQ),!1;this.cdnUrl=Vt||this.cdnUrl;var qt=this.cdnUrl;if(Pe){qt=qt==null?void 0:qt.replace(a,Oe);var Gt=(!((u=this.cdnUrl)===null||u===void 0)&&u.endsWith(".m3u8")?At:wt)[0].split(a)[0];this.sendTransCodecCmd(0,{streamID:a,playAddr:Gt,codecTemplateID:m.codecTemplateID,codecSuffix:Ge})}return!!this.Ep&&(h.$h&&((0,te.lA)(h.$h,{url:es.url(this.cdnUrl),ip:es.ip(h.ip),source_type:es.source_type(h.playMode),net_protocol:es.net_protocol("tcp"),tryidx:es.tryidx(h.tryidx)}),h.$h=void 0),this.gn.onPlayStateUpdate(E.h7.start,a,{code:0,message:"success"},{isCDN:!0}),!q&&m.CDNVideo?(x.play(qt,m.CDNVideo),m.CDNVideo.srcObject=null,this.bindZegoCDNPlayerEvents(x,a,m)):(x.src=qt,x.play(),this.bindZegoExpressPlayerEvents(x,a,m)),e&&e(),!0)},o.prototype.retrySendTransCodecCmd=function(){this.bp&&Date.now()-this.bp>9e4&&(this.bp=void 0,this.sendTransCodecCmd(0))},o.prototype._clearTransCodecRetry=function(){var e,t;(e=this.wp)===null||e===void 0||e.invalid(),(t=this.wp)===null||t===void 0||t.stopMaxTime()},o.prototype.stopCDNPlayer=function(){this._p&&(clearTimeout(this._p),this._p=void 0),this._clearTransCodecRetry(),this.bp=void 0,this.cdnPlayer&&(this.an.info("zc.cph.stcp stop"),this.cdnPlayer.stop(),this.updateCDNValidTime(),this.setCdnState(7))},o.prototype.Sp=function(e){return!(!e||!e._extApi)},o.prototype.bindZegoExpressPlayerEvents=function(e,t,n){var r=this,i=this.Bv,s=!1;e._extApi.off("canplay"),e._extApi.on("canplay",function(){s||(r.an.info("zsc.pc.1 start playing cdn source"),s=!0,r.onCDNPlayerCanplay(t,n))});var c=null,u=0;e._extApi.off("error"),e._extApi.on("error",function(l){var a,h,m=l.code,S=l.msg;r.an.error("zsc.pc.1 error occur ".concat(m," ").concat(S)),[100003,100004,100005].includes(m)?(c&&(clearTimeout(c),c=null),u>3?(r.an.error("zsc.pc.1 retryCount ".concat(u," greater than ").concat(3,". end play cdn source")),r.updateCDNValidTime(),(a=r.dm)===null||a===void 0||a.setAttributes({stop_reason:k.V0.stop_reason(S)})):c=setTimeout(function(){u++,e.resume(),i.CDNBrokenCnt++},3e3)):m!==100006&&((h=r.dm)===null||h===void 0||h.setAttributes({stop_reason:k.V0.stop_reason(S)}),r.an.error("zsc.pc.1 stop play cdn source."))}),e._extApi.off("loaded"),e._extApi.on("loaded",function(){r.Ep&&i.state==6?i.CDNBrokenCnt++:(r.an.info("zsc.pc.1 ended play cdn"),r.updateCDNValidTime())}),e._extApi.off("netQualityScoreUpdate")},o.prototype.kp=function(e){var t,n,r,i=((t={})[E.qP.RTC]=1,t[E.qP.CDN]=0,t[E.qP.L3]=2,t),s=this.pn.appConfig.media_config.play_config.resource_info;if(s.length){var c=s.find(function(m){return m.resource_type==i[E.qP.CDN]});if(c)for(var u=0;u<c.service_info.length;u++){var l=c.service_info[u],a=l.protocol,h=l.url_template.replace("{STREAM_NAME}",e);switch(a){case E.Hb.FLV:n=h;break;case E.Hb.HLS:r=h}}}return{flv:n,hls:r}},o.prototype.onCDNPlayerCanplay=function(e,t){var n=this.Bv;if(n.state!=6&&(this.setCdnState(6),n.firstFrameTime==0)){n.firstFrameTime=Date.now()-n.beginTime;var r=this.cr.createSpan(Te.t0.H,{key:k.Nr.event,par:e},{key:""},k.x6.event);r.setAttributes({fft_consumed:k.x6.fft_consumed(n.firstFrameTime),biz_product:k.x6.biz_product(t.resourceMode==E.qP.DG?1:0)}),r.end()}this.cdnPlayTime==0&&this.Ep&&(this.cdnPlayTime=Date.now())},o.prototype.bindZegoCDNPlayerEvents=function(e,t,n){var r=this,i=this.Bv;e.onComplete=function(){if(r.Ep&&i.state==6)e.retry(),i.CDNBrokenCnt++;else var s=i.initPoster,c=i.initVideoStyle,u=i.playOption.CDNVideo,l=setTimeout(function(){clearTimeout(l),u&&u.setAttribute("style",c),u&&u.setAttribute("poster",s)},1e3);r.updateCDNValidTime()},e.onError=function(s){var c;r.pn.networkState==Te.D2.offline&&(e.canRetry=!1),(c=r.dm)===null||c===void 0||c.setAttributes({stop_reason:k.V0.stop_reason(s)}),r.updateCDNValidTime()},e.onCanplay=function(){r.onCDNPlayerCanplay(t,n)}},o.prototype.selectCDNSource=function(e,t,n){var r=this.Sp(e),i="",s=this.dm;if(r)i=t[0],s==null||s.setAttributes({protocol:k.V0.protocol("flv")});else if(e.isSupportFLV()&&(t==null?void 0:t.length)>0)i=t[0],s==null||s.setAttributes({protocol:k.V0.protocol("flv")});else if(e.isSupportHLS()&&(n==null?void 0:n.length)>0)i=n[0],s==null||s.setAttributes({protocol:k.V0.protocol("hls")});else if(!this.cdnUrl)return null;return i?i=i.replace("http://","https://"):null},o.prototype.updateCDNValidTime=function(){this.cdnPlayTime&&(this.pp+=Date.now()-this.cdnPlayTime,this.cdnPlayTime=0)},o.prototype.setCdnState=function(e){this.state=e},o.prototype.renderMediaStreamByCdnPlayer=function(e){var t=this,n="zc.cph.rbcp",r=this.Bv;this.an.info(n+" switch media webrtc success");var i=r.initPoster,s=r.initVideoStyle,c=r.playOption.CDNPlayer,u=r.playOption.CDNVideo,l=!!r.zegoExpressPlayer;if(this.pn.browser==="safari"&&!l&&u&&r._CDNPlayerClone){var a=u.parentElement;if(a){var h=te.VJ.createElement("style"),m=u.cloneNode(!0),S=Date.now().toString(16);h.innerText=".zego_cdn_video_".concat(S," .zego_clone_video_").concat(S,"{width:").concat(u.offsetWidth,"px;height:").concat(u.offsetHeight,"px;}")+".zego_cdn_video_".concat(S," .hide_").concat(S,"{display:none!important;width:0;height:0}"),te.VJ.head.append(h),m.classList.add("zego_clone_video_".concat(S)),m.id=r.streamId+"_clone",m.src="",m.srcObject=e,m.classList.add("hide_".concat(S)),u.before(m),a.classList.add("zego_cdn_video_".concat(S));var x=setTimeout(function(){clearTimeout(x),u.classList.add("hide_".concat(S)),m.classList.remove("hide_".concat(S))},2e3),q=setTimeout(function(){clearTimeout(q),r.playOption.CDNVideo=m,t.stopCDNPlayer(),a.classList.remove("zego_cdn_video_".concat(S)),u.classList.remove("zego_cdn_video_".concat(S)),m.classList.remove("zego_clone_video_".concat(S)),m.id=u.id,h.remove(),u.remove()},4e3)}}else if(this.stopCDNPlayer(),l&&e)this.an.info(n+" express player switch to play webrtc"),c._extApi.srcObject=e,c.play();else{var V=setTimeout(function(){clearTimeout(V),u&&u.setAttribute("style",s),u&&u.setAttribute("poster",i)},1e3);e&&u&&(u.srcObject=e)}},o}(),Ep=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),go=function(){return go=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},go.apply(this,arguments)},Cp=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},wp=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},no=k.Nr,Wu=k.Nr.event,Yl=k.Nr.error,mi=k.oW,qo=k.zF,uh=k.er.event,Ip=k.TW.event,Rp=k.V0.event;(function(o){o.beforePublish="beforePublish",o.publishing="publishing",o.afterPublish="afterPublish"})($o||($o={}));var kp=function(o){function e(t,n,r,i,s,c,u,l,a,h,m,S,x){var q,V=this;(V=o.call(this,n,t)||this).an=n,V.gn=u,V.ac=l,V.pn=a,V.room=h,V.streamSid=S,V.isDataChannel=x,V.Op=void 0,V.Ip=void 0,V.Rp=void 0,V.jl={state:"NO_PLAY",code:0},V.probedList=[],V.probeTime=0,V.probeTimer=null,V.probeNodeList=[],V.hasSucceed=!1,V.Tp=0,V.Ap=0,V.pulledTimeStamp=0,V.firstPulledTimeStamp=0,V.zp=0,V.Dp=0,V.CDNBrokenCnt=0,V.serverUrl=bs,V.isCenterNode=!0,V._state=7,V.lastState=7,V.broadcasterStatus=E.ku.stop,V.isExternal=!1,V.reportPlayStateTime=0,V.streamInRoom=!0,V.playStartTime=0,V.Np=0,V.Rd=0,V.Td=0,V.poorQualityRetryCnt=0,V.Cd=[],V.continuousFailCnt=0,V.Pp=0,V.remoteStream=null,V.playStream=null,V.rtcViewer=null,V.pm={},V.Mp={video:!0,audio:!0,expireTime:0},V.isServerMuteVideo=!1,V.isServerMuteAudio=!1,V.jp=null,V.av=null,V.rd=25e3,V.cameraStatus=0,V.micStatus=0,V.soundLevel=0,V.mic=null,V.beginTime=0,V.firstFrameTime=0,V.playMode=E.ey.RTC,V.Od=!0,V.isProbe=!1,V.Id=0,V.initPoster="",V.initVideoStyle="",V.firstPlay=!0,V.isProbeByDG=!1,V.useResourceTypes=[],V.tryidx=0,V._CDNPlayerClone=null,V.signalTime=0,V.stopReason="",V.ql=!1,V.probeQuality=0,V.ip="",V.port=0,V.audioMuteState="0",V.videoMuteState="0",V.qp=null,V.Lp=0,V.Bp="",V.Up=0,V.Gp=0,V.Jp=$o.beforePublish,V.soundMeterWorklet=null,V.Fp=!1,V.Hp={},V.isProbe||(V.Vp=(0,te.fU)(V.cr,E.t0.I,t,Wu,Cn.event,void 0,!0)),V.id=In("".concat(u.appid,"_").concat(a.idName,"_").concat(t,"_").concat(Date.now(),"_").concat((0,E.Mo)())),V.beginTime=Date.now(),V.va=t,r&&V.setSignal(r),V.dataReport=i,V.qualityHandler=new hp(s,c,V,V.an,V.dataReport,V.pn),V.qualityHandler.onRecvMediaData=function(){var ke;V.isProbe||!((ke=V.Qp)===null||ke===void 0)&&ke.streamNotFoundTime&&(V.Qp.streamNotFoundTime=0,V.info("zc.p.ormd.1 reset streamNotFoundTime"))},V.qualityHandler.onFindDecodeException=function(ke){var Pe,Oe;if(!V.isProbe){var Ge=(Pe=V.room.streamList)===null||Pe===void 0?void 0:Pe.find(function(tt){return tt.stream_id===V.va}),Je="zc.p.ofde.1 may fail to decode. v: ".concat(ke," , ").concat((Oe=Ge==null?void 0:Ge.stream_attr_opts)===null||Oe===void 0?void 0:Oe.stream_codec);V.playOption.transcodeOnDecodeFail&&V.Qp&&(V.au("transcode_on_zero_fps",!0)!==1||V.Qp.needTranscode||(Je+=" ; need transcode",V.Qp.needTranscode=Et.SCx.code,V.playStateUpdateError(Et.SCx,!1,void 0,!0))),V.warn(Je)}},V.qualityHandler.onPlayingError=function(ke){V.playStateUpdateError(ke)},V.playMediaStatus={video:!V.gn.defaultVideoMuted,audio:!V.gn.defaultAudioMuted},V.info("zc.p.1 set playMediaStatus ".concat(JSON.stringify(V.playMediaStatus))),V.Mm=V.au("resource_mode"),V.retryStreamHandler=new ch(V.streamId,V.an,V.pn,V.gn,!1),m&&(V.pm=m,m.CDNPlayer&&(V.getCDNHandler().cdnPlayer=m.CDNPlayer),V.initResourceMode(m.resourceMode)),V.initStreamReport();var _e=go(go({},m),{CDNVideo:void 0,CDNPlayer:void 0});return(q=V.Vp)===null||q===void 0||q.setAttributes({stream_id:no.stream_id(t),stream_sid:no.stream_sid(S),play_option:no.play_option(_e),video_codec_id:no.video_codec_id(m==null?void 0:m.videoCodec),use_na:no.use_na(1),biz_product:(m==null?void 0:m.resourceMode)==E.qP.DG?1:0,resource_mode:no.resource_mode(V.resourceMode),src:no.src(V.playMode),room_id:no.room_id(h==null?void 0:h.roomID),room_sid_string:no.room_sid_string(h==null?void 0:h.roomSessionID),is_multi:no.is_multi(V.pn.isMultiRoom)}),V}return Ep(e,o),Object.defineProperty(e.prototype,"zegoPeer",{get:function(){return this.Qp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Qp",{get:function(){var t=void 0;switch(this.playMode){case E.ey.RTC:t=this.Op;break;case E.ey.L3:t=this.Ip}return t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"peerConnection",{get:function(){var t;return(t=this.Qp)===null||t===void 0?void 0:t.peerConnection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"signal",{get:function(){var t;return(t=this.Qp)===null||t===void 0?void 0:t.signal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curCBState",{get:function(){return this.jl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pp",{get:function(){var t;return((t=this.Rp)===null||t===void 0?void 0:t.pp)||0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"streamConnectIP",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.streamConnectIP)||""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zegoExpressPlayer",{get:function(){var t;return(t=this.Rp)===null||t===void 0?void 0:t.zegoExpressPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zegoCdnPlayer",{get:function(){var t;return(t=this.Rp)===null||t===void 0?void 0:t.zegoCdnPlayer},enumerable:!1,configurable:!0}),e.prototype.updateCBState=function(t){var n=this,r=Object.keys(t).some(function(i){return t[i]!==n.jl[i]});return r&&(this.jl=t),r},Object.defineProperty(e.prototype,"state",{get:function(){var t;return this.playMode==E.ey.CDN?this.Rp?this.Rp.state:7:((t=this.Qp)===null||t===void 0?void 0:t._state)===void 0?7:this.Qp._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"streamId",{get:function(){return this.va},set:function(t){this.va=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.sessionId)||0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playOption",{get:function(){return this.pm},set:function(t){this.pm=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stateNego",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.stateNego)||0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resourceMode",{get:function(){return this.Mm},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gwNode",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.gwNode)||""},set:function(t){this.Qp&&(this.Qp.gwNode=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gwNodeList",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.gwNodeList)||[]},set:function(t){this.Qp&&(this.Qp.gwNodeList=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gwNodesTTL",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.gwNodesTTL)||0},set:function(t){this.Qp&&(this.Qp.gwNodesTTL=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isNodesEmpty",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.isNodesEmpty)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ipNodeType",{get:function(){var t;return this.Qp?(t=this.Qp)===null||t===void 0?void 0:t.ipNodeType:A.ZV4Priority},set:function(t){this.Qp&&(this.Qp.ipNodeType=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ipV6Prefer",{get:function(){var t;return this.Qp?(t=this.Qp)===null||t===void 0?void 0:t.ipV6Prefer:1},set:function(t){this.Qp&&(this.Qp.ipV6Prefer=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPeer",{get:function(){return this.Od},set:function(t){this.Od=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"peerID",{get:function(){return this.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retryFailGwNodes",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.retryFailGwNodes)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retryFailIpV4Nodes",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.retryFailIpV4Nodes)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"retryFailIpV6Nodes",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.retryFailIpV6Nodes)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ipV4NodeList",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.ipV4NodeList)||[]},set:function(t){this.Qp&&(this.Qp.ipV4NodeList=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ipV6NodeList",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.ipV6NodeList)||[]},set:function(t){this.Qp&&(this.Qp.ipV6NodeList=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ipNode",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.ipNode)||null},set:function(t){this.Qp&&t&&(this.Qp.ipNode=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStreaming",{get:function(){return this.state===6},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"probeState",{get:function(){return this.qualityHandler.probeState},set:function(t){this.qualityHandler.probeState=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"qualityGrade",{get:function(){var t=this.qualityHandler.Wh;return Math.max(t.video.videoQuality,t.audio.audioQuality)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"netQuality",{get:function(){return this.qualityHandler.hf},set:function(t){this.qualityHandler.hf=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastPlayStats",{get:function(){return this.qualityHandler.Uv},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStateRetry",{get:function(){return[0,7,8].includes(this.stateNego)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iceStateDisConnect",{get:function(){return[7,6,8].includes(this.stateNego)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLastConnected",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.lastState)===6},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playStat",{get:function(){return this.qualityHandler.playStat},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webrtcProtocol",{get:function(){return this.qualityHandler.df},enumerable:!1,configurable:!0}),e.prototype.changePlayMode=function(t){var n,r,i=this,s="zc.ply.cpm",c=this.playMode;if(t!==c){this.info(s+" change mode "+t);var u=(0,te.fU)(this.cr,E.t0.H,this.streamId,k.AW.event,k.Nr.event);(0,te.lA)(u,{src:k.AW.src(t),last_src:k.AW.last_src(c)});var l=!1;t!==E.ey.CDN&&c!==E.ey.CDN||(l=!0),this.resetPlay(l,0),this.gn.removeStreamFromSignal(!1,this.streamId,15e3);var a=this.retryStreamHandler;a.endRtcPlaySpan(this.streamId,void 0,this),this.playMode=t;var h=!0;this.playMode===E.ey.L3?(this.serverUrl=_s,h=!1):(this.serverUrl=bs,h=!0),this.useResourceTypes.push(this.playMode),this.useResourceTypes=Array.from(new Set(this.useResourceTypes)),this.playMode===E.ey.CDN?this.playCDN():(a.startMaxTime(),a.playStartSpan(this.streamId,this,!0),this.gn.connectWebRTCCenterServer(!1,h,(n=this.room)===null||n===void 0?void 0:n.roomID,(r=this.room)===null||r===void 0?void 0:r.token,function(m){i.gn.rePlayStream(i.streamId,m)}))}else this.info(s+" no change.")},Object.defineProperty(e.prototype,"ipStack",{get:function(){return Yi(this.ip)?Y.IPv6:Y.IPv4},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataChannel",{get:function(){var t;return(t=this.Qp)===null||t===void 0?void 0:t.dataChannel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataChannelList",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.onDataChannelList)||[]},set:function(t){this.Qp&&(this.Qp.onDataChannelList=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"netProtocol",{get:function(){var t,n;return!((t=this.Qp)===null||t===void 0)&&t.turnToTcp?"tcp":!((n=this.Qp)===null||n===void 0)&&n.autoTcp?this.webrtcProtocol:"udp"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMiniSdp",{get:function(){var t;return((t=this.Qp)===null||t===void 0?void 0:t.$u)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seiWorker",{get:function(){return this.gn.seiWorker},enumerable:!1,configurable:!0}),e.prototype.au=function(t,n){return n===void 0&&(n=!1),this.pn.settingConfig.getSetting(t,n)},Object.defineProperty(e.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logger",{get:function(){return this.an},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"completePlaySpan",{get:function(){return this.Vp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playingEvent",{get:function(){var t=uh;switch(this.playMode){case E.ey.L3:t=Ip;break;case E.ey.RTC:t=uh;break;case E.ey.CDN:t=Rp}return t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playStartEvent",{get:function(){return this.hasSucceed?k.aT.event:qo.event},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isStreamNotFound",{get:function(){var t;return!!(!((t=this.Qp)===null||t===void 0)&&t.streamNotFoundTime)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"allowAutoSwitchResource",{get:function(){return[E.qP.DG,E.qP.CUSTOM].includes(this.Mm)},enumerable:!1,configurable:!0}),e.prototype.initResourceMode=function(t){if((0,R.Cs)(t)&&[0,1,2,3,5].includes(t)){var n=cr(t);if(this.Mm=t,t===E.qP.DG)n=E.ey.L3;else if(t===E.qP.CUSTOM){var r=this.playOption.customResourceConfig||{},i=r.beforePublish,s=void 0;this.gn.publishersLength>0?(s=r.publishing,this.Jp=$o.publishing):(s=i,this.Jp=$o.beforePublish),n=s===E.qP.L3?E.ey.L3:s===E.qP.CDN?E.ey.CDN:E.ey.RTC}this.useResourceTypes.push(n),this.playMode=n,n===E.ey.L3&&(this.serverUrl=_s),this.info("zc.ply.cpm init mode "+n)}return this.playMode},e.prototype.changePublishOccasion=function(t){var n=this.Jp,r=this.pm.resourceMode===E.qP.CUSTOM,i=this.pm.customResourceConfig||{},s=i.afterPublish,c=i.publishing;if(t&&n!==$o.publishing){if(this.Jp=$o.publishing,r&&(0,R.Cs)(c))return this.changePlayMode(cr(c))}else if(!t&&n!==$o.afterPublish&&n===$o.publishing&&(this.Jp=$o.afterPublish,r&&(0,R.Cs)(s)))return this.changePlayMode(cr(s))},e.prototype.setSignal=function(t){var n=this.Qp;n?n.setSignal(t):n=this.Yp(this.playMode,t),this.info(ie.QU$+" set signal "+t.server+" peer:"+(n==null?void 0:n.playMode))},e.prototype.netProbeToReDispatch=function(t,n){t===void 0&&(t=function(){}),n===void 0&&(n=function(){}),this.ql=!0;var r=this==null?void 0:this.retryStreamHandler;r&&r.dispatchGwNodesBypass(this,t,n)},e.prototype.initStreamReport=function(){this.tv=this.cr.createSpan(E.t0.I,{key:Wu,par:this.va},{key:mi.event,par:this.va},mi.event,!0),this.playStartTime=new Date().getTime()},e.prototype.startPlay=function(t,n){var r,i,s,c,u,l,a,h=this;this.info(ie.QU$+" called ");var m=this.pm||{};if(t){var S=this.Qp;if(S){this.getRemoteStreamSuc=n,this.playMediaStatus={video:this.playMediaStatus.video&&(this.pm.video===void 0||!!this.pm.video),audio:this.playMediaStatus.audio&&(this.pm.audio===void 0||!!this.pm.audio)},m&&m.videoCodec&&(this.pm.videoCodec=m.videoCodec),(r=this.Vp)===null||r===void 0||r.setAttributes({video_layer:no.video_layer(this.pm.streamType===2?-1:this.pm.streamType||1)});var x=this.au("play_video_codec",!0);x&&(this.info(ie.QU$+" setting play_video_codec "+x),this.pm.videoCodec=x);var q=((i=this.pm)===null||i===void 0?void 0:i.resourceMode)==E.qP.DG?1:0;(s=this.$h)===null||s===void 0||s.setAttributes({is_peer:qo.is_peer(this.Od),is_mini:qo.is_mini(this.isMiniSdp)});var V={};!((c=this.Qp)===null||c===void 0)&&c.Fl||(V.is_mini=this.isMiniSdp),(u=this.Vp)===null||u===void 0||u.setAttributes(go({audio_activate:no.audio_activate(this.pm.audio==1||this.pm.audio!=0),video_activate:no.video_activate(this.pm.video==1||this.pm.video!=0),biz_product:no.biz_product(q),is_peer:no.is_peer(this.Od)},V)),this.tv.setAttributes({room_id:mi.room_id((l=this==null?void 0:this.room)===null||l===void 0?void 0:l.roomID),room_sid_string:mi.room_sid_string((a=this==null?void 0:this.room)===null||a===void 0?void 0:a.roomSessionID)}),S.connectGW().then(function(_e){n&&n(_e)}),this.av!=null&&(clearTimeout(this.av),this.av=null),this.av=setTimeout(function(){h.error(ie.QU$+" waiting timeout"),h.playStateUpdateError(Yl.Te)},this.rd),this.isProbe&&this.qualityHandler.startProbeTimeout()}else this.error(ie.QU$+" no peer")}else this.warn(ie.QU$+" streamId is null")},e.prototype.Yp=function(t,n){var r=this;if([E.ey.L3,E.ey.RTC].includes(t)){var i=t===E.ey.L3,s=this.Qp;return s||(this.info(ie.QU$+" create peer "+t),s=new _p(this,t,n,this.an,this.dataReport,this.tv,this.gn,this.pn,this.room,this.pm)),s.onCanStopNegaTimer=function(){r.av!=null&&(clearTimeout(r.av),r.av=null)},s.onNeedReplay=function(){r.resetPlay(!0,0),r.startPlay(r.va,r.getRemoteStreamSuc)},s.onPlayStateUpdateError=function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];r.playMode===(s==null?void 0:s.playMode)&&r.playStateUpdateError.apply(r,c)},s.onPlayBFrameEvent=function(c){r.qualityHandler.setHasBFrames(c)},s.onPlayStreamEnd=function(c){r.qualityHandler.setPlayStreamEnd(c)},s.onGwPlayNetState=function(c){r.qualityHandler.updateGwPlayNetState(c)},s.onPlayStateUpdate=function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];r.playMode===(s==null?void 0:s.playMode)&&r.onPlayStateUpdate.apply(r,c)},s.onIceConnected=function(c,u){var l,a,h=r==null?void 0:r.retryStreamHandler;for(var m in h==null||h.getTryTime(r,!0),r.hasSucceed=!0,r.Pp++,r.continuousFailCnt=0,r.reportPlayStateTime=Date.now(),r.ql=!1,r.$h&&(0,te.lA)(r.$h,{signal_consume:qo.signal_consume(r.signalTime),is_peer:qo.is_peer(r.Od),peer_id:qo.peer_id(r.peerID),source_type:qo.source_type(r.playMode),net_protocol:qo.net_protocol(r==null?void 0:r.netProtocol),tryidx:qo.tryidx(r.tryidx)},!1),r.isProbe||r.dm||(r.dm=(0,te.fU)(r.cr,E.t0.I,r.streamId,r.playingEvent,k.Nr.event,void 0,!0)),r.getConnectIP(),r.gn.publisherList)if(r.gn.publisherList[m].publisher.state==6&&r.broadcasterStatus==E.ku.stop){s==null||s.sendBroadcasterStatus(1),r.broadcasterStatus=E.ku.start;break}if(!r.isProbe){r.qualityHandler.setPlayQualityTimer();var S=r.au("probe_started_num");!isNaN(S)&&(r.gn.probeStartedNum=S)}var x,q,V;((V=r.pn.browser)==="firefox"||V==="chrome"&&(x=0,(q=((0,Vn.$t)().toLowerCase().match(/chrome\/([\d.]+)/)||[])[1])&&(x=parseInt(q.split(",")[0])),x<72))&&r.Kp(c,u);var _e=r.Hp,ke=_e.v,Pe=_e.a;(0,R.Cs)(ke)&&r.onRemoteCameraStatusUpdate(ke),(0,R.Cs)(Pe)&&r.onRemoteMicStatusUpdate(Pe),r.allowAutoSwitchResource&&(r.playMode===E.ey.RTC?(l=r.Ip)===null||l===void 0||l.close(0):r.playMode===E.ey.L3&&((a=r.Op)===null||a===void 0||a.close(0)))},s.onGetIP=function(){r.state===6&&r.getConnectIP()},s.onPeerConnected=this.Kp.bind(this),s.onRecvRemoteStream=function(c){if(r.remoteStream=c,r.playStream){var u=r.rtcViewer;c.clone().getTracks().forEach(function(l){var a=l.kind==="video",h=[];(h=a?r.playStream.getVideoTracks():r.playStream.getAudioTracks()).includes(l)||(h.forEach(function(m){return r.playStream.removeTrack(m)}),(!a||r.playMediaStatus.video&&[0,20].includes(r.cameraStatus))&&(r.info(ie.Nw2+" add track "+a),r.playStream.addTrack(l),u&&u.setTrack(a,l,r.pn.browser==="safari"),r.pn.actionListener(a?"playerVideoTrackUpdate":"playerAudioTrackUpdate",r.va,l))),a||r.Zp()})}else r.playStream=c.clone(),r.info(ie.Nw2+" clone");r.Rp&&r.Rp.renderMediaStreamByCdnPlayer(r.playStream),r.gn.soundLevelDelegate&&!r.isProbe&&r.startSoundLevel(),r.audioMuteState=c.getAudioTracks().length>0?"0":"1",r.videoMuteState=c.getVideoTracks().length>0?"0":"1"},s.onRecvStreamStatus=this.Xp.bind(this),s.onRecvMixSoundLevels=function(c){r.Wp(c)},s.onRecvNetQuality=function(c,u,l){r.playMode===(s==null?void 0:s.playMode)&&(r.qualityHandler.stopProbeTimeout(),c==0&&(0,R.Cs)(u)&&(0,R.Cs)(l)?(r.isProbeByDG=!1,r.onCalNetQualityResult(0,ze(l,u))):r.onCalNetQualityResult(1))},s.onRecvNetQualityGrade=function(c){var u,l;if(r.playMode===(s==null?void 0:s.playMode)){var a=c;r.Bp=r.Bp||((l=(u=r.gn.playerList[r.va])===null||u===void 0?void 0:u.room.streamList.find(function(h){return h.stream_id==r.va}))===null||l===void 0?void 0:l.id_name),r.Bp&&(r.pn.actionListener("networkQuality",r.Bp,a==null?void 0:a.tx_quality,a==null?void 0:a.rx_quality),!r.qp&&r.startPollNetworkQuality(),r.Lp=0)}},i?this.Ip=s:this.Op=s,s}},e.prototype.resetGwNodes=function(){var t;(t=this.Qp)===null||t===void 0||t.resetGwNodes()},e.prototype.setGwNodes=function(t,n,r,i){var s;(s=this.Qp)===null||s===void 0||s.setGwNodes(t,n,r,i)},e.prototype.dispatchGwNodes=function(t,n,r){var i;(i=this.Qp)===null||i===void 0||i.dispatchGwNodes(t,n,r)},e.prototype.resetPlay=function(t,n){var r,i,s;t===void 0&&(t=!0),this.info(ie.ruA+" call"),t&&((r=this.Op)===null||r===void 0||r.close(n),(i=this.Ip)===null||i===void 0||i.close(n),(s=this.Rp)===null||s===void 0||s.stopCDNPlayer()),this.ip="",this.av!=null&&(clearTimeout(this.av),this.av=null),this.qualityHandler.stopProbeTimeout(),this.qualityHandler.clearPlayQualityTimer(),this.stopSoundLevel(),this.Up=0,this.Gp=0},e.prototype.playStateUpdateError=function(t,n,r,i){if(this.error(ie.Rbr+" call "+JSON.stringify(t)),!this.isProbe){var s=this.cr.createSpan(E.t0.H,{key:Wu,par:this.va},{key:""},k.$g.event);s.setAttributes({error:t==null?void 0:t.code,message:t==null?void 0:t.message}),s.end()}this.isProbe?this.onCalNetQualityResult(1):this.va&&this.onPlayStateUpdate(E.h7.error,this.va,t,n,r,i),this.info(ie.Rbr+" ended")},e.prototype.getCameraMicStatus=function(t){return t==0?"OPEN":"MUTE"},e.prototype.onPlayStateUpdate=function(t,n,r,i,s,c){(n&&this.gn.playerList[n])===this?this.retryStreamHandler.playStateHandle(t,this.streamId,r,i,s,c):this.error("zsc.pss.1 cannot find play"),t===E.h7.start&&(r==null?void 0:r.code)===0&&(this.gn.playModule&&this.$p(),this.gn.supplementPlayingChargeTime(),this.qualityHandler.resetCallbackState())},e.prototype.onPlayQualityUpdate=function(t,n){},e.prototype.getStopReason=function(t){var n="StopPlay";return t&&t.code&&(t.code===1104031?n="ReachMaxAVRetryTime":n="StopPlay"),n},e.prototype.Wp=function(t){var n=this,r=t.map(function(u){var l,a,h=((a=(l=n.room.streamList)===null||l===void 0?void 0:l.find(function(m){return m.stream_nid===u.soundLevelID}))===null||a===void 0?void 0:a.stream_id)||"";return go(go({},u),{streamID:h})}),i=new Map(r.map(function(u){return[u.soundLevelID,u.value]})),s=r.filter(function(u){return u.streamID}).map(function(u){return[u.streamID,u.value]}),c=new Map(s);this.pn.actionListener("mixerSoundLevelUpdate",i,this.va),c.size&&this.pn.actionListener("autoMixerSoundLevelUpdate",c,this.va)},e.prototype.stopPlay=function(t){var n,r,i,s,c,u;this.info(ie.W8t+" called");var l=this.getStopReason(t);for(var a in this.gn.publisherList)if(this.gn.publisherList[a].publisher.state==6&&this.broadcasterStatus==E.ku.start){this.sendBroadcasterStatus(0),this.broadcasterStatus=E.ku.stop;break}var h=(r=this.Qp)===null||r===void 0?void 0:r.$u,m=this.isStreaming?0:this.lastFailTimeLen;if(!this.isProbe){var S=Date.now()-this.reportPlayStateTime;[0,2].includes(this.Mm)&&this.tv.setAttributes({play_state_time:mi.play_state_time(S||0)}),this.dm&&this.endPlayingSpan({stop_reason:k.er.stop_reason(l),try_time:k.er.try_time(m)}),(t==null?void 0:t.code)==Yl.De.code&&this.uploadPlayEvent(t),this.seiWorker&&this.seiWorker.postMessage({cmd:"clear",type:"pull",streamID:this.va})}if(this.stopPollNetworkQuality(),this.resetPlay(!0,0),this.Zc(),!this.isProbe){var x=this.qualityHandler,q=x.Qv,V=x.Yv,_e=((n={}).l3_a_break_time=V.cumulativeBreakDurationL3,n.l3_a_decode_time=V.cumulativeDecodeDurationL3,n.l3_v_break_time=q.cumulativeBreakDurationL3,n.l3_v_decode_time=q.cumulativeDecodeDurationL3,n.rtc_a_break_time=V.cumulativeBreakDurationRtc,n.rtc_a_decode_time=V.cumulativeDecodeDurationRtc,n.rtc_v_break_time=q.cumulativeBreakDurationRtc,n.rtc_v_decode_time=q.cumulativeDecodeDurationRtc,n.audio_cumulative_break_time=V.cumulativeBreakDuration,n.audio_cumulative_decode_time=V.cumulativeDecodeDuration,n.video_cumulative_break_time=q.cumulativeBreakDuration,n.video_cumulative_decode_time=q.cumulativeDecodeDuration,n),ke=Date.now(),Pe=this.firstPulledTimeStamp;this.updateValidTime(t);var Oe=0;t&&t.code!==0&&(Oe=t.code===Et.I4J.code?this.latestPlayErrCode:t.code),this.tv.setAttributes(go(go({biz_product:((i=this.pm)===null||i===void 0?void 0:i.resourceMode)==E.qP.DG?1:0,webrtc_sid:mi.webrtc_sid(this.sessionId),max_retry_interval:mi.max_retry_interval(this.pn.streamRetryTime),probe_ip_cnt:mi.probe_ip_cnt(this.Rd),valid_probe_ip_cnt:mi.valid_probe_ip_cnt(this.Td),poor_quality_retry_cnt:mi.poor_quality_retry_cnt(this.poorQualityRetryCnt),probe_not_trigger_retry_info:mi.probe_not_trigger_retry_info(this.Cd.length>0?this.Cd:void 0),fail_cnt:mi.fail_cnt(Math.max(this.tryidx-1,0)),continuous_fail_cnt:mi.continuous_fail_cnt(Math.max(this.continuousFailCnt-1,0)),try_time:mi.try_time(m),use_resource_type:mi.use_resource_type(this.useResourceTypes),use_na:k.oW.use_na(1),play_state_cnt:mi.first_frame_time(this.Pp),protocol:mi.protocol("webrtc"),dispatch_external_ip:mi.dispatch_external_ip(this.pn.clientIP),w:mi.w((s=this.playStat)===null||s===void 0?void 0:s.frameWidth),h:mi.h((c=this.playStat)===null||c===void 0?void 0:c.frameHeight),stop_reason:mi.stop_reason(l),error:(t==null?void 0:t.code)||0,last_error:Oe,message:(t==null?void 0:t.message)||"",cdn_a_break_time:0,cdn_a_decode_time:0,cdn_v_break_time:0,cdn_v_decode_time:0},_e),{total_d:Pe?ke-Pe:0,valid_d:this.Tp+this.Ap+this.pp,tempbroken_cnt:this.zp+this.Dp+this.CDNBrokenCnt,is_mini:h})),this.tv.end()}this.gn.stopToReport(1),this.gn.stopNetProbe(this),(u=this.Qp)===null||u===void 0||u.stopPlay(),this.tg(),this.ig(),this.hasSucceed=!1,this.tryidx=0,this.ql=!1,this.Rd=0,this.Td=0,this.poorQualityRetryCnt=0,this.continuousFailCnt=0;var Ge=this.rtcViewer;Ge&&Ge.destroy()},e.prototype.uploadPlayEvent=function(t){var n,r;if(this.Vp){var i={};this.Qp&&(!((n=this.Qp)===null||n===void 0)&&n.Jl)&&(i.mini_retry_consume=+((r=this.Qp)===null||r===void 0?void 0:r.Jl.toFixed(0)),this.Qp.resetMiniReportInfos()),(0,te.lA)(this.Vp,go(go({},i),{error:t.code,message:t.message}))}this.Vp=void 0},e.prototype.onDisconnect=function(t){this.info(ie.Toj+" call"),this.playStateUpdateError(t||Yl.Wn,!!t)},e.prototype.startSoundLevel=function(){var t,n=this;if(this.info(ie.cuT+" call"),!this.isProbe)if(this.remoteStream&&this.remoteStream.getAudioTracks().length!=0){(t=this.soundMeterWorklet)===null||t===void 0||t.destroy(),this.mic=null;var r=this.gn.getCloudSoundInterval();try{var i=this,s=this.gn.createSoundLevel(this.ac,this.remoteStream,this.gn.soundLevelInterval,r,function(u){i.soundLevel=n.micStatus===0?100*u:0}),c=s.mic;this.soundMeterWorklet=s.soundMeter,this.mic=c}catch(u){this.error(ie.cuT+" get sound level failed "+u)}}else this.info(ie.cuT+" remote stream no found")},e.prototype.stopSoundLevel=function(){var t;this.info(ie.SKc+" call"),this.soundLevel=0,(t=this.soundMeterWorklet)===null||t===void 0||t.destroy(),this.mic=null},e.prototype.onCalNetQualityResult=function(t,n){},e.prototype.uploadRTCPlayStats=function(){var t,n,r,i,s,c,u,l,a,h,m,S,x,q,V,_e;this.lastPlayStats.time&&((t=this.dm)===null||t===void 0||t.setAttributes({lsttime:k.er.lsttime(parseInt(this.lastPlayStats.time)),total_stat:k.Jv.total_stat({afc:(n=this.lastPlayStats)===null||n===void 0?void 0:n.audioPacketsReceived,vfc:(r=this.lastPlayStats)===null||r===void 0?void 0:r.framesReceived,tfc:((i=this.lastPlayStats)===null||i===void 0?void 0:i.audioPacketsReceived)+((s=this.lastPlayStats)===null||s===void 0?void 0:s.framesReceived),vb:(c=this.lastPlayStats)===null||c===void 0?void 0:c.videoBytesReceived,ab:(u=this.lastPlayStats)===null||u===void 0?void 0:u.audioBytesReceived,tb:((l=this.lastPlayStats)===null||l===void 0?void 0:l.videoBytesReceived)+((a=this.lastPlayStats)===null||a===void 0?void 0:a.audioBytesReceived),rtp_rtt:Math.round(1e3*((h=this.playStat)===null||h===void 0?void 0:h.currentRoundTripTime))||0,w:(m=this.playStat)===null||m===void 0?void 0:m.frameWidth,rtp_plr:(S=this.playStat)===null||S===void 0?void 0:S.videoPacketsLostRate,h:(x=this.playStat)===null||x===void 0?void 0:x.frameHeight,rtp_bw:!((q=this.playStat)===null||q===void 0)&&q.googAvailableSendBandwidth?(V=this.playStat)===null||V===void 0?void 0:V.googAvailableSendBandwidth:void 0,p2p_delay:(_e=this.playStat)===null||_e===void 0?void 0:_e.peerToPeerDelay})}))},e.prototype.getViewer=function(){return this.playStream&&!this.rtcViewer&&(this.rtcViewer=new Ml(this.playStream,this,{clearLastFrame:this.pn.engineConfig.playClearLastFrame})),this.rtcViewer},e.prototype.Kp=function(t,n){var r;this.isProbe||this.firstFrameTime!=0||(this.firstFrameTime=new Date().getTime()-this.beginTime,this.tv.setAttributes({first_frame_time:mi.first_frame_time(this.firstFrameTime),fft_video:mi.fft_video(this.firstFrameTime),fft_audio:mi.fft_audio(this.firstFrameTime),biz_product:k.x6.biz_product(((r=this.pm)===null||r===void 0?void 0:r.resourceMode)==E.qP.DG?1:0)}),this.ng=this.firstFrameSpan("video",t,n),this.eg=this.firstFrameSpan("audio",t,n)),this.Fp&&this.rg(this.cameraStatus,this.micStatus)},e.prototype.rg=function(t,n){t===0&&this.ng&&(this.ng.setAttributes({dev_changed:k.x6.dev_changed(this.cameraStatus!==0)}),this.ng.spanReport(),this.ng=null),n===0&&this.eg&&(this.eg.setAttributes({dev_changed:k.Cp.dev_changed(this.micStatus!==0)}),this.eg.spanReport(),this.eg=null)},e.prototype.firstFrameSpan=function(t,n,r){var i,s=t==="video"?k.x6:k.Cp,c=(0,te.fU)(this.cr,E.t0.H,this.va,s.event,Wu),u=this.streamInRoom?2:this.Np===0?0:1;return c.setAttributes({webrtc_sid:s.webrtc_sid(n),resource_type:s.resource_type(this.playMode),fft_consumed:s.fft_consumed(this.firstFrameTime),protocol:s.protocol("webrtc"),push_consumed:s.push_consumed(this.Np),prepare_recv_consumed:s.prepare_recv_consumed(this.signalTime),connected_consumed:s.connected_consumed(r),reliability:s.reliability(u),biz_product:s.biz_product(((i=this.pm)===null||i===void 0?void 0:i.resourceMode)==E.qP.DG?1:0),ip_stack:this.ipStack}),c==null||c.end(!1),c},e.prototype.isCustomCdn=function(){return!1},e.prototype.setStreamAdd=function(){this.streamInRoom||this.Np!==0||this.state===5||(this.Np=new Date().getTime()-this.playStartTime),this.state===6&&this.Rp&&this.Rp.retrySendTransCodecCmd()},e.prototype.setStreamUpdate=function(t){this.qualityHandler.setStreamUpdate(t)},e.prototype.startPollNetworkQuality=function(){var t=this;clearTimeout(this.qp),this.qp=setTimeout(function(){t.Lp++;var n=E.b3.Unknown,r=E.b3.Unknown;t.Bp&&t.Lp>1&&(t.Lp>3&&(n=E.b3.Die,r=E.b3.Die),t.pn.actionListener("networkQuality",t.Bp,n,r)),t.startPollNetworkQuality()},3e3)},e.prototype.stopPollNetworkQuality=function(){clearTimeout(this.qp),this.Lp=0},e.prototype.setAudioFrameCallback=function(t,n){this.info("zc.p.safc.0 call"),this.playStream?(this.Yc||(this.Yc=new Ad(this.ac,this.an)),this.Yc.setAudioFrameCallback(this.playStream,t!==null,function(r){t&&t(r)},n)):this.warn("zc.p.safc.0 no play stream")},e.prototype.Zc=function(){this.Yc&&(this.Yc.destroy(),this.Yc=null)},e.prototype.Zp=function(){var t;(t=this.Yc)===null||t===void 0||t.replaceSource(this.playStream)},e.prototype.updateValidTime=function(t){if(this.pulledTimeStamp){var n=0;t!=null&&t.code&&t.code!==Et.I4J.code&&(n=1);var r=Date.now(),i=this.playMode,s=r-this.pulledTimeStamp;i==E.ey.RTC?(this.Tp=s,this.zp+=n):i===E.ey.L3&&(this.Ap=s,this.Dp+=n),this.pulledTimeStamp=0}},e.prototype.updateCDNValidTime=function(){var t;(t=this.Rp)===null||t===void 0||t.updateCDNValidTime()},e.prototype.setMuteStreamByPlayMode=function(t){this.info(ie.Ze2+" call: ".concat(JSON.stringify(t)));var n=t.play_mode,r=n===void 0?0:n,i=t.forbid_play_expire_time,s=1e3*(0,te.pl)(i===void 0?0:i),c=!fn(r,0),u=!fn(r,1);this.info(ie.Ze2+" mode: ".concat(u,`,
        `).concat(c,`,
        `).concat(s,`,
        `).concat(JSON.stringify(this.Mp))),u!==this.Mp.video||c!==this.Mp.audio||s!==this.Mp.expireTime?((0,R.dd)(u)&&(this.Mp.lastVideo=this.Mp.video,this.Mp.video=u),(0,R.dd)(c)&&(this.Mp.lastAudio=this.Mp.audio,this.Mp.audio=c),s&&(this.Mp.expireTime=s),this.gn.playModule&&this.isStreaming&&this.$p()):this.info(ie.Ze2+" mode not change")},e.prototype.$p=function(){var t=[void 0,!0].includes(this.pm.video),n=[void 0,!0].includes(this.pm.audio),r=this.Mp,i=r.video,s=r.audio,c=r.lastVideo,u=r.lastAudio,l=r.expireTime;this.info("".concat(ie.ISq," ").concat(JSON.stringify(this.Mp)));var a=this.playMediaStatus,h=a.video,m=a.audio,S=l-(new Date().getTime()+this.pn.clientTimeOffset);this.info("".concat(ie.ISq," remainTime ").concat(S));var x=!1,q=!1,V=!1,_e=!1;this.og();var ke=!1;this.isServerMuteVideo||c===!1&&i===!0?(x=!0,q=!i,ke=!0):(x=!h,q=!h),this.isServerMuteAudio||u===!1&&s===!0?(V=!0,_e=!s,ke=!0):(V=!m,_e=!m),t&&x&&this.ug("video",q,ke),n&&V&&this.ug("audio",_e,ke),this.ig(),(i===!1||s===!1)&&S>0&&this.ag(S)},e.prototype.ug=function(t,n,r,i){var s=this;this.info("".concat(ie.cIs," ").concat(this.va," ").concat(t," ").concat(n));var c=this.gn.playModule;c&&c.mutePlayStream(this.va,t,n,!1).then(function(u){s.info("".concat(ie.cIs," ").concat(s.va," mute ").concat(t,": ").concat(u));var l=function(m,S){s.pn.onExperimentalAPICallback({method:m,content:{roomID:s.room.roomID,streamID:s.va,mute:S}})},a=!s.playMediaStatus.video,h=!s.playMediaStatus.audio;t==="video"&&r&&s.cg!==a&&(l("onRecvRoomMuteVideoStream",a),s.cg=a),t==="audio"&&r&&s.hg!==h&&(l("onRecvRoomMuteAudioStream",h),s.hg=h),i&&i()})},e.prototype.ag=function(t){var n=this;this.info("".concat(ie.Ox5," ").concat(this.va," ").concat(t)),this.jp=setTimeout(function(){var r=n.gn.playModule;if(n.info("".concat(ie.Ox5," ").concat(n.va," ").concat(!!r)),r){var i=n.Mp,s=i.audio;i.video===!1&&n.ug("video",!1,!0,function(){n.og()}),s===!1&&n.ug("audio",!1,!0,function(){n.og()}),n.tg()}},t)},e.prototype.og=function(){var t=this.Mp,n=t.video,r=t.audio,i=t.expireTime-(new Date().getTime()+this.pn.clientTimeOffset);this.isServerMuteVideo=i>0&&n===!1,this.isServerMuteAudio=i>0&&r===!1},e.prototype.ig=function(){this.jp&&(clearTimeout(this.jp),this.jp=null)},e.prototype.tg=function(){this.Mp={video:!0,audio:!0,expireTime:0,lastVideo:!0,lastAudio:!0}},e.prototype.Xp=function(t,n,r){this.info("".concat(ie.dw7," status camera_status: ").concat(t," mic_status: ").concat(n));var i=this.cameraStatus!==t;if((!this.Fp||i)&&this.onRemoteCameraStatusUpdate(t),(!this.Fp||this.micStatus!==n)&&this.onRemoteMicStatusUpdate(n),this.Fp=!0,this.cameraStatus=t,this.micStatus=n,this.videoMuteState=t===0?"0":"1",this.audioMuteState=n===0?"0":"1",(0,R.dd)(this.pm.video))this.info(ie.dw7+" has set video option, ignore stream status");else if(this.handleVideoTrackForPlaying(i),this.pn.browser==="safari"&&r)for(var s=te.VJ.querySelectorAll("video, audio"),c=0;c<s.length;c++){var u=s[c];u.srcObject===this.playStream&&(this.info(ie.dw7+" track changed. rerender stream"),u.srcObject=this.playStream)}this.rg(t,n)},e.prototype.handleVideoTrackForPlaying=function(t){var n=this;t===void 0&&(t=!1);var r=this.playStream;if(r){var i=this.rtcViewer,s=this.cameraStatus;if(s!==0&&s!==20||!this.playMediaStatus.video)i?t&&(this.info(ie.dw7+" viewer clear last frame"),i.checkIfClearLastFrame()):r.getVideoTracks().forEach(function(u){u.enabled=!1,n.gn.trackUtils.stopTrack(u),r.removeTrack(u)});else if(r.getVideoTracks().length===0){var c=this.remoteStream.clone().getVideoTracks()[0];r.addTrack(c),i&&i.setVideo(c,this.pn.browser==="safari"),this.pn.actionListener("playerVideoTrackUpdate",this.va,c)}}},e.prototype.onRemoteCameraStatusUpdate=function(t){this.state===6?(this.Hp.v=void 0,this.gn.onRemoteCameraStatusUpdate(this.streamId,this.getCameraMicStatus(t),t)):(this.Hp.v=t,this.info(ie.dw7+" v not playing. "))},e.prototype.onRemoteMicStatusUpdate=function(t){this.state===6?(this.Hp.a=void 0,this.gn.onRemoteMicStatusUpdate(this.streamId,this.getCameraMicStatus(t),t)):(this.Hp.a=t,this.info(ie.dw7+" a not playing. "))},e.prototype.playCDN=function(t,n){var r=this,i="zc.ply.pcdn";this.info(i+" call"),this.getCDNHandler().playCDN(function(){for(var s=[],c=0;c<arguments.length;c++)s[c]=arguments[c];r.info(i+" success"),r.dm=(0,te.fU)(r.cr,E.t0.H,r.streamId,r.playingEvent,k.Nr.event,void 0,!0),n&&n.apply(void 0,s)},function(s){r.info(i+" fail. "+s),r.onPlayStateUpdate(E.h7.error,r.va,s,!0),t&&t(s)})},e.prototype.getCDNHandler=function(){return this.Rp||(this.Rp=new Tp(this,this.an,this.cr,this.gn,this.pn)),this.Rp},e.prototype.endPlayingSpan=function(t){var n,r,i;if(t===void 0&&(t={}),this.dm){var s=this.room,c=this.playMode===E.ey.CDN,u=this!=null&&this.isStreaming?0:(n=this==null?void 0:this.retryStreamHandler)===null||n===void 0?void 0:n.getTryTime(this);return c||this==null||this.uploadRTCPlayStats(),(0,te.lA)(this.dm,go(go({stream_id:k.er.stream_id(this.streamId),room_id:k.er.room_id(s==null?void 0:s.roomID),room_sid_string:k.er.room_sid_string(s==null?void 0:s.roomSessionID),tryidx:k.er.tryidx(this.tryidx),ip:k.er.ip(this==null?void 0:this.ip),resource_type:k.er.resource_type(this.playMode),dispatch_external_ip:k.er.dispatch_external_ip(this.pn.clientIP)},c?{url:k.er.url((r=this.Rp)===null||r===void 0?void 0:r.cdnUrl),net_protocol:k.er.net_protocol("tcp")}:{protocol:k.er.protocol("webrtc"),url:k.er.url((i=this.signal)===null||i===void 0?void 0:i.server),try_time:k.er.try_time(u),net_protocol:k.er.net_protocol(this.netProtocol)}),t)),this.dm=void 0,!0}return!1},e.prototype.sendBroadcasterStatus=function(t){var n=this.Qp;n&&n.sendBroadcasterStatus(t)},e.prototype.ActivatePlayAudioStream=function(t,n,r){var i=this.Qp;i&&i.ActivatePlayAudioStream(t,n,r)},e.prototype.ActivatePlayVideoStream=function(t,n,r){var i=this.Qp;i&&i.ActivatePlayVideoStream(t,n,r)},e.prototype.getP2PNetStats=function(t,n){var r=this.Qp;r&&r.getP2PNetStats(t,n)},e.prototype.getConnectIP=function(){var t,n;if(this.streamConnectIP&&!this.ip){var r=Ar(this.streamConnectIP),i=this.getIPByGwNode(r),s=i.ip,c=i.port;this.ip=s,this.port=c,this.info("zc.p.1.gci.0 ip: ".concat(s," ").concat(c)),(t=this.$h)===null||t===void 0||t.setAttributes({ip:qo.ip(this.ip),port:qo.port(this.port)}),(n=this.$h)===null||n===void 0||n.spanReport(),this.$h=void 0}},e.prototype.getIPByGwNode=function(t){var n;if(this.ipNode){var r=this.ipNode.vid.split("|"),i="";return r.forEach(function(u){var l=Ar(u);t===l&&(i=u)}),{ip:i,port:this.ipNode.port}}if(this.gwNode){var s=(n=this.gwNode)===null||n===void 0?void 0:n.split(":"),c=s[s.length-1];return{ip:this.gwNode.replace(":"+c,""),port:parseInt(c)}}return{ip:"",port:0}},e.prototype.reportMiniSdpInfos=function(){var t;(t=this.Qp)===null||t===void 0||t.reportMiniSdpInfos(this.playStartEvent)},e.prototype.setPlayStreamVideoType=function(t){return Cp(this,void 0,void 0,function(){var n;return wp(this,function(r){return(n=this.Qp)?[2,n.setPlayStreamVideoType(t)]:[2,!1]})})},e.prototype.onStatsUpdated=function(t){t.audioJitterBufferDelayMs&&this.sendStats(t.audioJitterBufferDelayMs)},e.prototype.sendStats=function(t){var n=this.Qp;if(n&&!(n.gwVersion<83886080)){var r=Date.now();if(this.Up===0||r-(this.Up+50)>=2e3){var i=this.dataChannel;if(i&&i.readyState==="open"){var s=new Uint8Array(5);s[0]=14,s[1]=this.Gp>>8&255,s[2]=255&this.Gp,s[3]=t>>8&255,s[4]=255&t,this.Gp++,this.Gp>=65536&&(this.Gp=0),i.send(s)}else n.sendPlayStats(t);this.Up=r}}},e}(Nl),Pp=pt(6361),Zl=pt.n(Pp),Io=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},yo=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Ap=function(){function o(e,t,n){this.name=e,this.an=t,this.fg=n;var r=this.lg();this.dg=e+":"+me(6),this.vg=Zl().createInstance({name:this.dg}),this.an.info(ie.EPo+" constructor ".concat(e," ").concat(this.dg," ").concat(r)),this.recordStoresInStorage(e,this.dg,r)}return Object.defineProperty(o.prototype,"deletedKeys",{get:function(){return this.name+"_d"},enumerable:!1,configurable:!0}),o.prototype.lg=function(){return Math.ceil(this.fg._now()/1e3)},o.prototype.recordStoresInStorage=function(e,t,n){try{var r=localStorage.getItem(e);this.an.info(ie.EPo+" record storage storeNames ".concat(r));var i=r?r.split(","):[];i.push(t+"/"+n+"-1"),localStorage.setItem(e,i==null?void 0:i.join(","))}catch{}},o.prototype.getStoresFromStorage=function(){return this.refreshStores("1")},o.prototype.resetStorageStores=function(){this.an.info(ie.EPo+" resetStorageStores"),this.refreshStores("0",this.dg)},o.prototype.removeStoreFromStorage=function(e){return Io(this,void 0,void 0,function(){return yo(this,function(t){switch(t.label){case 0:return e===this.dg?[3,2]:(this.an.info(ie.EPo+" removeStore ".concat(e)),[4,this.dropInstance(e)]);case 1:return t.sent(),this.refreshStores("2",e),[3,3];case 2:this.an.info(ie.EPo+" not remove self"),t.label=3;case 3:return[2]}})})},o.prototype.refreshStores=function(e,t){var n,r;if(this.an.info(ie.EPo+" refreshStores ".concat(e," ").concat(t)),!localStorage)return[];var i=localStorage.getItem(this.name),s=i?i.split(","):[],c=[],u=[];if(s.length>0){for(var l=[],a=0;a<s.length;a++){var h=s[a].split("-"),m=h[0],S=h[1],x=(n=m.split("/"))===null||n===void 0?void 0:n[0];if(this.an.info(ie.EPo+" refreshStores stores: ".concat(m," ").concat(S)),e=="2")x!==t&&l.push(m+"-"+S);else if(e=="0")x!==t&&l.push(m+"-"+S),x===t&&l.push(m+"-"+e);else if(S!=="2"){m.indexOf("/")>-1&&this.lg()-parseInt(((r=m.split("/"))===null||r===void 0?void 0:r[1])||"0")>86400&&u.push(x);var q=x+"/"+this.lg();l.push(q+"-"+e)}x.indexOf(this.dg)===-1&&S=="0"&&c.push(x)}localStorage.setItem(this.name,l.join(","))}return[c,u]},o.prototype.dropInstance=function(e){return Io(this,void 0,void 0,function(){var t;return yo(this,function(n){switch(n.label){case 0:this.an.info(ie.EPo+" dropInstance ".concat(e)),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,Zl().dropInstance({name:e})];case 2:return n.sent(),[4,this.manualDeleteDB(e)];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),this.an.info(ie.EPo+" dropInstance fail ".concat(t==null?void 0:t.message)),[3,5];case 5:return[2]}})})},o.prototype.manualDeleteDB=function(e){return new Promise(function(t,n){var r=window&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB);if(r){var i=r.deleteDatabase(e);i.onsuccess=function(){return t()},i.onerror=function(s){return n(s)},i.onblocked=function(){return n(new Error("please close other connection"))}}else t()})},o.prototype.getCacheStoreData=function(e,t){return Io(this,void 0,void 0,function(){var n,r,i,s,c,u,l,a=this;return yo(this,function(h){switch(h.label){case 0:return h.trys.push([0,12,,13]),n=this.getDeleteKey(),[4,(r=Zl().createInstance({name:e})).keys()];case 1:return i=h.sent(),this.an.info(ie.EPo+" ".concat(t," ").concat(e," get cache keys ").concat(i)),s=[],n.forEach(function(m){i.filter(function(S){return S.includes(m)}).length>0&&s.push(m),i=i.filter(function(S){return!S.includes(m)})}),s.length>0&&(this.an.info(ie.EPo+" ".concat(t," ").concat(e," get cache del keys ").concat(s)),s.forEach(function(m){a.setDeleteKey("remove",m)})),c=i.filter(function(m){return m.indexOf("_head")>-1}),u=[],this.an.info(ie.EPo+" ".concat(t," ").concat(e," get cache head keys ").concat(JSON.stringify(c))),c.length>0?[4,this.readStoreDatas(c,i,r)]:[3,7];case 2:return(u=h.sent())!=null&&u.length?[3,6]:(this.an.info(ie.EPo+" ".concat(t," ").concat(e," get cache empty")),t?[4,this.removeOldStoreFromStorage(t,e)]:[3,4]);case 3:return h.sent(),[3,6];case 4:return[4,this.removeStoreFromStorage(e)];case 5:h.sent(),h.label=6;case 6:return[3,11];case 7:return this.an.info(ie.EPo+" ".concat(t," ").concat(e," get cache head empty")),t?[4,this.removeOldStoreFromStorage(t,e)]:[3,9];case 8:return h.sent(),[3,11];case 9:return[4,this.removeStoreFromStorage(e)];case 10:h.sent(),h.label=11;case 11:return[2,u];case 12:return l=h.sent(),this.an.warn(ie.EPo+" get cache failed ".concat(e," ").concat(l)),[3,13];case 13:return[2]}})})},o.prototype.readStoreDatas=function(e,t,n){return Io(this,void 0,void 0,function(){var r,i,s,c;return yo(this,function(u){switch(u.label){case 0:r=[],i=function(l){var a,h,m,S,x,q,V,_e,ke,Pe,Oe;return yo(this,function(Ge){switch(Ge.label){case 0:h=(a=e[l]).replace("_head",""),m=t.filter(function(Je){return Je.indexOf(h)>-1}),S=null,x=[],q=[],V=void 0,_e=0,Ge.label=1;case 1:return _e<m.length?[4,n.getItem(ke=m[_e])]:[3,4];case 2:Pe=Ge.sent(),ke.startsWith(h+"_head")?S=Pe:ke.startsWith(h+"_publish")?x.push(Pe):ke.startsWith(h+"_play")?q.push(Pe):ke.startsWith("qec_"+h)&&(V=Pe),Ge.label=3;case 3:return _e++,[3,1];case 4:return Oe=new Date().getTime()-parseInt(h),S?x.length>0||q.length>0||V?(r.push({timestamp:parseInt(h),head:S,publishInfos:x,playInfos:q,chargeInfos:V}),[3,7]):[3,5]:[3,7];case 5:return x.length===0&&q.length===0&&!V&&Oe>6e4?(s.an.info(ie.EPo+" readStoreDatas remove ".concat(a)),[4,n.removeItem(a)]):[3,7];case 6:Ge.sent(),Ge.label=7;case 7:return[2]}})},s=this,c=0,u.label=1;case 1:return c<e.length?[5,i(c)]:[3,4];case 2:u.sent(),u.label=3;case 3:return c++,[3,1];case 4:return[2,r]}})})},o.prototype.saveItem=function(e,t){return Io(this,void 0,void 0,function(){var n;return yo(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.vg.setItem(e,t)];case 1:return r.sent(),[3,3];case 2:return n=r.sent(),this.an.warn(ie.EPo+" save "+JSON.stringify(n)),[3,3];case 3:return[2]}})})},o.prototype.getItem=function(e){return Io(this,void 0,void 0,function(){var t;return yo(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.vg.getItem(e)];case 1:return[2,n.sent()];case 2:return t=n.sent(),this.an.warn(ie.EPo+" get "+JSON.stringify(t)),[3,3];case 3:return[2]}})})},o.prototype.removeItem=function(e){return Io(this,void 0,void 0,function(){var t;return yo(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.vg.removeItem(e)];case 1:return n.sent(),this.an.info(ie.EPo+" removeItem ".concat(JSON.stringify(e))),[3,3];case 2:return t=n.sent(),this.an.warn(ie.EPo+" remove "+JSON.stringify(t)),[3,3];case 3:return[2]}})})},o.prototype.clearItems=function(e){return Io(this,void 0,void 0,function(){var t,n,r,i;return yo(this,function(s){switch(s.label){case 0:return s.trys.push([0,6,,7]),this.an.info(ie.EPo+" call clearItems ".concat(e)),[4,this.vg.keys()];case 1:t=s.sent(),this.an.info(ie.EPo+" clearItems store ".concat(JSON.stringify(t))),n=t.filter(function(c){return c.indexOf(e)>-1}),this.an.info(ie.EPo+" clearItems clear ".concat(JSON.stringify(n))),r=0,s.label=2;case 2:return r<n.length?[4,this.removeItem(n[r])]:[3,5];case 3:s.sent(),s.label=4;case 4:return r++,[3,2];case 5:return this.setDeleteKey("remove",e),[3,7];case 6:return i=s.sent(),this.an.warn(ie.EPo+" clear "+i.toString()),[3,7];case 7:return[2]}})})},o.prototype.checkItemsIsClear=function(e){return Io(this,void 0,void 0,function(){var t,n,r;return yo(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),this.an.info(ie.EPo+" checkIsClear call ".concat(e)),[4,this.vg.keys()];case 1:return t=i.sent(),n=t.filter(function(s){return s.indexOf(e)>-1}),this.an.info(ie.EPo+" checkIsClear filters ".concat(JSON.stringify(n))),[2,n.length>0];case 2:return r=i.sent(),this.an.warn(ie.EPo+" checkIsClear err ".concat(JSON.stringify(r))),[2,!0];case 3:return[2]}})})},o.prototype.getUnReportCachedDatas=function(e){return Io(this,void 0,void 0,function(){var t,n,r;return yo(this,function(i){switch(i.label){case 0:return[4,this.filterItems(e)];case 1:return t=i.sent(),n=[],t&&t.length>0?(r=t.filter(function(s){return s.indexOf("_head")>-1}),[4,this.readStoreDatas(r,t,this.vg)]):[3,3];case 2:n=i.sent(),i.label=3;case 3:return[2,n]}})})},o.prototype.filterItems=function(e){return Io(this,void 0,void 0,function(){var t,n;return yo(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.vg.keys()];case 1:return t=r.sent(),[2,e!==""?t.filter(function(i){return i.indexOf(e)===-1}):t];case 2:return n=r.sent(),this.an.warn(ie.EPo+" filter "+JSON.stringify(n)),[3,3];case 3:return[2]}})})},o.prototype.getOldStores=function(e){return this.refreshOldStores(e,"1")},o.prototype.refreshOldStores=function(e,t,n){if(this.an.info(ie.EPo+" refresh old ".concat(e," ").concat(t," ").concat(n)),!localStorage)return[];var r=localStorage.getItem(e);if(!(r!=null&&r.length))return this.an.info(ie.EPo+" refresh old no storage ".concat(e)),localStorage.removeItem(e),[];var i=r?r.split(","):[],s=[];if(i.length>0){for(var c=[],u=0;u<i.length;u++){var l=i[u].split("-"),a=l[0],h=l[1];this.an.info(ie.EPo+" refresh old stores: ".concat(a," ").concat(h)),t=="2"?a!==n&&c.push(a+"-"+h):t==="1"&&(s.push(a),c.push(a+"-"+t))}localStorage.setItem(e,c.join(","))}return s},o.prototype.removeOldStoreFromStorage=function(e,t){return Io(this,void 0,void 0,function(){return yo(this,function(n){switch(n.label){case 0:return t===this.dg?[3,2]:(this.an.info(ie.EPo+" remove old store ".concat(t)),[4,this.dropInstance(t)]);case 1:return n.sent(),this.refreshOldStores(e,"2",t),[3,3];case 2:this.an.info(ie.EPo+" not remove old self"),n.label=3;case 3:return[2]}})})},o.prototype.setDeleteKey=function(e,t){this.an.info(ie.EPo+" set del ".concat(e," ").concat(t));var n=this.getDeleteKey(),r=n.findIndex(function(i){return i===t});e==="add"?r===-1&&n.push(t):r>=0&&n.splice(r,1),this.an.info(ie.EPo+" set del keys ".concat(JSON.stringify(n))),localStorage.setItem(this.deletedKeys,n.join(","))},o.prototype.getDeleteKey=function(){var e=localStorage.getItem(this.deletedKeys),t=e?e.split(","):[];return this.an.info(ie.EPo+" get del keys ".concat(JSON.stringify(t))),t},o}(),Dp=function(){function o(e){e===void 0&&(e=""),this.mg=e,this.count=0,this.isStarting=!1,this.timer=0,this.lastLogTime=0,this.speed=0,this.lastTime=0}return o.prototype.add=function(e){this.isStarting&&(this.count+=e)},o.prototype.stop=function(){return this.isStarting=!1,this.reset()},o.prototype.start=function(e){var t=this;e===void 0&&(e=0),this.isStarting=!0,this.count=0,clearInterval(this.timer),e&&(this.timer=window.setInterval(function(){t.speed=t.count/e,t.count=0},e))},o.prototype.reset=function(){this.count=0,clearInterval(this.timer),this.timer=0,this.speed=0},o}(),$a=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},ec=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Qu=oo.logreport,lh=function(){function o(e,t,n){var r=this;this.an=e,this.pn=t,this.gn=n,this.pg=[],this.gg=[],this.bg=0,this.yg=0,this.wg=0,this.Sg=[],this.Eg=6e4,this.kg=!1,this.Ig={},this.Rg=6e4,this.Tg=20,this.Cg=!1,this.beforeunloadListener=function(){r.an.info("".concat(ie.MSI," beforeunload")),r.Ag.resetStorageStores()},this.Ag=new Ap(this.CacheKey,e,this),this.bindListener(),this.bindDestroyListener(),this.zg=new Dp("speed log")}return Object.defineProperty(o.prototype,"uploadCreateTime",{get:function(){return Math.round(this.yg/1e3)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"speed",{get:function(){return this.zg.speed},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"CacheKey",{get:function(){return"z_s_c2_"+this.pn.appid},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"oldCacheKey",{get:function(){return"z_s_c_"+this.pn.appid},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"billingTimer",{get:function(){return this.pn.streamCenter.billingTimer},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hasPublishingStream",{get:function(){var e,t=this.gn.publisherList,n=!1;for(var r in t)if(!((e=t[r].publisher)===null||e===void 0)&&e.Xh){n=!0;break}return n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Ng",{get:function(){var e=this.gn.playerList,t=!1;for(var n in e){var r=e[n];if(!(r!=null&&r.isProbe)&&(r!=null&&r.isStreaming)&&[E.ey.L3,E.ey.RTC].includes(r.playMode)){t=!0;break}}return t},enumerable:!1,configurable:!0}),o.prototype.checkIfSupportNTP=function(){var e,t=(e=this.pn.rtm)===null||e===void 0?void 0:e.getNetworkInfo().timestamp;t&&(this.an.info(ie.kEb+" use ntp. gap: "+(t-Date.now())),this.Cg=!0)},o.prototype.Pg=function(){var e=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i),t=navigator.userAgent,n=t.toLowerCase().match(/MicroMessenger/i)=="micromessenger",r=t.indexOf("Android")>-1||t.indexOf("Adr")>-1;return e||n&&r?"pagehide":"beforeunload"},o.prototype.bindListener=function(){var e=this.Pg();window.addEventListener(e,this.beforeunloadListener)},o.prototype.offListener=function(){var e=this.Pg();window.removeEventListener(e,this.beforeunloadListener)},o.prototype.bindDestroyListener=function(){var e=this;this.pn.listenerList._engineDestroy.push(function(){e.an.info("".concat(ie.MSI," _engineDestroy")),e.Ig={},e.Ag.resetStorageStores(),e.offListener()})},o.prototype.updateQualityOrChargeInfo=function(e,t,n){var r;this.an.info(ie.Tk2+" update info ".concat(e," ").concat(!!t));var i=this._now();!t||this.pg.length!==0||this.gg.length!==0||this.Mg&&((r=this.Mg)===null||r===void 0?void 0:r.infos.length)!==0||(this.yg=i,this._saveSpeedLogHead(),this.bg===0&&(this.bg=i)),t&&(e==nt.publish_quality?this.handlePublishQualityData(t):e==nt.play_quality?this.handlePlayQualityData(t):e==nt.charge&&this.handleChargeInfoData(t));var s=this.xg(),c=s>0,u=n&&c,l=s>8e3,a=this.bg!==0&&i-this.bg>this.Rg;(c&&a||l||u)&&(this.an.info(ie.Tk2+" start upload fire ".concat(l,",").concat(a,",").concat(u)),this.streamQualityUpload(this.yg,u),this.pg=[],this.gg=[],this.resetCharges(),this.yg=0,this.bg=i,this.checkHasDataToReport())},o.prototype.xg=function(){var e,t,n;if(this.pg.length>0||this.gg.length>0||((t=(e=this.Mg)===null||e===void 0?void 0:e.infos)===null||t===void 0?void 0:t.length)>0){var r=this._getSpeedLogHead(),i={publish_quality_infos:this.pg,play_quality_infos:this.gg,network_type:tr(),client_type:2};return this.Mg&&((n=this.Mg)===null||n===void 0?void 0:n.infos.length)>0&&(i.charge_infos=JSON.parse(JSON.stringify(this.Mg))),this._createStreamQualityPacket(r,i).byteLength}return 0},o.prototype.checkHasDataToReport=function(){this.an.info(ie.K74+" call"),this.gn.publishersLength||Object.keys(this.gn.playerList).length!==0||this.billingTimer.isReporting!==!1||(this.an.info(ie.K74+" no stream or charge to report"),this.bg=0),this.hasPublishingStream||this.Ng||this.billingTimer.shouldSampleCharge()||(this.an.info(ie.K74+" no data to report"),this.bg=0)},o.prototype.streamQualityUpload=function(e,t){var n,r,i,s=((r=(n=this.Mg)===null||n===void 0?void 0:n.infos)===null||r===void 0?void 0:r.length)>0;if(this.gn.publishersLength>0||Object.keys(this.gn.playerList).length>0||s||t){var c=this._getSpeedLogHead(),u={publish_quality_infos:this.pg,play_quality_infos:this.gg,network_type:tr(),client_type:2};this.Mg&&((i=this.Mg)===null||i===void 0?void 0:i.infos.length)>0&&(this.Mg.timestamp_offset_begin===this.Mg.timestamp_offset_end&&this.Mg.timestamp_diff===0?this.an.info(ie.Tk2+" no charge time"):(u.charge_infos=JSON.parse(JSON.stringify(this.Mg)),this.an.info(ie.Tk2+" upload charges ".concat(JSON.stringify({timestamp:e,chargeInfos:u.charge_infos}))))),this.uploadQuality(e,c,u)}},o.prototype._getStreamReportSocket=function(e){var t=this;return new te.l3(function(n,r){var i,s,c,u,l=!1,a=function(){var ke;t.an.info(ie.Tk2+" speed log socket open"),l=!0,t.zg.start(3e3),t.jg&&n(t.jg),(ke=t.jg)===null||ke===void 0||ke.removeEventListener("open",a)},h=function(){var ke;t.an.info(ie.Tk2+" speed log socket close"),l||r("not open, socket closed"),t.zg.stop(),(ke=t.jg)===null||ke===void 0||ke.removeEventListener("close",h)},m=function(){var ke;t.an.info(ie.Tk2+" speed log socket error"),l||r("not open, socket error"),(ke=t.jg)===null||ke===void 0||ke.removeEventListener("error",m)},S=function(){(function(){var ke;(ke=t.jg)===null||ke===void 0||ke.addEventListener("open",a)})(),function(){var ke,Pe;(ke=t.jg)===null||ke===void 0||ke.addEventListener("close",h),(Pe=t.jg)===null||Pe===void 0||Pe.addEventListener("error",m)}()};if(t.jg&&t.jg.readyState!=2&&t.jg.readyState!=3)t.jg.readyState==1?(l=!0,n(t.jg)):S();else{var x=t.pn.appid,q=t.pn.idName,V=(i=t.pn.roomList[0])===null||i===void 0?void 0:i.token;if(!x||!q||!V)return t.an.error(ie.Tk2+" appid userid token not exist"),void r("appid userid token not exist");var _e="wss://".concat(e,"/ws/report/stream?appid=").concat(x,"&product=rtc&token=").concat(encodeURIComponent(V),"&id_name=").concat(q);t.an.info(ie.Tk2+" stream url "+_e.split("?")[0]),t.jg=(s=_e,(u=1)===void 0&&(u=1),(c=p.proxyCtrl)?c.createSocket(s,u):new WebSocket(s)),S()}setTimeout(function(){l||t.pn.engineDestroy||r("not open, timeout, socket closed")},1e4)})},o.prototype._createStreamQualityPacket=function(e,t){var n=Qu.SpeedLogHead.create(e),r=Qu.QualityEvent.create(t),i=Qu.SpeedLogHead.encode(n).finish(),s=Qu.QualityEvent.encode(r).finish(),c=this.getQualityHead(i,s),u=new Uint8Array(12+i.length+s.length);return u.set(c),u.set(i,12),u.set(s,12+i.length),u},o.prototype.qg=function(e,t,n,r,i,s){var c=!1,u=!1;e.readyState!==1&&!u&&r&&r(),e.onmessage=function(l){(l.data+"").includes("success")?(!u&&n&&n(),c=!0):(!u&&r&&r(),c=!0),e.onmessage=null},this.zg.add(8*t.length),e.send(t),setTimeout(function(){c||(i&&i(),u=!0)},15e3)},o.prototype.uploadQuality=function(e,t,n,r){this.sendPacketReportData(e,t,n,r)},o.prototype.sendPacketReportData=function(e,t,n,r){var i,s=this,c=(i=this.an.url)===null||i===void 0?void 0:i.split("/")[2];if(c){if(this.checkNetworkIsAbnormal())return this.an.warn(ie.y4U+" ".concat(e," network is abnormal")),void this.saveReportPacketsToCache(e,t,n,r);s._getStreamReportSocket(c).then(function(u){if(s.kg)return s.an.warn(ie.y4U+" ".concat(e," is sending")),void s.saveReportPacketsToCache(e,t,n,r);var l=Date.now()%1e4;s.kg=!0;var a=s._createStreamQualityPacket(t,n);s.an.info(ie.y4U+" ".concat(e," send ").concat(l," ").concat(r," ").concat(a==null?void 0:a.byteLength)),s.qg(u,a,function(){return $a(s,void 0,void 0,function(){return ec(this,function(h){switch(h.label){case 0:return this.an.info(ie.y4U+" ".concat(e," send suc ").concat(l)),this.kg=!1,this.delStreamData(e),r?[4,this.Ag.removeStoreFromStorage(r)]:[3,2];case 1:h.sent(),h.label=2;case 2:return this.checkCachePacketsToReport(!0),[2]}})})},function(){s.an.info(ie.y4U+" ".concat(e," send error ").concat(l)),s.kg=!1,s.retryReportPackets(e,t,n,r)},function(){s.an.info(ie.y4U+" ".concat(e," send timeout ").concat(l)),s.kg=!1,s.retryReportPackets(e,t,n,r)},l)}).catch(function(u){u!=="appid userid token not exist"?(s.an.info(ie.y4U+" open socket error, retry upload quality event"),s.retryReportPackets(e,t,n,r)):s.an.info(ie.y4U+" stop retry upload quality event.")})}},o.prototype.retryReportPackets=function(e,t,n,r){this.an.info(ie.ivM+" retry packets"),this.saveReportPacketsToCache(e,t,n,r),this.checkCachePacketsToReport(!1)},o.prototype.checkCachePacketsToReport=function(e){var t=this;this.Lg&&clearTimeout(this.Lg),this.Eg=e?5e3:6e4,this.Lg=setTimeout(function(){var n=t.Sg.shift();if(n){var r=n.timeStampKey,i=n._SpeedLogHead,s=n._QualityEvent,c=n.storeName;t.an.info(ie.VdQ+" ".concat(r," ").concat(c)),t.sendPacketReportData(r,i,s,c)}else t.checkStorageDataToReport()},this.Eg)},o.prototype.saveReportPacketsToCache=function(e,t,n,r){this.an.info(ie.ifL+" call ".concat(e)),this.Sg.length>=this.Tg?this.an.info(ie.ifL+" ".concat(this.Sg.length)):this.Sg.find(function(i){return i.timeStampKey===e})||this.Sg.push({timeStampKey:e,_SpeedLogHead:t,_QualityEvent:n,storeName:r})},o.prototype.checkStorageDataToReport=function(){return $a(this,void 0,void 0,function(){var e;return ec(this,function(t){switch(t.label){case 0:return[4,this.Ag.getUnReportCachedDatas(this.yg===0?"":this.yg+"")];case 1:return e=t.sent(),this.uploadUnReportDatas(e),[2]}})})},o.prototype.getQualityHead=function(e,t){var n=new Uint8Array(12);n[0]=0,n[1]=12,n[2]=e.length>>8,n[3]=e.length-(n[2]<<8),n[4]=t.length>>24,n[5]=t.length-(n[4]<<24)>>16,n[6]=t.length-(n[4]<<24)-(n[5]<<16)>>8,n[7]=t.length-(n[4]<<24)-(n[5]<<16)-(n[6]<<8);var r=Math.ceil(this._now()/1e3);return n[8]=r>>24,n[9]=r-(n[8]<<24)>>16,n[10]=r-(n[8]<<24)-(n[9]<<16)>>8,n[11]=r-(n[8]<<24)-(n[9]<<16)-(n[10]<<8),n},o.prototype.handlePublishQualityData=function(e){var t,n=this.gn.getRoomByStreamID(e.stream_id),r=(t=this.gn.publisherList[e.stream_id])===null||t===void 0?void 0:t.publisher;if(n&&r){var i=r.id,s=this.pg.find(function(c){return c.stream_id==e.stream_id&&c.video_width==e.frameWidth&&c.video_height==e.frameHeight&&c.session_id==i});s||(s={stream_id:e.stream_id,session_id:i,video_width:e.frameWidth,video_height:e.frameHeight,infos:[],room_id:n?n.roomID:"",evnvironment:1,room_session_id:n?Number(n.roomSessionID):0,resource_type:2},e.ipv4&&(s.ipv4=e.ipv4,this.an.info("".concat(ie.KBL," stream_id: ").concat(e.stream_id,", ip: ").concat(s.ipv4," "))),e.ipv6&&(s.ipv6=e.ipv6,this.an.info("".concat(ie.KBL," stream_id: ").concat(e.stream_id," ip: ").concat(s.ipv6," "))),this.pg.push(s)),s.infos.push({audio_bitrate:Math.round(e.audioBitrate)||0,video_bitrate:Math.round(e.videoBitrate)||0,video_capture_fps:Math.round(10*e.videoFPS)||0,video_network_fps:Math.round(10*e.videoTransferFPS)||0,uplink_plr:e.audioPacketsLostRate,rtt:Math.round(1e3*e.currentRoundTripTime)||0,audio_network_fps:Math.round(10*e.audioFPS),captured_sound_level:Math.round(100*e.audioLevel),sample_time_offset:Math.round((this._now()-this.yg)/10)}),this.saveStreamInfo("publish",s)}else this.an.info("".concat(ie.KBL," room not exist. ").concat(!!n," "))},o.prototype.handlePlayQualityData=function(e){var t=this.gn.getRoomByStreamID(e.stream_id),n=this.gn.playerList[e.stream_id];if(n&&t){var r={l3:3,rtc:2,cdn:2}[n.playMode],i=n.id,s=this.gg.find(function(c){return c.stream_id==e.stream_id&&c.video_width==e.frameWidth&&c.video_height==e.frameHeight&&c.resource_type==r&&c.session_id==i});s||(s={stream_id:e.stream_id,session_id:i,video_width:e.frameWidth,video_height:e.frameHeight,infos:[],room_id:t?t.roomID:"",room_session_id:t?Number(t.roomSessionID):0,resource_type:r},e.ipv4&&(s.ipv4=e.ipv4,this.an.info("".concat(ie.RM$," ").concat(e.stream_id," ip ").concat(s.ipv4," "))),e.ipv6&&(s.ipv6=e.ipv6,this.an.info("".concat(ie.RM$," ").concat(e.stream_id," ip ").concat(s.ipv6," "))),this.gg.push(s)),s.infos.push({audio_bitrate:Math.round(e.audioBitrate)||0,video_bitrate:Math.round(e.videoBitrate)||0,video_network_fps:Math.round(10*e.videoFPS)||0,downlink_plr:Math.round(e.audioPacketsLostRate)||0,audio_network_fps:Math.round(10*e.audioFPS)||0,audio_break_duration:Math.round(e.audio_break_duration/10),video_break_duration:Math.round(e.video_break_duration/10),rtt:Math.round(1e3*e.currentRoundTripTime)||0,rendered_sound_level:Math.round(100*e.audioLevel),audio_break_cancel_duration:Math.round(e.audio_break_cancel_duration/10),video_break_cancel_duration:Math.round(e.video_break_cancel_duration/10),audio_decode_time:Math.round(e.audio_decode_time/10),video_decode_time:Math.round(e.video_decode_time/10),real_sampling_interval:Math.round(e.real_sampling_interval/10),video_frames_decoded:Math.round(e.videoFramesDecoded)||0,video_frames_dropped:Math.round(e.videoFramesDropped)||0,sample_time_offset:Math.round((this._now()-this.yg)/10),peer_to_peer_plr:e.peerToPeerPacketLostRate,peer_to_peer_delay:e.peerToPeerDelay}),this.saveStreamInfo("play",s)}else this.an.info("".concat(ie.RM$," player or room not exist. ").concat(!!n," ").concat(!!t," "))},o.prototype.handleChargeInfoData=function(e){var t,n;this.Mg||(this.Mg={room_id:"",timestamp_offset_begin:0,timestamp_offset_end:0,timestamp_diff_flag:0,timestamp_diff:0,infos:[]}),!((t=this.pn.roomList[0])===null||t===void 0)&&t.roomID&&(this.Mg.room_id=(n=this.pn.roomList[0])===null||n===void 0?void 0:n.roomID);var r=this._now(),i=this.yg;this.an.info("".concat(ie._ny," charge ").concat(r," ").concat(i," ").concat(JSON.stringify(e))),this.Mg.infos.length===0&&(this.Mg.timestamp_offset_begin=Math.round((r-i)/1e3),this.wg!==0&&(this.Mg.timestamp_diff=Math.round((r-this.wg)/1e3),this.Mg.timestamp_diff_flag=1,this.an.info("".concat(ie._ny," charge time diff ").concat(this.wg," ").concat(this.Mg.timestamp_diff)))),this.wg=r,this.Mg.timestamp_offset_end=Math.round((r-i)/1e3),this.Mg.infos.push(e),this.saveChargeInfos(this.Mg)},o.prototype.supplementChargeTime=function(){this.wg===0&&(this.wg=this._now(),this.an.info("".concat(ie.SK," charge time ").concat(this.wg," ")))},o.prototype.resetCharges=function(){this.Mg&&(this.Mg={room_id:"",timestamp_offset_begin:0,timestamp_offset_end:0,timestamp_diff_flag:0,timestamp_diff:0,infos:[]})},o.prototype.resetChargeTime=function(){this.wg=0},o.prototype.stopSampleCharge=function(){this.resetChargeTime(),this.checkHasDataToReport()},o.prototype._saveSpeedLogHead=function(){if(this.yg!==0){var e=this._getSpeedLogHead();this.Ag.saveItem(this.yg+"_head",e)}},o.prototype.saveStreamInfo=function(e,t){this.yg!==0&&this.Ag.saveItem("".concat(this.yg,"_").concat(e).concat(t.stream_id),t)},o.prototype.saveChargeInfos=function(e){this.yg!==0&&this.Ag.saveItem("qec_".concat(this.yg),e)},o.prototype.delStreamData=function(e){var t=this.Sg.findIndex(function(n){return n.timeStampKey===e});t>-1&&(this.an.info("".concat(ie.MSI," del cache ").concat(t," ").concat(e)),this.Sg.splice(t,1)),this.clearStoreItems(e+"")},o.prototype.clearStoreItems=function(e){var t=this;this.an.info("".concat(ie.JX$," clearStoreItems ").concat(e)),this.Ag.setDeleteKey("add",e),this.Ag.clearItems(e),setTimeout(function(){return $a(t,void 0,void 0,function(){return ec(this,function(n){switch(n.label){case 0:return[4,this.checkClear(e)];case 1:return n.sent(),[2]}})})},1e3)},o.prototype.checkClear=function(e){return $a(this,void 0,void 0,function(){var t,n=this;return ec(this,function(r){switch(r.label){case 0:return this.an.info("".concat(ie.IGr," call ").concat(e)),[4,this.Ag.checkItemsIsClear(e)];case 1:return t=r.sent(),this.Ig[e]?this.Ig[e]++:this.Ig[e]=1,t?(this.an.info("".concat(ie.IGr," count ").concat(e," ").concat(this.Ig[e])),this.Ig[e]&&this.Ig[e]<=5&&(this.Ag.clearItems(e),setTimeout(function(){return $a(n,void 0,void 0,function(){return ec(this,function(i){switch(i.label){case 0:return[4,this.checkClear(e)];case 1:return i.sent(),[2]}})})},1e3))):delete this.Ig[e],[2]}})})},o.prototype._getSpeedLogHead=function(e){return{version:20,timestamp:e||Math.round(this.yg/1e3),event:0,app_id:this.pn.appid,user_id:this.pn.idName,biz_type:1,time_offset:di.A.MAX_VALUE,os_type:(0,Vn.hU)(),scenario:this.pn.scenario===100?void 0:this.pn.scenario,sdk_version:E.qt,report_version:this.pn.sdkVerNum,customer_context:o.reportCustomerContext}},o.prototype.checkStreamReport=function(){var e=this;this.an.info("".concat(ie.MSI," check un report call"));var t=this.Ag.getStoresFromStorage(),n=t[0],r=t[1];this.an.info("".concat(ie.MSI," store: ").concat(n==null?void 0:n.length,", old: ").concat(r==null?void 0:r.length));for(var i=function(h){var m=n[h];s.Ag.getCacheStoreData(m).then(function(S){e.an.info("".concat(ie.MSI," check un report ").concat(m," ").concat(S==null?void 0:S.length)),e.uploadUnReportDatas(S,m)}).catch(function(S){e.an.info("".concat(ie.MSI," check un report fail ").concat(m," ").concat(S==null?void 0:S.message))})},s=this,c=0;c<n.length;c++)i(c);for(var u=function(h){var m=r[h];l.an.info("".concat(ie.MSI," old ").concat(m," check un report")),l.Ag.getCacheStoreData(m).then(function(S){e.an.info("".concat(ie.MSI," old check un report ").concat(m," ").concat(S==null?void 0:S.length)),e.uploadUnReportDatas(S,m)}).catch(function(S){e.an.info("".concat(ie.MSI," old check un report fail ").concat(m," ").concat(S==null?void 0:S.message))})},l=this,a=0;a<r.length;a++)u(a)},o.prototype.uploadUnReportDatas=function(e,t,n){return $a(this,void 0,void 0,function(){var r=this;return ec(this,function(i){switch(i.label){case 0:return this.pn.roomList.length<=0?(this.an.warn(ie.kkS+" no room"),[2]):(e==null?void 0:e.length)>0?(e.forEach(function(s){var c,u,l=s.timestamp,a=s.head,h=s.publishInfos,m=s.playInfos,S=s.chargeInfos;if(r.an.info("".concat(ie.kkS," cacheData publish ").concat(l," ").concat(JSON.stringify(h))),r.an.info("".concat(ie.kkS," cacheData play ").concat(l," ").concat(JSON.stringify(m))),r.an.info("".concat(ie.kkS," cacheData charge ").concat(l," ").concat(JSON.stringify(S))),r.an.info("".concat(ie.kkS," cacheData ").concat(l," ").concat(r.Ig[l])),r.Ig[l])r.an.info("".concat(ie.kkS," the data ").concat(l," report"));else{var x={publish_quality_infos:h,play_quality_infos:m,network_type:tr(),client_type:2};((c=S==null?void 0:S.infos)===null||c===void 0?void 0:c.length)>0&&(x.charge_infos=JSON.parse(JSON.stringify(S))),t&&(r.an.info("".concat(ie.kkS," save ").concat(l," ").concat(t)),r.Ag.saveItem(l+"_head",a),h.forEach(function(q){r.Ag.saveItem("".concat(l,"_publish").concat(q.stream_id),q)}),m.forEach(function(q){r.Ag.saveItem("".concat(l,"_play").concat(q.stream_id),q)}),((u=S==null?void 0:S.infos)===null||u===void 0?void 0:u.length)>0&&r.Ag.saveItem("qec_".concat(l),S)),r.an.info(ie.Tk2+" start upload cache quality. ".concat(l)),r.saveReportPacketsToCache(l,a,x)}}),t?(this.an.info(ie.Tk2+" remove storage store ".concat(n," ").concat(t)),n?[4,this.Ag.removeOldStoreFromStorage(n,t)]:[3,2]):[3,4]):[3,5];case 1:return i.sent(),[3,4];case 2:return[4,this.Ag.removeStoreFromStorage(t)];case 3:i.sent(),i.label=4;case 4:this.checkCachePacketsToReport(!0),i.label=5;case 5:return[2]}})})},o.prototype.reportOldCacheData=function(){var e=this,t=this.Ag.getOldStores(this.oldCacheKey),n="zc.sqrw.rlcd.0";this.an.info("".concat(n," old: ").concat(t==null?void 0:t.length));for(var r=function(c){var u=t[c];i.an.info("".concat(n," old ").concat(u," check un report")),i.Ag.getCacheStoreData(u,i.oldCacheKey).then(function(l){e.an.info("".concat(n," old check un report ").concat(u," ").concat(l==null?void 0:l.length)),e.uploadUnReportDatas(l,u,e.oldCacheKey)}).catch(function(l){e.an.info("".concat(n," old check un report fail ").concat(u," ").concat(l==null?void 0:l.message))})},i=this,s=0;s<t.length;s++)r(s)},o.prototype._now=function(e){var t;return e===void 0&&(e=0),t=this.Cg?this.pn.rtm.getNetworkInfo().timestamp:Date.now(),e===1&&(t=Math.round(t/1e3)),t},o.prototype.checkNetworkIsAbnormal=function(){var e;return!((e=this.pn.rtm)===null||e===void 0)&&e.isDisConnect()&&this.pn.networkState==E.D2.offline?(this.an.warn(ie.Q9_+" offline. "),!0):!this.gn.isNetAgentConnect()&&(this.an.warn(ie.Q9_+" netAgent disconnect. "),!0)},o.prototype.resetReport=function(){var e=this;this.pg=[],this.gg=[],this.yg=0,this.bg=0,this.Lg&&(clearTimeout(this.Lg),this.Lg=null),setTimeout(function(){e.jg&&(e.jg.close(),e.jg=void 0,e.kg=!1,e.zg.stop())},2e4)},o.reportCustomerContext=0,o}();function Op(){var o={},e=this,t=-10;function n(i){return/[^\x20-\x7E]+/.test(i)}var r={init:function(i,s){var c="",u=0;try{importScripts(i),e._ModuleFn(o),c="suc",u=0}catch(l){u=-1,c="fail "+(l==null?void 0:l.message)}e.postMessage({code:u,errMsg:c,eventId:s}),e.postMessage({code:t,msg:"init webassembly "+c})},parseToMiniSdp:function(i,s){var c=o._parseToMiniSdp,u=o.allocateUTF8,l=o._getBuffer,a=o.HEAPU8,h=o._free;e.postMessage({code:t,msg:"ptm call"});var m=u(i);e.postMessage({code:t,msg:"ptm allocate"});var S=c(m);if(e.postMessage({code:t,msg:"ptm bufLen "+S}),S<0)return e.postMessage({code:S,eventId:s});var x=l();e.postMessage({code:t,msg:"ptm getBuf "+x});var q=new Uint8Array(a.subarray(x,x+S-1))||new Uint8Array;e.postMessage({code:0,data:q,eventId:s});try{h(m),h(S),h(x)}catch(V){e.postMessage({code:t,msg:"ptm free e "+(V==null?void 0:V.message)||0})}},loadMiniSdpToOriginSdp:function(i,s){var c,u,l,a,h=o._loadMiniSdpToSdp,m=o.UTF8ToString,S=o._malloc,x=o.HEAPU8,q=o._free;e.postMessage({code:t,msg:"lmto call"});var V=S(i.length);e.postMessage({code:t,msg:"lmto malloc"}),x.set(i,V);var _e=h(V,i.byteLength);e.postMessage({code:t,msg:"lmto s"});var ke=m(_e)||"";e.postMessage({code:t,msg:"lmto o "+ke.length});for(var Pe=ke.split(`\r
`)||[],Oe=["ice-ufrag","ice-pwd","ice-options","fingerprint","setup","mid","extmap","sendrecv","sendonly","recvonly","inactive","rtpmap","rtcp-fb","fmtp","ssrc","candidate","msid"];Pe.length;){var Ge=Pe.length,Je=(u=(c=Pe[Ge-1])===null||c===void 0?void 0:c.split("=")[1])===null||u===void 0?void 0:u.split(":")[0],tt=Pe[Ge-1];if(((l=Pe[Ge-1])===null||l===void 0?void 0:l.indexOf("="))!=-1&&Oe.includes(Je)&&((a=Pe[Ge-1])===null||a===void 0?void 0:a.indexOf("="))!=0&&!n(tt))break;Pe.pop()}ke=Pe.join(`\r
`),e.postMessage({code:0,data:ke+=`\r
`,eventId:s});try{q(V)}catch(ut){e.postMessage({code:t,msg:"lmto free "+(ut==null?void 0:ut.message)})}}};onmessage=function(i){var s;r[i.data.command]?r[i.data.command](i.data.val,i.data.eventId):e.postMessage({code:t,msg:"om cmd invalid "+((s=i==null?void 0:i.data)===null||s===void 0?void 0:s.command)})}}var Xl,Np=pt(8754).G,tc=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},nc=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},dh=function(){function o(e){var t=this;this.an=e,this.initOK=!1,this.Bg={},this.seq=1;var n=Op.toString().trim().match(/\{([\s\S]*)\}/)[1],r=URL.createObjectURL(new window.Blob([n],{type:"text/javascript"}));this.Ug=new Worker(r);var i=function(u){for(var l=(u+"=".repeat((4-u.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),a=window.atob(l),h=new Uint8Array(a.length),m=0;m<a.length;++m)h[m]=a.charCodeAt(m);return h}("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"),s=Np.decompress(Array.from(i)),c=URL.createObjectURL(new window.Blob([s],{type:"text/javascript"}));this.Ug.onmessage=function(u){var l=u.data;l.eventId&&(0,R.JO)(t.Bg[l.eventId])?(t.Bg[l.eventId]({code:l.code,data:l.data}),delete t.Bg[l.eventId]):(l==null?void 0:l.code)===-10&&t.an.info("zc.ms.0.w "+l.msg)},this.Ug.onmessageerror=function(u){console.error("Error receiving message from worker: ".concat(u))},this.Ug.onerror=function(u){t.initOK=!1,t.an.warn("zc.ms.0.c worker err "+(u==null?void 0:u.message)||0)},this.initWasm(c).then(function(){t.initOK=!0}).catch(function(u){t.initOK=!1})}return o.prototype.messageHandler=function(e){var t=this;return new te.l3(function(n){e.eventId="".concat(e.command,"_").concat(t.seq++),t.Ug.postMessage(e),t.Bg[e.eventId]=function(r){n(r)}})},o.prototype.initWasm=function(e){return tc(this,void 0,void 0,function(){var t=this;return nc(this,function(n){return[2,new Promise(function(r,i){return tc(t,void 0,void 0,function(){var s;return nc(this,function(c){switch(c.label){case 0:return this.an.info("zc.ms.0.c init"),[4,this.messageHandler({command:"init",val:e})];case 1:return(s=c.sent()).code===0?r(!0):(this.an.warn("zc.ms.0.c fail "+s.errMsg),i(!1)),[2]}})})})]})})},o.prototype.parseToMiniSdp=function(e){return tc(this,void 0,void 0,function(){var t=this;return nc(this,function(n){return[2,new te.l3(function(r,i){return tc(t,void 0,void 0,function(){var s,c;return nc(this,function(u){switch(u.label){case 0:return(0,R.QP)(e)&&e?this.initOK?[4,this.messageHandler({command:"parseToMiniSdp",val:e})]:(i(Et.KbN),[2]):(i(Et.ZEp),[2]);case 1:if((s=u.sent()).code===0)r(s.data);else{switch(c=void 0,s.code){case-1:c=Et.GY7;break;case-2:c=Et.sP3;break;case-3:c=Et._9F}i(c)}return[2]}})})})]})})},o.prototype.loadMiniSdpToOriginSdp=function(e){return tc(this,void 0,void 0,function(){var t=this;return nc(this,function(n){return[2,new te.l3(function(r,i){return tc(t,void 0,void 0,function(){var s;return nc(this,function(c){switch(c.label){case 0:return(0,R.G0)(e)?this.initOK?[4,this.messageHandler({command:"loadMiniSdpToOriginSdp",val:e})]:(i(Et.KbN),[2]):(i(Et.ZEp),[2]);case 1:return(s=c.sent()).code==0&&r(s.data),[2]}})})})]})})},Object.defineProperty(o,"isSupported",{get:function(){return!(!window.WebAssembly||!window.Worker)},enumerable:!1,configurable:!0}),o.prototype.destroy=function(){this.Ug.terminate()},o}();(function(o){o.SAVED_CHARGEINFO_REPORT="zc.bill.scir",o.CHARGEINFO_SAVING_LOCALSTORAGE="zc.bill.cisl",o.CHARGEINFO_GET_AND_REMOVE_LOCALSTORAGE="zc.bill.cigrl",o.START_CHARGE_INFO_TIMER="zc.bill.tm.scit"})(Xl||(Xl={}));var $l,Lp=function(){function o(e,t){this.an=e,this.pn=t,this.Gg=5e3,this.Jg=!1}return Object.defineProperty(o.prototype,"gn",{get:function(){return this.pn.streamCenter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Fg",{get:function(){var e;return(e=this.gn)===null||e===void 0?void 0:e.Fg},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Hg",{get:function(){return Object.values(this.gn.playerList).filter(function(e){return(e==null?void 0:e.isProbe)===!1}).length},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hasPublishingStream",{get:function(){var e,t=this.gn.publisherList,n=!1;for(var r in t)if(!((e=t[r].publisher)===null||e===void 0)&&e.Xh){n=!0;break}return n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"hasPlayingRTCAndL3Stream",{get:function(){var e,t,n=this.gn.playerList,r=!1;for(var i in n)if(!(!((e=n[i])===null||e===void 0)&&e.isProbe)&&(!((t=n[i])===null||t===void 0)&&t.isStreaming)&&[E.ey.RTC,E.ey.L3].includes(n[i].playMode)){r=!0;break}return r},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"shouldEndSampleCharge",{get:function(){var e,t;return!this.gn||!!this.Jg&&(this.shouldReportRoomTime?((e=this.pn.rtm)===null||e===void 0?void 0:e.stateCenter.roomModulesList.filter(function(n){return!n.isLogout()||!n.isDisConnect()}).length)===0:((t=this.pn.appConfig.speedlog_config)===null||t===void 0?void 0:t.charge_info_report_mode)===0?this.gn.publishersLength===0:this.Hg===0)},enumerable:!1,configurable:!0}),o.prototype.report=function(e){var t,n,r;if(e===void 0&&(e=!1),this.an.info("zc.bill.tm.r.0 call"),this.gn){if(e)return this.an.info("zc.bill.tm.r.0 stop"),void((t=this.Fg)===null||t===void 0||t.updateQualityOrChargeInfo(nt.charge,void 0,!0));if(!this.shouldSampleCharge())return this.an.info("zc.bill.tm.r.0 not sample charge"),(n=this.Fg)===null||n===void 0||n.updateQualityOrChargeInfo(nt.charge,void 0),void this.Fg.resetChargeTime();var i=this.samplingChargeInfos();(r=this.Fg)===null||r===void 0||r.updateQualityOrChargeInfo(nt.charge,i)}else this.an.info("zc.bill.tm.r.0 no stream center")},o.prototype.shouldStartReportCharge=function(){if(!this.pn.appConfig)return this.an.info("zc.bill.ssrc.0 no app config"),!1;var e=this.pn.appConfig.speedlog_config.charge_info_report_cycle;return this.an.info("zc.bill.ssrc.0 speedlog config ".concat(JSON.stringify(this.pn.appConfig.speedlog_config))),!(!(0,R.Cs)(e)||e===0)&&(this.Gg=1e3*e,!0)},o.prototype.shouldSampleCharge=function(){var e,t=this;if(!this.pn.appConfig)return this.an.info("zc.bill.ssc.0 no app config"),!1;var n=this.pn.appConfig.speedlog_config,r=n.charge_info_report_mode,i=n.charge_info_report_no_playing,s=!1,c=(e=this.pn.rtm)===null||e===void 0?void 0:e.stateCenter.roomModulesList.filter(function(l){return!l.isLogout()}),u=function(l){return l===1||t.hasPublishingStream};return i===1?(c==null?void 0:c.length)!==0&&(this.hasPlayingRTCAndL3Stream||this.Hg===0)&&(s=u(r)):i!==0&&i!==void 0||!this.hasPlayingRTCAndL3Stream||(s=u(r)),s},Object.defineProperty(o.prototype,"shouldReportRoomTime",{get:function(){var e,t,n,r;return!(!(!((e=this.pn.rtm)===null||e===void 0)&&e.stateCenter.appConfig)||!(!((t=this.pn.rtm)===null||t===void 0)&&t.stateCenter.appConfig.speedlog_config)||((n=this.pn.rtm)===null||n===void 0?void 0:n.stateCenter.appConfig.speedlog_config.charge_info_report_cycle)===0||((r=this.pn.rtm)===null||r===void 0?void 0:r.stateCenter.appConfig.speedlog_config.charge_info_report_no_playing)!==1)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isReporting",{get:function(){return this.Jg},enumerable:!1,configurable:!0}),o.prototype.startChargeInfoTimer=function(){var e=this;if(this.Vg&&(clearTimeout(Number(this.Vg)),this.Vg=null,this.shouldEndSampleCharge))return this.an.info(Xl.START_CHARGE_INFO_TIMER+" chargeinfos timer report ended"),void(this.Jg=!1);this.Vg=setTimeout(function(){e.report(),e.startChargeInfoTimer()},this.Gg)},o.prototype.supplementPlayingChargeTime=function(){this.Jg&&this.Fg.supplementChargeTime()},o.prototype.startChargeInfosUpload=function(){this.shouldStartReportCharge()&&(this.Jg||(this.Jg=!0,this.shouldReportRoomTime&&this.report(),this.startChargeInfoTimer(),this.an.info("zsc.sciu.0 call")))},o.prototype.stopChargeInfosUpload=function(){this.an.info("zsc.sciu.1 call"),this.Vg&&this.shouldEndSampleCharge&&(this.an.info("zsc.sciu.1 stop"),clearTimeout(Number(this.Vg)),this.Vg=null,this.shouldReportRoomTime&&this.report(!0),this.Jg=!1,this.Fg.stopSampleCharge(),this.an.info("zsc.sciu.1 chargeinfos timer report ended"))},o.prototype.destroy=function(){this.an.info("zsc.ds.0 call"),this.Vg&&(clearTimeout(Number(this.Vg)),this.Vg=null),this.Jg=!1},o.prototype.samplingChargeInfos=function(){var e,t;this.an.info("zsc.cci.0 call");var n={is_publishing:0,no_playing:0},r=this.gn,i=r.publisherList,s=r.playerList;for(var c in i){i[c].publisher.state===6&&(n.is_publishing=1);break}var u=function(a){var h=s[a];if(h.isProbe||!h.isStreaming||![E.ey.RTC,E.ey.L3].includes(h.playMode))return"continue";h.playMode===E.ey.RTC?(n.play_max_audio_bitrate===void 0&&(n.play_max_audio_bitrate=0),n.play_stream_resolution_infos===void 0&&(n.play_stream_resolution_infos=[])):h.playMode===E.ey.L3&&(n.play_l3_max_audio_bitrate===void 0&&(n.play_l3_max_audio_bitrate=0),n.play_l3_stream_resolution_infos===void 0&&(n.play_l3_stream_resolution_infos=[]));var m={width:h.qualityHandler.Uv.frameWidth,height:h.qualityHandler.Uv.frameHeight},S={video_width:m&&m.width?m.width:0,video_height:m&&m.height?m.height:0,count:1};(function(x){var q,V=x===E.ey.L3,_e=x===E.ey.RTC;if(_e?q=n.play_stream_resolution_infos:V&&(q=n.play_l3_stream_resolution_infos),!(q!=null&&q.find(function(Pe){return Pe.video_width==S.video_width&&Pe.video_height==S.video_height&&(Pe.count++,!0)}))&&(q==null||q.push(S)),S.video_width==0&&S.video_height==0){var ke=h.qualityHandler.Uv.audioBitrate;_e?ke>n.play_max_audio_bitrate&&(n.play_max_audio_bitrate=Math.round(ke)):V&&ke>n.play_l3_max_audio_bitrate&&(n.play_l3_max_audio_bitrate=Math.round(ke))}})(h.playMode)};for(var l in s)u(l);return!this.shouldReportRoomTime||n.play_stream_resolution_infos&&((e=n.play_stream_resolution_infos)===null||e===void 0?void 0:e.length)!==0||n.play_l3_stream_resolution_infos&&((t=n.play_l3_stream_resolution_infos)===null||t===void 0?void 0:t.length)!==0||(n.no_playing=1),n},o}(),Mp=function(){function o(){this.Qg={},this.Yg=500}return o.prototype.isTrackStopBySDK=function(e){return this.Qg[e.id]!==void 0&&performance.now()-this.Qg[e.id]<=this.Yg},o.prototype.recordStopTrack=function(e){e&&(this.Qg[e.id]=performance.now())},o}(),xp=function(){function o(e){this.an=e,this.Kg=new Mp}return o.prototype.isTrackStopBySDK=function(e){return this.Kg.isTrackStopBySDK(e)},o.prototype.stopTrack=function(e){e&&(this.an.info("zc.tk.ut track "+e.id+" stop"),this.Kg.recordStopTrack(e),e.stop())},o}();function Bp(){var o=this,e=243,t=new Uint8Array([0,0,0,1,101,184,0,4,0,0,9,255,254,222,35,192,166,30,73,128]),n=new Uint8Array([0,0,0,1,103,77,64,51,140,141,78,64,60,34,17,168,0,0,0,1,104,238,60,128]),r=new Uint8Array([0,0,0,1,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,30,186,2,64,0,0,0,1,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,30,160,136,69,150,233,111,11,128,64,0,0,3,0,64,0,0,3,3,194,0,0,0,1,68,1,192,115,192,137]),i=new Uint8Array([0,0,0,1,40,1,172,26,224,244,133,49,47,246,227,105,128]),s={},c={},u={},l={},a=function(){function Pe(Oe,Ge){Ge===void 0&&(Ge=!1),this.view=Oe,this.isH265=Ge,this.offset=0,this.current_start_code_size=0,this.current_nalu_start=0,this.current_nalu_size=0,this.start_code_size=0,this.nalu_start=0,this.left_size=0,this.nalu_size=0,this.left_size=Oe.byteLength}return Pe.prototype.FindStartCode=function(){var Oe=this.view.byteLength-this.offset;for(this.current_start_code_size=0,this.current_nalu_start=-1;Oe>=3;){if(this.view.getUint8(this.offset)==0&&this.view.getUint8(this.offset+1)==0&&this.view.getUint8(this.offset+2)==1)return this.current_start_code_size=3,this.current_nalu_start=this.offset,this.offset-1>=0&&this.view.getUint8(this.offset-1)==0&&(++this.current_start_code_size,--this.current_nalu_start),this.offset+=3,!0;--Oe,++this.offset}return!1},Pe.prototype.FindNalu=function(){return this.start_code_size=0,this.nalu_start=0,this.nalu_size=0,!(this.offset>=this.view.byteLength)&&!!this.FindStartCode()&&(this.start_code_size=this.current_start_code_size,this.nalu_start=this.current_nalu_start,!0)},Pe.prototype.NextNalu=function(Oe){if(this.start_code_size=0,this.nalu_start=0,this.nalu_size=0,this.offset>=this.view.byteLength||!this.FindStartCode())return!1;if(this.start_code_size=this.current_start_code_size,this.nalu_start=this.current_nalu_start,Oe){if(this.isH265){if((126&this.view.getUint8(this.nalu_start+this.start_code_size))>>1!==39)return!0}else if((31&this.view.getUint8(this.nalu_start+this.start_code_size))!=6)return!0}return this.FindStartCode()?(this.offset=this.current_nalu_start,this.nalu_size=this.current_nalu_start-this.nalu_start,!0):(this.nalu_size=this.view.byteLength-this.nalu_start,!0)},Pe}();function h(Pe,Oe){Oe===void 0&&(Oe=0);for(var Ge=Pe.length,Je=[],tt=0;tt<Ge;)tt>=Oe&&Ge-tt>=3&&!Pe[tt]&&!Pe[tt+1]&&Pe[tt+2]==3?(Je.push(Pe[tt++]),Je.push(Pe[tt++]),tt++):Je.push(Pe[tt++]);var ut=new Uint8Array(Je);return{output:ut,outLength:ut.length}}function m(Pe){return Uint8Array.from(Array.from(unescape(encodeURIComponent(Pe))).map(function(Oe){return Oe.charCodeAt(0)}))}function S(Pe){var Oe=0,Ge=0;return Oe=Pe[Ge++]<<24,Oe|=Pe[Ge++]<<16,Oe|=Pe[Ge++]<<8,Oe|=Pe[Ge++]}function x(Pe,Oe,Ge){var Je=Pe.byteLength,tt=parseInt(Je/255),ut=Je%255,vt=new ArrayBuffer(1+(tt+1)+Je+1),gt=new DataView(vt),Pt=0;gt.setUint8(Pt++,Oe===1?5:e);for(var wt=0;wt<tt;wt++)gt.setUint8(Pt++,255);gt.setUint8(Pt++,ut);var At=new DataView(Pe);for(wt=0;wt<(Pe==null?void 0:Pe.byteLength);wt++)gt.setInt8(Pt++,At.getInt8(wt));gt.setInt8(Pt++,128);var Vt=new Uint8Array(vt),qt=Vt;if(Ge){var Gt=function(Sn){for(var Qt=[],Wt=Sn.length,zt=0,Mt=0;Mt<Wt;++Mt){var jt=Sn[Mt];jt<=3&&zt>=2&&(Qt.push(3),zt=0),Qt.push(Sn[Mt]),jt==0?++zt:zt=0}var Kt=new Uint8Array(Qt);return{output:Kt,outLength:Kt.length}}(Vt).output;qt=Gt}return{rbspView:qt,ebspLength:qt.length}}function q(Pe,Oe,Ge,Je,tt){var ut=void 0,vt=tt[Je],gt=vt.isLowStream,Pt=vt.kind,wt=vt.vCodec;if(Pt=Pt||"video",gt=gt||!1,Pe==="encode"?ut=function(Vt,qt){Pt==="audio"?qt.enqueue(Vt):vt.onlyAudio?function(Gt,Sn,Qt,Wt,zt){var Mt,jt,Kt,$t=s[Qt];if($t){var yt=Wt?$t.lowStreamSideInfos:$t.sideInfos,Pn=0,pn=Gt.type==="key",un=performance.now(),ln=!1,Mn=(jt=(Mt=Gt.getMetadata)===null||Mt===void 0?void 0:Mt.call(Gt))===null||jt===void 0?void 0:jt.mimeType;ln=Mn?(Kt=Mn==null?void 0:Mn.includes("H265"))!==null&&Kt!==void 0&&Kt:zt==="H265";var Hn=0,xi=[];if(yt.length>0){for(var vi=yt.length>=9?9:yt.length,yr=0;yr<vi;yr++){var Ur=x(yt[yr],$t.type,$t.emulationPreventionByte);Hn+=4+(ln?2:1)+(Jt=Ur.ebspLength),xi.push(Ur)}Wt?$t.lowStreamSideInfos=[]:$t.sideInfos=[],un-$t.recvLastKeyFrameTime>2e3&&(pn=!0)}ln&&!pn&&un-$t.recvLastKeyFrameTime>2e3&&(pn=!0),pn&&(Pn=ln?r.length+i.length:n.length+t.length);var Gr=new ArrayBuffer(Hn+Pn),Nr=new DataView(Gr),ni=0;if(pn)if(ln){var co=new DataView(r.buffer);for(gi=0;gi<r.length;gi++)Nr.setInt8(ni++,co.getInt8(gi))}else for(var Ho=new DataView(n.buffer),gi=0;gi<n.length;gi++)Nr.setInt8(ni++,Ho.getInt8(gi));for(yr=0;yr<xi.length;yr++){var Hi=xi[yr],Pi=Hi.rbspView,Jt=Hi.ebspLength;Nr.setUint8(ni++,0),Nr.setUint8(ni++,0),Nr.setUint8(ni++,0),Nr.setUint8(ni++,1),ln?(Nr.setUint8(ni++,78),Nr.setUint8(ni++,1)):Nr.setUint8(ni++,6);for(var Bi=0;Bi<Jt;Bi++)Nr.setInt8(ni++,Pi[Bi-0])}if(pn)if(ln){var Go=new DataView(i.buffer);for(gi=0;gi<i.length;gi++)Nr.setInt8(ni++,Go.getInt8(gi))}else{var Ki=new DataView(t.buffer);for(gi=0;gi<t.length;gi++)Nr.setInt8(ni++,Ki.getInt8(gi))}Gt.data=Gr,pn&&($t.recvLastKeyFrameTime=un),Sn.enqueue(Gt)}else Sn.enqueue(Gt)}(Vt,qt,Je,gt,wt):function(Gt,Sn,Qt,Wt,zt){var Mt,jt,Kt,$t=s[Qt];if($t){var yt=Wt?$t.lowStreamSideInfos:$t.sideInfos;if(yt.length>0){var Pn=!1,pn=(jt=(Mt=Gt.getMetadata)===null||Mt===void 0?void 0:Mt.call(Gt))===null||jt===void 0?void 0:jt.mimeType;Pn=pn?(Kt=pn==null?void 0:pn.includes("H265"))!==null&&Kt!==void 0&&Kt:zt==="H265";for(var un=new DataView(Gt.data),ln=[],Mn=0,Hn=0;Hn<yt.length;Hn++){var xi=x(yt[Hn],$t.type,$t.emulationPreventionByte);Mn+=4+(Pn?2:1)+(Ao=xi.ebspLength),ln.push(xi)}Wt?$t.lowStreamSideInfos=[]:$t.sideInfos=[];for(var vi=new ArrayBuffer(Mn+Gt.data.byteLength),yr=new DataView(vi),Ur=0,Gr=new a(un,Pn),Nr=0,ni=!1,co=!1,Ho=!1,gi=0;Gr.NextNalu();)if(gi++,Pn){if((Hi=(126&un.getUint8(Gr.nalu_start+Gr.start_code_size))>>1)==32)ni=!0,Nr+=Gr.nalu_size;else if(Hi==33)co=!0,Nr+=Gr.nalu_size;else if(Hi==34)Ho=!0,Nr+=Gr.nalu_size;else if(Hi==35)continue;if(ni&&co&&Ho)break}else{var Hi;if((Hi=31&un.getUint8(Gr.nalu_start+Gr.start_code_size))==7)co=!0,Nr+=Gr.nalu_size;else if(Hi==8)Ho=!0,Nr+=Gr.nalu_size;else if(Hi==9)continue;if(co&&Ho)break}for(var Pi=0;Pi<Nr;Pi++)yr.setInt8(Ur++,un.getInt8(Pi));var Jt=10-gi,Bi=ln.length>=(Jt=Jt>0?Jt:0)?Jt:ln.length;for(Hn=0;Hn<Bi;Hn++){var Go=ln[Hn],Ki=Go.rbspView,Ao=Go.ebspLength;yr.setUint8(Ur++,0),yr.setUint8(Ur++,0),yr.setUint8(Ur++,0),yr.setUint8(Ur++,1),Pn?(yr.setUint8(Ur++,78),yr.setUint8(Ur++,1)):yr.setUint8(Ur++,6);for(var Do=0;Do<Ao;Do++)yr.setInt8(Ur++,Ki[Do-0])}for(Pi=Nr;Pi<Gt.data.byteLength;Pi++)yr.setInt8(Ur++,un.getInt8(Pi));Gt.data=vi}Sn.enqueue(Gt)}else Sn.enqueue(Gt)}(Vt,qt,Je,gt,wt)}:Pe==="decode"&&(ut=function(Vt,qt){Pt==="audio"?qt.enqueue(Vt):function(Gt,Sn,Qt){var Wt,zt,Mt,jt=c[Qt],Kt=jt&&jt.codec!=="VP8",$t=!1,yt=(zt=(Wt=Gt.getMetadata)===null||Wt===void 0?void 0:Wt.call(Gt))===null||zt===void 0?void 0:zt.mimeType;if($t=yt?(Mt=yt==null?void 0:yt.includes("H265"))!==null&&Mt!==void 0&&Mt:jt.codec==="H265",Kt){var Pn=jt.firstFrame;if(Pn){if(Pn.buffer)if(Gt.timestamp-Pn.time<20){var pn=function(as,_a){if(as.byteLength!==_a.byteLength)return!1;for(var Sa=0;Sa<as.byteLength;Sa++)if(as[Sa]!==_a[Sa])return!1;return!0}(new Uint8Array(Gt.data),Pn.buffer);pn&&(Kt=!1)}else Pn.buffer=void 0}else jt.firstFrame={buffer:new Uint8Array(Gt.data).slice(0),time:Gt.timestamp}}if(Kt){for(var un=new DataView(Gt.data),ln=0,Mn=new a(un,$t),Hn=0,xi=!1;Mn.NextNalu(xi);){if($t){if((Hn=(126&un.getUint8(Mn.nalu_start+Mn.start_code_size))>>1)==32||Hn==33||Hn==34||Hn==35)continue;if(Hn!=39)break}else{if((Hn=31&un.getUint8(Mn.nalu_start+Mn.start_code_size))==7||Hn==8||Hn==9)continue;if(Hn!=6)break}var vi=new Uint8Array(Gt.data).slice(Mn.nalu_start+Mn.start_code_size,Mn.nalu_start+Mn.start_code_size+Mn.nalu_size);jt.emulationPreventionByte&&(vi=h(vi).output),ln=$t?2:1,xi=!0;for(var yr=0;vi[ln]===255;)yr+=255,ln++;if((yr+=vi[ln++])===e||yr===5||yr===100){for(var Ur=0;vi[ln]===255;)Ur+=255,ln++;if(Ur+=vi[ln++],Gt.data.byteLength-ln<Ur)break;var Gr=new Uint8Array(4+Ur);switch(Gr[0]=0,Gr[1]=0,yr){case 100:Gr[2]=3,Gr[3]=235;break;case 5:Gr[2]=3,Gr[3]=236;break;case e:Gr[2]=3,Gr[3]=237}for(var Nr=0;Nr<Ur;Nr++)Gr[4+Nr-0]=vi[ln++];var ni=!1;if(yr===e)ni=!0;else if(yr===5){var co=jt.unregisterSeiFilter;if(co){var Ho=Gr.slice(4,4+jt.filterSize),gi=void 0,Hi=!0;if((gi=typeof co=="string"?m(co):co).length===0)Hi=!1;else for(var Pi=0;Pi<gi.length;Pi++)if(gi[Pi]!==Ho[Pi]){Hi=!1;break}ni=Hi}else ni=!0}ni&&o.postMessage({cmd:"recvSEI",streamID:Qt,buffer:Array.from(Gr)})}else if(yr===244){for(Ur=0;vi[ln]===255;)Ur+=255,ln++;if(Ur+=vi[ln++],Gt.data.byteLength-ln<Ur)break;var Jt=parseInt(Ur/5+""),Bi=vi.slice(ln,ln+=Ur),Go=[];for(Pi=0;Pi<Jt;Pi++){var Ki=5*Pi,Ao=Bi.slice(Ki,Ki+4),Do=Bi.slice(Ki+4,Ki+5),Ws=S(Ao);Go.push({soundLevelID:Ws,value:Do[0]})}o.postMessage({cmd:"mixSoundLevel",soundLevelList:Go,streamID:jt.streamID})}}Sn.enqueue(Gt)}else Sn.enqueue(Gt)}(Vt,qt,Je)}),ut){var At=new TransformStream({transform:ut});Oe.pipeThrough(At).pipeTo(Ge)}}function V(Pe){var Oe=s[Pe];return Oe||(s[Pe]={streamID:Pe,sideInfos:[],lowStreamSideInfos:[],type:243,emulationPreventionByte:!1,recvLastKeyFrameTime:0},s[Pe])}function _e(Pe){var Oe=c[Pe];return Oe||(c[Pe]={streamID:Pe,emulationPreventionByte:!1,codec:"",unregisterSeiFilter:"",filterSize:0},c[Pe])}function ke(Pe){var Oe=Pe.cmd;if(Oe==="encode"){var Ge=Pe.readable,Je=Pe.writable,tt=Pe.streamID,ut=Pe.type,vt=Pe.isLowStream,gt=Pe.emulationPreventionByte,Pt=Pe.onlyAudio,wt=Pe.vCodec;if((Vt=Pe.kind)!=="audio"){var At=V(tt);At.type=ut,At.emulationPreventionByte=gt}u[tt]={isLowStream:vt,kind:Vt,onlyAudio:Pt,vCodec:wt},q(Oe,Ge,Je,tt,u)}else if(Oe==="decode"){Ge=Pe.readable,Je=Pe.writable,tt=Pe.streamID,gt=Pe.emulationPreventionByte;var Vt,qt=Pe.codec,Gt=Pe.unregisterSeiFilter,Sn=Pe.filterSize;if((Vt=Pe.kind)!=="audio"){var Qt=_e(tt);Qt.emulationPreventionByte=gt,Qt.codec=qt,Qt.unregisterSeiFilter=Gt,Qt.filterSize=Sn}l[tt]={isLowStream:!1,kind:Vt},q(Oe,Ge,Je,tt,l)}}onmessage=function(Pe){var Oe=Pe.data,Ge=Oe.cmd;try{switch(Ge){case"encode":case"decode":ke(Oe);break;case"updatePlayer":var Je=Oe.codec;_e(wt=Oe.streamID).codec=Je;break;case"pushSideInfo":var tt=Oe.buffer,ut=Oe.hasLowStream,vt=Oe.maxLength,gt=V(wt=Oe.streamID);gt.sideInfos.length>vt?console.error("Send SEI Failed. The number of inserted sei exceeds the limit."):(gt.sideInfos.push(tt),ut&&gt.lowStreamSideInfos.push(tt));break;case"publishStreamType":var Pt=u[wt=Oe.streamID];Pt&&(Pt.onlyAudio=Oe.onlyAudio);break;case"clear":var wt=Oe.streamID;Oe.type=="push"?(delete s[wt],delete u[wt]):(delete l[wt],delete c[wt])}}catch(At){o.postMessage({cmd:"error",error:At})}},o.RTCTransformEvent&&(o.onrtctransform=function(Pe){var Oe=Pe.transformer;ke(Object.assign({readable:Oe.readable,writable:Oe.writable},Oe.options))})}(function(o){o[o.LoginReq=1]="LoginReq",o[o.LoginRsp=2]="LoginRsp",o[o.CreateSessionReq=3]="CreateSessionReq",o[o.CreateSessionRsp=4]="CreateSessionRsp",o[o.CreateSessionWithSdpReq=5]="CreateSessionWithSdpReq",o[o.CreateSessionWithSdpRsp=6]="CreateSessionWithSdpRsp",o[o.SessionResetPush=7]="SessionResetPush",o[o.SessionResetAck=8]="SessionResetAck",o[o.PublishEventPush=9]="PublishEventPush",o[o.PlayEventPush=10]="PlayEventPush",o[o.MediaDescReq=11]="MediaDescReq",o[o.MediaDescRsp=12]="MediaDescRsp",o[o.CandidateInfoReq=13]="CandidateInfoReq",o[o.CandidateInfoRsp=14]="CandidateInfoRsp",o[o.CloseSessionReq=15]="CloseSessionReq",o[o.CloseSessionRsp=16]="CloseSessionRsp",o[o.MediaDescPush=17]="MediaDescPush",o[o.MediaDescAck=18]="MediaDescAck",o[o.CandidateInfoPush=19]="CandidateInfoPush",o[o.CandidateInfoAck=20]="CandidateInfoAck",o[o.CloseSessionPush=21]="CloseSessionPush",o[o.CloseSessionAck=22]="CloseSessionAck",o[o.StreamStatusNotify=23]="StreamStatusNotify",o[o.StreamStatusNotifyAck=24]="StreamStatusNotifyAck",o[o.StreamStatusNotifyPush=25]="StreamStatusNotifyPush",o[o.StreamStatusNotifyPushAck=26]="StreamStatusNotifyPushAck",o[o.BroadcasterStatusNotify=27]="BroadcasterStatusNotify",o[o.BroadcasterStatusAck=28]="BroadcasterStatusAck",o[o.ActivateAudioPlayStreamReq=29]="ActivateAudioPlayStreamReq",o[o.ActivateAudioPlayStreamRsp=30]="ActivateAudioPlayStreamRsp",o[o.ActivateVideoPlayStreamReq=31]="ActivateVideoPlayStreamReq",o[o.ActivateVideoPlayStreamRsp=32]="ActivateVideoPlayStreamRsp",o[o.ClientInfoPush=33]="ClientInfoPush",o[o.ClientInfoAck=34]="ClientInfoAck",o[o.NetQualityProbeReq=35]="NetQualityProbeReq",o[o.NetQualityProbeRsp=36]="NetQualityProbeRsp",o[o.NetQualityInfoPush=37]="NetQualityInfoPush",o[o.NetQualityInfoAck=38]="NetQualityInfoAck",o[o.ActivateSEIInsertReq=39]="ActivateSEIInsertReq",o[o.ActivateSEIInsertRsp=40]="ActivateSEIInsertRsp",o[o.Peer2PeerNetStatsGetReq=41]="Peer2PeerNetStatsGetReq",o[o.Peer2PeerNetStatsGetRsp=42]="Peer2PeerNetStatsGetRsp",o[o.CmdReq=43]="CmdReq",o[o.CmdRsp=44]="CmdRsp",o[o.CmdPush=45]="CmdPush",o[o.CmdAck=46]="CmdAck",o[o.WebRTCDispatchReq=47]="WebRTCDispatchReq",o[o.WebRTCDispatchRsp=48]="WebRTCDispatchRsp"})($l||($l={}));var hh={1:"LoginReq",2:"LoginRsp",3:"CreateSessionReq",4:"CreateSessionRsp",5:"CreateSessionWithSdpReq",6:"CreateSessionWithSdpRsp",7:"SessionResetPush",8:"SessionResetAck",9:"PublishEventPush",10:"PlayEventPush",11:"MediaDescReq",12:"MediaDescRsp",13:"CandidateInfoReq",14:"CandidateInfoRsp",15:"CloseSessionReq",16:"CloseSessionRsp",17:"MediaDescPush",18:"MediaDescAck",19:"CandidateInfoPush",20:"CandidateInfoAck",21:"CloseSessionPush",22:"CloseSessionAck",23:"StreamStatusNotify",24:"StreamStatusNotifyAck",25:"StreamStatusNotifyPush",26:"StreamStatusNotifyPushAck",27:"BroadcasterStatusNotify",28:"BroadcasterStatusAck",29:"ActivateAudioPlayStreamReq",30:"ActivateAudioPlayStreamRsp",31:"ActivateVideoPlayStreamReq",32:"ActivateVideoPlayStreamRsp",33:"ClientInfoPush",34:"ClientInfoAck",35:"NetQualityProbeReq",36:"NetQualityProbeRsp",37:"NetQualityInfoPush",38:"NetQualityInfoAck",39:"ActivateSEIInsertReq",40:"ActivateSEIInsertRsp",41:"Peer2PeerNetStatsGetReq",42:"Peer2PeerNetStatsGetRsp",43:"CmdReq",44:"CmdRsp",45:"CmdPush",46:"CmdAck",47:"WebRTCDispatchReq",48:"WebRTCDispatchRsp"},Ro=function(){return Ro=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},Ro.apply(this,arguments)},Up=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},zp=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Vp=["LoginReq","CreateSessionWithSdpReq","CreateSessionReq"],ed=["Peer2PeerNetStatsGetReq","Peer2PeerNetStatsGetRsp","CmdRsp"],Vs,rc=oo.webrtc_proto_v2,ph=oo.webrtc_cmd,td=oo.generalpclib,fh=function(){function o(e,t,n,r){this.Zg=e,this.an=t,this.pn=n,this.Xg=r,this.t_=new Ha,this.Vf={},this.Qf=new E.wl,this.Oo=100,this.Kf={},this.i_={},this.Yf=5e3,this.Ro=1e4,this.tu=null,this.To=2e3,this.n_=null,this.e_=6e3,this.s_=!0,this.o_={},this.u_=["ActivateVideoPlayStreamReq","ActivateAudioPlayStreamReq","CreateSessionReq","CreateSessionWithSdpReq","ActivateSEIInsertReq","StreamStatusNotify"],this.jo=E.xb.disconnected,this.a_=Ee.LOGOUT,this.c_=0,this.h_=void 0,this.unCheckCmds=["LoginReq","CreateSessionReq","CreateSessionWithSdpReq"];var i=e===bs;this.f_=i?"zc.wcss.0":"zc.wcss.1",this.l_=r.getPCRequest(i?Jn.BusinessService.SERVICE_WEBRTC_SIGNAL:Jn.BusinessService.SERVICE_L3_WEBRTC_SIGNAL,{path:"wsv2",query:"",encode:!1,messageType:2,isMsgCache:!1}),this.d_()}return Object.defineProperty(o.prototype,"isUaConnected",{get:function(){return this.Xg.isConnect()},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"state",{get:function(){return this.jo},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"mediaState",{get:function(){return this.a_},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"token",{get:function(){return this.v_},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"tokenType",{get:function(){return this.c_},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"server",{get:function(){return this.Zg},enumerable:!1,configurable:!0}),o.prototype.d_=function(){var e,t=this;this.Xg.on("connected",function(){t.an.info("".concat(t.f_," netAgent connected ").concat(t.jo)),t.jo===E.xb.connecting&&t.loginCenterSvr(),t.t_.emit("uaConnected")}),this.Xg.on("disconnected",function(){t.an.info("".concat(t.f_," netAgent disconnected"))}),this.Xg.on("broken",function(n){t.an.info("".concat(t.f_," netAgent broken ").concat(n))}),this.l_.on("connected",function(n){t.an.info("".concat(t.f_," pc connected ").concat(Jn.ConnectedType[n])),t.jo=E.xb.connected,n===Jn.ConnectedType.AUTO&&t.loginCenterSvr()}),this.l_.on("disconnected",function(n,r){t.an.info("".concat(t.f_," pc disconnected ").concat(Jn.DisconnectedType[n],", ua connect: ").concat(t.isUaConnected,", signal ").concat(t.s_?"closed":"connect")),t.jo=E.xb.disconnected,t.a_=Ee.LOGOUT,t.s_||(t.isUaConnected?t.loginCenterSvr():t.jo=E.xb.connecting)}),this.l_.on("broken",function(){t.an.info("".concat(t.f_," pc broken")),t.jo=E.xb.connecting,t.a_=Ee.LOGOUT}),this.l_.on("downLoadMessage",function(n,r){t.handleWsMessage({data:n,extras:r})}),(e=this.l_)===null||e===void 0||e.on("exception",function(n,r){t.an.info("".concat(t.f_," pc exception ").concat(JSON.stringify(n)))}),this.l_.off("pcBrokenEvent"),this.l_.on("pcBrokenEvent",function(n){var r=k.S2,i=t.cr.createSpan(E.t0.H,{key:k.Hu.event},{key:""},r.event);i.setAttributes({service_no:r.service_no(n==null?void 0:n.service_no),error:(n==null?void 0:n.code)||0}),i.end()}),this.l_.off("pcDisconnectedEvent"),this.l_.on("pcDisconnectedEvent",function(n){var r=k.pR,i=t.cr.createSpan(E.t0.H,{key:k.Hu.event},{key:""},r.event);i.setAttributes({service_no:r.service_no(n==null?void 0:n.service_no),error:(n==null?void 0:n.code)||0}),i.end()}),this.l_.off("pcConnectedEvent"),this.l_.on("pcConnectedEvent",function(n){var r=k.D1,i=t.cr.createSpan(E.t0.H,{key:k.Hu.event},{key:""},r.event);i.setAttributes({service_no:r.service_no(n.service_no),recv_time:r.recv_time(new Date().getTime()),proxy_link_sources:r.proxy_link_sources(n.proxy_link_sources),connect_stream:r.connect_stream(n.connect_stream)}),i.end()})},o.prototype.setSessionInfo=function(e,t){this.an.info("".concat(this.f_," set session info")),this.m_=e+"",this.p_=t},o.prototype.onReconnected=function(e){},o.prototype.onNeedRetry=function(e,t){},Object.defineProperty(o.prototype,"Ev",{get:function(){var e,t,n;if(this.pn.appConfig){var r=this.pn.appConfig.media_config.publish_config.resource_info.find(function(s){return s.resource_type===E.NI.RTC});if(r){var i=(e=r==null?void 0:r.service_info)===null||e===void 0?void 0:e.find(function(s){return s.protocol===E.Hb.WEBRTC});if(i)return(n=((t=i.url_template.split("{IP}")[1].split("?"))===null||t===void 0?void 0:t[1]).split("="))===null||n===void 0?void 0:n[1]}}},enumerable:!1,configurable:!0}),o.prototype.connectServer=function(e,t,n){var r,i;if(this._s=e||((r=this.pn.roomList[0])===null||r===void 0?void 0:r.roomID),this.v_=t||((i=this.pn.roomList[0])===null||i===void 0?void 0:i.token),this.an.info("".concat(this.f_," start connect server, roomID: ").concat(this._s)),this.an.remoteReport("".concat(this.f_," token: ").concat(this.v_)),this.c_=0,this.s_=!1,this.h_=n,this.a_===Ee.LOGOUT){if(!this.pn.appConfig)return void this.an.info("".concat(this.f_," no app config"));if(!this.Ev)return void(n&&n(this.Zg,Et.lph.code));this.app=this.Ev,this.isUaConnected?this.loginCenterSvr():(this.jo=E.xb.connecting,this.an.info("".concat(this.f_," ua is not connected")))}else this.an.info("".concat(this.f_,this.a_===Ee.TRY_LOGIN?" server is connecting":" server is connected"))},o.prototype.disconnectServer=function(){this.an.info("".concat(this.f_," disconnect server")),this.disconnectPcRequest(),this.resetCheckMessage(),this.resetLoginTimer(),this.jo=E.xb.disconnected,this.a_=Ee.LOGOUT,this.h_=void 0,this.v_="",this.i_={},this.c_=0},o.prototype.disconnectPcRequest=function(){this.an.info("".concat(this.f_," disconnect pc link ").concat(this.s_)),this.s_||(this.s_=!0,this.l_.closeRequest())},o.prototype.resetLoginTimer=function(){this.an.info("".concat(this.f_," reset login timer")),clearTimeout(this.n_),this.n_=null},o.prototype.handleWsPBMsg=function(e,t){var n=this.handlePushMsg(e,t);if(n!=null&&n.header&&(n!=null&&n.body)){var r;return n&&(n.header.cmd=hh[n.header.cmd],(0,te.M$)(n.body),r={header:Ro(Ro({},n.header),{appid:this.m_,user_id:this.p_}),body:n.body}),r}this.an.error("".concat(this.f_," no header or body"))},o.prototype.handleWsMessage=function(e){var t,n=this.handleWsPBMsg(e.data,e.extras);n!=null&&n.header&&n.header.appid==this.m_&&n.header.user_id===this.p_?(ed.includes(n.header.cmd)||this.an.info("".concat(this.f_," signmsg=").concat(n.header.cmd," ").concat((t=n.header)===null||t===void 0?void 0:t.seq)),this.handleServerPush(n)):this.an.error("".concat(this.f_," check header failed"))},o.prototype.resetCheckMessage=function(){var e;this.an.info("".concat(this.f_," reset check msg")),clearTimeout(this.tu),this.tu=null;for(var t=this.Qf.getFirst();t!=null;)this.Qf.remove(t),!((e=t._data)===null||e===void 0)&&e.error&&t._data.error(E.X5,t._data.seq),t=this.Qf.getFirst();this.Vf={}},o.prototype.handleServerPush=function(e){switch(e.header.cmd){case"LoginRsp":this.handleRespondData("LoginReq",e);break;case"CreateSessionRsp":this.handleRespondData("CreateSessionReq",e),e.body.result===0&&this.addSession(e.header.session_id,e.body.session_token);break;case"CreateSessionWithSdpRsp":this.handleRespondData("CreateSessionWithSdpReq",e),e.body.result===0&&this.addSession(e.header.session_id,e.body.session_token);break;case"WebRTCDispatchRsp":this.handleRespondData("WebRTCDispatchReq",e);break;case"SessionResetPush":this.sendResetSessionAck(e.header.seq,0,0),this.handlePushResetSessionData(e);break;case"CloseSessionPush":this.sendCloseSessionAck(e.header.seq,e.header.session_id,0),this.handleMsgWithSession(e,Se.PUSH),this.removeSession(e.header.session_id);break;case"StreamStatusNotifyPush":this.sendStreamStatusNotifyAck(e.header.seq,e.header.session_id,0),this.handleMsgWithSession(e,Se.PUSH);break;case"PublishEventPush":case"PlayEventPush":case"CmdPush":this.handleMsgWithSession(e,Se.PUSH);break;case"ClientInfoPush":this.sendClientInfoAck(e.header.seq,e.header.session_id,0),this.handleMsgWithSession(e,Se.PUSH);break;case"NetQualityInfoPush":this.sendNetQualityInfoPushAck(e.header.seq,e.header.session_id,e.body.peer_id,0),this.handleMsgWithSession(e,Se.PUSH);break;case"MediaDescRsp":case"CandidateInfoRsp":case"NetQualityProbeRsp":case"ActivateSEIInsertRsp":case"ActivateVideoPlayStreamRsp":case"ActivateAudioPlayStreamRsp":case"StreamStatusNotifyAck":case"BroadcasterStatusAck":case"Peer2PeerNetStatsGetRsp":case"CmdRsp":case"CloseSessionRsp":this.handleMsgWithSession(e,Se.RSP)}},o.prototype.registerPeerCallback=function(e,t){this.o_[e]=t},o.prototype.unregisterPeerCallback=function(e){delete this.o_[e]},o.prototype.handleMsgWithSession=function(e,t){var n,r;if(!((n=e==null?void 0:e.header)===null||n===void 0)&&n.session_id){var i=this.o_[(r=e==null?void 0:e.header)===null||r===void 0?void 0:r.session_id];i&&i(e,t)}else this.an.error("".concat(this.f_," rsp no session ").concat(e.header.cmd))},o.prototype.loginCenterSvr=function(){var e=this;if(this.app){var t=[];if(Object.keys(this.i_).length!=0)for(var n in this.i_){var r=parseInt(n);t.push({session_id:r,session_token:this.i_[r].token})}var i=this.v_,s=(0,te.fU)(this.cr,E.t0.H,this.p_,k.kn.event,k.Yu),c={appid:this.pn.appid,user_id:this.pn.idName,token:i,tokenType:this.c_,sessions:t,roomid:this._s,sdk_version:this.pn.sdkVerNum,app:this.app,net_mode:this.pn.netMode};this.an.info("".concat(this.f_," LoginReq ").concat(JSON.stringify(Ro(Ro({},c),{token:void 0})))),this.an.remoteReport("".concat(this.f_," LoginReq token ").concat(this.v_));var u="LoginReq",l=this.encodePBBody(u,c);this.a_=Ee.TRY_LOGIN,this.sendMessageWithCallback(u,this.pn.getSeq(),0,l,function(a,h,m){e.resetLoginTimer(),(0,te.lA)(s,{result:m.result,seq:a}),m.result==0?(e.a_=Ee.LOGIN,e.v_=m.token,e.c_=m.tokenType,e.an.info("".concat(e.f_," LoginReq suc, callback ").concat(!!e.h_)),e.an.remoteReport("".concat(e.f_," LoginRsp token ").concat(m.token)),e.h_!=null?(e.h_(e.Zg,0),e.h_=void 0):e.onReconnected(e.Zg),e.checkMessageTimeout()):(e.an.warn("".concat(e.f_," LoginReq fail, result: ").concat(m.result," callback ").concat(!!e.h_)),e.disconnectPcRequest(),e.a_=Ee.LOGOUT,e.h_!=null?(e.h_(e.Zg,m.result),e.resetCallback(m.result)):e.onNeedRetry(e.Zg,m.result))},function(a,h){e.resetLoginTimer(),e.a_=Ee.LOGOUT;var m="LoginReq fail, callback ".concat(!!e.h_,", is signal closed ").concat(e.s_,". code: ").concat(a);e.an.info("".concat(e.f_," ").concat(m)),s.setAttribute("seq",h),e.cr.setError(s,{code:a,msg:m},m),e.h_==null||e.s_||(e.h_(e.Zg,a=a??-1),e.resetCallback(a))}),this.resetLoginTimer(),this.n_=setTimeout(function(){e.an.info("".concat(e.f_," login timer triggered, callback ").concat(!!e.h_)),e.a_=Ee.LOGOUT,e.h_!=null?(e.h_(e.Zg,-1),e.resetCallback(-1)):e.onNeedRetry(e.Zg,-1)},this.e_)}else this.an.info("".concat(this.f_," no config for login"))},o.prototype.resetCallback=function(e){this.g_(e)&&(this.h_=void 0)},o.prototype.g_=function(e){return!![Et.lph.code,20010,1008].includes(e)},o.prototype.sendMessageWithCallback=function(e,t,n,r,i,s){var c=this;i===void 0&&(i=null),s===void 0&&(s=null),ed.includes(e)||this.an.info("".concat(this.f_," send callback ").concat(e,", seq: ").concat(t," ").concat(this.jo));var u=performance.now();if(!this.unCheckCmds.includes(e)&&this.jo!==E.xb.connected)return this.an.error("".concat(this.f_," send callback ").concat(e," connect not establish")),void(s&&s(E.Xb,t));var l={seq:t,deleted:!1,cmd:e,sendTime:new Date().getTime(),success:function(){for(var q=[],V=0;V<arguments.length;V++)q[V]=arguments[V];if(Vp.includes(e)){var _e=(performance.now()-u).toFixed(0);c.an.info("".concat(c.f_," send callback suc seq: ").concat(t,", cmd: ").concat(e,", cost_time: ").concat(_e))}i&&i.apply(void 0,q)},error:s,timeout:this.Yf},a=this.Qf.push(l);this.Vf[l.seq]=a;var h=this.getHeader(e,t,n),m=this.encodePBMsg(h,r),S=!1,x=!1;e==="LoginReq"&&(S=!0,x=!0),this.l_.sendRequest({payload:m,ack:S,isInSendMap:x},function(q){c.an.info("".concat(c.f_," send callback fail ").concat(JSON.stringify(q))),q.code&&s&&s(q.code,t)},function(q){c.an.info("".concat(c.f_," send callback ack"))})},o.prototype.sendMessage=function(e,t,n,r,i){if(this.a_===Ee.LOGIN){var s=this.getHeader(e,t,n),c=this.encodePBMsg(s,r);this.l_.sendRequest({payload:c})}else this.an.error("".concat(this.f_," send ").concat(e," connect not establish ").concat(Ee[this.a_]))},o.prototype.getHeader=function(e,t,n){return this.headerData({version:"1.0.1",cmd:e,appid:this.m_+"",seq:t,user_id:this.p_,session_id:n})},o.prototype.getParamsExt=function(e,t,n){return t&&(e.min_play_buf_level_ms=t),n&&(e.keyframe_intv=n),this.an.info("".concat(this.f_," params ").concat(JSON.stringify(e))),ph.WebrtcCmdReqMsg.encode({peer_extend_param:e}).finish()},o.prototype.decodeParamsExt=function(e){return ph.WebrtcCmdReqMsg.decode(e).peer_ext_params_push},o.prototype.createSession=function(e,t,n,r){var i="CreateSessionReq",s=t.serverHost,c=t.strAuthParam,u=t.geo,l=t.roomID,a=t.transCodecID,h=t.transCodecSuffix,m=t.ipV6Prefer,S={type:t.type,stream_id:t.streamID,turn_server_host:(0,R.QP)(s)?s:"",strAuthParam:c,params:t,area_type:u.type,area_id_list:u.areaList,ipv6_prefer:m};a!==void 0&&(S.trans_codec_id=a,S.trans_codec_suffix=h),this.pn.isMultiRoom&&(S.roomid=l),this.an.info("".concat(this.f_," create session ").concat(JSON.stringify(S)),{streamid:t.streamID});var x=this.encodePBBody(i,S);this.sendMessageWithCallback(i,e,0,x,n,r)},o.prototype.createSessionWithSdp=function(e,t,n){var r,i=this,s=e.seq,c=e.type,u=e.streamId,l=e.strAuthParam,a=e.sdp,h=e.miniSdp,m=e.serverHost,S=e.playBufLevel,x=e.params,q=e.paramsExt,V=e.roomID,_e=e.geo,ke=e.transCodecID,Pe=e.transCodecSuffix,Oe=e.ipV6Prefer,Ge=ei(this.an,u),Je="CreateSessionWithSdpReq",tt=((r=e.videoInfo)===null||r===void 0?void 0:r.keyFrameInterval)||2,ut=this.getParamsExt(q,S,tt),vt={type:c,stream_id:u,media_server_host:(0,R.QP)(m)?m:"",strAuthParam:l,params:x,params_ext:ut,area_type:_e.type,area_id_list:_e.areaList,ipv6_prefer:Oe};ke!==void 0&&(vt.trans_codec_id=ke,vt.trans_codec_suffix=Pe),h?vt.mini_sdp=h:vt.sdp=a,this.pn.isMultiRoom&&(vt.roomid=V),Ge.info("".concat(this.f_," create session with sdp, params: ").concat(JSON.stringify(Ro(Ro({},vt),{sdp:void 0,mini_sdp:void 0,params_ext:ut.toString()}))));var gt=this.encodePBBody(Je,vt);this.sendMessageWithCallback(Je,s,0,gt,function(Pt,wt,At){return Up(i,void 0,void 0,function(){return zp(this,function(Vt){return At.params_ext&&(At.params_ext=this.decodeParamsExt(At.params_ext),(0,te.M$)(At.params_ext)),Ge.info("".concat(this.f_," rsp ").concat(JSON.stringify(Ro(Ro({},At),{sdp:void 0,session_token:void 0})))),t&&t(Pt,wt,At),[2]})})},n)},o.prototype.dispatchGwNodes=function(e,t,n,r){var i="WebRTCDispatchReq",s=t.streamID,c=t.geo,u=t.transCodecID,l=t.transCodecSuffix,a={type:t.type,stream_id:s,area_type:c.type,area_id_list:c.areaList,ipv6_prefer:t.ipV6Prefer};u!==void 0&&(a.trans_codec_id=u,a.trans_codec_suffix=l),this.an.info("".concat(this.f_," dispatch nodes ").concat(JSON.stringify(a)),{streamid:s});var h=this.encodePBBody(i,a);this.sendMessageWithCallback(i,e,0,h,n,r)},o.prototype.sendMediaDescUpdateReq=function(e,t,n){var r=n.sdp,i=n.miniSdp,s={type:n.type,update:1};i?s.mini_sdp=i:s.sdp=r,this.an.info("".concat(this.f_," media desc ").concat(JSON.stringify(s)));var c=this.encodePBBody("MediaDescReq",s);this.sendMessage("MediaDescReq",e,t,c)},o.prototype.removeSession=function(e){this.an.info("".concat(this.f_," remove session ").concat(e)),this.i_[e]&&delete this.i_[e]},o.prototype.sendCloseSession=function(e,t,n){var r="CloseSessionReq",i={reason:n},s=this.encodePBBody(r,i);this.an.info("".concat(this.f_," close session ").concat(t,", ").concat(JSON.stringify(i))),this.removeSession(t),this.sendMessage(r,e,t,s)},o.prototype.handleRespondData=function(e,t){var n=t.header.seq;this.an.debug("".concat(this.f_," rsp data"));var r=this.Vf[n];if(r!=null){delete this.Vf[n],this.Qf.remove(r);var i=r._data;(i==null?void 0:i.cmd)!==e?this.an.error("".concat(this.f_," command is not match")):i.success&&i.success(n,t.header.session_id,t.body)}else{if(t.header.cmd=="CloseSessionRsp"||ed.includes(e))return;this.an.error("".concat(this.f_," cannot find data ").concat(e," ").concat(n))}},o.prototype.addSession=function(e,t){this.an.info("".concat(this.f_," add session ").concat(e)),this.i_[e]={token:t}},o.prototype.handlePushData=function(e){this.an.info("".concat(this.f_," push data, cmd: ").concat(e.header.cmd,", session: ").concat(e.header.session_id));var t=this.Kf[e.header.cmd+e.header.session_id];t?t.callback&&t.callback(e.header.seq,e.header.session_id,e.body):this.an.warn("".concat(this.f_," no callbackData, cmd: ").concat(e.header.cmd,", session: ").concat(e.header.session_id))},o.prototype.handlePushResetSessionData=function(e){this.an.info("".concat(this.f_," push reset session"));var t=[];if(e.body.cResetType==0)t=Object.keys(this.i_);else if(e.body.cResetType==1)for(var n=0;n<e.body.session_ids.length;n++)t.push(e.body.session_ids[n]);if(t.length!=0)for(var r=0;r<t.length;r++){var i=this.Kf[e.header.cmd+t[r]];i==null?this.an.info("".concat(this.f_," no callbackData ").concat(t[r])):i.callback&&i.callback(e.header.seq,t[r],e.body)}else this.an.info("".concat(this.f_," no session to callback"))},o.prototype.sendMediaDesc=function(e,t,n,r){var i="MediaDescReq",s=r.sdp,c=r.miniSdp,u={type:n,update:0,params_ext:this.getParamsExt(r.paramsExt,r.min_play_buf_level_ms,r.keyframe_intv)};c?u.mini_sdp=c:u.sdp=s,this.an.info("".concat(this.f_," media desc, session: ").concat(t,", ").concat(JSON.stringify(Ro(Ro({},u),{sdp:void 0,mini_sdp:void 0}))));var l=this.encodePBBody(i,u);this.sendMessage(i,e,t,l)},o.prototype.sendCandidateInfo=function(e,t,n){for(var r="CandidateInfoReq",i=[],s=0;s<n.length;s++)i.push({candidate:n[s].candidate,sdpMid:n[s].sdpMid,sdpMLineIndex:n[s].sdpMLineIndex});var c={infos:i};this.an.info("".concat(this.f_," candidate info, session: ").concat(t,", ").concat(JSON.stringify(c)));var u=this.encodePBBody(r,c);this.sendMessage(r,e,t,u)},o.prototype.sendCandidateInfoAck=function(e,t,n){var r="CandidateInfoAck",i={result:n};this.an.info("".concat(this.f_," candidate info ack, session: ").concat(t,", ").concat(JSON.stringify(i)));var s=this.encodePBBody(r,i);this.sendMessage(r,e,t,s)},o.prototype.sendCloseSessionAck=function(e,t,n){var r="CloseSessionAck",i={result:n};this.an.info("".concat(this.f_," close session ack, session: ").concat(t,", ").concat(JSON.stringify(i)));var s=this.encodePBBody(r,i);this.sendMessage(r,e,t,s)},o.prototype.sendResetSessionAck=function(e,t,n){var r="SessionResetAck",i={result:n};this.an.info("".concat(this.f_," reset session ack, session: ").concat(t,", ").concat(JSON.stringify(i)));var s=this.encodePBBody(r,i);this.sendMessage(r,e,t,s)},o.prototype.sendStreamStatusNotifyAck=function(e,t,n){var r="StreamStatusNotifyPushAck",i={result:n};this.an.info("".concat(this.f_," stream status notify ack, session: ").concat(t,", ").concat(JSON.stringify(i)));var s=this.encodePBBody(r,i);this.sendMessage(r,e,t,s)},o.prototype.sendClientInfoAck=function(e,t,n){var r="ClientInfoAck",i={result:n};this.an.info("".concat(this.f_," client info ack, session: ").concat(t,", ").concat(JSON.stringify(i)));var s=this.encodePBBody(r,i);this.sendMessage(r,e,t,s)},o.prototype.sendNetQualityInfoPushAck=function(e,t,n,r){var i="NetQualityInfoAck",s={peer_id:n,result:r};this.an.info("".concat(this.f_," net quality info, session: ").concat(t,", ").concat(JSON.stringify(s)));var c=this.encodePBBody(i,s);this.sendMessage(i,e,t,c)},o.prototype.registerPushCallback=function(e,t,n){n&&(0,R.JO)(n)&&(this.an.info("".concat(this.f_," set callback, session: ").concat(t,", ").concat(e)),this.Kf[e+t]={callback:n})},o.prototype.unregisterPushCallback=function(e,t){delete this.Kf[e+t]},o.prototype.checkMessageTimeout=function(){for(var e,t,n=this,r=this.Qf.getFirst(),i=new Date().getTime(),s=0,c=0,u=0;r!=null&&r._data&&!(r._data.sendTime+this.Yf>i);)if(delete this.Vf[r._data.seq],this.Qf.remove(r),++c,r._data.cmd&&this.u_.indexOf(r._data.cmd)==-1)r=this.Qf.getFirst();else{if(r._data.error==null||this.Ro>0&&r._data.sendTime+this.Ro<i?++u:(this.an.warn(ie.Qu8+" error cmd = "+r._data.cmd+" seq ="+((e=r._data)===null||e===void 0?void 0:e.seq)+" start time ="+((t=r._data)===null||t===void 0?void 0:t.sendTime)),(0,R.JO)(r._data.error)&&r._data.error(E.Xb,r._data.seq)),++s>=this.Oo)break;r=this.Qf.getFirst()}this.tu=setTimeout(function(){n.checkMessageTimeout()},this.To),c==0&&u==0||this.an.info(ie.Qu8+" call success, state: timeout="+c+" drop="+u)},o.prototype.sendStreamStatus=function(e,t,n,r,i){var s="StreamStatusNotify",c={mic_status:r,camera_status:n};ei(this.an,i).info("".concat(this.f_," stream status, session: ").concat(t,", ").concat(JSON.stringify(c)));var u=this.encodePBBody(s,c);return this.sendMessage(s,e,t,u),e},o.prototype.ActivatePlayVideoStream=function(e,t,n){var r="ActivateVideoPlayStreamReq",i={active:n?0:1,layer:0};this.an.info("".concat(this.f_," activate video, session: ").concat(t,", ").concat(JSON.stringify(i)));var s=this.encodePBBody(r,i);this.sendMessage(r,e,t,s)},o.prototype.ActivatePlayAudioStream=function(e,t,n){var r="ActivateAudioPlayStreamReq",i={active:n?0:1,layer:0};this.an.info("".concat(this.f_," activate audio, session: ").concat(t,", ").concat(JSON.stringify(i)));var s=this.encodePBBody(r,i);this.sendMessage(r,e,t,s)},o.prototype.activateSEIInsert=function(e,t,n,r,i){var s="ActivateSEIInsertReq",c={peer_id:n,action:r,info_type:i};this.an.info("".concat(this.f_," insert sei, session: ").concat(t,", ").concat(JSON.stringify(c)));var u=this.encodePBBody(s,c);this.sendMessage(s,e,t,u)},o.prototype.sendBroadcasterStatus=function(e,t,n){this.an.info("".concat(this.f_," broadcast status, session: ").concat(t,", status: ").concat(n));var r="BroadcasterStatusNotify",i=this.encodePBBody(r,{status:n});this.sendMessage(r,e,t,i)},o.prototype.sendNetProbe=function(e,t,n){var r="NetQualityProbeReq",i={peer_id:n,action:1};this.an.info("".concat(this.f_," net probe req, session: ").concat(t,", ").concat(JSON.stringify(i)));var s=this.encodePBBody(r,i);this.sendMessage(r,e,t,s)},o.prototype.getP2PNetStats=function(e,t,n){var r="Peer2PeerNetStatsGetReq",i=this.encodePBBody(r,{peer_id:n});this.sendMessage(r,e,t,i)},o.prototype.sendGWCmdReq=function(e,t,n){var r="CmdReq",i=this.encodePBBody(r,n);this.sendMessage(r,t,e,i,!1)},o.prototype.sendGWCmdAck=function(e,t,n,r){var i="CmdAck";t.body=n;var s=this.encodePBBody(i,t);this.sendMessage(i,(r==null?void 0:r.seq)||this.pn.getSeq(),e,s,!1)},o.prototype.on=function(e,t){this.t_.addEventHandler(e,t)},o.prototype.off=function(e,t){this.t_.removeEventHandler(e,t)},o.prototype.headerData=function(e){var t=$l[e.cmd];if(t!==void 0){var n=rc.Head.create({cmd:t,seq:e.seq,session_id:e.session_id});return rc.Head.encode(n).finish()}this.an.error("".concat(this.f_," cmd not exist"))},o.prototype.encodePBMsg=function(e,t,n){n===void 0&&(n=!0);var r=new Uint8Array(Array.from(this.getWebRTCHead(e.length,t.length)).concat(Array.from(e)).concat(Array.from(t))),i=td.Header.create({cmd:n?100:101}),s=td.Header.encode(i).finish(),c=new Uint8Array(8);c[0]=181,c[1]=0;var u=s.length,l=r.length;return c[2]=u>>8,c[3]=u-(c[2]<<8),c.set(new Uint8Array(Int32Array.from([l]).buffer).reverse(),4),new Uint8Array(Array.from(c).concat(Array.from(s)).concat(Array.from(r)))},o.prototype.getWebRTCHead=function(e,t){var n=new Uint8Array(7);return n[0]=17,n[1]=e>>8,n[2]=e-(n[1]<<8),n.set(new Uint8Array(Int32Array.from([t]).buffer).reverse(),3),n},o.prototype.encodePBBody=function(e,t){var n=rc[e].create(t);return rc[e].encode(n).finish()},o.prototype.decodePBBody=function(e,t){var n=hh[e.cmd];if(n)return rc[n].decode(t);this.an.error("".concat(this.f_," cmd is not rtc"))},o.prototype.handlePushMsg=function(e,t){var n=e[0];if(n===181){var r=(e[2]<<8)+e[3],i=td.Header.decode(e.slice(8,8+r));if(i.cmd===101){var s=e.slice(8+r),c=s[0];if(c===17){var u=(s[1]<<8)+s[2],l=rc.Head.decode(s.slice(7,7+u)),a=s.slice(7+u);return{header:l,body:this.decodePBBody(l,a)}}this.an.error("".concat(this.f_," webrtc tag error ").concat(c))}else this.an.error("".concat(this.f_," cmd error ").concat(i.cmd))}else this.an.error("".concat(this.f_," type error ").concat(n))},o}(),Fp=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),mh=function(o){function e(t,n){var r=o.call(this)||this;return r.b_=t,r.an=n,r.retryActiveCount=1,r.RETRY_MAX_TIME=90,r.rr=.3,r.sr=4.8,r.aborted=!1,r.f_="zc.rssh "+t.server,r}return Fp(e,o),e.prototype.startRetryTask=function(t,n,r,i,s){this.an.info("".concat(this.f_," start retry task"));var c=n.roomID,u=n.token,l=n.firstInterval;this.init(t),this.startMaxTime(),this.onCompleteActive=r,this.onSucActive=i,this.onFailActive=s,this.active(l,{roomID:c,token:u})},e.prototype.active=function(t,n){var r=this;if(this.an.info("".concat(this.f_," active ").concat(t)),this.retryTimer)return this.an.info("".concat(this.f_," has actived, ignore")),!1;if(this.isOverTime)return this.an.info("".concat(this.f_," retry over time, stop retry")),!1;this.retryActiveInterval=this.getRetryDelayByCount(this.retryActiveCount);var i=(0,R.Cs)(t)?t:this.retryActiveInterval,s=function(){r.an.info("".concat(r.f_," connect timer triggered ")+r.b_.mediaState),r.retryTimer&&clearTimeout(r.retryTimer),r.retryTimer=null,r.retryActiveCount++,r.b_&&(r.b_.mediaState===Ee.LOGOUT||t===0?(r.b_.connectServer(n==null?void 0:n.roomID,n==null?void 0:n.token,function(u,l){r.handleConnectRsp(u,l)}),t===0&&(r.onCompleteActive&&r.onCompleteActive(r.b_.server),r.onCompleteActive=void 0)):r.b_.mediaState===Ee.LOGIN&&r.qr())},c="";return i===0?(s(),c+="connect immediately"):(this.retryTimer=setTimeout(s,i),c+="connect timer start, delay ".concat(i)),this.an.info("".concat(this.f_," ").concat(c)),!0},e.prototype.handleConnectRsp=function(t,n){this.an.info(this.f_+" connect res "+n+" aborted "+this.aborted),this.aborted||(n!=0?this.b_.g_(n)?(this.qr(),this.onFailActive&&this.onFailActive(this.b_.server,n),this.resetCallback()):this.active():(this.an.info("".concat(this.f_," connect suc ")),this.qr(),this.onSucActive&&this.onSucActive(t),this.resetCallback()))},e.prototype.getRetryDelayByCount=function(t){var n=Math.min(this.sr,this.rr*Math.pow(2,t<2?0:t)),r=Math.random(),i=Math.floor(r*(1e3*n+1));return this.an.info("".concat(this.f_," attempt ").concat(t," ").concat(n," ").concat(i)),i},e.prototype.startMaxTime=function(){var t=this;this.maxTimer||(this.maxTimer=setTimeout(function(){t.an.warn("".concat(t.f_," connect over max time ").concat(t.RETRY_MAX_TIME,"s, stop retry, aborted ")+t.aborted),t.isOverTime=!0,t.aborted||(t.invalid(),t.aborted=!0,t.onFailActive&&t.onFailActive(t.b_.server,E.jZ),t.resetCallback())},1e3*this.RETRY_MAX_TIME))},e.prototype.stopMaxTime=function(){this.maxTimer&&clearTimeout(this.maxTimer),this.maxTimer=null},e.prototype.qr=function(){this.an.info("".concat(this.f_," stop retry")),this.stopMaxTime(),this.invalid(),this.aborted=!0},e.prototype.onactive=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},e.prototype.invalid=function(){this.an.info("".concat(this.f_," invalid")),this.retryTimer&&clearTimeout(this.retryTimer),this.retryTimer=null,this.startRetryTimer&&clearTimeout(this.startRetryTimer),this.startRetryTimer=null,this.retryStartTime=0,this.retryActiveCount=1},e.prototype.resetCallback=function(){this.onCompleteActive=void 0,this.onSucActive=void 0,this.onFailActive=void 0},e.prototype.reset=function(){this.an.info(this.f_+" reset"),this.stopMaxTime(),this.invalid(),this.resetCallback()},e}(Ks),Ju="zc.bwa",qp=function(){function o(e,t,n){this.an=e,this.gn=t,this.pn=n,this.timer=0,this.__=E.b3.Excellent,this.y_=5}return Object.defineProperty(o.prototype,"S_",{get:function(){return+this.gn.streamReportSpeed.toFixed(1)},enumerable:!1,configurable:!0}),o.prototype.E_=function(){var e,t=(e=this.pn.reporter.tracerHandler.getUploadStatus())!==null&&e!==void 0?e:{uploadSpeed:0,increaseSpeed:0};return+Math.max(t.uploadSpeed,t.increaseSpeed).toFixed(1)},o.prototype.setUploadStrategy=function(e,t){return this.an.setUploadStrategy(e),e!=this.y_&&(this.y_=e,t&&this.an.info("".concat(Ju," ").concat(t)),!0)},o.prototype.start=function(){var e,t,n=this,r=(t=(e=this.gn.au("log_strategy",!0))!==null&&e!==void 0?e:this.gn.au("log_strategy"))!==null&&t!==void 0?t:-1;[0,1,2,3,4,5].includes(r)?this.stop():this.timer||(this.k_(),this.timer=setInterval(function(){n.k_()},3e3))},o.prototype.k_=function(){var e,t,n=Object.values(this.gn.publisherList),r=Object.values(this.gn.playerList);if(n.length>0){this.endStreamTime=void 0;var i=n.reduce(function(Pe,Oe,Ge){var Je,tt=Oe.publisher,ut=tt.targetVBitrate;tt.lowStream&&(ut+=(Je=tt.lowStreamVBitrate)!==null&&Je!==void 0?Je:0),Pe.needBitrate+=ut,tt.mic_status===0&&(Pe.needBitrate+=100),Pe.hasPublishing||tt.state!==6||(Pe.hasPublishing=!0);var vt=tt.getAvailableBitrate();(0,R.TE)(vt)||Pe.bitrateList.push(vt);var gt=tt.qualityGrade;gt>Pe.netGrade&&(Pe.netGrade=gt),tt.camera_status===0&&(Pe.hasVideo=!0,tt.isLowVideoQuality&&(Pe.isReduceVideoQuality=!0));var Pt=Pe.bitrateList.length;return Ge===n.length-1&&Pt>0&&(Pe.bitrate=Pe.bitrateList.reduce(function(wt,At){return wt+At},0)/Pt),Pe},{needBitrate:0,bitrateList:[],bitrate:void 0,netGrade:E.b3.Excellent,isReduceVideoQuality:!1,hasVideo:!1,hasPublishing:!1}),s=i.bitrate,c=i.needBitrate,u=i.netGrade,l=i.isReduceVideoQuality,a=i.hasVideo,h=i.hasPublishing;if(window.noZegoLogStrategy)this.an.setUploadStrategy(5),this.y_=5;else if(h)if(s){var m=s-c-8*r.length;if(!window.noZegoLogStrategy){var S=void 0;m<=0&&a&&!l?this.an.setUploadStrategy(S=1):S=this.an.setUpBitrate(m),(0,R.TE)(S)||S==this.y_||(this.an.info("".concat(Ju," publish strategy: ").concat(S," bitrate: ").concat(m," grade: ").concat(u," reduce: ").concat(!a||l)),this.y_=S),(0,R.TE)(u)||(this.__=u)}}else S=this.O_(u),this.setUploadStrategy(S,"publish strategy: ".concat(S," grade: ").concat(u," reduce: ").concat(l));else this.an.setUploadStrategy(S=1),this.setUploadStrategy(S,"publish requesting strategy: ".concat(S))}else if(r.length>0){this.endStreamTime=void 0;var x=r.reduce(function(Pe,Oe){return Pe.hasPlaying||Oe.state!==6||(Pe.hasPlaying=!0),Oe.qualityGrade>Pe.grade&&(Pe.grade=Oe.qualityGrade),Pe},{grade:E.b3.Excellent,hasPlaying:!1}),q=x.hasPlaying;S=this.O_(u=x.grade),q&&S!==0||(S=1),window.noZegoLogStrategy?(this.an.setUploadStrategy(5),this.y_=5):this.setUploadStrategy(S,"play strategy: ".concat(S," grade: ").concat(u," playing: ").concat(q))}else{var V=this.E_(),_e=+((t=((e=this.pn.rtm)===null||e===void 0?void 0:e.netAgent).speed)!==null&&t!==void 0?t:0).toFixed(1),ke="".concat(Ju," will end. curr strategy: ").concat(this.y_," grade: ").concat(this.__," tracer: ").concat(V," speedLog: ").concat(this.S_," netAgent: ").concat(_e);this.endStreamTime||(this.endStreamTime=Date.now()),(Date.now()-this.endStreamTime>3e4||V+this.S_+_e<10)&&(S=this.O_(E.b3.Excellent),this.setUploadStrategy(S)&&(ke+=" target strategy ".concat(S))),this.an.info(ke),this.y_===5&&this.stop()}},o.prototype.lazyStopCheck=function(){[E.b3.Excellent,E.b3.Good].includes(this.__)},o.prototype.stop=function(){var e,t,n="".concat(Ju," end check net. ").concat(this.__);this.timer&&(clearInterval(this.timer),this.timer=0);var r=(t=(e=this.gn.au("log_strategy",!0))!==null&&e!==void 0?e:this.gn.au("log_strategy"))!==null&&t!==void 0?t:-1;(!r||r<0)&&(r=5),this.an.setUploadStrategy(r),(0,R.TE)(r)||r==this.y_||(n+=" new strategy ".concat(r),this.y_=r),this.an.info(n)},o.prototype.O_=function(e){var t,n=this.__;switch(e<n&&(e=n-1),this.__=e,e){case E.b3.Excellent:t=5;break;case E.b3.Good:t=3;break;case E.b3.Middle:t=2;break;case E.b3.Poor:t=1;break;case E.b3.Die:t=0;break;default:t=4}return t},o.defaultAvailableBitrate=5e4,o}(),Hp=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ts=function(){return ts=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},ts.apply(this,arguments)},Gp=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))};(function(o){o[o.NotReUse=0]="NotReUse",o[o.TheSameReUse=1]="TheSameReUse",o[o.DiffReUse=2]="DiffReUse",o[o.AllReUse=3]="AllReUse"})(Vs||(Vs={}));var bs="rtc",_s="l3",Ss=k.Og,vh=Ss.event,Vc=Ss.error,gh=k.Nr,Fc=gh.error,Ku=E.h7.error,nd=y.frameRate,rd=y.bitRate,jp=function(){function o(e){this.an=e,this.lazyTimeout=9e4,this.taskMap={}}return o.prototype.startLazyEndTimer=function(e,t,n){var r=this;this.taskMap[e]&&clearTimeout(this.taskMap[e].timer);var i=setTimeout(function(){t(),delete r.taskMap[e]},n??this.lazyTimeout);this.taskMap[e]={callback:t,timer:i}},o.prototype.clearLazyEndTimer=function(e){this.taskMap[e]&&(clearTimeout(this.taskMap[e].timer),delete this.taskMap[e],this.an.info("zsc.rsfs.0 clearLazyEndTimer: "+e))},o.prototype.endAll=function(){for(var e in this.taskMap)clearTimeout(this.taskMap[e].timer),this.taskMap[e].callback(),delete this.taskMap[e]},o.prototype.hasEndTask=function(e){return!!this.taskMap[e]},o.prototype.end=function(e){this.taskMap[e]&&(clearTimeout(this.taskMap[e].timer),this.taskMap[e].callback(),delete this.taskMap[e])},o}(),id=function(o){function e(t,n,r,i,s,c){var u,l,a,h=this;return(h=o.call(this)||this).an=t,h.pn=n,h.dataReport=r,h.I_=i,h.acMgr=s,h.geo=c,h.testEnvironment=!1,h.playModule=null,h.trackUtils=new xp(h.an),h.R_=3e3,h.C_=3e3,h.previewStreamList=[],h.A_={},h.captureStreamElementMap=new Map,h.soundLevelDelegate=!1,h.soundLevelInterval=1e3,h.enableInBackground=!1,h.Od=!0,h.z_={},h.D_={},h.streamIPStackMode=N.IPv4Prefer,h.isMicEnabled=!0,h.isDataChannelEnabled=!1,h.targetQuality=E.Bl.MiddleMinQuality,h.probeInterval=6e4,h.N_=3e5,h.gwNode="",h.playerList={},h.publisherList={},h.playSuccessCallBackList={},h.playErrorCallBackList={},h.waitPublishList=[],h.waitPlayList=[],h.autoSwitchProtocol=!0,h.udpFailNum=0,h.maxUdpFailNum=2,h.probeStartedNum=3,h.cachedGwNodesList={},h.cachedGwNodesMode=Vs.TheSameReUse,h.P_=-1,h.M_=-1,h.qp=null,h.x_=3,h.useCopyMusic=!1,h.playEventKeys={},h.isCustomVC=!1,h.defaultVideoMuted=!1,h.defaultAudioMuted=!1,h.agentConnectIPStackType=-1,h._agentIpStackDetection={IPv4:H.unknown,IPv6:H.unknown},h.miniSdpWorker=null,h.ipV6Prefer=0,h.ipNodeType=A.ZV4Priority,h.isCandidateHasIPv6=!1,h.referenceVideoBitrate=-1,h.referenceBitrateUpdateTs=0,h.j_=function(m){h.an.info("zsc.orh.0 call ".concat(m)),h.retryStreamList(m)},h.q_=function(m,S){h.an.info("zsc.odh.0 call ".concat(m," connect fail ").concat(S)),h.openConnectServerTask(m)},h.eventHandler={visibilitychange:function(){!h.enableInBackground&&h.soundLevelDelegate&&(te.VJ.hidden?(h.soundLevelTimer&&clearTimeout(h.soundLevelTimer),h.soundLevelTimer=null,h.enableSoundLevelProcessor(!1)):(h.enableSoundLevelProcessor(!0),h.activeSoundLevel(),h.ac.state==="suspended"&&h.ac.resume()))}},h.isNotSupportSeiWorker=!1,h.turnServers=void 0,h.checkDeviceChange=void 0,h.L_=new jp(t),h.I_._on("_roomStateUpdate",function(m,S,x,q,V,_e){var ke;for(var Pe in S=="CONNECTING"?ke=1:S==="CONNECTED"&&(ke=5),h.B_.timer||(0,R.TE)(ke)||h.B_.setUploadStrategy(ke,"login state ".concat(S," , strategy ").concat(ke)),h.playerList){var Oe=h.playerList[Pe];if(Oe.room.roomID==m&&Oe.state===6&&Oe.playMode==E.ey.CDN)if(S=="CONNECTED"){Oe.CDNBrokenCnt++;var Ge=Oe.zegoCdnPlayer,Je=Oe.zegoExpressPlayer;Je?Je.resume():Ge&&(Ge.canRetry=!0,Ge.retry())}else S==="DISCONNECTED"&&!_e&&h.stopPlayingStream(Pe)}}),te.VJ.addEventListener("visibilitychange",h.eventHandler.visibilitychange),h.Fg=new lh(t,n,h),(u=h.I_.netAgent)===null||u===void 0||u.on("clientInfo",function(m){var S;if(h.pn.accessClientIp&&(m!=null&&m.clientIP)&&h.pn.accessClientIp!==m.clientIP){h.an.info("zsc.cs.0 client ip changed "+h.pn.accessClientIp+" "+m.clientIP);var x=h.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.rH.event);x.setAttributes({last_client_ip:h.pn.accessClientIp,current_client_ip:m.clientIP}),x.end(),h.lastChangeIpTime=Date.now(),h.U_(h.publisherList,!0),h.U_(h.playerList,!1),h.z_={}}if(h.pn.accessClientIp=m.clientIP,!h.pn.clientTimeOffset&&(m==null?void 0:m.timeOffset)){var q=h.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.co.event);q.setAttributes({ntp_source:2,ntp_offset:m==null?void 0:m.timeOffset}),q.end()}(0,R.Cs)(m==null?void 0:m.timeOffset)&&(h.pn.clientTimeOffset=m==null?void 0:m.timeOffset),h.updateTimeOffsetInterval(),(S=h.Fg)===null||S===void 0||S.checkIfSupportNTP()}),(l=h.I_.netAgent)===null||l===void 0||l.on("connected",function(){var m=h.I_.netAgent.connectIPStackType;h.an.info("zsc.cs.0 netAgent connect stack ".concat(Y[m])),h.agentConnectIPStackType=m}),(a=h.I_.netAgent)===null||a===void 0||a.on("ipDetection",function(m){h.an.info("zsc.cs.0 ip detection ".concat(JSON.stringify(m)));var S=m.linkConnectDetection;if(S&&(h._agentIpStackDetection.IPv4!==S.IPv4||h._agentIpStackDetection.IPv6!==(S==null?void 0:S.IPv6))){h._agentIpStackDetection=S;var x=h.getStreamIPNodesMode().ipNodeType;h.ipNodeType=x}}),h.B_=new qp(t,h,h.pn),h}return Hp(e,o),Object.defineProperty(e.prototype,"signalList",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"probeList",{get:function(){return this.z_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"streamReportSpeed",{get:function(){return this.Fg.speed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"agentIpStackDetection",{get:function(){return this._agentIpStackDetection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ac",{get:function(){return this.acMgr.ac},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isProxy",{get:function(){return!!(p.proxyCtrl&&this.pn.engineConfig.notProxyRTC!==!0||this.isLocalProxy)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLocalProxy",{get:function(){var t=p.proxyCtrl;return t&&!(t!=null&&t.getTurnInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useingUdp",{get:function(){var t=this.playerList,n=Object.values(this.publisherList),r=Object.values(t);if(!n.length&&!r.length)return!1;var i=!!r.find(function(s){return s.stateNego===5});return!!i||(i=!!n.find(function(s){return s.publisher.stateNego===5}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rxQuality",{get:function(){return this.M_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"txQuality",{get:function(){return this.P_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxChannels",{get:function(){var t;return this.au("max_channels",!0)?t=this.au("max_channels",!0):(0,R.Cs)(this.pn.engineConfig.maxChannels)?t=this.pn.engineConfig.maxChannels:this.au("max_channels")&&(t=this.au("max_channels")),t},enumerable:!1,configurable:!0}),e.setCloseNetProbe=function(t){e.closeNetProbe=t},e.setReportCustomerContext=function(t){lh.reportCustomerContext=t},e.prototype.U_=function(t,n){var r=this,i="zc.rgnds";(0,te.rA)(this.an,i);var s=null;for(var c in t)s=n?t[c].publisher:t[c];s&&(this.clearCachedGwNodesList(s,n),Object.keys(this.D_).forEach(function(u){return r.D_[u].ipChange=!0}),this.stopNetProbe(s),(0,te.EK)(this.an,i))},Object.defineProperty(e.prototype,"billingTimer",{get:function(){return this._billingTimer||(this._billingTimer=new Lp(this.an,this.pn)),this._billingTimer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cameraPreviewStream",{get:function(){return this.previewStreamList.find(function(t){return t.previewType==="camera"})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"microphonePreviews",{get:function(){return this.previewStreamList.filter(function(t){return t.previewType==="camera"&&t.micTrack})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"publishersLength",{get:function(){return Object.keys(this.publisherList).length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasRTCStream",{get:function(){var t=Object.keys(this.publisherList).length,n=Object.values(this.playerList).filter(function(r){return r.playMode===E.ey.RTC}).length;return!(!t&&!n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasL3Stream",{get:function(){return Object.values(this.playerList).filter(function(t){return t.playMode===E.ey.L3}).length!==0},enumerable:!1,configurable:!0}),e.prototype.initMiniSdpWorker=function(t){var n,r=Ir(this.pn.browserInfo,"chrome",78,0);t&&dh.isSupported&&!r?this.miniSdpWorker=this.miniSdpWorker||new dh(this.an):(this.pn.$u=!1,(n=this.miniSdpWorker)===null||n===void 0||n.destroy(),this.miniSdpWorker=null)},e.prototype.setSessionInfo=function(t,n,r){this.an.debug("zsc.ssi.0 called"),this.appid=t,this.userid=n,this.testEnvironment=r},e.prototype.onPlayStateUpdate=function(t,n,r,i){},e.prototype.onPlayQualityUpdate=function(t,n){},e.prototype.onPublishStateUpdate=function(t,n,r){},e.prototype.onPublishQualityUpdate=function(t,n){},e.prototype.setPublishStateStart=function(t,n,r,i,s,c){var u,l,a=this,h="zsc.pss.0",m=ei(this.an,n);m.info(h+" call");var S=this.checkPreview(r);if(!S)return m.error(h+" stream not found"),!1;if(this.publisherList[n])return m.error(h+"  publisher already exist"),this.cr.spanSetAttributes({key:vh,par:n},{error:Vc.ie.code,message:Vc.ie.message}),!1;var x=new Kl(n,this.an,this.dataReport,this.pn.engineConfig.publishQualityInterval||this.R_,this.C_,this,this.pn,S);this.isProxy&&this.Od&&this.setIsPeer(!1),x.isPeer=this.Od,x.isExternal=!0,x.parentSpanKey=k.ch.event;var q=(u=S==null?void 0:S.videoTrack)===null||u===void 0?void 0:u.label,V="",_e="",ke=r.getAudioTracks()[0]&&r.getAudioTracks()[0].label;try{V=(l=S==null?void 0:S.videoTrack)===null||l===void 0?void 0:l.getSettings().deviceId,_e=r.getAudioTracks()[0]&&r.getAudioTracks()[0].getSettings().deviceId}catch(Oe){m.warn(h+" get device id failed. error: "+Oe)}var Pe=new ch(n,this.an,this.pn,this,!0);return this.publisherList[n]={seq:0,room:t,localStream:r,publisher:x,streamID:n,publishOption:i,cameraLabel:q||"",microLabel:ke||"",cameraDeviceId:V||"",microDeviceId:_e||"",deviceStateCount:0,retryStreamHandler:Pe,isDataChannel:c,streamSid:s,isRetweetCDN:!1},this.publishersLength===1&&this.G_(!0),x.onPublishStateUpdate=function(Oe,Ge,Je,tt,ut,vt){var gt=a.publisherList[Ge];gt?gt.retryStreamHandler.publishStateHandle(Oe,gt.streamID,Je,tt,ut,vt):m.error("zsc.psuh.0 cannot find publish")},x.onPublishQualityUpdate=function(Oe,Ge){var Je=a.publisherList[Oe];Je?(a.pn.deviceStateOut&&Ge.audio.audioBitrate===0?(Je.deviceStateCount++,Je.deviceStateCount>=2&&(Je.deviceStateCount=0,a.pn.deviceStateOut=!1,m.warn(h+" publish audio error by device"))):Je.deviceStateCount=0,a.onPublishQualityUpdate(Je.streamID,Ge)):m.error("zsc.psuh.0 cannot find publish")},!0},e.prototype.retweetCDN=function(t,n,r){var i=this,s=ei(this.an,n);return new Promise(function(c,u){s.info("zsc.rwc.0 call ".concat(t," ").concat(r));var l=i.getRoomByStreamID(n);l?l.streamHandler._publishTarget({type:t==="add"?"addpush":"delpush",streamID:n,pushUrl:r},function(){s.info("zsc.rwc.0 suc "),c(void 0)},function(a){s.warn("zsc.rwc.0 fail  "+JSON.stringify(a)),u(a)}):s.info("zsc.rwc.0 no room")})},e.prototype.startPublishingStream=function(t){var n,r=this,i=ei(this.an,t);i.info("zsc.sps.0 call");var s=this.publisherList[t];if(s){!((n=s.publishOption)===null||n===void 0)&&n.cdnUrl&&!s.isRetweetCDN&&this.retweetCDN("add",t,s.publishOption.cdnUrl).then(function(){i.info("zsc.sps.0 add cdn suc"),s.isRetweetCDN=!0}).catch(function(u){i.warn("zsc.sps.0 add cdn fail "+JSON.stringify(u))});var c=s.retryStreamHandler;c.invalid(),c.init(this.pn.streamRetryTime),c.startMaxTime(),this.connectWebRTCCenterServer(!1,!0,s==null?void 0:s.room.roomID,s==null?void 0:s.room.token,function(u){var l,a=(l=r.publisherList[t])===null||l===void 0?void 0:l.publisher;a&&(a.setSignal(u),r.publishStream(t)),r.billingTimer.startChargeInfosUpload(),r.activeSoundLevel()}),this.B_.start()}else i.error("zsc.sps.0 publisher don't exist")},e.prototype.publishStream=function(t){var n=this,r=ei(this.an,t);r.info("zsc.ps.0 call");var i=this.publisherList[t].publisher;if(i)if(r.info("zsc.ps.0 state ".concat(i.state)),i.state===7){var s=null,c=this.publisherList[t].publishOption,u=this.checkPreview(this.publisherList[t].localStream);u?((s=u.localStream)&&s.getTracks().forEach(function(l){rn(l,n.an,"zsc.ps.0")}),this.cr.spanSetAttributes({key:vh,par:t},{cap_w:Ss.cap_w(u.videoInfo.width),cap_h:Ss.cap_h(u.videoInfo.height),w:Ss.w(u.videoInfo.width),h:Ss.h(u.videoInfo.height),video_en_fps:Ss.video_en_fps(u.videoInfo.frameRate),video_en_bps:Ss.video_en_bps(1e3*u.videoInfo.bitRate),is_mini:Ss.is_mini(i.$u)}),s?(r.info("zsc.ps.0 call success"),this.setStreamGwNode(i,!0),i.getDispatchIPNodeMode(),i.startPublish(t,s,c,this.getReferredVideoBitrate())):r.error("zsc.ps.0 no localStream found")):r.error("zsc.ps.0 no preview found")}else r.warn("zsc.ps.0 publisher is progress");else r.info("zsc.ps.0 publisher don't exist")},e.prototype.stopPublishingStream=function(t,n){var r=ei(this.an,t);r.info("zsc.sps.0.1 call "+JSON.stringify(n));var i=this.publisherList[t];if(i){var s=i.retryStreamHandler;s&&(s.stopMaxTime(),s.invalid()),i.isRetweetCDN&&i.publishOption.cdnUrl&&this.retweetCDN("del",t,i.publishOption.cdnUrl).then(function(){i.isRetweetCDN=!1,r.info("zsc.sps.0.1 del cdn suc")}).catch(function(u){r.warn("zsc.sps.0.1 del cdn fail "+JSON.stringify(u))}),delete this.publisherList[t],this.resetNetworkData();var c=i.publisher;c&&(s.getTryTime(c),c.stopPublish(n),delete i.publisher),this.removeStreamFromSignal(!0,t),this.billingTimer.stopChargeInfosUpload(),this.stopSoundLevel(),this.publishersLength===0&&this.G_(!1),r.info("zsc.sps.0.1 call success")}else r.warn("zsc.sps.0.1 publisher don't exist")},e.prototype.createStreamSignal=function(t){var n=new fh(t,this.an,this.pn,this.I_.netAgent);return this.pn.clientIP=this.I_.netAgent.clientIP||"",n.setSessionInfo(this.appid,this.userid),n.onReconnected=this.j_,n.onNeedRetry=this.q_,n},e.prototype.connectWebRTCCenterServer=function(t,n,r,i,s){var c,u=this,l=this.an,a="zsc.cwrcs.0";l.info("".concat(a," call, isLogin: ").concat(t,", server: ").concat(n?"rtc":"l3"));var h=null,m=n?bs:_s;this.L_.clearLazyEndTimer(m),this.A_[m]?(c=this.A_[m].signal,this.A_[m].retryServerSignalHandler=null):(c=this.createStreamSignal(m),this.A_[m]={signal:c}),c&&(c.mediaState===Ee.LOGOUT?(l.info("".concat(a," has not connect")),h||(h=new mh(c,this.an),this.A_[m].retryServerSignalHandler=h),h.startRetryTask(this.pn.serverRetryTime,{roomID:r,token:i,firstInterval:0},function(S){var x=u.A_[S].signal;x&&s&&s(x)},function(S){u.retryStreamList(S);var x=u.A_[S].signal;t&&x&&(S===bs&&u.hasRTCStream||S===_s&&u.hasL3Stream||u.disconnectSignalURL(x,!0,15e3))},function(S,x){u.handleServerConnectFail(S,x)})):c.mediaState===Ee.TRY_LOGIN?(l.info("".concat(a," connecting")),s&&s(c)):(l.info("".concat(a,"  already connected")),s&&s(c)))},e.prototype.handleServerConnectFail=function(t,n){n===E.jZ?(t===bs&&this.hasRTCStream||t===_s&&this.hasL3Stream)&&this.openConnectServerTask(t):n&&this.handleConnectFailStream(t,n)},e.prototype.handleConnectFailStream=function(t,n){var r="zsc.rcsr.0";if(this.an.info("".concat(r," reconnect ").concat(t," ").concat(n)),this.pn.engineConfig.keepRtcWhenSignalDisconnected){var i=function(s,c){var u,l=!1;return n===Et.lph.code?(u=ts({},Et.lph),l=!0):((u=ts({},Et.F$4)).message=u.message+" "+n,n===1008&&(u=Et.g9p,l=!0),n===20010&&(l=!0,u=JSON.parse(JSON.stringify(s?Et.ZpF:c?Et.MK1:Et.b1q)))),{error:u,stopRetry:l}};Object.values(this.publisherList).forEach(function(s){var c,u=i(!0);(c=s.retryStreamHandler)===null||c===void 0||c.publishStateHandle(E.eZ.error,s.streamID,u.error,u.stopRetry)}),Object.values(this.playerList).forEach(function(s){var c,u=i(!1,s.playMode===E.ey.RTC);(c=s.retryStreamHandler)===null||c===void 0||c.playStateHandle(Ku,s.streamId,u.error,u.stopRetry)})}else this.an.info("".concat(r," keep rtc when signal disconnect"))},e.prototype.disconnectAllSignal=function(){var t=this;this.an.info("zsc.dcas.0 call"),Object.values(this.A_).forEach(function(n){var r=n.signal;r&&t.disconnectStreamSignal(r)})},e.prototype.disconnectStreamSignal=function(t){!this.I_.stateCenter.roomModulesList.some(function(n){return n.roomState!=="DISCONNECTED"})&&this.disconnectSignalURL(t,!1)},e.prototype.disconnectSignalURL=function(t,n,r){var i=this;this.an.info("zsc.dcsu.0 "+t.server+" "+n+" call");var s=t.server;n?(this.an.info("zsc.dcsu.0 lazy end"),this.L_.startLazyEndTimer(s,function(){var c=i.J_(s);i.an.info("zsc.dcsu.0 lazy end start "+c),c&&t.disconnectServer(),i.an.info("zsc.dcsu.0 lazy end signal")},r)):this.L_.hasEndTask(s)?(this.an.info("zsc.dcsu.0 has task to end"),this.L_.end(s)):(this.an.info("zsc.dcsu.0 direct disconnect"),t.disconnectServer()),this.an.info("zsc.dcsu.0 call success")},e.prototype.reConnectSignals=function(){this.an.info("".concat("zsc.rcs.0"," call")),Object.values(this.A_).forEach(function(t){var n=t.retryServerSignalHandler,r=t.signal;n&&(n==null||n.active(0,{roomID:r==null?void 0:r._s,token:r==null?void 0:r.token}))})},e.prototype.isNetAgentConnect=function(){var t,n;return(n=(t=this.I_)===null||t===void 0?void 0:t.netAgent)===null||n===void 0?void 0:n.isConnect()},e.prototype.setPlayStateStart=function(t,n,r,i){var s=this,c=ei(this.an,t);if(c.info("zsc.pss.1 call"),this.playerList[t])return c.error("zsc.pss.1 player already exist"),Fc.be;var u=this.getPlayRoom(t)||this.pn.roomList[0];if(!u)return c.error("zsc.pss.1 not login room"),Fc.ge;var l=new kp(t,this.an,null,this.dataReport,this.pn.engineConfig.playQualityInterval||this.R_,this.C_,this,this.ac,this.pn,u,n,r,i);!this.getStream(u,t)&&(l.streamInRoom=!1),this.isProxy&&this.Od&&this.setIsPeer(!1),l.isExternal=!0,l.isPeer=this.Od,this.playerList[t]=l;var a=u.streamList.find(function(m){return m.stream_id==t});if(a){var h=a.stream_attr_opts;h&&l.setMuteStreamByPlayMode(h)}return l.onPlayQualityUpdate=function(m,S){var x=s.playerList[m];x?s.onPlayQualityUpdate(x.streamId,S):c.error("zsc.pss.1 cannot find play")},!0},e.prototype.onRemoteMicStatusUpdate=function(t,n,r){},e.prototype.onRemoteCameraStatusUpdate=function(t,n,r){},e.prototype.startPlayingStream=function(t,n){var r,i,s=this,c=ei(this.an,t),u=this.playerList[t],l=u.playMode===E.ey.CDN;if(c.info("zsc.sps.1 start play called "+u.playMode),n=n||this.playSuccessCallBackList[t],!u)return c.error("zsc.sps.1 player don't exist"),!1;if(!((r=u.playOption)===null||r===void 0)&&r.CDNVideo&&u.firstPlay){var a=u.playOption.CDNVideo;u._CDNPlayerClone=a.cloneNode(),u.initPoster=(a==null?void 0:a.getAttribute("poster"))||"",u.initVideoStyle=(a==null?void 0:a.getAttribute("style"))||"",u.firstPlay=!1}else u.zegoExpressPlayer&&u.firstPlay&&(u.firstPlay=!1);var h=u.retryStreamHandler;return h.invalid(),h.init(this.pn.streamRetryTime),l?(u.playCDN(function(m){var S=s.playErrorCallBackList[t];S&&S({errorCode:m.code,extendedData:m.message})},n),!0):((i=u.completePlaySpan)===null||i===void 0||i.setAttributes({urls:gh.urls([u.serverUrl])}),h.startMaxTime(),h.playStartSpan(t,u,!0),this.connectWebRTCCenterServer(!1,(u==null?void 0:u.playMode)===E.ey.RTC,u==null?void 0:u.room.roomID,u==null?void 0:u.room.token,function(m){var S=s.playerList[t];S&&(S.setSignal(m),s.playStream(t,n)),s.billingTimer.startChargeInfosUpload(),s.activeSoundLevel()}),this.B_.start(),!0)},e.prototype.playStream=function(t,n){var r,i=ei(this.an,t);i.info("zsc.ps.1 call");var s=this.playerList[t];s?(i.info("zsc.ps.1 state ".concat(s.state)),s.state===7?(i.info("zsc.ps.1 call success"),this.setStreamGwNode(s,!1),(r=s.zegoPeer)===null||r===void 0||r.getDispatchIPNodeMode(),s.startPlay(t,n)):i.warn("zsc.ps.1 player is progress")):i.warn("zsc.ps.1 player don't exist")},e.prototype.rePlayStream=function(t,n){var r=this.playerList[t],i=this.playSuccessCallBackList[t];r&&(r.setSignal(n),this.playStream(t,i))},e.prototype.removeStreamFromSignal=function(t,n,r){var i,s,c=this,u=ei(this.an,n);u.info("zsc.rsfs.0 call "+t+" "+n);var l=function(m){u.info("zsc.rsfs.0 ".concat(m.server," lazy end by remove all stream")),c.L_.startLazyEndTimer(m.server,function(){var S=c.J_(m.server);u.info("zsc.rsfs.0 "+m.server+"lazy end start, empty "+S),S&&m.disconnectServer()},r)},a=(i=this.A_[bs])===null||i===void 0?void 0:i.signal;a&&!this.hasRTCStream&&l(a);var h=(s=this.A_[_s])===null||s===void 0?void 0:s.signal;h&&!this.hasL3Stream&&l(h)},e.prototype.J_=function(t){var n;return!!(!((n=this.A_[t])===null||n===void 0)&&n.signal&&(t===bs&&!this.hasRTCStream||t===_s&&!this.hasL3Stream))},e.prototype.stopPlayingStream=function(t,n){var r=ei(this.an,t);r.info("zsc.sps.1.1 call "+JSON.stringify(n));var i=this.playerList[t];if(i){var s=i.retryStreamHandler;s&&(s.stopMaxTime(),s.invalid()),i.playStream&&zl.sourceDisConnect(i.playStream),delete this.playerList[t],this.resetNetworkData(),s.getTryTime(i),i.stopPlay(n);var c=i.rtcViewer;c&&c.stop(),this.removeStreamFromSignal(!1,t),!i.isProbe&&this.billingTimer.stopChargeInfosUpload(),this.stopSoundLevel(),delete this.playSuccessCallBackList[t],delete this.playErrorCallBackList[t],r.debug("zsc.sps.1.1 call success")}else r.info("zsc.sps.1.1 player don't exist")},e.prototype.reset=function(t,n){var r,i,s;for(var c in this.an.info("zsc.rs call "+t+" "+n),this.publisherList){var u=this.publisherList[c];if(((r=u.room)===null||r===void 0?void 0:r.roomID)==t||!t){var l=u.publisher,a=!1;n===0?(a=!0,l.stopReason="Logout"):n==1002031&&(l.stopReason="ReachMaxAVRetryTime");var h=n==1002031?Vc.Un:{code:n||0,message:""};a&&!l.Xh&&(h=Vc.ce),(s=(i=u.room)===null||i===void 0?void 0:i.streamHandler)===null||s===void 0||s.onPublishStateUpdate(E.eZ.error,c,h),this.stopPublishingStream(c,h),delete this.pn.publishStreamList[c]}}for(var m in this.playerList){a=!1;var S=this.playerList[m],x=S,q=x==null?void 0:x.state;n===0?(a=!0,S.stopReason="Logout"):S.stopReason="ReachMaxAVRetryTime";var V=S.room,_e=V&&V.roomID==t,ke=this.pn.roomList.length;if(h=n==1002031?Fc.Oe:{code:n||0,message:""},a&&q!==void 0&&q!==6&&(h=Fc.De),_e&&(this.getStream(V,m)||ke==1))this.onPlayStateUpdate(Ku,m,h),this.stopPlayingStream(m,h);else if(_e&&ke>1){var Pe=this.pn.roomList.find(function(Oe){return Oe.roomID!==t});Pe?this.playerList[m].room=Pe:(this.stopPlayingStream(m,h),this.onPlayStateUpdate(Ku,m,h))}}this.publishersLength==0&&Object.keys(this.playerList).length==0&&(this.z_={}),this.waitPublishList=[],this.waitPlayList=[],this.Fg.resetReport(),this.an.info("zsc.rs call success")},e.prototype.openConnectServerTask=function(t){var n=this,r=this.A_[t],i=r.signal,s=r.retryServerSignalHandler;if(s==null||s.reset(),i){var c=new mh(i,this.an);c.startRetryTask(this.pn.serverRetryTime,{firstInterval:0},function(u){},function(u){n.retryStreamList(u)},function(u,l){n.handleServerConnectFail(u,l)}),this.A_[t].retryServerSignalHandler=c}},e.prototype.retryStreamList=function(t){var n;for(var r in this.publisherList){var i=this.publisherList[r].publisher,s=this.publisherList[r].retryStreamHandler;this.an.info("zsc.orh.0 reconnect "+r+" "+i.state+" "+i.stateNego),i.state==7||i.isStateRetry?!s.isOverTime&&s.publishStateHandle(E.eZ.error,r,Vc.xn):i.state==6&&(i.resendStreamStatus(2),s.stopMaxTime())}for(var r in this.playerList){var c=this.playerList[r],u=c,l=c.playMode;s=c.retryStreamHandler,this.an.info("zsc.orh.0 reconnect "+r+" "+u.state+" "+u.stateNego),((n=u.signal)===null||n===void 0?void 0:n.server)===t&&(u.state==7||l!==E.ey.CDN&&u.isStateRetry?!s.isOverTime&&s.playStateHandle(Ku,r,Fc.Se):u.state==6&&s.stopMaxTime())}},e.prototype.getPublisher=function(t){var n=null;if((0,R.QP)(t)&&this.publisherList[t]&&this.publisherList[t].publisher)n=this.publisherList[t].publisher;else if((0,R.dr)(t)){var r=this.checkPublish(t);r&&(n=r==null?void 0:r.publisher)}return n},e.prototype.getPreviewer=function(t){var n,r=null;return(0,R.QP)(t)&&this.publisherList[t]&&this.publisherList[t].publisher?r=(n=this.publisherList[t].publisher)===null||n===void 0?void 0:n.previewer:(0,R.dr)(t)&&(r=this.checkPreview(t)),r},e.prototype.checkPlayer=function(t){return Object.values(this.playerList).find(function(n){return n.playStream===t})||null},e.prototype.checkPreview=function(t){for(var n=0;n<this.previewStreamList.length;n++)if(this.previewStreamList[n].localStream===t||t&&!(0,R.dr)(t)&&t.zegoStream&&this.previewStreamList[n].zegoCaptureStream==t.zegoStream)return this.previewStreamList[n];return null},e.prototype.checkPublish=function(t){for(var n in this.publisherList)if(this.publisherList[n].localStream==t)return this.publisherList[n];return null},e.prototype.getPublishList=function(t,n){var r;n===void 0&&(n=!0);var i=[],s=this.checkPreview(t);for(var c in n&&(s!=null&&s.zegoCaptureStream)&&(!((r=s.zegoCaptureStream)===null||r===void 0)&&r.stream)&&(t=s.zegoCaptureStream.stream),this.publisherList)this.publisherList[c].localStream==t&&i.push(this.publisherList[c]);return i},e.prototype.removePreview=function(t){for(var n=0;n<this.previewStreamList.length;n++)if(this.previewStreamList[n]===t){this.previewStreamList.splice(n,1);break}},e.prototype.onPlayerStreamUrlUpdate=function(t,n,r){},e.prototype.getScreenConstrains=function(t){var n={};if((0,R.dd)(t)&&t)n={audio:!1,video:{frameRate:nd},bitRate:this.au("screen_video_bitrate")||rd};else if((0,R.w)(t)){switch(t.videoQuality){case 1:n={video:{frameRate:b.frameRate},bitRate:b.bitRate};break;case 3:n={video:{frameRate:M.frameRate},bitRate:M.bitRate};break;case 4:n={video:{frameRate:t.frameRate,width:t.width,height:t.height},bitRate:t.bitRate};break;case 2:n={video:{frameRate:nd},bitRate:rd};break;default:n={video:{frameRate:nd},bitRate:this.au("screen_video_bitrate")||rd}}if(n.audio=!!(0,R.dd)(t.audio)&&t.audio,n.audio){var r={noiseSuppression:!1,autoGainControl:!1,echoCancellation:!0},i=t.ANS,s=t.AGC,c=t.AEC;i!==void 0&&(r.noiseSuppression=i),s!==void 0&&(r.autoGainControl=s),c!==void 0&&(r.echoCancellation=c),n.audio=r}n.video&&(n.captureElement=t.captureElement),n=ts(ts({},t),n)}return n},e.prototype.createScreenPreviewer=function(t,n,r){var i=new la(this.an,this.pn,this,"screen"),s=t.getVideoTracks()[0].getSettings();return this.previewStreamList.push(i),(0,R.w)(r)&&(i.mediaStreamConfig=r),i.localStream=t,i.initMediaTrack(t),i.videoInfo={width:s.width||0,height:s.height||0,frameRate:s.frameRate||15,bitRate:(n==null?void 0:n.bitRate)||1e3,startBitrate:(n==null?void 0:n.startBitrate)||this.au("bitrate_mode"),minBitrate:(n==null?void 0:n.minBitrate)||0,keyFrameInterval:(n==null?void 0:n.keyFrameInterval)||2,channelCount:(n==null?void 0:n.channelCount)||1,audioBitrate:1e3*((r==null?void 0:r.audioBitrate)||48),contentHint:""},n&&(0,R.QP)(n.videoOptimizationMode)&&(i.videoInfo.contentHint=n.videoOptimizationMode),i.previewSuc=!0,i.previewType="screen",i.videoPreviewType="screen",i.audioPreviewType="screen",n!=null&&n.videoOptimizationMode&&this.setVideoTrackContentHint(t,n==null?void 0:n.videoOptimizationMode),i},e.prototype.createCompositingPreviewer=function(t,n,r){var i=new la(this.an,this.pn,this,"compositing"),s=t.getVideoTracks()[0].getSettings();return this.previewStreamList.push(i),i.mediaStreamConfig=n,t.getAudioTracks().length>0&&(i.audioTrack=t.getAudioTracks()[0]),i.localStream=t,i.videoInfo=ts(ts({},i.videoInfo),{width:(n==null?void 0:n.width)||s.width||0,height:(n==null?void 0:n.height)||s.height||0,frameRate:(n==null?void 0:n.frameRate)||s.frameRate||15,bitRate:(n==null?void 0:n.bitrate)||2500}),i.previewSuc=!0,i.inputStreamOptions=r,i},e.prototype.setSoundLevelDelegate=function(t,n,r){r===void 0&&(r=!1),this.an.info("zsc.ssd.0 call"),this.soundLevelDelegate=t,this.enableInBackground=r,n&&this.setSoundLevelInterval(n),this.enableSoundLevelProcessor(t),t?(this.an.info("zsc.ssd.0 start getting sound"),this.activeSoundLevel()):(this.an.info("zsc.ssd.0 stop getting sound"),this.soundLevelTimer&&clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null,this.soundLevelInterval=1e3)},e.prototype.setSoundLevelInterval=function(t){var n,r;if(t&&this.soundLevelDelegate){for(var i in this.soundLevelInterval=t,this.previewStreamList)(n=this.previewStreamList[i].soundMeterWorklet)===null||n===void 0||n.setInterval(t);for(var i in this.playerList)(r=this.playerList[i].soundMeterWorklet)===null||r===void 0||r.setInterval(t)}},e.prototype.enableSoundLevelProcessor=function(t){for(var n in this.previewStreamList){var r=this.previewStreamList[n];t?r.startSoundLevel():r.stopSoundLevel()}for(var n in this.playerList){var i=this.playerList[n];t?i.startSoundLevel():i.stopSoundLevel()}},Object.defineProperty(e.prototype,"hasRemoteStream",{get:function(){return Object.keys(this.playerList).length>0},enumerable:!1,configurable:!0}),e.prototype.activeSoundLevel=function(){!this.soundLevelTimer&&this.soundLevelDelegate&&this.startSoundLevel()},e.prototype.startSoundLevel=function(){var t=this;this.soundLevelTimer&&(clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null),this.soundLevelDelegate&&(this.checkSoundLevel(),this.checkMicSoundLevel(),this.soundLevelTimer=setTimeout(function(){t.startSoundLevel()},this.soundLevelInterval))},e.prototype.checkSoundLevel=function(){var t=[];for(var n in this.publisherList){var r=0,i=this.publisherList[n].publisher,s=i.previewer;s&&(r=s.soundLevel),t.push({streamID:this.getBackStreamId(i.streamId),soundLevel:r,type:"push"})}for(var n in this.playerList){var c=this.playerList[n];c.streamId&&!c.isProbe&&t.push({streamID:this.getBackStreamId(c.streamId),soundLevel:c.soundLevel,type:"pull"})}this.soundLevelDelegate&&t.length>0&&this.onSoundLevelUpdate(t)},e.prototype.checkMicSoundLevel=function(){if(this.microphonePreviews.length&&this.soundLevelDelegate){var t=this.microphonePreviews.reduce(function(n,r){return r.soundLevel>n?r.soundLevel:n},0);this.onMicSoundLevelUpdate(t)}},e.prototype.getBackStreamId=function(t){return this.testEnvironment&&t?t.replace("zegotest-"+this.appid+"-",""):t},e.prototype.onSoundLevelUpdate=function(t){},e.prototype.onMicSoundLevelUpdate=function(t){},e.prototype.stopSoundLevel=function(){this.soundLevelTimer&&!this.hasRemoteStream&&this.previewStreamList.length===0&&(this.an.info("zsc.ssl.0 stop"),clearTimeout(this.soundLevelTimer),this.soundLevelTimer=null)},e.prototype.F_=function(){return this.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.kA.event)},e.prototype.startNetProbe=function(t,n,r){var i;n&&(n.probeTime=Date.now()),n&&!n.isPeer||!this.Od?this.cr.setError(this.F_(),{code:-1,message:"not support peer"}):(i=r||this.getProbeNodeList(n),this.an.info("zc.stnp.1 nodes ".concat(JSON.stringify(i))),i.length>0&&this.H_(t,n,i))},e.prototype.stopNetProbe=function(t){var n=this;this.D_&&t&&t.probeState!=Re.probed&&(this.an.info("zc.stnp.0 call ".concat(t.streamId)),Object.keys(this.D_).forEach(function(r){var i;!((i=n.D_[r])===null||i===void 0)&&i.isProbed||(n.stopPlayingStream(n.D_[r].streamID),delete n.D_[r])}),t.probeState=Re.probed,this.V_(t))},e.prototype.getProbeNodeList=function(t){var n;switch(t==null?void 0:t.ipNodeType){case A.ZV4Only:n=t.gwNodeList;break;case A.ZV4Priority:n=this.sortIPNodesByPriority(t.ipV4NodeList).map(function(r){return Tr(r)});break;case A.ZV6Priority:n=this.sortIPNodesByPriority(t.ipV6NodeList).map(function(r){return Tr(r)});break;case A.ZV6AndV4Priority:n=this.getSortedIPV6AndV4Nodes(t,"v6").map(function(r){return Tr(r)});break;default:n=[]}return n},e.prototype.V_=function(t){t.probeTimer&&clearTimeout(t.probeTimer),t.probeTimer=null},e.prototype.Q_=function(){var t="zegoprobe-"+new Date().getTime();return this.setPlayStateStart(t),{prober:this.playerList[t]?this.playerList[t]:null,streamID:t}},e.prototype.Y_=function(){var t=this,n="zc.sp.cdn";(0,te.rA)(this.an,n);var r=this.Q_(),i=r.prober,s=r.streamID;i&&(i.isProbe=!0,this.playerList[s].serverUrl=_s,this.startPlayingStream(s,function(){}),this.playerList[s].isProbeByDG=!0,i.onCalNetQualityResult=function(c,u){t.an.info("zc.ocnqr.0 l3 detect "+c+" "+u),t.stopPlayingStream(s),(0,te.EK)(t.an,n)})},e.prototype.K_=function(t,n,r,i){i===void 0&&(i=-1);var s={result:r,probeQuality:i,timeStamp:new Date().getTime()};this.D_[n]&&(this.D_[n].isProbed=!0),this.z_[n]=s,t.probedList.push(ts(ts({},s),{gwNode:n}))},e.prototype.H_=function(t,n,r){var i=this,s="zc.psp.0";if((0,te.rA)(this.an,s),n&&r){var c=n.streamId,u=this.F_();n.probeNodeList=r;var l=new Date().getTime(),a=r.filter(function(_e){return!(i.z_[_e]&&i.z_[_e].timeStamp+i.N_>l||n.probeState==Re.probed||i.D_[_e]&&!i.D_[_e].isProbed)&&(delete i.z_[_e],!0)}),h={};this.an.info("".concat(s," ").concat(c," probe nodes:").concat(JSON.stringify(a)));for(var m=a.length>this.x_?this.x_:a.length,S=function(_e){var ke=a[_e];if(m==0)return"break";m--,x.z_[ke]={};var Pe=x.Q_(),Oe=Pe.prober,Ge=Pe.streamID;if(x.D_[ke]={ipChange:!1,isProbed:!1,streamID:Ge},h[ke]=!0,!Oe)return{value:void 0};Oe.isProbe=!0,Oe.setSignal(n.signal),Oe.gwNode=ke,Oe.ipV6Prefer=x.getIPv6PreferByGwNode(ke),Oe.startPlay(Ge,function(){}),Oe.onCalNetQualityResult=function(Je,tt){var ut;tt===void 0&&(tt=-1);var vt="zc.ocnqr.0";i.an.info(vt+" "+Oe.gwNode+" "+Je+" "+tt),delete h[ke];var gt=Object.keys(h).length==0;if(!((ut=i.D_[ke])===null||ut===void 0)&&ut.ipChange)return i.an.info("".concat(vt," ipChange:").concat(ke)),i.stopPlayingStream(i.D_[ke].streamID),void delete i.D_[ke];var Pt=Re.tryProbe;for(var wt in i.publisherList){var At=i.publisherList[wt].publisher;At.probeNodeList.includes(ke)&&At.probeState==Pt&&i.handleProbeQuality(!0,At,ke,Je,tt,gt)}for(var wt in i.playerList){var Vt=i.playerList[wt];wt.indexOf("zegoprobe-")==-1&&Vt.probeNodeList.includes(ke)&&Vt.probeState==Pt&&i.handleProbeQuality(!1,Vt,ke,Je,tt,gt)}u.setAttributes({net_quality:k.kA.net_quality(parseInt(n.netQuality+"")),node_list:k.kA.node_list(r)}),u.end()},n.probeTimer||(n.probeTimer=setTimeout(function(){i.an.info("zc.snp.0 call probeTimer"),i.handleProbedList(t,n,!1,r)},6e3)),(0,te.EK)(x.an,s)},x=this,q=0;q<(a==null?void 0:a.length);q++){var V=S(q);if(typeof V=="object")return V.value;if(V==="break")break}}(0,te.OY)(this.an,s)},e.prototype.handleProbeQuality=function(t,n,r,i,s,c){var u;(0,te.rA)(this.an,"zc.hpq.0","".concat(n.streamId," ").concat(s," ").concat(r," ").concat(c," ")),this.K_(n,r,i,s),n.gwNode!=r&&((u=n.signal)===null||u===void 0?void 0:u.server)!=r||(n.probeQuality=s),c&&this.handleProbedList(t,n,c,n.probeNodeList)},e.prototype.handleProbedList=function(t,n,r,i){var s=this;this.V_(n);var c,u=n.probedList,l=n.probeState==Re.probed,a="zc.hpl.0";(0,te.rA)(this.an,a,"".concat(n.streamId," ").concat(JSON.stringify(u)," ").concat(l," ").concat(n.netQuality)),u.length&&!l?(u.length>1&&u.forEach(function(h){if(c){if(c.probeQuality<=h.probeQuality-20){var m=s.gwNodeNetQuality(h.gwNode);if(s.an.info("".concat(a," 1: {netQuality} ").concat(h.gwNode," current:").concat(JSON.stringify(c))),m==-1||m>=c.probeQuality+20)c=h;else{var S=s.gwNodeNetQuality(c.gwNode);s.an.info("".concat(a," 2: {_netQuality} ").concat(c.gwNode)),S!==-1&&S<=Math.max(40,n.netQuality+20)&&(c=h)}}}else h.probeQuality>Math.max(40,n.netQuality+20)&&(c=h)}),c||(c=u[0]),u.forEach(function(h){var m,S=(m=s.D_[h.gwNode])===null||m===void 0?void 0:m.streamID;S&&(s.stopPlayingStream(S),delete s.D_[h.gwNode])}),this.handleCalNetQualityResult(t,c,n,r,i),n.probedList=[]):this.an.info("".concat(a," pbLength:").concat(u.length," probed:").concat(l))},e.prototype.gwNodeNetQuality=function(t){var n,r=-1;for(var i in this.publisherList){var s=this.publisherList[i].publisher;s.gwNode!=t&&s.signal.server!=t||(r=s.netQuality)}for(var i in this.playerList)if(!i.includes("zegoprobe")){var c=this.playerList[i];c.gwNode!=t&&((n=c.signal)===null||n===void 0?void 0:n.server)!=t||(r=c.netQuality)}return r},e.prototype.handleCalNetQualityResult=function(t,n,r,i,s){var c=this,u=n.gwNode,l=n.result,a=n.probeQuality,h="zc.hcqr.0 ",m=!1,S=!0,x=ei(this.an,r.streamId);s==null||s.forEach(function(ke){var Pe;!((Pe=c.z_[ke])===null||Pe===void 0)&&Pe.probeQuality||(S=!1)}),x.info("".concat(h," t:").concat(r.netQuality," probe:").concat(a,", gw:").concat(u,",r:").concat(l,", last:").concat(S));var q=this.cr.createSpan(E.t0.H,{key:k.vW.event},{key:""},k.Lk.event);if(l==0&&(a>Math.max(40,r.netQuality+20)?(x.info(h+" switch "+u),m=!0,this.retryStream(r,t,u),r.probeState=Re.probed):m=!1),!m)if(S){if(x.info(h+" last "),!r.ql)for(var V in r.netProbeToReDispatch(function(){r.ql=!1,x.info("".concat(h," gw redispatch success")),c.startNetProbe(t,r)},function(){x.info("".concat(h," gw redispatch fail")),r.ql=!1}),this.z_)this.z_[V].netQuality===-1&&(this.z_[V]={})}else i&&this.startNetProbe(t,r,s);var _e=k.Lk;q.setAttributes({is_switch:_e.is_switch(m),is_publish:_e.is_publish(t),stream_id:_e.stream_id(r.streamId),result:_e.result(l),node:_e.node(u),net_quality:_e.net_quality(parseInt(r.netQuality+"")),probe_net_quality:_e.probe_net_quality(parseInt(a+""))}),q.end()},e.prototype.retryStream=function(t,n,r){if(n){var i=t,s=i.streamId,c=i.localStream,u=i.publishOption;i.resetPublish(1),i.gwNode=r,i.startPublish(s,c,u,this.getReferredVideoBitrate())}else{var l=t,a=(s=l.streamId,l.getRemoteStreamSuc);l.resetPlay(!0,1),this.onPlayStateUpdate(E.h7.retry,s,{code:Et.cMG.code,message:Et.cMG.message}),l.gwNode=r,l.startPlay(s,a)}},e.prototype.getRoomByStreamID=function(t){return this.publisherList[t]?this.publisherList[t].room:this.playerList[t]?this.playerList[t].room:void 0},e.prototype.setVideoTrackContentHint=function(t,n){if((0,R.QP)(n)){var r=n.toLowerCase();if(["default","motion","detail","text"].includes(r)){var i=t.getVideoTracks()[0];i?"contentHint"in i?(this.an.info("zc.svtch "+r),i.contentHint=r=="default"?"":r):this.an.warn("zc.svtch mediaStreamTrack contentHint attribute not supported"):this.an.warn("zc.svtch video track no found")}else this.an.warn("zc.svtch videoOptimizationMode wrong")}else this.an.warn("zc.svtch videoOptimizationMode type wrong")},e.prototype.getPlayRoom=function(t){var n=this;return this.pn.roomList.find(function(r){return!!n.getStream(r,t)})},e.prototype.getStream=function(t,n){return t.streamList.find(function(r){return r.stream_id==n})},e.prototype.updateQuality=function(t,n){this.Fg.updateQualityOrChargeInfo(t,n)},e.prototype.checkStreamReport=function(){this.Fg.checkStreamReport(),this.Fg.reportOldCacheData()},e.prototype.stopToReport=function(t){this.Fg.updateQualityOrChargeInfo(t,void 0,!0)},e.prototype.setIsPeer=function(t){this.Od=t,Object.values(this.publisherList).forEach(function(n){n.publisher.isPeer=t}),Object.values(this.playerList).forEach(function(n){n.isPeer=t})},e.prototype.setStreamGwNode=function(t,n){var r=ei(this.an,t.streamId);r.info(ie.OKY+" call"),this.checkCachedNodesUse(t,n),t.gwNodesTTL&&t.gwNodesTTL<new Date().getTime()&&(r.info(ie.OKY+" ttl timeout, reset gw"),t.resetGwNodes()),this.gwNode&&(t.gwNode=this.gwNode),r.info(ie.OKY+" end "+t.gwNode)},e.prototype.getNodeIndex=function(t,n){var r="",i=n?"publish":"play",s="";switch(n||(t.playMode==E.ey.RTC?s="_rtc":t.playMode===E.ey.L3&&(s="_l3")),this.cachedGwNodesMode){case Vs.NotReUse:break;case Vs.TheSameReUse:r=i+"_"+t.streamId+s;break;case Vs.DiffReUse:r=i;break;case Vs.AllReUse:r="stream"}return r},e.prototype.checkCachedNodesUse=function(t,n){var r,i,s,c=ei(this.an,t.streamId);if(c.info(ie.KWc+" call "+this.cachedGwNodesMode),t.isExternal)if(n&&t.isCustomCdn())c.info(ie.KWc+" custom cdn");else if(t.hasSucceed&&this.pn.isMultiOuter)c.info(ie.KWc+" multi outer");else{var u=this.getNodeIndex(t,n);if(c.info(ie.KWc+" "+u),u){var l=this.cachedGwNodesList[u];l&&l.gwNodesTTL&&l.gwNodesTTL>new Date().getTime()&&(l!=null&&l.gwNodes&&((r=l==null?void 0:l.gwNodes)===null||r===void 0?void 0:r.length)>0||l!=null&&l.ips&&((i=l==null?void 0:l.ips)===null||i===void 0?void 0:i.length)>0||l!=null&&l.ipv6s&&((s=l==null?void 0:l.ipv6s)===null||s===void 0?void 0:s.length)>0)&&(c.info(ie.KWc+" use cache gwnodes"),l.gwNodes&&(t.gwNodeList=l.gwNodes),t.gwNodesTTL=l.gwNodesTTL,l.ips&&(t.ipV4NodeList=l.ips),l.ipv6s&&(t.ipV6NodeList=l.ipv6s),t.ipNodeType===A.ZV4Only?(t.gwNode=t.gwNodeList[0],t.ipV6Prefer=L.kV4Only):(t.gwNode=this.getGwNode(t,this.ipNodeType,-1),t.ipV6Prefer=this.ipV6Prefer))}c.info(ie.KWc+" end "+t.gwNode)}else c.info(ie.KWc+" retry internal")},e.prototype.updateCachedGwNodesList=function(t,n,r,i,s,c){s===void 0&&(s=[]),c===void 0&&(c=[]);var u=ei(this.an,t);if(u.info(ie.WaK+" call"),i===0)this.setCachedGwNodesMode(Vs.NotReUse);else if(i>0){var l=n?this.getPublisher(t):this.playerList[t];if(l){var a=this.getNodeIndex(l,n);u.info(ie.WaK+" nodeIndex "+a),a&&(this.cachedGwNodesList[a]||(this.cachedGwNodesList[a]={}),this.cachedGwNodesList[a].gwNodesTTL=new Date().getTime()+1e3*i,(r==null?void 0:r.length)>0&&(this.cachedGwNodesList[a].gwNodes=r),(s==null?void 0:s.length)>0&&(this.cachedGwNodesList[a].ips=s),(c==null?void 0:c.length)>0&&(this.cachedGwNodesList[a].ipv6s=c))}else this.an.info(ie.WaK+" player no found"+t)}},e.prototype.clearCachedGwNodesList=function(t,n){var r=this.getNodeIndex(t,n);this.an.info(ie.E8q+" nodeIndex "+r,{streamid:t.streamId}),r&&delete this.cachedGwNodesList[r]},e.prototype.setCachedGwNodesMode=function(t){this.cachedGwNodesMode=t},e.prototype.updateTimeOffsetInterval=function(){var t,n,r=this;(0,R.Cs)((t=this.I_)===null||t===void 0?void 0:t.netAgent.timeOffset)&&(this.pn.clientTimeOffset=(n=this.I_)===null||n===void 0?void 0:n.netAgent.timeOffset),this.Pu=setTimeout(function(){r.updateTimeOffsetInterval()},9e5)},e.prototype.changeRxQuality=function(t){this.M_=t,this.startPublishNetWorkQuality()},e.prototype.changeTxQuality=function(t){this.P_=t,this.startPublishNetWorkQuality()},e.prototype.startPublishNetWorkQuality=function(){var t=this;this.qp===null&&(this.qp=setInterval(function(){t.pn.actionListener("networkQuality","",t.P_,t.M_)},3e3))},e.prototype.resetNetworkData=function(){Object.keys(this.playerList).length<1&&(this.M_=-1),this.publishersLength<1&&(this.P_=-1),Object.keys(this.playerList).length<1&&this.publishersLength<1&&(clearInterval(this.qp),this.qp=null)},e.prototype.getCloudSoundInterval=function(){var t=this.au("sound_sample_interval");return t&&(t<100&&(t=100),t>3e3&&(t=3e3),this.an.info("zc.gsl setting sound_sample_interval "+t)),t},e.prototype.createSoundLevel=function(t,n,r,i,s){r===void 0&&(r=this.soundLevelInterval),s===void 0&&(s=function(l){});var c=new zl(this.an,this.pn,r,i),u=c.getSrcSource(t,n);return c.initAudioWorklet(t,u),c.onSoundLevelUpdate=function(l){s(l)},{mic:u,soundMeter:c}},e.prototype.createSEIWorker=function(){if(this.isNotSupportSeiWorker)return null;var t=this.seiWorker;if(t)return t;var n=Bp.toString().trim().match(/\{([\s\S]*)\}/)[1],r=URL.createObjectURL(new window.Blob([n],{type:"text/javascript"}));return t=this.seiWorker=new Worker(r),this.an.info("zsc.gseiw init sei"),t},e.prototype.handleSeiRollBack=function(){this.isNotSupportSeiWorker=!0,this.destroySEIWorker()},e.prototype.destroySEIWorker=function(){var t;(t=this.seiWorker)===null||t===void 0||t.terminate(),this.seiWorker=void 0},e.prototype.destroy=function(){var t;this.soundLevelTimer&&clearTimeout(this.soundLevelTimer),this.Pu&&clearTimeout(this.Pu),this.qp&&clearInterval(this.qp),(t=this._billingTimer)===null||t===void 0||t.destroy(),this.Z_(),this.checkDeviceChange=void 0,this.isCandidateHasIPv6=!1,this.captureStreamElementMap.clear(),this.B_.stop(),this.destroySEIWorker(),te.VJ.removeEventListener("visibilitychange",this.eventHandler.visibilitychange)},e.prototype.Z_=function(){var t=this;Object.keys(this.A_).forEach(function(n){var r,i;t.A_[n].signal=null,(i=(r=t.A_[n])===null||r===void 0?void 0:r.retryServerSignalHandler)===null||i===void 0||i.invalid(),t.A_[n].retryServerSignalHandler=null,delete t.A_[n]})},e.prototype.supplementPlayingChargeTime=function(){this.billingTimer.supplementPlayingChargeTime()},e.prototype.getDataChannelOption=function(){var t={ordered:!0},n=this.pn.engineConfig.datachannelOption;return(0,R.dd)(n.ordered)&&!n.ordered&&(t.ordered=!1,(0,R.Cs)(n.maxPacketLifeTime)&&n.maxPacketLifeTime>0&&n.maxPacketLifeTime<5e3?t.maxPacketLifeTime=n.maxPacketLifeTime:(0,R.Cs)(n.maxRetransmits)&&n.maxRetransmits>0&&n.maxRetransmits<50&&(t.maxRetransmits=n.maxRetransmits)),t},e.prototype.getIPv6PreferByGwNode=function(t){return Ar(Dr(t))===Y.IPv4?L.kV4AndV6:L.kV6AndV4},e.prototype.getGwNode=function(t,n,r){var i="",s=t.gwNodeList,c=t.ipV4NodeList,u=t.ipV6NodeList;if(n===A.ZV4Only)(s==null?void 0:s.length)>0&&(i=s[++r%s.length]);else if(n===A.ZV4Priority)(c==null?void 0:c.length)>0&&(t.ipNode=c[++r%c.length],i=Tr(t.ipNode));else if(n===A.ZV6Priority)(u==null?void 0:u.length)>0&&(t.ipNode=u[++r%u.length],i=Tr(t.ipNode));else if(n===A.ZV6AndV4Priority){var l=this.getSortedIPV6AndV4Nodes(t,"v6");if(l.length>0)if(r===-1)i=Tr(l[0]);else{var a=Ui(l,t.gwNode);i=Tr(l[++a%l.length])}}return this.an.info("zsc.gw get node ".concat(A[n]," ").concat(r," ").concat(i)),i},e.prototype.sortIPNodesByPriority=function(t){return t.sort(function(n,r){return n.priority>r.priority?-1:n.priority<r.priority?1:0})},e.prototype.getSortedIPV6AndV4Nodes=function(t,n){var r=Gp([],t.ipV6NodeList,!0);return t.ipV4NodeList.forEach(function(i){i.vid.split("|").every(function(s){return r.every(function(c){return c.ip===s})})||r.push(i)}),r.sort(function(i,s){return i.priority>s.priority?-1:i.priority<s.priority?1:Yi(i.ip)?n==="v6"?-1:1:n==="v6"?1:-1}),r},e.prototype.isNodeLast=function(t){var n=0,r=!1,i=t.gwNodeList,s=t.ipV4NodeList,c=t.ipV6NodeList,u=t.gwNode;if(t.ipNodeType===A.ZV4Only)r=(n=i.findIndex(function(m){return m==u}))===i.length-1;else{var l=Ui(s,u),a=Ui(c,u);if(t.ipNodeType===A.ZV4Priority)r=(n=l)===s.length-1;else if(t.ipNodeType===A.ZV6Priority)r=(n=a)===c.length-1;else{var h=this.getSortedIPV6AndV4Nodes(t,"v6");r=(n=Ui(h,u))===h.length-1}}return{lastTryNext:r,currentIdx:n}},e.prototype.getStreamIPNodesMode=function(){var t,n;if(this.an.info("zsc.gsinm call, proxy: ".concat(this.isProxy,", mode: ").concat(N[this.pn.selectIPStackMode]," ")),this.isProxy||this.pn.selectIPStackMode===N.IPv4Only)t=L.kV4Only,n=A.ZV4Only;else if(this.pn.selectIPStackMode===N.IPv4Prefer){var r=this.getIPV4PreferNodeType();n=r.ipNodeType,t=r.ipV6Prefer}else{var i=this.getIPV6PreferNodeType();n=i.ipNodeType,t=i.ipV6Prefer}return this.an.info("zsc.gsinm prefer: ".concat(t,", nodeType: ").concat(n)),this.ipV6Prefer=t,this.ipNodeType=n,{ipV6Prefer:t,ipNodeType:n}},e.prototype.getIPV4PreferNodeType=function(){var t=this.agentConnectIPStackType;this.an.info("zsc.gi4nt connected: ".concat(Y[t],", detection: ").concat(JSON.stringify(this.agentIpStackDetection)));var n,r,i=this.agentIpStackDetection,s=i.IPv4,c=i.IPv6;return t===Y.IPv4||s===H.reachable?(n=A.ZV4Only,r=L.kV4Only):[H.unknown,H.unreachable].includes(s)&&c===H.reachable?(n=A.ZV6Priority,r=L.kV6AndV4):(n=A.ZV4Priority,r=L.kV4AndV6),{ipNodeType:n,ipV6Prefer:r}},e.prototype.getIPV6PreferNodeType=function(){this.an.info("zsc.gi6nt detection: ".concat(JSON.stringify(this.agentIpStackDetection)));var t,n,r=this.agentIpStackDetection,i=r.IPv4-r.IPv6;return i===0?(t=A.ZV6AndV4Priority,n=L.kV6AndV4):i>0?(t=A.ZV4Priority,n=L.kV4AndV6):(t=A.ZV6Priority,n=L.kV6AndV4),{ipNodeType:t,ipV6Prefer:n}},e.prototype.getRetryIPPreferNodeType=function(){var t,n;this.an.info("zsc.gripnt mode:".concat(N[this.pn.selectIPStackMode]," detection: ").concat(this.agentIpStackDetection));var r=this.agentIpStackDetection;if(this.pn.selectIPStackMode===N.IPv4Prefer)r.IPv4===H.reachable?(t=A.ZV4Priority,n=L.kV4AndV6):r.IPv6===H.reachable?(t=A.ZV6Priority,n=L.kV6AndV4):(t=A.ZV4Priority,n=L.kV4AndV6);else{var i=this.getIPV6PreferNodeType();t=i.ipNodeType,n=i.ipV6Prefer}return{ipNodeType:t,ipV6Prefer:n}},e.prototype.G_=function(t){var n=this;setTimeout(function(){Object.values(n.playerList).forEach(function(r){r.changePublishOccasion(t)})},0)},e.prototype.getReferredVideoBitrate=function(){var t=Date.now();return this.referenceBitrateUpdateTs>0&&t-this.referenceBitrateUpdateTs<3e4?this.referenceVideoBitrate:0},e.prototype.updateReferenceBitrate=function(t){this.referenceVideoBitrate=t,this.referenceBitrateUpdateTs=Date.now()},e.prototype.au=function(t,n){return this.pn.settingConfig.getSetting(t,n)},e.closeNetProbe=!1,e}(dp),Wp=pt(6794),yh=function(){function o(e){this.v=e}return o.prototype.takeStreamSnapshot=function(e){return this.v.takeStreamSnapshot(e)},o.prototype.play=function(e,t){return this.v.play(e,t)},o.prototype.stop=function(){return this.v.stop()},o.prototype.playVideo=function(e,t){this.v.playVideo(e,t)},o.prototype.stopVideo=function(){this.v.stopVideo()},o.prototype.playAudio=function(e){this.v.playAudio(e,!0)},o.prototype.stopAudio=function(){this.v.stopAudio()},o.prototype.resume=function(){this.v.resume()},o.prototype.setAudioMuted=function(e){return this.v.setAudioMuted(e)},o.prototype.setVideoMuted=function(e){return this.v.setVideoMuted(e)},o.prototype.useAudioOutputDevice=function(e){return this.v.useAudioOut(e)},o.prototype.setVolume=function(e){return this.v.setVolume(e)},o.prototype.getVideoHeight=function(){return this.v.getVideoHeight()},o.prototype.getVideoWidth=function(){return this.v.getVideoWidth()},o.prototype.on=function(e,t){return this.v.on(e,t)},o.prototype.off=function(e,t){return this.v.off(e,t)},o}(),qc=function(){return qc=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},qc.apply(this,arguments)},Qp=function(){function o(e,t,n){this.X_=e,this.W_=t,this.gn=n,this._initTime=Date.now()}return Object.defineProperty(o.prototype,"appid",{get:function(){return this.W_.appid},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"device_id",{get:function(){return this.X_.deviceID},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"product",{get:function(){return this.X_.roomServer},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sdk_version",{get:function(){return E.qt},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sys_info",{get:function(){return navigator.userAgent},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"report_version",{get:function(){return this.W_.sdkVerNum},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"browser",{get:function(){return this.W_.browser},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"id_name",{get:function(){return this.X_.idName},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"nick_name",{get:function(){return this.X_.nickName},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"use_na",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"userid",{get:function(){return this.X_.userid},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"network_state",{get:function(){return this.W_.networkState},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"init_time",{get:function(){return this._initTime},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"net_type",{get:function(){var e;return((e=navigator.connection)===null||e===void 0?void 0:e.effectiveType)||"unknown"},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"room_server",{get:function(){return this.X_.roomServer},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"device_infos",{get:function(){return this.W_.deviceInfos},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"room_list",{get:function(){var e=this,t={};return this.W_.roomList.forEach(function(n){var r,i,s,c=e.X_.roomModulesList.find(function(l){return l.roomID===n.roomID}),u={roomSessionID:n.roomSessionID,sessionID:n.sessionID,streamList:n.streamList,token:n.token,role:e.X_.role,roomCreateFlag:e.X_.roomCreateFlag,loginTime:c==null?void 0:c.loginTime,heartbeatInterval:(r=c==null?void 0:c.heartBeatHandler)===null||r===void 0?void 0:r.heartbeatInterval,roomExtraInfos:(i=c==null?void 0:c.messageHandler)===null||i===void 0?void 0:i.transSeqMap,roomRetryTime:(s=c==null?void 0:c.roomTryHandler)===null||s===void 0?void 0:s.RETRY_MAX_TIME};t[n.roomID]=u}),t},enumerable:!1,configurable:!0}),o.prototype.getRoomList=function(e,t){var n=this;return this.room_id_list.slice(e,t).map(function(r){return qc({roomID:r},n.room_list[r])})},Object.defineProperty(o.prototype,"room_id_list",{get:function(){return this.W_.roomList.map(function(e){return e.roomID})},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"roomListSize",{get:function(){return this.room_id_list.length},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"userLoginState",{get:function(){var e,t=this.X_.roomModulesList[0],n=t.runState,r=t.lastRunState;return n===E.UV.logout?e=E.Es.logout:n===E.UV.login?e=E.Es.login:r===E.UV.logout?e=E.Es.trylogin:r===E.UV.login&&(e=E.Es.reconnect),e},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"publishStreamList",{get:function(){return Object.keys(this.gn.publisherList)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"publishList",{get:function(){var e=this,t={};return this.publishStreamList.forEach(function(n){var r,i,s,c=e.gn.publisherList[n],u=c==null?void 0:c.publisher,l=u==null?void 0:u.publishStat;t[n]={streamSid:c==null?void 0:c.streamSid,roomID:(r=c==null?void 0:c.room)===null||r===void 0?void 0:r.roomID,roomSessionID:(i=c==null?void 0:c.room)===null||i===void 0?void 0:i.roomSessionID,cameraLabel:c==null?void 0:c.cameraLabel,microLabel:c==null?void 0:c.microLabel,cameraStatus:u==null?void 0:u.camera_status,micStatus:u==null?void 0:u.mic_status,sessionId:u==null?void 0:u.sessionId,publishBeginTime:u==null?void 0:u.reportPublishStateTime,serverUrl:(s=u==null?void 0:u.signal)===null||s===void 0?void 0:s.server,gwNode:u==null?void 0:u.gwNode,proto:"webrtc",frameWidth:l==null?void 0:l.frameWidth,frameHeight:l==null?void 0:l.frameHeight,rtt:l==null?void 0:l.currentRoundTripTime,videoPacketsLostRate:l==null?void 0:l.videoPacketsLostRate,audioPacketsLostRate:l==null?void 0:l.audioPacketsLostRate,videoTargetBitrate:l==null?void 0:l.videoTargetBitrate,videoBitrate:l==null?void 0:l.videoBitrate,audioTargetBitrate:l==null?void 0:l.audioTargetBitrate,audioBitrate:l==null?void 0:l.audioBitrate,videoTargetFPS:l==null?void 0:l.videoTargetFPS,videoFPS:l==null?void 0:l.videoFPS,audioFPS:l==null?void 0:l.audioFPS,videoCodecName:l==null?void 0:l.videoCodecName,audioCodecName:l==null?void 0:l.audioCodecName}}),t},enumerable:!1,configurable:!0}),o.prototype.getPublishList=function(e,t){var n=this;return this.publishStreamList.slice(e,t).map(function(r){return qc({streamID:r},n.publishList[r])})},Object.defineProperty(o.prototype,"publishListSize",{get:function(){return this.publishStreamList.length},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"playStreamList",{get:function(){return Object.keys(this.gn.playerList)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"playList",{get:function(){var e=this,t={};return this.playStreamList.forEach(function(n){var r,i,s,c=e.gn.playerList[n],u=c,l=u==null?void 0:u.playStat;t[n]={streamSid:c==null?void 0:c.streamSid,roomID:(r=c==null?void 0:c.room)===null||r===void 0?void 0:r.roomID,roomSessionID:(i=c==null?void 0:c.room)===null||i===void 0?void 0:i.roomSessionID,cameraStatus:u==null?void 0:u.cameraStatus,micStatus:u==null?void 0:u.micStatus,sessionId:u==null?void 0:u.sessionId,playBeginTime:u==null?void 0:u.reportPlayStateTime,serverUrl:(s=u==null?void 0:u.signal)===null||s===void 0?void 0:s.server,gwNode:u==null?void 0:u.gwNode,proto:"webrtc",frameWidth:l==null?void 0:l.frameWidth,frameHeight:l==null?void 0:l.frameHeight,rtt:l==null?void 0:l.currentRoundTripTime,videoPacketsLostRate:l==null?void 0:l.videoPacketsLostRate,audioPacketsLostRate:l==null?void 0:l.audioPacketsLostRate,videoBitrate:l==null?void 0:l.videoBitrate,audioBitrate:l==null?void 0:l.audioBitrate,videoFPS:l==null?void 0:l.videoFPS,audioFPS:l==null?void 0:l.audioFPS,videoCodecName:l==null?void 0:l.videoCodecName,audioCodecName:l==null?void 0:l.audioCodecName,peerToPeerDelay:l==null?void 0:l.peerToPeerDelay,firstFrameTime:l==null?void 0:l.firstFrameTime,videoJitter:l==null?void 0:l.videoJitter,audioJitter:l==null?void 0:l.audioJitter}}),t},enumerable:!1,configurable:!0}),o.prototype.getPlayList=function(e,t){var n=this;return this.playStreamList.slice(e,t).map(function(r){return qc({streamID:r},n.playList[r])})},Object.defineProperty(o.prototype,"playListSize",{get:function(){return this.playStreamList.length},enumerable:!1,configurable:!0}),o}(),ic="zc.ac.mer",Jp=function(){function o(e,t,n){var r=this;this.an=e,this.ac=t,this.pa=n,this.error=!1,this.effectMode=1,this.eventHandler={volumechange:function(i){var s=i.target;s&&r.ty&&(s.muted||s.paused?(r.an.info(ic+" local audio muted disconnect"),r.ty.disconnect()):(r.an.info(ic+" local audio is connected"),r.ty.connect(r.ac.destination)))}},this.an.info(ic+" create audio renderer"),this.error=!this.init(),this.error||(n.addEventListener("volumechange",this.eventHandler.volumechange),n.addEventListener("pause",this.eventHandler.volumechange),n.addEventListener("play",this.eventHandler.volumechange))}return o.prototype.setGain=function(e){this.ty&&(this.ty.gain.value=e)},o.prototype.init=function(){var e=this.ac;try{var t=(0,Vn.$t)().match(/iPhone\sOS\s(\d+)_(\d+)_?(\d+)?/);if(t&&+t[1]==17&&+t[2]==0&&+t[3]<4)throw" iOS 17 not suppot createMediaElementSource.";this.pa.crossOrigin!=="anonymous"&&this.an.info(ic+" Media element does not support cross-origin. Maybe no sound can be played"),this.srcNode=e.createMediaElementSource(this.pa);var n=this.ty=e.createGain();n.connect(e.destination),this.srcNode.connect(n),this.ac.state==="suspended"&&this.ac.resume()}catch(r){return this.an.warn(ic+" create src failed."+r),!1}return!0},o.prototype.getMixNode=function(){var e=this.mixOutputNode;return e||(e=this.mixOutputNode=this.ac.createGain()),this.setVoiceChangeNode(this.effectMode,this.voiceChangerNode,!0),{mixOutputNode:e}},Object.defineProperty(o.prototype,"effectOnLocal",{get:function(){return[da.SC.Local,da.SC.All].includes(this.effectMode)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"effectOnMix",{get:function(){return[da.SC.Publish,da.SC.All].includes(this.effectMode)},enumerable:!1,configurable:!0}),o.prototype.setVoiceChangeNode=function(e,t,n){if(n===void 0&&(n=!1),this.ty&&this.srcNode&&(n||this.voiceChangerNode!==t||this.effectMode!==e)){this.effectMode=e,this.srcNode.disconnect();var r=this,i=r.mixOutputNode,s=r.effectOnLocal,c=r.effectOnMix;if(this.an.info(ic+" set voice changer render. ".concat(JSON.stringify({mode:e,node:!!t,force:n,effectOnLocal:s,effectOnMix:c}))),t)t.disconnect(),this.srcNode.connect(t),s?t.connect(this.ty):this.srcNode.connect(this.ty),i&&(c?t.connect(i):this.srcNode.connect(i)),this.voiceChangerNode=t;else{var u=this.srcNode;u.connect(this.ty),this.mixOutputNode&&u.connect(this.mixOutputNode),this.voiceChangerNode=void 0}}},o.prototype.destroy=function(){var e;(e=this.ty)===null||e===void 0||e.connect(this.ac.destination),this.pa.removeEventListener("volumechange",this.eventHandler.volumechange),this.pa.removeEventListener("pause",this.eventHandler.volumechange),this.pa.removeEventListener("play",this.eventHandler.volumechange)},o}(),Kp=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Yp=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Zp=function(){function o(e){var t=this;this.an=e,this.isResuming=!1,this.iy=new Map,this.sy=new Map,this.eventHandler={resumeAudioContext:function(r){var i=t.ac.state;if(i!=="running"){var s=r==null?void 0:r.type;t.an.info("zc.ac.rs call "+i+", "+s),t.ac.resume().then(function(){t.an.info("zc.ac.rs end "+t.ac.state+", "+s)})}else t.offCheckAudioContextListener()}},this.id=Date.now();var n=window.AudioContext||window.webkitAudioContext;this.ac=new n,this.an.info("zc.ac.0 ".concat(this.id," ").concat(this.ac.state,", ").concat(this.ac.sampleRate)),this.ac.addEventListener("statechange",function(){var r,i=(r=t.ac)===null||r===void 0?void 0:r.state;t.an.info("zc.ac.sc ".concat(t.id," ").concat(i)),i!=="running"&&t.checkAudioContext()}),this.checkAudioContext()}return o.create=function(e){return o.mgr?o.mgr.an=e:o.mgr=new o(e),o.mgr},o.prototype.getMediaElementRenderer=function(e){var t=this.iy.get(e);return t||((t=new Jp(this.an,this.ac,e)).error?null:(this.iy.set(e,t),t))},o.prototype.checkAudioContext=function(){if(this.an.info("zc.ac.cac call"),this.ac&&this.ac.state==="suspended"){var e=this.eventHandler.resumeAudioContext;(0,Vn.nr)()&&e(),window.addEventListener("mousedown",e)}},o.prototype.offCheckAudioContextListener=function(){this.an.info("zc.ac.ocac call"),window.removeEventListener("mousedown",this.eventHandler.resumeAudioContext)},o.prototype.registerModule=function(e,t){return Kp(this,void 0,void 0,function(){var n,r,i;return Yp(this,function(s){switch(s.label){case 0:if(this.sy.get(e))return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),n=new Blob([t],{type:"text/javascript"}),r=URL.createObjectURL(n),[4,this.ac.audioWorklet.addModule(r)];case 2:return s.sent(),this.sy.set(e,!0),[3,4];case 3:return i=s.sent(),this.sy.set(e,!1),this.an.error("zc.ac.rm.0 ".concat(e," fail ").concat(i.toString())),[3,4];case 4:return[2]}})})},o.prototype.destroy=function(){this.offCheckAudioContextListener()},o}(),Xp=function(){function o(e,t){var n=t.type,r=t.channels,i=r===void 0?1:r,s=t.bufferSize,c=s===void 0?0:s,u=t.sampleBit,l=u===void 0?16:u,a=t.sampleRate,h=a===void 0?44100:a,m=this;this.instant=0,this.slow=0,this.clip=0,this.context=e,this.type=n,this.channels=i,this.bufferSize=c,this.sampleBit=l,this.sampleRate=h,this.script=e.createScriptProcessor(c,i,i),new Date().getTime(),this.script.addEventListener("audioprocess",function(S){var x,q=S.inputBuffer.getChannelData(0),V=0,_e=0;for(x=0;x<q.length;++x)V+=q[x]*q[x],Math.abs(q[x])>.99&&(_e+=1);if(m.instant=Math.sqrt(V/q.length),m.slow=.95*m.slow+.05*m.instant,m.clip=_e/q.length,n==="pcm"||n==="wav"){for(var ke=[],Pe=0;Pe<m.channels;Pe++)ke.push(S.inputBuffer.getChannelData(Pe));m.recorderBuffer(ke)}}),n!=="pcm"&&n!=="wav"||this.initRecorderBuffer(n)}return o.prototype.connectToSource=function(e,t){try{this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination),(0,R.TE)(t)||t(null)}catch(n){console.error(n),(0,R.TE)(t)||t(n)}return this},o.prototype.recorderBuffer=function(e){this.worker.postMessage({command:"record",val:e})},o.prototype.initRecorderBuffer=function(e){var t=this;this.worker=this.inlineWorker(function(){var n,r,i,s,c,u,l=[];function a(Pe,Oe,Ge){for(var Je=0;Je<Ge.length;Je++,Oe+=2){var tt=Math.max(-1,Math.min(1,Ge[Je]));Pe.setInt16(Oe,tt<0?32768*tt:32767*tt,!0)}}function h(Pe,Oe,Ge){for(var Je=0;Je<Ge.length;Je++,Oe++){var tt=Math.max(-1,Math.min(1,Ge[Je])),ut=tt<0?128*tt:127*tt;Pe.setInt8(Oe,ut+=128)}}function m(Pe,Oe,Ge){for(var Je=0;Je<Ge.length;Je++)Pe.setUint8(Oe+Je,Ge.charCodeAt(Je))}function S(Pe,Oe){for(var Ge=new Float32Array(Oe.length/Pe),Je=0,tt=0;Je<Ge.length;)Ge[Je]=Oe[tt],tt+=Pe,Je++;return Ge}function x(Pe,Oe,Ge){for(var Je=new Float32Array(Oe*Pe.length),tt=0,ut=0;ut<Ge[0].length;ut++)Je.set(Ge[0][ut],tt),tt+=Ge[0][ut].length;return Je}function q(Pe,Oe){for(var Ge=new Float32Array(Pe.length+Oe.length),Je=0;Je<Pe.length+Oe.length;Je+=2)Ge[Je]=Pe[Je/2|0],Ge[Je+1]=Oe[Je/2|0];return Ge}function V(Pe){var Oe,Ge;if(n==1)Oe=x(l[0],c,l),Pe!=1&&(Ge=S(Pe,Oe));else if(n==2){var Je=x(l[0],c,l),tt=x(l[1],c,l);Pe!=1?Ge=q(S(Pe,Je),S(Pe,tt)):Oe=q(Je,tt)}return Pe!=1?Ge:Oe}function _e(Pe){var Oe=function(Ge,Je){var tt;Je==8?tt=Ge.length:Je==16&&(tt=Ge.length,tt*=2);var ut=new ArrayBuffer(tt),vt=new DataView(ut);return Je==8?h(vt,0,Ge):r==16&&a(vt,0,Ge),vt}(V(Pe),r);self.postMessage({command:"exportPcmLive",val:Oe})}function ke(Pe){var Oe=function(Ge,Je){var tt;Je==8?tt=Ge.length:r==16&&(tt=Ge.length,tt*=2);var ut=new ArrayBuffer(tt+44),vt=new DataView(ut),gt=i,Pt=r,wt=n;return m(vt,0,"RIFF"),vt.setUint32(4,36+tt,!0),m(vt,8,"WAVE"),m(vt,12,"fmt "),vt.setUint32(16,16,!0),vt.setUint16(20,1,!0),vt.setUint16(22,wt,!0),vt.setUint32(24,gt,!0),vt.setUint32(28,gt*wt*(Pt/8),!0),vt.setUint16(32,wt*(Pt/8),!0),vt.setUint16(34,Pt,!0),m(vt,36,"data"),vt.setUint32(40,tt,!0),r==8?h(vt,44,Ge):r==16&&a(vt,44,Ge),vt}(V(Pe),r);self.postMessage({command:"exportWav",val:Oe})}this.onmessage=function(Pe){switch(Pe.data.command){case"init":n=(Oe=Pe.data.val).sampleChannel,r=Oe.sampleBit,i=Oe.sampleRate,s=Oe.oldSampleRate,c=Oe.bufferSize,u=Oe.type;break;case"record":(function(Ge){for(var Je=0;Je<n;Je++)l[Je]||(l[Je]=[]),l[Je].push(Ge[Je]);var tt=Math.round(s/i);u==="pcm"?_e(tt):u==="wav"&&ke(tt),l=[]})(Pe.data.val)}var Oe}}),this.worker.postMessage({command:"init",val:{sampleChannel:this.channels,sampleBit:this.sampleBit,sampleRate:this.sampleRate,oldSampleRate:this.context.sampleRate,bufferSize:this.bufferSize,type:e}}),this.worker.onmessage=function(n){switch(n.data.command){case"exportPcmLive":t.onReceiveBuffer(n.data.val);break;case"exportWav":t.onReceiveWav(n.data.val)}}},o.prototype.onReceiveBuffer=function(e){},o.prototype.onReceiveWav=function(e){},o.prototype.writeString=function(e,t,n){for(var r=0;r<n.length;r++)e.setUint8(t+r,n.charCodeAt(r))},o.prototype.writeBuffer=function(e,t,n){for(var r=0;r<n.byteLength;r++)e.setUint8(t+r,n[r])},o.prototype.concatenation=function(e){for(var t=0,n=0;n<e.length;++n)t+=e[n].buffer.byteLength;var r=new Uint8Array(t),i=0;for(n=0;n<e.length;++n)r.set(new Uint8Array(e[n].buffer),i),i+=e[n].buffer.byteLength;return r},o.prototype.encodeWave=function(e){var t=this.concatenation(e),n=t.byteLength,r=new ArrayBuffer(n+44),i=new DataView(r),s=this.sampleRate,c=this.sampleBit,u=this.channels;return this.writeString(i,0,"RIFF"),i.setUint32(4,36+n,!0),this.writeString(i,8,"WAVE"),this.writeString(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,u,!0),i.setUint32(24,s,!0),i.setUint32(28,s*u*(c/8),!0),i.setUint16(32,u*(c/8),!0),i.setUint16(34,c,!0),this.writeString(i,36,"data"),i.setUint32(40,n,!0),this.writeBuffer(i,44,t),i},o.prototype.stop=function(){this.mic.disconnect(),this.script.disconnect()},o.prototype.inlineWorker=function(e){if(Worker&&e){var t=e.toString().trim().match(/\{([\s\S]*)\}/)[1],n=URL.createObjectURL(new window.Blob([t],{type:"text/javascript"}));return new Worker(n)}return null},o}(),ns=function(){return ns=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},ns.apply(this,arguments)},rs=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},is=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},$p=function(o,e,t){if(t||arguments.length===2)for(var n,r=0,i=e.length;r<i;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return o.concat(n||Array.prototype.slice.call(e))},Fs=function(){function o(e,t,n,r,i,s){s===void 0&&(s=E.UP.Default);var c,u,l=this;if(this.logger=e,this.reporter=n,this.recordedBlobs=[],this.mediaRecorder=null,o.isInstantiated=!0,this.an=e,this.dataReport=t,this.acMgr=Zp.create(this.an),this.stateCenter=new Oh(this.an,this.dataReport),this.pn=this.stateCenter,this.pn.clientType="webrtc",this.pn.settingConfig=r.stateCenter.settingConfig,r._on("_experimentalAPICallback",function(h){l.stateCenter.onExperimentalAPICallback(h)}),((c=o.engineOptions)===null||c===void 0?void 0:c.pri)===!0){var a=o.engineOptions.netMode;a!==E.Am.Extranet&&a!==E.Am.Intranet||(this.pn.netMode=o.engineOptions.netMode)}this.RTM=r,this.pn.appid=r.getAppID(),this.streamCenter=new id(this.an,this.pn,this.dataReport,this.RTM,this.acMgr,{type:o.geoFenceType,areaList:o.geoFenceAreaList}),this.gn=this.streamCenter,this.pn.browser=Wp.browserDetails.browser,this.pn.browserInfo=(0,Vn._Z)(),this.pn.sdkVerNum=this.RTM.stateCenter.sdkVerNum,this.RTM.cloudSetting.setEnvVariable("sdk_version",E.qt),this.initTracer(n),this.rtcModules=new Lc(this.an,this.dataReport,this.pn,this.gn,this.RTM,this.ac,this),(u=this.RTM.cloudSetting)===null||u===void 0||u.getSettingCache(Zo).then(function(h){var m;l.an.info(ie.BBG+" streamConfig "+JSON.stringify(h));var S=l.cr.createSpan(E.t0.H,{key:k.oq.event},{key:""},k.Xk.event);S.setAttributes({files:k.Xk.files([{name:Zo,content:JSON.stringify(h==null?void 0:h.setting),versions:JSON.stringify(h==null?void 0:h.versions),code:0,message:""}])}),S.end(),l.pn.settingConfig.setSetting(h==null?void 0:h.setting);var x=l.pn.settingConfig.getSetting("open_mini_sdp");(m=l.gn)===null||m===void 0||m.initMiniSdpWorker(x)}).catch(function(h){l.an.warn(ie.BBG+" streamConfig "+JSON.stringify(h))}),this.pn.rtm=this.RTM,this.pn.streamCenter=this.gn,[3,4,5,6,7,8,9].includes(s)?(this.pn.scenario=s,this.an.info(ie.sk8+" "+s+" success")):s===100?(this.stateCenter.scenario=s,this.an.info(ie.sk8+" "+s+" liveroom set")):(this.pn.scenario=E.UP.Default,this.an.error(ie.sk8+" "+s+"  please use valid scenario")),this.RTM.stateCenter.onListener("_beforeSwitchRoom",function(h){var m;if(l.rtcModules.publishModule.stopPublishingStreamInRoom(h),l.stateCenter.engineConfig.switchRoomNotStopPlay){var S=[];for(var x in l.streamCenter.playerList)((m=l.streamCenter.playerList[x].room)===null||m===void 0?void 0:m.roomID)===h&&(S.push(x),l.streamCenter.playerList[x].room={});var q=function(V,_e){l.RTM.stateCenter.offListener("_afterSwitchRoom",q);for(var ke=l.stateCenter.getRoomByRoomID(V),Pe=0,Oe=S;Pe<Oe.length;Pe++){var Ge=Oe[Pe];_e&&ke?l.streamCenter.playerList[Ge].room=ke:l.rtcModules.playModule.stopPlayingStream(Ge)}};l.RTM.stateCenter.onListener("_afterSwitchRoom",q)}else l.rtcModules.playModule.stopPlayingStreamInRoom(h)})}return Object.defineProperty(o.prototype,"ac",{get:function(){return this.acMgr.ac},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),o.setGeoFence=function(e,t){if(o.isInstantiated)throw Et.mHY;o.geoFenceType=e,o.geoFenceAreaList=t},o.setEngineOptions=function(e){o.engineOptions=ns(ns({},o.engineOptions||{}),e),e.geoFenceType&&(o.geoFenceType=e.geoFenceType),e.geoFenceAreaList&&(o.geoFenceAreaList=e.geoFenceAreaList),typeof e.closeNetProbe=="boolean"&&id.setCloseNetProbe(e.closeNetProbe),(0,te.zQ)(e.dataReportCustomerContext,!0)&&id.setReportCustomerContext(e.dataReportCustomerContext),e.ipStackMode!==void 0&&[0,1,2].includes(e.ipStackMode)&&(o.ipStackMode=e.ipStackMode)},o.prototype.destroyEngineHandler=function(){var e=this;this.an.info(ie.Wgj+" call");var t=function(){return!e.RTM.stateCenter.roomModulesList.some(function(r){return!(r.isLogout()||r.roomState==="DISCONNECTED")})},n=function(){e.destroyCopyrightedMusic(),e.RTM.destroyRTM();for(var r=0,i=e.gn.previewStreamList;r<i.length;r++){var s=i[r];s.localStream&&e.destroyStream(s.localStream)}e.pn.actionListener("_engineDestroy"),e.acMgr.destroy(),e.rtcModules.publishModule.destroy(),e.gn.destroy(),e.pn.destroy(),e.RTM.netAgent.destroy(),e.an.info(ie.Wgj+" call success"),e.an.destroy()};t()?n():(this.RTM.off("roomStateUpdate"),this.off("playerStateUpdate"),this.off("publisherStateUpdate"),this.RTM.stateCenter.onListener("_roomStateUpdate",function(r,i){i==="DISCONNECTED"&&t()&&n()}),this.RTM.logoutRoom())},o.prototype.mutePublishStreamVideo=function(e,t,n){return this.rtcModules.publishModule.mutePublishStreamVideo(e,t,n)},o.prototype.mutePublishStreamAudio=function(e,t){return this.rtcModules.publishModule.mutePublishStreamAudio(e,t)},o.prototype.mutePlayStreamVideo=function(e,t){return this.rtcModules.playModule.mutePlayStreamVideo(e,t)},o.prototype.mutePlayStreamAudio=function(e,t){return this.rtcModules.playModule.mutePlayStreamAudio(e,t)},o.prototype.muteMicrophone=function(e){return this.rtcModules.publishModule.muteMicrophone(e)},o.prototype.isMicrophoneMuted=function(){return!this.gn.isMicEnabled},o.prototype.setAudioOutput=function(e,t){return this.an.info(ie.it$+" call"),(0,R.QP)(t)?this.rtcModules.playModule.setStreamAudioOutput(e,t):(this.an.error("audiooutput is not string"),!1)},o.prototype.setGWNode=function(e){(0,R.QP)(e)&&e.length>0&&(this.gn.gwNode=e)},o.prototype.setQualityMonitorCycle=function(e){return this.an.warn("setQualityMonitorCycle method deprecated!!!"),!1},o.prototype.startPlayingStream=function(e,t,n){return this.an.info(ie.rGc+" call by user",{streamid:e+""}),this.rtcModules.playModule.startPlayingStream(e,t,n)},o.prototype.setPlayStreamVideoType=function(e,t){return this.rtcModules.playModule.setPlayStreamVideoType(e,t)},o.prototype.stopPlayingStream=function(e){this.an.info(ie.dk2+" call by user",{streamid:e+""}),this.rtcModules.playModule.stopPlayingStream(e,void 0,!0)},o.prototype.setPlayAccelerate=function(e){this.pn.playAccelerate=e},o.prototype.setTurnOverTcpOnly=function(e){this.an.info(ie.ZIe+" call "+e),(0,R.dd)(e)?this.pn.turnOverTcpOnly=e:this.an.error("zc.p.stoto.0 param must be param")},o.prototype.createStream=function(e){return this.rtcModules.publishModule.createStream(e,!0)},o.prototype.createZegoStream=function(e){return this.rtcModules.publishModule.createZegoStream(e)},o.prototype.setRoomScenario=function(e){return[3,4,5,6,7,8,9].includes(e)?(this.an.info(ie.ibZ+" "+e+" called"),this.pn.roomList.length?(this.an.error(ie.ibZ+" "+JSON.stringify(Et.p7L)),!1):(this.pn.scenario=e,this.an.info(ie.ibZ+" "+e+" called success"),!0)):(this.an.error(ie.ibZ+" "+e+" please use valid scenario"),!1)},o.prototype.destroyStream=function(e){this.an.info(ie.mLk+" call by user"),this.rtcModules.publishModule.destroyStream(e)},o.prototype.startPublishingStream=function(e,t,n,r){return this.an.info(ie.gkP+" call by user",{streamid:e+""}),this.rtcModules.publishModule.startPublishingStream(e,t,n&&ns({},n),r)},o.prototype.updatePublishingStream=function(e,t){return this.an.info(ie.xcY+" call by user"),this.rtcModules.publishModule.updatePublishingStream(e,t)},o.prototype.activateSEIInsert=function(e){return this.rtcModules.publishModule.activateSEIInsert(e)},o.prototype.setSEIConfig=function(e){this.an.info("zc.ssc "+JSON.stringify(e)),this.pn.seiConfig=ns(ns({},this.pn.seiConfig),e),this.pn.player265ReceiverList.forEach(function(t){t.sendMsg({type:"SEIConfigUpdate"})})},o.prototype.sendSEI=function(e,t){return this.rtcModules.publishModule.sendSEI(e,t)},o.prototype.stopPublishingStream=function(e){return this.an.info(ie.K4A+" call by user",{streamid:e+""}),this.rtcModules.publishModule.stopPublishingStream(e,void 0,!0)},o.prototype.setVideoConfig=function(e,t){return this.rtcModules.publishModule.setVideoConfig(e,t)},o.prototype.setAudioConfig=function(e,t){return this.rtcModules.publishModule.setAudioConfig(e,t)},o.prototype.replaceTrack=function(e,t){return this.rtcModules.publishModule.replaceTrack(e,t)},o.prototype.preloadEffect=function(e,t,n){if(this.rtcModules.audioMixModule===void 0)throw(0,te.d1)(["audio mix"]);this.rtcModules.audioMixModule.preloadEffect(e,t,n)},o.prototype.getEffectDuration=function(e){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.getEffectDuration(e);throw(0,te.d1)(["audio mix"])},o.prototype.getEffectCurrentProgress=function(e,t){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.getEffectProgress(e,t);throw(0,te.d1)(["audio mix"])},o.prototype.seekAudioEffect=function(e,t,n){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.seekAudioEffect(e,t,n);throw(0,te.d1)(["audio mix"])},o.prototype.playEffect=function(e,t,n){if(this.rtcModules.audioMixModule===void 0)throw(0,te.d1)(["audio mix"]);this.rtcModules.audioMixModule.playEffect(e,t,n)},o.prototype.pauseEffect=function(e,t){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.pauseEffect(e,t);throw(0,te.d1)(["audio mix"])},o.prototype.resumeEffect=function(e,t){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.resumeEffect(e,t);throw(0,te.d1)(["audio mix"])},o.prototype.stopEffect=function(e,t){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.stopEffect(e,t);throw(0,te.d1)(["audio mix"])},o.prototype.unloadEffect=function(e){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.unloadEffect(e);throw(0,te.d1)(["audio mix"])},o.prototype.setEffectVolume=function(e,t,n,r){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.setEffectVolume(e,t,n,r);throw(0,te.d1)(["audio mix"])},o.prototype.startMixingAudio=function(e,t){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.startMixingAudio(e,t);throw(0,te.d1)(["audio mix"])},o.prototype.stopMixingAudio=function(e,t){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.stopMixingAudio(e,t);throw(0,te.d1)(["audio mix"])},o.prototype.mixingBuffer=function(e,t,n,r){if(this.rtcModules.audioMixModule===void 0)throw(0,te.d1)(["audio mix"]);this.rtcModules.audioMixModule.mixingBuffer(e,t,n,r)},o.prototype.stopMixingBuffer=function(e,t){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.stopMixingBuffer(e,t);throw(0,te.d1)(["audio mix"])},o.prototype.setMixingAudioVolume=function(e,t,n){if(this.rtcModules.audioMixModule!==void 0)return this.rtcModules.audioMixModule.setMixingAudioVolume(e,t,n);throw(0,te.d1)(["audio mix"])},o.prototype.checkSystemRequirements=function(e,t){var n=this,r=navigator&&navigator.mediaDevices&&(o.screenShotReady||"getDisplayMedia"in navigator.mediaDevices);return this.an.info(ie.XQ0+" call"+(0,Vn.$t)()),new te.l3(function(i){var s=(0,te.fU)(n.cr,E.t0.H,"",k.J8.event,k.oq.event),c=t||"all",u=function(l){(0,te.lA)(s,{capability:k.J8.capability(l)});var a=n.pn.checkList.indexOf(c);n.pn.checkList.splice(a,1),i(l)};return["webRTC","customCapture","camera","microphone","screenSharing","H264","VP8","H265","all"].includes(c)&&[0,1].includes(e)?n.pn.checkList.includes(c)||n.pn.checkList.includes("all")?u({result:!1,errInfo:{extendedDate:"The last test of the same type has not returned a result "}}):(n.pn.checkList.push(c),void sa(r,u,e,t,n.pn.customUa)):u({result:!1,errInfo:{extendedDate:"param error"}})})},o.prototype.enumDevices=function(e,t){return rs(this,void 0,void 0,function(){var n,r,i,s,c,u,l,a,h,m,S,x,q,V=this;return is(this,function(_e){switch(_e.label){case 0:return this.an.info("zc.ed.0 call"),n=function(){return new te.l3(function(ke,Pe){V.rtcModules.publishModule.recordDevices(function(Oe){var Ge=!0,Je=!0;Oe.cameras.find(function(tt){if(tt.deviceID==="")return Ge=!1,!0}),Oe.microphones.find(function(tt){if(tt.deviceID==="")return Je=!1,!0}),ke({devices:Oe,enableCamera:Ge,enableMic:Je})},function(Oe){Pe(Oe)})})},[4,n()];case 1:return r=_e.sent(),i=r.enableCamera,s=r.enableMic,c=r.devices,e?(this.an.info("zc.ed.0 check permission"),u={video:!0,audio:!0},t==="videoinput"?u.audio=!1:t!=="audioinput"&&t!=="audiooutput"||(u.video=!1),a=u.audio&&!s,(l=u.video&&!i)||a?(this.an.info("zc.ed.0 need to get device permission. needCamera: ".concat(l,", needMic: ").concat(a)),[4,Wi(u).catch(function(){})]):[3,4]):[3,4];case 2:return(h=_e.sent())&&h.getTracks().forEach(function(ke){ke.stop()}),[4,n()];case 3:m=_e.sent(),S=m.devices,x=m.enableCamera,q=m.enableMic,u.video&&!x&&this.an.warn("zc.ed.0 get video device permission failed."),u.audio&&!q&&this.an.warn("zc.ed.0 get audio device permission failed."),c=S,_e.label=4;case 4:return[2,c]}})})},o.prototype.getCameras=function(){return rs(this,void 0,void 0,function(){return is(this,function(e){switch(e.label){case 0:return[4,this.enumDevices(!0,"videoinput")];case 1:return[2,e.sent().cameras]}})})},o.prototype.getMicrophones=function(){return rs(this,void 0,void 0,function(){return is(this,function(e){switch(e.label){case 0:return[4,this.enumDevices(!0,"audioinput")];case 1:return[2,e.sent().microphones]}})})},o.prototype.getSpeakers=function(){return rs(this,void 0,void 0,function(){return is(this,function(e){switch(e.label){case 0:return[4,this.enumDevices(!0,"audiooutput")];case 1:return[2,e.sent().speakers]}})})},o.prototype.getAudioInfo=function(e,t,n){if(!e)return this.an.error("localStream is empty!"),!1;var r=ns({},n);return new Xp(this.ac,r).connectToSource(e,function(i){t(i)})},o.prototype.getSoundLevel=function(e,t,n){if(!this.rtcModules.audioMixModule)throw(0,te.d1)(["audio mix"]);this.rtcModules.audioMixModule.getSoundLevel(e,t,n)},o.prototype.stopSoundLevel=function(e){if(!this.rtcModules.audioMixModule)throw(0,te.d1)(["audio mix"]);this.rtcModules.audioMixModule.stopSoundLevel(e)},o.prototype.handleDataAvailable=function(e){e.data&&e.data.size>0&&o.recordedBlobs.push(e.data)},o.prototype.setAudioFrameCallback=function(e,t,n){var r=this;return new Promise(function(i,s){return rs(r,void 0,void 0,function(){var c,u,l,a,h;return is(this,function(m){switch(m.label){case 0:if(c=function(x){s({errorCode:x.errorCode||x.code,extendedData:x.extendedData||x.message})},!((0,R.QP)(e)||(0,R.dr)(e)||(S=e,S instanceof zd)))return this.an.error("zc.safc.0 streamID must be string or ZegoLocalStream or MediaStream"),c(Et.ZEp),[2];if(n!=null&&n.frameSize&&![256,512,1024,2048,4096,8192,16384].includes(n==null?void 0:n.frameSize))return this.an.error("zc.safc.0 option frameSize invalid"),c(Et.ZEp),[2];if((0,R.QP)(e)){if(!(l=this.gn.playerList[e]))return this.an.error("zc.safc.0 player not found"),c(Et.oCq),[2];if(((h=l.playStream)===null||h===void 0?void 0:h.getAudioTracks().length)===0)return this.an.error("zc.safc.0 no stream or no audio"),c(Et.oCq),[2];u=l}else{if(!(a=this.gn.checkPreview(e)))return this.an.error("zsc.sd.0 preview no found"),c(Et.fzq),[2];if(e.getAudioTracks().length===0||a.isOriginEmptyTrack())return this.an.error("zsc.sd.0 preview no audio track"),c(Et.akY),[2];u=a}return[4,this.gn.acMgr.registerModule("audioPCMExporter",`class AudioPcmDataProcessor extends AudioWorkletProcessor {\r
  // 0. Determine the buffer size (this is the same as the 1st argument of ScriptProcessor)\r
\r
  constructor(options) {\r
    super();\r
    // console.error("AudioPcmDataProcessor");\r
    this.bufferSize = 1024;\r
    // 1. Track the current buffer fill level\r
    this._bytesWritten = 0;\r
\r
    // 2. Create a buffer of fixed size\r
    this.channelCount = 2;\r
\r
    this.inputChannels = [];\r
    this.bufferSize = options.processorOptions.bufferSize || this.bufferSize;\r
    this.initBuffer();\r
    this.port.postMessage({\r
      type: "msg",\r
      msg: "init"\r
    });\r
  }\r
\r
  initBuffer() {\r
    this._bytesWritten = 0;\r
  }\r
\r
  process(inputList) {\r
    // console.warn("process", inputList[0]);\r
    this.port.postMessage({\r
      type: "proces",\r
      len: inputList[0].length\r
    });\r
    if (this.isBufferFull()) {\r
      this.flush();\r
    }\r
\r
    const _inputChannels = inputList[0];\r
    this.channelCount = _inputChannels.length;\r
    if (_inputChannels && _inputChannels.length) {\r
      // \r
      if (!this.inputChannels[0]) {\r
        for (let i = 0; i < this.channelCount; i++) {\r
          this.inputChannels[i] = new Float32Array(this.bufferSize);\r
        }\r
      }\r
\r
      const bufferLen = _inputChannels[0].length;\r
      for (let j = 0; j < bufferLen; j++) {\r
        for (let i = 0; i < _inputChannels.length; i++) {\r
          this.inputChannels[i][this._bytesWritten] = _inputChannels[i][j];\r
        }\r
        this._bytesWritten++;\r
      }\r
    }\r
    return true;\r
  }\r
\r
  isBufferEmpty() {\r
    return this._bytesWritten === 0;\r
  }\r
\r
  isBufferFull() {\r
    // console.warn(this._bytesWritten, this.bufferSize, this.channelCount);\r
    return this._bytesWritten === this.bufferSize;\r
  }\r
\r
  flush() {\r
    this.port.postMessage({\r
      type: "process",\r
      channels: this.inputChannels,\r
      channelCount: this.inputChannels.length,\r
      sampleRate: sampleRate\r
    });\r
    this.initBuffer();\r
  }\r
}\r
\r
try {\r
  registerProcessor("audio-pcm-data-processor", AudioPcmDataProcessor);\r
} catch (error) {\r
  // console.warn("registerProcessor", error);\r
}\r
`)];case 1:return m.sent(),u.setAudioFrameCallback(t,n),i({errorCode:0,extendedData:""}),[2]}var S})})})},o.prototype.startRecord=function(e){var t=this,n=this.gn.checkPreview(e);if(!n)throw"start record failed. streamNotFromZegoStr.";var r=e.clone(),i=r.getAudioTracks();i.length>0&&n.hasEmptyAudioTrack&&i.forEach(function(c){r.removeTrack(c)}),this.recordedBlobs=[];var s={mimeType:"video/webm;codecs=vp9"};console.log("MediaRecorder",MediaRecorder),MediaRecorder.isTypeSupported(s.mimeType)||(s={mimeType:"video/webm;codecs=vp8,opus"},MediaRecorder.isTypeSupported(s.mimeType)||(s={mimeType:"video/webm;codecs=vp8"},MediaRecorder.isTypeSupported(s.mimeType)||(s={mimeType:"video/webm"},MediaRecorder.isTypeSupported(s.mimeType)||(s={mimeType:""}))));try{this.mediaRecorder=new MediaRecorder(r,s)}catch(c){return void this.an.error("zc.mdrcd Exception while creating ZegoMediaRecorder:",c)}this.mediaRecorder.onstop=function(c){t.an.warn("zc.mdrcd Recorder stopped: "+c)},this.mediaRecorder.ondataavailable=this.handleDataAvailable.bind(this),this.mediaRecorder.start(10)},o.prototype.stopRecord=function(){this.mediaRecorder?this.mediaRecorder.stop():this.an.warn("zc.mdrcd please invoke startRecord first")},o.prototype.resumeRecord=function(){this.mediaRecorder?this.mediaRecorder.resume():this.an.warn("zc.mdrcd please invoke startRecord first")},o.prototype.pauseRecord=function(){this.mediaRecorder?this.mediaRecorder.pause():this.an.warn("zc.mdrcd please invoke startRecord first")},o.prototype.saveRecord=function(e){if(this.mediaRecorder&&this.recordedBlobs){var t=new Blob(this.recordedBlobs,{type:"video/webm"}),n=window.URL.createObjectURL(t),r=te.VJ.createElement("a");r.style.display="none",r.href=n,r.download=e+".webm",te.VJ.body.appendChild(r),r.click(),setTimeout(function(){te.VJ.body.removeChild(r),window.URL.revokeObjectURL(n)},100)}else this.an.warn("please invoke startRecord first")},o.prototype.useVideoDevice=function(e,t){return this.rtcModules.publishModule.useVideoDevice(e,t)},o.prototype.useAudioDevice=function(e,t){return this.rtcModules.publishModule.useAudioDevice(e,t)},o.prototype.useFrontCamera=function(e,t){return this.rtcModules.publishModule.useFrontCamera(e,t)},o.prototype.getElectronScreenSources=function(){return this.rtcModules.publishModule.getElectronScreenSources()},o.prototype.setSoundLevelDelegate=function(e,t,n){this.an.info("zc.ssd.0 call"),(0,R.dd)(e)?t&&(!(0,te.zQ)(t)||t<100||t>3e3)?this.an.error("zc.ssd.0 soundLevel interval must be integer number which is between 100 and 3000"):this.gn.setSoundLevelDelegate(e,t,n):this.an.error("zc.ssd.0 param 1 must be boolean")},o.prototype.on=function(e,t){return this.rtcModules.bindListener(e,t)},o.prototype.off=function(e,t){return this.rtcModules.deleteListener(e,t)},o.prototype.getVersion=function(){return E.qt},o.prototype.setStreamExtraInfo=function(e,t){return this.rtcModules.streamCommon.setStreamExtraInfo(e,t)},o.prototype.addPublishCdnUrl=function(e,t){return this.an.info("zg.cm.apu call "+t,{streamid:e}),this.rtcModules.streamCDNModule?this.rtcModules.streamCDNModule.publishTarget({type:"addpush",streamID:e,pushUrl:t}):(0,te.AA)(["stream CDN"])},o.prototype.removePublishCdnUrl=function(e,t){return this.an.info("zg.cm.rpu call "+t,{streamid:e}),this.rtcModules.streamCDNModule?this.rtcModules.streamCDNModule.publishTarget({type:"delpush",streamID:e,pushUrl:t}):(0,te.AA)(["stream CDN"])},o.prototype.startMixerTask=function(e){return(0,te.AA)(["mix stream"])},o.prototype.startAutoMixerTask=function(e){return(0,te.AA)(["mix stream"])},o.prototype.setMixerTaskConfig=function(e){return(0,te.AA)(["mix stream"])},o.prototype.stopMixerTask=function(e){return(0,te.AA)(["mix stream"])},o.prototype.stopAutoMixerTask=function(e){return(0,te.AA)(["mix stream"])},o.prototype.setCaptureVolume=function(e,t){return this.rtcModules.publishModule.setCaptureVolume(e,t)},o.use=function(e){switch(e.type){case"AudioMix":e.install(Lc,Kl);break;case"MixStream":e.install(o,Nc,Lc);break;case"StreamCDN":e.install(o,Lc,Nc);break;case"Advance":e.install(o,Lc,Nc,la,Wd,Hd,Kl,fh);break;case"BeautyEffect":case"VoiceChanger":e.install(o,la);break;case"RangeAudio":case"DataChannel":case"AiDenoise":case"BackgroundProcess":case"CopyrightedMusic":case"StreamCompositor":e.install(o)}},o.prototype.createRangeAudioInstance=function(){throw(0,te.d1)(["range audio"])},o.prototype.createCopyrightedMusic=function(){throw(0,te.d1)(["copyrighted music"])},o.prototype.destroyCopyrightedMusic=function(){},o.prototype.createRealTimeSequentialDataManager=function(e){throw(0,te.d1)(["data channel"])},o.prototype.destroyRealTimeSequentialDataManager=function(e){throw(0,te.d1)(["data channel"])},o.prototype.enableDataChannel=function(e){(0,R.dd)(e)&&(this.gn.isDataChannelEnabled=e)},o.prototype.addTrack=function(e,t){var n=this;return new te.l3(function(r,i){var s={id:t.id,muted:t.muted,enabled:t.enabled,kind:t.kind,readyState:t.readyState,label:t.label};n.an.info(ie.WuQ+" call. ".concat(e==null?void 0:e.id," track: ")+JSON.stringify(s)),n.rtcModules.publishModule.handleTrack("ADD",e,t,r,i)})},o.prototype.removeTrack=function(e,t){var n=this;return new te.l3(function(r,i){n.an.info(ie.FGD+" call"),n.rtcModules.publishModule.handleTrack("REMOVE",e,t,r,i)})},o.prototype.setBeautyEffect=function(e,t,n){return(0,te.AA)(["beauty effect"])},o.prototype.setLowlightEnhance=function(e,t){return(0,te.AA)(["beauty effect"])},o.prototype.getPublishingStreamQuality=function(e){return this.rtcModules.publishModule.getStreamStats(e)},o.prototype.getPlayingStreamQuality=function(e){return this.rtcModules.playModule.getStreamStats(e)},o.prototype.checkAudioTrackIsActive=function(e){var t=this;return this.an.info("zc.caia.0 call"),new te.l3(function(n,r){if(e=(0,Qi.L)(e,t.an),!t.checkTrackParam(e,1))return t.an.info("zc.caia.0 param active: false"),n(!1);var i=0;try{var s=0,c=t.gn.createSoundLevel(t.ac,e,50,50,function(l){l*=100;var a=!1;s>=4?(u.destroy(),(l>0||i>0)&&(a=!0),t.an.info("zc.caia.0 active: "+a),n(a)):i=Math.max(l,i),s++}),u=c.soundMeter;u&&c.mic||(t.an.error("zc.cvia.1 checkVideoTrackIsActive not supported"),n(!1))}catch(l){t.an.error("zc.cvia.1 "+l),n(!1)}})},o.prototype.checkVideoTrackIsActive=function(e){var t=this;this.an.info("zc.cvia.0 call");var n=this;return new te.l3(function(r,i){if(e=(0,Qi.L)(e,t.an),!t.checkTrackParam(e,0))return t.an.info("zc.cvia.1 param active: false"),r(!1);var s=(0,te.sb)(1,1),c=(0,te.FP)(160,120).getContext("2d");c&&(c!=null&&c.drawImage)&&(c!=null&&c.getImageData)||(n.an.error("zc.cvia.1 checkVideoTrackIsActive not supported"),r(!1)),s.style.position="fixed",s.style.left="-1000px",s.style.opacity="0.01",te.VJ.body.appendChild(s),s.srcObject=e;var u=null;function l(){c=null;try{s.pause(),s.remove(),s.srcObject=null}catch{}}function a(){s.play();var h=setTimeout(function(){clearTimeout(h),h=null,s.removeEventListener("canplay",a),c==null||c.drawImage(s,0,0,160,120);var m=setTimeout(function(){clearTimeout(m),m=null;var S=c==null?void 0:c.getImageData(0,0,160,120),x=(S==null?void 0:S.data)&&Math.floor(S.data.length/3);if(x){for(var q=3;q<x;q+=4)if(S.data[q-1]!==0||S.data[q-2]!==0||S.data[q-3]!==0)return n.an.info("zc.cvia.0 active: true"),r(!0),void l();l(),n.an.info("zc.cvia.1 active: false"),r(!1)}},20)},200)}s.addEventListener("canplay",a),u=setTimeout(function(){clearTimeout(u),s.removeEventListener("canplay",a),l(),r(!1)},1e3)})},o.prototype.checkTrackParam=function(e,t){var n,r=this;if(this.an.info("zc.ctp.0 call type:"+t),!(0,R.dr)(e))return this.an.error("zc.ctp.1 param 1 must be MediaStream"),!1;var i=this.gn.checkPreview(e),s=Object.keys(this.gn.playerList).find(function(u){var l;return((l=r.gn.playerList[u])===null||l===void 0?void 0:l.playStream)===e});if(!i&&!s)return this.an.error("zc.ctp.1 "+te.aw),!1;var c=e[t==0?"getVideoTracks":"getAudioTracks"]()[0];return c?c.readyState!=="live"||!c.enabled||c.muted?(this.an.info("zc.ctp.0 type:".concat(t," state:").concat(c.readyState," enabled:").concat(c.enabled," muted:").concat(c.muted)),!1):!s||((n=this.gn.playerList[s])===null||n===void 0?void 0:n.micStatus)===0:(this.an.error("zc.cvia.1 the stream has not track"),!1)},o.prototype.setDummyCaptureImagePath=function(e,t){return this.rtcModules.publishModule.setDummyCaptureImagePath(e,t)},o.prototype.setAccess=function(e){},o.prototype.setTestPackageSize=function(e){this.RTM.setTestPackageSize(!0)},o.prototype.setAudioOutputDevice=function(e,t){return rs(this,void 0,void 0,function(){var n,r=this;return is(this,function(i){return n=e==null?void 0:e.setSinkId,this.an.info("zc.saopd call:"+t),[2,new te.l3(function(s,c){return rs(r,void 0,void 0,function(){var u,l,a,h=this;return is(this,function(m){switch(m.label){case 0:if(u=function(S){h.an.info("zc.saopd error"+JSON.stringify(S)),c({errorCode:S.code,extendedData:S.message})},!n)return[3,5];if(e.setsinkid&&(e.setsinkid.enabled=!0),!t||!(0,R.QP)(t))return[2,u({code:Et.ann.code,message:"the 'deviceID' is invalid"})];m.label=1;case 1:return m.trys.push([1,3,,4]),[4,n.call(e,t)];case 2:return m.sent(),[3,4];case 3:return l=m.sent(),(a=e.srcObject)&&!a.getAudioTracks()[0]?[2,u(Et.akY)]:[2,u({code:Et.z0D.code,message:l})];case 4:return[2,s(!0)];case 5:throw Error("Browser not support set audio output.")}})})})]})})},o.prototype.enableCameraCapturing=function(e,t){return t===void 0&&(t=!0),rs(this,void 0,void 0,function(){return is(this,function(n){return[2,this.rtcModules.publishModule.enableCameraCapturing(e,t)]})})},o.prototype.enableDualStream=function(e){this.rtcModules.publishModule.enableDualStream(e)},o.prototype.setLowStreamParameter=function(e,t){this.rtcModules.publishModule.setLowStreamParameter(e,t)},o.prototype.enableVideoHardwareEncoder=function(e){if((0,R.dd)(e)){var t=this.pn.settingConfig;t.setUserValue("hardware_encode",e),t.setUserValue("camera_hard_encode",e),t.setUserValue("custom_hard_encode",e)}},o.prototype.createLocalViewer=function(e){var t=this.gn.checkPreview(e),n=t==null?void 0:t.getViewer();if(!n)throw Error("create viewer failed.");return new yh(n)},o.prototype.createRemoteViewer=function(e){var t=this.gn.checkPlayer(e),n=t==null?void 0:t.getViewer();if(!n)throw Error("create viewer failed.");return new yh(n)},o.prototype.createStreamCompositor=function(){throw(0,te.d1)(["stream compositor"])},o.prototype._enableAiDenoise=function(e,t,n){return n==da.PP.AIBalanced||n==da.PP.AI||n==da.PP.AIAggressive?this.setVoiceChangerPreset(e,{ANS:{enable:t,mode:n}}):this.enableAiDenoise(e,t)},o.prototype.enableAiDenoise=function(e,t){return(0,te.AA)(["ai denoise"])},o.prototype.setAiDenoiseMode=function(e,t){return(0,te.AA)(["voice changer with AIBalance"])},o.prototype.muteAllPlayAudioStreams=function(e){return this.rtcModules.playModule.muteAllPlayAudioStreams(e)},o.prototype.muteAllPlayVideoStreams=function(e){return this.rtcModules.playModule.muteAllPlayVideoStreams(e)},o.prototype.setVoiceChangerPreset=function(e,t){return(0,te.AA)(["voice changer","advanced"])},o.prototype.enableLiveAudioEffect=function(e,t,n){return(0,te.AA)(["voice changer","advanced"])},o.prototype.loadBackgroundBlurModule=function(){return(0,te.AA)(["blur background","advanced"],-1)},o.prototype.initBackgroundModule=function(e,t){return(0,te.AA)(["blur background","advanced"],-1)},o.prototype.setBackgroundBlurOptions=function(e,t){throw(0,te.d1)(["blur background","advanced"])},o.prototype.setVirtualBackgroundOptions=function(e,t){throw(0,te.d1)(["blur background","advanced"])},o.prototype.setTransparentBackgroundOptions=function(e){throw(0,te.d1)(["blur background","advanced"])},o.prototype.enableBackgroundProcess=function(e,t,n){return(0,te.AA)(["advanced"])},o.prototype.enableAutoSwitchDevice=function(e){this.rtcModules.publishModule.enableAutoSwitchDevice(e)},o.prototype.initTracer=function(e){this.pn.reporter=e;var t=new Qp(this.RTM.stateCenter,this.pn,this.gn);this.cr.setCommonStates(t),this.cr.setResource({sdk_version:E.qt,report_version:this.pn.sdkVerNum})},o.prototype.setEngineConfig=function(e){if(e&&this.an.info("zc.sec.0 "+JSON.stringify(e)),this.checkMaxChannels(e),this.checkRetryTime(e),this.pn.engineConfig=ns(ns({},this.pn.engineConfig),e),this.checkQualityInterval(),this.pn.actionListener("_engineConfigUpdate",this.pn.engineConfig),e.adaptCustomUA){var t=(0,Vn.$t)();this.pn.customUa=t.includes("iOS"),this.an.info("zc.sec.0 custom ua ".concat(t))}(0,R.w)(e.setUserInfo)&&this.oy(e.setUserInfo),(0,R.dd)(e.enableMiniSDP)&&this.stateCenter.setIsMiniSdp(e.enableMiniSDP),this.RTM.setEngineConfig(e)},o.prototype.oy=function(e){this.logger.info("zc.sui "+JSON.stringify(e));var t=e.token,n=e.userID;this.logger.setTokenInfo(t||"",n),n&&t&&this.pn.reporter.setReporterInfo(n,t)},o.prototype.checkQualityInterval=function(){var e=this.pn.engineConfig,t=e.publishQualityInterval,n=e.playQualityInterval;(0,R.Cs)(t)&&t!==0&&t<E.d7&&(this.pn.engineConfig.publishQualityInterval=E.d7),(0,R.Cs)(n)&&n!==0&&n<E.d7&&(this.pn.engineConfig.playQualityInterval=E.d7)},o.prototype.checkMaxChannels=function(e){var t=e.maxChannels;(0,R.Cs)(t)&&(t<E.FV&&(e.maxChannels=E.FV),t>E.di&&(e.maxChannels=E.di))},o.prototype.checkRetryTime=function(e){var t=e.roomRetryTime,n=e.streamRetryTime;(0,R.Cs)(t)&&(t<E.Lx&&(e.roomRetryTime=E.Lx),t>E.ZV&&(e.roomRetryTime=E.ZV)),(0,R.Cs)(n)&&(n<E.Lx&&(e.streamRetryTime=E.Lx),n>E.ZV&&(e.streamRetryTime=E.ZV),this.pn.streamRetryTime=e.streamRetryTime)},o.prototype.inject=function(e,t){var n=this;if(e!=="ZegoExpressPlayer")throw new Error("You are not authorized to use 'inject' method!");t({appid:this.pn.appid,logger:this.an,validateToken:function(r,i){return rs(n,void 0,void 0,function(){return is(this,function(s){switch(s.label){case 0:return this.pn.player265Validated?[2,!0]:[4,this.RTM.fetchAppConfigByTargetToken(r,i)];case 1:return s.sent()&&(this.pn.player265Validated=!0),[2,!!this.pn.player265Validated]}})})},isLogin:function(){return n.pn.rtm&&n.pn.rtm.stateCenter.roomModulesList.some(function(r){return r.isLogin()})},seiConfig:function(){return n.pn.seiConfig},addReceiver:function(r){n.pn.player265ReceiverList.push(r)},removeReceiver:function(r){n.pn.player265ReceiverList=n.pn.player265ReceiverList.filter(function(i){return i!=r})}})},o.prototype.setStreamAlignmentProperty=function(e,t){return rs(this,void 0,void 0,function(){var n,r,i,s;return is(this,function(c){switch(c.label){case 0:return n="zc.ssap",r=(0,R.QP)(e),this.an.info(n+" call. "+(r?e:e==null?void 0:e.id)+" alignment: ".concat(t)),i=null,(i=r?this.gn.publisherList[e]:this.gn.checkPublish(e))&&i.publisher.state===6?[4,i.publisher.setStreamAlignmentProperty(t)]:(this.an.error(n+" failed.  setStreamAlignmentProperty failed, stream not published."),[2,!1]);case 1:return s=c.sent(),this.an.info(n+" end. "+s),[2,s]}})})},o.prototype.setTurnServer=function(e){if(!(0,R.C9)(e))throw"'setTurnServer' failed. param error.";this.streamCenter.turnServers=$p([],e,!0)},o.prototype.destroyEngine=function(){if(this.pn.engineDestroy)throw new Error("ZegoExpressEngine has been destroyed.");this.destroyEngineHandler(),this.pn.engineDestroy=!0},o.prototype.uploadLog=function(e){return e===void 0&&(e=!1),this.RTM.uploadLog(e)},o.prototype.callExperimentalAPI=function(e){var t=this;return new Promise(function(n,r){var i=e.method,s=e.params;["onRecvRoomMuteVideoStream","onRecvRoomMuteAudioStream","onRecvRoomChannelMessage"].includes(i)?n({errorCode:0,extendedData:""}):i==="sendRoomChannelMessage"?t.RTM.sendRoomChannelMessage(s.roomID,0,s.msgType,s.msgContent,s.toUserIDList).then(function(){n({errorCode:0,extendedData:""})}).catch(function(c){r(c)}):i==="enableVolumeDucking"?t.hy(s.localStream,s.enable).then(function(){n({errorCode:0,extendedData:""})}).catch(function(c){r(c)}):n(i==="getAudioContext"?t.ac:void 0)})},o.prototype.setTracerLevel=function(e){this.RTM.reporter.tracerHandler.tracer.setLogLevel(e)},o.prototype.getReportSize=function(){var e;return(e=this.RTM.reporter.tracerHandler)===null||e===void 0?void 0:e.tracer.reportSize()},o.prototype.getFlutterVideoConfig=function(){var e=Uu(this.pn,this.an,{});return{encodeWidth:e.width,encodeHeight:e.height,fps:e.frameRate,bitrate:e.bitRate,keyFrameInterval:e.keyFrameInterval}},o.prototype.getFlutterAudioConfig=function(){var e=Uu(this.pn,this.an,{});return{bitrate:e.audioBitrate,channel:e.channelCount}},o.prototype.hy=function(e,t){return this.setVoiceChangerPreset(e,{volumeDucking:t})},o.screenShotReady=!1,o.isInstantiated=!1,o}();window.addEventListener("message",function(o){o.data.type==="SS_PING"&&(Fs.screenShotReady=!0)});var od,sd=function(){return sd=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},sd.apply(this,arguments)},ef=function(){function o(e,t){this.ly=e,this.vy=t}return o.prototype.start=function(e,t,n,r){this.ly.playEffect(sd({stream:this.vy,effectID:e},t||{}),n,r)},o.prototype.stop=function(e){return this.ly.stopEffect(this.vy,e)},o.prototype.pause=function(e){return this.ly.pauseEffect(this.vy,e)},o.prototype.resume=function(e){return this.ly.resumeEffect(this.vy,e)},o.prototype.setVolume=function(e,t,n){return this.ly.setEffectVolume(this.vy,t,e,n)},o.prototype.getTotalDuration=function(e){return this.ly.getEffectDuration(e)},o.prototype.getCurrentProgress=function(e){return this.ly.getEffectCurrentProgress(this.vy,e)},o.prototype.seekTo=function(e,t){return this.ly.seekAudioEffect(this.vy,e,t)},o}(),tf=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),qs=function(o){function e(t,n,r){var i=o.call(this,t,n,0,arguments[2])||this;return i.zegoWebRTC=new Fs(i.logger,i.dataReport,i.reporter,i.zegoWebRTM,0,r==null?void 0:r.scenario),i}return tf(e,o),e.prototype.setEngineConfig=function(t){this.zegoWebRTC.setEngineConfig(t)},e.setEngineOptions=function(t){O.setEngineOptions(t),Fs.setEngineOptions(t)},e.setGeoFence=function(t,n){Fs.setGeoFence(t,n),O.setGeoFence(t,n)},e.prototype.setRoomScenario=function(t){return this.zegoWebRTC.setRoomScenario(t)},e.prototype.setSEIConfig=function(t){this.zegoWebRTC.setSEIConfig(t)},e.use=function(t){O.use(t),Fs.use(t)},e.prototype.checkSystemRequirements=function(t,n){return n===void 0&&(n=0),this.zegoWebRTC.checkSystemRequirements(n,t)},e.prototype.off=function(t,n){return this.zegoWebRTM.stateCenter.listenerList[t]?this.zegoWebRTM.off(t,n):!!this.zegoWebRTC.stateCenter.listenerList[t]&&this.zegoWebRTC.off(t,n)},e.prototype.on=function(t,n){return this.zegoWebRTM.stateCenter.listenerList[t]?this.zegoWebRTM.on(t,n):!!this.zegoWebRTC.stateCenter.listenerList[t]&&this.zegoWebRTC.on(t,n)},e.prototype.createStream=function(t){return this.zegoWebRTC.createStream(t)},e.prototype.createZegoStream=function(t){return this.zegoWebRTC.createZegoStream(t)},e.prototype.getPublishingStreamQuality=function(t){return this.zegoWebRTC.getPublishingStreamQuality(t)},e.prototype.getElectronScreenSources=function(){return this.zegoWebRTC.getElectronScreenSources()},e.prototype.destroyStream=function(t){return this.zegoWebRTC.destroyStream(t)},e.prototype.startPublishingStream=function(t,n,r){return this.zegoWebRTC.startPublishingStream(t,n,r)},e.prototype.updatePublishingStream=function(t,n){return this.zegoWebRTC.updatePublishingStream(t,n)},e.prototype.stopPublishingStream=function(t){return this.zegoWebRTC.stopPublishingStream(t)},e.prototype.sendSEI=function(t,n){return this.zegoWebRTC.sendSEI(t,n)},e.prototype.setVideoConfig=function(t,n){return this.zegoWebRTC.setVideoConfig(t,n)},e.prototype.setAudioConfig=function(t,n){return this.zegoWebRTC.setAudioConfig(t,n)},e.prototype.replaceTrack=function(t,n){return this.zegoWebRTC.replaceTrack(t,n)},e.prototype.addTrack=function(t,n){return this.zegoWebRTC.addTrack(t,n)},e.prototype.removeTrack=function(t,n){return this.zegoWebRTC.removeTrack(t,n)},e.prototype.setCaptureVolume=function(t,n){return this.zegoWebRTC.setCaptureVolume(t,n)},e.prototype.setDummyCaptureImagePath=function(t,n){return this.zegoWebRTC.setDummyCaptureImagePath(t,n)},e.prototype.setStreamExtraInfo=function(t,n){return this.zegoWebRTC.setStreamExtraInfo(t,n)},e.prototype.enableVideoCaptureDevice=function(t,n){return this.zegoWebRTC.enableCameraCapturing(t,n)},e.prototype.addPublishCdnUrl=function(t,n){return arguments.length===3?this.zegoWebRTC.addPublishCdnUrl(arguments[0],arguments[2]):this.zegoWebRTC.addPublishCdnUrl(t,n)},e.prototype.removePublishCdnUrl=function(t,n){return arguments.length===3?this.zegoWebRTC.removePublishCdnUrl(arguments[0],arguments[2]):this.zegoWebRTC.removePublishCdnUrl(t,n)},e.prototype.mutePublishStreamVideo=function(t,n,r){return this.zegoWebRTC.mutePublishStreamVideo(t,n,r)},e.prototype.mutePublishStreamAudio=function(t,n){return this.zegoWebRTC.mutePublishStreamAudio(t,n)},e.prototype.setEffectsBeauty=function(t,n,r){return this.zegoWebRTC.setBeautyEffect(t,n,r)},e.prototype.setLowlightEnhancement=function(t,n){return this.zegoWebRTC.setLowlightEnhance(t,n)},e.prototype.enableDualStream=function(t){return this.zegoWebRTC.enableDualStream(t)},e.prototype.setLowStreamParameter=function(t,n){return this.zegoWebRTC.setLowStreamParameter(t,n)},e.prototype.enableHardwareEncoder=function(t){this.zegoWebRTC.enableVideoHardwareEncoder(t)},e.prototype.enableAutoSwitchDevice=function(t){return this.zegoWebRTC.enableAutoSwitchDevice(t)},e.prototype.initBackgroundModule=function(t,n){return this.zegoWebRTC.initBackgroundModule(t,n)},e.prototype.setBackgroundBlurOptions=function(t,n){return this.zegoWebRTC.setBackgroundBlurOptions(t,n)},e.prototype.setTransparentBackgroundOptions=function(t){return this.zegoWebRTC.setTransparentBackgroundOptions(t)},e.prototype.setVirtualBackgroundOptions=function(t,n){return this.zegoWebRTC.setVirtualBackgroundOptions(t,n)},e.prototype.enableBackgroundProcess=function(t,n,r){return this.zegoWebRTC.enableBackgroundProcess(t,n,r)},e.prototype.setVoiceChangerPreset=function(t,n){return this.zegoWebRTC.setVoiceChangerPreset(n,{voiceChanger:t})},e.prototype.setVoiceChangerParam=function(t,n){return this.zegoWebRTC.setVoiceChangerPreset(t,{voiceParam:n})},e.prototype.setReverbPreset=function(t,n){return this.zegoWebRTC.setVoiceChangerPreset(t,{reverb:n})},e.prototype.enableVirtualStereo=function(t,n,r){return this.zegoWebRTC.setVoiceChangerPreset(t,{stereo:{enable:n,angle:r}})},e.prototype.enableLiveAudioEffect=function(t,n,r){return this.zegoWebRTC.enableLiveAudioEffect(t,r,{liveEffect:n})},e.prototype.setAudioChangerParam=function(t,n,r){return this.zegoWebRTC.enableLiveAudioEffect(t,r,{pitch:n})},e.prototype.enableAiDenoise=function(t,n){return this.zegoWebRTC.enableAiDenoise(t,n)},e.prototype.setAiDenoiseMode=function(t,n){return this.zegoWebRTC.setAiDenoiseMode(t,n)},e.prototype.startPlayingStream=function(t,n){return this.zegoWebRTC.startPlayingStream(t,n)},e.prototype.setPlayStreamVideoType=function(t,n){return this.zegoWebRTC.setPlayStreamVideoType(t,n)},e.prototype.stopPlayingStream=function(t){return this.zegoWebRTC.stopPlayingStream(t)},e.prototype.mutePlayStreamVideo=function(t,n){return this.zegoWebRTC.mutePlayStreamVideo(t,n)},e.prototype.mutePlayStreamAudio=function(t,n){return this.zegoWebRTC.mutePlayStreamAudio(t,n)},e.prototype.setAudioFrameCallback=function(t,n,r){return this.zegoWebRTC.setAudioFrameCallback(t,n,r)},e.prototype.setCaptureAudioFrameCallback=function(t,n,r){return this.zegoWebRTC.setAudioFrameCallback(t,n,r)},e.prototype.getPlayingStreamQuality=function(t){return this.zegoWebRTC.getPlayingStreamQuality(t)},e.prototype.createLocalStreamView=function(t){return this.zegoWebRTC.createLocalViewer(t)},e.prototype.createRemoteStreamView=function(t){return this.zegoWebRTC.createRemoteViewer(t)},e.prototype.startMixerTask=function(t){return this.zegoWebRTC.startMixerTask(t)},e.prototype.stopMixerTask=function(t){return this.zegoWebRTC.stopMixerTask(t)},e.prototype.setMixerTaskConfig=function(t){return this.zegoWebRTC.setMixerTaskConfig(t)},e.prototype.startAutoMixerTask=function(t){return this.zegoWebRTC.startAutoMixerTask(t)},e.prototype.stopAutoMixerTask=function(t){return this.zegoWebRTC.stopAutoMixerTask(t)},e.prototype.startMixingAudio=function(t,n){return this.zegoWebRTC.startMixingAudio(t,n)},e.prototype.stopMixingAudio=function(t,n){return this.zegoWebRTC.stopMixingAudio(t,n)},e.prototype.setMixingAudioVolume=function(t,n,r){return this.zegoWebRTC.setMixingAudioVolume(t,n,r)},e.prototype.createAudioEffectPlayer=function(t){if(t instanceof MediaStream||t.getTracks)return new ef(this.zegoWebRTC,t);throw Error("Param localStream is not instance of MediaStream or ZegoLocalStream.")},e.prototype.loadAudioEffect=function(t,n){var r=this;return new Promise(function(i,s){r.zegoWebRTC.preloadEffect(t,n,function(c){c&&s(c),i(t)})})},e.prototype.unloadAudioEffect=function(t){return this.zegoWebRTC.unloadEffect(t)},e.prototype.enumDevices=function(){return this.zegoWebRTC.enumDevices()},e.prototype.getCameras=function(){return this.zegoWebRTC.getCameras()},e.prototype.getMicrophones=function(){return this.zegoWebRTC.getMicrophones()},e.prototype.getSpeakers=function(){return this.zegoWebRTC.getSpeakers()},e.prototype.useVideoDevice=function(t,n){return this.zegoWebRTC.useVideoDevice(t,n)},e.prototype.useAudioDevice=function(t,n){return this.zegoWebRTC.useAudioDevice(t,n)},e.prototype.useAudioOutputDevice=function(t,n){return this.zegoWebRTC.setAudioOutputDevice(t,n)},e.prototype.useFrontCamera=function(t,n){return this.zegoWebRTC.useFrontCamera(t,n)},e.prototype.setSoundLevelDelegate=function(t,n,r){return this.zegoWebRTC.setSoundLevelDelegate(t,n,r==null?void 0:r.enableInBackground)},e.prototype.isMicrophoneMuted=function(){return this.zegoWebRTC.isMicrophoneMuted()},e.prototype.muteMicrophone=function(t){return this.zegoWebRTC.muteMicrophone(t)},e.prototype.createRangeAudioInstance=function(){return this.zegoWebRTC.createRangeAudioInstance()},e.prototype.createRealTimeSequentialDataManager=function(t){return this.zegoWebRTC.createRealTimeSequentialDataManager(t)},e.prototype.destroyRealTimeSequentialDataManager=function(t){this.zegoWebRTC.destroyRealTimeSequentialDataManager(t)},e.prototype.createCopyrightedMusic=function(){return this.zegoWebRTC.createCopyrightedMusic()},e.prototype.checkVideoTrackIsActive=function(t){return this.zegoWebRTC.checkVideoTrackIsActive(t)},e.prototype.checkAudioTrackIsActive=function(t){return this.zegoWebRTC.checkAudioTrackIsActive(t)},e.prototype.destroyCopyrightedMusic=function(){return this.zegoWebRTC.destroyCopyrightedMusic()},e.prototype.getNetworkTimeInfo=function(){var t=this.zegoWebRTC.RTM;return t.setNetAgentHBMode("periodic"),t.getNetworkInfo()},e.prototype.setStreamAlignmentProperty=function(t,n){return this.zegoWebRTC.setStreamAlignmentProperty(t,n)},e.prototype.destroyEngine=function(){return this.zegoWebRTC.destroyEngine()},e.prototype.uploadLog=function(){return this.zegoWebRTC.uploadLog(!0)},e.prototype.createStreamCompositor=function(){return this.zegoWebRTC.createStreamCompositor()},e.prototype.setTurnServer=function(t){this.zegoWebRTC.setTurnServer(t)},e.prototype.muteAllPlayAudioStreams=function(t){return this.zegoWebRTC.muteAllPlayAudioStreams(t)},e.prototype.muteAllPlayVideoStreams=function(t){return this.zegoWebRTC.muteAllPlayVideoStreams(t)},e.prototype.callExperimentalAPI=function(t){return this.zegoWebRTC.callExperimentalAPI(t)},e.version="3.11.0",e}(O),oc="zm.scc",ba="zm.sbcm",sc="zm.srlm",Hc="zm.sbrm",bh="zm.schm",ac="zm.msg.sdr",Gc="zm.msg.rlr",ad="zm.msg.rps",Yu="zm.msg.srm",cd="zm.msg.scm",ud="zm.msg.schm",_h="zm.msg.sbm",jc="zm.msg.bps",ld="zm.sv.ps",zi={code:1100001,msg:"input param error."},Wc={code:1100002,msg:"network timeout."},Zu={code:1100003,msg:"socket close"},os={code:1000002,msg:"not login"},Qc={code:1009001,msg:"message content is empty"},Hs={code:1009002,msg:"content is too long"},Jc={code:1009005,msg:"inconsistent room id"},Xu={code:1009010,msg:"failed to send message"},dd={code:1009013,msg:"message is too long"},nf={code:1002017,msg:"room extra info key exceed the limit"},rf={code:1002098,msg:"room channel type error"},Gs={code:1002099,msg:"room inner error"},of={code:1102022,msg:"trans send frequently"},sf={code:1009015,msg:"frequency limited."},Kc=function(o){return o},cc=function(o){return o},hd=function(o){return o},af="/sdk/login",js={event:"/liveroom/send_big_room_message",room_sid_string:Kc,error:{INPUT_PARAM:zi,IM_MESSAGE_NULL:Qc,IM_CONTENT_TOO_LONG:Hs,IM_MESSAGE_TOO_LONG:dd,INCONSISTENT_ROOM_ID:Jc,ROOM_NOT_EXIST:os}},ko={event:"/liveroom/send_custom_command",room_sid_string:Kc,request_id:cc,error:{INPUT_PARAM:zi,IM_CONTENT_NULL:Qc,IM_CONTENT_TOO_LONG:Hs,INCONSISTENT_ROOM_ID:Jc,ROOM_NOT_EXIST:os}},ss={event:"/liveroom/send_room_message",room_id:cc,room_sid_string:cc,msg_content_size:hd,send_seq:hd,msg_id:hd,error:{INPUT_PARAM:zi,IM_MESSAGE_NULL:Qc,IM_MESSAGE_TOO_LONG:dd,ROOM_NOT_EXIST:os,INCONSISTENT_ROOM_ID:Jc}},Po={event:"/liveroom/set_room_extrainfo",room_id:cc,room_sid_string:Kc,key:cc,value:cc,error:{INPUT_PARAM:zi,TRANS_FREQUENTLY:of,ROOM_ROOMID_INCORRECT:pe.ROOM_ROOMID_INCORRECT,KEY_EMPTY:{code:1002014,msg:"room extra info key empty"},KEY_TOO_LONG:{code:1002015,msg:"room extra info key too long"},VALUE_TOOL_LONG:{code:1002016,msg:"room extra info value too long"}}},cf="/liveroom/get_room_extrainfo",uf=Kc,lf=Kc,df=1000001109,hf=1000001110,$u=10240;(function(o){o[o.I=0]="I",o[o.H=10]="H",o[o.M=100]="M",o[o.L=1e3]="L"})(od||(od={}));var uc=function(){return uc=Object.assign||function(o){for(var e,t=1,n=arguments.length;t<n;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o},uc.apply(this,arguments)},pf=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},ff=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},mf=function(){function o(e,t,n,r,i,s){var c=this;this.an=e,this.pn=t,this._dataReport=n,this.Jr=r,this._rtm=i,this.Ar=s,this.my=0,this.py=500,this.gy={},this.by=0,this._y=[],this.yy=null,this.wy=null,this.Gr=0,this.Sy=0,this.Ey=!1,this.ky={},this.Oy={},this.Iy={},this.roomExtraInfo={},this.Ry=function(u,l){l===void 0&&(l=!1);var a=u.map(function(h){var m={key:h.trans_type,value:h.trans_data?h.trans_data:"",updateUser:{userID:h.id_name||h.trans_idname,userName:h.nick_name||h.trans_nickname},updateTime:di.A.isLong(h.trans_send_time)?h.trans_send_time.toNumber():h.trans_send_time};return c.roomExtraInfo[h.trans_type]=m,m});l?c.an.warn(ad+" id name same"):(a.length>0&&c.pn.actionListener("roomExtraInfoUpdate",c.Ar.roomID,Object.values(c.roomExtraInfo)),u.forEach(function(h){c.pn.actionListener("recvReliableMessage",h.trans_type,h.trans_seq,h.trans_data)}))}}return Object.defineProperty(o.prototype,"cr",{get:function(){return this.pn.reporter},enumerable:!1,configurable:!0}),o.prototype.loginRsp=function(e){var t,n,r=this,i=e.body,s=i.ret_timestamp,c=i.bigim_time_window,u=i.trans_seqs;if(s!=null&&(0,R.QP)(s)){var l=parseFloat(s);this.Gr=l==0?0:+s-new Date().getTime()}if(c&&(0,R.kb)(c)&&(this.Sy=c),u)for(var a=0;a<u.length;a++){var h=u[a].trans_channel,m=u[a].trans_seq_list||u[a].trans_seq_array;(m=(m=m.filter(function(S){var x=S.trans_type;return!r.Oy[x]||r.Oy[x].seq<S.trans_seq})).map(function(S){return{trans_type:S.trans_type,trans_local_seq:S.trans_seq}})).length>0&&this.Ty(h,m)}!((t=e.body)===null||t===void 0)&&t.user_trans_channel_list&&this.userTransMessageHandler((n=e.body)===null||n===void 0?void 0:n.user_trans_channel_list)},o.prototype.fetchUserTransMessage=function(e,t){var n=this;this.an.info("zb.mh.futm.0 call");var r=function(i){n.Cy(i)};this.Jr.fetchUserTransInfo({trans_channel:e,fetch_array:t},r,r,this.Ar),this.an.info("zb.mh.futm.0 call success")},o.prototype.userTransMessageHandler=function(e){var t=this;if(e)for(var n=function(s){var c=e[s].trans_channel,u=e[s].trans_seq_list;u=u.filter(function(l){var a=l.trans_type,h=l.trans_seq;return t.Iy[c]||(t.Iy[c]={}),!t.Iy[c][a]||t.Iy[c][a].seq<h}),u.length>0&&r.fetchUserTransMessage(c,u)},r=this,i=0;i<e.length;i++)n(i)},o.prototype.Cy=function(e){if(e.body&&e.body.err_code!=0)this.an.error("zb.mh.hfutr user trans send error "+e.body.err_code);else if(e.header&&e.body){var t=e.body.user_trans_list,n=e.body.trans_channel,r=[];if(Array.isArray(t)&&t.length>0){for(var i=0;i<t.length;i++){var s=t[i],c=s.trans_type,u=s.trans_seq;this.Iy[n]||(this.Iy[n]={}),!this.Iy[n][c]||this.Iy[n][c].seq<u?(this.Iy[n][c]={seq:u},r.push(s)):this.an.warn("zb.mh.hfutr fetch trans seq wrong"),this.an.info("zb.mh.hfutr trans "+c+" seq "+u)}r.length>0&&this.pn.actionListener("_userTransUpdate",this.Ar.roomID,n,r),this.an.info("zb.mh.hfutr call success")}}else this.an.error("zb.mh.hfutr user trans send error "+JSON.stringify(e))},o.prototype.sendReliableMessage=function(e,t,n,r){var i=this;if(this.an.info(ac+" call"),!this.Ar.isLogin())return this.an.error(ac+" state error"),void(r&&r(os));if(this.Ey)return this.an.error(ac+" send too often"),void r(Po.error.TRANS_FREQUENTLY);this.Oy[e]||(this.Oy[e]={seq:0});var s={trans_type:e,trans_data:t,trans_local_seq:this.Oy[e].seq,trans_channel:"clt"};this.Ey=!0,this.Jr.sendReliableMessage(s,function(c){i.Oy[e].seq=c.body.trans_seq,i.an.info(ac+" trans "+e+" seq "+c.body.trans_seq),i.Ey=!1,i.roomExtraInfo[e]={key:e,value:t,updateUser:{userID:i.Ar.userID,userName:i.Ar.userName},updateTime:Date.now()},n({seq:c.header.seq,errorCode:0})},function(c){var u=Gs;i.an.error(ac+" fail "+JSON.stringify(c)),c.body&&c.body.err_code?(u=i._rtm.getServerError(c.body.err_code,c.body.err_message),i.an.error(ac+"  "+u.msg)):u=c,i.Ey=!1,r(u)},this.Ar)},o.prototype.Ty=function(e,t){var n=this,r={trans_channel:e,fetch_array:t},i=this.cr.createSpan(od.H,{key:af,par:this.Ar.roomID},{key:""},cf);i.setAttributes({fetch_array:uf(t)});var s=function(c){n.Ay(c,i)};this.Jr.fetchReliableMessage(r,s,s,this.Ar),this.an.info("zm.msg.frm call success")},o.prototype.Ay=function(e,t){if(e.body&&e.body.err_code!=0)return this.an.error(Gc+" trans send error "+e.body.err_code),void this.pn.reporter.setError(t,{code:e.body.err_code});if(!e.header||!e.body)return this.an.error(Gc+" trans send error "+e),void this.pn.reporter.setError(t,Wc);var n=e.body.trans_list||e.body.trans_fetch_results,r=[],i=[];if(Array.isArray(n)&&n.length>0){for(var s=0;s<n.length;s++){var c=n[s];if(c.err_code!==df){var u=c.trans_type,l=c.trans_seq;i.push({trans_type:u,trans_seq:l}),c.err_code!==hf?!this.Oy[u]||this.Oy[u].seq<l?(this.Oy[u]={seq:l},r.push(c)):this.an.warn(Gc+" fetch trans seq wrong"):(this.an.warn(Gc+" fetch trans seq is wrong "+c.err_code),this.Oy[u]={seq:l})}else this.an.warn(Gc+" fetch trans unknown type "+c.err_code)}this.roomExtraInfo={},r.length>0&&this.Ry(r)}t.setAttributes({result_array:lf(i)}),t.end()},o.prototype.handlePushTransMsg=function(e){var t,n,r=e.body.trans_type,i=e.body.trans_seq;!this.Oy[r]||this.Oy[r].seq<i?(this.Oy[r]={seq:i},this.Ry([e.body],((t=e==null?void 0:e.body)===null||t===void 0?void 0:t.trans_idname)===this.pn.idName||((n=e==null?void 0:e.body)===null||n===void 0?void 0:n.id_name)===this.pn.idName)):this.an.warn(ad+" trans seq wrong"),this.an.info(ad+" trans "+r+" seq "+i)},o.prototype.handlePushUserTransMsg=function(e){this.an.info("zb.mh.hputr.0 call");var t=e.body.trans_seq_list,n=e.body.trans_channel,r=[];if(n&&Array.isArray(t)&&t.length>0){for(var i=0;i<t.length;i++){var s=t[i].trans_type,c=t[i].trans_seq;this.Iy[n]||(this.Iy[n]={}),(!this.Iy[n][s]||this.Iy[n][s].seq<c)&&(this.Iy[n][s]={seq:c},r.push(t[i]))}r.length>0?this.pn.actionListener("_userTransUpdate",this.Ar.roomID,n,r):this.an.warn("zb.mh.hputr.0 no fetch user trans")}else this.an.warn("zb.mh.hputr.0 no push user trans")},o.prototype.sendRoomMsg=function(e,t,n,r,i,s){var c,u=this;if(!this.Ar.isLogin())return this.an.error(Yu+" state error"),s(os),!1;var l=Date.parse(new Date+"");if(this.my>0&&this.my+this.py>l)return this.an.info(Yu+" freq error"),s&&s(sf,0,e,r),!1;this.my=l;var a=this.Jr.sendRoomMsg({msg_category:e,msg_type:1,msg_priority:1,msg_content:r},function(h){i({seq:h.header.seq,errorCode:0,messageID:h.body.msg_id})},function(h){var m,S,x,q=Gs;if(!h.header||!h.body)return h.code&&h.msg&&(q=h),void s({seq:0,errorCode:q.code,messageID:0});x=(m=[u._rtm.getServerError(h.body.err_code,(S=h.body)===null||S===void 0?void 0:S.err_message),h.body.msg_id])[1],u.an.error(Yu+" "+(q=m[0]).msg),q==Wc&&(q=Xu),s({seq:h.header.seq,errorCode:q.code,messageID:x,message:q.msg})},this.Ar);return this.cr.spanSetAttributes({key:ss.event,par:(c=this.Ar)===null||c===void 0?void 0:c.roomID},{send_seq:ss.send_seq(a)}),this.an.info(Yu+"  call success"),!0},o.prototype.handlePushRoomMsg=function(e){var t=[],n=e.body.msg_list;e.body.msg_list.forEach(function(r){var i={fromUser:{userID:r.id_name,userName:r.nick_name},message:r.msg_content,sendTime:r.send_time.toNumber(),messageID:r.msg_id.toNumber()};t.push(i)}),e.body.server_msg_id=e.body.server_msg_id.toNumber(),e.body.ret_msg_id=e.body.ret_msg_id.toNumber(),this.pn.actionListener("IMRecvBroadcastMessage",this.Ar.roomID,t),this.pn.actionListener("_recvRoomMsg",n,e.body.server_msg_id,e.body.ret_msg_id)},o.prototype.sendCustomCommand=function(e,t,n,r){var i,s=this;if(!this.Ar.isLogin())return this.an.error(cd+" state error"),r(os),!1;var c={from_userid:this.pn.idName,from_username:this.pn.nickName,request_id:this.pn.getRequestId(),custom_content:t||"",room_id:this.Ar.roomID};this.cr.spanSetAttributes({key:ko.event,par:(i=this.Ar)===null||i===void 0?void 0:i.roomID},{request_id:ko.request_id(c.request_id)});var u={dest_id_name:e,custom_msg:JSON.stringify(c)};return this.Jr.sendCustomCommand(u,function(l){n({seq:l.header.seq,errorCode:0})},function(l){var a,h,m,S,x,q=Gs;q=l.body&&l.body.err_code?s._rtm.getServerError(l.body.err_code,(a=l.body)===null||a===void 0?void 0:a.err_message):l,s.an.error(cd+" "+q.msg),x=((h=l.body)===null||h===void 0?void 0:h.err_code)===2||((m=l.body)===null||m===void 0?void 0:m.err_code)===1000000002?zi:q==Wc?Xu:q,r({seq:((S=l.header)===null||S===void 0?void 0:S.seq)||-1,errorCode:x.code,code:x.code,message:x.msg})},this.Ar),this.an.info(cd+" call success"),!0},o.prototype.handlePushChannelMsg=function(e){var t=e.body;t.channel_type===0&&this.pn.actionListener("_experimentalAPICallback",{method:"onRecvRoomChannelMessage",content:{roomID:this.Ar.roomID,sendIDName:t.sender_idname,sendNickName:t.sender_nickname,msgType:t.msg_type,msgContent:t.msg_content}})},o.prototype.handlePushTransparentMsg=function(e){var t=e.body,n=t.sender_idname,r=t.sender_nickname,i=t.client_seq,s=t.msg_data,c=this.ky[n],u=!1;c&&i?di.A.isLong(i)&&di.A.isLong(c)&&i.gt(c)&&(u=!0):u=!0,this.ky[n]=i,u&&this.pn.actionListener("recvRoomTransparentMessage",this.Ar.roomID,{sendUser:{userID:n,userName:r},content:s})},o.prototype.handlePushCustomMsg=function(e){var t=JSON.parse(e.body.custommsg),n=[t.from_userid,t.from_username,t.room_id,t.custom_content];this.pn.actionListener("IMRecvCustomCommand",n[2],{userID:n[0],userName:n[1]},n[3])},o.prototype.sendRoomChannelMessage=function(e,t,n,r,i,s){var c=this;return this.Ar.isLogin()?(this.Jr.sendRoomChannelMessage({channelType:e,msgType:t,msgContent:n,toUserIDList:r},this.Ar.roomID,function(u){i({seq:u.header.seq,errorCode:0})},function(u){var l={code:0,msg:""};u.body?(l.code=u.body.err_code||0,l.msg=u.body.err_message||""):l=u,c.an.error(ud+" err:"+JSON.stringify(l)),[2].includes(l.code)?l.code=zi.code:[3].includes(l.code)?l.code=Hs.code:l=l.code==Wc.code?uc({},Xu):l.code==Zu.code?uc({},Zu):{code:Gs.code,msg:"liveroom error ".concat(l.code," ").concat(l.msg)},s(l)}),this.an.info(ud+" call success"),!0):(this.an.error(ud+" state error"),s(os),!1)},o.prototype.sendTransparentMessage=function(e,t,n,r,i,s,c){var u,l,a=this,h="zm.msg.stpm";if(!this.Ar.isLogin())return this.an.error(h+" state error"),void c(os);t===0?l=0:l=((u=this.pn.rtm)===null||u===void 0?void 0:u.getNetworkInfo().timestamp)||Date.now();var m={msg_type:e,msg_data:n,to_user_list:r.map(function(S){return ar(S.userID)}),client_seq:di.A.fromInt(l)};this.Jr.sendTransparentMessage(m,this.Ar.roomID,i||10,function(S){s({seq:S.header.seq,errorCode:0})},function(S){var x=a.zy(S,h);c(x)}),this.an.info(h+" call success")},o.prototype.sendBigRoomMessage=function(e,t,n,r,i,s){var c=this;if(!this.Ar.isLogin())return this.an.error(_h+" state error"),void(s&&s(os));var u=this.Sy,l=this.Gr,a=new Date().getTime()+l,h=this._rtm.getSeq().toString();if(this.gy[h]={success:i,error:s},u==0)this.sendBigRoomMessageInternal([{msg_category:e,msg_type:1,msg_content:r,bigmsg_client_id:h}],function(S){c.handleBigImMsgRsp(S)},function(S){s&&s(S)});else{var m=Math.floor(a/u);this.by<m&&this._y.length==0?(this.by=m,this.sendBigRoomMessageInternal([{msg_category:e,msg_type:1,msg_content:r,bigmsg_client_id:h}],function(S){c.handleBigImMsgRsp(S)},function(S){s&&s(S)})):(this._y.push({msg_category:e,msg_type:1,msg_content:r,bigmsg_client_id:h}),this._y.length==1&&this.setBigImTimer(l,u))}},o.prototype.sendBigRoomMessageInternal=function(e,t,n){this.Jr.sendBigRoomMessage({msgs:e},function(r){t(r)},function(r){var i,s,c;r.header&&r.body?c=r.body?{code:(i=r.body)===null||i===void 0?void 0:i.err_code,msg:(s=r.body)===null||s===void 0?void 0:s.err_message}:Gs:(r.code&&r.msg&&(c=r),n(c)),n(c)},this.Ar),this.an.info(_h+" sendBigRoomMessage called")},o.prototype.handleBigImMsgRsp=function(e){this.Sy=e.body.bigim_time_window;for(var t=e.body.msg_list||e.body.msgs,n=0;n<t.length;n++){var r=t[n].msg_client_id||t[n].bigmsg_client_id;if(this.gy[r]){var i=this.gy[r].success;i!=null&&i({seq:e.header.seq,errorCode:0,messageID:t[n].msg_id||t[n].bigmsg_id}),delete this.gy[r]}}},o.prototype.setBigImTimer=function(e,t){var n=this,r=new Date().getTime()+e,i=t-r%t,s=function(c){n.yy=setTimeout(function(){n.onBigImTimer()},c)};(function(c){return pf(this,void 0,void 0,function(){var u;return ff(this,function(l){switch(l.label){case 0:return[4,(0,te.UY)()];case 1:return u=l.sent(),[2,parseInt(u*(c+1)+"",10)]}})})})(t).then(function(c){s(c+i)}).catch(function(c){s(.5*t+i)})},o.prototype.onBigImTimer=function(){var e=this,t=new Date().getTime()+this.Gr;this.by=Math.floor(t/this.Sy);for(var n=[],r=[],i=0;i<this._y.length&&!(i>=20);i++){var s=this._y[i];n.push({msg_category:s.msg_category,msg_type:s.msg_type,msg_content:s.msg_content,bigmsg_client_id:s.bigmsg_client_id}),r.push(s.bigmsg_client_id)}this._y.length>20?this._y.splice(0,20):this._y=[],this.sendBigRoomMessageInternal(n,function(c){e.handleBigImMsgRsp(c)},function(c,u){for(var l=0;l<r.length;l++){var a=r[l],h=e.gy[a];h&&(h.error!=null&&h.error(c,u),delete e.gy[a])}}),this.yy&&clearTimeout(this.yy),this.yy=null,this._y.length>0&&this.setBigImTimer(this.Gr,this.Sy)},o.prototype.handlePushMergeMsg=function(e){for(var t=e.body.message_list||e.body.messages,n=0;n<t.length;n++)t[n].sub_cmd===14001&&this.handlePushBigRooMsg(t[n].msg_body)},o.prototype.handlePushBigRooMsg=function(e){var t;if((0,R.QP)(e))try{t=JSON.parse(e)}catch{return void this.an.warn(jc+"parse json error")}else t=e;if(t){for(var n=t.room_id||this.Ar.roomID,r=[],i=t.msg_list||t.msg_data,s=0;s<i.length;s++){var c=i[s];c.id_name!=this.pn.idName?r.push({idName:c.id_name,nickName:c.nick_name,messageId:c.msg_id||c.bigmsg_id,category:c.msg_category,type:c.msg_type,content:c.msg_content,time:c.send_time||di.A.isLong(c.msg_timestamp)&&c.msg_timestamp.toNumber()}):this.an.info(jc+" self message")}r.length==0?this.an.info(jc+" no other pushData except self"):this.onRecvBigRoomMessage(r,n),this.an.info(jc+"call success")}else this.an.warn(jc+" cann't find message body")},o.prototype.onRecvBigRoomMessage=function(e,t){var n=[];e.forEach(function(r){n.push({fromUser:{userID:r.idName,userName:r.nickName},message:r.content,sendTime:r.time,messageID:r.messageId})}),this.pn.actionListener("IMRecvBarrageMessage",t,n),this.pn.actionListener("_recvBigRoomMessage",e,t)},o.prototype.resetMessageInfo=function(){this.Oy={},this.wy&&(clearTimeout(this.wy),this.wy=null),this.by=0,this._y=[],this.gy={},this.yy&&(clearTimeout(this.yy),this.yy=null),this.Gr=0,this.Sy=0},o.prototype.zy=function(e,t){var n=Gs;return n=e.body&&e.body.err_code?fe(e.body.err_code,e.body.err_message):e,this.an.error(t+" err:"+(0,te.iq)(n)),[2].includes(n.code)?n.code=zi.code:[3].includes(n.code)?n.code=Hs.code:n=n.code==Wc.code?uc({},Xu):n.code==Zu.code?uc({},Zu):{code:Gs.code,msg:"liveroom error ".concat(n.code," ").concat(n.msg)},n},o.prototype.deleteTransparentUser=function(e){delete this.ky[e]},o}();function el(o,e,t,n){return{interResolve:function(r){e(r),o.end()},interReject:function(r,i){i===void 0&&(i="");var s=r.errorCode||r.code,c=r.message||r.msg||""+i,u=s;if(s<1e6){o.setAttributes({server_code:s});var l=void 0;n&&n[s]?s=(l=n[s]).code:(l=Ze(s,r.msg||""),s=Gs.code),u=l.code}o.setAttributes({error:u,message:c}),o.end(),t({errorCode:s})}}}function Sh(o,e,t,n){var r=this;return t===void 0&&(t=1),n===void 0&&(n=1),new Promise(function(i,s){var c=r.getMsgSpan(ss.event,o,!0),u=el(c,function(m){c.setAttributes({msg_id:ss.msg_id(m.messageID)}),i(m)},s,{3:dd}),l=u.interResolve,a=u.interReject;if(!(0,R.QP)(o))return r.logger.error(ba+" roomid must be string"),void a(ss.error.INPUT_PARAM," param roomID error");if(!(0,R.QP)(e))return r.logger.error(ba+" message must be string"),void a(ss.error.INPUT_PARAM," param message error");if(e.length===0)return r.logger.error(ba+" message is empty"),void a(ss.error.IM_MESSAGE_NULL);if(Pa(e)>$u)return r.logger.error(ba+" message is too long"),void a(ss.error.IM_MESSAGE_TOO_LONG);var h=r.getRoomModules(o);if(c.setAttributes({msg_content:e}),!h)return r.logger.error(ba+" room not exist, roomID: "+o),void a(r.isDisConnect()?ss.error.ROOM_NOT_EXIST:ss.error.INCONSISTENT_ROOM_ID);h.messageHandler.sendRoomMsg(t,n,o,e,function(m){m.messageID&&c.setAttributes({msg_id:m.messageID}),l(m)},a)})}function Th(o,e,t){var n=this;return new Promise(function(r,i){var s=n.getMsgSpan(ko.event,o,!0),c=el(s,r,i,{3:Hs}),u=c.interResolve,l=c.interReject;if(!(0,R.QP)(o))return n.logger.error(oc+" roomID must be string"),void l(ko.error.INCONSISTENT_ROOM_ID," roomID must be string");if(!(0,R.C9)(t)||t.find(function(m){return!(0,R.QP)(m)}))return n.logger.error(oc+" toUserIDList must be string array"),void l(ko.error.INPUT_PARAM," param toUserList error");if(!(0,R.QP)(e)&&!(0,R.w)(e))return n.logger.error(oc+" command must be a string or object"),void l(ko.error.IM_CONTENT_NULL," command type error");var a=n.getRoomModules(o),h=(0,R.QP)(e)?e:JSON.stringify(e);return Pa(h)>$u?(n.logger.error(oc+" command too long"),void l(ko.error.IM_CONTENT_TOO_LONG)):h.length===0?(n.logger.error(oc+" command empty"),void l(ko.error.IM_CONTENT_NULL)):(s.setAttributes({msg_content:h}),a?void a.messageHandler.sendCustomCommand(t,e,u,l):(n.logger.error(oc+" room not exist, roomID: "+o),void l(n.isDisConnect()?ko.error.ROOM_NOT_EXIST:ko.error.INCONSISTENT_ROOM_ID)))})}function Eh(o,e,t,n){var r=this;return t===void 0&&(t=1),n===void 0&&(n=1),new Promise(function(i,s){var c=r.getMsgSpan(js.event,o),u=el(c,i,s,{3:Hs}),l=u.interResolve,a=u.interReject;if(!(0,R.QP)(o))return r.logger.error(Hc+" roomid must be string"),void a(js.error.ROOM_NOT_EXIST," param roomID error");if(!(0,R.QP)(e))return r.logger.error(Hc+" message must be string"),void a(js.error.IM_MESSAGE_NULL);if(e.length===0)r.logger.error(Hc+" message is empty"),a(js.error.IM_MESSAGE_NULL);else if(Pa(e)>$u)return r.logger.error(Hc+" message is too long"),void a(r.stateCenter.isFlutter?js.error.IM_CONTENT_TOO_LONG:js.error.IM_MESSAGE_TOO_LONG);c.setAttributes({msg_content:e});var h=r.getRoomModules(o);if(!h)return r.logger.error(Hc+" room not exist, roomID: "+o),void a(r.isDisConnect()?js.error.ROOM_NOT_EXIST:js.error.INCONSISTENT_ROOM_ID);h.messageHandler.sendBigRoomMessage(t,n,o,e,l,a)})}function Ch(o,e,t){var n=this;return new Promise(function(r,i){var s=n.getMsgSpan(Po.event,o),c=el(s,r,i,{1015:nf}),u=c.interResolve,l=c.interReject;if(!(0,R.QP)(o))return n.logger.error(ba+" roomid must be string"),void l(Po.error.ROOM_ROOMID_INCORRECT," roomID must be string");if(o.length===0)return n.logger.error(ba+" roomid is empty"),void l(Po.error.ROOM_ROOMID_INCORRECT," roomid is empty");if(!(0,R.QP)(e))return n.logger.error(sc+" key must be string"),void l(Po.error.KEY_EMPTY," key must be string");if(e.length===0)return n.logger.error(sc+" key is empty"),void l(Po.error.KEY_EMPTY);if(e.length>128)return n.logger.error(sc+" key is too long"),void l(Po.error.KEY_TOO_LONG);if(!(0,R.QP)(t))return n.logger.error(sc+" value must be string"),void l(Po.error.INPUT_PARAM," value must be string");if(t.length>4096)return n.logger.error(sc+" value is too long"),void l(Po.error.VALUE_TOOL_LONG);s.setAttributes({key:Po.key(e),value:Po.value(t)});var a=n.getRoomModules(o);if(!a)return n.logger.error(sc+" room not exist, roomID: "+o),void l(Po.error.ROOM_ROOMID_INCORRECT);a.messageHandler.sendReliableMessage(e,t,u,l)})}var wh={_sendBroadcastMessage:Sh,sendBroadcastMessage:function(o,e){var t=this;return new Promise(function(n,r){Sh.call(t,o,e).then(function(i){n({errorCode:i.errorCode,messageID:i.messageID,extendedData:i.extendedData})}).catch(function(i){r(i)})})},_sendCustomCommand:Th,sendCustomCommand:function(o,e,t){var n=this;return new Promise(function(r,i){Th.call(n,o,e,t).then(function(s){r({errorCode:s.errorCode,extendedData:s.extendedData})}).catch(function(s){i(s)})})},_sendBarrageMessage:Eh,sendBarrageMessage:function(o,e){var t=this;return new Promise(function(n,r){Eh.call(t,o,e).then(function(i){n({errorCode:i.errorCode,messageID:i.messageID,extendedData:i.extendedData})}).catch(function(i){r(i)})})},_setRoomExtraInfo:Ch,setRoomExtraInfo:function(o,e,t){return Ch.call(this,o,e,t)},sendRoomChannelMessage:function(o,e,t,n,r){var i=this;return new Promise(function(s,c){var u=function(a,h){h===void 0&&(h=""),h&&i.logger.error(bh+h),c({errorCode:a.code,extendedData:a.msg+h})};if(e===0)if((0,R.QP)(o))if((0,te.zQ)(t))if((0,R.C9)(r)&&!r.find(function(a){return!(0,R.QP)(a)}))if((0,R.QP)(n))if(Pa(n)>$u)u(Hs," msgContent too long");else if(n.length!==0){var l=i.getRoomModules(o);if(!l)return i.logger.error(bh+" room not exist, roomID: "+o),void u(i.isDisConnect()?ko.error.ROOM_NOT_EXIST:ko.error.INCONSISTENT_ROOM_ID);l.messageHandler.sendRoomChannelMessage(e,t,n,r,function(){s({errorCode:0,extendedData:""})},u)}else u(zi," msgContent empty");else u(zi," msgContent must be a string");else u(zi," toUserIDList must be string array");else u(zi," msgType must be integer number");else u(zi," roomID must be string");else u(rf)})},sendTransparentMessage:function(o,e){var t=this;return new Promise(function(n,r){var i="zm.stpm",s=function(S,x){x===void 0&&(x=""),x&&t.logger.error(i+" "+x),r({errorCode:S.code,extendedData:S.msg+x})};if(!(0,R.QP)(o)||o.length>127||!(0,te.jy)(o))s(Jc);else if((0,R.w)(e)){var c=e.sendMode,u=e.sendType,l=e.content,a=e.recvUserList,h=e.timeOut;if([0,1,2].includes(c))if([0,1].includes(u))if(l)if((0,R.G0)(l))if(l.byteLength)if(l.byteLength>4096)s(Hs);else if((0,R.C9)(a)&&!a.find(function(S){return!(0,R.QP)(S.userID)}))if((0,R.TE)(h)||(0,te.zQ)(h)){var m=t.getRoomModules(o);if(!m)return t.logger.error(i+" room not exist, roomID: "+o),void s(t.isDisConnect()?os:Jc);m.messageHandler.sendTransparentMessage(c,u,l,a,h,function(){n({errorCode:0,extendedData:""})},s)}else s(zi,"message content type error");else s(zi,"recvUserList must be ZegoUser Array");else s(Qc);else s(zi,"message content type error");else s(Qc);else s(zi,"message sendType error");else s(zi,"message sendMode error")}else s(zi,"message must be object")})}},Ih={handlePushRoomMsg:function(o){var e=this.handlePushMsg(o);e[0].messageHandler.handlePushRoomMsg(e[1])},handlePushCustomMsg:function(o){var e=this.handlePushMsg(o);e[0].messageHandler.handlePushCustomMsg(e[1])},handlePushMergeMsg:function(o){var e,t=(e=o==null?void 0:o.header)===null||e===void 0?void 0:e.room_id,n=this.rtm.getRoomModules(t);n?n.messageHandler.handlePushMergeMsg(o):this.logger.error(ld+" room no found ignore "+JSON.stringify(o))},handlePushTransMsg:function(o){var e=this.handlePushMsg(o);e[0].messageHandler.handlePushTransMsg(e[1])},handlePushUserTransMsg:function(o){var e=this.handlePushMsg(o);e[0].messageHandler.handlePushUserTransMsg(e[1])},handleBigImMsgRsp:function(o){var e,t=(e=o==null?void 0:o.header)===null||e===void 0?void 0:e.room_id,n=this.rtm.getRoomModules(t);n?n.messageHandler.handleBigImMsgRsp(o):this.logger.error(ld+" room no found ignore "+JSON.stringify(o))},handlePushMsg:function(o){var e,t=(e=o==null?void 0:o.header)===null||e===void 0?void 0:e.room_id,n=this.rtm.getRoomModules(t);if(n)return[n,o];this.logger.error(ld+" room no found ignore "+JSON.stringify(o))},handlePushChannelMsg:function(o){var e=this.handlePushMsg(o);e[0].messageHandler.handlePushChannelMsg(e[1])},handlePushTransparentMsg:function(o){var e=this.handlePushMsg(o);e[0].messageHandler.handlePushTransparentMsg(e[1])}},Rh={initMessageHandler:function(){this.messageHandler=new mf(this.logger,this.stateCenter,this.dataReport,this.liveRoomHandler,this.rtm,this)}},vf={type:"Message",install:function(o,e,t){for(var n in wh)Object.defineProperty(o.prototype,n,{value:wh[n],writable:!1});for(var n in Ih)Object.defineProperty(t.prototype,n,{value:Ih[n],writable:!1});for(var n in Rh)Object.defineProperty(e.prototype,n,{value:Rh[n],writable:!1})}},gf=pt(5830),yf=pt(3509),bf=pt(9674),_f=pt(743),kh=function(o,e,t,n){return new(t||(t=Promise))(function(r,i){function s(l){try{u(n.next(l))}catch(a){i(a)}}function c(l){try{u(n.throw(l))}catch(a){i(a)}}function u(l){var a;l.done?r(l.value):(a=l.value,a instanceof t?a:new t(function(h){h(a)})).then(s,c)}u((n=n.apply(o,e||[])).next())})},Ph=function(o,e){var t,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function c(u){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!((r=r.length>0&&r[r.length-1])||a[0]!==6&&a[0]!==2)){s=0;continue}if(a[0]===3&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(a[0]===6&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(o,s)}catch(h){a=[6,h],n=0}finally{t=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([u,l])}}},Sf=function(){function o(e,t){this.zegoWebRTC=e,this.roomID=t,this.pubDataChannelList=[],this.subDataChannelList=[],this.listenerList={receiveRealTimeSequentialData:[]},this.an=e.logger}return o.prototype.startBroadcasting=function(e,t){return kh(this,void 0,void 0,function(){var n,r,i,s,c,u;return Ph(this,function(l){switch(l.label){case 0:if((0,te.rA)(this.an,n="dc.sb.0"),this.pubDataChannelList.includes(e))return this.an.error(n+" datachannel already exist"),[2,!1];if((r=this.zegoWebRTC.streamCenter.publisherList[e])&&r.publisher.dataChannel)return this.pubDataChannelList.push(e),[2,!0];if(r&&!r.publisher.dataChannel)return this.an.error(n+" publish datachannel no exist, try other stream ID"),[2,!1];if(this.broadcastStream)return[3,2];i=te.VJ.createElement("canvas"),s=void 0;try{s=i.captureStream()}catch{return this.an.error(n+" publish datachannel, canvas captureStream error"),[2,!1]}return c=this,[4,this.zegoWebRTC.createStream({custom:{source:s}})];case 1:c.broadcastStream=l.sent(),l.label=2;case 2:return(u=this.zegoWebRTC.startPublishingStream(e,this.broadcastStream,{roomID:this.roomID},!0))&&this.pubDataChannelList.push(e),(0,te.OY)(this.an,n),[2,u]}})})},o.prototype.stopBroadcasting=function(e){var t="dc.sb.1";(0,te.rA)(this.an,t),this.pubDataChannelList=this.pubDataChannelList.filter(function(r){return r!==e});var n=this.zegoWebRTC.streamCenter.publisherList[e];return n?(n.room.roomID==this.roomID&&n.isDataChannel&&this.zegoWebRTC.stopPublishingStream(e),(0,te.OY)(this.an,t),!0):(this.an.error(t+" datachannel no found"),!1)},o.prototype.sendRealTimeSequentialData=function(e,t){if(!(0,R.SY)(t))return this.an.error("dc.srsd data type wrong"),!1;var n=this.zegoWebRTC.streamCenter.publisherList[e];return n&&this.pubDataChannelList.includes(e)?this.sendBCMessage(n.publisher,t):(this.an.error("dc.srsd datachannel no found"),!1)},o.prototype.sendBCMessage=function(e,t){var n;if(!e.dataChannelState)return!1;for(var r=new Uint8Array(t),i=0,s=t.byteLength,c=e.send_seq,u=0,l=new Date().getTime(),a=0;s>0;){s>1151?a=1141:(a=s,u=1);var h=new Uint8Array(a+10);h[0]=1,h[1]=u,h[2]=e.send_seq>>8&255,h[3]=255&e.send_seq,h[4]=c>>8&255,h[5]=255&c,h[6]=l>>24&255,h[7]=l>>16&255,h[8]=l>>8&255,h[9]=255&l;for(var m=0;m<a;m++)h[m+10]=r[m+i];s-=a,i+=a,e.send_seq++,e.send_seq>=65536&&(e.send_seq=0),(n=e.dataChannel)===null||n===void 0||n.send(h)}return!0},o.prototype.startSubscribing=function(e,t){var n,r;return kh(this,void 0,void 0,function(){var i,s,c;return Ph(this,function(u){switch(u.label){case 0:return(0,te.rA)(this.an,i="dc.ss.0"),this.subDataChannelList.includes(e)?(this.an.error(i+" datachannel already exist"),[2,!1]):(s=this.zegoWebRTC.streamCenter.playerList[e])?[3,2]:[4,this.zegoWebRTC.startPlayingStream(e,void 0,!0)];case 1:u.sent(),s=this.zegoWebRTC.streamCenter.playerList[e],u.label=2;case 2:return(c=s).dataChannel?(!(!((n=c.onDataChannelList)===null||n===void 0)&&n.includes(this.onReceivedDataChannel.bind(this)))&&((r=c.onDataChannelList)===null||r===void 0||r.push(this.onReceivedDataChannel.bind(this))),this.subDataChannelList.push(e),(0,te.OY)(this.an,i),[2,!0]):(this.an.error(i+" datachannel no exist, try other stream ID"),[2,!1])}})})},o.prototype.stopSubscribing=function(e){var t="dc.ss.1";(0,te.rA)(this.an,t),this.subDataChannelList=this.subDataChannelList.filter(function(r){return r!==e});var n=this.zegoWebRTC.streamCenter.playerList[e];return n?(n.room.roomID==this.roomID&&n.isDataChannel&&this.zegoWebRTC.stopPlayingStream(e),(0,te.OY)(this.an,t),!0):(this.an.error(t+" datachannel no subscribe"),!1)},o.prototype.on=function(e,t){this.bindListener(e,t)},o.prototype.off=function(e,t){this.deleteListener(e,t)},o.prototype.bindListener=function(e,t){return this.listenerList[e]?(0,R.JO)(t)?(this.listenerList[e].indexOf(t)==-1&&this.listenerList[e].push(t),!0):(this.an.error("zc.o.0 listener callBack must be funciton"),!1):(this.an.error("dc.o.0 event "+e+" no found"),!1)},o.prototype.deleteListener=function(e,t){if(!this.listenerList[e])return this.an.error("dc.o.1 listener no found"),!1;var n=this.listenerList[e];return t?n.splice(n.indexOf(t),1):this.listenerList[e]=[],!0},o.prototype.actionListener=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.listenerList[e]&&this.listenerList[e].forEach(function(i){try{setTimeout(function(){i.apply(void 0,n)},0)}catch(s){t.an.error("dc.al "+e+" "+s)}})},o.prototype.onReceivedDataChannel=function(e,t,n){this.actionListener("receiveRealTimeSequentialData",e,t,n)},o.prototype.reset=function(){var e=this,t="dc.rs";for(var n in(0,te.rA)(this.an,t),this.pubDataChannelList.forEach(function(r){var i=e.zegoWebRTC.streamCenter.publisherList[r];i&&i.room.roomID==e.roomID&&i.isDataChannel&&e.zegoWebRTC.stopPublishingStream(r)}),this.subDataChannelList.forEach(function(r){var i=e.zegoWebRTC.streamCenter.playerList[r];i&&i.room.roomID==e.roomID&&i.isDataChannel&&e.zegoWebRTC.stopPlayingStream(r)}),this.listenerList)this.listenerList[n]=[];this.broadcastStream&&this.zegoWebRTC.destroyStream(this.broadcastStream),this.broadcastStream=void 0,(0,te.OY)(this.an,t)},o}(),Tf=function(){function o(e,t){this._roomID=t,this.Dy=new Sf(e,t)}return o.prototype.reset=function(){this.Dy.reset()},Object.defineProperty(o.prototype,"roomID",{get:function(){return this._roomID},enumerable:!1,configurable:!0}),o.prototype.startBroadcasting=function(e){return this.Dy.startBroadcasting(e)},o.prototype.stopBroadcasting=function(e){return this.Dy.stopBroadcasting(e)},o.prototype.sendRealTimeSequentialData=function(e,t){return this.Dy.sendRealTimeSequentialData(e,t)},o.prototype.startSubscribing=function(e){return this.Dy.startSubscribing(e)},o.prototype.stopSubscribing=function(e){return this.Dy.stopSubscribing(e)},o.prototype.on=function(e,t){this.Dy.on(e,t)},o.prototype.off=function(e,t){this.Dy.off(e,t)},o}(),Ef={type:"DataChannel",install:function(o){Object.defineProperty(o.prototype,"createRealTimeSequentialDataManager",{value:function(e){this.logger.info("dc.cr room call"),this.enableDataChannel(!0);var t=this.stateCenter.getRoomByRoomID(e);return t?t.dataChannelManager?null:(t.dataChannelManager=new Tf(this,e),t.dataChannelManager):(this.logger.error("dc.cr room ".concat(e," no exist")),null)},writable:!1}),Object.defineProperty(o.prototype,"destroyRealTimeSequentialDataManager",{value:function(e){this.logger.info("dc.ds call");var t=this.stateCenter.roomList.find(function(n){return n.dataChannelManager==e});t?(e.reset(),t.dataChannelManager=null):this.logger.error("dc.ds not match, room: ".concat(e.roomID))},writable:!1})}},Cf=pt(5772),wf=function(){var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},o(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();qs.use(vf),qs.use(gf.StreamCDN),qs.use(yf.AudioMix),qs.use(bf.MixStream),qs.use(_f.RangeAudio),qs.use(Ef),qs.use(Cf.BeautyEffect);var If=function(o){function e(){return o!==null&&o.apply(this,arguments)||this}return wf(e,o),e}(qs)}(),Ft}()})})(ZegoExpressWebRTC);var ZegoExpressWebRTCExports=ZegoExpressWebRTC.exports;const getZegoToken=async(yn,Bt)=>{try{const sn=await fetch(`/api/zego/token?userId=${encodeURIComponent(Bt)}&roomId=${encodeURIComponent(yn)}`,{method:"GET"});if(!sn.ok)throw new Error(`Token fetch failed: ${sn.statusText}`);const Dt=await sn.json();return{token:Dt.token,appID:Dt.appID}}catch(on){return console.error("Error getting Zego token",on),null}},createMeeting=async()=>({meetingId:"room_"+Date.now()+"_"+Math.floor(Math.random()*1e3),err:null});export{Mic as M,VideoOff as V,ZegoExpressWebRTCExports as Z,MicOff as a,createMeeting as c,getZegoToken as g};
