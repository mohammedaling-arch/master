import { r as p, d as O, a as g, j as e, A as q, m as T, X as G, e as Y, C as H } from "./index-a367903a.js"; import { S as X, f as J } from "./dateUtils-0cf2816c.js"; import { a as K, D as Q, U as V } from "./SupportTickets-1bec5e21.js"; import { C as W, I as Z } from "./ImageCapture-db49fbfc.js"; import { U as M, P as R } from "./user-plus-bcd5904a.js"; import { F as ee } from "./file-text-05ff1bfe.js"; import { T as te } from "./trash-2-9ff1ad5f.js"; import { I as re } from "./image-fb628d93.js"; const ce = ({ isMobile: i, onFileFor: S }) => { const [_, I] = p.useState([]), [P, C] = p.useState(!0), [m, F] = p.useState(""), [N, x] = p.useState(!1), [t, l] = p.useState(null), [f, k] = p.useState(!1), { showModal: c } = O(), [D, z] = p.useState(!1); p.useEffect(() => { b() }, []); const b = async () => { var r, s; try { C(!0); const n = await g.get("/applicants"); I(n.data) } catch (n) { console.error("Error fetching applicants:", n), c({ type: "error", title: "Error Loading Applicants", message: ((s = (r = n.response) == null ? void 0 : r.data) == null ? void 0 : s.error) || "Failed to load applicants. Please refresh the page." }) } finally { C(!1) } }, [y, h] = p.useState(null), [j, v] = p.useState(null), U = () => { l({ first_name: "", middle_name: "", surname: "", gender: "male", age: "", email: "", phone: "", address: "", nin: "", status: "active", picture_path: "", signature_path: "" }), h(null), v(null), x(!0) }, w = r => { if (!r) return null; const s = r.replace(/\\/g, "/").replace(/^\/+/, ""); return `${g.defaults.baseURL.replace(/\/api$/, "")}/${s}` }, E = r => { l({ ...r, picture: null, signature: null }), h(w(r.picture_path)), v(w(r.signature_path)), x(!0) }, B = (r, s) => { const n = r.target.files[0]; if (!n) return; const a = new FileReader; a.onloadend = () => { s === "picture" ? (l(u => ({ ...u, picture: n })), h(a.result)) : (l(u => ({ ...u, signature: n })), v(a.result)) }, a.readAsDataURL(n) }, $ = async r => { var s, n; r.preventDefault(), k(!0); try { const a = new FormData, u = { first_name: t.first_name, middle_name: t.middle_name, surname: t.surname, gender: t.gender, age: t.age, email: t.email, phone: t.phone, address: t.address, nin: t.nin, status: t.status || "active" }; Object.entries(u).forEach(([d, o]) => { o != null && (!t.id && d === "first_name" ? a.append("firstName", o) : !t.id && d === "middle_name" ? a.append("middleName", o) : d === "age" && o === "" ? a.append(d, 0) : (d !== "first_name" && d !== "middle_name" || t.id) && a.append(d, o)) }), t.id && (t.picture_path && a.append("picture_path", t.picture_path), t.signature_path && a.append("signature_path", t.signature_path)), t.picture instanceof File && a.append("picture", t.picture), t.signature instanceof File && a.append("signature", t.signature), console.log("Submitting applicant:", t.id ? "UPDATE" : "CREATE"), console.log("FormData entries:"); for (let [d, o] of a.entries()) console.log(`  ${d}:`, o instanceof File ? `File(${o.name})` : o); t.id ? (await g.put(`/applicants/${t.id}`, a, { headers: { "Content-Type": "multipart/form-data" } }), c({ type: "success", title: "Applicant Updated", message: `${t.first_name} ${t.surname} has been updated successfully.` })) : (await g.post("/applicants", a, { headers: { "Content-Type": "multipart/form-data" } }), c({ type: "success", title: "Applicant Created", message: `${t.first_name} ${t.surname} has been added successfully.` })), x(!1), b() } catch (a) { c({ type: "error", title: t.id ? "Update Failed" : "Creation Failed", message: ((n = (s = a.response) == null ? void 0 : s.data) == null ? void 0 : n.error) || "Failed to save applicant." }) } finally { k(!1) } }, A = r => { c({ type: "warning", title: "Delete Applicant", message: `Are you sure you want to permanently delete ${r.first_name} ${r.surname}? This action cannot be undone.`, confirmText: "Delete Permanently", cancelText: "Cancel", showCancel: !0, onConfirm: async () => { try { await g.delete(`/applicants/${r.id}`), c({ type: "success", title: "Applicant Deleted", message: "The applicant has been removed." }), b() } catch { c({ type: "error", title: "Deletion Failed", message: "Failed to delete applicant." }) } } }) }, L = _.filter(r => { const s = `${r.first_name || ""} ${r.surname || ""}`.toLowerCase(), n = (r.email || "").toLowerCase(), a = m.toLowerCase(); return s.includes(a) || n.includes(a) || r.phone && r.phone.includes(m) }); return e.jsxs(e.Fragment, { children: [e.jsxs("div", { className: "glass-card", style: { background: "rgb\(18 37 74\)", border: "none", color: "white", overflow: "auto" }, children: [e.jsx("div", { style: { padding: i ? "1.5rem" : "2.5rem", background: "transparent" }, children: e.jsxs("div", { style: { display: "flex", flexDirection: i ? "column" : "row", justifyContent: "space-between", alignItems: i ? "flex-start" : "center", marginBottom: "2rem", gap: "1.5rem" }, children: [e.jsxs("div", { children: [e.jsxs("h2", { style: { margin: "0 0 0.5rem 0", display: "flex", alignItems: "center", gap: "0.75rem", fontSize: i ? "1.5rem" : "2rem", fontWeight: "bold" }, children: [e.jsx(K, { size: i ? 24 : 32, className: "text-blue-500" }), " Applicant Registry"] }), e.jsx("p", { style: { margin: 0, color: "#94a3b8", fontSize: "15px" }, children: "Manage applicant profiles, biometric data, and application history." })] }), e.jsxs("div", { style: { display: "flex", gap: "1rem", width: i ? "100%" : "auto" }, children: [e.jsxs("div", { style: { position: "relative", flex: 1, minWidth: i ? "auto" : "300px" }, children: [e.jsx(X, { style: { position: "absolute", left: "16px", top: "50%", transform: "translateY(-50%)", color: "#778eaeff" }, size: 20 }), e.jsx("input", { type: "text", placeholder: "Search applicants...", value: m, onChange: r => F(r.target.value), style: { width: "100%", padding: "12px 16px 12px 50px", background: "#0f172a", border: "1px solid #334155", borderRadius: "12px", color: "white", outline: "none", fontSize: "14px", transition: "all 0.3s" } })] }), e.jsxs("button", { onClick: U, className: "hover-scale", style: { display: "flex", alignItems: "center", gap: "0.5rem", padding: "12px 24px", background: "linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)", border: "none", borderRadius: "12px", color: "white", fontWeight: "600", cursor: "pointer", whiteSpace: "nowrap", boxShadow: "0 4px 6px -1px rgba(59, 130, 246, 0.3)" }, children: [e.jsx(M, { size: 20 }), " Add New"] })] })] }) }), e.jsx("div", { style: { padding: "1.5rem" }, children: e.jsx(Q, { dark: !0, columns: [{ key: "first_name", label: "Applicant", sortable: !0, render: (r, s) => { var n; return e.jsxs("div", { style: { display: "flex", alignItems: "center", gap: "0.75rem" }, children: [s.picture_path ? e.jsx("img", { src: w(s.picture_path), alt: r, style: { width: "40px", height: "40px", borderRadius: "10px", objectFit: "cover", border: "1px solid #334155" }, onError: a => { a.target.src = "https://via.placeholder.com/40?text=User" } }) : e.jsxs("div", { style: { width: "40px", height: "40px", background: "linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)", borderRadius: "10px", display: "flex", alignItems: "center", justifyContent: "center", fontWeight: "bold" }, children: [r == null ? void 0 : r[0], (n = s.surname) == null ? void 0 : n[0]] }), e.jsxs("div", { children: [e.jsxs("div", { style: { fontWeight: "600", color: "#f1f5f9" }, children: [r, " ", s.surname] }), e.jsx("div", { style: { fontSize: "12px", color: "#94a3b8" }, children: s.email || "No Email" })] })] }) } }, { key: "phone", label: "Contact", render: (r, s) => e.jsxs("div", { style: { fontSize: "13px" }, children: [e.jsx("div", { children: r || "N/A" }), e.jsxs("div", { style: { color: "#778eaeff", fontSize: "11px" }, children: ["NIN: ", s.nin || "Not Provided"] })] }) }, { key: "status", label: "Status", sortable: !0, render: r => e.jsxs("div", { style: { display: "flex", alignItems: "center", gap: "0.5rem" }, children: [e.jsx("div", { style: { width: "8px", height: "8px", borderRadius: "50%", background: r === "active" ? "#10b981" : "#ef4444" } }), e.jsx("span", { style: { color: r === "active" ? "#10b981" : "#ef4444", fontSize: "13px", fontWeight: "bold", textTransform: "uppercase" }, children: r })] }) }, { key: "created_at", label: "Added", sortable: !0, render: r => J(r) }], data: L, loading: P, searchPlaceholder: "Search applicants...", actions: r => e.jsxs("div", { style: { display: "flex", gap: "0.5rem", justifyContent: "flex-end" }, children: [e.jsx("button", { onClick: () => S && S(r), style: { padding: "8px", background: "rgba(16, 185, 129, 0.1)", color: "#10b981", border: "none", borderRadius: "8px", cursor: "pointer" }, title: "File Application", children: e.jsx(ee, { size: 18 }) }), e.jsx("button", { onClick: () => E(r), style: { padding: "8px", background: "rgba(59, 130, 246, 0.1)", color: "#3b82f6", border: "none", borderRadius: "8px", cursor: "pointer" }, title: "Edit", children: e.jsx(R, { size: 18 }) }), e.jsx("button", { onClick: () => A(r), style: { padding: "8px", background: "rgba(239, 68, 68, 0.1)", color: "#ef4444", border: "none", borderRadius: "8px", cursor: "pointer" }, title: "Delete", children: e.jsx(te, { size: 18 }) })] }) }) })] }), e.jsx(q, { children: N && e.jsx(T.div, { initial: { opacity: 0 }, animate: { opacity: 1 }, exit: { opacity: 0 }, style: { position: "fixed", inset: 0, background: "rgba(0, 0, 0, 0.85)", backdropFilter: "blur(8px)", display: "flex", alignItems: "flex-start", justifyContent: "center", zIndex: 2e3, padding: i ? "1rem" : "3rem", overflowY: "auto" }, onClick: () => !f && x(!1), children: e.jsxs(T.div, { initial: { scale: .9, opacity: 0 }, animate: { scale: 1, opacity: 1 }, exit: { scale: .9, opacity: 0 }, onClick: r => r.stopPropagation(), style: { background: "rgb\(18 37 74\)", borderRadius: "24px", padding: i ? "1.5rem" : "3rem", maxWidth: "850px", width: "100%", border: "1px solid #334155", boxShadow: "0 25px 50px -12px rgba(0, 0, 0, 0.5)", margin: "auto" }, children: [e.jsxs("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: "2rem" }, children: [e.jsx("h3", { style: { margin: 0, fontSize: "1.5rem" }, children: t != null && t.id ? "Edit Applicant" : "Add New Applicant" }), e.jsx("button", { onClick: () => x(!1), style: { background: "transparent", border: "none", color: "#778eaeff", cursor: "pointer" }, children: e.jsx(G, { size: 24 }) })] }), e.jsxs("form", { onSubmit: $, children: [e.jsxs("div", { style: { display: "grid", gridTemplateColumns: i ? "1fr" : "1fr 1fr", gap: i ? "1rem" : "1.5rem" }, children: [e.jsxs("div", { style: { gridColumn: i ? "span 1" : "span 3", display: "grid", gridTemplateColumns: i ? "1fr" : "1fr 1fr 1fr", gap: "1rem" }, children: [e.jsxs("div", { children: [e.jsx("label", { style: { display: "block", color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "6px", letterSpacing: "0.5px" }, children: "First Name *" }), e.jsx("input", { type: "text", required: !0, value: (t == null ? void 0 : t.first_name) || "", onChange: r => l({ ...t, first_name: r.target.value }), style: { width: "100%", padding: "12px", background: "#0f172a", border: "1px solid #334155", borderRadius: "8px", color: "white", fontWeight: "500" } })] }), e.jsxs("div", { children: [e.jsx("label", { style: { display: "block", color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "6px", letterSpacing: "0.5px" }, children: "Middle Name" }), e.jsx("input", { type: "text", value: (t == null ? void 0 : t.middle_name) || "", onChange: r => l({ ...t, middle_name: r.target.value }), style: { width: "100%", padding: "12px", background: "#0f172a", border: "1px solid #334155", borderRadius: "8px", color: "white", fontWeight: "500" } })] }), e.jsxs("div", { children: [e.jsx("label", { style: { display: "block", color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "6px", letterSpacing: "0.5px" }, children: "Surname *" }), e.jsx("input", { type: "text", required: !0, value: (t == null ? void 0 : t.surname) || "", onChange: r => l({ ...t, surname: r.target.value }), style: { width: "100%", padding: "12px", background: "#0f172a", border: "1px solid #334155", borderRadius: "8px", color: "white", fontWeight: "500" } })] })] }), e.jsxs("div", { style: { display: "grid", gridTemplateColumns: i ? "1fr" : "1fr 1fr", gap: "1rem", gridColumn: i ? "span 1" : "span 3" }, children: [e.jsxs("div", { children: [e.jsx("label", { style: { display: "block", color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "6px", letterSpacing: "0.5px" }, children: "Gender" }), e.jsxs("select", { value: (t == null ? void 0 : t.gender) || "male", onChange: r => l({ ...t, gender: r.target.value }), style: { width: "100%", padding: "12px", background: "#0f172a", border: "1px solid #334155", borderRadius: "8px", color: "white", fontWeight: "500" }, children: [e.jsx("option", { value: "male", children: "Male" }), e.jsx("option", { value: "female", children: "Female" }), e.jsx("option", { value: "other", children: "Other" })] })] }), e.jsxs("div", { children: [e.jsx("label", { style: { display: "block", color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "6px", letterSpacing: "0.5px" }, children: "Age" }), e.jsx("input", { type: "number", value: (t == null ? void 0 : t.age) || "", onChange: r => l({ ...t, age: r.target.value }), style: { width: "100%", padding: "12px", background: "#0f172a", border: "1px solid #334155", borderRadius: "8px", color: "white", fontWeight: "500" } })] })] }), e.jsxs("div", { style: { display: "grid", gridTemplateColumns: i ? "1fr" : "1fr 1fr 1fr", gap: "1rem", gridColumn: i ? "span 1" : "span 3" }, children: [e.jsxs("div", { children: [e.jsx("label", { style: { display: "block", color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "6px", letterSpacing: "0.5px" }, children: "Email" }), e.jsx("input", { type: "email", value: (t == null ? void 0 : t.email) || "", onChange: r => l({ ...t, email: r.target.value }), style: { width: "100%", padding: "12px", background: "#0f172a", border: "1px solid #334155", borderRadius: "8px", color: "white", fontWeight: "500" } })] }), e.jsxs("div", { children: [e.jsx("label", { style: { display: "block", color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "6px", letterSpacing: "0.5px" }, children: "Phone" }), e.jsx("input", { type: "text", value: (t == null ? void 0 : t.phone) || "", onChange: r => l({ ...t, phone: r.target.value }), style: { width: "100%", padding: "12px", background: "#0f172a", border: "1px solid #334155", borderRadius: "8px", color: "white", fontWeight: "500" } })] }), e.jsxs("div", { children: [e.jsx("label", { style: { display: "block", color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "6px", letterSpacing: "0.5px" }, children: "NIN" }), e.jsx("input", { type: "text", value: (t == null ? void 0 : t.nin) || "", onChange: r => l({ ...t, nin: r.target.value }), style: { width: "100%", padding: "12px", background: "#0f172a", border: "1px solid #334155", borderRadius: "8px", color: "white", fontWeight: "500" } })] })] }), e.jsxs("div", { style: { gridColumn: i ? "span 1" : "span 3" }, children: [e.jsx("label", { style: { display: "block", color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "6px", letterSpacing: "0.5px" }, children: "Address" }), e.jsx("textarea", { value: (t == null ? void 0 : t.address) || "", onChange: r => l({ ...t, address: r.target.value }), style: { width: "100%", padding: "12px", background: "#0f172a", border: "1px solid #334155", borderRadius: "8px", color: "white", minHeight: "80px", resize: "vertical", fontWeight: "500" } })] }), e.jsxs("div", { style: { gridColumn: i ? "span 1" : "span 3", display: "grid", gridTemplateColumns: i ? "1fr" : "1fr 1fr", gap: "1.5rem", marginTop: "1rem", borderTop: "1px solid #334155", paddingTop: "1.5rem" }, children: [e.jsxs("div", { children: [e.jsxs("label", { style: { color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "10px", display: "flex", alignItems: "center", gap: "0.5rem", letterSpacing: "0.5px" }, children: [e.jsx(W, { size: 14 }), " Applicant Picture"] }), e.jsxs("div", { style: { display: "flex", flexDirection: "column", gap: "0.75rem" }, children: [e.jsxs("div", { style: { display: "flex", alignItems: "center", gap: "1rem", background: "#0f172a", padding: "10px", borderRadius: "10px", border: "1px solid #334155" }, children: [e.jsx("div", { style: { width: "60px", height: "60px", borderRadius: "8px", overflow: "hidden", background: "rgb\(18 37 74\)", flexShrink: 0, border: "1px solid #334155" }, children: y ? e.jsx("img", { src: y, style: { width: "100%", height: "100%", objectFit: "cover" }, alt: "Preview" }) : e.jsx("div", { style: { width: "100%", height: "100%", display: "flex", alignItems: "center", justifyContent: "center", color: "#334155" }, children: e.jsx(re, { size: 24 }) }) }), e.jsxs("button", { type: "button", onClick: () => z(!0), style: { fontSize: "12px", color: "#3b82f6", background: "none", border: "none", cursor: "pointer", fontWeight: "bold", display: "flex", alignItems: "center", gap: "4px" }, children: [e.jsx(W, { size: 14 }), " ", y ? "Change Photo" : "Take/Upload Photo"] })] }), D && e.jsx(Z, { onClose: () => z(!1), onImageCaptured: (r, s) => { l(n => ({ ...n, picture: r })), h(s) }, title: "Applicant Photo" })] })] }), e.jsxs("div", { children: [e.jsxs("label", { style: { color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "10px", display: "flex", alignItems: "center", gap: "0.5rem", letterSpacing: "0.5px" }, children: [e.jsx(R, { size: 14 }), " Applicant Signature"] }), e.jsx("div", { style: { display: "flex", flexDirection: "column", gap: "0.75rem" }, children: e.jsxs("div", { style: { display: "flex", alignItems: "center", gap: "1rem", background: "#0f172a", padding: "10px", borderRadius: "10px", border: "1px solid #334155" }, children: [e.jsx("div", { style: { height: "60px", width: "120px", borderRadius: "8px", overflow: "hidden", background: "white", flexShrink: 0, display: "flex", alignItems: "center", justifyContent: "center", padding: "4px" }, children: j ? e.jsx("img", { src: j, style: { height: "100%", width: "100%", objectFit: "contain" }, alt: "Preview" }) : e.jsx("div", { style: { color: "#cbd5e1", fontSize: "10px", fontWeight: "bold" }, children: "NO SIGNATURE" }) }), e.jsx("input", { type: "file", accept: "image/*", id: "applicant-sig-upload", onChange: r => B(r, "signature"), style: { display: "none" } }), e.jsxs("label", { htmlFor: "applicant-sig-upload", style: { fontSize: "12px", color: "#3b82f6", cursor: "pointer", fontWeight: "bold", display: "flex", alignItems: "center", gap: "4px" }, children: [e.jsx(V, { size: 14 }), " ", j ? "Change Signature" : "Upload Signature"] })] }) })] }), (t == null ? void 0 : t.id) && e.jsxs("div", { children: [e.jsx("label", { style: { display: "block", color: "#94a3b8", fontSize: "11px", fontWeight: "bold", textTransform: "uppercase", marginBottom: "6px", letterSpacing: "0.5px" }, children: "Status" }), e.jsxs("select", { value: (t == null ? void 0 : t.status) || "active", onChange: r => l({ ...t, status: r.target.value }), style: { width: "100%", padding: "12px", background: "#0f172a", border: "1px solid #334155", borderRadius: "8px", color: "white", fontWeight: "500" }, children: [e.jsx("option", { value: "active", children: "Active" }), e.jsx("option", { value: "inactive", children: "Inactive" })] })] })] })] }), e.jsxs("div", { style: { display: "flex", gap: "1rem", marginTop: "2.5rem" }, children: [e.jsx("button", { type: "button", onClick: () => x(!1), style: { flex: 1, padding: "14px", borderRadius: "12px", background: "#334155", border: "none", color: "white", cursor: "pointer", fontWeight: "bold" }, children: "Cancel" }), e.jsxs("button", { type: "submit", disabled: f, className: "hover-scale", style: { flex: 1, padding: "14px", borderRadius: "12px", background: "linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)", border: "none", color: "white", cursor: "pointer", fontWeight: "bold", display: "flex", alignItems: "center", justifyContent: "center", gap: "0.5rem", boxShadow: "0 4px 6px -1px rgba(59, 130, 246, 0.3)" }, children: [f ? e.jsx(Y, { className: "animate-spin", size: 20 }) : e.jsx(H, { size: 20 }), t != null && t.id ? "Update" : "Create", " Applicant"] })] })] })] }) }) })] }) }; export { ce as A };
