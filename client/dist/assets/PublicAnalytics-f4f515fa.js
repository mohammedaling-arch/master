import { r as c, a as v, j as e, e as _, h as S, m as g, C as u } from "./index-a367903a.js"; import { f as P } from "./dateUtils-0cf2816c.js"; import { D as A, C as k } from "./SupportTickets-1bec5e21.js"; import { a as w } from "./ImageCapture-db49fbfc.js"; import { C as h } from "./credit-card-7df9ba98.js"; import { D as R } from "./download-8bb8051d.js"; import { F as y } from "./file-text-05ff1bfe.js"; import { A as j } from "./activity-566acbed.js"; import { a as z } from "./menu-52d4f898.js"; const L = ({ user: a, isMobile: i, staffMode: d = !1 }) => { const [o, f] = c.useState([]), [b, m] = c.useState(!0), [r, x] = c.useState(null); c.useEffect(() => { (a != null && a.id || d) && n() }, [a == null ? void 0 : a.id, d]); const n = async () => { m(!0), x(null); try { const t = d ? "/staff/payments/all" : `/payments/user/${a.id}`, s = await v.get(t); f(s.data) } catch (t) { console.error("Error fetching payments:", t), x("Failed to load payment history.") } finally { m(!1) } }, p = async t => { await w({ user: a, payment: t }) }, l = [{ key: "payment_date", label: "Date", sortable: !0, render: t => P(t) }, { key: "transaction_id", label: "Reference", render: t => e.jsx("span", { style: { fontFamily: "monospace", fontWeight: "bold" }, children: t }), hiddenMobile: !0 }, { key: "item_paid", label: "Purpose", render: (t, s) => e.jsxs("div", { children: [e.jsx("div", { style: { fontWeight: "600" }, children: t }), e.jsx("div", { style: { fontSize: "11px", color: "#778eaeff" }, children: s.affidavit_title || s.deceased_name || "Service Payment" })] }) }, { key: "amount", label: "Amount", sortable: !0, render: t => e.jsxs("span", { style: { fontWeight: "bold", color: "rgb\(18 37 74\)" }, children: ["₦", parseFloat(t).toLocaleString()] }) }, { key: "payment_status", label: "Status", render: t => e.jsx("span", { style: { padding: "4px 12px", borderRadius: "20px", fontSize: "11px", fontWeight: "bold", background: t === "completed" ? "#ecfdf5" : "#fffbeb", color: t === "completed" ? "#10b981" : "#f59e0b", textTransform: "uppercase" }, children: t }) }]; return b ? e.jsxs("div", { style: { padding: "4rem", textAlign: "center" }, children: [e.jsx(_, { className: "animate-spin", size: 40, color: "#3d2b1f", style: { margin: "0 auto 1rem" } }), e.jsx("p", { style: { color: "#778eaeff" }, children: "Fetching your payment records..." })] }) : r ? e.jsxs("div", { style: { padding: "4rem", textAlign: "center" }, children: [e.jsx(S, { size: 40, color: "#ef4444", style: { margin: "0 auto 1rem" } }), e.jsx("p", { style: { color: "#ef4444" }, children: r }), e.jsx("button", { onClick: n, style: { marginTop: "1rem", color: "#3b82f6", background: "none", border: "none", cursor: "pointer", fontWeight: "bold" }, children: "Retry" })] }) : e.jsxs(g.div, { initial: { opacity: 0, y: 20 }, animate: { opacity: 1, y: 0 }, className: "glass-card", style: { background: "white", padding: i ? "1rem" : "2rem" }, children: [e.jsx("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: "2rem" }, children: e.jsxs("div", { children: [e.jsxs("h2", { style: { margin: 0, fontSize: i ? "1.25rem" : "1.5rem", color: "#3d2b1f", display: "flex", alignItems: "center", gap: "0.75rem" }, children: [e.jsx(h, {}), " Payment History"] }), e.jsx("p", { style: { margin: "4px 0 0", color: "#778eaeff", fontSize: "14px" }, children: "View and download your official payment receipts." })] }) }), o.length > 0 ? e.jsx(A, { columns: l, data: o, isMobile: i, searchPlaceholder: "Search transactions...", actions: t => e.jsxs("button", { onClick: () => p(t), title: "Download Receipt", style: { background: "#3d2b1f", color: "white", border: "none", padding: "8px", borderRadius: "8px", cursor: "pointer", display: "flex", alignItems: "center", gap: "0.5rem", transition: "transform 0.2s", fontSize: "12px", fontWeight: "bold" }, onMouseOver: s => s.currentTarget.style.transform = "scale(1.05)", onMouseOut: s => s.currentTarget.style.transform = "scale(1)", children: [e.jsx(R, { size: 16 }), !i && "Download Receipt"] }) }) : e.jsxs("div", { style: { textAlign: "center", padding: "4rem 2rem", background: "#f8fafc", borderRadius: "16px", border: "2px dashed #e2e8f0" }, children: [e.jsx("div", { style: { width: "64px", height: "64px", background: "#fff", borderRadius: "50%", display: "flex", alignItems: "center", justifyContent: "center", margin: "0 auto 1.5rem", boxShadow: "0 4px 6px -1px rgba(0,0,0,0.1)" }, children: e.jsx(y, { size: 32, color: "#94a3b8" }) }), e.jsx("h3", { style: { margin: "0 0 0.5rem", color: "rgb\(18 37 74\)" }, children: "No Payments Found" }), e.jsx("p", { style: { color: "#778eaeff", maxWidth: "300px", margin: "0 auto 1.5rem" }, children: "You haven't made any payments yet. Records of your filings and applications will appear here." })] })] }) }, N = ({ isMobile: a, setView: i, module: d = "affidavit" }) => { const [o, f] = c.useState(null), [b, m] = c.useState(!0); if (c.useEffect(() => { (async () => { var p; try { console.log("[PublicAnalytics] Fetching stats for module:", d); const l = await v.get(`/public/stats?t=${Date.now()}`); console.log("[PublicAnalytics] Stats response:", l.data), f(l.data) } catch (l) { console.error("[PublicAnalytics] Failed to fetch public stats:", l), console.error("[PublicAnalytics] Error details:", ((p = l.response) == null ? void 0 : p.data) || l.message), f({ total_affidavits: 0, completed_affidavits: 0, affidavit_spent: 0, total_probate: 0, approved_probate: 0, pending_probate: 0, rejected_probate: 0, probate_spent: 0, total_spent: 0 }) } finally { m(!1) } })() }, [d]), b) return e.jsx("div", { style: { display: "flex", justifyContent: "center", padding: "3rem" }, children: e.jsx("div", { className: "animate-spin", style: { width: "40px", height: "40px", border: "4px solid #3b82f6", borderTopColor: "transparent", borderRadius: "50%" } }) }); if (!o) return console.warn("[PublicAnalytics] Stats is null, showing empty state"), e.jsx("div", { style: { padding: "2rem", textAlign: "center", color: "#778eaeff" }, children: e.jsx("p", { children: "Unable to load analytics data. Please refresh the page." }) }); const r = d === "probate", x = r ? [{ title: "Probate Apps", value: (o == null ? void 0 : o.total_probate) || 0, icon: e.jsx(y, { color: "#8b5cf6" }), color: "#8b5cf6", action: () => i("applications") }, { title: "Approved", value: (o == null ? void 0 : o.approved_probate) || 0, icon: e.jsx(u, { color: "#10b981" }), color: "#10b981", action: () => i("applications") }, { title: "Pending/Rejected", value: ((o == null ? void 0 : o.pending_probate) || 0) + ((o == null ? void 0 : o.rejected_probate) || 0), icon: e.jsx(k, { color: "#f59e0b" }), color: "#f59e0b", action: () => i("applications") }, { title: "Probate Fees", value: `₦${parseFloat((o == null ? void 0 : o.probate_spent) || 0).toLocaleString()}`, icon: e.jsx(h, { color: "#3b82f6" }), color: "#3b82f6", action: () => i("payments") }] : [{ title: "Your Affidavits", value: (o == null ? void 0 : o.total_affidavits) || 0, icon: e.jsx(y, { color: "#3b82f6" }), color: "#3b82f6", action: () => i("history") }, { title: "Certified", value: (o == null ? void 0 : o.completed_affidavits) || 0, icon: e.jsx(u, { color: "#10b981" }), color: "#10b981", action: () => i("history") }, { title: "Total Spent", value: `₦${parseFloat((o == null ? void 0 : o.affidavit_spent) || 0).toLocaleString()}`, icon: e.jsx(h, { color: "#8b5cf6" }), color: "#8b5cf6", action: () => i("payments") }, { title: "Module Usage", value: (o == null ? void 0 : o.total_probate) > 0 ? "Integrated" : "Affidavit", icon: e.jsx(j, { color: "#f59e0b" }), color: "#f59e0b", action: () => i("dash") }]; return e.jsxs("div", { style: { animation: "fadeIn 0.5s ease-out" }, children: [e.jsxs("div", { style: { marginBottom: "2rem" }, children: [e.jsx("h2", { style: { fontSize: "1.8rem", margin: "0 0 0.5rem 0", fontWeight: "bold", color: "rgb\(18 37 74\)" }, children: r ? "Probate Insights" : "Welcome Back!" }), e.jsx("p", { style: { color: "#778eaeff" }, children: r ? "Summary of your probate and estate applications." : "Here's what's happening with your legal documents today." })] }), e.jsx("div", { style: { display: "grid", gridTemplateColumns: a ? "1fr" : "repeat(4, 1fr)", gap: "1.5rem", marginBottom: "3rem" }, children: x.map((n, p) => e.jsxs(g.div, { whileHover: { y: -5, boxShadow: "0 10px 25px -5px rgba(0, 0, 0, 0.1)" }, onClick: n.action, style: { background: "white", padding: "1.75rem", borderRadius: "24px", border: "1px solid #f1f5f9", display: "flex", flexDirection: "column", gap: "1.25rem", cursor: "pointer", transition: "all 0.3s ease" }, children: [e.jsx("div", { style: { padding: "12px", borderRadius: "16px", background: `${n.color}10`, width: "fit-content" }, children: n.icon }), e.jsxs("div", { children: [e.jsx("p", { style: { margin: 0, color: "#778eaeff", fontSize: "14px", fontWeight: "600" }, children: n.title }), e.jsx("h3", { style: { margin: "0.4rem 0 0", fontSize: "1.8rem", fontWeight: "800", color: "rgb\(18 37 74\)" }, children: n.value })] }), e.jsxs("div", { style: { display: "flex", alignItems: "center", gap: "4px", color: n.color, fontSize: "12px", fontWeight: "700", marginTop: "auto" }, children: ["View Details ", e.jsx(z, { size: 14 })] })] }, p)) }), e.jsx("div", { children: e.jsxs("div", { style: { background: "white", padding: "2.5rem", borderRadius: "32px", border: "1px solid #f1f5f9", width: "100%" }, children: [e.jsxs("h3", { style: { margin: "0 0 2rem 0", display: "flex", alignItems: "center", gap: "0.75rem", color: "rgb\(18 37 74\)", fontSize: "1.25rem" }, children: [e.jsx(j, { size: 22, color: r ? "#8b5cf6" : "#3b82f6" }), " ", r ? "Probate Application Progress" : "Filing Activity"] }), e.jsxs("div", { style: { display: "flex", flexDirection: "column", gap: "2rem" }, children: [e.jsxs("div", { children: [e.jsxs("div", { style: { display: "flex", justifyContent: "space-between", marginBottom: "12px" }, children: [e.jsx("span", { style: { fontSize: "15px", color: "#778eaeff", fontWeight: "500" }, children: r ? "Application Approval Rate" : "Affidavit Progress" }), e.jsx("span", { style: { fontSize: "15px", fontWeight: "bold", color: "rgb\(18 37 74\)" }, children: r ? `${(o == null ? void 0 : o.approved_probate) || 0} / ${(o == null ? void 0 : o.total_probate) || 0} Approved` : `${(o == null ? void 0 : o.completed_affidavits) || 0} / ${(o == null ? void 0 : o.total_affidavits) || 0} Certified` })] }), e.jsx("div", { style: { height: "12px", background: "#f8fafc", borderRadius: "8px", overflow: "hidden", border: "1px solid #f1f5f9" }, children: e.jsx(g.div, { initial: { width: 0 }, animate: { width: r ? o != null && o.total_probate ? `${o.approved_probate / o.total_probate * 100}%` : 0 : o != null && o.total_affidavits ? `${o.completed_affidavits / o.total_affidavits * 100}%` : 0 }, style: { height: "100%", background: r ? "linear-gradient(90deg, #8b5cf6, #a78bfa)" : "linear-gradient(90deg, #3b82f6, #60a5fa)", borderRadius: "8px" } }) })] }), e.jsxs("div", { style: { display: "flex", gap: "1.5rem", marginTop: "1rem" }, children: [e.jsxs("div", { style: { flex: 1, padding: "1.5rem", background: r ? "#f5f3ff" : "#f0f9ff", borderRadius: "20px", border: r ? "1px solid #ede9fe" : "1px solid #e0f2fe" }, children: [e.jsx("h4", { style: { margin: "0 0 0.5rem", color: r ? "#6d28d9" : "#0369a1", fontSize: "0.9rem" }, children: "Efficiency" }), e.jsx("p", { style: { margin: 0, fontSize: "1.25rem", fontWeight: "bold", color: r ? "#4c1d95" : "#0c4a6e" }, children: (r ? o == null ? void 0 : o.total_probate : o == null ? void 0 : o.total_affidavits) > 0 ? "High" : "N/A" })] }), e.jsxs("div", { style: { flex: 1, padding: "1.5rem", background: "#f0fdf4", borderRadius: "20px", border: "1px solid #dcfce7" }, children: [e.jsx("h4", { style: { margin: "0 0 0.5rem", color: "#15803d", fontSize: "0.9rem" }, children: "Total Processed" }), e.jsx("p", { style: { margin: 0, fontSize: "1.25rem", fontWeight: "bold", color: "#064e3b" }, children: r ? `${(o == null ? void 0 : o.approved_probate) || 0} Apps` : `${(o == null ? void 0 : o.completed_affidavits) || 0} Docs` })] })] })] })] }) })] }) }; export { N as P, L as a };
